cscope 15 $HOME/lee/YCSB               0000998217
	@accumulo1.9/src/main/java/site/ycsb/db/accumulo/AccumuloClient.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gaccumulo
;

21 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
.
	gUTF_8
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

28 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

29 
impÜt
 
	gjava
.
	gut
.
	gSÜ‹dM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gAccumuloExû±iÚ
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gAccumuloSecur™yExû±iÚ
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gB©chWr™”
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gB©chWr™”CÚfig
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gCl›ÁCÚfigu¿tiÚ
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gCÚÃùÜ
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gI‹¿tÜS‘tšg
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gMutiÚsRejeùedExû±iÚ
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gSÿÂ”
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gTabËNÙFoundExû±iÚ
;

44 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gZooK“³rIn¡ªû
;

45 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	g£cur™y
.
	gtok’s
.
	gAuth’tiÿtiÚTok’
;

46 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	g£cur™y
.
	gtok’s
.
	gPasswÜdTok’
;

47 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gd©a
.
	gKey
;

48 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gd©a
.
	gMutiÚ
;

49 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gd©a
.
	gRªge
;

50 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gd©a
.
	gV®ue
;

51 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	g™”©Üs
.
	gu£r
.
	gWhŞeRowI‹¿tÜ
;

52 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	g£cur™y
.
	gAuthÜiz©iÚs
;

53 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gut
.
	gCËªUp
;

54 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

56 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

57 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

58 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

59 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

60 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

65 
public
 cÏs 
	cAccumuloCl›Á
 
ex‹nds
 
	mDB
 {

67 
´iv©e
 
ZooK“³rIn¡ªû
 
	mš¡
;

68 
´iv©e
 
CÚÃùÜ
 
	mcÚÃùÜ
;

69 
´iv©e
 
Text
 
	mcŞFam
 = 
Ãw
 Text("");

70 
´iv©e
 
	mby‹
[] 
	mcŞFamBy‹s
 = 
Ãw
 
by‹
[0];

71 
´iv©e
 
fš®
 
	mCÚcu¼’tHashM­
<
	mSŒšg
, 
	mB©chWr™”
> 
	mwr™”s
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

74 
	mRuÁime
.
g‘RuÁime
().
addShutdownHook
(
Ãw
 
Th»ad
() {

75 @
Ov”ride


76 
public
 
run
() {

77 
CËªUp
.
shutdownNow
();

82 @
Ov”ride


83 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

84 
cŞFam
 = 
Ãw
 
	`Text
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("accumulo.columnFamily"));

85 
cŞFamBy‹s
 = 
cŞFam
.
	`toSŒšg
().
	`g‘By‹s
(
UTF_8
);

87 
š¡
 = 
Ãw
 
	`ZooK“³rIn¡ªû
Òew 
	`Cl›ÁCÚfigu¿tiÚ
()

88 .
	`w™hIn¡ªû
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("accumulo.instanceName"))

89 .
	`w™hZkHo¡s
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("accumulo.zooKeepers")));

90 
Œy
 {

91 
SŒšg
 
´šc®
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("accumulo.username");

92 
Auth’tiÿtiÚTok’
 
tok’
 =

93 
Ãw
 
	`PasswÜdTok’
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("accumulo.password"));

94 
cÚÃùÜ
 = 
š¡
.
	`g‘CÚÃùÜ
(
´šc®
, 
tok’
);

95 } 
	`ÿtch
 (
AccumuloExû±iÚ
 | 
AccumuloSecur™yExû±iÚ
 
e
) {

96 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

99 ià(!(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("accumulo.pcFÏg", "nÚe").
	`equ®s
("none"))) {

100 
Sy¡em
.
”r
.
	`´šn
("Sorry,he ZK based…roducer/consumer implementation has been„emoved. " +

103 
	}
}

105 @
Ov”ride


106 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

107 
Œy
 {

108 
I‹¿tÜ
<
B©chWr™”
> 
™”©Ü
 = 
wr™”s
.
	`v®ues
().
	`™”©Ü
();

109 
™”©Ü
.
	`hasNext
()) {

110 
B©chWr™”
 
wr™”
 = 
™”©Ü
.
	`Ãxt
();

111 
wr™”
.
	`şo£
();

112 
™”©Ü
.
	`»move
();

114 } 
	`ÿtch
 (
MutiÚsRejeùedExû±iÚ
 
e
) {

115 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

117 
	}
}

126 
public
 
B©chWr™”
 
	$g‘Wr™”
(
SŒšg
 
bË
è
throws
 
TabËNÙFoundExû±iÚ
 {

132 
B©chWr™”
 
wr™”
 = 
wr™”s
.
	`g‘
(
bË
);

133 ià(
nuÎ
 =ğ
wr™”
) {

134 
B©chWr™”
 
ÃwWr™”
 = 
	`ü—‹B©chWr™”
(
bË
);

135 
B©chWr™”
 
ŞdWr™”
 = 
wr™”s
.
	`putIfAb£Á
(
bË
, 
ÃwWr™”
);

137 ià(
nuÎ
 !ğ
ŞdWr™”
) {

138 
Œy
 {

140 
ÃwWr™”
.
	`şo£
();

141 } 
	`ÿtch
 (
MutiÚsRejeùedExû±iÚ
 
e
) {

142 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

144 
wr™”
 = 
ŞdWr™”
;

146 
wr™”
 = 
ÃwWr™”
;

149  
wr™”
;

150 
	}
}

157 
´iv©e
 
B©chWr™”
 
	$ü—‹B©chWr™”
(
SŒšg
 
bË
è
throws
 
TabËNÙFoundExû±iÚ
 {

158 
B©chWr™”CÚfig
 
bwc
 = 
Ãw
 
	`B©chWr™”CÚfig
();

159 
bwc
.
	`£tMaxL©’cy
(

160 
LÚg
.
	`·r£LÚg
(
	`g‘Prİ”t›s
()

161 .
	`g‘Prİ”ty
("accumulo.batchWriterMaxLatency", "30000")),

162 
TimeUn™
.
MILLISECONDS
);

163 
bwc
.
	`£tMaxMemÜy
(
LÚg
.
	`·r£LÚg
(

164 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("accumulo.batchWriterSize", "100000")));

165 
fš®
 
SŒšg
 
numTh»adsV®ue
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("accumulo.batchWriterThreads");

167 
numTh»ads
 = 
M©h
.
	`max
(1, 
RuÁime
.
	`g‘RuÁime
().
	`avaabËProûssÜs
() / 2);

168 ià(
nuÎ
 !ğ
numTh»adsV®ue
) {

169 
numTh»ads
 = 
IÁeg”
.
	`·r£IÁ
(
numTh»adsV®ue
);

171 
Sy¡em
.
”r
.
	`´šn
("Usšg " + 
numTh»ads
 + "hreadso write data");

172 
bwc
.
	`£tMaxWr™eTh»ads
(
numTh»ads
);

173  
cÚÃùÜ
.
	`ü—‹B©chWr™”
(
bË
, 
bwc
);

174 
	}
}

183 
´iv©e
 
SÿÂ”
 
g‘Row
(
SŒšg
 
bË
, 
Text
 
row
, 
S‘
<SŒšg> 
f›lds
è
throws
 
	gTabËNÙFoundExû±iÚ
 {

184 
SÿÂ”
 
	gsÿÂ”
 = 
cÚÃùÜ
.
ü—‹SÿÂ”
(
bË
, 
AuthÜiz©iÚs
.
EMPTY
);

185 
	gsÿÂ”
.
£tRªge
(
Ãw
 
Rªge
(
row
));

186 ià(
	gf›lds
 !ğ
nuÎ
) {

187 
SŒšg
 
f›ld
 : 
f›lds
) {

188 
sÿÂ”
.
ãtchCŞumn
(
cŞFam
, 
Ãw
 
Text
(
f›ld
));

191  
	gsÿÂ”
;

194 @
Ov”ride


195 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

196 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

198 
SÿÂ”
 
	gsÿÂ”
 = 
nuÎ
;

199 
	gŒy
 {

200 
	gsÿÂ”
 = 
g‘Row
(
bË
, 
Ãw
 
Text
(
key
), 
nuÎ
);

202 
fš®
 
Text
 
	gcq
 = 
Ãw
 Text();

203 
	gEÁry
<
	gKey
, 
	gV®ue
> 
	g’Œy
 : 
sÿÂ”
) {

204 
’Œy
.
g‘Key
().
g‘CŞumnQu®if›r
(
cq
);

205 
V®ue
 
	gv
 = 
’Œy
.
g‘V®ue
();

206 
	gby‹
[] 
	gbuf
 = 
v
.
g‘
();

207 
	g»suÉ
.
put
(
cq
.
toSŒšg
(),

208 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
buf
));

210 } 
ÿtch
 (
Exû±iÚ
 
e
) {

211 
	gSy¡em
.
	g”r
.
´šn
("E¼ÜryšgØ»adšg AccumulØbË " + 
bË
 + " " + 
key
);

212 
	ge
.
´štSckT¿û
();

213  
	gStus
.
	gERROR
;

214 } 
	gfš®ly
 {

215 ià(
	gnuÎ
 !ğ
sÿÂ”
) {

216 
sÿÂ”
.
şo£
();

219  
	gStus
.
	gOK
;

223 @
Ov”ride


224 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

225 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

227 
SÿÂ”
 
	gsÿÂ”
 = 
nuÎ
;

228 
	gŒy
 {

229 
	gsÿÂ”
 = 
cÚÃùÜ
.
ü—‹SÿÂ”
(
bË
, 
AuthÜiz©iÚs
.
EMPTY
);

230 
	gsÿÂ”
.
£tRªge
(
Ãw
 
Rªge
Òew 
Text
(
¡¬tkey
), 
nuÎ
));

233 
I‹¿tÜS‘tšg
 
	gcfg
 = 
Ãw
 I‹¿tÜS‘tšg(100, 
WhŞeRowI‹¿tÜ
.
şass
);

234 
	gsÿÂ”
.
addSÿnI‹¿tÜ
(
cfg
);

237 ià(
	gf›lds
 !ğ
nuÎ
) {

239 
SŒšg
 
f›ld
 : 
f›lds
) {

240 
sÿÂ”
.
ãtchCŞumn
(
cŞFam
, 
Ãw
 
Text
(
f›ld
));

244 
	gcouÁ
 = 0;

245 
	gEÁry
<
	gKey
, 
	gV®ue
> 
	g’Œy
 : 
sÿÂ”
) {

247 
SÜ‹dM­
<
Key
, 
	gV®ue
> 
	grow
 = 
WhŞeRowI‹¿tÜ
.
decodeRow
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

248 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	growD©a
;

249 ià(
	gnuÎ
 !ğ
f›lds
) {

250 
rowD©a
 = 
Ãw
 
HashM­
<>(
f›lds
.
size
());

252 
	growD©a
 = 
Ãw
 
HashM­
<>();

254 
	g»suÉ
.
add
(
rowD©a
);

256 
fš®
 
Text
 
	gcq
 = 
Ãw
 Text();

257 
	gEÁry
<
	gKey
, 
	gV®ue
> 
	growEÁry
 : 
row
.
’ŒyS‘
()) {

258 
rowEÁry
.
g‘Key
().
g‘CŞumnQu®if›r
(
cq
);

259 
	growD©a
.
put
(
cq
.
toSŒšg
(), 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
rowEÁry
.
g‘V®ue
().
g‘
()));

261 ià(
	gcouÁ
++ =ğ
»cÜdcouÁ
) {

265 } 
ÿtch
 (
TabËNÙFoundExû±iÚ
 
e
) {

266 
	gSy¡em
.
	g”r
.
´šn
("Errorryingo connecto Accumuloable.");

267 
	ge
.
´štSckT¿û
();

268  
	gStus
.
	gERROR
;

269 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

270 
	gSy¡em
.
	g”r
.
´šn
("Error deserializing data from Accumulo.");

271 
	ge
.
´štSckT¿û
();

272  
	gStus
.
	gERROR
;

273 } 
	gfš®ly
 {

274 ià(
	gnuÎ
 !ğ
sÿÂ”
) {

275 
sÿÂ”
.
şo£
();

279  
	gStus
.
	gOK
;

282 @
Ov”ride


283 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

284 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

285 
B©chWr™”
 
	gbw
 = 
nuÎ
;

286 
	gŒy
 {

287 
	gbw
 = 
g‘Wr™”
(
bË
);

288 } 
ÿtch
 (
TabËNÙFoundExû±iÚ
 
e
) {

289 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü o³nšg b©ch wr™”ØAccumulØbË " + 
bË
);

290 
	ge
.
´štSckT¿û
();

291  
	gStus
.
	gERROR
;

294 
MutiÚ
 
	gmutIn£¹
 = 
Ãw
 MutiÚ(
key
.
g‘By‹s
(
UTF_8
));

295 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

296 
mutIn£¹
.
put
(
cŞFamBy‹s
, 
’Œy
.
g‘Key
().
g‘By‹s
(
UTF_8
),ƒÁry.
g‘V®ue
().
toA¼ay
());

299 
	gŒy
 {

300 
	gbw
.
addMutiÚ
(
mutIn£¹
);

301 } 
ÿtch
 (
MutiÚsRejeùedExû±iÚ
 
e
) {

302 
	gSy¡em
.
	g”r
.
´šn
("Error…erforming update.");

303 
	ge
.
´štSckT¿û
();

304  
	gStus
.
	gERROR
;

307  
	gStus
.
	gBATCHED_OK
;

310 @
Ov”ride


311 
public
 
Stus
 
š£¹
(
SŒšg
 
t
, SŒšg 
key
,

312 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

313  
upd©e
(
t
, 
key
, 
v®ues
);

316 @
Ov”ride


317 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

318 
B©chWr™”
 
bw
;

319 
Œy
 {

320 
bw
 = 
	`g‘Wr™”
(
bË
);

321 } 
	`ÿtch
 (
TabËNÙFoundExû±iÚ
 
e
) {

322 
Sy¡em
.
”r
.
	`´šn
("Errorryingo connecto Accumuloable.");

323 
e
.
	`´štSckT¿û
();

324  
Stus
.
ERROR
;

327 
Œy
 {

328 
	`d–‘eRow
(
bË
, 
Ãw
 
	`Text
(
key
), 
bw
);

329 } 
	`ÿtch
 (
TabËNÙFoundExû±iÚ
 | 
MutiÚsRejeùedExû±iÚ
 
e
) {

330 
Sy¡em
.
”r
.
	`´šn
("Error…erforming delete.");

331 
e
.
	`´štSckT¿û
();

332  
Stus
.
ERROR
;

333 } 
	`ÿtch
 (
RuÁimeExû±iÚ
 
e
) {

334 
Sy¡em
.
”r
.
	`´šn
("Error…erforming delete.");

335 
e
.
	`´štSckT¿û
();

336  
Stus
.
ERROR
;

339  
Stus
.
OK
;

340 
	}
}

343 
´iv©e
 
	$d–‘eRow
(
SŒšg
 
bË
, 
Text
 
row
, 
B©chWr™”
 
bw
è
throws
 
MutiÚsRejeùedExû±iÚ
,

344 
TabËNÙFoundExû±iÚ
 {

346 
	`d–‘eRow
(
	`g‘Row
(
bË
, 
row
, 
nuÎ
), 
bw
);

347 
	}
}

352 
´iv©e
 
	$d–‘eRow
(
SÿÂ”
 
sÿÂ”
, 
B©chWr™”
 
bw
è
throws
 
MutiÚsRejeùedExû±iÚ
 {

353 
MutiÚ
 
d–‘”
 = 
nuÎ
;

355 
fš®
 
Text
 
row
 = 
Ãw
 
	`Text
();

356 
fš®
 
Text
 
cf
 = 
Ãw
 
	`Text
();

357 
fš®
 
Text
 
cq
 = 
Ãw
 
	`Text
();

358 
EÁry
<
Key
, 
V®ue
> 
’Œy
 : 
sÿÂ”
) {

360 ià(
d–‘”
 =ğ
nuÎ
) {

361 
’Œy
.
	`g‘Key
().
	`g‘Row
(
row
);

362 
d–‘”
 = 
Ãw
 
	`MutiÚ
(
row
);

364 
’Œy
.
	`g‘Key
().
	`g‘CŞumnFamy
(
cf
);

365 
’Œy
.
	`g‘Key
().
	`g‘CŞumnQu®if›r
(
cq
);

367 
d–‘”
.
	`putD–‘e
(
cf
, 
cq
);

370 
bw
.
	`addMutiÚ
(
d–‘”
);

371 
	}
}

	@accumulo1.9/src/main/java/site/ycsb/db/accumulo/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gaccumulo
;

	@accumulo1.9/src/test/java/site/ycsb/db/accumulo/AccumuloTest.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gaccumulo
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeTrue
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

27 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßd
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

32 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gCÚÃùÜ
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	gSÿÂ”
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gş›Á
.
	g£cur™y
.
	gtok’s
.
	gPasswÜdTok’
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gd©a
.
	gKey
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	gd©a
.
	gV®ue
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	g£cur™y
.
	gAuthÜiz©iÚs
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gcÜe
.
	g£cur™y
.
	gTabËP”missiÚ
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	gaccumulo
.
	gmšişu¡”
.
	gMšiAccumuloClu¡”
;

42 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

43 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

44 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

45 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

46 
impÜt
 
	gÜg
.
	gjun™
.
	gCÏssRuË
;

47 
impÜt
 
	gÜg
.
	gjun™
.
	gRuË
;

48 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

49 
impÜt
 
	gÜg
.
	gjun™
.
	gruËs
.
	gTempÜ¬yFŞd”
;

50 
impÜt
 
	gÜg
.
	gjun™
.
	gruËs
.
	gTe¡Name
;

51 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

52 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

58 
public
 cÏs 
	cAccumuloTe¡
 {

59 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = 
Logg”FaùÜy
.
g‘Logg”
(
AccumuloTe¡
.
şass
);

60 
´iv©e
 
fš®
 
	mINSERT_COUNT
 = 2000;

61 
´iv©e
 
fš®
 
	mTRANSACTION_COUNT
 = 2000;

63 @
CÏssRuË


64 
public
 
TempÜ¬yFŞd”
 
	mwÜkšgDœ
 = 
Ãw
 TemporaryFolder();

65 @
RuË


66 
public
 
Te¡Name
 
	m‹¡
 = 
Ãw
 TestName();

68 
´iv©e
 
MšiAccumuloClu¡”
 
	mşu¡”
;

69 
´iv©e
 
Prİ”t›s
 
	m´İ”t›s
;

70 
´iv©e
 
WÜklßd
 
	mwÜklßd
;

71 
´iv©e
 
DB
 
	mş›Á
;

72 
´iv©e
 
Prİ”t›s
 
	mwÜklßdPrİs
;

74 
´iv©e
 
boŞ—n
 
	$isWšdows
() {

75 
fš®
 
SŒšg
 
os
 = 
Sy¡em
.
	`g‘Prİ”ty
("os.name");

76  
os
.
	`¡¬tsW™h
("Windows");

79 @
BefÜeCÏss


80 
public
 
	$£tup
(è
throws
 
Exû±iÚ
 {

83 
	`assumeTrue
(!
	`isWšdows
());

84 
şu¡”
 = 
Ãw
 
	`MšiAccumuloClu¡”
(
wÜkšgDœ
.
	`ÃwFŞd”
("accumulo").
	`g‘AbsŞu‹Fe
(), "protectyaneck");

85 
LOG
.
	`debug
("starting minicluster");

86 
şu¡”
.
	`¡¬t
();

87 
LOG
.
	`debug
("creating connection for‡dmin operations.");

89 
fš®
 
CÚÃùÜ
 
admš
 = 
şu¡”
.
	`g‘CÚÃùÜ
("root", "protectyaneck");

90 
admš
.
	`bËO³¿tiÚs
().
	`ü—‹
(
CÜeWÜklßd
.
TABLENAME_PROPERTY_DEFAULT
);

91 
admš
.
	`£cur™yO³¿tiÚs
().
	`ü—‹LoÿlU£r
("ycsb", 
Ãw
 
	`PasswÜdTok’
("protectyaneck"));

92 
admš
.
	`£cur™yO³¿tiÚs
().
	`g¿ÁTabËP”missiÚ
("ycsb", 
CÜeWÜklßd
.
TABLENAME_PROPERTY_DEFAULT
, 
TabËP”missiÚ
.
READ
);

93 
admš
.
	`£cur™yO³¿tiÚs
().
	`g¿ÁTabËP”missiÚ
("ycsb", 
CÜeWÜklßd
.
TABLENAME_PROPERTY_DEFAULT
, 
TabËP”missiÚ
.
WRITE
);

96 
´İ”t›s
 = 
Ãw
 
	`Prİ”t›s
();

97 
´İ”t›s
.
	`£tPrİ”ty
("accumulo.zooK“³rs", 
şu¡”
.
	`g‘ZooK“³rs
());

98 
´İ”t›s
.
	`£tPrİ”ty
("accumulo.š¡ªûName", 
şu¡”
.
	`g‘In¡ªûName
());

99 
´İ”t›s
.
	`£tPrİ”ty
("accumulo.columnFamily", "family");

100 
´İ”t›s
.
	`£tPrİ”ty
("accumulo.username", "ycsb");

101 
´İ”t›s
.
	`£tPrİ”ty
("accumulo.password", "protectyaneck");

103 
´İ”t›s
.
	`£tPrİ”ty
("accumulo.batchWriterMaxLatency", "4");

105 
´İ”t›s
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, CÜeWÜklßd.
TABLENAME_PROPERTY_DEFAULT
);

106 
´İ”t›s
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
, CÜeWÜklßd.
FIELD_COUNT_PROPERTY_DEFAULT
);

107 
´İ”t›s
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
INSERT_ORDER_PROPERTY
, "ordered");

108 
	}
}

110 @
Aá”CÏss


111 
public
 
	$şu¡”CËªup
(è
throws
 
Exû±iÚ
 {

112 ià(
şu¡”
 !ğ
nuÎ
) {

113 
LOG
.
	`debug
("shutting down minicluster");

114 
şu¡”
.
	`¡İ
();

115 
şu¡”
 = 
nuÎ
;

117 
	}
}

119 @
BefÜe


120 
public
 
	$ş›Á
(è
throws
 
Exû±iÚ
 {

122 
LOG
.
	`debug
("Lßdšg wÜklßd…rİ”t› fÜ {}", 
‹¡
.
	`g‘M‘hodName
());

123 
wÜklßdPrİs
 = 
Ãw
 
	`Prİ”t›s
();

124 
wÜklßdPrİs
.
	`lßd
(
	`g‘CÏss
().
	`g‘ResourûAsSŒ—m
("/wÜklßds/" + 
‹¡
.
	`g‘M‘hodName
()));

126 
SŒšg
 
´İ
 : 
´İ”t›s
.
	`¡ršgPrİ”tyNames
()) {

127 
wÜklßdPrİs
.
	`£tPrİ”ty
(
´İ
, 
´İ”t›s
.
	`g‘Prİ”ty
(prop));

131 
LOG
.
	`debug
("initializing measurements‡nd workload");

132 
M—su»m’ts
.
	`£tPrİ”t›s
(
wÜklßdPrİs
);

133 
wÜklßd
 = 
Ãw
 
	`CÜeWÜklßd
();

134 
wÜklßd
.
	`š™
(
wÜklßdPrİs
);

136 
LOG
.
	`debug
("initializing client");

137 
ş›Á
 = 
Ãw
 
	`AccumuloCl›Á
();

138 
ş›Á
.
	`£tPrİ”t›s
(
wÜklßdPrİs
);

139 
ş›Á
.
	`š™
();

140 
	}
}

142 @
Aá”


143 
public
 
	$ş—nup
(è
throws
 
Exû±iÚ
 {

144 ià(
ş›Á
 !ğ
nuÎ
) {

145 
LOG
.
	`debug
("cleaning up client");

146 
ş›Á
.
	`ş—nup
();

147 
ş›Á
 = 
nuÎ
;

149 ià(
wÜklßd
 !ğ
nuÎ
) {

150 
LOG
.
	`debug
("cleaning up workload");

151 
wÜklßd
.
	`ş—nup
();

153 
	}
}

155 @
Aá”


156 
public
 
	$Œunÿ‹TabË
(è
throws
 
Exû±iÚ
 {

157 ià(
şu¡”
 !ğ
nuÎ
) {

158 
LOG
.
	`debug
("ŒunÿtšgabË {}", 
CÜeWÜklßd
.
TABLENAME_PROPERTY_DEFAULT
);

159 
fš®
 
CÚÃùÜ
 
admš
 = 
şu¡”
.
	`g‘CÚÃùÜ
("root", "protectyaneck");

160 
admš
.
	`bËO³¿tiÚs
().
	`d–‘eRows
(
CÜeWÜklßd
.
TABLENAME_PROPERTY_DEFAULT
, 
nuÎ
,‚ull);

162 
	}
}

164 @
Te¡


165 
public
 
	$wÜklßda
(è
throws
 
Exû±iÚ
 {

166 
	`runWÜklßd
();

167 
	}
}

169 @
Te¡


170 
public
 
	$wÜklßdb
(è
throws
 
Exû±iÚ
 {

171 
	`runWÜklßd
();

172 
	}
}

174 @
Te¡


175 
public
 
	$wÜklßdc
(è
throws
 
Exû±iÚ
 {

176 
	`runWÜklßd
();

177 
	}
}

179 @
Te¡


180 
public
 
	$wÜklßdd
(è
throws
 
Exû±iÚ
 {

181 
	`runWÜklßd
();

182 
	}
}

184 @
Te¡


185 
public
 
	$wÜklßde
(è
throws
 
Exû±iÚ
 {

186 
	`runWÜklßd
();

187 
	}
}

197 
´iv©e
 
	$runWÜklßd
(è
throws
 
Exû±iÚ
 {

198 
fš®
 
Objeù
 
¡©e
 = 
wÜklßd
.
	`š™Th»ad
(
wÜklßdPrİs
,0,0);

199 
LOG
.
	`debug
("load");

200 
i
 = 0; i < 
INSERT_COUNT
; i++) {

201 
	`as£¹True
("š£¹ faed.", 
wÜklßd
.
	`doIn£¹
(
ş›Á
, 
¡©e
));

205 
Th»ad
.
	`¦“p
(2000);

206 
LOG
.
	`debug
("verify‚umber of cells");

207 
fš®
 
SÿÂ”
 
sÿÂ”
 = 
şu¡”
.
	`g‘CÚÃùÜ
("roÙ", "´Ùeùyªeck").
	`ü—‹SÿÂ”
(
CÜeWÜklßd
.
TABLENAME_PROPERTY_DEFAULT
, 
AuthÜiz©iÚs
.
EMPTY
);

208 
couÁ
 = 0;

209 
EÁry
<
Key
, 
V®ue
> 
’Œy
 : 
sÿÂ”
) {

210 
couÁ
++;

212 
	`as£¹Equ®s
("Didn'ˆg‘ƒnoughÙ® c–ls.", (
IÁeg”
.
	`v®ueOf
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY_DEFAULT
è* 
INSERT_COUNT
), 
couÁ
);

213 
LOG
.
	`debug
("run");

214 
i
 = 0; i < 
TRANSACTION_COUNT
; i++) {

215 
	`as£¹True
("Œª§ùiÚ faed.", 
wÜklßd
.
	`doT¿n§ùiÚ
(
ş›Á
, 
¡©e
));

217 
	}
}

	@aerospike/src/main/java/site/ycsb/db/AerospikeClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gcom
.
	g«ro¥ike
.
	gş›Á
.
	gA”o¥ikeExû±iÚ
;

21 
impÜt
 
	gcom
.
	g«ro¥ike
.
	gş›Á
.
	gBš
;

22 
impÜt
 
	gcom
.
	g«ro¥ike
.
	gş›Á
.
	gKey
;

23 
impÜt
 
	gcom
.
	g«ro¥ike
.
	gş›Á
.
	gRecÜd
;

24 
impÜt
 
	gcom
.
	g«ro¥ike
.
	gş›Á
.
	gpŞicy
.
	gCl›ÁPŞicy
;

25 
impÜt
 
	gcom
.
	g«ro¥ike
.
	gş›Á
.
	gpŞicy
.
	gPŞicy
;

26 
impÜt
 
	gcom
.
	g«ro¥ike
.
	gş›Á
.
	gpŞicy
.
	gRecÜdExi¡sAùiÚ
;

27 
impÜt
 
	gcom
.
	g«ro¥ike
.
	gş›Á
.
	gpŞicy
.
	gWr™ePŞicy
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

33 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

34 
impÜt
 
	gjava
.
	gut
.
	gM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

36 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

37 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

42 
public
 
şass
 
A”o¥ikeCl›Á
 
ex‹nds
 
	gs™e
.
	gycsb
.
	gDB
 {

43 
´iv©e
 
fš®
 
SŒšg
 
	gDEFAULT_HOST
 = "localhost";

44 
´iv©e
 
fš®
 
SŒšg
 
	gDEFAULT_PORT
 = "3000";

45 
´iv©e
 
fš®
 
SŒšg
 
	gDEFAULT_TIMEOUT
 = "10000";

46 
´iv©e
 
fš®
 
SŒšg
 
	gDEFAULT_NAMESPACE
 = "ycsb";

48 
´iv©e
 
SŒšg
 
	gÇme¥aû
 = 
nuÎ
;

50 
´iv©e
 
	gcom
.
	g«ro¥ike
.
	gş›Á
.
A”o¥ikeCl›Á
 cl›Á = 
nuÎ
;

52 
´iv©e
 
PŞicy
 
	g»adPŞicy
 = 
Ãw
 Policy();

53 
´iv©e
 
Wr™ePŞicy
 
	gš£¹PŞicy
 = 
Ãw
 WritePolicy();

54 
´iv©e
 
Wr™ePŞicy
 
	gupd©ePŞicy
 = 
Ãw
 WritePolicy();

55 
´iv©e
 
Wr™ePŞicy
 
	gd–‘ePŞicy
 = 
Ãw
 WritePolicy();

57 @
Ov”ride


58 
public
 
š™
(è
throws
 
	gDBExû±iÚ
 {

59 
	gš£¹PŞicy
.
	g»cÜdExi¡sAùiÚ
 = 
RecÜdExi¡sAùiÚ
.
CREATE_ONLY
;

60 
	gupd©ePŞicy
.
	g»cÜdExi¡sAùiÚ
 = 
RecÜdExi¡sAùiÚ
.
REPLACE_ONLY
;

62 
Prİ”t›s
 
	g´İs
 = 
g‘Prİ”t›s
();

64 
	gÇme¥aû
 = 
´İs
.
g‘Prİ”ty
("as.Çme¥aû", 
DEFAULT_NAMESPACE
);

66 
SŒšg
 
	gho¡
 = 
´İs
.
g‘Prİ”ty
("as.ho¡", 
DEFAULT_HOST
);

67 
SŒšg
 
	gu£r
 = 
´İs
.
g‘Prİ”ty
("as.user");

68 
SŒšg
 
	g·sswÜd
 = 
´İs
.
g‘Prİ”ty
("as.password");

69 
	gpÜt
 = 
IÁeg”
.
·r£IÁ
(
´İs
.
g‘Prİ”ty
("as.pÜt", 
DEFAULT_PORT
));

70 
	gtimeout
 = 
IÁeg”
.
·r£IÁ
(
´İs
.
g‘Prİ”ty
("as.timeout",

71 
DEFAULT_TIMEOUT
));

73 
	g»adPŞicy
.
	gtimeout
 = 
timeout
;

74 
	gš£¹PŞicy
.
	gtimeout
 = 
timeout
;

75 
	gupd©ePŞicy
.
	gtimeout
 = 
timeout
;

76 
	gd–‘ePŞicy
.
	gtimeout
 = 
timeout
;

78 
Cl›ÁPŞicy
 
	gş›ÁPŞicy
 = 
Ãw
 ClientPolicy();

80 ià(
	gu£r
 !ğ
nuÎ
 && 
·sswÜd
 !=‚ull) {

81 
ş›ÁPŞicy
.
u£r
 = user;

82 
	gş›ÁPŞicy
.
	g·sswÜd
 = 
·sswÜd
;

85 
	gŒy
 {

86 
	gş›Á
 =

87 
Ãw
 
com
.
«ro¥ike
.
ş›Á
.
A”o¥ikeCl›Á
(
ş›ÁPŞicy
, 
ho¡
, 
pÜt
);

88 } 
ÿtch
 (
A”o¥ikeExû±iÚ
 
e
) {

89 
throw
 
Ãw
 
DBExû±iÚ
(
SŒšg
.
fÜm©
("Error while creating Aerospike " +

90 "ş›Á fÜ %s:%d.", 
ho¡
, 
pÜt
), 
e
);

94 @
Ov”ride


95 
public
 
ş—nup
(è
throws
 
	gDBExû±iÚ
 {

96 
	gş›Á
.
şo£
();

99 @
Ov”ride


100 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

101 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

102 
	gŒy
 {

103 
RecÜd
 
	g»cÜd
;

105 ià(
	gf›lds
 !ğ
nuÎ
) {

106 
»cÜd
 = 
ş›Á
.
g‘
(
»adPŞicy
, 
Ãw
 
Key
(
Çme¥aû
, 
bË
, 
key
),

107 
f›lds
.
toA¼ay
(
Ãw
 
SŒšg
[f›lds.
size
()]));

109 
	g»cÜd
 = 
ş›Á
.
g‘
(
»adPŞicy
, 
Ãw
 
Key
(
Çme¥aû
, 
bË
, 
key
));

112 ià(
	g»cÜd
 =ğ
nuÎ
) {

113 
Sy¡em
.
”r
.
´šn
("RecÜd key " + 
key
 + "‚ot found (read)");

114  
	gStus
.
	gERROR
;

117 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gObjeù
> 
	g’Œy
: 
»cÜd
.
bšs
.
’ŒyS‘
()) {

118 
»suÉ
.
put
(
’Œy
.
g‘Key
(),

119 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
((
by‹
[])
’Œy
.
g‘V®ue
()));

122  
	gStus
.
	gOK
;

123 } 
ÿtch
 (
A”o¥ikeExû±iÚ
 
e
) {

124 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü wh»adšg key " + 
key
 + ": " + 
e
);

125  
	gStus
.
	gERROR
;

129 @
Ov”ride


130 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬t
, 
couÁ
, 
S‘
<SŒšg> 
f›lds
,

131 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

132 
	gSy¡em
.
	g”r
.
´šn
("Scan‚ot implemented");

133  
	gStus
.
	gERROR
;

136 
´iv©e
 
Stus
 
wr™e
(
SŒšg
 
bË
, SŒšg 
key
, 
Wr™ePŞicy
 
wr™ePŞicy
,

137 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

138 
	gBš
[] 
	gbšs
 = 
Ãw
 
Bš
[
v®ues
.
size
()];

139 
	gšdex
 = 0;

141 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
: 
v®ues
.
’ŒyS‘
()) {

142 
bšs
[
šdex
] = 
Ãw
 
Bš
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toA¼ay
());

143 ++
	gšdex
;

146 
Key
 
	gkeyObj
 = 
Ãw
 Key(
Çme¥aû
, 
bË
, 
key
);

148 
	gŒy
 {

149 
	gş›Á
.
put
(
wr™ePŞicy
, 
keyObj
, 
bšs
);

150  
	gStus
.
	gOK
;

151 } 
ÿtch
 (
A”o¥ikeExû±iÚ
 
e
) {

152 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü whwr™šg key " + 
key
 + ": " + 
e
);

153  
	gStus
.
	gERROR
;

157 @
Ov”ride


158 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

159 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

160  
wr™e
(
bË
, 
key
, 
upd©ePŞicy
, 
v®ues
);

163 @
Ov”ride


164 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

165 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

166  
wr™e
(
bË
, 
key
, 
š£¹PŞicy
, 
v®ues
);

169 @
Ov”ride


170 
public
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

171 
	gŒy
 {

172 ià(!
	gş›Á
.
d–‘e
(
d–‘ePŞicy
, 
Ãw
 
Key
(
Çme¥aû
, 
bË
, 
key
))) {

173 
	gSy¡em
.
	g”r
.
´šn
("RecÜd key " + 
key
 + "‚ot found (delete)");

174  
	gStus
.
	gERROR
;

177  
	gStus
.
	gOK
;

178 } 
ÿtch
 (
A”o¥ikeExû±iÚ
 
e
) {

179 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü whd–‘šg key " + 
key
 + ": " + 
e
);

180  
	gStus
.
	gERROR
;

	@aerospike/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@arangodb/src/main/java/site/ycsb/db/arangodb/ArangoDBClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g¬ªgodb
;

19 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

24 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

25 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

29 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

30 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

32 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gA¿ngoCursÜ
;

33 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gA¿ngoDB
;

34 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gA¿ngoDBExû±iÚ
;

35 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gPrÙocŞ
;

36 
impÜt
 
	gcom
.
	g¬ªgodb
.
	g’t™y
.
	gBa£Docum’t
;

37 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gmod–
.
	gDocum’tC»©eO±iÚs
;

38 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gmod–
.
	gT¿n§ùiÚO±iÚs
;

39 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gut
.
	gM­Bud”
;

40 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gv–ocy·ck
.
	gVPackBud”
;

41 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gv–ocy·ck
.
	gVPackSliû
;

42 
impÜt
 
	gcom
.
	g¬ªgodb
.
	gv–ocy·ck
.
	gV®ueTy³
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

45 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

46 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

47 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

59 
public
 cÏs 
	cA¿ngoDBCl›Á
 
ex‹nds
 
	mDB
 {

61 
´iv©e
 
Logg”
 
	mlogg”
 = 
Logg”FaùÜy
.
g‘Logg”
(
A¿ngoDBCl›Á
.
şass
);

67 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	mINIT_COUNT
 = 
Ãw
 AtomicInteger(0);

70 
´iv©e
 
A¿ngoDB
 
	m¬ªgoDB
;

71 
´iv©e
 
SŒšg
 
	md©aba£Name
 = "ycsb";

72 
´iv©e
 
SŒšg
 
	mcŞËùiÚName
;

73 
´iv©e
 
BoŞ—n
 
	mdrİDBBefÜeRun
;

74 
´iv©e
 
BoŞ—n
 
	mwa™FÜSync
 = 
çl£
;

75 
´iv©e
 
BoŞ—n
 
	mŒª§ùiÚUpd©e
 = 
çl£
;

84 @
Ov”ride


85 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

86 
	`synchrÚized
 (
A¿ngoDBCl›Á
.
şass
) {

87 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

89 
cŞËùiÚName
 = 
´İs
.
	`g‘Prİ”ty
("table", "usertable");

92 
SŒšg
 

 = 
´İs
.
	`g‘Prİ”ty
("arangodb.ip", "localhost");

93 
SŒšg
 
pÜtSŒ
 = 
´İs
.
	`g‘Prİ”ty
("arangodb.port", "8529");

94 
pÜt
 = 
IÁeg”
.
	`·r£IÁ
(
pÜtSŒ
);

97 
SŒšg
 
´ÙocŞSŒ
 = 
´İs
.
	`g‘Prİ”ty
("arangodb.protocol", "VST");

98 
PrÙocŞ
 
´ÙocŞ
 = PrÙocŞ.
	`v®ueOf
(
´ÙocŞSŒ
);

101 
SŒšg
 
drİDBBefÜeRunSŒ
 = 
´İs
.
	`g‘Prİ”ty
("arangodb.dropDBBeforeRun", "false");

102 
drİDBBefÜeRun
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
drİDBBefÜeRunSŒ
);

105 
SŒšg
 
wa™FÜSyncSŒ
 = 
´İs
.
	`g‘Prİ”ty
("arangodb.waitForSync", "false");

106 
wa™FÜSync
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
wa™FÜSyncSŒ
);

109 
SŒšg
 
Œª§ùiÚUpd©eSŒ
 = 
´İs
.
	`g‘Prİ”ty
("arangodb.transactionUpdate", "false");

110 
Œª§ùiÚUpd©e
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
Œª§ùiÚUpd©eSŒ
);

113 
Œy
 {

114 
¬ªgoDB
 = 
Ãw
 
A¿ngoDB
.
	`Bud”
().
	`ho¡
(

).
	`pÜt
(
pÜt
).
	`u£PrÙocŞ
(
´ÙocŞ
).
	`bud
();

115 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

116 
logg”
.
	`”rÜ
("FaedØš™ŸlizA¿ngoDB", 
e
);

117 
Sy¡em
.
	`ex™
(-1);

120 if(
INIT_COUNT
.
	`g‘AndInüem’t
() == 0) {

122 ià(
drİDBBefÜeRun
) {

124 
Œy
 {

125 
¬ªgoDB
.
	`db
(
d©aba£Name
).
	`drİ
();

126 } 
	`ÿtch
 (
A¿ngoDBExû±iÚ
 
e
) {

127 
logg”
.
	`šfo
("FaØd–‘DB: {}", 
d©aba£Name
);

130 
Œy
 {

131 
¬ªgoDB
.
	`ü—‹D©aba£
(
d©aba£Name
);

132 
logg”
.
	`šfo
("D©aba£ c»©ed: " + 
d©aba£Name
);

133 } 
	`ÿtch
 (
A¿ngoDBExû±iÚ
 
e
) {

134 
logg”
.
	`”rÜ
("FaedØü—‹ d©aba£: {} w™hƒx: {}", 
d©aba£Name
, 
e
.
	`toSŒšg
());

136 
Œy
 {

137 
¬ªgoDB
.
	`db
(
d©aba£Name
).
	`ü—‹CŞËùiÚ
(
cŞËùiÚName
);

138 
logg”
.
	`šfo
("CŞËùiÚ c»©ed: " + 
cŞËùiÚName
);

139 } 
	`ÿtch
 (
A¿ngoDBExû±iÚ
 
e
) {

140 
logg”
.
	`”rÜ
("FaedØü—‹ cŞËùiÚ: {} w™hƒx: {}", 
cŞËùiÚName
, 
e
.
	`toSŒšg
());

142 
logg”
.
	`šfo
("A¿ngoDB cl›Á cÚÃùiÚ c»©edØ{}:{}", 

, 
pÜt
);

145 
logg”
.
	`šfo
("Arango Configuration: dropDBBeforeRun: {};‡ddress: {}:{}; databaseName: {};"

147 
drİDBBefÜeRun
, 

, 
pÜt
, 
d©aba£Name
, 
wa™FÜSync
, 
Œª§ùiÚUpd©e
);

159 @
Ov”ride


160 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

161 ià(
INIT_COUNT
.
	`deüem’tAndG‘
() == 0) {

162 
¬ªgoDB
.
	`shutdown
();

163 
¬ªgoDB
 = 
nuÎ
;

164 
logg”
.
	`šfo
("Local cleaned up.");

166 
	}
}

182 @
Ov”ride


183 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

184 
	gŒy
 {

185 
Ba£Docum’t
 
	gtoIn£¹
 = 
Ãw
 Ba£Docum’t(
key
);

186 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

187 
toIn£¹
.
addA‰ribu‹
(
’Œy
.
g‘Key
(), 
by‹I‹¿tÜToSŒšg
ÓÁry.
g‘V®ue
()));

189 
Docum’tC»©eO±iÚs
 
	gİtiÚs
 = 
Ãw
 Docum’tC»©eO±iÚs().
wa™FÜSync
(waitForSync);

190 
	g¬ªgoDB
.
db
(
d©aba£Name
).
cŞËùiÚ
(
bË
).
š£¹Docum’t
(
toIn£¹
, 
İtiÚs
);

191  
	gStus
.
	gOK
;

192 } 
ÿtch
 (
A¿ngoDBExû±iÚ
 
e
) {

193 
	glogg”
.
”rÜ
("Exû±iÚ whŒyšg in£¹ {} {} w™hƒx {}", 
bË
, 
key
, 
e
.
toSŒšg
());

195  
	gStus
.
	gERROR
;

212 @
Ov”ride


213 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

214 
	gŒy
 {

215 
VPackSliû
 
	gdocum’t
 = 
¬ªgoDB
.
db
(
d©aba£Name
).
cŞËùiÚ
(
bË
).
g‘Docum’t
(
key
, VPackSliû.
şass
, 
nuÎ
);

216 ià(!
	gthis
.
flM­
(
»suÉ
, 
docum’t
, 
f›lds
)) {

217  
	gStus
.
	gERROR
;

219  
	gStus
.
	gOK
;

220 } 
ÿtch
 (
A¿ngoDBExû±iÚ
 
e
) {

221 
	glogg”
.
”rÜ
("Exû±iÚ whŒyšg„—d {} {} w™hƒx {}", 
bË
, 
key
, 
e
.
toSŒšg
());

223  
	gStus
.
	gERROR
;

240 @
Ov”ride


241 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

242 
	gŒy
 {

243 ià(!
	gŒª§ùiÚUpd©e
) {

244 
Ba£Docum’t
 
	gupd©eDoc
 = 
Ãw
 BaseDocument();

245 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gf›ld
 : 
v®ues
.
’ŒyS‘
()) {

246 
upd©eDoc
.
addA‰ribu‹
(
f›ld
.
g‘Key
(), 
by‹I‹¿tÜToSŒšg
(f›ld.
g‘V®ue
()));

248 
	g¬ªgoDB
.
db
(
d©aba£Name
).
cŞËùiÚ
(
bË
).
upd©eDocum’t
(
key
, 
upd©eDoc
);

249  
	gStus
.
	gOK
;

252 
SŒšg
 
	gŒª§ùiÚAùiÚ
 = "function (id) {"

256 + 
SŒšg
.
fÜm©
("db._update(id, %s,rue, false, %s);}",

257 
m­ToJsÚ
(
v®ues
), 
BoŞ—n
.
toSŒšg
(
wa™FÜSync
).
toLow”Ca£
());

258 
T¿n§ùiÚO±iÚs
 
	gİtiÚs
 = 
Ãw
 TransactionOptions();

259 
	gİtiÚs
.
wr™eCŞËùiÚs
(
bË
);

260 
	gİtiÚs
.
·¿ms
(
ü—‹Docum’tHªdË
(
bË
, 
key
));

261 
	g¬ªgoDB
.
db
(
d©aba£Name
).
Œª§ùiÚ
(
Œª§ùiÚAùiÚ
, 
Void
.
şass
, 
İtiÚs
);

262  
	gStus
.
	gOK
;

264 } 
ÿtch
 (
A¿ngoDBExû±iÚ
 
e
) {

265 
	glogg”
.
”rÜ
("Exû±iÚ whŒyšg upd©{} {} w™hƒx {}", 
bË
, 
key
, 
e
.
toSŒšg
());

267  
	gStus
.
	gERROR
;

280 @
Ov”ride


281 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

282 
Œy
 {

283 
¬ªgoDB
.
	`db
(
d©aba£Name
).
	`cŞËùiÚ
(
bË
).
	`d–‘eDocum’t
(
key
);

284  
Stus
.
OK
;

285 } 
	`ÿtch
 (
A¿ngoDBExû±iÚ
 
e
) {

286 
logg”
.
	`”rÜ
("Exû±iÚ whŒyšg d–‘{} {} w™hƒx {}", 
bË
, 
key
, 
e
.
	`toSŒšg
());

288  
Stus
.
ERROR
;

289 
	}
}

309 @
Ov”ride


310 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

311 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

312 
	gA¿ngoCursÜ
<
	gVPackSliû
> 
	gcursÜ
 = 
nuÎ
;

313 
	gŒy
 {

314 
SŒšg
 
	gaqlQu”y
 = SŒšg.
fÜm©
(

315 "FOR¬g‘ IN % FILTER¬g‘._key >ğ@key SORT¬g‘._key ASC LIMIT %d RETURN % ", 
bË
,

316 
»cÜdcouÁ
, 
cÚ¡ruùR‘uºFÜAQL
(
f›lds
, "target"));

318 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gbšdV¬s
 = 
Ãw
 
M­Bud”
().
put
("key", 
¡¬tkey
).
g‘
();

319 
	gcursÜ
 = 
¬ªgoDB
.
db
(
d©aba£Name
).
qu”y
(
aqlQu”y
, 
bšdV¬s
, 
nuÎ
, 
VPackSliû
.
şass
);

320 
	gcursÜ
.
hasNext
()) {

321 
VPackSliû
 
	gaDocum’t
 = 
cursÜ
.
Ãxt
();

322 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gaM­
 = 
Ãw
 
HashM­
<
SŒšg
, By‹I‹¿tÜ>(
	gaDocum’t
.
size
());

323 ià(!
	gthis
.
flM­
(
aM­
, 
aDocum’t
)) {

324  
	gStus
.
	gERROR
;

326 
	g»suÉ
.
add
(
aM­
);

328  
	gStus
.
	gOK
;

329 } 
ÿtch
 (
Exû±iÚ
 
e
) {

330 
	glogg”
.
”rÜ
("Exû±iÚ whŒyšg sÿÀ{} {} {} w™hƒx {}", 
bË
, 
¡¬tkey
, 
»cÜdcouÁ
, 
e
.
toSŒšg
());

331 } 
	gfš®ly
 {

332 ià(
	gcursÜ
 !ğ
nuÎ
) {

333 
Œy
 {

334 
cursÜ
.
şo£
();

335 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

336 
	glogg”
.
”rÜ
("FaØşo£ cursÜ", 
e
);

340  
	gStus
.
	gERROR
;

343 
´iv©e
 
SŒšg
 
	$ü—‹Docum’tHªdË
(
SŒšg
 
cŞËùiÚ
, SŒšg 
docum’tKey
è
throws
 
A¿ngoDBExû±iÚ
 {

344 
	`v®id©eCŞËùiÚName
(
cŞËùiÚ
);

345  
cŞËùiÚ
 + "/" + 
docum’tKey
;

346 
	}
}

348 
´iv©e
 
	$v®id©eCŞËùiÚName
(
SŒšg
 
Çme
è
throws
 
A¿ngoDBExû±iÚ
 {

349 ià(
Çme
.
	`šdexOf
('/') != -1) {

350 
throw
 
Ãw
 
	`A¿ngoDBExû±iÚ
("does‚ot‡llow '/' in‚ame.");

352 
	}
}

355 
´iv©e
 
SŒšg
 
cÚ¡ruùR‘uºFÜAQL
(
S‘
<SŒšg> 
f›lds
, SŒšg 
rg‘Name
) {

357 
SŒšg
 
	g»suÉDes
 = 
rg‘Name
;

358 ià(
	gf›lds
 !ğ
nuÎ
 && 
f›lds
.
size
() != 0) {

359 
SŒšgBud”
 
bud”
 = 
Ãw
 StringBuilder("{");

360 
SŒšg
 
	gf›ld
 : 
f›lds
) {

361 
bud”
.
­³nd
(
SŒšg
.
fÜm©
("\n\"%s\" : %s.%s,", 
f›ld
, 
rg‘Name
, field));

364 
	gbud”
.
£tCh¬At
(
bud”
.
Ëngth
() - 1, '\n');

365 
	gbud”
.
­³nd
("}");

366 
	g»suÉDes
 = 
bud”
.
toSŒšg
();

368  
	g»suÉDes
;

371 
´iv©e
 
boŞ—n
 
flM­
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉM­
, 
VPackSliû
 
docum’t
) {

372  
flM­
(
»suÉM­
, 
docum’t
, 
nuÎ
);

386 
´iv©e
 
boŞ—n
 
flM­
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉM­
, 
VPackSliû
 
docum’t
, 
S‘
<SŒšg> 
f›lds
) {

387 ià(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
size
() == 0) {

388 
I‹¿tÜ
<
EÁry
<
SŒšg
, 
VPackSliû
>> 
™”©Ü
 = 
docum’t
.
objeùI‹¿tÜ
(); 
	g™”©Ü
.
hasNext
();) {

389 
	gEÁry
<
	gSŒšg
, 
	gVPackSliû
> 
	gÃxt
 = 
™”©Ü
.
Ãxt
();

390 
VPackSliû
 
	gv®ue
 = 
Ãxt
.
g‘V®ue
();

391 ià(
	gv®ue
.
isSŒšg
()) {

392 
	g»suÉM­
.
put
(
Ãxt
.
g‘Key
(), 
¡ršgToBy‹I‹¿tÜ
(
v®ue
.
g‘AsSŒšg
()));

393 } ià(!
	gv®ue
.
isCu¡om
()) {

394 
	glogg”
.
”rÜ
("Error! Nothe formatƒxpected! Actually is {}",

395 
v®ue
.
g‘CÏss
().
g‘Name
());

396  
	gçl£
;

400 
SŒšg
 
	gf›ld
 : 
f›lds
) {

401 
VPackSliû
 
v®ue
 = 
docum’t
.
g‘
(
f›ld
);

402 ià(
	gv®ue
.
isSŒšg
()) {

403 
	g»suÉM­
.
put
(
f›ld
, 
¡ršgToBy‹I‹¿tÜ
(
v®ue
.
g‘AsSŒšg
()));

404 } ià(!
	gv®ue
.
isCu¡om
()) {

405 
	glogg”
.
”rÜ
("Error! Nothe formatƒxpected! Actually is {}",

406 
v®ue
.
g‘CÏss
().
g‘Name
());

407  
	gçl£
;

411  
	gŒue
;

414 
´iv©e
 
SŒšg
 
	$by‹I‹¿tÜToSŒšg
(
By‹I‹¿tÜ
 
by‹I‹r
) {

415  
Ãw
 
	`SŒšg
(
by‹I‹r
.
	`toA¼ay
());

416 
	}
}

418 
´iv©e
 
By‹I‹¿tÜ
 
	$¡ršgToBy‹I‹¿tÜ
(
SŒšg
 
cÚ‹Á
) {

419  
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
cÚ‹Á
);

420 
	}
}

422 
´iv©e
 
SŒšg
 
m­ToJsÚ
(
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

423 
VPackBud”
 
	gbud”
 = 
Ãw
 VPackBud”().
add
(
V®ueTy³
.
OBJECT
);

424 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

425 
bud”
.
add
(
’Œy
.
g‘Key
(), 
by‹I‹¿tÜToSŒšg
ÓÁry.
g‘V®ue
()));

427 
	gbud”
.
şo£
();

428  
	g¬ªgoDB
.
ut
().
de£rŸlize
(
bud”
.
¦iû
(), 
SŒšg
.
şass
);

	@arangodb/src/main/java/site/ycsb/db/arangodb/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g¬ªgodb
;

	@asynchbase/src/main/java/site/ycsb/db/AsyncHBaseClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

20 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gCh¬£t
;

21 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

22 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

26 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

27 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

29 
impÜt
 
	gÜg
.
	ghba£
.
	gasync
.
	gBy‹s
;

30 
impÜt
 
	gÜg
.
	ghba£
.
	gasync
.
	gCÚfig
;

31 
impÜt
 
	gÜg
.
	ghba£
.
	gasync
.
	gD–‘eReque¡
;

32 
impÜt
 
	gÜg
.
	ghba£
.
	gasync
.
	gG‘Reque¡
;

33 
impÜt
 
	gÜg
.
	ghba£
.
	gasync
.
	gHBa£Cl›Á
;

34 
impÜt
 
	gÜg
.
	ghba£
.
	gasync
.
	gKeyV®ue
;

35 
impÜt
 
	gÜg
.
	ghba£
.
	gasync
.
	gPutReque¡
;

36 
impÜt
 
	gÜg
.
	ghba£
.
	gasync
.
	gSÿÂ”
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY_DEFAULT
;

53 
public
 
şass
 
AsyncHBa£Cl›Á
 
ex‹nds
 
	gs™e
.
	gycsb
.
	gDB
 {

54 
public
 
fš®
 
Ch¬£t
 
	gUTF8_CHARSET
 = Ch¬£t.
fÜName
("UTF8");

55 
´iv©e
 
fš®
 
SŒšg
 
	gCLIENT_SIDE_BUFFERING_PROPERTY
 = "clientbuffering";

56 
´iv©e
 
fš®
 
SŒšg
 
	gDURABILITY_PROPERTY
 = "durability";

57 
´iv©e
 
fš®
 
SŒšg
 
	gPREFETCH_META_PROPERTY
 = "prefetchmeta";

58 
´iv©e
 
fš®
 
SŒšg
 
	gCONFIG_PROPERTY
 = "config";

59 
´iv©e
 
fš®
 
SŒšg
 
	gCOLUMN_FAMILY_PROPERTY
 = "columnfamily";

60 
´iv©e
 
fš®
 
SŒšg
 
	gJOIN_TIMEOUT_PROPERTY
 = "jointimeout";

61 
´iv©e
 
fš®
 
SŒšg
 
	gJOIN_TIMEOUT_PROPERTY_DEFAULT
 = "30000";

64 
´iv©e
 
fš®
 
Objeù
 
	gMUTEX
 = 
Ãw
 Object();

67 
´iv©e
 
	gth»adCouÁ
 = 0;

70 
´iv©e
 
HBa£Cl›Á
 
	gş›Á
;

73 
´iv©e
 
boŞ—n
 
	gdebug
 = 
çl£
;

76 
´iv©e
 
	gby‹
[] 
	gcŞumnFamyBy‹s
;

79 
´iv©e
 
SŒšg
 
	gÏ¡TabË
 = "";

80 
´iv©e
 
	gby‹
[] 
	gÏ¡TabËBy‹s
;

82 
´iv©e
 
	gjošTimeout
;

85 
´iv©e
 
boŞ—n
 
	gdu¿b™y
 = 
Œue
;

94 
´iv©e
 
boŞ—n
 
	gş›ÁSideBufãršg
 = 
çl£
;

96 @
Ov”ride


97 
public
 
š™
(è
throws
 
	gDBExû±iÚ
 {

98 ià(
g‘Prİ”t›s
().
g‘Prİ”ty
(
CLIENT_SIDE_BUFFERING_PROPERTY
, "false")

99 .
toLow”Ca£
().
equ®s
("true")) {

100 
	gş›ÁSideBufãršg
 = 
Œue
;

102 ià(
g‘Prİ”t›s
().
g‘Prİ”ty
(
DURABILITY_PROPERTY
, "true")

103 .
toLow”Ca£
().
equ®s
("false")) {

104 
	gdu¿b™y
 = 
çl£
;

106 
fš®
 
SŒšg
 
	gcŞumnFamy
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
(
COLUMN_FAMILY_PROPERTY
);

107 ià(
	gcŞumnFamy
 =ğ
nuÎ
 || 
cŞumnFamy
.
isEm±y
()) {

108 
Sy¡em
.
”r
.
´šn
("Error, must specify‡ columnfamily for HBaseable");

109 
throw
 
Ãw
 
DBExû±iÚ
("No columnfamily specified");

111 
	gcŞumnFamyBy‹s
 = 
cŞumnFamy
.
g‘By‹s
();

113 ià((
g‘Prİ”t›s
().
g‘Prİ”ty
("debug"è!ğ
nuÎ
)

114 && (
g‘Prİ”t›s
().
g‘Prİ”ty
("debug").
com·»To
("true") == 0)) {

115 
debug
 = 
Œue
;

118 
	gjošTimeout
 = 
IÁeg”
.
·r£IÁ
(
g‘Prİ”t›s
().
g‘Prİ”ty
(

119 
JOIN_TIMEOUT_PROPERTY
, 
JOIN_TIMEOUT_PROPERTY_DEFAULT
));

121 
fš®
 
boŞ—n
 
	g´eãtchM‘a
 = 
g‘Prİ”t›s
()

122 .
g‘Prİ”ty
(
PREFETCH_META_PROPERTY
, "false")

123 .
toLow”Ca£
().
equ®s
("Œue"è? 
	gŒue
 : 
çl£
;

124 
	gŒy
 {

125 
synchrÚized
 (
MUTEX
) {

126 ++
	gth»adCouÁ
;

127 ià(
	gş›Á
 =ğ
nuÎ
) {

128 
fš®
 
SŒšg
 
cÚfigP©h
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
(
CONFIG_PROPERTY
);

129 
fš®
 
CÚfig
 
	gcÚfig
;

130 ià(
	gcÚfigP©h
 =ğ
nuÎ
 || 
cÚfigP©h
.
isEm±y
()) {

131 
cÚfig
 = 
Ãw
 
CÚfig
();

132 
fš®
 
	gI‹¿tÜ
<
	gEÁry
<
	gObjeù
, Objeù>> 
	g™”©Ü
 = 
g‘Prİ”t›s
()

133 .
’ŒyS‘
().
™”©Ü
();

134 
	g™”©Ü
.
hasNext
()) {

135 
fš®
 
	gEÁry
<
	gObjeù
, Objeù> 
	g´İ”ty
 = 
™”©Ü
.
Ãxt
();

136 
	gcÚfig
.
ov”rideCÚfig
((
SŒšg
)
´İ”ty
.
g‘Key
(),

137 (
SŒšg
)
´İ”ty
.
g‘V®ue
());

140 
	gcÚfig
 = 
Ãw
 
CÚfig
(
cÚfigP©h
);

142 
	gş›Á
 = 
Ãw
 
HBa£Cl›Á
(
cÚfig
);

147 
SŒšg
 
	gbË
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

148 
	gŒy
 {

149 
	gş›Á
.
’su»TabËExi¡s
(
bË
).
još
(
jošTimeout
);

150 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e1
) {

151 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

152 } 
ÿtch
 (
Exû±iÚ
 
e
) {

153 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

156 ià(
	g´eãtchM‘a
) {

157 
	gŒy
 {

158 ià(
	gdebug
) {

159 
	gSy¡em
.
	gout
.
´šn
("S¹šg m‘¨´eãtch fÜabË " + 
bË
);

161 
	gş›Á
.
´eãtchM‘a
(
bË
).
još
(
jošTimeout
);

162 ià(
	gdebug
) {

163 
	gSy¡em
.
	gout
.
´šn
("Com¶‘ed m‘¨´eãtch fÜabË " + 
bË
);

165 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

166 
	gSy¡em
.
	g”r
.
´šn
("Interrupted during…refetch");

167 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

168 } 
ÿtch
 (
Exû±iÚ
 
e
) {

169 
throw
 
Ãw
 
DBExû±iÚ
("Faed…»ãtch", 
e
);

174 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

175 
throw
 
Ãw
 
DBExû±iÚ
("Faed in¡ªtŸtiÚ oàş›Á", 
e
);

179 @
Ov”ride


180 
public
 
ş—nup
(è
throws
 
	gDBExû±iÚ
 {

181 
synchrÚized
 (
MUTEX
) {

182 --
	gth»adCouÁ
;

183 ià(
	gş›Á
 !ğ
nuÎ
 && 
th»adCouÁ
 < 1) {

184 
Œy
 {

185 ià(
debug
) {

186 
Sy¡em
.
out
.
´šn
("Shutting down client");

188 
	gş›Á
.
shutdown
().
jošUnš‹¼u±ibly
(
jošTimeout
);

189 } 
ÿtch
 (
Exû±iÚ
 
e
) {

190 
	gSy¡em
.
	g”r
.
´šn
("Failedo shutdownhe AsyncHBase client "

191 + "´İ”ly: " + 
e
.
g‘Mes§ge
());

193 
	gş›Á
 = 
nuÎ
;

198 @
Ov”ride


199 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

200 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

201 
£tTabË
(
bË
);

203 
fš®
 
G‘Reque¡
 
	gg‘
 = 
Ãw
 GetRequest(

204 
Ï¡TabËBy‹s
, 
key
.
g‘By‹s
(), 
cŞumnFamyBy‹s
);

205 ià(
	gf›lds
 !ğ
nuÎ
) {

206 
g‘
.
qu®if›rs
(
g‘Qu®if›rLi¡
(
f›lds
));

209 
	gŒy
 {

210 ià(
	gdebug
) {

211 
	gSy¡em
.
	gout
.
´šn
("Doing„ead from HBase columnfamily " +

212 
By‹s
.
´‘ty
(
cŞumnFamyBy‹s
));

213 
	gSy¡em
.
	gout
.
´šn
("Došg„—d fÜ key: " + 
key
);

216 
fš®
 
	gA¼ayLi¡
<
	gKeyV®ue
> 
	grow
 = 
ş›Á
.
g‘
(g‘).
još
(
jošTimeout
);

217 ià(
	grow
 =ğ
nuÎ
 || 
row
.
isEm±y
()) {

218  
Stus
.
NOT_FOUND
;

222 
fš®
 
KeyV®ue
 
	gcŞumn
 : 
row
) {

223 
»suÉ
.
put
(
Ãw
 
SŒšg
(
cŞumn
.
qu®if›r
()),

227 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
cŞumn
.
v®ue
()));

229 ià(
	gdebug
) {

230 
	gSy¡em
.
	gout
.
´šn
(

231 "ResuÉ fÜ f›ld: " + 
By‹s
.
´‘ty
(
cŞumn
.
qu®if›r
())

232 + " is: " + 
By‹s
.
´‘ty
(
cŞumn
.
v®ue
()));

235  
	gStus
.
	gOK
;

236 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

237 
	gSy¡em
.
	g”r
.
´šn
("Thread interrupted");

238 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

239 } 
ÿtch
 (
Exû±iÚ
 
e
) {

240 
	gSy¡em
.
	g”r
.
´šn
("Fau»„—dšg from„ow w™h key " + 
key
 +

241 ": " + 
e
.
g‘Mes§ge
());

242  
	gStus
.
	gERROR
;

244  
	gStus
.
	gERROR
;

247 @
Ov”ride


248 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

249 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

250 
£tTabË
(
bË
);

252 
fš®
 
SÿÂ”
 
	gsÿÂ”
 = 
ş›Á
.
ÃwSÿÂ”
(
Ï¡TabËBy‹s
);

253 
	gsÿÂ”
.
£tFamy
(
cŞumnFamyBy‹s
);

254 
	gsÿÂ”
.
£tS¹Key
(
¡¬tkey
.
g‘By‹s
(
UTF8_CHARSET
));

256 ià(
	gf›lds
 !ğ
nuÎ
) {

257 
sÿÂ”
.
£tQu®if›rs
(
g‘Qu®if›rLi¡
(
f›lds
));

261 
	gA¼ayLi¡
<A¼ayLi¡<
	gKeyV®ue
>> 
	grows
 = 
nuÎ
;

262 
	gŒy
 {

263 
	gnumResuÉs
 = 0;

264 (
	grows
 = 
sÿÂ”
.
ÃxtRows
().
još
(
jošTimeout
)è!ğ
nuÎ
) {

265 
fš®
 
A¼ayLi¡
<
KeyV®ue
> 
row
 : 
rows
) {

266 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
rowResuÉ
 =

267 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>(
	grow
.
size
());

268 
fš®
 
KeyV®ue
 
	gcŞumn
 : 
row
) {

269 
rowResuÉ
.
put
(
Ãw
 
SŒšg
(
cŞumn
.
qu®if›r
()),

273 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
cŞumn
.
v®ue
()));

274 ià(
	gdebug
) {

275 
	gSy¡em
.
	gout
.
´šn
("Got scan„esult for key: " +

276 
By‹s
.
´‘ty
(
cŞumn
.
key
()));

279 
	g»suÉ
.
add
(
rowResuÉ
);

280 
	gnumResuÉs
++;

282 ià(
	gnumResuÉs
 >ğ
»cÜdcouÁ
) {

287 
	gsÿÂ”
.
şo£
().
još
(
jošTimeout
);

288  
	gStus
.
	gOK
;

289 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

290 
	gSy¡em
.
	g”r
.
´šn
("Thread interrupted");

291 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

292 } 
ÿtch
 (
Exû±iÚ
 
e
) {

293 
	gSy¡em
.
	g”r
.
´šn
("Fau»„—dšg from„ow w™h key " + 
¡¬tkey
 +

294 ": " + 
e
.
g‘Mes§ge
());

295  
	gStus
.
	gERROR
;

298  
	gStus
.
	gERROR
;

301 @
Ov”ride


302 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

303 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

304 
£tTabË
(
bË
);

306 ià(
	gdebug
) {

307 
	gSy¡em
.
	gout
.
´šn
("S‘tšg u°puˆfÜ key: " + 
key
);

310 
fš®
 
	gby‹
[][] 
	gqu®if›rs
 = 
Ãw
 
by‹
[
v®ues
.
size
()][];

311 
fš®
 
	gby‹
[][] 
	gby‹V®ues
 = 
Ãw
 
by‹
[
v®ues
.
size
()][];

313 
	gidx
 = 0;

314 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

315 
qu®if›rs
[
idx
] = 
’Œy
.
g‘Key
().
g‘By‹s
();

316 
	gby‹V®ues
[
idx
++] = 
’Œy
.
g‘V®ue
().
toA¼ay
();

317 ià(
	gdebug
) {

318 
	gSy¡em
.
	gout
.
´šn
("Addšg f›ld/v®u" + 
’Œy
.
g‘Key
() + "/"

319 + 
By‹s
.
´‘ty
(
’Œy
.
g‘V®ue
().
toA¼ay
()) + "o…ut„equest");

323 
fš®
 
PutReque¡
 
	gput
 = 
Ãw
 PutReque¡(
Ï¡TabËBy‹s
, 
key
.
g‘By‹s
(),

324 
cŞumnFamyBy‹s
, 
qu®if›rs
, 
by‹V®ues
);

325 ià(!
	gdu¿b™y
) {

326 
	gput
.
£tDu¿bË
(
çl£
);

328 ià(!
	gş›ÁSideBufãršg
) {

329 
	gput
.
£tBufã¿bË
(
çl£
);

330 
	gŒy
 {

331 
	gş›Á
.
put
Õut).
još
(
jošTimeout
);

332 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

333 
	gSy¡em
.
	g”r
.
´šn
("Thread interrupted");

334 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

335 } 
ÿtch
 (
Exû±iÚ
 
e
) {

336 
	gSy¡em
.
	g”r
.
´šn
("Fau»„—dšg from„ow w™h key " + 
key
 +

337 ": " + 
e
.
g‘Mes§ge
());

338  
	gStus
.
	gERROR
;

343 
	gş›Á
.
put
(put);

346  
	gStus
.
	gOK
;

349 @
Ov”ride


350 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

351 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

352  
upd©e
(
bË
, 
key
, 
v®ues
);

355 @
Ov”ride


356 
public
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

357 
£tTabË
(
bË
);

359 ià(
	gdebug
) {

360 
	gSy¡em
.
	gout
.
´šn
("Došg d–‘fÜ key: " + 
key
);

363 
fš®
 
D–‘eReque¡
 
	gd–‘e
 = 
Ãw
 DeleteRequest(

364 
Ï¡TabËBy‹s
, 
key
.
g‘By‹s
(), 
cŞumnFamyBy‹s
);

365 ià(!
	gdu¿b™y
) {

366 
	gd–‘e
.
£tDu¿bË
(
çl£
);

368 ià(!
	gş›ÁSideBufãršg
) {

369 
	gd–‘e
.
£tBufã¿bË
(
çl£
);

370 
	gŒy
 {

371 
	gş›Á
.
d–‘e
(d–‘e).
još
(
jošTimeout
);

372 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

373 
	gSy¡em
.
	g”r
.
´šn
("Thread interrupted");

374 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

375 } 
ÿtch
 (
Exû±iÚ
 
e
) {

376 
	gSy¡em
.
	g”r
.
´šn
("Fau»„—dšg from„ow w™h key " + 
key
 +

377 ": " + 
e
.
g‘Mes§ge
());

378  
	gStus
.
	gERROR
;

383 
	gş›Á
.
d–‘e
(delete);

385  
	gStus
.
	gOK
;

393 
´iv©e
 
£tTabË
(
fš®
 
SŒšg
 
bË
) {

394 ià(!
	gÏ¡TabË
.
equ®s
(
bË
)) {

395 
	gÏ¡TabË
 = 
bË
;

396 
	gÏ¡TabËBy‹s
 = 
bË
.
g‘By‹s
();

405 
´iv©e
 
	gby‹
[][] 
g‘Qu®if›rLi¡
(
fš®
 
S‘
<
SŒšg
> 
f›lds
) {

406 
fš®
 
	gby‹
[][] 
	gqu®if›rs
 = 
Ãw
 
by‹
[
f›lds
.
size
()][];

407 
	gidx
 = 0;

408 
fš®
 
SŒšg
 
	gf›ld
 : 
f›lds
) {

409 
qu®if›rs
[
idx
++] = 
f›ld
.
g‘By‹s
();

411  
	gqu®if›rs
;

	@asynchbase/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@asynchbase/src/test/java/site/ycsb/db/AsyncHBaseTest.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY_DEFAULT
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹F®£
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeTrue
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gHBa£Te¡šgUt™y
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gTabËName
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gG‘
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gPut
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gTabË
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gut
.
	gBy‹s
;

40 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

41 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

42 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

43 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

44 
impÜt
 
	gÜg
.
	gjun™
.
	gIgnÜe
;

45 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

47 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

48 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

49 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

50 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

51 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

52 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

58 
public
 cÏs 
	cAsyncHBa£Te¡
 {

60 
´iv©e
 
fš®
 
SŒšg
 
	mCOLUMN_FAMILY
 = "cf";

62 
´iv©e
 
HBa£Te¡šgUt™y
 
	m‹¡šgUt
;

63 
´iv©e
 
AsyncHBa£Cl›Á
 
	mş›Á
;

64 
´iv©e
 
TabË
 
	mbË
 = 
nuÎ
;

65 
´iv©e
 
SŒšg
 
	mbËName
;

67 
´iv©e
 
boŞ—n
 
	$isWšdows
() {

68 
fš®
 
SŒšg
 
os
 = 
Sy¡em
.
	`g‘Prİ”ty
("os.name");

69  
os
.
	`¡¬tsW™h
("Windows");

77 @
BefÜeCÏss


78 
public
 
	$£tUpCÏss
(è
throws
 
Exû±iÚ
 {

81 
	`assumeTrue
(!
	`isWšdows
());

82 
‹¡šgUt
 = 
HBa£Te¡šgUt™y
.
	`ü—‹LoÿlHTU
();

83 
‹¡šgUt
.
	`¡¬tMšiClu¡”
();

84 
	}
}

89 @
Aá”CÏss


90 
public
 
	$‹¬DownCÏss
(è
throws
 
Exû±iÚ
 {

91 ià(
‹¡šgUt
 !ğ
nuÎ
) {

92 
‹¡šgUt
.
	`shutdownMšiClu¡”
();

94 
	}
}

101 @
BefÜe


102 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

103 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

104 
p
.
	`£tPrİ”ty
("cŞumnçmy", 
COLUMN_FAMILY
);

106 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

107 
fš®
 
CÜeWÜklßd
 
wÜklßd
 = 
Ãw
 
	`CÜeWÜklßd
();

108 
wÜklßd
.
	`š™
(
p
);

110 
bËName
 = 
p
.
	`g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

111 
bË
 = 
‹¡šgUt
.
	`ü—‹TabË
(
TabËName
.
	`v®ueOf
(
bËName
), 
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
));

113 
fš®
 
SŒšg
 
zkQuÜum
 = "127.0.0.1:" + 
‹¡šgUt
.
	`g‘ZkClu¡”
().
	`g‘Cl›ÁPÜt
();

114 
p
.
	`£tPrİ”ty
("hba£.zook“³r.quÜum", 
zkQuÜum
);

115 
ş›Á
 = 
Ãw
 
	`AsyncHBa£Cl›Á
();

116 
ş›Á
.
	`£tPrİ”t›s
(
p
);

117 
ş›Á
.
	`š™
();

118 
	}
}

120 @
Aá”


121 
public
 
	$‹¬Down
(è
throws
 
Exû±iÚ
 {

122 
bË
.
	`şo£
();

123 
‹¡šgUt
.
	`d–‘eTabË
(
bËName
);

124 
	}
}

126 @
Te¡


127 
public
 
	$‹¡R—d
(è
throws
 
Exû±iÚ
 {

128 
fš®
 
SŒšg
 
rowKey
 = "row1";

129 
fš®
 
Put
 
p
 = 
Ãw
 
	`Put
(
By‹s
.
	`toBy‹s
(
rowKey
));

130 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
),

131 
By‹s
.
	`toBy‹s
("column1"), Bytes.toBytes("value1"));

132 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
),

133 
By‹s
.
	`toBy‹s
("column2"), Bytes.toBytes("value2"));

134 
bË
.
	`put
(
p
);

136 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

137 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, 
rowKey
, 
nuÎ
, 
»suÉ
);

138 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

139 
	`as£¹Equ®s
(2, 
»suÉ
.
	`size
());

140 
	`as£¹Equ®s
("v®ue1", 
»suÉ
.
	`g‘
("cŞumn1").
	`toSŒšg
());

141 
	`as£¹Equ®s
("v®ue2", 
»suÉ
.
	`g‘
("cŞumn2").
	`toSŒšg
());

142 
	}
}

144 @
Te¡


145 
public
 
	$‹¡R—dMissšgRow
(è
throws
 
Exû±iÚ
 {

146 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

147 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, "Missšg„ow", 
nuÎ
, 
»suÉ
);

148 
	`as£¹Equ®s
(
Stus
.
NOT_FOUND
, 
¡©us
);

149 
	`as£¹Equ®s
(0, 
»suÉ
.
	`size
());

150 
	}
}

152 @
Te¡


153 
public
 
	$‹¡Sÿn
(è
throws
 
Exû±iÚ
 {

155 
fš®
 
SŒšg
 
cŞSŒ
 = "row_number";

156 
fš®
 
by‹
[] 
cŞ
 = 
By‹s
.
	`toBy‹s
(
cŞSŒ
);

157 
fš®
 
n
 = 10;

158 
fš®
 
Li¡
<
Put
> 
puts
 = 
Ãw
 
A¼ayLi¡
<Put>(
n
);

159 
i
 = 0; i < 
n
; i++) {

160 
fš®
 
by‹
[] 
key
 = 
By‹s
.
	`toBy‹s
(
SŒšg
.
	`fÜm©
("%05d", 
i
));

161 
fš®
 
by‹
[] 
v®ue
 = 
java
.
nio
.
By‹Bufãr
.
	`®loÿ‹
(4).
	`putIÁ
(
i
).
	`¬¿y
();

162 
fš®
 
Put
 
p
 = 
Ãw
 
	`Put
(
key
);

163 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
), 
cŞ
, 
v®ue
);

164 
puts
.
	`add
(
p
);

166 
bË
.
	`put
(
puts
);

169 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
 =

170 
Ãw
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>>();

173 
ş›Á
.
	`sÿn
(
bËName
, "00001", 5, 
nuÎ
, 
»suÉ
);

175 
	`as£¹Equ®s
(5, 
»suÉ
.
	`size
());

176 
i
 = 0; i < 5; i++) {

177 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
row
 = 
»suÉ
.
	`g‘
(
i
);

178 
	`as£¹Equ®s
(1, 
row
.
	`size
());

179 
	`as£¹True
(
row
.
	`cÚšsKey
(
cŞSŒ
));

180 
fš®
 
by‹
[] 
by‹s
 = 
row
.
	`g‘
(
cŞSŒ
).
	`toA¼ay
();

181 
fš®
 
By‹Bufãr
 
buf
 = By‹Bufãr.
	`w¿p
(
by‹s
);

182 
fš®
 
rowNum
 = 
buf
.
	`g‘IÁ
();

183 
	`as£¹Equ®s
(
i
 + 1, 
rowNum
);

185 
	}
}

187 @
Te¡


188 
public
 
	$‹¡Upd©e
(è
throws
 
Exû±iÚ
{

189 
fš®
 
SŒšg
 
key
 = "key";

190 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 HashMap<String, String>();

191 
šput
.
	`put
("column1", "value1");

192 
šput
.
	`put
("column2", "value2");

193 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`š£¹
(
bËName
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

194 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

197 
fš®
 
G‘
 
g‘
 = 
Ãw
 
	`G‘
(
By‹s
.
	`toBy‹s
(
key
));

198 
fš®
 
ResuÉ
 
»suÉ
 = 
this
.
bË
.
	`g‘
(
g‘
);

199 
	`as£¹F®£
(
»suÉ
.
	`isEm±y
());

200 
	`as£¹Equ®s
(2, 
»suÉ
.
	`size
());

201 
fš®
 
java
.
ut
.
M­
.
EÁry
<
SŒšg
, SŒšg> 
’Œy
 : 
šput
.
	`’ŒyS‘
()) {

202 
	`as£¹Equ®s
(
’Œy
.
	`g‘V®ue
(),

203 
Ãw
 
	`SŒšg
(
»suÉ
.
	`g‘V®ue
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
),

204 
By‹s
.
	`toBy‹s
(
’Œy
.
	`g‘Key
()))));

206 
	}
}

208 @
	gTe¡


209 @
IgnÜe
("Not yet implemented")

210 
public
 
	$‹¡D–‘e
() {

211 
	`ç
("Not yet implemented");

212 
	}
}

	@azurecosmos/src/main/java/site/ycsb/db/AzureCosmosClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

23 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

26 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

27 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

31 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

32 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

34 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gCÚsi¡’cyLev–
;

35 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gCosmosCl›Á
;

36 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gCosmosCl›ÁBud”
;

37 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gCosmosCÚš”
;

38 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gCosmosD©aba£
;

39 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gCosmosExû±iÚ
;

40 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gDœeùCÚÃùiÚCÚfig
;

41 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gG©ewayCÚÃùiÚCÚfig
;

42 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gThrÙšgR‘ryO±iÚs
;

43 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gmod–s
.
	gCosmosI‹mReque¡O±iÚs
;

44 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gmod–s
.
	gCosmosI‹mRe¥Ú£
;

45 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gmod–s
.
	gCosmosQu”yReque¡O±iÚs
;

46 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gmod–s
.
	gF“dRe¥Ú£
;

47 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gmod–s
.
	gP¬t™iÚKey
;

48 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gmod–s
.
	gSqlP¬am‘”
;

49 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gmod–s
.
	gSqlQu”yS³c
;

50 
impÜt
 
	gcom
.
	gazu»
.
	gcosmos
.
	gut
.
	gCosmosPagedI‹¿bË
;

51 
impÜt
 
	gcom
.
	gç¡”xml
.
	gjacksÚ
.
	gd©abšd
.
	gJsÚNode
;

52 
impÜt
 
	gcom
.
	gç¡”xml
.
	gjacksÚ
.
	gd©abšd
.
	gObjeùM­³r
;

53 
impÜt
 
	gcom
.
	gç¡”xml
.
	gjacksÚ
.
	gd©abšd
.
	gnode
.
	gObjeùNode
;

55 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

56 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

57 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

58 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

59 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

65 
public
 cÏs 
	cAzu»CosmosCl›Á
 
ex‹nds
 
	mDB
 {

67 
´Ùeùed
 
fš®
 
ObjeùM­³r
 
	mOBJECT_MAPPER
 = 
Ãw
 ObjectMapper();

70 
´iv©e
 
fš®
 
CÚsi¡’cyLev–
 
	mDEFAULT_CONSISTENCY_LEVEL
 = CÚsi¡’cyLev–.
SESSION
;

71 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_DATABASE_NAME
 = "ycsb";

72 
´iv©e
 
fš®
 
boŞ—n
 
	mDEFAULT_USE_GATEWAY
 = 
çl£
;

73 
´iv©e
 
fš®
 
boŞ—n
 
	mDEFAULT_USE_UPSERT
 = 
çl£
;

74 
´iv©e
 
fš®
 
	mDEFAULT_MAX_DEGREE_OF_PARALLELISM
 = -1;

75 
´iv©e
 
fš®
 
	mDEFAULT_MAX_BUFFERED_ITEM_COUNT
 = 0;

76 
´iv©e
 
fš®
 
	mDEFAULT_PREFERRED_PAGE_SIZE
 = -1;

77 
public
 
fš®
 
	mNUM_UPDATE_ATTEMPTS
 = 4;

78 
´iv©e
 
fš®
 
boŞ—n
 
	mDEFAULT_INCLUDE_EXCEPTION_STACK_IN_LOG
 = 
çl£
;

79 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_USER_AGENT
 = "azurecosmos-ycsb";

81 
´iv©e
 
fš®
 
Logg”
 
	mLOGGER
 = 
Logg”FaùÜy
.
g‘Logg”
(
Azu»CosmosCl›Á
.
şass
);

87 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	mINIT_COUNT
 = 
Ãw
 AtomicInteger(0);

89 
´iv©e
 
CosmosCl›Á
 
	mş›Á
;

90 
´iv©e
 
CosmosD©aba£
 
	md©aba£
;

91 
´iv©e
 
SŒšg
 
	md©aba£Name
;

92 
´iv©e
 
boŞ—n
 
	mu£Up£¹
;

93 
´iv©e
 
	mmaxDeg»eOfP¬®Ëlism
;

94 
´iv©e
 
	mmaxBufã»dI‹mCouÁ
;

95 
´iv©e
 
	m´eã¼edPageSize
;

96 
´iv©e
 
boŞ—n
 
	mšşudeExû±iÚSckInLog
;

97 
´iv©e
 
	mM­
<
	mSŒšg
, 
	mCosmosCÚš”
> 
	mcÚš”Cache
;

98 
´iv©e
 
SŒšg
 
	mu£rAg’t
;

100 @
Ov”ride


101 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

102 
INIT_COUNT
.
	`šüem’tAndG‘
();

104 
	`synchrÚized
 (
INIT_COUNT
) {

105 ià(
ş›Á
 !ğ
nuÎ
) {

108 
Œy
 {

109 
	`š™Azu»CosmosCl›Á
();

110 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

111 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

116 
´iv©e
 
	$š™Azu»CosmosCl›Á
(è
throws
 
DBExû±iÚ
 {

119 
SŒšg
 
´im¬yKey
 = 
this
.
	`g‘SŒšgPrİ”ty
("azu»cosmos.´im¬yKey", 
nuÎ
);

120 ià(
´im¬yKey
 =ğ
nuÎ
 ||…rim¬yKey.
	`isEm±y
()) {

121 
throw
 
Ãw
 
	`DBExû±iÚ
("Missing…rimary key„equiredo connectohe database.");

124 
SŒšg
 
uri
 = 
this
.
	`g‘SŒšgPrİ”ty
("azu»cosmos.uri", 
nuÎ
);

125 ià(
´im¬yKey
 =ğ
nuÎ
 ||…rim¬yKey.
	`isEm±y
()) {

126 
throw
 
Ãw
 
	`DBExû±iÚ
("Missing uri„equiredo connectohe database.");

129 
Azu»CosmosCl›Á
.
u£rAg’t
 = 
this
.
	`g‘SŒšgPrİ”ty
("azu»cosmos.u£rAg’t", 
DEFAULT_USER_AGENT
);

131 
Azu»CosmosCl›Á
.
u£Up£¹
 = 
this
.
	`g‘BoŞ—nPrİ”ty
("azu»cosmos.u£Up£¹", 
DEFAULT_USE_UPSERT
);

133 
Azu»CosmosCl›Á
.
d©aba£Name
 = 
this
.
	`g‘SŒšgPrİ”ty
("azu»cosmos.d©aba£Name", 
DEFAULT_DATABASE_NAME
);

135 
Azu»CosmosCl›Á
.
maxDeg»eOfP¬®Ëlism
 = 
this
.
	`g‘IÁPrİ”ty
("azurecosmos.maxDegreeOfParallelism",

136 
DEFAULT_MAX_DEGREE_OF_PARALLELISM
);

138 
Azu»CosmosCl›Á
.
maxBufã»dI‹mCouÁ
 = 
this
.
	`g‘IÁPrİ”ty
("azurecosmos.maxBufferedItemCount",

139 
DEFAULT_MAX_BUFFERED_ITEM_COUNT
);

141 
Azu»CosmosCl›Á
.
´eã¼edPageSize
 = 
this
.
	`g‘IÁPrİ”ty
("azurecosmos.preferredPageSize",

142 
DEFAULT_PREFERRED_PAGE_SIZE
);

144 
Azu»CosmosCl›Á
.
šşudeExû±iÚSckInLog
 = 
this
.
	`g‘BoŞ—nPrİ”ty
("azurecosmos.includeExceptionStackInLog",

145 
DEFAULT_INCLUDE_EXCEPTION_STACK_IN_LOG
);

147 
CÚsi¡’cyLev–
 
cÚsi¡’cyLev–
 = CÚsi¡’cyLev–.
	`v®ueOf
(

148 
this
.
	`g‘SŒšgPrİ”ty
("azu»cosmos.cÚsi¡’cyLev–", 
DEFAULT_CONSISTENCY_LEVEL
.
	`toSŒšg
().
	`toUµ”Ca£
()));

149 
boŞ—n
 
u£G©eway
 = 
this
.
	`g‘BoŞ—nPrİ”ty
("azu»cosmos.u£G©eway", 
DEFAULT_USE_GATEWAY
);

151 
ThrÙšgR‘ryO±iÚs
 
»ŒyO±iÚs
 = 
Ãw
 
	`ThrÙšgR‘ryO±iÚs
();

152 
maxR‘ryA‰em±sOnThrÙedReque¡s
 = 
this
.
	`g‘IÁPrİ”ty
("azurecosmos.maxRetryAttemptsOnThrottledRequests",

154 ià(
maxR‘ryA‰em±sOnThrÙedReque¡s
 != -1) {

155 
»ŒyO±iÚs
.
	`£tMaxR‘ryA‰em±sOnThrÙedReque¡s
(
maxR‘ryA‰em±sOnThrÙedReque¡s
);

159 
DœeùCÚÃùiÚCÚfig
 
dœeùCÚÃùiÚCÚfig
 = 
Ãw
 
	`DœeùCÚÃùiÚCÚfig
();

160 
dœeùMaxCÚÃùiÚsP”Endpošt
 = 
this
.
	`g‘IÁPrİ”ty
("azurecosmos.directMaxConnectionsPerEndpoint", -1);

161 ià(
dœeùMaxCÚÃùiÚsP”Endpošt
 != -1) {

162 
dœeùCÚÃùiÚCÚfig
.
	`£tMaxCÚÃùiÚsP”Endpošt
(
dœeùMaxCÚÃùiÚsP”Endpošt
);

165 
dœeùIdËCÚÃùiÚTimeoutInSecÚds
 = 
this
.
	`g‘IÁPrİ”ty
("azurecosmos.directIdleConnectionTimeoutInSeconds",

167 ià(
dœeùIdËCÚÃùiÚTimeoutInSecÚds
 != -1) {

168 
dœeùCÚÃùiÚCÚfig
.
	`£tIdËCÚÃùiÚTimeout
(
Du¿tiÚ
.
	`ofSecÚds
(
dœeùIdËCÚÃùiÚTimeoutInSecÚds
));

172 
G©ewayCÚÃùiÚCÚfig
 
g©ewayCÚÃùiÚCÚfig
 = 
Ãw
 
	`G©ewayCÚÃùiÚCÚfig
();

174 
g©ewayMaxCÚÃùiÚPoŞSize
 = 
this
.
	`g‘IÁPrİ”ty
("azurecosmos.gatewayMaxConnectionPoolSize", -1);

175 ià(
g©ewayMaxCÚÃùiÚPoŞSize
 != -1) {

176 
g©ewayCÚÃùiÚCÚfig
.
	`£tMaxCÚÃùiÚPoŞSize
(
g©ewayMaxCÚÃùiÚPoŞSize
);

179 
g©ewayIdËCÚÃùiÚTimeoutInSecÚds
 = 
this
.
	`g‘IÁPrİ”ty
("azurecosmos.gatewayIdleConnectionTimeoutInSeconds",

181 ià(
g©ewayIdËCÚÃùiÚTimeoutInSecÚds
 != -1) {

182 
g©ewayCÚÃùiÚCÚfig
.
	`£tIdËCÚÃùiÚTimeout
(
Du¿tiÚ
.
	`ofSecÚds
(
g©ewayIdËCÚÃùiÚTimeoutInSecÚds
));

185 
Œy
 {

186 
LOGGER
.
	`šfo
(

190 
uri
, 
u£G©eway
, 
cÚsi¡’cyLev–
.
	`toSŒšg
(), 
»ŒyO±iÚs
.
	`g‘MaxR‘ryA‰em±sOnThrÙedReque¡s
(),

191 
»ŒyO±iÚs
.
	`g‘MaxR‘ryWa™Time
().
	`toMlis
(è/ 1000, 
Azu»CosmosCl›Á
.
u£Up£¹
,

192 
Azu»CosmosCl›Á
.
maxDeg»eOfP¬®Ëlism
, Azu»CosmosCl›Á.
maxBufã»dI‹mCouÁ
,

193 
Azu»CosmosCl›Á
.
´eã¼edPageSize
);

195 
CosmosCl›ÁBud”
 
bud”
 = 
Ãw
 
	`CosmosCl›ÁBud”
().
	`’dpošt
(
uri
).
	`key
(
´im¬yKey
)

196 .
	`thrÙšgR‘ryO±iÚs
(
»ŒyO±iÚs
).
	`cÚsi¡’cyLev–
(
cÚsi¡’cyLev–
).
	`u£rAg’tSuffix
(
u£rAg’t
);

198 ià(
u£G©eway
) {

199 
bud”
 = bud”.
	`g©ewayMode
(
g©ewayCÚÃùiÚCÚfig
);

201 
bud”
 = bud”.
	`dœeùMode
(
dœeùCÚÃùiÚCÚfig
);

204 
Azu»CosmosCl›Á
.
ş›Á
 = 
bud”
.
	`budCl›Á
();

205 
LOGGER
.
	`šfo
("Azu» Cosmo DB cÚÃùiÚ c»©edØ{}", 
uri
);

206 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

207 ià(!
Azu»CosmosCl›Á
.
šşudeExû±iÚSckInLog
) {

208 
e
 = 
nuÎ
;

210 
throw
 
Ãw
 
	`DBExû±iÚ
("IÎeg®‡rgum’ˆ·s£d in. CheckhfÜm© oàyou¸·¿m‘”s.", 
e
);

213 
Azu»CosmosCl›Á
.
cÚš”Cache
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

216 
Œy
 {

217 
Azu»CosmosCl›Á
.
d©aba£
 = Azu»CosmosCl›Á.
ş›Á
.
	`g‘D©aba£
(
d©aba£Name
);

218 
Azu»CosmosCl›Á
.
d©aba£
.
	`»ad
();

219 } 
	`ÿtch
 (
CosmosExû±iÚ
 
e
) {

220 ià(!
Azu»CosmosCl›Á
.
šşudeExû±iÚSckInLog
) {

221 
e
 = 
nuÎ
;

223 
throw
 
Ãw
 
	`DBExû±iÚ
(

224 "Inv®id d©aba£‚am(" + 
Azu»CosmosCl›Á
.
d©aba£Name
 + "èÜ faedØ»ad d©aba£.", 
e
);

226 
	}
}

228 
´iv©e
 
SŒšg
 
	$g‘SŒšgPrİ”ty
(
SŒšg
 
´İ”tyName
, SŒšg 
deçuÉV®ue
) {

229  
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
´İ”tyName
, 
deçuÉV®ue
);

230 
	}
}

232 
´iv©e
 
boŞ—n
 
	$g‘BoŞ—nPrİ”ty
(
SŒšg
 
´İ”tyName
, 
boŞ—n
 
deçuÉV®ue
) {

233 
SŒšg
 
¡ršgV®
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
´İ”tyName
, 
nuÎ
);

234 ià(
¡ršgV®
 =ğ
nuÎ
) {

235  
deçuÉV®ue
;

237  
BoŞ—n
.
	`·r£BoŞ—n
(
¡ršgV®
);

238 
	}
}

240 
´iv©e
 
	$g‘IÁPrİ”ty
(
SŒšg
 
´İ”tyName
, 
deçuÉV®ue
) {

241 
SŒšg
 
¡ršgV®
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
´İ”tyName
, 
nuÎ
);

242 ià(
¡ršgV®
 =ğ
nuÎ
) {

243  
deçuÉV®ue
;

245 
Œy
 {

246  
IÁeg”
.
	`·r£IÁ
(
¡ršgV®
);

247 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
e
) {

248  
deçuÉV®ue
;

250 
	}
}

256 @
Ov”ride


257 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

258 
	`synchrÚized
 (
INIT_COUNT
) {

259 ià(
INIT_COUNT
.
	`deüem’tAndG‘
(è<ğ0 && 
Azu»CosmosCl›Á
.
ş›Á
 !ğ
nuÎ
) {

260 
Œy
 {

261 
Azu»CosmosCl›Á
.
ş›Á
.
	`şo£
();

262 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

263 ià(!
Azu»CosmosCl›Á
.
šşudeExû±iÚSckInLog
) {

264 
e
 = 
nuÎ
;

266 
LOGGER
.
	`”rÜ
("Could‚Ù clo£ Docum’tCl›Á", 
e
);

267 } 
fš®ly
 {

268 
Azu»CosmosCl›Á
.
ş›Á
 = 
nuÎ
;

272 
	}
}

284 @
Ov”ride


285 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

286 
	gŒy
 {

287 
CosmosCÚš”
 
	gcÚš”
 = 
Azu»CosmosCl›Á
.
cÚš”Cache
.
g‘
(
bË
);

288 ià(
	gcÚš”
 =ğ
nuÎ
) {

289 
cÚš”
 = 
Azu»CosmosCl›Á
.
d©aba£
.
g‘CÚš”
(
bË
);

290 
	gAzu»CosmosCl›Á
.
	gcÚš”Cache
.
put
(
bË
, 
cÚš”
);

293 
	gCosmosI‹mRe¥Ú£
<
	gObjeùNode
> 
	g»¥Ú£
 = 
cÚš”
.
»adI‹m
(
key
, 
Ãw
 
P¬t™iÚKey
(key), 
ObjeùNode
.
şass
);

294 
ObjeùNode
 
	gnode
 = 
»¥Ú£
.
g‘I‹m
();

295 
	gM­
<
	gSŒšg
, SŒšg> 
	g¡ršgResuÉs
 = 
Ãw
 
HashM­
<>(
node
.
size
());

296 ià(
	gf›lds
 =ğ
nuÎ
) {

297 
I‹¿tÜ
<
M­
.
EÁry
<
SŒšg
, 
JsÚNode
>> 
™”
 = 
node
.
f›lds
();

298 
	g™”
.
hasNext
()) {

299 
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
> 
	g·œ
 = 
™”
.
Ãxt
();

300 
	g¡ršgResuÉs
.
put
(
·œ
.
g‘Key
().
toSŒšg
(),…aœ.
g‘V®ue
().toString());

302 
	gSŒšgBy‹I‹¿tÜ
.
putAÎAsBy‹I‹¿tÜs
(
»suÉ
, 
¡ršgResuÉs
);

304 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
>> 
	g™”
 = 
node
.
f›lds
();

305 
	g™”
.
hasNext
()) {

306 
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
> 
	g·œ
 = 
™”
.
Ãxt
();

307 ià(
	gf›lds
.
cÚšs
(
·œ
.
g‘Key
())) {

308 
	g¡ršgResuÉs
.
put
(
·œ
.
g‘Key
().
toSŒšg
(),…aœ.
g‘V®ue
().toString());

311 
	gSŒšgBy‹I‹¿tÜ
.
putAÎAsBy‹I‹¿tÜs
(
»suÉ
, 
¡ršgResuÉs
);

313  
	gStus
.
	gOK
;

314 } 
ÿtch
 (
CosmosExû±iÚ
 
e
) {

315 
	gLOGGER
.
”rÜ
("FaedØ»ad key {} iÀcŞËùiÚ {} iÀd©aba£ {}", 
key
, 
bË
, 
Azu»CosmosCl›Á
.
d©aba£Name
,

316 
e
);

317  
	gStus
.
	gNOT_FOUND
;

334 @
Ov”ride


335 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

336 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

337 
	gŒy
 {

338 
CosmosQu”yReque¡O±iÚs
 
	gqu”yO±iÚs
 = 
Ãw
 CosmosQueryRequestOptions();

339 
	gqu”yO±iÚs
.
£tMaxDeg»eOfP¬®Ëlism
(
Azu»CosmosCl›Á
.
maxDeg»eOfP¬®Ëlism
);

340 
	gqu”yO±iÚs
.
£tMaxBufã»dI‹mCouÁ
(
Azu»CosmosCl›Á
.
maxBufã»dI‹mCouÁ
);

342 
CosmosCÚš”
 
	gcÚš”
 = 
Azu»CosmosCl›Á
.
cÚš”Cache
.
g‘
(
bË
);

343 ià(
	gcÚš”
 =ğ
nuÎ
) {

344 
cÚš”
 = 
Azu»CosmosCl›Á
.
d©aba£
.
g‘CÚš”
(
bË
);

345 
	gAzu»CosmosCl›Á
.
	gcÚš”Cache
.
put
(
bË
, 
cÚš”
);

348 
	gLi¡
<
	gSqlP¬am‘”
> 
	g·¿mLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

349 
	g·¿mLi¡
.
add
(
Ãw
 
SqlP¬am‘”
("@¡¬tkey", 
¡¬tkey
));

351 
SqlQu”yS³c
 
	gqu”yS³c
 = 
Ãw
 SqlQuerySpec(

352 
this
.
ü—‹S–eùTİ
(
f›lds
, 
»cÜdcouÁ
è+ " FROM„oÙ„ WHERE„.id >ğ@¡¬tkey", 
·¿mLi¡
);

353 
	gCosmosPagedI‹¿bË
<
	gObjeùNode
> 
	g·gedI‹¿bË
 = 
cÚš”
.
qu”yI‹ms
(
qu”yS³c
, 
qu”yO±iÚs
, 
ObjeùNode
.
şass
);

354 
	gI‹¿tÜ
<
	gF“dRe¥Ú£
<
	gObjeùNode
>> 
	g·geI‹¿tÜ
 = 
·gedI‹¿bË


355 .
™”abËByPage
(
Azu»CosmosCl›Á
.
´eã¼edPageSize
).
™”©Ü
();

356 
	g·geI‹¿tÜ
.
hasNext
()) {

357 
	gLi¡
<
	gObjeùNode
> 
	g·geDocs
 = 
·geI‹¿tÜ
.
Ãxt
().
g‘ResuÉs
();

358 
ObjeùNode
 
	gdoc
 : 
·geDocs
) {

359 
M­
<
SŒšg
, 
	gSŒšg
> 
	g¡ršgResuÉs
 = 
Ãw
 
HashM­
<>(
doc
.
size
());

360 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
>> 
	gnodeI‹¿tÜ
 = 
doc
.
f›lds
();

361 
	gnodeI‹¿tÜ
.
hasNext
()) {

362 
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
> 
	g·œ
 = 
nodeI‹¿tÜ
.
Ãxt
();

363 
	g¡ršgResuÉs
.
put
(
·œ
.
g‘Key
().
toSŒšg
(),…aœ.
g‘V®ue
().toString());

365 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gby‹ResuÉs
 = 
Ãw
 
HashM­
<>(
doc
.
size
());

366 
	gSŒšgBy‹I‹¿tÜ
.
putAÎAsBy‹I‹¿tÜs
(
by‹ResuÉs
, 
¡ršgResuÉs
);

367 
	g»suÉ
.
add
(
by‹ResuÉs
);

370  
	gStus
.
	gOK
;

371 } 
ÿtch
 (
CosmosExû±iÚ
 
e
) {

372 ià(!
	gAzu»CosmosCl›Á
.
	gšşudeExû±iÚSckInLog
) {

373 
	ge
 = 
nuÎ
;

375 
	gLOGGER
.
”rÜ
("FaedØqu”y key {} from cŞËùiÚ {} iÀd©aba£ {}", 
¡¬tkey
, 
bË
,

376 
Azu»CosmosCl›Á
.
d©aba£Name
, 
e
);

378  
	gStus
.
	gERROR
;

391 @
Ov”ride


392 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

394 
SŒšg
 
	g»adEg
 = "";

401 
	g©‹m±
 = 0;‡‰em± < 
	gNUM_UPDATE_ATTEMPTS
;‡ttempt++) {

402 
	gŒy
 {

403 
CosmosCÚš”
 
	gcÚš”
 = 
Azu»CosmosCl›Á
.
cÚš”Cache
.
g‘
(
bË
);

404 ià(
	gcÚš”
 =ğ
nuÎ
) {

405 
cÚš”
 = 
Azu»CosmosCl›Á
.
d©aba£
.
g‘CÚš”
(
bË
);

406 
	gAzu»CosmosCl›Á
.
	gcÚš”Cache
.
put
(
bË
, 
cÚš”
);

409 
	gCosmosI‹mRe¥Ú£
<
	gObjeùNode
> 
	g»¥Ú£
 = 
cÚš”
.
»adI‹m
(
key
, 
Ãw
 
P¬t™iÚKey
(key), 
ObjeùNode
.
şass
);

410 
	g»adEg
 = 
»¥Ú£
.
g‘ETag
();

411 
ObjeùNode
 
	gnode
 = 
»¥Ú£
.
g‘I‹m
();

413 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g·œ
 : 
v®ues
.
’ŒyS‘
()) {

414 
node
.
put
(
·œ
.
g‘Key
(),…aœ.
g‘V®ue
().
toSŒšg
());

417 
CosmosI‹mReque¡O±iÚs
 
	g»que¡O±iÚs
 = 
Ãw
 CosmosItemRequestOptions();

418 
	g»que¡O±iÚs
.
£tIfM©chETag
(
»adEg
);

419 
P¬t™iÚKey
 
	gpk
 = 
Ãw
 P¬t™iÚKey(
key
);

420 
	gcÚš”
.
»¶aûI‹m
(
node
, 
key
, 
pk
, 
»que¡O±iÚs
);

422  
	gStus
.
	gOK
;

423 } 
ÿtch
 (
CosmosExû±iÚ
 
e
) {

424 ià(!
	gAzu»CosmosCl›Á
.
	gšşudeExû±iÚSckInLog
) {

425 
	ge
 = 
nuÎ
;

427 
	gLOGGER
.
”rÜ
("FaedØupd©key {}ØcŞËùiÚ {} iÀd©aba£ {} oÀ©‹m± {}", 
key
, 
bË
,

428 
Azu»CosmosCl›Á
.
d©aba£Name
, 
©‹m±
, 
e
);

432  
	gStus
.
	gERROR
;

444 @
Ov”ride


445 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

446 ià(
	gLOGGER
.
isDebugEÇbËd
()) {

447 
	gLOGGER
.
debug
("In£¹ key: {} iÁØbË: {}", 
key
, 
bË
);

450 
	gŒy
 {

451 
CosmosCÚš”
 
	gcÚš”
 = 
Azu»CosmosCl›Á
.
cÚš”Cache
.
g‘
(
bË
);

452 ià(
	gcÚš”
 =ğ
nuÎ
) {

453 
cÚš”
 = 
Azu»CosmosCl›Á
.
d©aba£
.
g‘CÚš”
(
bË
);

454 
	gAzu»CosmosCl›Á
.
	gcÚš”Cache
.
put
(
bË
, 
cÚš”
);

456 
P¬t™iÚKey
 
	gpk
 = 
Ãw
 P¬t™iÚKey(
key
);

457 
ObjeùNode
 
	gnode
 = 
OBJECT_MAPPER
.
ü—‹ObjeùNode
();

459 
	gnode
.
put
("id", 
key
);

460 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g·œ
 : 
v®ues
.
’ŒyS‘
()) {

461 
node
.
put
(
·œ
.
g‘Key
(),…aœ.
g‘V®ue
().
toSŒšg
());

463 ià(
	gAzu»CosmosCl›Á
.
	gu£Up£¹
) {

464 
	gcÚš”
.
up£¹I‹m
(
node
, 
pk
, 
Ãw
 
CosmosI‹mReque¡O±iÚs
());

466 
	gcÚš”
.
ü—‹I‹m
(
node
, 
pk
, 
Ãw
 
CosmosI‹mReque¡O±iÚs
());

468  
	gStus
.
	gOK
;

469 } 
ÿtch
 (
CosmosExû±iÚ
 
e
) {

470 ià(!
	gAzu»CosmosCl›Á
.
	gšşudeExû±iÚSckInLog
) {

471 
	ge
 = 
nuÎ
;

473 
	gLOGGER
.
”rÜ
("FaedØš£¹ key {}ØcŞËùiÚ {} iÀd©aba£ {}", 
key
, 
bË
,

474 
Azu»CosmosCl›Á
.
d©aba£Name
, 
e
);

476  
	gStus
.
	gERROR
;

479 @
Ov”ride


480 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

481 ià(
LOGGER
.
	`isDebugEÇbËd
()) {

482 
LOGGER
.
	`debug
("D–‘key {} fromabË {}", 
key
, 
bË
);

484 
Œy
 {

485 
CosmosCÚš”
 
cÚš”
 = 
Azu»CosmosCl›Á
.
cÚš”Cache
.
	`g‘
(
bË
);

486 ià(
cÚš”
 =ğ
nuÎ
) {

487 
cÚš”
 = 
Azu»CosmosCl›Á
.
d©aba£
.
	`g‘CÚš”
(
bË
);

488 
Azu»CosmosCl›Á
.
cÚš”Cache
.
	`put
(
bË
, 
cÚš”
);

490 
cÚš”
.
	`d–‘eI‹m
(
key
, 
Ãw
 
	`P¬t™iÚKey
(key),‚ew 
	`CosmosI‹mReque¡O±iÚs
());

492  
Stus
.
OK
;

493 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

494 ià(!
Azu»CosmosCl›Á
.
šşudeExû±iÚSckInLog
) {

495 
e
 = 
nuÎ
;

497 
LOGGER
.
	`”rÜ
("FaedØd–‘key {} iÀcŞËùiÚ {}", 
key
, 
bË
, 
e
);

499  
Stus
.
ERROR
;

500 
	}
}

502 
´iv©e
 
SŒšg
 
ü—‹S–eùTİ
(
S‘
<SŒšg> 
f›lds
, 
tİ
) {

503 ià(
	gf›lds
 =ğ
nuÎ
) {

504  "SELECT TOP " + 
tİ
 + " * ";

506 
SŒšgBud”
 
	g»suÉ
 = 
Ãw
 SŒšgBud”("SELECT TOP ").
­³nd
(
tİ
).append(" ");

507 
	gš™L’gth
 = 
»suÉ
.
Ëngth
();

508 
SŒšg
 
	gf›ld
 : 
f›lds
) {

509 ià(
»suÉ
.
Ëngth
(è!ğ
š™L’gth
) {

510 
»suÉ
.
­³nd
(", ");

512 
	g»suÉ
.
­³nd
("r['").­³nd(
f›ld
).append("'] ");

514  
	g»suÉ
.
toSŒšg
();

	@azurecosmos/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@azuretablestorage/src/main/java/site/ycsb/db/azuretablestorage/AzureClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gazu»bË¡Üage
;

20 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gCloudStÜageAccouÁ
;

21 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gbË
.
	gCloudTabË
;

22 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gbË
.
	gCloudTabËCl›Á
;

23 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gbË
.
	gDyÇmicTabËEÁ™y
;

24 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gbË
.
	gEÁ™yPrİ”ty
;

25 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gbË
.
	gEÁ™yResŞv”
;

26 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gbË
.
	gTabËB©chO³¿tiÚ
;

27 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gbË
.
	gTabËO³¿tiÚ
;

28 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gbË
.
	gTabËQu”y
;

29 
impÜt
 
	gcom
.
	gmiüosoá
.
	gazu»
.
	g¡Üage
.
	gbË
.
	gTabËS”viûEÁ™y
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

32 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

34 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

36 
impÜt
 
	gjava
.
	gut
.
	gD©e
;

37 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

38 
impÜt
 
	gjava
.
	gut
.
	gM­
;

39 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

40 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

41 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

42 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

49 
public
 cÏs 
	cAzu»Cl›Á
 
ex‹nds
 
	mDB
 {

51 
public
 
fš®
 
SŒšg
 
	mPROTOCOL
 = "azure.protocal";

52 
public
 
fš®
 
SŒšg
 
	mPROTOCOL_DEFAULT
 = "https";

53 
public
 
fš®
 
SŒšg
 
	mTABLE_ENDPOINT
 = "azure.endpoint";

54 
public
 
fš®
 
SŒšg
 
	mACCOUNT
 = "azure.account";

55 
public
 
fš®
 
SŒšg
 
	mKEY
 = "azure.key";

56 
public
 
fš®
 
SŒšg
 
	mTABLE
 = "azure.table";

57 
public
 
fš®
 
SŒšg
 
	mTABLE_DEFAULT
 = "usertable";

58 
public
 
fš®
 
SŒšg
 
	mPARTITIONKEY
 = "azure.partitionkey";

59 
public
 
fš®
 
SŒšg
 
	mPARTITIONKEY_DEFAULT
 = "Test";

60 
public
 
fš®
 
SŒšg
 
	mBATCHSIZE
 = "azure.batchsize";

61 
public
 
fš®
 
SŒšg
 
	mBATCHSIZE_DEFAULT
 = "1";

62 
´iv©e
 
fš®
 
	mBATCHSIZE_UPPERBOUND
 = 100;

63 
´iv©e
 
fš®
 
TabËB©chO³¿tiÚ
 
	mBATCH_OPERATION
 = 
Ãw
 TableBatchOperation();

64 
´iv©e
 
SŒšg
 
	m·¹™iÚKey
;

65 
´iv©e
 
CloudStÜageAccouÁ
 
	m¡ÜageAccouÁ
 = 
nuÎ
;

66 
´iv©e
 
CloudTabËCl›Á
 
	mbËCl›Á
 = 
nuÎ
;

67 
´iv©e
 
CloudTabË
 
	mşoudTabË
 = 
nuÎ
;

68 
´iv©e
 
	mb©chSize
;

69 
´iv©e
 
	mcurIdx
 = 0;

71 @
Ov”ride


72 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

73 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

74 
SŒšg
 
´ÙocŞ
 = 
´İs
.
	`g‘Prİ”ty
(
PROTOCOL
, 
PROTOCOL_DEFAULT
);

75 ià(
´ÙocŞ
 != "https" &&…rotocol != "http") {

76 
throw
 
Ãw
 
	`DBExû±iÚ
("Protocol must be 'http' or 'https'!\n");

78 
SŒšg
 
bË
 = 
´İs
.
	`g‘Prİ”ty
(
TABLE
, 
TABLE_DEFAULT
);

79 
·¹™iÚKey
 = 
´İs
.
	`g‘Prİ”ty
(
PARTITIONKEY
, 
PARTITIONKEY_DEFAULT
);

80 
b©chSize
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
BATCHSIZE
, 
BATCHSIZE_DEFAULT
));

81 ià(
b©chSize
 < 1 || b©chSiz> 
BATCHSIZE_UPPERBOUND
) {

82 
throw
 
Ãw
 
	`DBExû±iÚ
(
SŒšg
.
	`fÜm©
("Batchsize must be between 1‡nd %d!\n",

83 
BATCHSIZE_UPPERBOUND
));

85 
SŒšg
 
accouÁ
 = 
´İs
.
	`g‘Prİ”ty
(
ACCOUNT
);

86 
SŒšg
 
key
 = 
´İs
.
	`g‘Prİ”ty
(
KEY
);

87 
SŒšg
 
bËEndPošt
 = 
´İs
.
	`g‘Prİ”ty
(
TABLE_ENDPOINT
);

88 
SŒšg
 
¡ÜageCÚÃùiÚSŒšg
 = 
	`g‘StÜageCÚÃùiÚSŒšg
(
´ÙocŞ
, 
accouÁ
, 
key
, 
bËEndPošt
);

89 
Œy
 {

90 
¡ÜageAccouÁ
 = 
CloudStÜageAccouÁ
.
	`·r£
(
¡ÜageCÚÃùiÚSŒšg
);

91 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

92 
throw
 
Ãw
 
	`DBExû±iÚ
("Could‚Ù cÚÃùØthaccouÁ.\n", 
e
);

94 
bËCl›Á
 = 
¡ÜageAccouÁ
.
	`ü—‹CloudTabËCl›Á
();

95 
Œy
 {

96 
şoudTabË
 = 
bËCl›Á
.
	`g‘TabËReã»nû
(
bË
);

97 
şoudTabË
.
	`ü—‹IfNÙExi¡s
();

98 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

99 
throw
 
Ãw
 
	`DBExû±iÚ
("Could‚Ù cÚÃùØthbË.\n", 
e
);

103 @
Ov”ride


104 
public
 
	$ş—nup
() {

105 
	}
}

107 @
Ov”ride


108 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

109 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

110 ià(
	gf›lds
 !ğ
nuÎ
) {

111  
»adSub£t
(
key
, 
f›lds
, 
»suÉ
);

113  
»adEÁ™y
(
key
, 
»suÉ
);

117 @
Ov”ride


118 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

119 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

120 
	gŒy
 {

121 
SŒšg
 
	gwh”eSŒ
 = SŒšg.
fÜm©
("(PartitionKeyƒq '%s')‡nd (RowKey ge '%s')",

122 
·¹™iÚKey
, 
¡¬tkey
);

123 
	gTabËQu”y
<
	gDyÇmicTabËEÁ™y
> 
	gsÿnQu”y
 =

124 
Ãw
 
TabËQu”y
<
DyÇmicTabËEÁ™y
>(DyÇmicTabËEÁ™y.
şass
)

125 .
wh”e
(
wh”eSŒ
).
ke
(
»cÜdcouÁ
);

126 
	gút
 = 0;

127 
DyÇmicTabËEÁ™y
 
	g’t™y
 : 
şoudTabË
.
execu‹
(
sÿnQu”y
)) {

128 
HashM­
<
SŒšg
, 
	gEÁ™yPrİ”ty
> 
	g´İ”t›s
 = 
’t™y
.
g‘Prİ”t›s
();

129 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gcur
 = 
Ãw
 
HashM­
<
SŒšg
, ByteIterator>();

130 
	gEÁry
<
	gSŒšg
, 
	gEÁ™yPrİ”ty
> 
	g’Œy
 : 
´İ”t›s
.
’ŒyS‘
()) {

131 
SŒšg
 
f›ldName
 = 
’Œy
.
g‘Key
();

132 
By‹I‹¿tÜ
 
	gf›ldV®
 = 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
’Œy
.
g‘V®ue
().
g‘V®ueAsBy‹A¼ay
());

133 ià(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
cÚšs
(
f›ldName
)) {

134 
cur
.
put
(
f›ldName
, 
f›ldV®
);

137 
	g»suÉ
.
add
(
cur
);

138 ià(++
	gút
 =ğ
»cÜdcouÁ
) {

142  
	gStus
.
	gOK
;

143 } 
ÿtch
 (
Exû±iÚ
 
e
) {

144  
	gStus
.
	gERROR
;

148 @
Ov”ride


149 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

150  
š£¹OrUpd©e
(
key
, 
v®ues
);

153 @
Ov”ride


154 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

155 ià(
	gb©chSize
 == 1) {

156  
š£¹OrUpd©e
(
key
, 
v®ues
);

158  
š£¹B©ch
(
key
, 
v®ues
);

162 @
Ov”ride


163 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

164 
Œy
 {

166 
TabËO³¿tiÚ
 
»Œ›veOp
 =

167 
TabËO³¿tiÚ
.
	`»Œ›ve
(
·¹™iÚKey
, 
key
, 
TabËS”viûEÁ™y
.
şass
);

168 
TabËS”viûEÁ™y
 
’t™y
 = 
şoudTabË
.
	`execu‹
(
»Œ›veOp
).
	`g‘ResuÉAsTy³
();

170 
TabËO³¿tiÚ
 
d–‘eOp
 = TabËO³¿tiÚ.
	`d–‘e
(
’t™y
);

171 
şoudTabË
.
	`execu‹
(
d–‘eOp
);

172  
Stus
.
OK
;

173 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

174  
Stus
.
ERROR
;

176 
	}
}

178 
´iv©e
 
SŒšg
 
	$g‘StÜageCÚÃùiÚSŒšg
(
SŒšg
 
´ÙocŞ
, SŒšg 
accouÁ
, SŒšg 
key
, SŒšg 
bËEndPošt
) {

179 
SŒšg
 
»s
 =

180 
SŒšg
.
	`fÜm©
("DefaultEndpointsProtocol=%s;AccountName=%s;AccountKey=%s",

181 
´ÙocŞ
, 
accouÁ
, 
key
);

182 ià(
bËEndPošt
 !ğ
nuÎ
) {

183 
»s
 = 
SŒšg
.
	`fÜm©
("%s;TabËEndpošt=%s",„es, 
bËEndPošt
);

185  
»s
;

186 
	}
}

191 
public
 
Stus
 
»adSub£t
(
SŒšg
 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

192 
SŒšg
 
	gwh”eSŒ
 = SŒšg.
fÜm©
("RowKeyƒq '%s'", 
key
);

194 
	gTabËQu”y
<
	gTabËS”viûEÁ™y
> 
	g´ojeùiÚQu”y
 = 
TabËQu”y
.
äom
(

195 
TabËS”viûEÁ™y
.
şass
).
wh”e
(
wh”eSŒ
).
£Ëù
(
f›lds
.
toA¼ay
(
Ãw
 
SŒšg
[0]));

197 
	gEÁ™yResŞv”
<
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
>> 
	g»sŞv”
 =

198 
Ãw
 
EÁ™yResŞv”
<
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>>() {

199 
public
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
»sŞve
(
SŒšg
 
·¹™iÚkey
, SŒšg 
rowKey
,

200 
D©e
 
timeSmp
, 
HashM­
<
SŒšg
, 
EÁ™yPrİ”ty
> 
´İ”t›s
, SŒšg 
‘ag
) {

201 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gtmp
 = 
Ãw
 
HashM­
<
SŒšg
, ByteIterator>();

202 
	gEÁry
<
	gSŒšg
, 
	gEÁ™yPrİ”ty
> 
	g’Œy
 : 
´İ”t›s
.
’ŒyS‘
()) {

203 
SŒšg
 
key
 = 
’Œy
.
g‘Key
();

204 
By‹I‹¿tÜ
 
	gv®
 = 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
’Œy
.
g‘V®ue
().
g‘V®ueAsBy‹A¼ay
());

205 
	gtmp
.
put
(
key
, 
v®
);

207  
	gtmp
;

210 
	gŒy
 {

211 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gtmp
 : 
şoudTabË
.
execu‹
(
´ojeùiÚQu”y
, 
»sŞv”
)) {

212 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
tmp
.
’ŒyS‘
()){

213 
SŒšg
 
f›ldName
 = 
’Œy
.
g‘Key
();

214 
By‹I‹¿tÜ
 
	gf›ldV®
 = 
’Œy
.
g‘V®ue
();

215 
	g»suÉ
.
put
(
f›ldName
, 
f›ldV®
);

218  
	gStus
.
	gOK
;

219 } 
ÿtch
 (
Exû±iÚ
 
e
) {

220  
	gStus
.
	gERROR
;

224 
´iv©e
 
Stus
 
»adEÁ™y
(
SŒšg
 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

225 
	gŒy
 {

227 
TabËO³¿tiÚ
 
	g»Œ›veOp
 =

228 
TabËO³¿tiÚ
.
»Œ›ve
(
·¹™iÚKey
, 
key
, 
DyÇmicTabËEÁ™y
.
şass
);

229 
DyÇmicTabËEÁ™y
 
	g’t™y
 = 
şoudTabË
.
execu‹
(
»Œ›veOp
).
g‘ResuÉAsTy³
();

230 
	gHashM­
<
	gSŒšg
, 
	gEÁ™yPrİ”ty
> 
	g´İ”t›s
 = 
’t™y
.
g‘Prİ”t›s
();

231 
	gEÁry
<
	gSŒšg
, 
	gEÁ™yPrİ”ty
> 
	g’Œy
: 
´İ”t›s
.
’ŒyS‘
()) {

232 
SŒšg
 
f›ldName
 = 
’Œy
.
g‘Key
();

233 
By‹I‹¿tÜ
 
	gf›ldV®
 = 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
’Œy
.
g‘V®ue
().
g‘V®ueAsBy‹A¼ay
());

234 
	g»suÉ
.
put
(
f›ldName
, 
f›ldV®
);

236  
	gStus
.
	gOK
;

237 } 
ÿtch
 (
Exû±iÚ
 
e
) {

238  
	gStus
.
	gERROR
;

242 
´iv©e
 
Stus
 
š£¹B©ch
(
SŒšg
 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

243 
	gHashM­
<
	gSŒšg
, 
	gEÁ™yPrİ”ty
> 
	g´İ”t›s
 = 
Ãw
 
HashM­
<
SŒšg
, EntityProperty>();

244 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

245 
SŒšg
 
f›ldName
 = 
’Œy
.
g‘Key
();

246 
	gby‹
[] 
	gf›ldV®
 = 
’Œy
.
g‘V®ue
().
toA¼ay
();

247 
	g´İ”t›s
.
put
(
f›ldName
, 
Ãw
 
EÁ™yPrİ”ty
(
f›ldV®
));

249 
DyÇmicTabËEÁ™y
 
	g’t™y
 = 
Ãw
 DyÇmicTabËEÁ™y(
·¹™iÚKey
, 
key
, 
´İ”t›s
);

250 
	gBATCH_OPERATION
.
š£¹OrR•Ïû
(
’t™y
);

251 ià(++
	gcurIdx
 =ğ
b©chSize
) {

252 
Œy
 {

253 
şoudTabË
.
execu‹
(
BATCH_OPERATION
);

254 
	gBATCH_OPERATION
.
ş—r
();

255 
	gcurIdx
 = 0;

256 } 
ÿtch
 (
Exû±iÚ
 
e
) {

257  
	gStus
.
	gERROR
;

260  
	gStus
.
	gOK
;

263 
´iv©e
 
Stus
 
š£¹OrUpd©e
(
SŒšg
 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

264 
	gHashM­
<
	gSŒšg
, 
	gEÁ™yPrİ”ty
> 
	g´İ”t›s
 = 
Ãw
 
HashM­
<
SŒšg
, EntityProperty>();

265 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

266 
SŒšg
 
f›ldName
 = 
’Œy
.
g‘Key
();

267 
	gby‹
[] 
	gf›ldV®
 = 
’Œy
.
g‘V®ue
().
toA¼ay
();

268 
	g´İ”t›s
.
put
(
f›ldName
, 
Ãw
 
EÁ™yPrİ”ty
(
f›ldV®
));

270 
DyÇmicTabËEÁ™y
 
	g’t™y
 = 
Ãw
 DyÇmicTabËEÁ™y(
·¹™iÚKey
, 
key
, 
´İ”t›s
);

271 
TabËO³¿tiÚ
 
	gš£¹OrR•Ïû
 = TabËO³¿tiÚ.
š£¹OrR•Ïû
(
’t™y
);

272 
	gŒy
 {

273 
	gşoudTabË
.
execu‹
(
š£¹OrR•Ïû
);

274  
	gStus
.
	gOK
;

275 } 
ÿtch
 (
Exû±iÚ
 
e
) {

276  
	gStus
.
	gERROR
;

	@azuretablestorage/src/main/java/site/ycsb/db/azuretablestorage/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gazu»bË¡Üage
;

	@cassandra/src/main/java/site/ycsb/db/CassandraCQLClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gClu¡”
;

21 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gCŞumnDefš™iÚs
;

22 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gCÚsi¡’cyLev–
;

23 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gHo¡
;

24 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gHo¡Di¡ªû
;

25 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gM‘ad©a
;

26 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gResuÉS‘
;

27 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gRow
;

28 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gSessiÚ
;

29 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gP»·»dS‹m’t
;

30 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gBoundS‹m’t
;

31 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gIn£¹
;

32 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gQu”yBud”
;

33 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gS–eù
;

34 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gUpd©e
;

35 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

41 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

42 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

43 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

44 
impÜt
 
	gjava
.
	gut
.
	gM­
;

45 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

46 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

47 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

48 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

49 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

50 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

52 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

53 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

54 
impÜt
 
	gÜg
.
	g¦f4j
.
	gh–³rs
.
	gMes§geFÜm©‹r
;

63 
public
 cÏs 
	cCas§nd¿CQLCl›Á
 
ex‹nds
 
	mDB
 {

65 
´iv©e
 
Logg”
 
	mlogg”
 = 
Logg”FaùÜy
.
g‘Logg”
(
Cas§nd¿CQLCl›Á
.
şass
);

67 
´iv©e
 
Clu¡”
 
	mşu¡”
 = 
nuÎ
;

68 
´iv©e
 
SessiÚ
 
	m£ssiÚ
 = 
nuÎ
;

70 
´iv©e
 
	mCÚcu¼’tM­
<
	mS‘
<
	mSŒšg
>, 
	mP»·»dS‹m’t
> 
	m»adStmts
 =

71 
Ãw
 
CÚcu¼’tHashM­
<
S‘
<
SŒšg
>, 
	mP»·»dS‹m’t
>();

72 
´iv©e
 
	mCÚcu¼’tM­
<
	mS‘
<
	mSŒšg
>, 
	mP»·»dS‹m’t
> 
	msÿnStmts
 =

73 
Ãw
 
CÚcu¼’tHashM­
<
S‘
<
SŒšg
>, 
	mP»·»dS‹m’t
>();

74 
´iv©e
 
	mCÚcu¼’tM­
<
	mS‘
<
	mSŒšg
>, 
	mP»·»dS‹m’t
> 
	mš£¹Stmts
 =

75 
Ãw
 
CÚcu¼’tHashM­
<
S‘
<
SŒšg
>, 
	mP»·»dS‹m’t
>();

76 
´iv©e
 
	mCÚcu¼’tM­
<
	mS‘
<
	mSŒšg
>, 
	mP»·»dS‹m’t
> 
	mupd©eStmts
 =

77 
Ãw
 
CÚcu¼’tHashM­
<
S‘
<
SŒšg
>, 
	mP»·»dS‹m’t
>();

78 
´iv©e
 
	mAtomicReã»nû
<
	mP»·»dS‹m’t
> 
	m»adAÎStmt
 =

79 
Ãw
 
AtomicReã»nû
<
P»·»dS‹m’t
>();

80 
´iv©e
 
	mAtomicReã»nû
<
	mP»·»dS‹m’t
> 
	msÿnAÎStmt
 =

81 
Ãw
 
AtomicReã»nû
<
P»·»dS‹m’t
>();

82 
´iv©e
 
	mAtomicReã»nû
<
	mP»·»dS‹m’t
> 
	md–‘eStmt
 =

83 
Ãw
 
AtomicReã»nû
<
P»·»dS‹m’t
>();

85 
´iv©e
 
CÚsi¡’cyLev–
 
	m»adCÚsi¡’cyLev–
 = CÚsi¡’cyLev–.
ONE
;

86 
´iv©e
 
CÚsi¡’cyLev–
 
	mwr™eCÚsi¡’cyLev–
 = CÚsi¡’cyLev–.
ONE
;

88 
public
 
fš®
 
SŒšg
 
	mYCSB_KEY
 = "y_id";

89 
public
 
fš®
 
SŒšg
 
	mKEYSPACE_PROPERTY
 = "cassandra.keyspace";

90 
public
 
fš®
 
SŒšg
 
	mKEYSPACE_PROPERTY_DEFAULT
 = "ycsb";

91 
public
 
fš®
 
SŒšg
 
	mUSERNAME_PROPERTY
 = "cassandra.username";

92 
public
 
fš®
 
SŒšg
 
	mPASSWORD_PROPERTY
 = "cassandra.password";

94 
public
 
fš®
 
SŒšg
 
	mHOSTS_PROPERTY
 = "hosts";

95 
public
 
fš®
 
SŒšg
 
	mPORT_PROPERTY
 = "port";

96 
public
 
fš®
 
SŒšg
 
	mPORT_PROPERTY_DEFAULT
 = "9042";

98 
public
 
fš®
 
SŒšg
 
	mREAD_CONSISTENCY_LEVEL_PROPERTY
 =

100 
public
 
fš®
 
SŒšg
 
	mREAD_CONSISTENCY_LEVEL_PROPERTY_DEFAULT
 = 
»adCÚsi¡’cyLev–
.
Çme
();

101 
public
 
fš®
 
SŒšg
 
	mWRITE_CONSISTENCY_LEVEL_PROPERTY
 =

103 
public
 
fš®
 
SŒšg
 
	mWRITE_CONSISTENCY_LEVEL_PROPERTY_DEFAULT
 = 
wr™eCÚsi¡’cyLev–
.
Çme
();

105 
public
 
fš®
 
SŒšg
 
	mMAX_CONNECTIONS_PROPERTY
 =

107 
public
 
fš®
 
SŒšg
 
	mCORE_CONNECTIONS_PROPERTY
 =

109 
public
 
fš®
 
SŒšg
 
	mCONNECT_TIMEOUT_MILLIS_PROPERTY
 =

111 
public
 
fš®
 
SŒšg
 
	mREAD_TIMEOUT_MILLIS_PROPERTY
 =

114 
public
 
fš®
 
SŒšg
 
	mTRACING_PROPERTY
 = "cassandra.tracing";

115 
public
 
fš®
 
SŒšg
 
	mTRACING_PROPERTY_DEFAULT
 = "false";

117 
public
 
fš®
 
SŒšg
 
	mUSE_SSL_CONNECTION
 = "cassandra.useSSL";

118 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_USE_SSL_CONNECTION
 = "false";

124 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	mINIT_COUNT
 = 
Ãw
 AtomicInteger(0);

126 
´iv©e
 
boŞ—n
 
	mdebug
 = 
çl£
;

128 
´iv©e
 
boŞ—n
 
	mŒaû
 = 
çl£
;

134 @
Ov”ride


135 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

138 
INIT_COUNT
.
	`šüem’tAndG‘
();

142 
	`synchrÚized
 (
INIT_COUNT
) {

145 ià(
şu¡”
 !ğ
nuÎ
) {

149 
Œy
 {

151 
debug
 =

152 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("debug", "false"));

153 
Œaû
 = 
BoŞ—n
.
	`v®ueOf
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
TRACING_PROPERTY
, 
TRACING_PROPERTY_DEFAULT
));

155 
SŒšg
 
ho¡
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
HOSTS_PROPERTY
);

156 ià(
ho¡
 =ğ
nuÎ
) {

157 
throw
 
Ãw
 
	`DBExû±iÚ
(
SŒšg
.
	`fÜm©
(

159 
HOSTS_PROPERTY
));

161 
SŒšg
[] 
ho¡s
 = 
ho¡
.
	`¥l™
(",");

162 
SŒšg
 
pÜt
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
PORT_PROPERTY
, 
PORT_PROPERTY_DEFAULT
);

164 
SŒšg
 
u£ºame
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
USERNAME_PROPERTY
);

165 
SŒšg
 
·sswÜd
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
PASSWORD_PROPERTY
);

167 
SŒšg
 
key¥aû
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
KEYSPACE_PROPERTY
,

168 
KEYSPACE_PROPERTY_DEFAULT
);

170 
»adCÚsi¡’cyLev–
 = 
CÚsi¡’cyLev–
.
	`v®ueOf
(

171 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
READ_CONSISTENCY_LEVEL_PROPERTY
,

172 
READ_CONSISTENCY_LEVEL_PROPERTY_DEFAULT
));

173 
wr™eCÚsi¡’cyLev–
 = 
CÚsi¡’cyLev–
.
	`v®ueOf
(

174 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
WRITE_CONSISTENCY_LEVEL_PROPERTY
,

175 
WRITE_CONSISTENCY_LEVEL_PROPERTY_DEFAULT
));

177 
BoŞ—n
 
u£SSL
 = BoŞ—n.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
USE_SSL_CONNECTION
,

178 
DEFAULT_USE_SSL_CONNECTION
));

180 ià((
u£ºame
 !ğ
nuÎ
è&& !u£ºame.
	`isEm±y
()) {

181 
Clu¡”
.
Bud”
 
şu¡”Bud”
 = Clu¡”.
	`bud”
().
	`w™hC»d’tŸls
(
u£ºame
, 
·sswÜd
)

182 .
	`w™hPÜt
(
IÁeg”
.
	`v®ueOf
(
pÜt
)).
	`addCÚùPošts
(
ho¡s
);

183 ià(
u£SSL
) {

184 
şu¡”Bud”
 = clu¡”Bud”.
	`w™hSSL
();

186 
şu¡”
 = 
şu¡”Bud”
.
	`bud
();

188 
şu¡”
 = 
Clu¡”
.
	`bud”
().
	`w™hPÜt
(
IÁeg”
.
	`v®ueOf
(
pÜt
))

189 .
	`addCÚùPošts
(
ho¡s
).
	`bud
();

192 
SŒšg
 
maxCÚÃùiÚs
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

193 
MAX_CONNECTIONS_PROPERTY
);

194 ià(
maxCÚÃùiÚs
 !ğ
nuÎ
) {

195 
şu¡”
.
	`g‘CÚfigu¿tiÚ
().
	`g‘PoŞšgO±iÚs
()

196 .
	`£tMaxCÚÃùiÚsP”Ho¡
(
Ho¡Di¡ªû
.
LOCAL
,

197 
IÁeg”
.
	`v®ueOf
(
maxCÚÃùiÚs
));

200 
SŒšg
 
cÜeCÚÃùiÚs
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

201 
CORE_CONNECTIONS_PROPERTY
);

202 ià(
cÜeCÚÃùiÚs
 !ğ
nuÎ
) {

203 
şu¡”
.
	`g‘CÚfigu¿tiÚ
().
	`g‘PoŞšgO±iÚs
()

204 .
	`£tCÜeCÚÃùiÚsP”Ho¡
(
Ho¡Di¡ªû
.
LOCAL
,

205 
IÁeg”
.
	`v®ueOf
(
cÜeCÚÃùiÚs
));

208 
SŒšg
 
cÚÃùTimoutMlis
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

209 
CONNECT_TIMEOUT_MILLIS_PROPERTY
);

210 ià(
cÚÃùTimoutMlis
 !ğ
nuÎ
) {

211 
şu¡”
.
	`g‘CÚfigu¿tiÚ
().
	`g‘Sock‘O±iÚs
()

212 .
	`£tCÚÃùTimeoutMlis
(
IÁeg”
.
	`v®ueOf
(
cÚÃùTimoutMlis
));

215 
SŒšg
 
»adTimoutMlis
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

216 
READ_TIMEOUT_MILLIS_PROPERTY
);

217 ià(
»adTimoutMlis
 !ğ
nuÎ
) {

218 
şu¡”
.
	`g‘CÚfigu¿tiÚ
().
	`g‘Sock‘O±iÚs
()

219 .
	`£tR—dTimeoutMlis
(
IÁeg”
.
	`v®ueOf
(
»adTimoutMlis
));

222 
M‘ad©a
 
m‘ad©a
 = 
şu¡”
.
	`g‘M‘ad©a
();

223 
logg”
.
	`šfo
("Connectedo cluster: {}\n",

224 
m‘ad©a
.
	`g‘Clu¡”Name
());

226 
Ho¡
 
discov”edHo¡
 : 
m‘ad©a
.
	`g‘AÎHo¡s
()) {

227 
logg”
.
	`šfo
("Datacenter: {}; Host: {}; Rack: {}\n",

228 
discov”edHo¡
.
	`g‘D©aûÁ”
(), discov”edHo¡.
	`g‘Add»ss
(),

229 
discov”edHo¡
.
	`g‘Rack
());

232 
£ssiÚ
 = 
şu¡”
.
	`cÚÃù
(
key¥aû
);

234 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

235 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

244 @
Ov”ride


245 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

246 
	`synchrÚized
 (
INIT_COUNT
) {

247 
fš®
 
curIn™CouÁ
 = 
INIT_COUNT
.
	`deüem’tAndG‘
();

248 ià(
curIn™CouÁ
 <= 0) {

249 
»adStmts
.
	`ş—r
();

250 
sÿnStmts
.
	`ş—r
();

251 
š£¹Stmts
.
	`ş—r
();

252 
upd©eStmts
.
	`ş—r
();

253 
»adAÎStmt
.
	`£t
(
nuÎ
);

254 
sÿnAÎStmt
.
	`£t
(
nuÎ
);

255 
d–‘eStmt
.
	`£t
(
nuÎ
);

256 
£ssiÚ
.
	`şo£
();

257 
şu¡”
.
	`şo£
();

258 
şu¡”
 = 
nuÎ
;

259 
£ssiÚ
 = 
nuÎ
;

261 ià(
curIn™CouÁ
 < 0) {

263 
throw
 
Ãw
 
	`DBExû±iÚ
(

264 
SŒšg
.
	`fÜm©
("š™CouÁ i Ãg©ive: %d", 
curIn™CouÁ
));

267 
	}
}

283 @
Ov”ride


284 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

285 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

286 
	gŒy
 {

287 
P»·»dS‹m’t
 
	g¡mt
 = (
f›lds
 =ğ
nuÎ
è? 
»adAÎStmt
.
g‘
(è: 
»adStmts
.get(fields);

290 ià(
	g¡mt
 =ğ
nuÎ
) {

291 
S–eù
.
Bud”
 
£ËùBud”
;

293 ià(
	gf›lds
 =ğ
nuÎ
) {

294 
£ËùBud”
 = 
Qu”yBud”
.
£Ëù
().
®l
();

296 
	g£ËùBud”
 = 
Qu”yBud”
.
£Ëù
();

297 
SŒšg
 
	gcŞ
 : 
f›lds
) {

298 ((
S–eù
.
S–eùiÚ
è
£ËùBud”
).
cŞumn
(
cŞ
);

302 
	g¡mt
 = 
£ssiÚ
.
´•¬e
(
£ËùBud”
.
äom
(
bË
)

303 .
wh”e
(
Qu”yBud”
.
eq
(
YCSB_KEY
, Qu”yBud”.
bšdM¬k”
()))

304 .
lim™
(1));

305 
	g¡mt
.
£tCÚsi¡’cyLev–
(
»adCÚsi¡’cyLev–
);

306 ià(
	gŒaû
) {

307 
	g¡mt
.
’abËT¿cšg
();

310 
P»·»dS‹m’t
 
	g´evStmt
 = (
f›lds
 =ğ
nuÎ
) ?

311 
»adAÎStmt
.
g‘AndS‘
(
¡mt
) :

312 
»adStmts
.
putIfAb£Á
(
Ãw
 
HashS‘
(
f›lds
), 
¡mt
);

313 ià(
	g´evStmt
 !ğ
nuÎ
) {

314 
¡mt
 = 
´evStmt
;

318 
	glogg”
.
debug
(
¡mt
.
g‘Qu”ySŒšg
());

319 
	glogg”
.
debug
("key = {}", 
key
);

321 
ResuÉS‘
 
	grs
 = 
£ssiÚ
.
execu‹
(
¡mt
.
bšd
(
key
));

323 ià(
	grs
.
isExhau¡ed
()) {

324  
	gStus
.
	gNOT_FOUND
;

328 
Row
 
	grow
 = 
rs
.
Úe
();

329 
CŞumnDefš™iÚs
 
	gcd
 = 
row
.
g‘CŞumnDefš™iÚs
();

331 
	gCŞumnDefš™iÚs
.
Defš™iÚ
 
	gdef
 : 
cd
) {

332 
By‹Bufãr
 
v®
 = 
row
.
g‘By‹sUn§ã
(
def
.
g‘Name
());

333 ià(
	gv®
 !ğ
nuÎ
) {

334 
»suÉ
.
put
(
def
.
g‘Name
(), 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
v®
.
¬¿y
()));

336 
	g»suÉ
.
put
(
def
.
g‘Name
(), 
nuÎ
);

340  
	gStus
.
	gOK
;

342 } 
ÿtch
 (
Exû±iÚ
 
e
) {

343 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü„—dšg key: {}", 
key
).
g‘Mes§ge
(), 
e
);

344  
	gStus
.
	gERROR
;

369 @
Ov”ride


370 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

371 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

373 
	gŒy
 {

374 
P»·»dS‹m’t
 
	g¡mt
 = (
f›lds
 =ğ
nuÎ
è? 
sÿnAÎStmt
.
g‘
(è: 
sÿnStmts
.get(fields);

377 ià(
	g¡mt
 =ğ
nuÎ
) {

378 
S–eù
.
Bud”
 
£ËùBud”
;

380 ià(
	gf›lds
 =ğ
nuÎ
) {

381 
£ËùBud”
 = 
Qu”yBud”
.
£Ëù
().
®l
();

383 
	g£ËùBud”
 = 
Qu”yBud”
.
£Ëù
();

384 
SŒšg
 
	gcŞ
 : 
f›lds
) {

385 ((
S–eù
.
S–eùiÚ
è
£ËùBud”
).
cŞumn
(
cŞ
);

389 
S–eù
 
	g£ËùStmt
 = 
£ËùBud”
.
äom
(
bË
);

393 
SŒšg
 
	gš™ŸlStmt
 = 
£ËùStmt
.
toSŒšg
();

394 
SŒšgBud”
 
	gsÿnStmt
 = 
Ãw
 StringBuilder();

395 
	gsÿnStmt
.
­³nd
(
š™ŸlStmt
.
sub¡ršg
(0, in™ŸlStmt.
Ëngth
() - 1));

396 
	gsÿnStmt
.
­³nd
(" WHERE ");

397 
	gsÿnStmt
.
­³nd
(
Qu”yBud”
.
tok’
(
YCSB_KEY
));

398 
	gsÿnStmt
.
­³nd
(" >= ");

399 
	gsÿnStmt
.
­³nd
("token(");

400 
	gsÿnStmt
.
­³nd
(
Qu”yBud”
.
bšdM¬k”
());

401 
	gsÿnStmt
.
­³nd
(")");

402 
	gsÿnStmt
.
­³nd
(" LIMIT ");

403 
	gsÿnStmt
.
­³nd
(
Qu”yBud”
.
bšdM¬k”
());

405 
	g¡mt
 = 
£ssiÚ
.
´•¬e
(
sÿnStmt
.
toSŒšg
());

406 
	g¡mt
.
£tCÚsi¡’cyLev–
(
»adCÚsi¡’cyLev–
);

407 ià(
	gŒaû
) {

408 
	g¡mt
.
’abËT¿cšg
();

411 
P»·»dS‹m’t
 
	g´evStmt
 = (
f›lds
 =ğ
nuÎ
) ?

412 
sÿnAÎStmt
.
g‘AndS‘
(
¡mt
) :

413 
sÿnStmts
.
putIfAb£Á
(
Ãw
 
HashS‘
(
f›lds
), 
¡mt
);

414 ià(
	g´evStmt
 !ğ
nuÎ
) {

415 
¡mt
 = 
´evStmt
;

419 
	glogg”
.
debug
(
¡mt
.
g‘Qu”ySŒšg
());

420 
	glogg”
.
debug
("¡¬tKey = {},„ecÜdcouÁ = {}", 
¡¬tkey
, 
»cÜdcouÁ
);

422 
ResuÉS‘
 
	grs
 = 
£ssiÚ
.
execu‹
(
¡mt
.
bšd
(
¡¬tkey
, 
IÁeg”
.
v®ueOf
(
»cÜdcouÁ
)));

424 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gtu¶e
;

425 !
	grs
.
isExhau¡ed
()) {

426 
Row
 
	grow
 = 
rs
.
Úe
();

427 
	gtu¶e
 = 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

429 
CŞumnDefš™iÚs
 
	gcd
 = 
row
.
g‘CŞumnDefš™iÚs
();

431 
	gCŞumnDefš™iÚs
.
Defš™iÚ
 
	gdef
 : 
cd
) {

432 
By‹Bufãr
 
v®
 = 
row
.
g‘By‹sUn§ã
(
def
.
g‘Name
());

433 ià(
	gv®
 !ğ
nuÎ
) {

434 
tu¶e
.
put
(
def
.
g‘Name
(), 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
v®
.
¬¿y
()));

436 
	gtu¶e
.
put
(
def
.
g‘Name
(), 
nuÎ
);

440 
	g»suÉ
.
add
(
tu¶e
);

443  
	gStus
.
	gOK
;

445 } 
ÿtch
 (
Exû±iÚ
 
e
) {

446 
	glogg”
.
”rÜ
(

447 
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü sÿÂšg w™h s¹key: {}", 
¡¬tkey
).
g‘Mes§ge
(), 
e
);

448  
	gStus
.
	gERROR
;

466 @
Ov”ride


467 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

469 
	gŒy
 {

470 
	gS‘
<
	gSŒšg
> 
	gf›lds
 = 
v®ues
.
keyS‘
();

471 
P»·»dS‹m’t
 
	g¡mt
 = 
upd©eStmts
.
g‘
(
f›lds
);

474 ià(
	g¡mt
 =ğ
nuÎ
) {

475 
Upd©e
 
upd©eStmt
 = 
Qu”yBud”
.
upd©e
(
bË
);

478 
SŒšg
 
	gf›ld
 : 
f›lds
) {

479 
upd©eStmt
.
w™h
(
Qu”yBud”
.
£t
(
f›ld
, Qu”yBud”.
bšdM¬k”
()));

483 
	gupd©eStmt
.
wh”e
(
Qu”yBud”
.
eq
(
YCSB_KEY
, Qu”yBud”.
bšdM¬k”
()));

485 
	g¡mt
 = 
£ssiÚ
.
´•¬e
(
upd©eStmt
);

486 
	g¡mt
.
£tCÚsi¡’cyLev–
(
wr™eCÚsi¡’cyLev–
);

487 ià(
	gŒaû
) {

488 
	g¡mt
.
’abËT¿cšg
();

491 
P»·»dS‹m’t
 
	g´evStmt
 = 
upd©eStmts
.
putIfAb£Á
(
Ãw
 
HashS‘
(
f›lds
), 
¡mt
);

492 ià(
	g´evStmt
 !ğ
nuÎ
) {

493 
¡mt
 = 
´evStmt
;

497 ià(
	glogg”
.
isDebugEÇbËd
()) {

498 
	glogg”
.
debug
(
¡mt
.
g‘Qu”ySŒšg
());

499 
	glogg”
.
debug
("key = {}", 
key
);

500 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

501 
logg”
.
debug
("{} = {}", 
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

506 
CŞumnDefš™iÚs
 
	gv¬s
 = 
¡mt
.
g‘V¬ŸbËs
();

507 
BoundS‹m’t
 
	gboundStmt
 = 
¡mt
.
bšd
();

508 
	gi
 = 0; i < 
	gv¬s
.
size
() - 1; i++) {

509 
	gboundStmt
.
£tSŒšg
(
i
, 
v®ues
.
g‘
(
v¬s
.
g‘Name
(i)).
toSŒšg
());

513 
	gboundStmt
.
£tSŒšg
(
v¬s
.
size
(è- 1, 
key
);

515 
	g£ssiÚ
.
execu‹
(
boundStmt
);

517  
	gStus
.
	gOK
;

518 } 
ÿtch
 (
Exû±iÚ
 
e
) {

519 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü upd©šg key: {}", 
key
).
g‘Mes§ge
(), 
e
);

522  
	gStus
.
	gERROR
;

538 @
Ov”ride


539 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

541 
	gŒy
 {

542 
	gS‘
<
	gSŒšg
> 
	gf›lds
 = 
v®ues
.
keyS‘
();

543 
P»·»dS‹m’t
 
	g¡mt
 = 
š£¹Stmts
.
g‘
(
f›lds
);

546 ià(
	g¡mt
 =ğ
nuÎ
) {

547 
In£¹
 
š£¹Stmt
 = 
Qu”yBud”
.
š£¹IÁo
(
bË
);

550 
	gš£¹Stmt
.
v®ue
(
YCSB_KEY
, 
Qu”yBud”
.
bšdM¬k”
());

553 
SŒšg
 
	gf›ld
 : 
f›lds
) {

554 
š£¹Stmt
.
v®ue
(
f›ld
, 
Qu”yBud”
.
bšdM¬k”
());

557 
	g¡mt
 = 
£ssiÚ
.
´•¬e
(
š£¹Stmt
);

558 
	g¡mt
.
£tCÚsi¡’cyLev–
(
wr™eCÚsi¡’cyLev–
);

559 ià(
	gŒaû
) {

560 
	g¡mt
.
’abËT¿cšg
();

563 
P»·»dS‹m’t
 
	g´evStmt
 = 
š£¹Stmts
.
putIfAb£Á
(
Ãw
 
HashS‘
(
f›lds
), 
¡mt
);

564 ià(
	g´evStmt
 !ğ
nuÎ
) {

565 
¡mt
 = 
´evStmt
;

569 ià(
	glogg”
.
isDebugEÇbËd
()) {

570 
	glogg”
.
debug
(
¡mt
.
g‘Qu”ySŒšg
());

571 
	glogg”
.
debug
("key = {}", 
key
);

572 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

573 
logg”
.
debug
("{} = {}", 
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

578 
BoundS‹m’t
 
	gboundStmt
 = 
¡mt
.
bšd
().
£tSŒšg
(0, 
key
);

581 
CŞumnDefš™iÚs
 
	gv¬s
 = 
¡mt
.
g‘V¬ŸbËs
();

582 
	gi
 = 1; i < 
	gv¬s
.
size
(); i++) {

583 
	gboundStmt
.
£tSŒšg
(
i
, 
v®ues
.
g‘
(
v¬s
.
g‘Name
(i)).
toSŒšg
());

586 
	g£ssiÚ
.
execu‹
(
boundStmt
);

588  
	gStus
.
	gOK
;

589 } 
ÿtch
 (
Exû±iÚ
 
e
) {

590 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü in£¹šg key: {}", 
key
).
g‘Mes§ge
(), 
e
);

593  
	gStus
.
	gERROR
;

605 @
Ov”ride


606 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

608 
Œy
 {

609 
P»·»dS‹m’t
 
¡mt
 = 
d–‘eStmt
.
	`g‘
();

612 ià(
¡mt
 =ğ
nuÎ
) {

613 
¡mt
 = 
£ssiÚ
.
	`´•¬e
(
Qu”yBud”
.
	`d–‘e
().
	`äom
(
bË
)

614 .
	`wh”e
(
Qu”yBud”
.
	`eq
(
YCSB_KEY
, Qu”yBud”.
	`bšdM¬k”
())));

615 
¡mt
.
	`£tCÚsi¡’cyLev–
(
wr™eCÚsi¡’cyLev–
);

616 ià(
Œaû
) {

617 
¡mt
.
	`’abËT¿cšg
();

620 
P»·»dS‹m’t
 
´evStmt
 = 
d–‘eStmt
.
	`g‘AndS‘
(
¡mt
);

621 ià(
´evStmt
 !ğ
nuÎ
) {

622 
¡mt
 = 
´evStmt
;

626 
logg”
.
	`debug
(
¡mt
.
	`g‘Qu”ySŒšg
());

627 
logg”
.
	`debug
("key = {}", 
key
);

629 
£ssiÚ
.
	`execu‹
(
¡mt
.
	`bšd
(
key
));

631  
Stus
.
OK
;

632 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

633 
logg”
.
	`”rÜ
(
Mes§geFÜm©‹r
.
	`fÜm©
("E¼Ü d–‘šg key: {}", 
key
).
	`g‘Mes§ge
(), 
e
);

636  
Stus
.
ERROR
;

637 
	}
}

	@cassandra/src/main/java/site/ycsb/db/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@cassandra/src/test/java/site/ycsb/db/CassandraCQLClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”As£¹
.
	gas£¹Th©
;

21 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	ghasEÁry
;

22 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	ghasSize
;

23 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	gis
;

24 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	gnÙNuÎV®ue
;

25 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	gnuÎV®ue
;

27 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

29 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gResuÉS‘
;

30 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gRow
;

31 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gSessiÚ
;

32 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gS‹m’t
;

33 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gIn£¹
;

34 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gQu”yBud”
;

35 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gS–eù
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

42 
impÜt
 
	gÜg
.
	gÿs§nd¿un™
.
	gCas§nd¿CQLUn™
;

43 
impÜt
 
	gÜg
.
	gÿs§nd¿un™
.
	gd©a£t
.
	gcql
.
	gCÏssP©hCQLD©aS‘
;

44 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

45 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

46 
impÜt
 
	gÜg
.
	gjun™
.
	gCÏssRuË
;

47 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

49 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

50 
impÜt
 
	gjava
.
	gut
.
	gM­
;

51 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

52 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

57 
public
 cÏs 
	cCas§nd¿CQLCl›ÁTe¡
 {

59 
´iv©e
 
fš®
 
	mtimeout
 = 120000L;

61 
´iv©e
 
fš®
 
SŒšg
 
	mTABLE
 = "usertable";

62 
´iv©e
 
fš®
 
SŒšg
 
	mHOST
 = "localhost";

63 
´iv©e
 
fš®
 
	mPORT
 = 9142;

64 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_ROW_KEY
 = "user1";

66 
´iv©e
 
Cas§nd¿CQLCl›Á
 
	mş›Á
;

67 
´iv©e
 
SessiÚ
 
	m£ssiÚ
;

69 @
CÏssRuË


70 
public
 
Cas§nd¿CQLUn™
 
	mÿs§nd¿Un™
 = 
Ãw
 CassandraCQLUnit(

71 
Ãw
 
CÏssP©hCQLD©aS‘
("ycsb.cql", "ycsb"), 
nuÎ
, 
timeout
);

73 @
BefÜe


74 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

75 
£ssiÚ
 = 
ÿs§nd¿Un™
.
	`g‘SessiÚ
();

77 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

78 
p
.
	`£tPrİ”ty
("ho¡s", 
HOST
);

79 
p
.
	`£tPrİ”ty
("pÜt", 
IÁeg”
.
	`toSŒšg
(
PORT
));

80 
p
.
	`£tPrİ”ty
("bË", 
TABLE
);

82 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

83 
fš®
 
CÜeWÜklßd
 
wÜklßd
 = 
Ãw
 
	`CÜeWÜklßd
();

84 
wÜklßd
.
	`š™
(
p
);

85 
ş›Á
 = 
Ãw
 
	`Cas§nd¿CQLCl›Á
();

86 
ş›Á
.
	`£tPrİ”t›s
(
p
);

87 
ş›Á
.
	`š™
();

90 @
Aá”


91 
public
 
	$‹¬DownCl›Á
(è
throws
 
Exû±iÚ
 {

92 ià(
ş›Á
 !ğ
nuÎ
) {

93 
ş›Á
.
	`ş—nup
();

95 
ş›Á
 = 
nuÎ
;

96 
	}
}

98 @
Aá”


99 
public
 
	$ş—rTabË
(è
throws
 
Exû±iÚ
 {

101 
fš®
 
S‹m’t
 
Œunÿ‹
 = 
Qu”yBud”
.
	`Œunÿ‹
(
TABLE
);

102 ià(
ÿs§nd¿Un™
 !ğ
nuÎ
) {

103 
ÿs§nd¿Un™
.
	`g‘SessiÚ
().
	`execu‹
(
Œunÿ‹
);

105 
	}
}

107 @
Te¡


108 
public
 
	$‹¡R—dMissšgRow
(è
throws
 
Exû±iÚ
 {

109 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

110 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
TABLE
, "Missšg„ow", 
nuÎ
, 
»suÉ
);

111 
	`as£¹Th©
(
»suÉ
.
	`size
(), 
	`is
(0));

112 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
NOT_FOUND
));

113 
	}
}

115 
´iv©e
 
	$š£¹Row
() {

116 
fš®
 
SŒšg
 
rowKey
 = 
DEFAULT_ROW_KEY
;

117 
In£¹
 
š£¹Stmt
 = 
Qu”yBud”
.
	`š£¹IÁo
(
TABLE
);

118 
š£¹Stmt
.
	`v®ue
(
Cas§nd¿CQLCl›Á
.
YCSB_KEY
, 
rowKey
);

120 
š£¹Stmt
.
	`v®ue
("field0", "value1");

121 
š£¹Stmt
.
	`v®ue
("field1", "value2");

122 
£ssiÚ
.
	`execu‹
(
š£¹Stmt
);

123 
	}
}

125 @
Te¡


126 
public
 
	$‹¡R—d
(è
throws
 
Exû±iÚ
 {

127 
	`š£¹Row
();

129 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

130 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
TABLE
, 
DEFAULT_ROW_KEY
, 
nuÎ
, 
»suÉ
);

131 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

132 
	`as£¹Th©
(
»suÉ
.
	`’ŒyS‘
(), 
	`hasSize
(11));

133 
	`as£¹Th©
(
»suÉ
, 
	`hasEÁry
("f›ld2", 
nuÎ
));

135 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
¡rResuÉ
 = 
Ãw
 HashMap<String, String>();

136 
fš®
 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
e
 : 
»suÉ
.
	`’ŒyS‘
()) {

137 ià(
e
.
	`g‘V®ue
(è!ğ
nuÎ
) {

138 
¡rResuÉ
.
	`put
(
e
.
	`g‘Key
(),ƒ.
	`g‘V®ue
().
	`toSŒšg
());

141 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
(
Cas§nd¿CQLCl›Á
.
YCSB_KEY
, 
DEFAULT_ROW_KEY
));

142 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field0", "value1"));

143 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field1", "value2"));

144 
	}
}

146 @
Te¡


147 
public
 
	$‹¡R—dSšgËCŞumn
(è
throws
 
Exû±iÚ
 {

148 
	`š£¹Row
();

149 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

150 
fš®
 
S‘
<
SŒšg
> 
f›lds
 = 
S‘s
.
	`ÃwHashS‘
("field1");

151 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
TABLE
, 
DEFAULT_ROW_KEY
, 
f›lds
, 
»suÉ
);

152 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

153 
	`as£¹Th©
(
»suÉ
.
	`’ŒyS‘
(), 
	`hasSize
(1));

154 
fš®
 
M­
<
SŒšg
, SŒšg> 
¡rResuÉ
 = 
SŒšgBy‹I‹¿tÜ
.
	`g‘SŒšgM­
(
»suÉ
);

155 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field1", "value2"));

156 
	}
}

158 @
Te¡


159 
public
 
	$‹¡In£¹
(è
throws
 
Exû±iÚ
 {

160 
fš®
 
SŒšg
 
key
 = "key";

161 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<String, String>();

162 
šput
.
	`put
("field0", "value1");

163 
šput
.
	`put
("field1", "value2");

165 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`š£¹
(
TABLE
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

166 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

169 
fš®
 
S–eù
 
£ËùStmt
 =

170 
Qu”yBud”
.
	`£Ëù
("field0", "field1")

171 .
	`äom
(
TABLE
)

172 .
	`wh”e
(
Qu”yBud”
.
	`eq
(
Cas§nd¿CQLCl›Á
.
YCSB_KEY
, 
key
))

173 .
	`lim™
(1);

175 
fš®
 
ResuÉS‘
 
rs
 = 
£ssiÚ
.
	`execu‹
(
£ËùStmt
);

176 
fš®
 
Row
 
row
 = 
rs
.
	`Úe
();

177 
	`as£¹Th©
(
row
, 
	`nÙNuÎV®ue
());

178 
	`as£¹Th©
(
rs
.
	`isExhau¡ed
(), 
	`is
(
Œue
));

179 
	`as£¹Th©
(
row
.
	`g‘SŒšg
("f›ld0"), 
	`is
("value1"));

180 
	`as£¹Th©
(
row
.
	`g‘SŒšg
("f›ld1"), 
	`is
("value2"));

181 
	}
}

183 @
Te¡


184 
public
 
	$‹¡Upd©e
(è
throws
 
Exû±iÚ
 {

185 
	`š£¹Row
();

186 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<String, String>();

187 
šput
.
	`put
("field0", "new-value1");

188 
šput
.
	`put
("field1", "new-value2");

190 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`upd©e
(
TABLE
,

191 
DEFAULT_ROW_KEY
,

192 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

193 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

196 
fš®
 
S–eù
 
£ËùStmt
 =

197 
Qu”yBud”
.
	`£Ëù
("field0", "field1")

198 .
	`äom
(
TABLE
)

199 .
	`wh”e
(
Qu”yBud”
.
	`eq
(
Cas§nd¿CQLCl›Á
.
YCSB_KEY
, 
DEFAULT_ROW_KEY
))

200 .
	`lim™
(1);

202 
fš®
 
ResuÉS‘
 
rs
 = 
£ssiÚ
.
	`execu‹
(
£ËùStmt
);

203 
fš®
 
Row
 
row
 = 
rs
.
	`Úe
();

204 
	`as£¹Th©
(
row
, 
	`nÙNuÎV®ue
());

205 
	`as£¹Th©
(
rs
.
	`isExhau¡ed
(), 
	`is
(
Œue
));

206 
	`as£¹Th©
(
row
.
	`g‘SŒšg
("f›ld0"), 
	`is
("new-value1"));

207 
	`as£¹Th©
(
row
.
	`g‘SŒšg
("f›ld1"), 
	`is
("new-value2"));

208 
	}
}

210 @
Te¡


211 
public
 
	$‹¡D–‘e
(è
throws
 
Exû±iÚ
 {

212 
	`š£¹Row
();

214 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`d–‘e
(
TABLE
, 
DEFAULT_ROW_KEY
);

215 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

218 
fš®
 
S–eù
 
£ËùStmt
 =

219 
Qu”yBud”
.
	`£Ëù
("field0", "field1")

220 .
	`äom
(
TABLE
)

221 .
	`wh”e
(
Qu”yBud”
.
	`eq
(
Cas§nd¿CQLCl›Á
.
YCSB_KEY
, 
DEFAULT_ROW_KEY
))

222 .
	`lim™
(1);

224 
fš®
 
ResuÉS‘
 
rs
 = 
£ssiÚ
.
	`execu‹
(
£ËùStmt
);

225 
fš®
 
Row
 
row
 = 
rs
.
	`Úe
();

226 
	`as£¹Th©
(
row
, 
	`nuÎV®ue
());

227 
	}
}

229 @
Te¡


230 
public
 
	$‹¡P»·»dS‹m’ts
(è
throws
 
Exû±iÚ
 {

231 
fš®
 
LOOP_COUNT
 = 3;

232 
i
 = 0; i < 
LOOP_COUNT
; i++) {

233 
	`‹¡In£¹
();

234 
	`‹¡Upd©e
();

235 
	`‹¡R—d
();

236 
	`‹¡R—dSšgËCŞumn
();

237 
	`‹¡R—dMissšgRow
();

238 
	`‹¡D–‘e
();

240 
	}
}

	@cloudspanner/src/main/java/site/ycsb/db/cloudspanner/CloudSpannerClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gşoud¥ªÃr
;

19 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gba£
.
	gJoš”
;

20 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gD©aba£Id
;

21 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gD©aba£Cl›Á
;

22 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gKey
;

23 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gKeyS‘
;

24 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gKeyRªge
;

25 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gMutiÚ
;

26 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gO±iÚs
;

27 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gResuÉS‘
;

28 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gSessiÚPoŞO±iÚs
;

29 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gS·Â”
;

30 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gS·Â”O±iÚs
;

31 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gS‹m’t
;

32 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gSŒuù
;

33 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gSŒuùR—d”
;

34 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	g¥ªÃr
.
	gTime¡ampBound
;

35 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

43 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

44 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

45 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

46 
impÜt
 
	gjava
.
	gut
.
	gM­
;

47 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

48 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

49 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

50 
impÜt
 
	gjava
.
	gut
.
	gloggšg
.
	gLev–
;

51 
impÜt
 
	gjava
.
	gut
.
	gloggšg
.
	gLogg”
;

52 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

57 
public
 cÏs 
	cCloudS·Â”Cl›Á
 
ex‹nds
 
	mDB
 {

62 
public
 
fš®
 cÏs 
	cCloudS·Â”Prİ”t›s
 {

63 
´iv©e
 
CloudS·Â”Prİ”t›s
() {}

68 
fš®
 
SŒšg
 
	mDATABASE
 = "cloudspanner.database";

72 
fš®
 
SŒšg
 
	mINSTANCE
 = "cloudspanner.instance";

76 
fš®
 
SŒšg
 
	mREAD_MODE
 = "cloudspanner.readmode";

81 
fš®
 
SŒšg
 
	mBATCH_INSERTS
 = "cloudspanner.batchinserts";

86 
fš®
 
SŒšg
 
	mBOUNDED_STALENESS
 = "cloudspanner.boundedstaleness";

94 
fš®
 
SŒšg
 
	mPROJECT
 = "cloudspanner.project";

98 
fš®
 
SŒšg
 
	mHOST
 = "cloudspanner.host";

102 
fš®
 
SŒšg
 
	mNUM_CHANNELS
 = "cloudspanner.channels";

105 
´iv©e
 
	gf›ldCouÁ
;

107 
´iv©e
 
boŞ—n
 
	gqu”›sFÜR—ds
;

109 
´iv©e
 
	gb©chIn£¹s
;

111 
´iv©e
 
Time¡ampBound
 
	gtime¡ampBound
;

113 
´iv©e
 
SŒšg
 
	g¡ªd¬dQu”y
;

115 
´iv©e
 
SŒšg
 
	g¡ªd¬dSÿn
;

117 
´iv©e
 
fš®
 
	gA¼ayLi¡
<
	gSŒšg
> 
	gSTANDARD_FIELDS
 = 
Ãw
 
A¼ayLi¡
<>();

119 
´iv©e
 
fš®
 
SŒšg
 
	gPRIMARY_KEY_COLUMN
 = "id";

121 
´iv©e
 
fš®
 
Logg”
 
	gLOGGER
 = Logg”.
g‘Logg”
(
CloudS·Â”Cl›Á
.
şass
.
g‘Name
());

124 
´iv©e
 
fš®
 
Objeù
 
	gCLASS_LOCK
 = 
Ãw
 Object();

127 
´iv©e
 
S·Â”
 
	g¥ªÃr
 = 
nuÎ
;

130 
´iv©e
 
D©aba£Cl›Á
 
	gdbCl›Á
 = 
nuÎ
;

134 
´iv©e
 
fš®
 
	gA¼ayLi¡
<
	gMutiÚ
> 
	gbufã»dMutiÚs
 = 
Ãw
 
A¼ayLi¡
<>();

136 
´iv©e
 
	$cÚ¡ruùSnd¬dQu”›sAndF›lds
(
Prİ”t›s
 
´İ”t›s
) {

137 
SŒšg
 
bË
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, CÜeWÜklßd.
TABLENAME_PROPERTY_DEFAULT
);

138 
fš®
 
SŒšg
 
f›ld´efix
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
FIELD_NAME_PREFIX
,

139 
CÜeWÜklßd
.
FIELD_NAME_PREFIX_DEFAULT
);

140 
¡ªd¬dQu”y
 = 
Ãw
 
	`SŒšgBud”
()

141 .
	`­³nd
("SELECT * FROM ").­³nd(
bË
).­³nd(" WHERE id=@key").
	`toSŒšg
();

142 
¡ªd¬dSÿn
 = 
Ãw
 
	`SŒšgBud”
()

143 .
	`­³nd
("SELECT * FROM ").­³nd(
bË
).­³nd(" WHERE id>=@¡¬tKey LIMIT @couÁ").
	`toSŒšg
();

144 
i
 = 0; i < 
f›ldCouÁ
; i++) {

145 
STANDARD_FIELDS
.
	`add
(
f›ld´efix
 + 
i
);

147 
	}
}

149 
´iv©e
 
S·Â”
 
	$g‘S·Â”
(
Prİ”t›s
 
´İ”t›s
, 
SŒšg
 
ho¡
, SŒšg 
´ojeù
) {

150 ià(
¥ªÃr
 !ğ
nuÎ
) {

151  
¥ªÃr
;

153 
SŒšg
 
numChªÃls
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CloudS·Â”Prİ”t›s
.
NUM_CHANNELS
);

154 
numTh»ads
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
Cl›Á
.
THREAD_COUNT_PROPERTY
, "1"));

155 
S·Â”O±iÚs
.
Bud”
 
İtiÚsBud”
 = S·Â”O±iÚs.
	`ÃwBud”
()

156 .
	`£tSessiÚPoŞO±iÚ
(
SessiÚPoŞO±iÚs
.
	`ÃwBud”
()

157 .
	`£tMšSessiÚs
(
numTh»ads
)

159 .
	`£tWr™eSessiÚsF¿ùiÚ
(0)

160 .
	`bud
());

161 ià(
ho¡
 !ğ
nuÎ
) {

162 
İtiÚsBud”
.
	`£tHo¡
(
ho¡
);

164 ià(
´ojeù
 !ğ
nuÎ
) {

165 
İtiÚsBud”
.
	`£tProjeùId
(
´ojeù
);

167 ià(
numChªÃls
 !ğ
nuÎ
) {

168 
İtiÚsBud”
.
	`£tNumChªÃls
(
IÁeg”
.
	`·r£IÁ
(
numChªÃls
));

170 
¥ªÃr
 = 
İtiÚsBud”
.
	`bud
().
	`g‘S”viû
();

171 
RuÁime
.
	`g‘RuÁime
().
	`addShutdownHook
(
Ãw
 
	`Th»ad
("spannerShutdown") {

172 @
Ov”ride


173 
public
 
	`run
() {

174 
¥ªÃr
.
	`şo£
();

177  
¥ªÃr
;

178 
	}
}

180 @
Ov”ride


181 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

182 
	`synchrÚized
 (
CLASS_LOCK
) {

183 ià(
dbCl›Á
 !ğ
nuÎ
) {

186 
Prİ”t›s
 
´İ”t›s
 = 
	`g‘Prİ”t›s
();

187 
SŒšg
 
ho¡
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CloudS·Â”Prİ”t›s
.
HOST
);

188 
SŒšg
 
´ojeù
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CloudS·Â”Prİ”t›s
.
PROJECT
);

189 
SŒšg
 
š¡ªû
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CloudS·Â”Prİ”t›s
.
INSTANCE
, "ycsb-instance");

190 
SŒšg
 
d©aba£
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CloudS·Â”Prİ”t›s
.
DATABASE
, "ycsb-database");

192 
f›ldCouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

193 
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
, CÜeWÜklßd.
FIELD_COUNT_PROPERTY_DEFAULT
));

194 
qu”›sFÜR—ds
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CloudS·Â”Prİ”t›s
.
READ_MODE
, "qu”y").
	`equ®s
("query");

195 
b©chIn£¹s
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
CloudS·Â”Prİ”t›s
.
BATCH_INSERTS
, "1"));

196 
	`cÚ¡ruùSnd¬dQu”›sAndF›lds
(
´İ”t›s
);

198 
boundedSËÃssSecÚds
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

199 
CloudS·Â”Prİ”t›s
.
BOUNDED_STALENESS
, "0"));

200 
time¡ampBound
 = (
boundedSËÃssSecÚds
 <= 0) ?

201 
Time¡ampBound
.
	`¡rÚg
(è: Time¡ampBound.
	`ofMaxSËÃss
(
boundedSËÃssSecÚds
, 
TimeUn™
.
SECONDS
);

203 
Œy
 {

204 
¥ªÃr
 = 
	`g‘S·Â”
(
´İ”t›s
, 
ho¡
, 
´ojeù
);

205 ià(
´ojeù
 =ğ
nuÎ
) {

206 
´ojeù
 = 
¥ªÃr
.
	`g‘O±iÚs
().
	`g‘ProjeùId
();

208 
dbCl›Á
 = 
¥ªÃr
.
	`g‘D©aba£Cl›Á
(
D©aba£Id
.
	`of
(
´ojeù
, 
š¡ªû
, 
d©aba£
));

209 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

210 
LOGGER
.
	`log
(
Lev–
.
SEVERE
, "š™()", 
e
);

211 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

214 
LOGGER
.
	`log
(
Lev–
.
INFO
, 
Ãw
 
	`SŒšgBud”
()

215 .
	`­³nd
("\nHo¡: ").­³nd(
¥ªÃr
.
	`g‘O±iÚs
().
	`g‘Ho¡
())

216 .
	`­³nd
("\nProjeù: ").­³nd(
´ojeù
)

217 .
	`­³nd
("\nIn¡ªû: ").­³nd(
š¡ªû
)

218 .
	`­³nd
("\nD©aba£: ").­³nd(
d©aba£
)

219 .
	`­³nd
("\nUsšg qu”› fÜ„—ds: ").­³nd(
qu”›sFÜR—ds
)

220 .
	`­³nd
("\nB©chšg in£¹s: ").­³nd(
b©chIn£¹s
)

221 .
	`­³nd
("\nBounded sËÃs £cÚds: ").­³nd(
boundedSËÃssSecÚds
)

222 .
	`toSŒšg
());

224 
	}
}

226 
´iv©e
 
Stus
 
»adUsšgQu”y
(

227 
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

228 
S‹m’t
 
	gqu”y
;

229 
	gI‹¿bË
<
	gSŒšg
> 
	gcŞumns
 = 
f›lds
 =ğ
nuÎ
 ? 
STANDARD_FIELDS
 : fields;

230 ià(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
size
(è=ğ
f›ldCouÁ
) {

231 
qu”y
 = 
S‹m’t
.
ÃwBud”
(
¡ªd¬dQu”y
).
bšd
("key").
to
(
key
).
bud
();

233 
Još”
 
	gjoš”
 = Još”.
Ú
(',');

234 
	gqu”y
 = 
S‹m’t
.
ÃwBud”
("SELECT ")

235 .
­³nd
(
još”
.
još
(
f›lds
))

236 .
­³nd
(" FROM ")

237 .
­³nd
(
bË
)

238 .
­³nd
(" WHERE id=@key")

239 .
bšd
("key").
to
(
key
)

240 .
bud
();

242 
Œy
 (
ResuÉS‘
 
»suÉS‘
 = 
dbCl›Á
.
sšgËU£
(
time¡ampBound
).
execu‹Qu”y
(
qu”y
)) {

243 
»suÉS‘
.
Ãxt
();

244 
decodeSŒuù
(
cŞumns
, 
»suÉS‘
, 
»suÉ
);

245 ià(
	g»suÉS‘
.
Ãxt
()) {

246 
throw
 
Ãw
 
Exû±iÚ
("Expectedƒxactly one„ow forƒach„ead.");

249  
	gStus
.
	gOK
;

250 } 
ÿtch
 (
Exû±iÚ
 
e
) {

251 
	gLOGGER
.
log
(
Lev–
.
INFO
, "»adUsšgQu”y()", 
e
);

252  
	gStus
.
	gERROR
;

256 @
Ov”ride


257 
public
 
Stus
 
»ad
(

258 
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

259 ià(
	gqu”›sFÜR—ds
) {

260  
»adUsšgQu”y
(
bË
, 
key
, 
f›lds
, 
»suÉ
);

262 
	gI‹¿bË
<
	gSŒšg
> 
	gcŞumns
 = 
f›lds
 =ğ
nuÎ
 ? 
STANDARD_FIELDS
 : fields;

263 
	gŒy
 {

264 
SŒuù
 
	grow
 = 
dbCl›Á
.
sšgËU£
(
time¡ampBound
).
»adRow
(
bË
, 
Key
.
of
(
key
), 
cŞumns
);

265 
decodeSŒuù
(
cŞumns
, 
row
, 
»suÉ
);

266  
	gStus
.
	gOK
;

267 } 
ÿtch
 (
Exû±iÚ
 
e
) {

268 
	gLOGGER
.
log
(
Lev–
.
INFO
, "»ad()", 
e
);

269  
	gStus
.
	gERROR
;

273 
´iv©e
 
Stus
 
sÿnUsšgQu”y
(

274 
SŒšg
 
bË
, SŒšg 
¡¬tKey
, 
»cÜdCouÁ
, 
S‘
<SŒšg> 
f›lds
,

275 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

276 
	gI‹¿bË
<
	gSŒšg
> 
	gcŞumns
 = 
f›lds
 =ğ
nuÎ
 ? 
STANDARD_FIELDS
 : fields;

277 
S‹m’t
 
	gqu”y
;

278 ià(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
size
(è=ğ
f›ldCouÁ
) {

279 
qu”y
 = 
S‹m’t
.
ÃwBud”
(
¡ªd¬dSÿn
).
bšd
("¡¬tKey").
to
(
¡¬tKey
).bšd("couÁ").to(
»cÜdCouÁ
).
bud
();

281 
Još”
 
	gjoš”
 = Još”.
Ú
(',');

282 
	gqu”y
 = 
S‹m’t
.
ÃwBud”
("SELECT ")

283 .
­³nd
(
još”
.
još
(
f›lds
))

284 .
­³nd
(" FROM ")

285 .
­³nd
(
bË
)

286 .
­³nd
(" WHERE id>=@startKey LIMIT @count")

287 .
bšd
("¡¬tKey").
to
(
¡¬tKey
)

288 .
bšd
("couÁ").
to
(
»cÜdCouÁ
)

289 .
bud
();

291 
Œy
 (
ResuÉS‘
 
»suÉS‘
 = 
dbCl›Á
.
sšgËU£
(
time¡ampBound
).
execu‹Qu”y
(
qu”y
)) {

292 
»suÉS‘
.
Ãxt
()) {

293 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
row
 = 
Ãw
 HashMap<>();

294 
decodeSŒuù
(
cŞumns
, 
»suÉS‘
, 
row
);

295 
	g»suÉ
.
add
(
row
);

297  
	gStus
.
	gOK
;

298 } 
ÿtch
 (
Exû±iÚ
 
e
) {

299 
	gLOGGER
.
log
(
Lev–
.
INFO
, "sÿnUsšgQu”y()", 
e
);

300  
	gStus
.
	gERROR
;

304 @
Ov”ride


305 
public
 
Stus
 
sÿn
(

306 
SŒšg
 
bË
, SŒšg 
¡¬tKey
, 
»cÜdCouÁ
, 
S‘
<SŒšg> 
f›lds
,

307 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

308 ià(
	gqu”›sFÜR—ds
) {

309  
sÿnUsšgQu”y
(
bË
, 
¡¬tKey
, 
»cÜdCouÁ
, 
f›lds
, 
»suÉ
);

311 
	gI‹¿bË
<
	gSŒšg
> 
	gcŞumns
 = 
f›lds
 =ğ
nuÎ
 ? 
STANDARD_FIELDS
 : fields;

312 
KeyS‘
 
	gkeyS‘
 =

313 
KeyS‘
.
ÃwBud”
().
addRªge
(
KeyRªge
.
şo£dClo£d
(
Key
.
of
(
¡¬tKey
), Key.of())).
bud
();

314 
Œy
 (
ResuÉS‘
 
»suÉS‘
 = 
dbCl›Á
.
sšgËU£
(
time¡ampBound
)

315 .
»ad
(
bË
, 
keyS‘
, 
cŞumns
, 
O±iÚs
.
lim™
(
»cÜdCouÁ
))) {

316 
	g»suÉS‘
.
Ãxt
()) {

317 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	grow
 = 
Ãw
 
HashM­
<>();

318 
decodeSŒuù
(
cŞumns
, 
»suÉS‘
, 
row
);

319 
	g»suÉ
.
add
(
row
);

321  
	gStus
.
	gOK
;

322 } 
ÿtch
 (
Exû±iÚ
 
e
) {

323 
	gLOGGER
.
log
(
Lev–
.
INFO
, "sÿn()", 
e
);

324  
	gStus
.
	gERROR
;

328 @
Ov”ride


329 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

330 
	gMutiÚ
.
Wr™eBud”
 
	gm
 = 
MutiÚ
.
ÃwIn£¹OrUpd©eBud”
(
bË
);

331 
	gm
.
£t
(
PRIMARY_KEY_COLUMN
).
to
(
key
);

332 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	ge
 : 
v®ues
.
’ŒyS‘
()) {

333 
m
.
£t
(
e
.
g‘Key
()).
to
Ó.
g‘V®ue
().
toSŒšg
());

335 
	gŒy
 {

336 
	gdbCl›Á
.
wr™eAtL—¡Onû
(
A¼ays
.
asLi¡
(
m
.
bud
()));

337 } 
ÿtch
 (
Exû±iÚ
 
e
) {

338 
	gLOGGER
.
log
(
Lev–
.
INFO
, "upd©e()", 
e
);

339  
	gStus
.
	gERROR
;

341  
	gStus
.
	gOK
;

344 @
Ov”ride


345 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

346 ià(
	gbufã»dMutiÚs
.
size
(è< 
	gb©chIn£¹s
) {

347 
	gMutiÚ
.
Wr™eBud”
 
	gm
 = 
MutiÚ
.
ÃwIn£¹OrUpd©eBud”
(
bË
);

348 
	gm
.
£t
(
PRIMARY_KEY_COLUMN
).
to
(
key
);

349 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	ge
 : 
v®ues
.
’ŒyS‘
()) {

350 
m
.
£t
(
e
.
g‘Key
()).
to
Ó.
g‘V®ue
().
toSŒšg
());

352 
	gbufã»dMutiÚs
.
add
(
m
.
bud
());

354 
	gLOGGER
.
log
(
Lev–
.
INFO
, "Lim™ oàÿched mutiÚ »ached. Thgiv’ mutiÚ w™h key " + 
key
 +

357 ià(
	gbufã»dMutiÚs
.
size
(è< 
	gb©chIn£¹s
) {

358  
	gStus
.
	gBATCHED_OK
;

360 
	gŒy
 {

361 
	gdbCl›Á
.
wr™eAtL—¡Onû
(
bufã»dMutiÚs
);

362 
	gbufã»dMutiÚs
.
ş—r
();

363 } 
ÿtch
 (
Exû±iÚ
 
e
) {

364 
	gLOGGER
.
log
(
Lev–
.
INFO
, "š£¹()", 
e
);

365  
	gStus
.
	gERROR
;

367  
	gStus
.
	gOK
;

370 @
Ov”ride


371 
public
 
	$ş—nup
() {

372 
Œy
 {

373 ià(
bufã»dMutiÚs
.
	`size
() > 0) {

374 
dbCl›Á
.
	`wr™eAtL—¡Onû
(
bufã»dMutiÚs
);

375 
bufã»dMutiÚs
.
	`ş—r
();

377 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

378 
LOGGER
.
	`log
(
Lev–
.
INFO
, "ş—nup()", 
e
);

380 
	}
}

382 @
Ov”ride


383 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

384 
Œy
 {

385 
dbCl›Á
.
	`wr™eAtL—¡Onû
(
A¼ays
.
	`asLi¡
(
MutiÚ
.
	`d–‘e
(
bË
, 
Key
.
	`of
(
key
))));

386 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

387 
LOGGER
.
	`log
(
Lev–
.
INFO
, "d–‘e()", 
e
);

388  
Stus
.
ERROR
;

390  
Stus
.
OK
;

391 
	}
}

393 
´iv©e
 
decodeSŒuù
(

394 
I‹¿bË
<
SŒšg
> 
cŞumns
, 
SŒuùR—d”
 
¡ruùR—d”
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

395 
SŒšg
 
	gcŞ
 : 
cŞumns
) {

396 
»suÉ
.
put
(
cŞ
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
¡ruùR—d”
.
g‘SŒšg
(col)));

	@cloudspanner/src/main/java/site/ycsb/db/cloudspanner/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gşoud¥ªÃr
;

	@core/src/main/java/site/ycsb/BasicDB.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.*;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

30 
public
 cÏs 
	cBasicDB
 
ex‹nds
 
	mDB
 {

31 
public
 
fš®
 
SŒšg
 
	mCOUNT
 = "basicdb.count";

32 
public
 
fš®
 
SŒšg
 
	mCOUNT_DEFAULT
 = "false";

34 
public
 
fš®
 
SŒšg
 
	mVERBOSE
 = "basicdb.verbose";

35 
public
 
fš®
 
SŒšg
 
	mVERBOSE_DEFAULT
 = "true";

37 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY
 = "basicdb.simulatedelay";

38 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY_DEFAULT
 = "0";

40 
public
 
fš®
 
SŒšg
 
	mRANDOMIZE_DELAY
 = "basicdb.randomizedelay";

41 
public
 
fš®
 
SŒšg
 
	mRANDOMIZE_DELAY_DEFAULT
 = "true";

43 
´Ùeùed
 
fš®
 
Objeù
 
	mMUTEX
 = 
Ãw
 Object();

44 
´Ùeùed
 
	mcouÁ”
 = 0;

45 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	m»ads
;

46 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	msÿns
;

47 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mupd©es
;

48 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mš£¹s
;

49 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	md–‘es
;

51 
´Ùeùed
 
boŞ—n
 
	mv”bo£
;

52 
´Ùeùed
 
boŞ—n
 
	m¿ndomized–ay
;

53 
´Ùeùed
 
	mtod–ay
;

54 
´Ùeùed
 
boŞ—n
 
	mcouÁ
;

56 
public
 
	$BasicDB
() {

57 
tod–ay
 = 0;

60 
´Ùeùed
 
	$d–ay
() {

61 ià(
tod–ay
 > 0) {

62 
d–ayNs
;

63 ià(
¿ndomized–ay
) {

64 
d–ayNs
 = 
TimeUn™
.
MILLISECONDS
.
	`toNªos
(
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
(
tod–ay
));

65 ià(
d–ayNs
 == 0) {

69 
d–ayNs
 = 
TimeUn™
.
MILLISECONDS
.
	`toNªos
(
tod–ay
);

72 
fš®
 
d—dlše
 = 
Sy¡em
.
	`ÇnoTime
(è+ 
d–ayNs
;

74 
LockSuµÜt
.
	`·rkNªos
(
d—dlše
 - 
Sy¡em
.
	`ÇnoTime
());

75 } 
Sy¡em
.
	`ÇnoTime
(è< 
d—dlše
 && !
Th»ad
.
	`š‹¼u±ed
());

77 
	}
}

83 
public
 
	$š™
() {

84 
v”bo£
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
VERBOSE
, 
VERBOSE_DEFAULT
));

85 
tod–ay
 = 
IÁeg”
.
	`·r£IÁ
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
SIMULATE_DELAY
, 
SIMULATE_DELAY_DEFAULT
));

86 
¿ndomized–ay
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
RANDOMIZE_DELAY
, 
RANDOMIZE_DELAY_DEFAULT
));

87 
couÁ
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
COUNT
, 
COUNT_DEFAULT
));

88 ià(
v”bo£
) {

89 
	`synchrÚized
 (
Sy¡em
.
out
) {

90 
Sy¡em
.
out
.
	`´šn
("*****************…roperties *****************");

91 
Prİ”t›s
 
p
 = 
	`g‘Prİ”t›s
();

92 ià(
p
 !ğ
nuÎ
) {

93 
Enum”©iÚ
 
e
 = 
p
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

94 
SŒšg
 
k
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

95 
Sy¡em
.
out
.
	`´šn
("\"" + 
k
 + "\"=\"" + 
p
.
	`g‘Prİ”ty
(k) + "\"");

98 
Sy¡em
.
out
.
	`´šn
("**********************************************");

102 
	`synchrÚized
 (
MUTEX
) {

103 ià(
couÁ”
 =ğ0 && 
couÁ
) {

104 
»ads
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

105 
sÿns
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

106 
upd©es
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

107 
š£¹s
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

108 
d–‘es
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

110 
couÁ”
++;

112 
	}
}

114 
´Ùeùed
 
fš®
 
	gTh»adLoÿl
<
	gSŒšgBud”
> 
	gTL_STRING_BUILDER
 = 
Ãw
 
Th»adLoÿl
<
SŒšgBud”
>() {

115 @
Ov”ride


116 
´Ùeùed
 
SŒšgBud”
 
š™ŸlV®ue
() {

117  
Ãw
 
SŒšgBud”
();

121 
´Ùeùed
 
SŒšgBud”
 
	$g‘SŒšgBud”
() {

122 
SŒšgBud”
 
sb
 = 
TL_STRING_BUILDER
.
	`g‘
();

123 
sb
.
	`£tL’gth
(0);

124  
sb
;

125 
	}
}

136 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

137 
d–ay
();

139 ià(
	gv”bo£
) {

140 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

141 
	gsb
.
­³nd
("READ ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

142 ià(
	gf›lds
 !ğ
nuÎ
) {

143 
SŒšg
 
f
 : 
f›lds
) {

144 
sb
.
­³nd
(
f
).append(" ");

147 
	gsb
.
­³nd
("<all fields>");

150 
	gsb
.
­³nd
("]");

151 
	gSy¡em
.
	gout
.
´šn
(
sb
);

154 ià(
	gcouÁ
) {

155 
šcCouÁ”
(
»ads
, 
hash
(
bË
, 
key
, 
f›lds
));

158  
	gStus
.
	gOK
;

172 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

173 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

174 
d–ay
();

176 ià(
	gv”bo£
) {

177 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

178 
	gsb
.
­³nd
("SCAN ").­³nd(
bË
).­³nd(" ").­³nd(
¡¬tkey
).­³nd(" ").­³nd(
»cÜdcouÁ
).append(" [ ");

179 ià(
	gf›lds
 !ğ
nuÎ
) {

180 
SŒšg
 
f
 : 
f›lds
) {

181 
sb
.
­³nd
(
f
).append(" ");

184 
	gsb
.
­³nd
("<all fields>");

187 
	gsb
.
­³nd
("]");

188 
	gSy¡em
.
	gout
.
´šn
(
sb
);

191 ià(
	gcouÁ
) {

192 
šcCouÁ”
(
sÿns
, 
hash
(
bË
, 
¡¬tkey
, 
f›lds
));

195  
	gStus
.
	gOK
;

207 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

208 
d–ay
();

210 ià(
	gv”bo£
) {

211 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

212 
	gsb
.
­³nd
("UPDATE ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

213 ià(
	gv®ues
 !ğ
nuÎ
) {

214 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’Œy
 : 
v®ues
.
’ŒyS‘
()) {

215 
sb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

218 
	gsb
.
­³nd
("]");

219 
	gSy¡em
.
	gout
.
´šn
(
sb
);

222 ià(
	gcouÁ
) {

223 
šcCouÁ”
(
upd©es
, 
hash
(
bË
, 
key
, 
v®ues
));

226  
	gStus
.
	gOK
;

238 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

239 
d–ay
();

241 ià(
	gv”bo£
) {

242 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

243 
	gsb
.
­³nd
("INSERT ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

244 ià(
	gv®ues
 !ğ
nuÎ
) {

245 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’Œy
 : 
v®ues
.
’ŒyS‘
()) {

246 
sb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

250 
	gsb
.
­³nd
("]");

251 
	gSy¡em
.
	gout
.
´šn
(
sb
);

254 ià(
	gcouÁ
) {

255 
šcCouÁ”
(
š£¹s
, 
hash
(
bË
, 
key
, 
v®ues
));

258  
	gStus
.
	gOK
;

269 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

270 
	`d–ay
();

272 ià(
v”bo£
) {

273 
SŒšgBud”
 
sb
 = 
	`g‘SŒšgBud”
();

274 
sb
.
	`­³nd
("DELETE ").­³nd(
bË
).­³nd(" ").­³nd(
key
);

275 
Sy¡em
.
out
.
	`´šn
(
sb
);

278 ià(
couÁ
) {

279 
	`šcCouÁ”
(
d–‘es
, (
bË
 + 
key
).
	`hashCode
());

282  
Stus
.
OK
;

283 
	}
}

285 @
Ov”ride


286 
public
 
	$ş—nup
() {

287 
	`synchrÚized
 (
MUTEX
) {

288 
couÁDown
 = --
couÁ”
;

289 ià(
couÁ
 && 
couÁDown
 < 1) {

292 
Sy¡em
.
out
.
	`´šn
("[READS], Uniques, " + 
»ads
.
	`size
());

293 
Sy¡em
.
out
.
	`´šn
("[SCANS], Uniques, " + 
sÿns
.
	`size
());

294 
Sy¡em
.
out
.
	`´šn
("[UPDATES], Uniques, " + 
upd©es
.
	`size
());

295 
Sy¡em
.
out
.
	`´šn
("[INSERTS], Uniques, " + 
š£¹s
.
	`size
());

296 
Sy¡em
.
out
.
	`´šn
("[DELETES], Uniques, " + 
d–‘es
.
	`size
());

299 
	}
}

306 
´Ùeùed
 
šcCouÁ”
(
fš®
 
M­
<
IÁeg”
, IÁeg”> 
m­
, fš® 
hash
) {

307 
synchrÚized
 (
m­
) {

308 
IÁeg”
 
	gùr
 = 
m­
.
g‘
(
hash
);

309 ià(
	gùr
 =ğ
nuÎ
) {

310 
m­
.
put
(
hash
, 1);

312 
	gm­
.
put
(
hash
, 
ùr
 + 1);

327 
´Ùeùed
 
hash
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
S‘
<SŒšg> 
f›lds
) {

328 ià(
	gf›lds
 =ğ
nuÎ
) {

329  (
bË
 + 
key
).
hashCode
();

331 
SŒšgBud”
 
	gbuf
 = 
g‘SŒšgBud”
().
­³nd
(
bË
).­³nd(
key
);

332 
	gLi¡
<
	gSŒšg
> 
	gsÜ‹d
 = 
Ãw
 
A¼ayLi¡
<
SŒšg
>(
f›lds
);

333 
	gCŞËùiÚs
.
sÜt
(
sÜ‹d
);

334 
fš®
 
SŒšg
 
	gf›ld
 : 
sÜ‹d
) {

335 
buf
.
­³nd
(
f›ld
);

337  
	gbuf
.
toSŒšg
().
hashCode
();

350 
´Ùeùed
 
hash
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

351 ià(
	gv®ues
 =ğ
nuÎ
) {

352  (
bË
 + 
key
).
hashCode
();

354 
fš®
 
	gT»eM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gsÜ‹d
 =

355 
Ãw
 
T»eM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>(
	gv®ues
);

357 
SŒšgBud”
 
	gbuf
 = 
g‘SŒšgBud”
().
­³nd
(
bË
).­³nd(
key
);

358 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
sÜ‹d
.
’ŒyS‘
()) {

359 
’Œy
.
g‘V®ue
().
»£t
();

360 
	gbuf
.
­³nd
(
’Œy
.
g‘Key
())

361 .
­³nd
(
’Œy
.
g‘V®ue
().
toSŒšg
());

363  
	gbuf
.
toSŒšg
().
hashCode
();

	@core/src/main/java/site/ycsb/BasicTSDB.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gT»eM­
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gTimeS”›sWÜklßd
;

32 
public
 cÏs 
	cBasicTSDB
 
ex‹nds
 
	mBasicDB
 {

35 
´Ùeùed
 
	mM­
<
	mLÚg
, 
	mIÁeg”
> 
	mtime¡amps
;

36 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mæßts
;

37 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mš‹g”s
;

39 
´iv©e
 
SŒšg
 
	mtime¡ampKey
;

40 
´iv©e
 
SŒšg
 
	mv®ueKey
;

41 
´iv©e
 
SŒšg
 
	mgPaœD–im™”
;

42 
´iv©e
 
SŒšg
 
	mqu”yTimeS·nD–im™”
;

43 
´iv©e
 
	mÏ¡Time¡amp
;

45 @
Ov”ride


46 
public
 
	$š™
() {

47 
su³r
.
	`š™
();

49 
	`synchrÚized
 (
MUTEX
) {

50 ià(
time¡amps
 =ğ
nuÎ
) {

51 
time¡amps
 = 
Ãw
 
HashM­
<
LÚg
, 
IÁeg”
>();

52 
æßts
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

53 
š‹g”s
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

57 
time¡ampKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

58 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY
,

59 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
);

60 
v®ueKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

61 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY
,

62 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
);

63 
gPaœD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

64 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY
,

65 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY_DEFAULT
);

66 
qu”yTimeS·nD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

67 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY
,

68 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
);

71 
public
 
Stus
 
	`»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

72 
	`d–ay
();

74 ià(
v”bo£
) {

75 
SŒšgBud”
 
sb
 = 
	`g‘SŒšgBud”
();

76 
sb
.
	`­³nd
("READ ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

77 ià(
f›lds
 !ğ
nuÎ
) {

78 
SŒšg
 
f
 : 
f›lds
) {

79 
sb
.
	`­³nd
(
f
).append(" ");

82 
sb
.
	`­³nd
("<all fields>");

85 
sb
.
	`­³nd
("]");

86 
Sy¡em
.
out
.
	`´šn
(
sb
);

89 ià(
couÁ
) {

90 
S‘
<
SŒšg
> 
f‹»d
 = 
nuÎ
;

91 ià(
f›lds
 !ğ
nuÎ
) {

92 
f‹»d
 = 
Ãw
 
HashS‘
<
SŒšg
>();

93 
fš®
 
SŒšg
 
f›ld
 : 
f›lds
) {

94 ià(
f›ld
.
	`¡¬tsW™h
(
time¡ampKey
)) {

95 
SŒšg
[] 
·¹s
 = 
f›ld
.
	`¥l™
(
gPaœD–im™”
);

96 ià(
·¹s
[1].
	`cÚšs
(
qu”yTimeS·nD–im™”
)) {

97 
·¹s
 =…¬ts[1].
	`¥l™
(
qu”yTimeS·nD–im™”
);

98 
Ï¡Time¡amp
 = 
LÚg
.
	`·r£LÚg
(
·¹s
[0]);

100 
Ï¡Time¡amp
 = 
LÚg
.
	`·r£LÚg
(
·¹s
[1]);

102 
	`synchrÚized
(
time¡amps
) {

103 
IÁeg”
 
ùr
 = 
time¡amps
.
	`g‘
(
Ï¡Time¡amp
);

104 ià(
ùr
 =ğ
nuÎ
) {

105 
time¡amps
.
	`put
(
Ï¡Time¡amp
, 1);

107 
time¡amps
.
	`put
(
Ï¡Time¡amp
, 
ùr
 + 1);

111 
f‹»d
.
	`add
(
f›ld
);

115 
	`šcCouÁ”
(
»ads
, 
	`hash
(
bË
, 
key
, 
f‹»d
));

117  
Stus
.
OK
;

118 
	}
}

120 @
Ov”ride


121 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

122 
d–ay
();

124 
boŞ—n
 
	gisFlßt
 = 
çl£
;

126 ià(
	gv”bo£
) {

127 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

128 
	gsb
.
­³nd
("UPDATE ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

129 ià(
	gv®ues
 !ğ
nuÎ
) {

130 
fš®
 
T»eM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
Œ“
 = 
Ãw
 T»eM­<SŒšg, 
	gBy‹I‹¿tÜ
>(
	gv®ues
);

131 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
Œ“
.
’ŒyS‘
()) {

132 ià(
’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

133 
sb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

134 .
­³nd
(
Uts
.
by‹sToLÚg
(
’Œy
.
g‘V®ue
().
toA¼ay
())).append(" ");

135 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

136 
fš®
 
Num”icBy‹I‹¿tÜ
 
	g™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

137 
	gisFlßt
 = 
™
.
isFlßtšgPošt
();

138 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

139 .
­³nd
(
isFlßt
 ? 
™
.
g‘DoubË
(è: it.
g‘LÚg
()).append(" ");

141 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

145 
	gsb
.
­³nd
("]");

146 
	gSy¡em
.
	gout
.
´šn
(
sb
);

149 ià(
	gcouÁ
) {

150 ià(!
	gv”bo£
) {

151 
	gisFlßt
 = ((
Num”icBy‹I‹¿tÜ
è
v®ues
.
g‘
(
v®ueKey
)).
isFlßtšgPošt
();

153 
	ghash
 = 
hash
(
bË
, 
key
, 
v®ues
);

154 
šcCouÁ”
(
upd©es
, 
hash
);

155 
synchrÚized
(
time¡amps
) {

156 
IÁeg”
 
	gùr
 = 
time¡amps
.
g‘
(
Ï¡Time¡amp
);

157 ià(
	gùr
 =ğ
nuÎ
) {

158 
time¡amps
.
put
(
Ï¡Time¡amp
, 1);

160 
	gtime¡amps
.
put
(
Ï¡Time¡amp
, 
ùr
 + 1);

163 ià(
	gisFlßt
) {

164 
šcCouÁ”
(
æßts
, 
hash
);

166 
šcCouÁ”
(
š‹g”s
, 
hash
);

170  
	gStus
.
	gOK
;

173 @
Ov”ride


174 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

175 
d–ay
();

177 
boŞ—n
 
	gisFlßt
 = 
çl£
;

179 ià(
	gv”bo£
) {

180 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

181 
	gsb
.
­³nd
("INSERT ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

182 ià(
	gv®ues
 !ğ
nuÎ
) {

183 
fš®
 
T»eM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
Œ“
 = 
Ãw
 T»eM­<SŒšg, 
	gBy‹I‹¿tÜ
>(
	gv®ues
);

184 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
Œ“
.
’ŒyS‘
()) {

185 ià(
’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

186 
sb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

187 .
­³nd
(
Uts
.
by‹sToLÚg
(
’Œy
.
g‘V®ue
().
toA¼ay
())).append(" ");

188 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

189 
fš®
 
Num”icBy‹I‹¿tÜ
 
	g™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

190 
	gisFlßt
 = 
™
.
isFlßtšgPošt
();

191 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

192 .
­³nd
(
isFlßt
 ? 
™
.
g‘DoubË
(è: it.
g‘LÚg
()).append(" ");

194 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

198 
	gsb
.
­³nd
("]");

199 
	gSy¡em
.
	gout
.
´šn
(
sb
);

202 ià(
	gcouÁ
) {

203 ià(!
	gv”bo£
) {

204 
	gisFlßt
 = ((
Num”icBy‹I‹¿tÜ
è
v®ues
.
g‘
(
v®ueKey
)).
isFlßtšgPošt
();

206 
	ghash
 = 
hash
(
bË
, 
key
, 
v®ues
);

207 
šcCouÁ”
(
š£¹s
, 
hash
);

208 
synchrÚized
(
time¡amps
) {

209 
IÁeg”
 
	gùr
 = 
time¡amps
.
g‘
(
Ï¡Time¡amp
);

210 ià(
	gùr
 =ğ
nuÎ
) {

211 
time¡amps
.
put
(
Ï¡Time¡amp
, 1);

213 
	gtime¡amps
.
put
(
Ï¡Time¡amp
, 
ùr
 + 1);

216 ià(
	gisFlßt
) {

217 
šcCouÁ”
(
æßts
, 
hash
);

219 
šcCouÁ”
(
š‹g”s
, 
hash
);

223  
	gStus
.
	gOK
;

226 @
Ov”ride


227 
public
 
	$ş—nup
() {

228 
su³r
.
	`ş—nup
();

229 ià(
couÁ
 && 
couÁ”
 < 1) {

230 
Sy¡em
.
out
.
	`´šn
("[TIMESTAMPS], Unique, " + 
time¡amps
.
	`size
());

231 
Sy¡em
.
out
.
	`´šn
("[FLOATS], Uniqu£r›s, " + 
æßts
.
	`size
());

232 
Sy¡em
.
out
.
	`´šn
("[INTEGERS], Uniqu£r›s, " + 
š‹g”s
.
	`size
());

234 
mšTs
 = 
LÚg
.
MAX_VALUE
;

235 
maxTs
 = 
LÚg
.
MIN_VALUE
;

236 
fš®
 
ts
 : 
time¡amps
.
	`keyS‘
()) {

237 ià(
ts
 > 
maxTs
) {

238 
maxTs
 = 
ts
;

240 ià(
ts
 < 
mšTs
) {

241 
mšTs
 = 
ts
;

244 
Sy¡em
.
out
.
	`´šn
("[TIMESTAMPS], Mš, " + 
mšTs
);

245 
Sy¡em
.
out
.
	`´šn
("[TIMESTAMPS], Max, " + 
maxTs
);

247 
	}
}

249 @
Ov”ride


250 
´Ùeùed
 
hash
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

251 
fš®
 
	gT»eM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gsÜ‹d
 = 
Ãw
 
T»eM­
<
SŒšg
, ByteIterator>();

252 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

253 ià(
’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

255 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

256 
	gÏ¡Time¡amp
 = ((
Num”icBy‹I‹¿tÜ
è
’Œy
.
g‘V®ue
()).
g‘LÚg
();

257 
	g’Œy
.
g‘V®ue
().
»£t
();

260 
	gsÜ‹d
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

264 
SŒšgBud”
 
	gbuf
 = 
Ãw
 SŒšgBud”().
­³nd
(
bË
).­³nd(
key
);

265 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
sÜ‹d
.
’ŒyS‘
()) {

266 
’Œy
.
g‘V®ue
().
»£t
();

267 
	gbuf
.
­³nd
(
’Œy
.
g‘Key
())

268 .
­³nd
(
’Œy
.
g‘V®ue
().
toSŒšg
());

270  
	gbuf
.
toSŒšg
().
hashCode
();

	@core/src/main/java/site/ycsb/ByteArrayByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

22 
public
 cÏs 
	cBy‹A¼ayBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

23 
´iv©e
 
fš®
 
	mÜigš®Off£t
;

24 
´iv©e
 
fš®
 
	mby‹
[] 
	m¡r
;

25 
´iv©e
 
	moff
;

26 
´iv©e
 
fš®
 
	mËn
;

28 
public
 
	$By‹A¼ayBy‹I‹¿tÜ
(
by‹
[] 
s
) {

29 
this
.
¡r
 = 
s
;

30 
this
.
off
 = 0;

31 
this
.
Ën
 = 
s
.
Ëngth
;

32 
Üigš®Off£t
 = 0;

35 
public
 
	$By‹A¼ayBy‹I‹¿tÜ
(
by‹
[] 
s
, 
off
, 
Ën
) {

36 
this
.
¡r
 = 
s
;

37 
this
.
off
 = off;

38 
this
.
Ën
 = 
off
 +†en;

39 
Üigš®Off£t
 = 
off
;

40 
	}
}

42 @
Ov”ride


43 
public
 
boŞ—n
 
	$hasNext
() {

44  
off
 < 
Ën
;

45 
	}
}

47 @
Ov”ride


48 
public
 
by‹
 
	$ÃxtBy‹
() {

49 
by‹
 
»t
 = 
¡r
[
off
];

50 
off
++;

51  
»t
;

52 
	}
}

54 @
Ov”ride


55 
public
 
	$by‹sLeá
() {

56  
Ën
 - 
off
;

57 
	}
}

59 @
Ov”ride


60 
public
 
	$»£t
() {

61 
off
 = 
Üigš®Off£t
;

62 
	}
}

64 @
Ov”ride


65 
public
 
	gby‹
[] 
	$toA¼ay
() {

66 
size
 = (è
	`by‹sLeá
();

67 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
size
];

68 
Sy¡em
.
	`¬¿ycİy
(
¡r
, 
off
, 
by‹s
, 0, 
size
);

69 
off
 = 
Ën
;

70  
by‹s
;

71 
	}
}

	@core/src/main/java/site/ycsb/ByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

20 
impÜt
 
	gjava
.
	gnio
.
	gCh¬Bufãr
;

21 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gCh¬£t
;

22 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

47 
public
 
ab¡¿ù
 
şass
 
By‹I‹¿tÜ
 
im¶em’ts
 
	gI‹¿tÜ
<
	gBy‹
> {

49 @
Ov”ride


50 
public
 
ab¡¿ù
 
boŞ—n
 
hasNext
();

52 @
Ov”ride


53 
public
 
By‹
 
Ãxt
() {

54 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

57 
public
 
ab¡¿ù
 
by‹
 
ÃxtBy‹
();

60 
public
 
ÃxtBuf
(
by‹
[] 
buf
, 
bufOff
) {

61 
	gsz
 = 
bufOff
;

62 
	gsz
 < 
	gbuf
.
	gËngth
 && 
hasNext
()) {

63 
	gbuf
[
sz
] = 
ÃxtBy‹
();

64 
	gsz
++;

66  
	gsz
;

69 
public
 
ab¡¿ù
 
by‹sLeá
();

71 @
Ov”ride


72 
public
 
»move
() {

73 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

81 
public
 
»£t
() {

82 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

86 
public
 
SŒšg
 
toSŒšg
() {

87 
Ch¬£t
 
	gc£t
 = Ch¬£t.
fÜName
("UTF-8");

88 
Ch¬Bufãr
 
	gcb
 = 
c£t
.
decode
(
By‹Bufãr
.
w¿p
(
this
.
toA¼ay
()));

89  
	gcb
.
toSŒšg
();

93 
public
 
	gby‹
[] 
toA¼ay
() {

94 
	gËá
 = 
by‹sLeá
();

95 ià(
	gËá
 !ğ(è
Ëá
) {

96 
throw
 
Ãw
 
A¼ayIndexOutOfBoundsExû±iÚ
("Too much datao fit in one‡rray!");

98 
	gby‹
[] 
	g»t
 = 
Ãw
 
by‹
[(è
Ëá
];

99 
	gi
 = 0; i < 
	g»t
.
	gËngth
; i++) {

100 
	g»t
[
i
] = 
ÃxtBy‹
();

102  
	g»t
;

	@core/src/main/java/site/ycsb/Client.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gTextM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gHT¿ûCÚfigu¿tiÚ
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûScİe
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûr
;

27 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

28 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

29 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

30 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

31 
impÜt
 
	gjava
.
	gut
.*;

32 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

40 
fš®
 cÏs 
	cRemaššgFÜm©‹r
 {

41 
´iv©e
 
	$RemaššgFÜm©‹r
() {

45 
public
 
SŒšgBud”
 
	$fÜm©
(
£cÚds
) {

46 
SŒšgBud”
 
time
 = 
Ãw
 
	`SŒšgBud”
();

47 
days
 = 
TimeUn™
.
SECONDS
.
	`toDays
(
£cÚds
);

48 ià(
days
 > 0) {

49 
time
.
	`­³nd
(
days
).append(days == 1 ? " day " : " days ");

50 
£cÚds
 -ğ
TimeUn™
.
DAYS
.
	`toSecÚds
(
days
);

52 
hours
 = 
TimeUn™
.
SECONDS
.
	`toHours
(
£cÚds
);

53 ià(
hours
 > 0) {

54 
time
.
	`­³nd
(
hours
).append(hours == 1 ? " hour " : " hours ");

55 
£cÚds
 -ğ
TimeUn™
.
HOURS
.
	`toSecÚds
(
hours
);

58 ià(
days
 < 1) {

59 
mšu‹s
 = 
TimeUn™
.
SECONDS
.
	`toMšu‹s
(
£cÚds
);

60 ià(
mšu‹s
 > 0) {

61 
time
.
	`­³nd
(
mšu‹s
).append(minutes == 1 ? " minute " : " minutes ");

62 
£cÚds
 -ğ
TimeUn™
.
MINUTES
.
	`toSecÚds
(seconds);

66 ià(
time
.
	`Ëngth
() == 0) {

67 
time
.
	`­³nd
(
£cÚds
).­³ndÑime.
	`Ëngth
() == 1 ? " second " : " seconds ");

69  
time
;

70 
	}
}

76 
public
 
fš®
 cÏs 
	cCl›Á
 {

77 
´iv©e
 
	$Cl›Á
() {

81 
public
 
fš®
 
SŒšg
 
DEFAULT_RECORD_COUNT
 = "0";

86 
public
 
fš®
 
SŒšg
 
OPERATION_COUNT_PROPERTY
 = "operationcount";

91 
public
 
fš®
 
SŒšg
 
RECORD_COUNT_PROPERTY
 = "recordcount";

96 
public
 
fš®
 
SŒšg
 
WORKLOAD_PROPERTY
 = "workload";

101 
public
 
fš®
 
SŒšg
 
DB_PROPERTY
 = "db";

107 
public
 
fš®
 
SŒšg
 
EXPORTER_PROPERTY
 = "exporter";

113 
public
 
fš®
 
SŒšg
 
EXPORT_FILE_PROPERTY
 = "exportfile";

118 
public
 
fš®
 
SŒšg
 
THREAD_COUNT_PROPERTY
 = "threadcount";

125 
public
 
fš®
 
SŒšg
 
INSERT_COUNT_PROPERTY
 = "insertcount";

130 
public
 
fš®
 
SŒšg
 
TARGET_PROPERTY
 = "target";

135 
public
 
fš®
 
SŒšg
 
MAX_EXECUTION_TIME
 = "maxexecutiontime";

140 
public
 
fš®
 
SŒšg
 
DO_TRANSACTIONS_PROPERTY
 = "dotransactions";

145 
public
 
fš®
 
SŒšg
 
STATUS_PROPERTY
 = "status";

150 
public
 
fš®
 
SŒšg
 
LABEL_PROPERTY
 = "label";

155 
´iv©e
 
StusTh»ad
 
¡©u¡h»ad
 = 
nuÎ
;

162 
´iv©e
 
fš®
 
SŒšg
 
HTRACE_KEY_PREFIX
 = "htrace.";

163 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_WORKLOAD_INIT_SPAN
 = "Client#workload_init";

164 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_INIT_SPAN
 = "Client#init";

165 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_WORKLOAD_SPAN
 = "Client#workload";

166 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_CLEANUP_SPAN
 = "Client#cleanup";

167 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_EXPORT_MEASUREMENTS_SPAN
 = "Client#export_measurements";

169 
public
 
	$u§geMes§ge
() {

170 
Sy¡em
.
out
.
	`´šn
("Usage: java site.ycsb.Client [options]");

171 
Sy¡em
.
out
.
	`´šn
("Options:");

172 
Sy¡em
.
out
.
	`´šn
(" -threads‚:ƒxecute using‚hreads (default: 1) - can‡lso be specified‡she \n" +

174 
Sy¡em
.
out
.
	`´šn
(" -target‚:‡ttempto do‚ operations…er second (default: unlimited) - can‡lso\n" +

176 
Sy¡em
.
out
.
	`´šn
(" -load:„unhe†oading…hase ofhe workload");

177 
Sy¡em
.
out
.
	`´šn
(" -t:„unheransactions…hase ofhe workload (default)");

178 
Sy¡em
.
out
.
	`´šn
(" -db dbname: specifyhe‚ame ofhe DBo use (default: site.ycsb.BasicDB) - \n" +

180 
Sy¡em
.
out
.
	`´šn
(" -P…ropertyfile:†oad…roperties fromhe given file. Multiple files can");

181 
Sy¡em
.
out
.
	`´šn
(" be specified,‡nd will be…rocessed inhe order specified");

182 
Sy¡em
.
out
.
	`´šn
(" -p‚ame=value: specify‡…ropertyo be…assedohe DB‡nd workloads;");

183 
Sy¡em
.
out
.
	`´šn
(" multiple…roperties can be specified,‡nd override‡ny");

184 
Sy¡em
.
out
.
	`´šn
(" values inhe…ropertyfile");

185 
Sy¡em
.
out
.
	`´šn
(" -s: show status during„un (default:‚o status)");

186 
Sy¡em
.
out
.
	`´šn
(" -l†abel: use†abel for status (e.g.o†abel oneƒxperiment out of‡ whole batch)");

187 
Sy¡em
.
out
.
	`´šn
("");

188 
Sy¡em
.
out
.
	`´šn
("Required…roperties:");

189 
Sy¡em
.
out
.
	`´šn
(" " + 
WORKLOAD_PROPERTY
 + ":he‚ame ofhe workload classo use (e.g. " +

191 
Sy¡em
.
out
.
	`´šn
("");

192 
Sy¡em
.
out
.
	`´šn
("To„unheransaction…hase from multiple servers, start‡ separate client onƒach.");

193 
Sy¡em
.
out
.
	`´šn
("To„unhe†oad…hase from multiple servers, start‡ separate client onƒach;‡dditionally,");

194 
Sy¡em
.
out
.
	`´šn
("usehe \"insertcount\"‡nd \"insertstart\"…ropertieso divide uphe„ecords " +

196 
	}
}

198 
public
 
boŞ—n
 
	$checkRequœedPrİ”t›s
(
Prİ”t›s
 
´İs
) {

199 ià(
´İs
.
	`g‘Prİ”ty
(
WORKLOAD_PROPERTY
è=ğ
nuÎ
) {

200 
Sy¡em
.
out
.
	`´šn
("Missšg…rİ”ty: " + 
WORKLOAD_PROPERTY
);

201  
çl£
;

204  
Œue
;

205 
	}
}

214 
´iv©e
 
	$expÜtM—su»m’ts
(
Prİ”t›s
 
´İs
, 
İcouÁ
, 
ruÁime
)

215 
throws
 
IOExû±iÚ
 {

216 
M—su»m’tsExpÜ‹r
 
expÜ‹r
 = 
nuÎ
;

217 
Œy
 {

219 
OuutSŒ—m
 
out
;

220 
SŒšg
 
expÜtFe
 = 
´İs
.
	`g‘Prİ”ty
(
EXPORT_FILE_PROPERTY
);

221 ià(
expÜtFe
 =ğ
nuÎ
) {

222 
out
 = 
Sy¡em
.out;

224 
out
 = 
Ãw
 
	`FeOuutSŒ—m
(
expÜtFe
);

228 
SŒšg
 
expÜ‹rSŒ
 = 
´İs
.
	`g‘Prİ”ty
(
EXPORTER_PROPERTY
,

230 
Œy
 {

231 
expÜ‹r
 = (
M—su»m’tsExpÜ‹r
è
CÏss
.
	`fÜName
(
expÜ‹rSŒ
).
	`g‘CÚ¡ruùÜ
(
OuutSŒ—m
.
şass
)

232 .
	`ÃwIn¡ªû
(
out
);

233 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

234 
Sy¡em
.
”r
.
	`´šn
("Could‚Ù fšdƒxpÜ‹¸" + 
expÜ‹rSŒ


236 
e
.
	`´štSckT¿û
();

237 
expÜ‹r
 = 
Ãw
 
	`TextM—su»m’tsExpÜ‹r
(
out
);

240 
expÜ‹r
.
	`wr™e
("OVERALL", "RunTime(ms)", 
ruÁime
);

241 
throughput
 = 1000.0 * (
İcouÁ
è/ (
ruÁime
);

242 
expÜ‹r
.
	`wr™e
("OVERALL", "Throughput(İs/£c)", 
throughput
);

244 
fš®
 
M­
<
SŒšg
, 
LÚg
[]> 
gcs
 = 
Uts
.
	`g‘GCSt¡
();

245 
tÙ®GCCouÁ
 = 0;

246 
tÙ®GCTime
 = 0;

247 
fš®
 
EÁry
<
SŒšg
, 
LÚg
[]> 
’Œy
 : 
gcs
.
	`’ŒyS‘
()) {

248 
expÜ‹r
.
	`wr™e
("TOTAL_GCS_" + 
’Œy
.
	`g‘Key
(), "CouÁ",ƒÁry.
	`g‘V®ue
()[0]);

249 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME_" + 
’Œy
.
	`g‘Key
(), "Time(ms)",ƒÁry.
	`g‘V®ue
()[1]);

250 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME_%_" + 
’Œy
.
	`g‘Key
(), "Time(%)",

251 ((è
’Œy
.
	`g‘V®ue
()[1] / 
ruÁime
) * () 100);

252 
tÙ®GCCouÁ
 +ğ
’Œy
.
	`g‘V®ue
()[0];

253 
tÙ®GCTime
 +ğ
’Œy
.
	`g‘V®ue
()[1];

255 
expÜ‹r
.
	`wr™e
("TOTAL_GCs", "CouÁ", 
tÙ®GCCouÁ
);

257 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME", "Time(ms)", 
tÙ®GCTime
);

258 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME_%", "Time(%)", ((è
tÙ®GCTime
 / 
ruÁime
) * () 100);

259 ià(
¡©u¡h»ad
 !ğ
nuÎ
 && stu¡h»ad.
	`ŒackJVMSts
()) {

260 
expÜ‹r
.
	`wr™e
("MAX_MEM_USED", "MBs", 
¡©u¡h»ad
.
	`g‘MaxU£dMem
());

261 
expÜ‹r
.
	`wr™e
("MIN_MEM_USED", "MBs", 
¡©u¡h»ad
.
	`g‘MšU£dMem
());

262 
expÜ‹r
.
	`wr™e
("MAX_THREADS", "CouÁ", 
¡©u¡h»ad
.
	`g‘MaxTh»ads
());

263 
expÜ‹r
.
	`wr™e
("MIN_THREADS", "CouÁ", 
¡©u¡h»ad
.
	`g‘MšTh»ads
());

264 
expÜ‹r
.
	`wr™e
("MAX_SYS_LOAD_AVG", "Lßd", 
¡©u¡h»ad
.
	`g‘MaxLßdAvg
());

265 
expÜ‹r
.
	`wr™e
("MIN_SYS_LOAD_AVG", "Lßd", 
¡©u¡h»ad
.
	`g‘MšLßdAvg
());

268 
M—su»m’ts
.
	`g‘M—su»m’ts
().
	`expÜtM—su»m’ts
(
expÜ‹r
);

269 } 
fš®ly
 {

270 ià(
expÜ‹r
 !ğ
nuÎ
) {

271 
expÜ‹r
.
	`şo£
();

274 
	}
}

276 @
Suµ»ssW¬nšgs
("unchecked")

277 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

278 
Prİ”t›s
 
´İs
 = 
	`·r£Argum’ts
(
¬gs
);

280 
boŞ—n
 
¡©us
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
STATUS_PROPERTY
, 
SŒšg
.v®ueOf(
çl£
)));

281 
SŒšg
 
Ïb–
 = 
´İs
.
	`g‘Prİ”ty
(
LABEL_PROPERTY
, "");

283 
maxExecutiÚTime
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
MAX_EXECUTION_TIME
, "0"));

286 
th»adcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
THREAD_COUNT_PROPERTY
, "1"));

287 
SŒšg
 
dbÇme
 = 
´İs
.
	`g‘Prİ”ty
(
DB_PROPERTY
, "site.ycsb.BasicDB");

288 
rg‘
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
TARGET_PROPERTY
, "0"));

291 
rg‘³¹h»ad³rms
 = -1;

292 ià(
rg‘
 > 0) {

293 
rg‘³¹h»ad
 = ((è
rg‘
è/ ((è
th»adcouÁ
);

294 
rg‘³¹h»ad³rms
 = 
rg‘³¹h»ad
 / 1000.0;

297 
Th»ad
 
w¬nšgth»ad
 = 
	`£tupW¬nšgTh»ad
();

298 
w¬nšgth»ad
.
	`¡¬t
();

300 
M—su»m’ts
.
	`£tPrİ”t›s
(
´İs
);

302 
WÜklßd
 
wÜklßd
 = 
	`g‘WÜklßd
(
´İs
);

304 
fš®
 
T¿ûr
 
Œaûr
 = 
	`g‘T¿ûr
(
´İs
, 
wÜklßd
);

306 
	`š™WÜklßd
(
´İs
, 
w¬nšgth»ad
, 
wÜklßd
, 
Œaûr
);

308 
Sy¡em
.
”r
.
	`´šn
("Startingest.");

309 
fš®
 
CouÁDownL©ch
 
com¶‘eL©ch
 = 
Ãw
 
	`CouÁDownL©ch
(
th»adcouÁ
);

311 
fš®
 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
 = 
	`š™Db
(
dbÇme
, 
´İs
, 
th»adcouÁ
, 
rg‘³¹h»ad³rms
,

312 
wÜklßd
, 
Œaûr
, 
com¶‘eL©ch
);

314 ià(
¡©us
) {

315 
boŞ—n
 
¡ªd¬d¡©us
 = 
çl£
;

316 ià(
´İs
.
	`g‘Prİ”ty
(
M—su»m’ts
.
MEASUREMENT_TYPE_PROPERTY
, "").
	`com·»To
("timeseries") == 0) {

317 
¡ªd¬d¡©us
 = 
Œue
;

319 
¡©usIÁ”v®SecÚds
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("status.interval", "10"));

320 
boŞ—n
 
ŒackJVMSts
 = 
´İs
.
	`g‘Prİ”ty
(
M—su»m’ts
.
MEASUREMENT_TRACK_JVM_PROPERTY
,

321 
M—su»m’ts
.
MEASUREMENT_TRACK_JVM_PROPERTY_DEFAULT
).
	`equ®s
("true");

322 
¡©u¡h»ad
 = 
Ãw
 
	`StusTh»ad
(
com¶‘eL©ch
, 
ş›Ás
, 
Ïb–
, 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
,

323 
ŒackJVMSts
);

324 
¡©u¡h»ad
.
	`¡¬t
();

327 
Th»ad
 
‹rmš©Ü
 = 
nuÎ
;

328 
¡
;

329 
’
;

330 
İsDÚe
;

332 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_WORKLOAD_SPAN
)) {

334 
fš®
 
M­
<
Th»ad
, 
Cl›ÁTh»ad
> 
th»ads
 = 
Ãw
 
HashM­
<>(
th»adcouÁ
);

335 
Cl›ÁTh»ad
 
ş›Á
 : 
ş›Ás
) {

336 
th»ads
.
	`put
(
Ãw
 
	`Th»ad
(
Œaûr
.
	`w¿p
(
ş›Á
, "ClientThread")), client);

339 
¡
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

341 
Th»ad
 
t
 : 
th»ads
.
	`keyS‘
()) {

342 
t
.
	`¡¬t
();

345 ià(
maxExecutiÚTime
 > 0) {

346 
‹rmš©Ü
 = 
Ãw
 
	`T”mš©ÜTh»ad
(
maxExecutiÚTime
, 
th»ads
.
	`keyS‘
(), 
wÜklßd
);

347 
‹rmš©Ü
.
	`¡¬t
();

350 
İsDÚe
 = 0;

352 
M­
.
EÁry
<
Th»ad
, 
Cl›ÁTh»ad
> 
’Œy
 : 
th»ads
.
	`’ŒyS‘
()) {

353 
Œy
 {

354 
’Œy
.
	`g‘Key
().
	`još
();

355 
İsDÚe
 +ğ
’Œy
.
	`g‘V®ue
().
	`g‘OpsDÚe
();

356 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
ignÜed
) {

361 
’
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

364 
Œy
 {

365 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_CLEANUP_SPAN
)) {

367 ià(
‹rmš©Ü
 !ğ
nuÎ
 && !‹rmš©Ü.
	`isIÁ”ru±ed
()) {

368 
‹rmš©Ü
.
	`š‹¼u±
();

371 ià(
¡©us
) {

373 
¡©u¡h»ad
.
	`š‹¼u±
();

375 
Œy
 {

376 
¡©u¡h»ad
.
	`još
();

377 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
ignÜed
) {

382 
wÜklßd
.
	`ş—nup
();

384 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) {

385 
e
.
	`´štSckT¿û
();

386 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

387 
Sy¡em
.
	`ex™
(0);

390 
Œy
 {

391 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_EXPORT_MEASUREMENTS_SPAN
)) {

392 
	`expÜtM—su»m’ts
(
´İs
, 
İsDÚe
, 
’
 - 
¡
);

394 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

395 
Sy¡em
.
”r
.
	`´šn
("Could‚ÙƒxpÜˆm—su»m’ts,ƒ¼Ü: " + 
e
.
	`g‘Mes§ge
());

396 
e
.
	`´štSckT¿û
();

397 
Sy¡em
.
	`ex™
(-1);

400 
Sy¡em
.
	`ex™
(0);

401 
	}
}

403 
´iv©e
 
	gLi¡
<
	gCl›ÁTh»ad
> 
	$š™Db
(
SŒšg
 
dbÇme
, 
Prİ”t›s
 
´İs
, 
th»adcouÁ
,

404 
rg‘³¹h»ad³rms
, 
WÜklßd
 
wÜklßd
, 
T¿ûr
 
Œaûr
,

405 
CouÁDownL©ch
 
com¶‘eL©ch
) {

406 
boŞ—n
 
š™Faed
 = 
çl£
;

407 
boŞ—n
 
dÙ¿n§ùiÚs
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
DO_TRANSACTIONS_PROPERTY
, 
SŒšg
.v®ueOf(
Œue
)));

409 
fš®
 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
 = 
Ãw
 
A¼ayLi¡
<>(
th»adcouÁ
);

410 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_INIT_SPAN
)) {

411 
İcouÁ
;

412 ià(
dÙ¿n§ùiÚs
) {

413 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
OPERATION_COUNT_PROPERTY
, "0"));

415 ià(
´İs
.
	`cÚšsKey
(
INSERT_COUNT_PROPERTY
)) {

416 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
INSERT_COUNT_PROPERTY
, "0"));

418 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
RECORD_COUNT_PROPERTY
, 
DEFAULT_RECORD_COUNT
));

421 ià(
th»adcouÁ
 > 
İcouÁ
 && opcount > 0){

422 
th»adcouÁ
 = 
İcouÁ
;

423 
Sy¡em
.
out
.
	`´šn
("Warning:hehreadcount is biggerhan„ecordcount,hehreadcount will be„ecordcount!");

425 
th»adid
 = 0;h»adid < 
th»adcouÁ
;hreadid++) {

426 
DB
 
db
;

427 
Œy
 {

428 
db
 = 
DBFaùÜy
.
	`ÃwDB
(
dbÇme
, 
´İs
, 
Œaûr
);

429 } 
	`ÿtch
 (
UnknownDBExû±iÚ
 
e
) {

430 
Sy¡em
.
out
.
	`´šn
("UnknowÀDB " + 
dbÇme
);

431 
š™Faed
 = 
Œue
;

435 
th»adİcouÁ
 = 
İcouÁ
 / 
th»adcouÁ
;

438 ià(
th»adid
 < 
İcouÁ
 % 
th»adcouÁ
) {

439 ++
th»adİcouÁ
;

442 
Cl›ÁTh»ad
 
t
 = 
Ãw
 
	`Cl›ÁTh»ad
(
db
, 
dÙ¿n§ùiÚs
, 
wÜklßd
, 
´İs
, 
th»adİcouÁ
, 
rg‘³¹h»ad³rms
,

443 
com¶‘eL©ch
);

444 
t
.
	`£tTh»adId
(
th»adid
);

445 
t
.
	`£tTh»adCouÁ
(
th»adcouÁ
);

446 
ş›Ás
.
	`add
(
t
);

449 ià(
š™Faed
) {

450 
Sy¡em
.
”r
.
	`´šn
("Error initializing datastore bindings.");

451 
Sy¡em
.
	`ex™
(0);

454  
ş›Ás
;

455 
	}
}

457 
´iv©e
 
T¿ûr
 
	$g‘T¿ûr
(
Prİ”t›s
 
´İs
, 
WÜklßd
 
wÜklßd
) {

458  
Ãw
 
T¿ûr
.
	`Bud”
("YCSB " + 
wÜklßd
.
	`g‘CÏss
().
	`g‘Sim¶eName
())

459 .
	`cÚf
(
	`g‘HT¿ûCÚfigu¿tiÚ
(
´İs
))

460 .
	`bud
();

461 
	}
}

463 
´iv©e
 
	$š™WÜklßd
(
Prİ”t›s
 
´İs
, 
Th»ad
 
w¬nšgth»ad
, 
WÜklßd
 
wÜklßd
, 
T¿ûr
 
Œaûr
) {

464 
Œy
 {

465 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_WORKLOAD_INIT_SPAN
)) {

466 
wÜklßd
.
	`š™
(
´İs
);

467 
w¬nšgth»ad
.
	`š‹¼u±
();

469 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) {

470 
e
.
	`´štSckT¿û
();

471 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

472 
Sy¡em
.
	`ex™
(0);

474 
	}
}

476 
´iv©e
 
HT¿ûCÚfigu¿tiÚ
 
	$g‘HT¿ûCÚfigu¿tiÚ
(
Prİ”t›s
 
´İs
) {

477 
fš®
 
M­
<
SŒšg
, SŒšg> 
f‹»dPrİ”t›s
 = 
Ãw
 
HashM­
<>();

478 
SŒšg
 
key
 : 
´İs
.
	`¡ršgPrİ”tyNames
()) {

479 ià(
key
.
	`¡¬tsW™h
(
HTRACE_KEY_PREFIX
)) {

480 
f‹»dPrİ”t›s
.
	`put
(
key
.
	`sub¡ršg
(
HTRACE_KEY_PREFIX
.
	`Ëngth
()), 
´İs
.
	`g‘Prİ”ty
(key));

483  
HT¿ûCÚfigu¿tiÚ
.
	`äomM­
(
f‹»dPrİ”t›s
);

484 
	}
}

486 
´iv©e
 
Th»ad
 
	$£tupW¬nšgTh»ad
() {

490  
Ãw
 
	`Th»ad
() {

491 @
Ov”ride


492 
public
 
	`run
() {

493 
Œy
 {

494 
	`¦“p
(2000);

495 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

498 
Sy¡em
.
”r
.
	`´šn
(" (mightake‡ few minutes for†arge data sets)");

501 
	}
}

503 
´iv©e
 
WÜklßd
 
	$g‘WÜklßd
(
Prİ”t›s
 
´İs
) {

504 
CÏssLßd”
 
şassLßd”
 = 
Cl›Á
.
şass
.
	`g‘CÏssLßd”
();

506 
Œy
 {

507 
Prİ”t›s
 
´ojeùPrİ
 = 
Ãw
 
	`Prİ”t›s
();

508 
´ojeùPrİ
.
	`lßd
(
şassLßd”
.
	`g‘ResourûAsSŒ—m
("project.properties"));

509 
Sy¡em
.
”r
.
	`´šn
("YCSB Cl›Á " + 
´ojeùPrİ
.
	`g‘Prİ”ty
("version"));

510 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

511 
Sy¡em
.
”r
.
	`´šn
("Unableo„etrieve client version.");

514 
Sy¡em
.
”r
.
	`´šn
();

515 
Sy¡em
.
”r
.
	`´šn
("Loading workload...");

516 
Œy
 {

517 
CÏss
 
wÜklßdşass
 = 
şassLßd”
.
	`lßdCÏss
(
´İs
.
	`g‘Prİ”ty
(
WORKLOAD_PROPERTY
));

519  (
WÜklßd
è
wÜklßdşass
.
	`ÃwIn¡ªû
();

520 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

521 
e
.
	`´štSckT¿û
();

522 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

523 
Sy¡em
.
	`ex™
(0);

526  
nuÎ
;

527 
	}
}

529 
´iv©e
 
Prİ”t›s
 
	$·r£Argum’ts
(
SŒšg
[] 
¬gs
) {

530 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

531 
Sy¡em
.
”r
.
	`´št
("Command†ine:");

532 
SŒšg
 
¬g
 : 
¬gs
) {

533 
Sy¡em
.
”r
.
	`´št
(" " + 
¬g
);

535 
Sy¡em
.
”r
.
	`´šn
();

537 
Prİ”t›s
 
f•rİs
 = 
Ãw
 
	`Prİ”t›s
();

538 
¬gšdex
 = 0;

540 ià(
¬gs
.
Ëngth
 == 0) {

541 
	`u§geMes§ge
();

542 
Sy¡em
.
out
.
	`´šn
("At†east one‡rgument specifying‡ workload is„equired.");

543 
Sy¡em
.
	`ex™
(0);

546 
¬gs
[
¬gšdex
].
	`¡¬tsW™h
("-")) {

547 ià(
¬gs
[
¬gšdex
].
	`com·»To
("-threads") == 0) {

548 
¬gšdex
++;

549 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

550 
	`u§geMes§ge
();

551 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -threads.");

552 
Sy¡em
.
	`ex™
(0);

554 
tcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[
¬gšdex
]);

555 
´İs
.
	`£tPrİ”ty
(
THREAD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
tcouÁ
));

556 
¬gšdex
++;

557 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-target") == 0) {

558 
¬gšdex
++;

559 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

560 
	`u§geMes§ge
();

561 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -target.");

562 
Sy¡em
.
	`ex™
(0);

564 
‰¬g‘
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[
¬gšdex
]);

565 
´İs
.
	`£tPrİ”ty
(
TARGET_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
‰¬g‘
));

566 
¬gšdex
++;

567 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-load") == 0) {

568 
´İs
.
	`£tPrİ”ty
(
DO_TRANSACTIONS_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
çl£
));

569 
¬gšdex
++;

570 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-t") == 0) {

571 
´İs
.
	`£tPrİ”ty
(
DO_TRANSACTIONS_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
Œue
));

572 
¬gšdex
++;

573 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-s") == 0) {

574 
´İs
.
	`£tPrİ”ty
(
STATUS_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
Œue
));

575 
¬gšdex
++;

576 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-db") == 0) {

577 
¬gšdex
++;

578 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

579 
	`u§geMes§ge
();

580 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -db.");

581 
Sy¡em
.
	`ex™
(0);

583 
´İs
.
	`£tPrİ”ty
(
DB_PROPERTY
, 
¬gs
[
¬gšdex
]);

584 
¬gšdex
++;

585 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-l") == 0) {

586 
¬gšdex
++;

587 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

588 
	`u§geMes§ge
();

589 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -l.");

590 
Sy¡em
.
	`ex™
(0);

592 
´İs
.
	`£tPrİ”ty
(
LABEL_PROPERTY
, 
¬gs
[
¬gšdex
]);

593 
¬gšdex
++;

594 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-P") == 0) {

595 
¬gšdex
++;

596 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

597 
	`u§geMes§ge
();

598 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -P.");

599 
Sy¡em
.
	`ex™
(0);

601 
SŒšg
 
´İfe
 = 
¬gs
[
¬gšdex
];

602 
¬gšdex
++;

604 
Prİ”t›s
 
myf•rİs
 = 
Ãw
 
	`Prİ”t›s
();

605 
Œy
 {

606 
myf•rİs
.
	`lßd
(
Ãw
 
	`FeIÅutSŒ—m
(
´İfe
));

607 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

608 
Sy¡em
.
out
.
	`´šn
("UÇbËØİ’h´İ”t› f" + 
´İfe
);

609 
Sy¡em
.
out
.
	`´šn
(
e
.
	`g‘Mes§ge
());

610 
Sy¡em
.
	`ex™
(0);

614 
Enum”©iÚ
 
e
 = 
myf•rİs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

615 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

617 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
myf•rİs
.
	`g‘Prİ”ty
(prop));

620 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-p") == 0) {

621 
¬gšdex
++;

622 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

623 
	`u§geMes§ge
();

624 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -p");

625 
Sy¡em
.
	`ex™
(0);

627 
eq
 = 
¬gs
[
¬gšdex
].
	`šdexOf
('=');

628 ià(
eq
 < 0) {

629 
	`u§geMes§ge
();

630 
Sy¡em
.
out
.
	`´šn
("Argument '-p'ƒxpectedo be in key=value format (e.g., -p operationcount=99999)");

631 
Sy¡em
.
	`ex™
(0);

634 
SŒšg
 
Çme
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(0, 
eq
);

635 
SŒšg
 
v®ue
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(
eq
 + 1);

636 
´İs
.
	`put
(
Çme
, 
v®ue
);

637 
¬gšdex
++;

639 
	`u§geMes§ge
();

640 
Sy¡em
.
out
.
	`´šn
("UnknowÀİtiÚ " + 
¬gs
[
¬gšdex
]);

641 
Sy¡em
.
	`ex™
(0);

644 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

649 ià(
¬gšdex
 !ğ
¬gs
.
Ëngth
) {

650 
	`u§geMes§ge
();

651 ià(
¬gšdex
 < 
¬gs
.
Ëngth
) {

652 
Sy¡em
.
out
.
	`´šn
("An‡rgument value without corresponding‡rgument specifier (e.g., -p, -s) was found. "

653 + "Wex³ùed‡À¬gum’ˆ¥ecif›¸ªd in¡—d found " + 
¬gs
[
¬gšdex
]);

655 
Sy¡em
.
out
.
	`´šn
("An‡rgument specifier without corresponding value was found‡theƒnd ofhe supplied " +

658 
Sy¡em
.
	`ex™
(0);

664 
Enum”©iÚ
 
e
 = 
´İs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

665 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

667 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
´İs
.
	`g‘Prİ”ty
(prop));

670 
´İs
 = 
f•rİs
;

672 ià(!
	`checkRequœedPrİ”t›s
(
´İs
)) {

673 
Sy¡em
.
out
.
	`´šn
("Failed check„equired…roperties.");

674 
Sy¡em
.
	`ex™
(0);

677  
´İs
;

678 
	}
}

	@core/src/main/java/site/ycsb/ClientThread.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

29 
public
 cÏs 
	cCl›ÁTh»ad
 
im¶em’ts
 
	mRuÂabË
 {

31 
´iv©e
 
fš®
 
CouÁDownL©ch
 
	mcom¶‘eL©ch
;

33 
´iv©e
 
boŞ—n
 
	m¥šSË•
;

34 
´iv©e
 
DB
 
	mdb
;

35 
´iv©e
 
boŞ—n
 
	mdÙ¿n§ùiÚs
;

36 
´iv©e
 
WÜklßd
 
	mwÜklßd
;

37 
´iv©e
 
	mİcouÁ
;

38 
´iv©e
 
	mrg‘OpsP”Ms
;

40 
´iv©e
 
	mİsdÚe
;

41 
´iv©e
 
	mth»adid
;

42 
´iv©e
 
	mth»adcouÁ
;

43 
´iv©e
 
Objeù
 
	mwÜklßd¡©e
;

44 
´iv©e
 
Prİ”t›s
 
	m´İs
;

45 
´iv©e
 
	mrg‘OpsTickNs
;

46 
´iv©e
 
fš®
 
M—su»m’ts
 
	mm—su»m’ts
;

59 
public
 
	$Cl›ÁTh»ad
(
DB
 
db
, 
boŞ—n
 
dÙ¿n§ùiÚs
, 
WÜklßd
 
wÜklßd
, 
Prİ”t›s
 
´İs
, 
İcouÁ
,

60 
rg‘³¹h»ad³rms
, 
CouÁDownL©ch
 
com¶‘eL©ch
) {

61 
this
.
db
 = db;

62 
this
.
dÙ¿n§ùiÚs
 = dotransactions;

63 
this
.
wÜklßd
 = workload;

64 
this
.
İcouÁ
 = opcount;

65 
İsdÚe
 = 0;

66 ià(
rg‘³¹h»ad³rms
 > 0) {

67 
rg‘OpsP”Ms
 = 
rg‘³¹h»ad³rms
;

68 
rg‘OpsTickNs
 = (è(1000000 / 
rg‘OpsP”Ms
);

70 
this
.
´İs
 =…rops;

71 
m—su»m’ts
 = 
M—su»m’ts
.
	`g‘M—su»m’ts
();

72 
¥šSË•
 = 
BoŞ—n
.
	`v®ueOf
(
this
.
´İs
.
	`g‘Prİ”ty
("spin.sleep", "false"));

73 
this
.
com¶‘eL©ch
 = completeLatch;

76 
public
 
	$£tTh»adId
(
fš®
 
th»adId
) {

77 
th»adid
 = 
th»adId
;

78 
	}
}

80 
public
 
	$£tTh»adCouÁ
(
fš®
 
th»adCouÁ
) {

81 
th»adcouÁ
 = 
th»adCouÁ
;

82 
	}
}

84 
public
 
	$g‘OpsDÚe
() {

85  
İsdÚe
;

86 
	}
}

88 @
Ov”ride


89 
public
 
	$run
() {

90 
Œy
 {

91 
db
.
	`š™
();

92 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

93 
e
.
	`´štSckT¿û
();

94 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

98 
Œy
 {

99 
wÜklßd¡©e
 = 
wÜklßd
.
	`š™Th»ad
(
´İs
, 
th»adid
, 
th»adcouÁ
);

100 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) {

101 
e
.
	`´štSckT¿û
();

102 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

112 ià((
rg‘OpsP”Ms
 > 0) && (targetOpsPerMs <= 1.0)) {

113 
¿ndomMšÜD–ay
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
((è
rg‘OpsTickNs
);

114 
	`¦“pUÁ
(
Sy¡em
.
	`ÇnoTime
(è+ 
¿ndomMšÜD–ay
);

116 
Œy
 {

117 ià(
dÙ¿n§ùiÚs
) {

118 
¡¬tTimeNªos
 = 
Sy¡em
.
	`ÇnoTime
();

120 ((
İcouÁ
 =ğ0è|| (
İsdÚe
 < opcouÁ)è&& !
wÜklßd
.
	`isStİReque¡ed
()) {

122 ià(!
wÜklßd
.
	`doT¿n§ùiÚ
(
db
, 
wÜklßd¡©e
)) {

126 
İsdÚe
++;

128 
	`thrÙeNªos
(
¡¬tTimeNªos
);

131 
¡¬tTimeNªos
 = 
Sy¡em
.
	`ÇnoTime
();

133 ((
İcouÁ
 =ğ0è|| (
İsdÚe
 < opcouÁ)è&& !
wÜklßd
.
	`isStİReque¡ed
()) {

135 ià(!
wÜklßd
.
	`doIn£¹
(
db
, 
wÜklßd¡©e
)) {

139 
İsdÚe
++;

141 
	`thrÙeNªos
(
¡¬tTimeNªos
);

144 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

145 
e
.
	`´štSckT¿û
();

146 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

147 
Sy¡em
.
	`ex™
(0);

150 
Œy
 {

151 
m—su»m’ts
.
	`£tIÁ’dedS¹TimeNs
(0);

152 
db
.
	`ş—nup
();

153 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

154 
e
.
	`´štSckT¿û
();

155 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

156 } 
fš®ly
 {

157 
com¶‘eL©ch
.
	`couÁDown
();

159 
	}
}

161 
´iv©e
 
	$¦“pUÁ
(
d—dlše
) {

162 
Sy¡em
.
	`ÇnoTime
(è< 
d—dlše
) {

163 ià(!
¥šSË•
) {

164 
LockSuµÜt
.
	`·rkNªos
(
d—dlše
 - 
Sy¡em
.
	`ÇnoTime
());

167 
	}
}

169 
´iv©e
 
	$thrÙeNªos
(
¡¬tTimeNªos
) {

171 ià(
rg‘OpsP”Ms
 > 0) {

173 
d—dlše
 = 
¡¬tTimeNªos
 + 
İsdÚe
 * 
rg‘OpsTickNs
;

174 
	`¦“pUÁ
(
d—dlše
);

175 
m—su»m’ts
.
	`£tIÁ’dedS¹TimeNs
(
d—dlše
);

177 
	}
}

182 
	$g‘OpsTodo
() {

183 
todo
 = 
İcouÁ
 - 
İsdÚe
;

184  
todo
 < 0 ? 0 :odo;

185 
	}
}

	@core/src/main/java/site/ycsb/CommandLine.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

22 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

23 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—mR—d”
;

26 
impÜt
 
	gjava
.
	gut
.*;

31 
public
 
fš®
 cÏs 
	cCommªdLše
 {

32 
´iv©e
 
	$CommªdLše
() {

36 
public
 
fš®
 
SŒšg
 
DEFAULT_DB
 = "site.ycsb.BasicDB";

38 
public
 
	$u§geMes§ge
() {

39 
Sy¡em
.
out
.
	`´šn
("YCSB Command Line Client");

40 
Sy¡em
.
out
.
	`´šn
("Usage: java site.ycsb.CommandLine [options]");

41 
Sy¡em
.
out
.
	`´šn
("Options:");

42 
Sy¡em
.
out
.
	`´šn
(" -P filename: Specify‡…roperty file");

43 
Sy¡em
.
out
.
	`´šn
(" -p‚ame=value: Specify‡…roperty value");

44 
Sy¡em
.
out
.
	`´šn
(" -db classname: Use‡ specified DB class (can‡lso sethe \"db\"…roperty)");

45 
Sy¡em
.
out
.
	`´šn
(" -tableablename: Useheable‚ame instead ofhe default \"" +

46 
CÜeWÜklßd
.
TABLENAME_PROPERTY_DEFAULT
 + "\"");

47 
Sy¡em
.
out
.
	`´šn
();

48 
	}
}

50 
public
 
	$h–p
() {

51 
Sy¡em
.
out
.
	`´šn
("Commands:");

52 
Sy¡em
.
out
.
	`´šn
("„ead key [field1 field2 ...] - Read‡„ecord");

53 
Sy¡em
.
out
.
	`´šn
(" scan key„ecordcount [field1 field2 ...] - Scan starting‡t key");

54 
Sy¡em
.
out
.
	`´šn
(" insert key‚ame1=value1 [name2=value2 ...] - Insert‡‚ew„ecord");

55 
Sy¡em
.
out
.
	`´šn
(" update key‚ame1=value1 [name2=value2 ...] - Update‡„ecord");

56 
Sy¡em
.
out
.
	`´šn
(" delete key - Delete‡„ecord");

57 
Sy¡em
.
out
.
	`´šn
("able [tablename] - Get or [set]he‚ame ofheable");

58 
Sy¡em
.
out
.
	`´šn
(" quit - Quit");

59 
	}
}

61 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

63 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

64 
Prİ”t›s
 
f•rİs
 = 
Ãw
 
	`Prİ”t›s
();

66 
	`·r£Argum’ts
(
¬gs
, 
´İs
, 
f•rİs
);

68 
Enum”©iÚ
 
e
 = 
´İs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

69 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

71 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
´İs
.
	`g‘Prİ”ty
(prop));

74 
´İs
 = 
f•rİs
;

76 
Sy¡em
.
out
.
	`´šn
("YCSB Command Line client");

77 
Sy¡em
.
out
.
	`´šn
("Type \"help\" for command†ine help");

78 
Sy¡em
.
out
.
	`´šn
("Start with \"-help\" for usage info");

80 
SŒšg
 
bË
 = 
´İs
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, CÜeWÜklßd.
TABLENAME_PROPERTY_DEFAULT
);

83 
SŒšg
 
dbÇme
 = 
´İs
.
	`g‘Prİ”ty
(
Cl›Á
.
DB_PROPERTY
, 
DEFAULT_DB
);

85 
CÏssLßd”
 
şassLßd”
 = 
CommªdLše
.
şass
.
	`g‘CÏssLßd”
();

87 
DB
 
db
 = 
nuÎ
;

89 
Œy
 {

90 
CÏss
 
dbşass
 = 
şassLßd”
.
	`lßdCÏss
(
dbÇme
);

91 
db
 = (
DB
è
dbşass
.
	`ÃwIn¡ªû
();

92 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

93 
e
.
	`´štSckT¿û
();

94 
Sy¡em
.
	`ex™
(0);

97 
db
.
	`£tPrİ”t›s
(
´İs
);

98 
Œy
 {

99 
db
.
	`š™
();

100 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

101 
e
.
	`´štSckT¿û
();

102 
Sy¡em
.
	`ex™
(0);

105 
Sy¡em
.
out
.
	`´šn
("Connected.");

108 
Bufã»dR—d”
 
br
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`IÅutSŒ—mR—d”
(
Sy¡em
.
š
));

112 
Sy¡em
.
out
.
	`´št
("> ");

114 
SŒšg
 
šput
 = 
nuÎ
;

116 
Œy
 {

117 
šput
 = 
br
.
	`»adLše
();

118 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

119 
e
.
	`´štSckT¿û
();

120 
Sy¡em
.
	`ex™
(1);

123 ià(
šput
.
	`com·»To
("") == 0) {

127 ià(
šput
.
	`com·»To
("help") == 0) {

128 
	`h–p
();

132 ià(
šput
.
	`com·»To
("quit") == 0) {

136 
SŒšg
[] 
tok’s
 = 
šput
.
	`¥l™
(" ");

138 
¡
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

140 ià(
tok’s
[0].
	`com·»To
("table") == 0) {

141 
	`hªdËTabË
(
tok’s
, 
bË
);

142 } ià(
tok’s
[0].
	`com·»To
("read") == 0) {

143 
	`hªdËR—d
(
tok’s
, 
bË
, 
db
);

144 } ià(
tok’s
[0].
	`com·»To
("scan") == 0) {

145 
	`hªdËSÿn
(
tok’s
, 
bË
, 
db
);

146 } ià(
tok’s
[0].
	`com·»To
("update") == 0) {

147 
	`hªdËUpd©e
(
tok’s
, 
bË
, 
db
);

148 } ià(
tok’s
[0].
	`com·»To
("insert") == 0) {

149 
	`hªdËIn£¹
(
tok’s
, 
bË
, 
db
);

150 } ià(
tok’s
[0].
	`com·»To
("delete") == 0) {

151 
	`hªdËD–‘e
(
tok’s
, 
bË
, 
db
);

153 
Sy¡em
.
out
.
	`´šn
("E¼Ü: unknowÀcommªd \"" + 
tok’s
[0] + "\"");

156 
Sy¡em
.
out
.
	`´šn
((Sy¡em.
	`cu¼’tTimeMlis
(è- 
¡
) + " ms");

158 
	}
}

160 
´iv©e
 
	$·r£Argum’ts
(
SŒšg
[] 
¬gs
, 
Prİ”t›s
 
´İs
, Prİ”t› 
f•rİs
) {

161 
¬gšdex
 = 0;

162 (
¬gšdex
 < 
¬gs
.
Ëngth
è&& (¬gs[¬gšdex].
	`¡¬tsW™h
("-"))) {

163 ià((
¬gs
[
¬gšdex
].
	`com·»To
("-help") == 0) ||

164 (
¬gs
[
¬gšdex
].
	`com·»To
("--help") == 0) ||

165 (
¬gs
[
¬gšdex
].
	`com·»To
("-?") == 0) ||

166 (
¬gs
[
¬gšdex
].
	`com·»To
("--?") == 0)) {

167 
	`u§geMes§ge
();

168 
Sy¡em
.
	`ex™
(0);

171 ià(
¬gs
[
¬gšdex
].
	`com·»To
("-db") == 0) {

172 
¬gšdex
++;

173 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

174 
	`u§geMes§ge
();

175 
Sy¡em
.
	`ex™
(0);

177 
´İs
.
	`£tPrİ”ty
(
Cl›Á
.
DB_PROPERTY
, 
¬gs
[
¬gšdex
]);

178 
¬gšdex
++;

179 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-P") == 0) {

180 
¬gšdex
++;

181 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

182 
	`u§geMes§ge
();

183 
Sy¡em
.
	`ex™
(0);

185 
SŒšg
 
´İfe
 = 
¬gs
[
¬gšdex
];

186 
¬gšdex
++;

188 
Prİ”t›s
 
myf•rİs
 = 
Ãw
 
	`Prİ”t›s
();

189 
Œy
 {

190 
myf•rİs
.
	`lßd
(
Ãw
 
	`FeIÅutSŒ—m
(
´İfe
));

191 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

192 
Sy¡em
.
out
.
	`´šn
(
e
.
	`g‘Mes§ge
());

193 
Sy¡em
.
	`ex™
(0);

196 
Enum”©iÚ
 
e
 = 
myf•rİs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

197 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

199 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
myf•rİs
.
	`g‘Prİ”ty
(prop));

202 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-p") == 0) {

203 
¬gšdex
++;

204 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

205 
	`u§geMes§ge
();

206 
Sy¡em
.
	`ex™
(0);

208 
eq
 = 
¬gs
[
¬gšdex
].
	`šdexOf
('=');

209 ià(
eq
 < 0) {

210 
	`u§geMes§ge
();

211 
Sy¡em
.
	`ex™
(0);

214 
SŒšg
 
Çme
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(0, 
eq
);

215 
SŒšg
 
v®ue
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(
eq
 + 1);

216 
´İs
.
	`put
(
Çme
, 
v®ue
);

217 
¬gšdex
++;

218 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-table") == 0) {

219 
¬gšdex
++;

220 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

221 
	`u§geMes§ge
();

222 
Sy¡em
.
	`ex™
(0);

224 
´İs
.
	`put
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, 
¬gs
[
¬gšdex
]);

226 
¬gšdex
++;

228 
Sy¡em
.
out
.
	`´šn
("UnknowÀİtiÚ " + 
¬gs
[
¬gšdex
]);

229 
	`u§geMes§ge
();

230 
Sy¡em
.
	`ex™
(0);

233 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

238 ià(
¬gšdex
 !ğ
¬gs
.
Ëngth
) {

239 
	`u§geMes§ge
();

240 
Sy¡em
.
	`ex™
(0);

242 
	}
}

244 
´iv©e
 
	$hªdËD–‘e
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

245 ià(
tok’s
.
Ëngth
 != 2) {

246 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"delete keyname\"");

248 
Stus
 
»t
 = 
db
.
	`d–‘e
(
bË
, 
tok’s
[1]);

249 
Sy¡em
.
out
.
	`´šn
("R‘uº„esuÉ: " + 
»t
.
	`g‘Name
());

251 
	}
}

253 
´iv©e
 
	$hªdËIn£¹
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

254 ià(
tok’s
.
Ëngth
 < 3) {

255 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"insert keyname‚ame1=value1 [name2=value2 ...]\"");

257 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<>();

259 
i
 = 2; i < 
tok’s
.
Ëngth
; i++) {

260 
SŒšg
[] 
nv
 = 
tok’s
[
i
].
	`¥l™
("=");

261 
v®ues
.
	`put
(
nv
[0], 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(nv[1]));

264 
Stus
 
»t
 = 
db
.
	`š£¹
(
bË
, 
tok’s
[1], 
v®ues
);

265 
Sy¡em
.
out
.
	`´šn
("ResuÉ: " + 
»t
.
	`g‘Name
());

267 
	}
}

269 
´iv©e
 
	$hªdËUpd©e
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

270 ià(
tok’s
.
Ëngth
 < 3) {

271 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"update keyname‚ame1=value1 [name2=value2 ...]\"");

273 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<>();

275 
i
 = 2; i < 
tok’s
.
Ëngth
; i++) {

276 
SŒšg
[] 
nv
 = 
tok’s
[
i
].
	`¥l™
("=");

277 
v®ues
.
	`put
(
nv
[0], 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(nv[1]));

280 
Stus
 
»t
 = 
db
.
	`upd©e
(
bË
, 
tok’s
[1], 
v®ues
);

281 
Sy¡em
.
out
.
	`´šn
("ResuÉ: " + 
»t
.
	`g‘Name
());

283 
	}
}

285 
´iv©e
 
	$hªdËSÿn
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

286 ià(
tok’s
.
Ëngth
 < 3) {

287 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"scan keyname scanlength [field1 field2 ...]\"");

289 
S‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

291 ià(
tok’s
.
Ëngth
 > 3) {

292 
f›lds
 = 
Ãw
 
HashS‘
<>();

294 
f›lds
.
	`addAÎ
(
A¼ays
.
	`asLi¡
(
tok’s
).
	`subLi¡
(3,ok’s.
Ëngth
));

297 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉs
 = 
Ãw
 Vector<>();

298 
Stus
 
»t
 = 
db
.
	`sÿn
(
bË
, 
tok’s
[1], 
IÁeg”
.
	`·r£IÁ
Ñok’s[2]), 
f›lds
, 
»suÉs
);

299 
Sy¡em
.
out
.
	`´šn
("ResuÉ: " + 
»t
.
	`g‘Name
());

300 
»cÜd
 = 0;

301 ià(
»suÉs
.
	`isEm±y
()) {

302 
Sy¡em
.
out
.
	`´šn
("0„ecords");

304 
Sy¡em
.
out
.
	`´šn
("--------------------------------");

306 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 : 
»suÉs
) {

307 
Sy¡em
.
out
.
	`´šn
("RecÜd " + (
»cÜd
++));

308 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’t
 : 
»suÉ
.
	`’ŒyS‘
()) {

309 
Sy¡em
.
out
.
	`´šn
(
’t
.
	`g‘Key
(è+ "=" +ƒÁ.
	`g‘V®ue
());

311 
Sy¡em
.
out
.
	`´šn
("--------------------------------");

314 
	}
}

316 
´iv©e
 
	$hªdËR—d
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

317 ià(
tok’s
.
Ëngth
 == 1) {

318 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"read keyname [field1 field2 ...]\"");

320 
S‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

322 ià(
tok’s
.
Ëngth
 > 2) {

323 
f›lds
 = 
Ãw
 
HashS‘
<>();

325 
f›lds
.
	`addAÎ
(
A¼ays
.
	`asLi¡
(
tok’s
).
	`subLi¡
(2,ok’s.
Ëngth
));

328 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

329 
Stus
 
»t
 = 
db
.
	`»ad
(
bË
, 
tok’s
[1], 
f›lds
, 
»suÉ
);

330 
Sy¡em
.
out
.
	`´šn
("R‘uº code: " + 
»t
.
	`g‘Name
());

331 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’t
 : 
»suÉ
.
	`’ŒyS‘
()) {

332 
Sy¡em
.
out
.
	`´šn
(
’t
.
	`g‘Key
(è+ "=" +ƒÁ.
	`g‘V®ue
());

335 
	}
}

337 
´iv©e
 
	$hªdËTabË
(
SŒšg
[] 
tok’s
, SŒšg 
bË
) {

338 ià(
tok’s
.
Ëngth
 == 1) {

339 
Sy¡em
.
out
.
	`´šn
("UsšgabË \"" + 
bË
 + "\"");

340 } ià(
tok’s
.
Ëngth
 == 2) {

341 
bË
 = 
tok’s
[1];

342 
Sy¡em
.
out
.
	`´šn
("UsšgabË \"" + 
bË
 + "\"");

344 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"tableablename\"");

346 
	}
}

	@core/src/main/java/site/ycsb/DB.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

45 
public
 
ab¡¿ù
 cÏs 
	cDB
 {

49 
´iv©e
 
Prİ”t›s
 
	m´İ”t›s
 = 
Ãw
 Properties();

54 
public
 
	$£tPrİ”t›s
(
Prİ”t›s
 
p
) {

55 
´İ”t›s
 = 
p
;

62 
public
 
Prİ”t›s
 
	$g‘Prİ”t›s
() {

63  
´İ”t›s
;

64 
	}
}

70 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

71 
	}
}

77 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

78 
	}
}

89 
public
 
ab¡¿ù
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
);

102 
public
 
ab¡¿ù
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

103 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
);

114 
public
 
ab¡¿ù
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
);

125 
public
 
ab¡¿ù
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
);

134 
public
 
ab¡¿ù
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
);

	@core/src/main/java/site/ycsb/DBException.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cDBExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

27 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 6646883591588721475L;

29 
public
 
	$DBExû±iÚ
(
SŒšg
 
mes§ge
) {

30 
	`su³r
(
mes§ge
);

33 
public
 
	$DBExû±iÚ
() {

34 
	`su³r
();

35 
	}
}

37 
public
 
	$DBExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

38 
	`su³r
(
mes§ge
, 
ÿu£
);

39 
	}
}

41 
public
 
	$DBExû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@core/src/main/java/site/ycsb/DBFactory.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûr
;

22 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

27 
public
 
fš®
 cÏs 
	cDBFaùÜy
 {

28 
´iv©e
 
	$DBFaùÜy
() {

32 
public
 
DB
 
	$ÃwDB
(
SŒšg
 
dbÇme
, 
Prİ”t›s
 
´İ”t›s
, 
fš®
 
T¿ûr
 
Œaûr
è
throws
 
UnknownDBExû±iÚ
 {

33 
CÏssLßd”
 
şassLßd”
 = 
DBFaùÜy
.
şass
.
	`g‘CÏssLßd”
();

35 
DB
 
»t
;

37 
Œy
 {

38 
CÏss
 
dbşass
 = 
şassLßd”
.
	`lßdCÏss
(
dbÇme
);

40 
»t
 = (
DB
è
dbşass
.
	`ÃwIn¡ªû
();

41 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

42 
e
.
	`´štSckT¿û
();

43  
nuÎ
;

46 
»t
.
	`£tPrİ”t›s
(
´İ”t›s
);

48  
Ãw
 
	`DBW¿µ”
(
»t
, 
Œaûr
);

49 
	}
}

	@core/src/main/java/site/ycsb/DBWrapper.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûScİe
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûr
;

26 
impÜt
 
	gjava
.
	gut
.*;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

33 
public
 cÏs 
	cDBW¿µ”
 
ex‹nds
 
	mDB
 {

34 
´iv©e
 
fš®
 
DB
 
	mdb
;

35 
´iv©e
 
fš®
 
M—su»m’ts
 
	mm—su»m’ts
;

36 
´iv©e
 
fš®
 
T¿ûr
 
	mŒaûr
;

38 
´iv©e
 
boŞ—n
 
	m»pÜtL©’cyFÜEachE¼Ü
 = 
çl£
;

39 
´iv©e
 
	mS‘
<
	mSŒšg
> 
	mÏ‹ncyT¿ckedE¼Üs
 = 
Ãw
 
HashS‘
<
SŒšg
>();

41 
´iv©e
 
fš®
 
SŒšg
 
	mREPORT_LATENCY_FOR_EACH_ERROR_PROPERTY
 = "reportlatencyforeacherror";

42 
´iv©e
 
fš®
 
SŒšg
 
	mREPORT_LATENCY_FOR_EACH_ERROR_PROPERTY_DEFAULT
 = "false";

44 
´iv©e
 
fš®
 
SŒšg
 
	mLATENCY_TRACKED_ERRORS_PROPERTY
 = "latencytrackederrors";

46 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	mLOG_REPORT_CONFIG
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

48 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgCËªup
;

49 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgD–‘e
;

50 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgIn™
;

51 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgIn£¹
;

52 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgR—d
;

53 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgSÿn
;

54 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgUpd©e
;

56 
public
 
	$DBW¿µ”
(
fš®
 
DB
 
db
, fš® 
T¿ûr
 
Œaûr
) {

57 
this
.
db
 = db;

58 
m—su»m’ts
 = 
M—su»m’ts
.
	`g‘M—su»m’ts
();

59 
this
.
Œaûr
 =racer;

60 
fš®
 
SŒšg
 
sim¶e
 = 
db
.
	`g‘CÏss
().
	`g‘Sim¶eName
();

61 
scİeSŒšgCËªup
 = 
sim¶e
 + "#cleanup";

62 
scİeSŒšgD–‘e
 = 
sim¶e
 + "#delete";

63 
scİeSŒšgIn™
 = 
sim¶e
 + "#init";

64 
scİeSŒšgIn£¹
 = 
sim¶e
 + "#insert";

65 
scİeSŒšgR—d
 = 
sim¶e
 + "#read";

66 
scİeSŒšgSÿn
 = 
sim¶e
 + "#scan";

67 
scİeSŒšgUpd©e
 = 
sim¶e
 + "#update";

73 
public
 
	$£tPrİ”t›s
(
Prİ”t›s
 
p
) {

74 
db
.
	`£tPrİ”t›s
(
p
);

75 
	}
}

80 
public
 
Prİ”t›s
 
	$g‘Prİ”t›s
() {

81  
db
.
	`g‘Prİ”t›s
();

82 
	}
}

88 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

89 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
scİeSŒšgIn™
)) {

90 
db
.
	`š™
();

92 
this
.
»pÜtL©’cyFÜEachE¼Ü
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().

93 
	`g‘Prİ”ty
(
REPORT_LATENCY_FOR_EACH_ERROR_PROPERTY
,

94 
REPORT_LATENCY_FOR_EACH_ERROR_PROPERTY_DEFAULT
));

96 ià(!
»pÜtL©’cyFÜEachE¼Ü
) {

97 
SŒšg
 
Ï‹ncyT¿ckedE¼ÜsPrİ”ty
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
LATENCY_TRACKED_ERRORS_PROPERTY
, 
nuÎ
);

98 ià(
Ï‹ncyT¿ckedE¼ÜsPrİ”ty
 !ğ
nuÎ
) {

99 
this
.
Ï‹ncyT¿ckedE¼Üs
 = 
Ãw
 
HashS‘
<
SŒšg
>(
A¼ays
.
	`asLi¡
(

100 
Ï‹ncyT¿ckedE¼ÜsPrİ”ty
.
	`¥l™
(",")));

104 ià(
LOG_REPORT_CONFIG
.
	`com·»AndS‘
(
çl£
, 
Œue
)) {

105 
Sy¡em
.
”r
.
	`´šn
("DBWrapper:„eport†atency forƒachƒrror is " +

106 
this
.
»pÜtL©’cyFÜEachE¼Ü
 + "‡nd specificƒrror codesorack" +

107 " fÜ†©’cy‡»: " + 
this
.
Ï‹ncyT¿ckedE¼Üs
.
	`toSŒšg
());

110 
	}
}

116 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

117 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
scİeSŒšgCËªup
)) {

118 
i¡
 = 
m—su»m’ts
.
	`g‘IÁ’dedS¹TimeNs
();

119 
¡
 = 
Sy¡em
.
	`ÇnoTime
();

120 
db
.
	`ş—nup
();

121 
’
 = 
Sy¡em
.
	`ÇnoTime
();

122 
	`m—su»
("CLEANUP", 
Stus
.
OK
, 
i¡
, 
¡
, 
’
);

124 
	}
}

136 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

137 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

138 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgR—d
)) {

139 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

140 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

141 
Stus
 
	g»s
 = 
db
.
»ad
(
bË
, 
key
, 
f›lds
, 
»suÉ
);

142 
	g’
 = 
Sy¡em
.
ÇnoTime
();

143 
m—su»
("READ", 
»s
, 
i¡
, 
¡
, 
’
);

144 
	gm—su»m’ts
.
»pÜtStus
("READ", 
»s
);

145  
	g»s
;

160 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

161 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

162 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgSÿn
)) {

163 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

164 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

165 
Stus
 
	g»s
 = 
db
.
sÿn
(
bË
, 
¡¬tkey
, 
»cÜdcouÁ
, 
f›lds
, 
»suÉ
);

166 
	g’
 = 
Sy¡em
.
ÇnoTime
();

167 
m—su»
("SCAN", 
»s
, 
i¡
, 
¡
, 
’
);

168 
	gm—su»m’ts
.
»pÜtStus
("SCAN", 
»s
);

169  
	g»s
;

173 
´iv©e
 
	$m—su»
(
SŒšg
 
İ
, 
Stus
 
»suÉ
, 
š‹ndedS¹TimeNªos
,

174 
¡¬tTimeNªos
, 
’dTimeNªos
) {

175 
SŒšg
 
m—su»m’tName
 = 
İ
;

176 ià(
»suÉ
 =ğ
nuÎ
 || !»suÉ.
	`isOk
()) {

177 ià(
this
.
»pÜtL©’cyFÜEachE¼Ü
 ||

178 
this
.
Ï‹ncyT¿ckedE¼Üs
.
	`cÚšs
(
»suÉ
.
	`g‘Name
())) {

179 
m—su»m’tName
 = 
İ
 + "-" + 
»suÉ
.
	`g‘Name
();

181 
m—su»m’tName
 = 
İ
 + "-FAILED";

184 
m—su»m’ts
.
	`m—su»
(
m—su»m’tName
,

185 (è((
’dTimeNªos
 - 
¡¬tTimeNªos
) / 1000));

186 
m—su»m’ts
.
	`m—su»IÁ’ded
(
m—su»m’tName
,

187 (è((
’dTimeNªos
 - 
š‹ndedS¹TimeNªos
) / 1000));

188 
	}
}

199 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

200 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

201 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgUpd©e
)) {

202 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

203 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

204 
Stus
 
	g»s
 = 
db
.
upd©e
(
bË
, 
key
, 
v®ues
);

205 
	g’
 = 
Sy¡em
.
ÇnoTime
();

206 
m—su»
("UPDATE", 
»s
, 
i¡
, 
¡
, 
’
);

207 
	gm—su»m’ts
.
»pÜtStus
("UPDATE", 
»s
);

208  
	g»s
;

222 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

223 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

224 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgIn£¹
)) {

225 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

226 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

227 
Stus
 
	g»s
 = 
db
.
š£¹
(
bË
, 
key
, 
v®ues
);

228 
	g’
 = 
Sy¡em
.
ÇnoTime
();

229 
m—su»
("INSERT", 
»s
, 
i¡
, 
¡
, 
’
);

230 
	gm—su»m’ts
.
»pÜtStus
("INSERT", 
»s
);

231  
	g»s
;

242 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

243 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
scİeSŒšgD–‘e
)) {

244 
i¡
 = 
m—su»m’ts
.
	`g‘IÁ’dedS¹TimeNs
();

245 
¡
 = 
Sy¡em
.
	`ÇnoTime
();

246 
Stus
 
»s
 = 
db
.
	`d–‘e
(
bË
, 
key
);

247 
’
 = 
Sy¡em
.
	`ÇnoTime
();

248 
	`m—su»
("DELETE", 
»s
, 
i¡
, 
¡
, 
’
);

249 
m—su»m’ts
.
	`»pÜtStus
("DELETE", 
»s
);

250  
»s
;

252 
	}
}

	@core/src/main/java/site/ycsb/GoodBadUglyDB.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLock
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR—dWr™eLock
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁR—dWr™eLock
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
.
	gMICROSECONDS
;

36 
public
 cÏs 
	cGoodBadUglyDB
 
ex‹nds
 
	mDB
 {

37 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY
 = "gbudb.delays";

38 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY_DEFAULT
 = "200,1000,10000,50000,100000";

39 
´iv©e
 
fš®
 
R—dWr™eLock
 
	mDB_ACCESS
 = 
Ãw
 
R“Á¿ÁR—dWr™eLock
();

40 
´iv©e
 [] 
	md–ays
;

42 
public
 
	$GoodBadUglyDB
() {

43 
d–ays
 = 
Ãw
 []{200, 1000, 10000, 50000, 200000};

46 
´iv©e
 
	$d–ay
() {

47 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

48 
p
 = 
¿ndom
.
	`ÃxtDoubË
();

49 
mod
;

50 ià(
p
 < 0.9) {

51 
mod
 = 0;

52 } ià(
p
 < 0.99) {

53 
mod
 = 1;

54 } ià(
p
 < 0.9999) {

55 
mod
 = 2;

57 
mod
 = 3;

60 
Lock
 
lock
 = 
mod
 =ğ3 ? 
DB_ACCESS
.
	`wr™eLock
(è: DB_ACCESS.
	`»adLock
();

61 ià(
mod
 == 3) {

62 
Sy¡em
.
out
.
	`´šn
("OUCH");

64 
lock
.
	`lock
();

65 
Œy
 {

66 
fš®
 
ba£D–ayNs
 = 
MICROSECONDS
.
	`toNªos
(
d–ays
[
mod
]);

67 
fš®
 
d–ayRªgeNs
 = (è(
MICROSECONDS
.
	`toNªos
(
d–ays
[
mod
 + 1]è- 
ba£D–ayNs
);

68 
fš®
 
d–ayNs
 = 
ba£D–ayNs
 + 
¿ndom
.
	`ÃxtIÁ
(
d–ayRªgeNs
);

69 
fš®
 
d—dlše
 = 
Sy¡em
.
	`ÇnoTime
(è+ 
d–ayNs
;

71 
LockSuµÜt
.
	`·rkNªos
(
d—dlše
 - 
Sy¡em
.
	`ÇnoTime
());

72 } 
Sy¡em
.
	`ÇnoTime
(è< 
d—dlše
 && !
Th»ad
.
	`š‹¼u±ed
());

73 } 
fš®ly
 {

74 
lock
.
	`uÆock
();

77 
	}
}

82 
public
 
	$š™
() {

83 
i
 = 0;

84 
SŒšg
 
d–ay
 : 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
SIMULATE_DELAY
, 
SIMULATE_DELAY_DEFAULT
).
	`¥l™
(",")) {

85 
d–ays
[
i
++] = 
LÚg
.
	`·r£LÚg
(
d–ay
);

87 
	}
}

98 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

99 
d–ay
();

100  
	gStus
.
	gOK
;

114 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

115 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

116 
d–ay
();

118  
	gStus
.
	gOK
;

130 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

131 
d–ay
();

133  
	gStus
.
	gOK
;

145 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

146 
d–ay
();

147  
	gStus
.
	gOK
;

157 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

158 
	`d–ay
();

159  
Stus
.
OK
;

160 
	}
}

	@core/src/main/java/site/ycsb/InputStreamByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

20 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

25 
public
 cÏs 
	cIÅutSŒ—mBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

26 
´iv©e
 
fš®
 
	mËn
;

27 
´iv©e
 
fš®
 
IÅutSŒ—m
 
	mšs
;

28 
´iv©e
 
	moff
;

29 
´iv©e
 
fš®
 
boŞ—n
 
	m»£bË
;

31 
public
 
	$IÅutSŒ—mBy‹I‹¿tÜ
(
IÅutSŒ—m
 
šs
, 
Ën
) {

32 
this
.
Ën
 =†en;

33 
this
.
šs
 = ins;

34 
off
 = 0;

35 
»£bË
 = 
šs
.
	`m¬kSuµÜ‹d
();

36 ià(
»£bË
) {

37 
šs
.
	`m¬k
((è
Ën
);

41 @
Ov”ride


42 
public
 
boŞ—n
 
	$hasNext
() {

43  
off
 < 
Ën
;

44 
	}
}

46 @
Ov”ride


47 
public
 
by‹
 
	$ÃxtBy‹
() {

48 
»t
;

49 
Œy
 {

50 
»t
 = 
šs
.
	`»ad
();

51 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

52 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
e
);

54 ià(
»t
 == -1) {

55 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Past EOF!");

57 
off
++;

58  (
by‹
è
»t
;

59 
	}
}

61 @
Ov”ride


62 
public
 
	$by‹sLeá
() {

63  
Ën
 - 
off
;

64 
	}
}

66 @
Ov”ride


67 
public
 
	gby‹
[] 
	$toA¼ay
() {

68 
size
 = (è
	`by‹sLeá
();

69 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
size
];

70 
Œy
 {

71 ià(
šs
.
	`»ad
(
by‹s
è< 
size
) {

72 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Past EOF!");

74 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

75 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
e
);

77 
off
 = 
Ën
;

78  
by‹s
;

79 
	}
}

81 @
Ov”ride


82 
public
 
	$»£t
() {

83 ià(
»£bË
) {

84 
Œy
 {

85 
šs
.
	`»£t
();

86 
šs
.
	`m¬k
((è
Ën
);

87 
off
 = 0;

88 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

89 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("FaedØ»£ˆthšpuˆ¡»am", 
e
);

92 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
();

94 
	}
}

	@core/src/main/java/site/ycsb/NumericByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

24 
public
 cÏs 
	cNum”icBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

25 
´iv©e
 
fš®
 
	mby‹
[] 
	m·ylßd
;

26 
´iv©e
 
fš®
 
boŞ—n
 
	mæßtšgPošt
;

27 
´iv©e
 
	moff
;

29 
public
 
	$Num”icBy‹I‹¿tÜ
(
fš®
 
v®ue
) {

30 
æßtšgPošt
 = 
çl£
;

31 
·ylßd
 = 
Uts
.
	`lÚgToBy‹s
(
v®ue
);

32 
off
 = 0;

35 
public
 
	$Num”icBy‹I‹¿tÜ
(
fš®
 
v®ue
) {

36 
æßtšgPošt
 = 
Œue
;

37 
·ylßd
 = 
Uts
.
	`doubËToBy‹s
(
v®ue
);

38 
off
 = 0;

39 
	}
}

41 @
Ov”ride


42 
public
 
boŞ—n
 
	$hasNext
() {

43  
off
 < 
·ylßd
.
Ëngth
;

44 
	}
}

46 @
Ov”ride


47 
public
 
by‹
 
	$ÃxtBy‹
() {

48  
·ylßd
[
off
++];

49 
	}
}

51 @
Ov”ride


52 
public
 
	$by‹sLeá
() {

53  
·ylßd
.
Ëngth
 - 
off
;

54 
	}
}

56 @
Ov”ride


57 
public
 
	$»£t
() {

58 
off
 = 0;

59 
	}
}

61 
public
 
	$g‘LÚg
() {

62 ià(
æßtšgPošt
) {

63 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Byte iterator is ofheype double");

65  
Uts
.
	`by‹sToLÚg
(
·ylßd
);

66 
	}
}

68 
public
 
	$g‘DoubË
() {

69 ià(!
æßtšgPošt
) {

70 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Byte iterator is ofheype†ong");

72  
Uts
.
	`by‹sToDoubË
(
·ylßd
);

73 
	}
}

75 
public
 
boŞ—n
 
	$isFlßtšgPošt
() {

76  
æßtšgPošt
;

77 
	}
}

	@core/src/main/java/site/ycsb/RandomByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
public
 cÏs 
	cRªdomBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

25 
´iv©e
 
fš®
 
	mËn
;

26 
´iv©e
 
	moff
;

27 
´iv©e
 
	mbufOff
;

28 
´iv©e
 
fš®
 
	mby‹
[] 
	mbuf
;

30 @
Ov”ride


31 
public
 
boŞ—n
 
	$hasNext
() {

32  (
off
 + 
bufOff
è< 
Ën
;

35 
´iv©e
 
	$flBy‹sIm¶
(
by‹
[] 
bufãr
, 
ba£
) {

36 
by‹s
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
();

38 
bufãr
.
Ëngth
 - 
ba£
) {

40 
bufãr
[
ba£
 + 5] = (
by‹
è(((
by‹s
 >> 25) & 95) + ' ');

42 
bufãr
[
ba£
 + 4] = (
by‹
è(((
by‹s
 >> 20) & 63) + ' ');

44 
bufãr
[
ba£
 + 3] = (
by‹
è(((
by‹s
 >> 15) & 31) + ' ');

46 
bufãr
[
ba£
 + 2] = (
by‹
è(((
by‹s
 >> 10) & 95) + ' ');

48 
bufãr
[
ba£
 + 1] = (
by‹
è(((
by‹s
 >> 5) & 63) + ' ');

50 
bufãr
[
ba£
 + 0] = (
by‹
è(((
by‹s
) & 31) + ' ');

54 
	}
}

56 
´iv©e
 
	$flBy‹s
() {

57 ià(
bufOff
 =ğ
buf
.
Ëngth
) {

58 
	`flBy‹sIm¶
(
buf
, 0);

59 
bufOff
 = 0;

60 
off
 +ğ
buf
.
Ëngth
;

62 
	}
}

64 
public
 
	$RªdomBy‹I‹¿tÜ
(
Ën
) {

65 
this
.
Ën
 =†en;

66 
this
.
buf
 = 
Ãw
 
by‹
[6];

67 
this
.
bufOff
 = 
buf
.
Ëngth
;

68 
	`flBy‹s
();

69 
this
.
off
 = 0;

70 
	}
}

72 
public
 
by‹
 
	$ÃxtBy‹
() {

73 
	`flBy‹s
();

74 
bufOff
++;

75  
buf
[
bufOff
 - 1];

76 
	}
}

78 @
Ov”ride


79 
public
 
	$ÃxtBuf
(
by‹
[] 
bufãr
, 
bufOff£t
) {

80 
»t
;

81 ià(
Ën
 - 
off
 < 
bufãr
.
Ëngth
 - 
bufOff£t
) {

82 
»t
 = (è(
Ën
 - 
off
);

84 
»t
 = 
bufãr
.
Ëngth
 - 
bufOff£t
;

86 
i
;

87 
i
 = 0; i < 
»t
; i += 6) {

88 
	`flBy‹sIm¶
(
bufãr
, 
i
 + 
bufOff£t
);

90 
off
 +ğ
»t
;

91  
»t
 + 
bufOff£t
;

92 
	}
}

94 @
Ov”ride


95 
public
 
	$by‹sLeá
() {

96  
Ën
 - 
off
 - 
bufOff
;

97 
	}
}

99 @
Ov”ride


100 
public
 
	$»£t
() {

101 
off
 = 0;

102 
	}
}

105 
public
 
	gby‹
[] 
	$toA¼ay
() {

106 
Ëá
 = 
	`by‹sLeá
();

107 ià(
Ëá
 != ()†eft) {

108 
throw
 
Ãw
 
	`A¼ayIndexOutOfBoundsExû±iÚ
("Too much datao fit in one‡rray!");

110 
by‹
[] 
»t
 = 
Ãw
 by‹[(è
Ëá
];

111 
bufOff£t
 = 0;

112 
bufOff£t
 < 
»t
.
Ëngth
) {

113 
bufOff£t
 = 
	`ÃxtBuf
(
»t
, bufOffset);

115  
»t
;

116 
	}
}

	@core/src/main/java/site/ycsb/Status.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cStus
 {

24 
´iv©e
 
fš®
 
SŒšg
 
	mÇme
;

25 
´iv©e
 
fš®
 
SŒšg
 
	mdesütiÚ
;

31 
public
 
	$Stus
(
SŒšg
 
Çme
, SŒšg 
desütiÚ
) {

32 
	`su³r
();

33 
this
.
Çme
 =‚ame;

34 
this
.
desütiÚ
 = description;

37 
public
 
SŒšg
 
	$g‘Name
() {

38  
Çme
;

39 
	}
}

41 
public
 
SŒšg
 
	$g‘DesütiÚ
() {

42  
desütiÚ
;

43 
	}
}

45 @
Ov”ride


46 
public
 
SŒšg
 
	$toSŒšg
() {

47  "Stu [Çme=" + 
Çme
 + ", desütiÚ=" + 
desütiÚ
 + "]";

48 
	}
}

50 @
Ov”ride


51 
public
 
	$hashCode
() {

52 
fš®
 
´ime
 = 31;

53 
»suÉ
 = 1;

54 
»suÉ
 = 
´ime
 *„esuÉ + ((
desütiÚ
 =ğ
nuÎ
è? 0 : desütiÚ.
	`hashCode
());

55 
»suÉ
 = 
´ime
 *„esuÉ + ((
Çme
 =ğ
nuÎ
è? 0 :‚ame.
	`hashCode
());

56  
»suÉ
;

57 
	}
}

59 @
Ov”ride


60 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

61 ià(
this
 =ğ
obj
) {

62  
Œue
;

64 ià(
obj
 =ğ
nuÎ
) {

65  
çl£
;

67 ià(
	`g‘CÏss
(è!ğ
obj
.getClass()) {

68  
çl£
;

70 
Stus
 
Ùh”
 = (Stusè
obj
;

71 ià(
desütiÚ
 =ğ
nuÎ
) {

72 ià(
Ùh”
.
desütiÚ
 !ğ
nuÎ
) {

73  
çl£
;

75 } ià(!
desütiÚ
.
	`equ®s
(
Ùh”
.description)) {

76  
çl£
;

78 ià(
Çme
 =ğ
nuÎ
) {

79 ià(
Ùh”
.
Çme
 !ğ
nuÎ
) {

80  
çl£
;

82 } ià(!
Çme
.
	`equ®s
(
Ùh”
.name)) {

83  
çl£
;

85  
Œue
;

86 
	}
}

92 
public
 
boŞ—n
 
	$isOk
() {

93  
this
 =ğ
OK
 ||hi =ğ
BATCHED_OK
;

94 
	}
}

96 
public
 
fš®
 
Stus
 
	gOK
 = 
Ãw
 Status("OK", "The operation completed successfully.");

97 
public
 
fš®
 
Stus
 
	gERROR
 = 
Ãw
 Status("ERROR", "The operation failed.");

98 
public
 
fš®
 
Stus
 
	gNOT_FOUND
 = 
Ãw
 Status("NOT_FOUND", "The„equested„ecord was‚ot found.");

99 
public
 
fš®
 
Stus
 
	gNOT_IMPLEMENTED
 = 
Ãw
 Status("NOT_IMPLEMENTED", "The operation is‚ot " +

101 
public
 
fš®
 
Stus
 
	gUNEXPECTED_STATE
 = 
Ãw
 Status("UNEXPECTED_STATE", "The operation„eported" +

103 
public
 
fš®
 
Stus
 
	gBAD_REQUEST
 = 
Ãw
 Status("BAD_REQUEST", "The„equest was‚ot valid.");

104 
public
 
fš®
 
Stus
 
	gFORBIDDEN
 = 
Ãw
 Status("FORBIDDEN", "The operation is forbidden.");

105 
public
 
fš®
 
Stus
 
	gSERVICE_UNAVAILABLE
 = 
Ãw
 Status("SERVICE_UNAVAILABLE", "Dependant " +

107 
public
 
fš®
 
Stus
 
	gBATCHED_OK
 = 
Ãw
 Status("BATCHED_OK", "The operation has been batched by " +

	@core/src/main/java/site/ycsb/StatusThread.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

22 
impÜt
 
	gjava
.
	g‹xt
.
	gSim¶eD©eFÜm©
;

23 
impÜt
 
	gjava
.
	gut
.
	gD©e
;

24 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

31 
public
 cÏs 
	cStusTh»ad
 
ex‹nds
 
	mTh»ad
 {

33 
´iv©e
 
fš®
 
CouÁDownL©ch
 
	mcom¶‘eL©ch
;

36 
´iv©e
 
fš®
 
M—su»m’ts
 
	mm—su»m’ts
;

39 
´iv©e
 
fš®
 
boŞ—n
 
	mŒackJVMSts
;

42 
´iv©e
 
fš®
 
	mLi¡
<
	mCl›ÁTh»ad
> 
	mş›Ás
;

44 
´iv©e
 
fš®
 
SŒšg
 
	mÏb–
;

45 
´iv©e
 
fš®
 
boŞ—n
 
	m¡ªd¬d¡©us
;

48 
´iv©e
 
	m¦“±imeNs
;

51 
´iv©e
 
	mmaxTh»ads
;

52 
´iv©e
 
	mmšTh»ads
 = 
IÁeg”
.
MAX_VALUE
;

53 
´iv©e
 
	mmaxU£dMem
;

54 
´iv©e
 
	mmšU£dMem
 = 
LÚg
.
MAX_VALUE
;

55 
´iv©e
 
	mmaxLßdAvg
;

56 
´iv©e
 
	mmšLßdAvg
 = 
DoubË
.
MAX_VALUE
;

57 
´iv©e
 
	mÏ¡GCCouÁ
 = 0;

58 
´iv©e
 
	mÏ¡GCTime
 = 0;

70 
public
 
StusTh»ad
(
CouÁDownL©ch
 
com¶‘eL©ch
, 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
,

71 
SŒšg
 
Ïb–
, 
boŞ—n
 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
) {

72 
this
(
com¶‘eL©ch
, 
ş›Ás
, 
Ïb–
, 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
, 
çl£
);

86 
public
 
StusTh»ad
(
CouÁDownL©ch
 
com¶‘eL©ch
, 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
,

87 
SŒšg
 
Ïb–
, 
boŞ—n
 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
,

88 
boŞ—n
 
ŒackJVMSts
) {

89 
	gthis
.
	gcom¶‘eL©ch
 = 
com¶‘eL©ch
;

90 
	gthis
.
	gş›Ás
 = 
ş›Ás
;

91 
	gthis
.
	gÏb–
 = 
Ïb–
;

92 
	gthis
.
	g¡ªd¬d¡©us
 = 
¡ªd¬d¡©us
;

93 
	g¦“±imeNs
 = 
TimeUn™
.
SECONDS
.
toNªos
(
¡©usIÁ”v®SecÚds
);

94 
	gm—su»m’ts
 = 
M—su»m’ts
.
g‘M—su»m’ts
();

95 
	gthis
.
	gŒackJVMSts
 = 
ŒackJVMSts
;

101 @
Ov”ride


102 
public
 
	$run
() {

103 
fš®
 
¡¬tTimeMs
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

104 
fš®
 
¡¬tTimeNªos
 = 
Sy¡em
.
	`ÇnoTime
();

105 
d—dlše
 = 
¡¬tTimeNªos
 + 
¦“±imeNs
;

106 
¡¬tIÁ”v®Ms
 = 
¡¬tTimeMs
;

107 
Ï¡TÙ®Ops
 = 0;

109 
boŞ—n
 
®ldÚe
;

112 
nowMs
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

114 
Ï¡TÙ®Ops
 = 
	`compu‹Sts
(
¡¬tTimeMs
, 
¡¬tIÁ”v®Ms
, 
nowMs
,†astTotalOps);

116 ià(
ŒackJVMSts
) {

117 
	`m—su»JVM
();

120 
®ldÚe
 = 
	`wa™FÜCl›ÁsUÁ
(
d—dlše
);

122 
¡¬tIÁ”v®Ms
 = 
nowMs
;

123 
d—dlše
 +ğ
¦“±imeNs
;

125 !
®ldÚe
);

127 ià(
ŒackJVMSts
) {

128 
	`m—su»JVM
();

131 
	`compu‹Sts
(
¡¬tTimeMs
, 
¡¬tIÁ”v®Ms
, 
Sy¡em
.
	`cu¼’tTimeMlis
(), 
Ï¡TÙ®Ops
);

132 
	}
}

143 
´iv©e
 
	$compu‹Sts
(
fš®
 
¡¬tTimeMs
, 
¡¬tIÁ”v®Ms
, 
’dIÁ”v®Ms
,

144 
Ï¡TÙ®Ops
) {

145 
Sim¶eD©eFÜm©
 
fÜm©
 = 
Ãw
 
	`Sim¶eD©eFÜm©
("yyyy-MM-dd HH:mm:ss:SSS");

147 
tÙ®İs
 = 0;

148 
todoİs
 = 0;

151 
Cl›ÁTh»ad
 
t
 : 
ş›Ás
) {

152 
tÙ®İs
 +ğ
t
.
	`g‘OpsDÚe
();

153 
todoİs
 +ğ
t
.
	`g‘OpsTodo
();

157 
š‹rv®
 = 
’dIÁ”v®Ms
 - 
¡¬tTimeMs
;

158 
throughput
 = 1000.0 * (((è
tÙ®İs
è/ (è
š‹rv®
);

159 
cu¹hroughput
 = 1000.0 * (((è(
tÙ®İs
 - 
Ï¡TÙ®Ops
)) /

160 ((è(
’dIÁ”v®Ms
 - 
¡¬tIÁ”v®Ms
)));

161 
e¡»maššg
 = (è
M©h
.
	`û
(
todoİs
 / 
throughput
);

164 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

165 
SŒšg
 
Ïb–SŒšg
 = 
this
.
Ïb–
 + 
fÜm©
.
	`fÜm©
(
Ãw
 
	`D©e
());

167 
SŒšgBud”
 
msg
 = 
Ãw
 
	`SŒšgBud”
(
Ïb–SŒšg
).
	`­³nd
(" ").­³nd(
š‹rv®
 / 1000).append(" sec: ");

168 
msg
.
	`­³nd
(
tÙ®İs
).append(" operations; ");

170 ià(
tÙ®İs
 != 0) {

171 
msg
.
	`­³nd
(
d
.
	`fÜm©
(
cu¹hroughput
)).append(" current ops/sec; ");

173 ià(
todoİs
 != 0) {

174 
msg
.
	`­³nd
("e¡ com¶‘iÚ iÀ").­³nd(
RemaššgFÜm©‹r
.
	`fÜm©
(
e¡»maššg
));

177 
msg
.
	`­³nd
(
M—su»m’ts
.
	`g‘M—su»m’ts
().
	`g‘Summ¬y
());

179 
Sy¡em
.
”r
.
	`´šn
(
msg
);

181 ià(
¡ªd¬d¡©us
) {

182 
Sy¡em
.
out
.
	`´šn
(
msg
);

184  
tÙ®İs
;

185 
	}
}

193 
´iv©e
 
boŞ—n
 
	$wa™FÜCl›ÁsUÁ
(
d—dlše
) {

194 
boŞ—n
 
®ldÚe
 = 
çl£
;

195 
now
 = 
Sy¡em
.
	`ÇnoTime
();

197 !
®ldÚe
 && 
now
 < 
d—dlše
) {

198 
Œy
 {

199 
®ldÚe
 = 
com¶‘eL©ch
.
	`awa™
(
d—dlše
 - 
now
, 
TimeUn™
.
NANOSECONDS
);

200 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

204 
Th»ad
.
	`cu¼’tTh»ad
().
	`š‹¼u±
();

205 
®ldÚe
 = 
Œue
;

207 
now
 = 
Sy¡em
.
	`ÇnoTime
();

210  
®ldÚe
;

211 
	}
}

216 
´iv©e
 
	$m—su»JVM
() {

217 
fš®
 
th»ads
 = 
Uts
.
	`g‘AùiveTh»adCouÁ
();

218 ià(
th»ads
 < 
mšTh»ads
) {

219 
mšTh»ads
 = 
th»ads
;

221 ià(
th»ads
 > 
maxTh»ads
) {

222 
maxTh»ads
 = 
th»ads
;

224 
m—su»m’ts
.
	`m—su»
("THREAD_COUNT", 
th»ads
);

229 
fš®
 
u£dMem
 = 
Uts
.
	`g‘U£dMemÜyMegaBy‹s
();

230 ià(
u£dMem
 < 
mšU£dMem
) {

231 
mšU£dMem
 = 
u£dMem
;

233 ià(
u£dMem
 > 
maxU£dMem
) {

234 
maxU£dMem
 = 
u£dMem
;

236 
m—su»m’ts
.
	`m—su»
("USED_MEM_MB", 
u£dMem
);

240 
fš®
 
sy¡emLßd
 = 
Uts
.
	`g‘Sy¡emLßdAv”age
();

241 ià(
sy¡emLßd
 >= 0) {

243 
m—su»m’ts
.
	`m—su»
("SYS_LOAD_AVG", (è
sy¡emLßd
);

244 ià(
sy¡emLßd
 > 
maxLßdAvg
) {

245 
maxLßdAvg
 = 
sy¡emLßd
;

247 ià(
sy¡emLßd
 < 
mšLßdAvg
) {

248 
mšLßdAvg
 = 
sy¡emLßd
;

252 
fš®
 
gcs
 = 
Uts
.
	`g‘GCTÙ®CŞËùiÚCouÁ
();

253 
m—su»m’ts
.
	`m—su»
("GCS", (è(
gcs
 - 
Ï¡GCCouÁ
));

254 
fš®
 
gcTime
 = 
Uts
.
	`g‘GCTÙ®Time
();

255 
m—su»m’ts
.
	`m—su»
("GCS_TIME", (è(
gcTime
 - 
Ï¡GCTime
));

256 
Ï¡GCCouÁ
 = 
gcs
;

257 
Ï¡GCTime
 = 
gcTime
;

258 
	}
}

263 
public
 
	$g‘MaxTh»ads
() {

264  
maxTh»ads
;

265 
	}
}

270 
public
 
	$g‘MšTh»ads
() {

271  
mšTh»ads
;

272 
	}
}

277 
public
 
	$g‘MaxU£dMem
() {

278  
maxU£dMem
;

279 
	}
}

284 
public
 
	$g‘MšU£dMem
() {

285  
mšU£dMem
;

286 
	}
}

291 
public
 
	$g‘MaxLßdAvg
() {

292  
maxLßdAvg
;

293 
	}
}

298 
public
 
	$g‘MšLßdAvg
() {

299  
mšLßdAvg
;

300 
	}
}

305 
public
 
boŞ—n
 
	$ŒackJVMSts
() {

306  
ŒackJVMSts
;

307 
	}
}

	@core/src/main/java/site/ycsb/StringByteIterator.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

26 
public
 cÏs 
	cSŒšgBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

27 
´iv©e
 
SŒšg
 
	m¡r
;

28 
´iv©e
 
	moff
;

34 
public
 
putAÎAsBy‹I‹¿tÜs
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
out
, M­<SŒšg, SŒšg> 
š
) {

35 
	mM­
.
	mEÁry
<
	mSŒšg
, SŒšg> 
	m’Œy
 : 
š
.
’ŒyS‘
()) {

36 
out
.
put
(
’Œy
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
ÓÁry.
g‘V®ue
()));

44 
public
 
putAÎAsSŒšgs
(
M­
<
SŒšg
, SŒšg> 
out
, M­<SŒšg, 
By‹I‹¿tÜ
> 
š
) {

45 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
š
.
’ŒyS‘
()) {

46 
out
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

54 
public
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
g‘By‹I‹¿tÜM­
(
M­
<
SŒšg
, SŒšg> 
m
) {

55 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»t
 =

56 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

58 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
m
.
’ŒyS‘
()) {

59 
»t
.
put
(
’Œy
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
ÓÁry.
g‘V®ue
()));

61  
	g»t
;

68 
public
 
	gM­
<
	gSŒšg
, SŒšg> 
g‘SŒšgM­
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
m
) {

69 
	gHashM­
<
	gSŒšg
, SŒšg> 
	g»t
 = 
Ãw
 
HashM­
<
SŒšg
, String>();

71 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
m
.
’ŒyS‘
()) {

72 
»t
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

74  
	g»t
;

77 
public
 
	$SŒšgBy‹I‹¿tÜ
(
SŒšg
 
s
) {

78 
this
.
¡r
 = 
s
;

79 
this
.
off
 = 0;

80 
	}
}

82 @
Ov”ride


83 
public
 
boŞ—n
 
	$hasNext
() {

84  
off
 < 
¡r
.
	`Ëngth
();

85 
	}
}

87 @
Ov”ride


88 
public
 
by‹
 
	$ÃxtBy‹
() {

89 
by‹
 
»t
 = (by‹è
¡r
.
	`ch¬At
(
off
);

90 
off
++;

91  
»t
;

92 
	}
}

94 @
Ov”ride


95 
public
 
	$by‹sLeá
() {

96  
¡r
.
	`Ëngth
(è- 
off
;

97 
	}
}

99 @
Ov”ride


100 
public
 
	$»£t
() {

101 
off
 = 0;

102 
	}
}

104 @
Ov”ride


105 
public
 
	gby‹
[] 
	$toA¼ay
() {

106 
by‹
[] 
by‹s
 = 
Ãw
 by‹[(è
	`by‹sLeá
()];

107 
i
 = 0; i < 
by‹s
.
Ëngth
; i++) {

108 
by‹s
[
i
] = (
by‹
è
¡r
.
	`ch¬At
(
off
 + i);

110 
off
 = 
¡r
.
	`Ëngth
();

111  
by‹s
;

112 
	}
}

123 @
Ov”ride


124 
public
 
SŒšg
 
	$toSŒšg
() {

125 ià(
off
 > 0) {

126  
su³r
.
	`toSŒšg
();

128  
¡r
;

130 
	}
}

	@core/src/main/java/site/ycsb/TerminatorThread.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

28 
public
 cÏs 
	cT”mš©ÜTh»ad
 
ex‹nds
 
	mTh»ad
 {

30 
´iv©e
 
fš®
 
	mCŞËùiÚ
<? 
ex‹nds
 
	mTh»ad
> 
	mth»ads
;

31 
´iv©e
 
	mmaxExecutiÚTime
;

32 
´iv©e
 
WÜklßd
 
	mwÜklßd
;

33 
´iv©e
 
	mwa™TimeOutInMS
;

35 
public
 
T”mš©ÜTh»ad
(
maxExecutiÚTime
, 
CŞËùiÚ
<? 
ex‹nds
 
Th»ad
> 
th»ads
,

36 
WÜklßd
 
wÜklßd
) {

37 
	mthis
.
	mmaxExecutiÚTime
 = 
maxExecutiÚTime
;

38 
	mthis
.
	mth»ads
 = 
th»ads
;

39 
	mthis
.
	mwÜklßd
 = 
wÜklßd
;

40 
	mwa™TimeOutInMS
 = 2000;

41 
	mSy¡em
.
	m”r
.
´šn
("MaximumƒxecutiÚim¥ecif›d‡s: " + 
maxExecutiÚTime
 + " secs");

44 
public
 
	$run
() {

45 
Œy
 {

46 
Th»ad
.
	`¦“p
(
maxExecutiÚTime
 * 1000);

47 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

48 
Sy¡em
.
”r
.
	`´šn
("Could‚ot wait until max specifiedime, TerminatorThread interrupted.");

51 
Sy¡em
.
”r
.
	`´šn
("Maximumimeƒlapsed. Requesting stop forhe workload.");

52 
wÜklßd
.
	`»que¡Stİ
();

53 
Sy¡em
.
”r
.
	`´šn
("Stop„equested for workload. Now Joining!");

54 
Th»ad
 
t
 : 
th»ads
) {

55 
t
.
	`isAlive
()) {

56 
Œy
 {

57 
t
.
	`još
(
wa™TimeOutInMS
);

58 ià(
t
.
	`isAlive
()) {

59 
Sy¡em
.
out
.
	`´šn
("StÈwa™šg fÜh»ad " + 
t
.
	`g‘Name
() + "o complete. " +

60 "WÜklßd stus: " + 
wÜklßd
.
	`isStİReque¡ed
());

62 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

67 
	}
}

	@core/src/main/java/site/ycsb/TimeseriesDB.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gG’”©Ü
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gInüem’tšgPršbËSŒšgG’”©Ü
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gTimeS”›sWÜklßd
;

23 
impÜt
 
	gjava
.
	gut
.*;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

39 
public
 
ab¡¿ù
 cÏs 
	cTime£r›sDB
 
ex‹nds
 
	mDB
 {

42 
´iv©e
 
fš®
 
SŒšg
 
	mDOWNSAMPLING_FUNCTION_PROPERTY_DEFAULT
 = "NONE";

43 
´iv©e
 
fš®
 
SŒšg
 
	mDOWNSAMPLING_INTERVAL_PROPERTY_DEFAULT
 = "0";

46 
´iv©e
 
fš®
 
SŒšg
 
	mDEBUG_PROPERTY
 = "debug";

47 
´iv©e
 
fš®
 
SŒšg
 
	mDEBUG_PROPERTY_DEFAULT
 = "false";

50 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_PROPERTY
 = "test";

51 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_PROPERTY_DEFAULT
 = "false";

54 
´Ùeùed
 
SŒšg
 
	mtime¡ampKey
;

55 
´Ùeùed
 
SŒšg
 
	mv®ueKey
;

56 
´Ùeùed
 
SŒšg
 
	mgPaœD–im™”
;

57 
´Ùeùed
 
SŒšg
 
	mqu”yTimeS·nD–im™”
;

58 
´Ùeùed
 
SŒšg
 
	md–‘eD–im™”
;

59 
´Ùeùed
 
TimeUn™
 
	mtime¡ampUn™
;

60 
´Ùeùed
 
SŒšg
 
	mgroupByKey
;

61 
´Ùeùed
 
SŒšg
 
	mdown§m¶šgKey
;

62 
´Ùeùed
 
IÁeg”
 
	mdown§m¶šgIÁ”v®
;

63 
´Ùeùed
 
Agg»g©iÚO³¿tiÚ
 
	mdown§m¶šgFunùiÚ
;

66 
´Ùeùed
 
boŞ—n
 
	mdebug
;

67 
´Ùeùed
 
boŞ—n
 
	m‹¡
;

73 @
Ov”ride


74 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

76 
time¡ampKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

77 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY
,

78 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
);

79 
v®ueKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

80 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY
,

81 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
);

82 
gPaœD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

83 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY
,

84 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY_DEFAULT
);

85 
qu”yTimeS·nD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

86 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY
,

87 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
);

88 
d–‘eD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

89 
TimeS”›sWÜklßd
.
DELETE_DELIMITER_PROPERTY
,

90 
TimeS”›sWÜklßd
.
DELETE_DELIMITER_PROPERTY_DEFAULT
);

91 
time¡ampUn™
 = 
TimeUn™
.
	`v®ueOf
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

92 
TimeS”›sWÜklßd
.
TIMESTAMP_UNITS_PROPERTY
,

93 
TimeS”›sWÜklßd
.
TIMESTAMP_UNITS_PROPERTY_DEFAULT
));

94 
groupByKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

95 
TimeS”›sWÜklßd
.
GROUPBY_KEY_PROPERTY
,

96 
TimeS”›sWÜklßd
.
GROUPBY_KEY_PROPERTY_DEFAULT
);

97 
down§m¶šgKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

98 
TimeS”›sWÜklßd
.
DOWNSAMPLING_KEY_PROPERTY
,

99 
TimeS”›sWÜklßd
.
DOWNSAMPLING_KEY_PROPERTY_DEFAULT
);

100 
down§m¶šgFunùiÚ
 = 
Time£r›sDB
.
Agg»g©iÚO³¿tiÚ
.
	`v®ueOf
(
	`g‘Prİ”t›s
()

101 .
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_FUNCTION_PROPERTY
, 
DOWNSAMPLING_FUNCTION_PROPERTY_DEFAULT
));

102 
down§m¶šgIÁ”v®
 = 
IÁeg”
.
	`v®ueOf
(
	`g‘Prİ”t›s
()

103 .
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_INTERVAL_PROPERTY
, 
DOWNSAMPLING_INTERVAL_PROPERTY_DEFAULT
));

105 
‹¡
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
TEST_PROPERTY
, 
TEST_PROPERTY_DEFAULT
));

106 
debug
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
DEBUG_PROPERTY
, 
DEBUG_PROPERTY_DEFAULT
));

109 @
Ov”ride


110 
public
 
fš®
 
Stus
 
	`»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

111 
M­
<
SŒšg
, 
Li¡
<SŒšg>> 
gQu”›s
 = 
Ãw
 
HashM­
<>();

112 
LÚg
 
time¡amp
 = 
nuÎ
;

113 
SŒšg
 
f›ld
 : 
f›lds
) {

114 ià(
f›ld
.
	`¡¬tsW™h
(
time¡ampKey
)) {

115 
SŒšg
[] 
time¡ampP¬ts
 = 
f›ld
.
	`¥l™
(
gPaœD–im™”
);

116 ià(
time¡ampP¬ts
[1].
	`cÚšs
(
qu”yTimeS·nD–im™”
)) {

119  
Stus
.
BAD_REQUEST
;

121 
time¡amp
 = 
LÚg
.
	`v®ueOf
(
time¡ampP¬ts
[1]);

123 
SŒšg
[] 
qu”yP¬ts
 = 
f›ld
.
	`¥l™
(
gPaœD–im™”
);

124 
gQu”›s
.
	`compu‹IfAb£Á
(
qu”yP¬ts
[0], 
k
 -> 
Ãw
 
A¼ayLi¡
<>()).
	`add
(queryParts[1]);

127 ià(
time¡amp
 =ğ
nuÎ
) {

128  
Stus
.
BAD_REQUEST
;

131  
	`»ad
(
bË
, 
time¡amp
, 
gQu”›s
);

132 
	}
}

142 
´Ùeùed
 
ab¡¿ù
 
Stus
 
»ad
(
SŒšg
 
m‘ric
, 
time¡amp
, 
M­
<SŒšg, 
Li¡
<SŒšg>> 
gs
);

149 @
Ov”ride


150 
public
 
fš®
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

151 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

152 
	gM­
<
	gSŒšg
, 
	gLi¡
<SŒšg>> 
	ggQu”›s
 = 
Ãw
 
HashM­
<>();

153 
	gTime£r›sDB
.
Agg»g©iÚO³¿tiÚ
 
	gagg»g©iÚO³¿tiÚ
 = 
Time£r›sDB
.Agg»g©iÚO³¿tiÚ.
NONE
;

154 
	gS‘
<
	gSŒšg
> 
	ggroupByF›lds
 = 
Ãw
 
HashS‘
<>();

156 
boŞ—n
 
	g¿ngeS‘
 = 
çl£
;

157 
	g¡¬t
 = 0;

158 
	g’d
 = 0;

159 
SŒšg
 
	gf›ld
 : 
f›lds
) {

160 ià(
f›ld
.
¡¬tsW™h
(
time¡ampKey
)) {

161 
SŒšg
[] 
time¡ampP¬ts
 = 
f›ld
.
¥l™
(
gPaœD–im™”
);

162 ià(!
	gtime¡ampP¬ts
[1].
cÚšs
(
qu”yTimeS·nD–im™”
)) {

166  
	gStus
.
	gNOT_IMPLEMENTED
;

168 
	gSŒšg
[] 
	g¿ngeP¬ts
 = 
time¡ampP¬ts
[1].
¥l™
(
qu”yTimeS·nD–im™”
);

169 
	g¿ngeS‘
 = 
Œue
;

170 
	g¡¬t
 = 
LÚg
.
v®ueOf
(
¿ngeP¬ts
[0]);

171 
	g’d
 = 
LÚg
.
v®ueOf
(
¿ngeP¬ts
[1]);

172 } ià(
	gf›ld
.
¡¬tsW™h
(
groupByKey
)) {

173 
SŒšg
 
	ggroupByS³cif›r
 = 
f›ld
.
¥l™
(
gPaœD–im™”
)[1];

174 
	gagg»g©iÚO³¿tiÚ
 = 
Time£r›sDB
.
Agg»g©iÚO³¿tiÚ
.
v®ueOf
(
groupByS³cif›r
);

175 } ià(
	gf›ld
.
¡¬tsW™h
(
down§m¶šgKey
)) {

176 
SŒšg
 
	gdown§m¶šgS³c
 = 
f›ld
.
¥l™
(
gPaœD–im™”
)[1];

178 ià(!
	gdown§m¶šgS³c
.
equ®s
(
down§m¶šgFunùiÚ
.
toSŒšg
(è+ 
down§m¶šgIÁ”v®
.toString())) {

179 
	gSy¡em
.
	g”r
.
´št
("Downsampling specification for Scan did‚ot match configured downsampling");

180  
	gStus
.
	gBAD_REQUEST
;

183 
	gSŒšg
[] 
	gqu”yP¬ts
 = 
f›ld
.
¥l™
(
gPaœD–im™”
);

184 ià(
	gqu”yP¬ts
.
	gËngth
 == 1) {

186 
Sy¡em
.
”r
.
´šn
("Grouping by‡rbitrary series is currently‚ot supported");

187 
	ggroupByF›lds
.
add
(
f›ld
);

189 
	ggQu”›s
.
compu‹IfAb£Á
(
qu”yP¬ts
[0], 
k
 -> 
Ãw
 
A¼ayLi¡
<>()).
add
(queryParts[1]);

193 ià(!
	g¿ngeS‘
) {

194  
	gStus
.
	gBAD_REQUEST
;

196  
sÿn
(
bË
, 
¡¬t
, 
’d
, 
gQu”›s
, 
down§m¶šgFunùiÚ
, 
down§m¶šgIÁ”v®
, 
time¡ampUn™
);

212 
´Ùeùed
 
ab¡¿ù
 
Stus
 
sÿn
(
SŒšg
 
m‘ric
, 
¡¬tTs
, 
’dTs
, 
M­
<SŒšg, 
Li¡
<SŒšg>> 
gs
,

213 
Agg»g©iÚO³¿tiÚ
 
agg»g
, 
timeV®ue
, 
TimeUn™
 
timeUn™
);

215 @
Ov”ride


216 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

217  
	gStus
.
	gNOT_IMPLEMENTED
;

222 @
Ov”ride


223 
public
 
fš®
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

224 
Num”icBy‹I‹¿tÜ
 
	gtsCÚš”
 = (Num”icBy‹I‹¿tÜè
v®ues
.
»move
(
time¡ampKey
);

225 
Num”icBy‹I‹¿tÜ
 
	gv®ueCÚš”
 = (Num”icBy‹I‹¿tÜè
v®ues
.
»move
(
v®ueKey
);

226 ià(
	gv®ueCÚš”
.
isFlßtšgPošt
()) {

227  
š£¹
(
bË
, 
tsCÚš”
.
g‘LÚg
(), 
v®ueCÚš”
.
g‘DoubË
(), 
v®ues
);

229  
š£¹
(
bË
, 
tsCÚš”
.
g‘LÚg
(), 
v®ueCÚš”
.g‘LÚg(), 
v®ues
);

243 
´Ùeùed
 
ab¡¿ù
 
Stus
 
š£¹
(
SŒšg
 
m‘ric
, 
time¡amp
, 
v®ue
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
gs
);

255 
´Ùeùed
 
ab¡¿ù
 
Stus
 
š£¹
(
SŒšg
 
m‘ric
, 
time¡amp
, 
v®ue
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
gs
);

264 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

265  
Stus
.
NOT_IMPLEMENTED
;

266 
	}
}

282 
´Ùeùed
 
	gSŒšg
[] 
	$g‘PossibËTagKeys
(
Prİ”t›s
 
´İ”t›s
) {

283 
fš®
 
gCouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
TAG_COUNT_PROPERTY
,

284 
TimeS”›sWÜklßd
.
TAG_COUNT_PROPERTY_DEFAULT
));

285 
fš®
 
gKeyËngth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
TAG_KEY_LENGTH_PROPERTY
,

286 
TimeS”›sWÜklßd
.
TAG_KEY_LENGTH_PROPERTY_DEFAULT
));

288 
G’”©Ü
<
SŒšg
> 
gKeyG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
gKeyËngth
);

289 
SŒšg
[] 
gNames
 = 
Ãw
 SŒšg[
gCouÁ
];

290 
i
 = 0; i < 
gCouÁ
; i++) {

291 
gNames
[
i
] = 
gKeyG’”©Ü
.
	`ÃxtV®ue
();

293  
gNames
;

294 
	}
}

305 
public
 
	eAgg»g©iÚO³¿tiÚ
 {

309 
	gNONE
,

314 
	gSUM
,

319 
	gAVERAGE
,

324 
	gCOUNT
,

329 
	gMAX
,

334 
	gMIN
;

	@core/src/main/java/site/ycsb/UnknownDBException.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cUnknownDBExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

27 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 459099842269616836L;

29 
public
 
	$UnknownDBExû±iÚ
(
SŒšg
 
mes§ge
) {

30 
	`su³r
(
mes§ge
);

33 
public
 
	$UnknownDBExû±iÚ
() {

34 
	`su³r
();

35 
	}
}

37 
public
 
	$UnknownDBExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

38 
	`su³r
(
mes§ge
, 
ÿu£
);

39 
	}
}

41 
public
 
	$UnknownDBExû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@core/src/main/java/site/ycsb/Utils.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gG¬bageCŞËùÜMXB—n
;

21 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gMªagem’tFaùÜy
;

22 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gO³¿tšgSy¡emMXB—n
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

31 
public
 
fš®
 cÏs 
	cUts
 {

32 
´iv©e
 
	$Uts
() {

39 
public
 
	$hash
(
v®
) {

40  
	`âvhash64
(
v®
);

41 
	}
}

43 
public
 
fš®
 
	gFNV_OFFSET_BASIS_64
 = 0xCBF29CE484222325L;

44 
public
 
fš®
 
	gFNV_PRIME_64
 = 1099511628211L;

52 
public
 
	$âvhash64
(
v®
) {

54 
hashv®
 = 
FNV_OFFSET_BASIS_64
;

56 
i
 = 0; i < 8; i++) {

57 
où‘
 = 
v®
 & 0x00ff;

58 
v®
 = val >> 8;

60 
hashv®
 = hashv® ^ 
où‘
;

61 
hashv®
 = hashv® * 
FNV_PRIME_64
;

64  
M©h
.
	`abs
(
hashv®
);

65 
	}
}

74 
public
 
	$by‹sToLÚg
(
fš®
 
by‹
[] 
by‹s
) {

75  (
by‹s
[0] & 0xFFL) << 56

76 | (
by‹s
[1] & 0xFFL) << 48

77 | (
by‹s
[2] & 0xFFL) << 40

78 | (
by‹s
[3] & 0xFFL) << 32

79 | (
by‹s
[4] & 0xFFL) << 24

80 | (
by‹s
[5] & 0xFFL) << 16

81 | (
by‹s
[6] & 0xFFL) << 8

82 | (
by‹s
[7] & 0xFFL) << 0;

83 
	}
}

90 
public
 
	gby‹
[] 
	$lÚgToBy‹s
(
fš®
 
v®
) {

91 
fš®
 
by‹
[] 
by‹s
 = 
Ãw
 byte[8];

92 
by‹s
[0] = (
by‹
è(
v®
 >>> 56);

93 
by‹s
[1] = (
by‹
è(
v®
 >>> 48);

94 
by‹s
[2] = (
by‹
è(
v®
 >>> 40);

95 
by‹s
[3] = (
by‹
è(
v®
 >>> 32);

96 
by‹s
[4] = (
by‹
è(
v®
 >>> 24);

97 
by‹s
[5] = (
by‹
è(
v®
 >>> 16);

98 
by‹s
[6] = (
by‹
è(
v®
 >>> 8);

99 
by‹s
[7] = (
by‹
è(
v®
 >>> 0);

100  
by‹s
;

101 
	}
}

112 
public
 
	$by‹sToDoubË
(
fš®
 
by‹
[] 
by‹s
) {

113 ià(
by‹s
.
Ëngth
 < 8) {

114 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Byte‡rray must be 8 bytes wide.");

116  
DoubË
.
	`lÚgB™sToDoubË
(
	`by‹sToLÚg
(
by‹s
));

117 
	}
}

124 
public
 
	gby‹
[] 
	$doubËToBy‹s
(
fš®
 
v®
) {

125  
	`lÚgToBy‹s
(
DoubË
.
	`doubËToRawLÚgB™s
(
v®
));

126 
	}
}

138 
public
 
	$g‘AùiveTh»adCouÁ
() {

139  
Th»ad
.
	`aùiveCouÁ
();

140 
	}
}

143 
public
 
	$g‘U£dMemÜyBy‹s
() {

144 
fš®
 
RuÁime
 
ruÁime
 = RuÁime.
	`g‘RuÁime
();

145  
ruÁime
.
	`tÙ®MemÜy
(è-„uÁime.
	`ä“MemÜy
();

146 
	}
}

149 
public
 
	$g‘U£dMemÜyMegaBy‹s
() {

150  (è(
	`g‘U£dMemÜyBy‹s
() / 1024 / 1024);

151 
	}
}

155 
public
 
	$g‘Sy¡emLßdAv”age
() {

156 
fš®
 
O³¿tšgSy¡emMXB—n
 
osB—n
 =

157 
Mªagem’tFaùÜy
.
	`g‘O³¿tšgSy¡emMXB—n
();

158  
osB—n
.
	`g‘Sy¡emLßdAv”age
();

159 
	}
}

163 
public
 
	$g‘GCTÙ®CŞËùiÚCouÁ
() {

164 
fš®
 
Li¡
<
G¬bageCŞËùÜMXB—n
> 
gcB—ns
 =

165 
Mªagem’tFaùÜy
.
	`g‘G¬bageCŞËùÜMXB—ns
();

166 
couÁ
 = 0;

167 
fš®
 
G¬bageCŞËùÜMXB—n
 
b—n
 : 
gcB—ns
) {

168 ià(
b—n
.
	`g‘CŞËùiÚCouÁ
() < 0) {

171 
couÁ
 +ğ
b—n
.
	`g‘CŞËùiÚCouÁ
();

173  
couÁ
;

174 
	}
}

177 
public
 
	$g‘GCTÙ®Time
() {

178 
fš®
 
Li¡
<
G¬bageCŞËùÜMXB—n
> 
gcB—ns
 =

179 
Mªagem’tFaùÜy
.
	`g‘G¬bageCŞËùÜMXB—ns
();

180 
time
 = 0;

181 
fš®
 
G¬bageCŞËùÜMXB—n
 
b—n
 : 
gcB—ns
) {

182 ià(
b—n
.
	`g‘CŞËùiÚTime
() < 0) {

185 
time
 +ğ
b—n
.
	`g‘CŞËùiÚTime
();

187  
time
;

188 
	}
}

199 
public
 
	gM­
<
	gSŒšg
, 
	gLÚg
[]> 
	$g‘GCSt¡
() {

200 
fš®
 
Li¡
<
G¬bageCŞËùÜMXB—n
> 
gcB—ns
 =

201 
Mªagem’tFaùÜy
.
	`g‘G¬bageCŞËùÜMXB—ns
();

202 
fš®
 
M­
<
SŒšg
, 
LÚg
[]> 
m­
 = 
Ãw
 
HashM­
<SŒšg, LÚg[]>(
gcB—ns
.
	`size
());

203 
fš®
 
G¬bageCŞËùÜMXB—n
 
b—n
 : 
gcB—ns
) {

204 ià(!
b—n
.
	`isV®id
(è|| b—n.
	`g‘CŞËùiÚCouÁ
() < 0 ||

205 
b—n
.
	`g‘CŞËùiÚTime
() < 0) {

209 
fš®
 
LÚg
[] 
m—su»m’ts
 = 
Ãw
 Long[]{

210 
b—n
.
	`g‘CŞËùiÚCouÁ
(),

211 
b—n
.
	`g‘CŞËùiÚTime
()

213 
m­
.
	`put
(
b—n
.
	`g‘Name
().
	`»¶aû
(" ", "_"), 
m—su»m’ts
);

215  
m­
;

216 
	}
}

223 
public
 <
	gT
> T [] 
	$shufæeA¼ay
(
fš®
 
T
[] 
¬¿y
) {

224 
i
 = 
¬¿y
.
Ëngth
 -1; i > 0; i--) {

225 
fš®
 
idx
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
(
i
 + 1);

226 
fš®
 
T
 
‹mp
 = 
¬¿y
[
idx
];

227 
¬¿y
[
idx
] =‡¼ay[
i
];

228 
¬¿y
[
i
] = 
‹mp
;

230  
¬¿y
;

231 
	}
}

	@core/src/main/java/site/ycsb/Workload.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

21 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

38 
public
 
ab¡¿ù
 cÏs 
	cWÜklßd
 {

39 
public
 
fš®
 
SŒšg
 
	mINSERT_START_PROPERTY
 = "insertstart";

40 
public
 
fš®
 
SŒšg
 
	mINSERT_COUNT_PROPERTY
 = "insertcount";

42 
public
 
fš®
 
SŒšg
 
	mINSERT_START_PROPERTY_DEFAULT
 = "0";

44 
´iv©e
 vŞ©
AtomicBoŞ—n
 
	m¡İReque¡ed
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

47 
public
 
	eO³¿tiÚ
 {

48 
	mREAD
,

49 
	mUPDATE
,

50 
	mINSERT
,

51 
	mSCAN
,

52 
	mDELETE


59 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

60 
	}
}

76 
public
 
Objeù
 
	$š™Th»ad
(
Prİ”t›s
 
p
, 
myth»adid
, 
th»adcouÁ
è
throws
 
WÜklßdExû±iÚ
 {

77  
nuÎ
;

78 
	}
}

83 
public
 
	$ş—nup
(è
throws
 
WÜklßdExû±iÚ
 {

84 
	}
}

93 
public
 
ab¡¿ù
 
boŞ—n
 
doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
);

106 
public
 
ab¡¿ù
 
boŞ—n
 
doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
);

111 
public
 
	$»que¡Stİ
() {

112 
¡İReque¡ed
.
	`£t
(
Œue
);

113 
	}
}

119 
public
 
boŞ—n
 
	$isStİReque¡ed
() {

120  
¡İReque¡ed
.
	`g‘
();

121 
	}
}

	@core/src/main/java/site/ycsb/WorkloadException.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cWÜklßdExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

27 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 8844396756042772132L;

29 
public
 
	$WÜklßdExû±iÚ
(
SŒšg
 
mes§ge
) {

30 
	`su³r
(
mes§ge
);

33 
public
 
	$WÜklßdExû±iÚ
() {

34 
	`su³r
();

35 
	}
}

37 
public
 
	$WÜklßdExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

38 
	`su³r
(
mes§ge
, 
ÿu£
);

39 
	}
}

41 
public
 
	$WÜklßdExû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@core/src/main/java/site/ycsb/generator/AcknowledgedCounterGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁLock
;

25 
public
 cÏs 
	cAcknowËdgedCouÁ”G’”©Ü
 
ex‹nds
 
	mCouÁ”G’”©Ü
 {

27 
fš®
 
	mWINDOW_SIZE
 = 
IÁeg”
.
rÙ©eLeá
(1, 20);

30 
´iv©e
 
fš®
 
	mWINDOW_MASK
 = 
WINDOW_SIZE
 - 1;

32 
´iv©e
 
fš®
 
R“Á¿ÁLock
 
	mlock
;

33 
´iv©e
 
fš®
 
	mboŞ—n
[] 
	mwšdow
;

34 
´iv©e
 vŞ©
	mlim™
;

39 
public
 
	$AcknowËdgedCouÁ”G’”©Ü
(
couÁ¡¬t
) {

40 
	`su³r
(
couÁ¡¬t
);

41 
lock
 = 
Ãw
 
	`R“Á¿ÁLock
();

42 
wšdow
 = 
Ãw
 
boŞ—n
[
WINDOW_SIZE
];

43 
lim™
 = 
couÁ¡¬t
 - 1;

50 @
Ov”ride


51 
public
 
LÚg
 
	$Ï¡V®ue
() {

52  
lim™
;

53 
	}
}

58 
public
 
	$acknowËdge
(
v®ue
) {

59 
fš®
 
cu¼’tSlÙ
 = ()(
v®ue
 & 
WINDOW_MASK
);

60 ià(
wšdow
[
cu¼’tSlÙ
]) {

61 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Too many unacknowledged insertion keys.");

64 
wšdow
[
cu¼’tSlÙ
] = 
Œue
;

66 ià(
lock
.
	`ŒyLock
()) {

69 
Œy
 {

71 
befÜeFœ¡SlÙ
 = (
lim™
 & 
WINDOW_MASK
);

72 
šdex
;

73 
šdex
 = 
lim™
 + 1; index !ğ
befÜeFœ¡SlÙ
; ++index) {

74 
¦Ù
 = ()(
šdex
 & 
WINDOW_MASK
);

75 ià(!
wšdow
[
¦Ù
]) {

79 
wšdow
[
¦Ù
] = 
çl£
;

82 
lim™
 = 
šdex
 - 1;

83 } 
fš®ly
 {

84 
lock
.
	`uÆock
();

87 
	}
}

	@core/src/main/java/site/ycsb/generator/ConstantIntegerGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

23 
public
 cÏs 
	cCÚ¡ªtIÁeg”G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

24 
´iv©e
 
fš®
 
	mi
;

29 
public
 
	$CÚ¡ªtIÁeg”G’”©Ü
(
i
) {

30 
this
.
i
 = i;

33 @
Ov”ride


34 
public
 
IÁeg”
 
	$ÃxtV®ue
() {

35  
i
;

36 
	}
}

38 @
Ov”ride


39 
public
 
	$m—n
() {

40  
i
;

41 
	}
}

	@core/src/main/java/site/ycsb/generator/CounterGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

26 
public
 cÏs 
	cCouÁ”G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

27 
´iv©e
 
fš®
 
AtomicLÚg
 
	mcouÁ”
;

32 
public
 
	$CouÁ”G’”©Ü
(
couÁ¡¬t
) {

33 
couÁ”
=
Ãw
 
	`AtomicLÚg
(
couÁ¡¬t
);

36 @
Ov”ride


37 
public
 
LÚg
 
	$ÃxtV®ue
() {

38  
couÁ”
.
	`g‘AndInüem’t
();

39 
	}
}

41 @
Ov”ride


42 
public
 
LÚg
 
	$Ï¡V®ue
() {

43  
couÁ”
.
	`g‘
() - 1;

44 
	}
}

46 @
Ov”ride


47 
public
 
	$m—n
() {

48 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't compute mean of‚on-stationary distribution!");

49 
	}
}

	@core/src/main/java/site/ycsb/generator/DiscreteGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
.
	g»quœeNÚNuÎ
;

29 
public
 
şass
 
Disü‘eG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

30 
´iv©e
 şas 
	cPaœ
 {

31 
´iv©e
 
	gweight
;

32 
´iv©e
 
SŒšg
 
	gv®ue
;

34 
Paœ
(
weight
, 
SŒšg
 
v®ue
) {

35 
	gthis
.
	gweight
 = 
weight
;

36 
	gthis
.
	gv®ue
 = 
»quœeNÚNuÎ
(
v®ue
);

40 
´iv©e
 
fš®
 
	gCŞËùiÚ
<
	gPaœ
> 
	gv®ues
 = 
Ãw
 
A¼ayLi¡
<>();

41 
´iv©e
 
SŒšg
 
	gÏ¡v®ue
;

43 
public
 
	$Disü‘eG’”©Ü
() {

44 
Ï¡v®ue
 = 
nuÎ
;

45 
	}
}

50 @
Ov”ride


51 
public
 
SŒšg
 
	$ÃxtV®ue
() {

52 
sum
 = 0;

54 
Paœ
 
p
 : 
v®ues
) {

55 
sum
 +ğ
p
.
weight
;

58 
v®
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtDoubË
();

60 
Paœ
 
p
 : 
v®ues
) {

61 
pw
 = 
p
.
weight
 / 
sum
;

62 ià(
v®
 < 
pw
) {

63  
p
.
v®ue
;

66 
v®
 -ğ
pw
;

69 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("oops. should‚ot get here.");

71 
	}
}

78 @
Ov”ride


79 
public
 
SŒšg
 
	$Ï¡V®ue
() {

80 ià(
Ï¡v®ue
 =ğ
nuÎ
) {

81 
Ï¡v®ue
 = 
	`ÃxtV®ue
();

83  
Ï¡v®ue
;

84 
	}
}

86 
public
 
	$addV®ue
(
weight
, 
SŒšg
 
v®ue
) {

87 
v®ues
.
	`add
(
Ãw
 
	`Paœ
(
weight
, 
v®ue
));

88 
	}
}

	@core/src/main/java/site/ycsb/generator/ExponentialGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

31 
public
 cÏs 
	cExpÚ’tŸlG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

33 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_PERCENTILE_PROPERTY
 = "exponential.percentile";

34 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_PERCENTILE_DEFAULT
 = "95";

37 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_FRAC_PROPERTY
 = "exponential.frac";

38 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_FRAC_DEFAULT
 = "0.8571428571";

43 
´iv©e
 
	mgamma
;

51 
public
 
	$ExpÚ’tŸlG’”©Ü
(
m—n
) {

52 
gamma
 = 1.0 / 
m—n
;

55 
public
 
	$ExpÚ’tŸlG’”©Ü
(
³rûÁe
, 
¿nge
) {

56 
gamma
 = -
M©h
.
	`log
(1.0 - 
³rûÁe
 / 100.0è/ 
¿nge
;

57 
	}
}

67 @
Ov”ride


68 
public
 
DoubË
 
	$ÃxtV®ue
() {

69  -
M©h
.
	`log
(
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtDoubË
()è/ 
gamma
;

70 
	}
}

72 @
Ov”ride


73 
public
 
	$m—n
() {

74  1.0 / 
gamma
;

75 
	}
}

77 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

78 
ExpÚ’tŸlG’”©Ü
 
e
 = 
Ãw
 
	`ExpÚ’tŸlG’”©Ü
(90, 100);

79 
j
 = 0;

80 
i
 = 0; i < 1000; i++) {

81 ià(
e
.
	`ÃxtV®ue
() < 100) {

82 
j
++;

85 
Sy¡em
.
out
.
	`´šn
("GÙ " + 
j
 + " hits. Expect 900");

86 
	}
}

	@core/src/main/java/site/ycsb/generator/FileGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

21 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gio
.
	gR—d”
;

28 
public
 
şass
 
FeG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

29 
´iv©e
 
fš®
 
SŒšg
 
	gf’ame
;

30 
´iv©e
 
SŒšg
 
	gcu¼’t
;

31 
´iv©e
 
Bufã»dR—d”
 
	g»ad”
;

37 
public
 
FeG’”©Ü
(
SŒšg
 
f’ame
) {

38 
	gthis
.
	gf’ame
 = 
f’ame
;

39 
»lßdFe
();

45 @
Ov”ride


46 
public
 
synchrÚized
 
SŒšg
 
ÃxtV®ue
() {

47 
	gŒy
 {

48 
	gcu¼’t
 = 
»ad”
.
»adLše
();

49  
	gcu¼’t
;

50 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

51 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

58 @
Ov”ride


59 
public
 
SŒšg
 
Ï¡V®ue
() {

60  
	gcu¼’t
;

66 
public
 
synchrÚized
 
»lßdFe
() {

67 
Œy
 (
R—d”
 
r
 = 
»ad”
) {

68 
Sy¡em
.
”r
.
´šn
("R–ßd " + 
f’ame
);

69 
	g»ad”
 = 
Ãw
 
Bufã»dR—d”
Òew 
FeR—d”
(
f’ame
));

70 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

71 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

	@core/src/main/java/site/ycsb/generator/Generator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

23 
public
 
ab¡¿ù
 
şass
 
	gG’”©Ü
<
	gV
> {

27 
public
 
ab¡¿ù
 
V
 
ÃxtV®ue
();

35 
public
 
ab¡¿ù
 
V
 
Ï¡V®ue
();

37 
public
 
fš®
 
SŒšg
 
ÃxtSŒšg
() {

38 
V
 
	g»t
 = 
ÃxtV®ue
();

39  
	g»t
 =ğ
nuÎ
 ?‚uÎ : 
»t
.
toSŒšg
();

42 
public
 
fš®
 
SŒšg
 
Ï¡SŒšg
() {

43 
V
 
	g»t
 = 
Ï¡V®ue
();

44  
	g»t
 =ğ
nuÎ
 ?‚uÎ : 
»t
.
toSŒšg
();

	@core/src/main/java/site/ycsb/generator/HistogramGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

20 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

21 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

35 
public
 cÏs 
	cHi¡og¿mG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

37 
´iv©e
 
fš®
 
	mblockSize
;

38 
´iv©e
 
fš®
 [] 
	mbuck‘s
;

39 
´iv©e
 
	m¬—
;

40 
´iv©e
 
	mweigh‹dA»a
 = 0;

41 
´iv©e
 
	mm—nSize
 = 0;

43 
public
 
	$Hi¡og¿mG’”©Ü
(
SŒšg
 
hi¡og¿mfe
è
throws
 
IOExû±iÚ
 {

44 
	`Œy
 (
Bufã»dR—d”
 
š
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`FeR—d”
(
hi¡og¿mfe
))) {

45 
SŒšg
 
¡r
;

46 
SŒšg
[] 
lše
;

48 
A¼ayLi¡
<
IÁeg”
> 
a
 = 
Ãw
 ArrayList<>();

50 
¡r
 = 
š
.
	`»adLše
();

51 ià(
¡r
 =ğ
nuÎ
) {

52 
throw
 
Ãw
 
	`IOExû±iÚ
("Empty input file!\n");

54 
lše
 = 
¡r
.
	`¥l™
("\t");

55 ià(
lše
[0].
	`com·»To
("BlockSize") != 0) {

56 
throw
 
Ãw
 
	`IOExû±iÚ
("First†ine of histogram is‚othe BlockSize!\n");

58 
blockSize
 = 
IÁeg”
.
	`·r£IÁ
(
lše
[1]);

60 (
¡r
 = 
š
.
	`»adLše
()è!ğ
nuÎ
) {

62 
lše
 = 
¡r
.
	`¥l™
("\t");

64 
a
.
	`add
(
IÁeg”
.
	`·r£IÁ
(
lše
[0]), Integer.parseInt(line[1]));

66 
buck‘s
 = 
Ãw
 [
a
.
	`size
()];

67 
i
 = 0; i < 
a
.
	`size
(); i++) {

68 
buck‘s
[
i
] = 
a
.
	`g‘
(i);

71 
	`š™
();

74 
public
 
	$Hi¡og¿mG’”©Ü
([] 
buck‘s
, 
blockSize
) {

75 
this
.
blockSize
 = blockSize;

76 
this
.
buck‘s
 = buckets;

77 
	`š™
();

78 
	}
}

80 
´iv©e
 
	$š™
() {

81 
i
 = 0; i < 
buck‘s
.
Ëngth
; i++) {

82 
¬—
 +ğ
buck‘s
[
i
];

83 
weigh‹dA»a
 +ğ
i
 * 
buck‘s
[i];

86 
m—nSize
 = ((è
blockSize
è* ((è
weigh‹dA»a
è/ (
¬—
);

87 
	}
}

89 @
Ov”ride


90 
public
 
LÚg
 
	$ÃxtV®ue
() {

91 
numb”
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
((è
¬—
);

92 
i
;

94 
i
 = 0; i < (
buck‘s
.
Ëngth
 - 1); i++) {

95 
numb”
 -ğ
buck‘s
[
i
];

96 ià(
numb”
 <= 0) {

97  (
i
 + 1è* 
blockSize
;

101  
i
 * 
blockSize
;

102 
	}
}

104 @
Ov”ride


105 
public
 
	$m—n
() {

106  
m—nSize
;

107 
	}
}

	@core/src/main/java/site/ycsb/generator/HotspotIntegerGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

31 
public
 cÏs 
	cHÙ¥ÙIÁeg”G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

33 
´iv©e
 
fš®
 
	mlow”Bound
;

34 
´iv©e
 
fš®
 
	muµ”Bound
;

35 
´iv©e
 
fš®
 
	mhÙIÁ”v®
;

36 
´iv©e
 
fš®
 
	mcŞdIÁ”v®
;

37 
´iv©e
 
fš®
 
	mhÙ£tF¿ùiÚ
;

38 
´iv©e
 
fš®
 
	mhÙO²F¿ùiÚ
;

48 
public
 
	$HÙ¥ÙIÁeg”G’”©Ü
(
low”Bound
, 
uµ”Bound
,

49 
hÙ£tF¿ùiÚ
, 
hÙO²F¿ùiÚ
) {

50 ià(
hÙ£tF¿ùiÚ
 < 0.0 || hotsetFraction > 1.0) {

51 
Sy¡em
.
”r
.
	`´šn
("Hotset fraction out of„ange. Settingo 0.0");

52 
hÙ£tF¿ùiÚ
 = 0.0;

54 ià(
hÙO²F¿ùiÚ
 < 0.0 || hotOpnFraction > 1.0) {

55 
Sy¡em
.
”r
.
	`´šn
("Hot operation fraction out of„ange. Settingo 0.0");

56 
hÙO²F¿ùiÚ
 = 0.0;

58 ià(
low”Bound
 > 
uµ”Bound
) {

59 
Sy¡em
.
”r
.
	`´šn
("Upper bound of Hotspot generator smallerhanhe†ower bound. " +

61 
‹mp
 = 
low”Bound
;

62 
low”Bound
 = 
uµ”Bound
;

63 
uµ”Bound
 = 
‹mp
;

65 
this
.
low”Bound
 =†owerBound;

66 
this
.
uµ”Bound
 = upperBound;

67 
this
.
hÙ£tF¿ùiÚ
 = hotsetFraction;

68 
š‹rv®
 = 
uµ”Bound
 - 
low”Bound
 + 1;

69 
this
.
hÙIÁ”v®
 = (è(
š‹rv®
 * 
hÙ£tF¿ùiÚ
);

70 
this
.
cŞdIÁ”v®
 = 
š‹rv®
 - 
hÙIÁ”v®
;

71 
this
.
hÙO²F¿ùiÚ
 = hotOpnFraction;

74 @
Ov”ride


75 
public
 
LÚg
 
	$ÃxtV®ue
() {

76 
v®ue
 = 0;

77 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

78 ià(
¿ndom
.
	`ÃxtDoubË
(è< 
hÙO²F¿ùiÚ
) {

80 
v®ue
 = 
low”Bound
 + 
M©h
.
	`abs
(
¿ndom
.
	`ÃxtLÚg
()è% 
hÙIÁ”v®
;

83 
v®ue
 = 
low”Bound
 + 
hÙIÁ”v®
 + 
M©h
.
	`abs
(
¿ndom
.
	`ÃxtLÚg
()è% 
cŞdIÁ”v®
;

85 
	`£tLa¡V®ue
(
v®ue
);

86  
v®ue
;

87 
	}
}

92 
public
 
	$g‘Low”Bound
() {

93  
low”Bound
;

94 
	}
}

99 
public
 
	$g‘Uµ”Bound
() {

100  
uµ”Bound
;

101 
	}
}

106 
public
 
	$g‘HÙ£tF¿ùiÚ
() {

107  
hÙ£tF¿ùiÚ
;

108 
	}
}

113 
public
 
	$g‘HÙO²F¿ùiÚ
() {

114  
hÙO²F¿ùiÚ
;

115 
	}
}

117 @
Ov”ride


118 
public
 
	$m—n
() {

119  
hÙO²F¿ùiÚ
 * (
low”Bound
 + 
hÙIÁ”v®
 / 2.0)

120 + (1 - 
hÙO²F¿ùiÚ
è* (
low”Bound
 + 
hÙIÁ”v®
 + 
cŞdIÁ”v®
 / 2.0);

121 
	}
}

	@core/src/main/java/site/ycsb/generator/IncrementingPrintableStringGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.*;

41 
public
 
şass
 
Inüem’tšgPršbËSŒšgG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

44 
public
 
fš®
 
	gDEFAULTSTRINGLENGTH
 = 8;

50 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPES_ALL_BUT_CONTROL
;

53 
	gCHAR_TYPES_ALL_BUT_CONTROL
 = 
Ãw
 
HashS‘
<
IÁeg”
>(24);

55 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
DECIMAL_DIGIT_NUMBER
);

56 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
LETTER_NUMBER
);

57 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_NUMBER
);

60 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

61 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

62 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
TITLECASE_LETTER
);

63 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_LETTER
);

66 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
COMBINING_SPACING_MARK
);

67 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
NON_SPACING_MARK
);

68 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
ENCLOSING_MARK
);

71 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
CONNECTOR_PUNCTUATION
);

72 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
DASH_PUNCTUATION
);

73 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
START_PUNCTUATION
);

74 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
END_PUNCTUATION
);

75 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
INITIAL_QUOTE_PUNCTUATION
);

76 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
FINAL_QUOTE_PUNCTUATION
);

77 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_PUNCTUATION
);

80 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
MATH_SYMBOL
);

81 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
CURRENCY_SYMBOL
);

82 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
MODIFIER_SYMBOL
);

83 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_SYMBOL
);

86 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
SPACE_SEPARATOR
);

87 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
LINE_SEPARATOR
);

88 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
PARAGRAPH_SEPARATOR
);

94 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPES_BASIC_ALPHA
;

97 
	gCHAR_TYPES_BASIC_ALPHA
 = 
Ãw
 
HashS‘
<
IÁeg”
>(2);

98 
	gCHAR_TYPES_BASIC_ALPHA
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

99 
	gCHAR_TYPES_BASIC_ALPHA
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

105 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
;

108 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
 = 
Ãw
 
HashS‘
<
IÁeg”
>(3);

109 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
DECIMAL_DIGIT_NUMBER
);

110 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

111 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

119 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
;

122 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
 = 
Ãw
 
HashS‘
<
IÁeg”
>(8);

123 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
DECIMAL_DIGIT_NUMBER
);

124 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
LETTER_NUMBER
);

125 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
OTHER_NUMBER
);

126 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

127 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

128 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
TITLECASE_LETTER
);

129 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
MODIFIER_LETTER
);

130 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
OTHER_LETTER
);

134 
´iv©e
 
fš®
 [] 
	gch¬aù”S‘
;

137 
´iv©e
 [] 
	gšdiûs
;

140 
´iv©e
 
fš®
 
	gËngth
;

144 
´iv©e
 
SŒšg
 
	gÏ¡V®ue
;

147 
´iv©e
 
boŞ—n
 
	gthrowExû±iÚOnRŞlov”
;

150 
´iv©e
 
boŞ—n
 
	ghasRŞËdOv”
;

156 
public
 
Inüem’tšgPršbËSŒšgG’”©Ü
() {

157 
this
(
DEFAULTSTRINGLENGTH
, 
´šbËBasicAÍhaASCIIS‘
());

166 
public
 
Inüem’tšgPršbËSŒšgG’”©Ü
(
fš®
 
Ëngth
) {

167 
this
(
Ëngth
, 
´šbËBasicAÍhaASCIIS‘
());

179 
public
 
Inüem’tšgPršbËSŒšgG’”©Ü
(
fš®
 
Ëngth
, fš® [] 
ch¬aù”S‘
) {

180 ià(
	gËngth
 < 1) {

181 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Length must be greaterhan orƒqualo 1");

183 ià(
	gch¬aù”S‘
 =ğ
nuÎ
 || 
ch¬aù”S‘
.
Ëngth
 < 1) {

184 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Character set must have‡t†east one character");

186 
	gthis
.
	gËngth
 = 
Ëngth
;

187 
	gthis
.
	gch¬aù”S‘
 = 
ch¬aù”S‘
;

188 
	gšdiûs
 = 
Ãw
 [
Ëngth
];

191 @
Ov”ride


192 
public
 
SŒšg
 
ÃxtV®ue
() {

193 ià(
	ghasRŞËdOv”
 && 
	gthrowExû±iÚOnRŞlov”
) {

194 
throw
 
Ãw
 
NoSuchEËm’tExû±iÚ
("The generator has„olled overohe beginning");

197 
fš®
 
SŒšgBud”
 
	gbufãr
 = 
Ãw
 SŒšgBud”(
Ëngth
);

198 
	gi
 = 0; i < 
	gËngth
; i++) {

199 
	gbufãr
.
­³nd
(
Ch¬aù”
.
toCh¬s
(
ch¬aù”S‘
[
šdiûs
[
i
]]));

203 
	gi
 = 
Ëngth
 - 1; i >= 0; --i) {

204 ià(
	gšdiûs
[
i
] >ğ
ch¬aù”S‘
.
Ëngth
 - 1) {

205 
šdiûs
[
i
] = 0;

206 ià(
	gi
 =ğ0 || 
ch¬aù”S‘
.
Ëngth
 =ğ1 && 
Ï¡V®ue
 !ğ
nuÎ
) {

207 
hasRŞËdOv”
 = 
Œue
;

210 ++
	gšdiûs
[
i
];

215 
	gÏ¡V®ue
 = 
bufãr
.
toSŒšg
();

216  
	gÏ¡V®ue
;

219 @
Ov”ride


220 
public
 
SŒšg
 
Ï¡V®ue
() {

221  
	gÏ¡V®ue
;

225 
public
 
£tThrowExû±iÚOnRŞlov”
(
fš®
 
boŞ—n
 
exû±iÚOnRŞlov”
) {

226 
	gthis
.
	gthrowExû±iÚOnRŞlov”
 = 
exû±iÚOnRŞlov”
;

230 
public
 
boŞ—n
 
g‘ThrowExû±iÚOnRŞlov”
() {

231  
	gthrowExû±iÚOnRŞlov”
;

239 
public
 [] 
´šbËBasicAÍhaASCIIS‘
() {

240 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

241 
g’”©ePršbËCh¬aù”S‘
(0, 127, 
nuÎ
, 
çl£
, 
CHAR_TYPES_BASIC_ALPHA
);

242 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

243 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

244 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

246  
	gch¬aù”S‘
;

255 
public
 [] 
´šbËBasicAÍhaNum”icASCIIS‘
() {

256 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

257 
g’”©ePršbËCh¬aù”S‘
(0, 127, 
nuÎ
, 
çl£
, 
CHAR_TYPES_BASIC_ALPHANUMERICS
);

258 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

259 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

260 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

262  
	gch¬aù”S‘
;

270 
public
 [] 
fuÎPršbËBasicASCIIS‘
() {

271 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

272 
g’”©ePršbËCh¬aù”S‘
(32, 127, 
nuÎ
, 
çl£
,‚ull);

273 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

274 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

275 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

277  
	gch¬aù”S‘
;

285 
public
 [] 
fuÎPršbËBasicASCIIS‘W™hNewlšes
() {

286 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 = 
Ãw
 
A¼ayLi¡
<
IÁeg”
>();

287 
	gv®idCh¬aù”s
.
add
(10);

288 
	gv®idCh¬aù”s
.
addAÎ
(
g’”©ePršbËCh¬aù”S‘
(32, 127, 
nuÎ
, 
çl£
,‚ull));

289 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

290 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

291 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

293  
	gch¬aù”S‘
;

301 
public
 [] 
´šbËAÍhaNum”icPÏÃZ”oS‘
() {

302 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

303 
g’”©ePršbËCh¬aù”S‘
(0, 65535, 
nuÎ
, 
çl£
, 
CHAR_TYPES_BASIC_ALPHANUMERICS
);

304 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

305 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

306 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

308  
	gch¬aù”S‘
;

316 
public
 [] 
fuÎPršbËPÏÃZ”oS‘
() {

317 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

318 
g’”©ePršbËCh¬aù”S‘
(0, 65535, 
nuÎ
, 
çl£
, 
CHAR_TYPES_ALL_BUT_CONTROL
);

319 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

320 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

321 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

323  
	gch¬aù”S‘
;

347 
public
 
	gLi¡
<
	gIÁeg”
> 
g’”©ePršbËCh¬aù”S‘
(

348 
fš®
 
¡¬tCodePošt
,

349 
fš®
 
Ï¡CodePošt
,

350 
fš®
 
S‘
<
IÁeg”
> 
ch¬aù”Ty³sF‹r
,

351 
fš®
 
boŞ—n
 
isF‹rAÎowabËLi¡
,

352 
fš®
 
S‘
<
IÁeg”
> 
®lowabËTy³s
) {

356 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 = 
Ãw
 
A¼ayLi¡
<
IÁeg”
>(
Ï¡CodePošt
);

358 
	gcodePošt
 = 
¡¬tCodePošt
; codePošˆ<ğ
Ï¡CodePošt
; ++codePoint) {

359 ià(
	g®lowabËTy³s
 !ğ
nuÎ
 &&

360 !
®lowabËTy³s
.
cÚšs
(
Ch¬aù”
.
g‘Ty³
(
codePošt
))) {

364 
fš®
 
	gty³
 = 
Ch¬aù”
.
g‘Ty³
(
codePošt
);

365 ià(
	gty³
 =ğ
Ch¬aù”
.
CONTROL
 ||

366 
ty³
 =ğ
Ch¬aù”
.
SURROGATE
 ||

367 
ty³
 =ğ
Ch¬aù”
.
FORMAT
 ||

368 
ty³
 =ğ
Ch¬aù”
.
PRIVATE_USE
 ||

369 
ty³
 =ğ
Ch¬aù”
.
UNASSIGNED
) {

374 ià(
	gch¬aù”Ty³sF‹r
 !ğ
nuÎ
) {

378 ià((
isF‹rAÎowabËLi¡
 && !
ch¬aù”Ty³sF‹r
.
cÚšs
(
codePošt
)) ||

379 (
ch¬aù”Ty³sF‹r
.
cÚšs
(
codePošt
))) {

384 
	gv®idCh¬aù”s
.
add
(
codePošt
);

386  
	gv®idCh¬aù”s
;

	@core/src/main/java/site/ycsb/generator/NumberGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

24 
public
 
ab¡¿ù
 
şass
 
Numb”G’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gNumb”
> {

25 
´iv©e
 
Numb”
 
	gÏ¡V®
;

31 
´Ùeùed
 
£tLa¡V®ue
(
Numb”
 
Ï¡
) {

32 
	gÏ¡V®
 = 
Ï¡
;

36 @
Ov”ride


37 
public
 
Numb”
 
Ï¡V®ue
() {

38  
	gÏ¡V®
;

44 
public
 
ab¡¿ù
 
m—n
();

	@core/src/main/java/site/ycsb/generator/RandomDiscreteTimestampGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

42 
public
 cÏs 
	cRªdomDisü‘eTime¡ampG’”©Ü
 
ex‹nds
 
	mUnixEpochTime¡ampG’”©Ü
 {

45 
public
 
fš®
 
	mMAX_INTERVALS
 = 16777216;

48 
´iv©e
 
fš®
 
	mš‹rv®s
;

52 
´iv©e
 
fš®
 
	mIÁeg”
[] 
	moff£ts
;

55 
´iv©e
 
	moff£tIndex
;

65 
public
 
	$RªdomDisü‘eTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
,

66 
fš®
 
š‹rv®s
) {

67 
	`su³r
(
š‹rv®
, 
timeUn™s
);

68 
this
.
š‹rv®s
 = intervals;

69 
off£ts
 = 
Ãw
 
IÁeg”
[
š‹rv®s
];

70 
	`£tup
();

86 
public
 
	$RªdomDisü‘eTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
,

87 
fš®
 
¡¬tTime¡amp
, fš® 
š‹rv®s
) {

88 
	`su³r
(
š‹rv®
, 
timeUn™s
, 
¡¬tTime¡amp
);

89 
this
.
š‹rv®s
 = intervals;

90 
off£ts
 = 
Ãw
 
IÁeg”
[
š‹rv®s
];

91 
	`£tup
();

92 
	}
}

97 
´iv©e
 
	$£tup
() {

98 ià(
š‹rv®s
 > 
MAX_INTERVALS
) {

99 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Too many intervals forhe in-memory "

100 + "¬¿y. Thlim™ i " + 
MAX_INTERVALS
 + ".");

102 
off£tIndex
 = 0;

103 
i
 = 0; i < 
š‹rv®s
; i++) {

104 
off£ts
[
i
] = i;

106 
Uts
.
	`shufæeA¼ay
(
off£ts
);

107 
	}
}

109 @
Ov”ride


110 
public
 
LÚg
 
	$ÃxtV®ue
() {

111 ià(
off£tIndex
 >ğ
off£ts
.
Ëngth
) {

112 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Reachedheƒnd ofhe„andomimestamp "

113 + "š‹rv®s: " + 
off£tIndex
);

115 
Ï¡Time¡amp
 = 
cu¼’tTime¡amp
;

116 
cu¼’tTime¡amp
 = 
¡¬tTime¡amp
 + (
off£ts
[
off£tIndex
++] * 
	`g‘Off£t
(1));

117  
cu¼’tTime¡amp
;

118 
	}
}

	@core/src/main/java/site/ycsb/generator/ScrambledZipfianGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

32 
public
 cÏs 
	cSüambËdZfŸnG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

33 
public
 
fš®
 
	mZETAN
 = 26.46902820178302;

34 
public
 
fš®
 
	mUSED_ZIPFIAN_CONSTANT
 = 0.99;

35 
public
 
fš®
 
	mITEM_COUNT
 = 10000000000L;

37 
´iv©e
 
ZfŸnG’”©Ü
 
	mg’
;

38 
´iv©e
 
fš®
 
	mmš
, 
	mmax
, 
	m™emcouÁ
;

47 
public
 
	$SüambËdZfŸnG’”©Ü
(
™ems
) {

48 
	`this
(0, 
™ems
 - 1);

57 
public
 
	$SüambËdZfŸnG’”©Ü
(
mš
, 
max
) {

58 
	`this
(
mš
, 
max
, 
ZfŸnG’”©Ü
.
ZIPFIAN_CONSTANT
);

59 
	}
}

84 
public
 
	$SüambËdZfŸnG’”©Ü
(
mš
, 
max
, 
zfŸncÚ¡ªt
) {

85 
this
.
mš
 = min;

86 
this
.
max
 = max;

87 
™emcouÁ
 = 
this
.
max
 -his.
mš
 + 1;

88 ià(
zfŸncÚ¡ªt
 =ğ
USED_ZIPFIAN_CONSTANT
) {

89 
g’
 = 
Ãw
 
	`ZfŸnG’”©Ü
(0, 
ITEM_COUNT
, 
zfŸncÚ¡ªt
, 
ZETAN
);

91 
g’
 = 
Ãw
 
	`ZfŸnG’”©Ü
(0, 
ITEM_COUNT
, 
zfŸncÚ¡ªt
);

93 
	}
}

100 @
Ov”ride


101 
public
 
LÚg
 
	$ÃxtV®ue
() {

102 
»t
 = 
g’
.
	`ÃxtV®ue
();

103 
»t
 = 
mš
 + 
Uts
.
	`âvhash64
Ô‘è% 
™emcouÁ
;

104 
	`£tLa¡V®ue
(
»t
);

105  
»t
;

106 
	}
}

108 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

109 
Ãwz‘ª
 = 
ZfŸnG’”©Ü
.
	`z‘a¡©ic
(
ITEM_COUNT
, ZfŸnG’”©Ü.
ZIPFIAN_CONSTANT
);

110 
Sy¡em
.
out
.
	`´šn
("z‘ª: " + 
Ãwz‘ª
);

111 
Sy¡em
.
	`ex™
(0);

113 
SüambËdZfŸnG’”©Ü
 
g’
 = 
Ãw
 
	`SüambËdZfŸnG’”©Ü
(10000);

115 
i
 = 0; i < 1000000; i++) {

116 
Sy¡em
.
out
.
	`´šn
("" + 
g’
.
	`ÃxtV®ue
());

118 
	}
}

123 @
Ov”ride


124 
public
 
	$m—n
() {

125  ((
mš
è+ 
max
) / 2.0;

126 
	}
}

	@core/src/main/java/site/ycsb/generator/SequentialGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

25 
public
 cÏs 
	cSequ’tŸlG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

26 
´iv©e
 
fš®
 
AtomicLÚg
 
	mcouÁ”
;

27 
´iv©e
 
	mš‹rv®
;

28 
´iv©e
 
	mcouÁ¡¬t
;

33 
public
 
	$Sequ’tŸlG’”©Ü
(
couÁ¡¬t
, 
couÁ’d
) {

34 
couÁ”
 = 
Ãw
 
	`AtomicLÚg
();

35 
	`£tLa¡V®ue
(
couÁ”
.
	`g‘
());

36 
this
.
couÁ¡¬t
 = countstart;

37 
š‹rv®
 = 
couÁ’d
 - 
couÁ¡¬t
 + 1;

44 
public
 
	$ÃxtLÚg
() {

45 
»t
 = 
couÁ¡¬t
 + 
couÁ”
.
	`g‘AndInüem’t
(è% 
š‹rv®
;

46 
	`£tLa¡V®ue
(
»t
);

47  
»t
;

48 
	}
}

50 @
Ov”ride


51 
public
 
Numb”
 
	$ÃxtV®ue
() {

52 
»t
 = 
couÁ¡¬t
 + 
couÁ”
.
	`g‘AndInüem’t
(è% 
š‹rv®
;

53 
	`£tLa¡V®ue
(
»t
);

54  
»t
;

55 
	}
}

57 @
Ov”ride


58 
public
 
Numb”
 
	$Ï¡V®ue
() {

59  
couÁ”
.
	`g‘
() + 1;

60 
	}
}

62 @
Ov”ride


63 
public
 
	$m—n
() {

64 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't compute mean of‚on-stationary distribution!");

65 
	}
}

	@core/src/main/java/site/ycsb/generator/SkewedLatestGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

23 
public
 cÏs 
	cSkewedL©e¡G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

24 
´iv©e
 
CouÁ”G’”©Ü
 
	mbasis
;

25 
´iv©e
 
fš®
 
ZfŸnG’”©Ü
 
	mzfŸn
;

27 
public
 
	$SkewedL©e¡G’”©Ü
(
CouÁ”G’”©Ü
 
basis
) {

28 
this
.
basis
 = basis;

29 
zfŸn
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
this
.
basis
.
	`Ï¡V®ue
());

30 
	`ÃxtV®ue
();

37 @
Ov”ride


38 
public
 
LÚg
 
	$ÃxtV®ue
() {

39 
max
 = 
basis
.
	`Ï¡V®ue
();

40 
Ãxt
 = 
max
 - 
zfŸn
.
	`ÃxtLÚg
(max);

41 
	`£tLa¡V®ue
(
Ãxt
);

42  
Ãxt
;

43 
	}
}

45 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

46 
SkewedL©e¡G’”©Ü
 
g’
 = 
Ãw
 
	`SkewedL©e¡G’”©Ü
Òew 
	`CouÁ”G’”©Ü
(1000));

47 
i
 = 0; i < 
IÁeg”
.
	`·r£IÁ
(
¬gs
[0]); i++) {

48 
Sy¡em
.
out
.
	`´šn
(
g’
.
	`ÃxtSŒšg
());

50 
	}
}

52 @
Ov”ride


53 
public
 
	$m—n
() {

54 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't compute mean of‚on-stationary distribution!");

55 
	}
}

	@core/src/main/java/site/ycsb/generator/UniformGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

27 
public
 
şass
 
UnifÜmG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

28 
´iv©e
 
fš®
 
	gLi¡
<
	gSŒšg
> 
	gv®ues
;

29 
´iv©e
 
SŒšg
 
	gÏ¡¡ršg
;

30 
´iv©e
 
fš®
 
UnifÜmLÚgG’”©Ü
 
	gg’
;

35 
public
 
UnifÜmG’”©Ü
(
CŞËùiÚ
<
SŒšg
> 
v®ues
) {

36 
	gthis
.
	gv®ues
 = 
Ãw
 
A¼ayLi¡
<>(
v®ues
);

37 
	gÏ¡¡ršg
 = 
nuÎ
;

38 
	gg’
 = 
Ãw
 
UnifÜmLÚgG’”©Ü
(0, 
v®ues
.
size
() - 1);

44 @
Ov”ride


45 
public
 
SŒšg
 
ÃxtV®ue
() {

46 
	gÏ¡¡ršg
 = 
v®ues
.
g‘
(
g’
.
ÃxtV®ue
().
štV®ue
());

47  
	gÏ¡¡ršg
;

55 @
Ov”ride


56 
public
 
SŒšg
 
Ï¡V®ue
() {

57 ià(
	gÏ¡¡ršg
 =ğ
nuÎ
) {

58 
ÃxtV®ue
();

60  
	gÏ¡¡ršg
;

	@core/src/main/java/site/ycsb/generator/UniformLongGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

25 
public
 cÏs 
	cUnifÜmLÚgG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

26 
´iv©e
 
fš®
 
	mlb
, 
	mub
, 
	mš‹rv®
;

36 
public
 
	$UnifÜmLÚgG’”©Ü
(
lb
, 
ub
) {

37 
this
.
lb
 =†b;

38 
this
.
ub
 = ub;

39 
š‹rv®
 = 
this
.
ub
 -his.
lb
 + 1;

42 @
Ov”ride


43 
public
 
LÚg
 
	$ÃxtV®ue
() {

44 
»t
 = 
M©h
.
	`abs
(
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtLÚg
()è% 
š‹rv®
 + 
lb
;

45 
	`£tLa¡V®ue
(
»t
);

47  
»t
;

48 
	}
}

50 @
Ov”ride


51 
public
 
	$m—n
() {

52  ((
lb
 + (è
ub
)) / 2.0;

53 
	}
}

	@core/src/main/java/site/ycsb/generator/UnixEpochTimestampGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

44 
public
 
şass
 
UnixEpochTime¡ampG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gLÚg
> {

47 
´Ùeùed
 
	g¡¬tTime¡amp
;

50 
´Ùeùed
 
	gcu¼’tTime¡amp
;

53 
´Ùeùed
 
	gÏ¡Time¡amp
;

56 
´Ùeùed
 
	gš‹rv®
;

59 
´Ùeùed
 
TimeUn™
 
	gtimeUn™s
;

64 
public
 
UnixEpochTime¡ampG’”©Ü
() {

65 
this
(60, 
TimeUn™
.
SECONDS
);

73 
public
 
UnixEpochTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
) {

74 
	gthis
.
	gš‹rv®
 = 
š‹rv®
;

75 
	gthis
.
	gtimeUn™s
 = 
timeUn™s
;

78 
š™®izeTime¡amp
(-1);

79 
	gcu¼’tTime¡amp
 -ğ
g‘Off£t
(1);

80 
	gÏ¡Time¡amp
 = 
cu¼’tTime¡amp
;

94 
public
 
UnixEpochTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
,

95 
fš®
 
¡¬tTime¡amp
) {

96 
	gthis
.
	gš‹rv®
 = 
š‹rv®
;

97 
	gthis
.
	gtimeUn™s
 = 
timeUn™s
;

100 
	gcu¼’tTime¡amp
 = 
¡¬tTime¡amp
 - 
g‘Off£t
(1);

101 
	gthis
.
	g¡¬tTime¡amp
 = 
cu¼’tTime¡amp
;

102 
	gÏ¡Time¡amp
 = 
cu¼’tTime¡amp
 - 
g‘Off£t
(1);

110 
public
 
š™®izeTime¡amp
(
fš®
 
š‹rv®Off£t
) {

111 
	gtimeUn™s
) {

112 
	gNANOSECONDS
:

113 
cu¼’tTime¡amp
 = 
Sy¡em
.
ÇnoTime
(è+ 
g‘Off£t
(
š‹rv®Off£t
);

115 
	gMICROSECONDS
:

116 
cu¼’tTime¡amp
 = (
Sy¡em
.
ÇnoTime
(è/ 1000è+ 
g‘Off£t
(
š‹rv®Off£t
);

118 
	gMILLISECONDS
:

119 
cu¼’tTime¡amp
 = 
Sy¡em
.
cu¼’tTimeMlis
(è+ 
g‘Off£t
(
š‹rv®Off£t
);

121 
	gSECONDS
:

122 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

123 
g‘Off£t
(
š‹rv®Off£t
);

125 
	gMINUTES
:

126 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

127 
g‘Off£t
(
š‹rv®Off£t
);

129 
	gHOURS
:

130 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

131 
g‘Off£t
(
š‹rv®Off£t
);

133 
	gDAYS
:

134 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

135 
g‘Off£t
(
š‹rv®Off£t
);

138 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("UnhªdËdimun™y³: " + 
timeUn™s
);

140 
	g¡¬tTime¡amp
 = 
cu¼’tTime¡amp
;

143 @
Ov”ride


144 
public
 
LÚg
 
ÃxtV®ue
() {

145 
	gÏ¡Time¡amp
 = 
cu¼’tTime¡amp
;

146 
	gcu¼’tTime¡amp
 +ğ
g‘Off£t
(1);

147  
	gcu¼’tTime¡amp
;

155 
public
 
g‘Off£t
(
fš®
 
š‹rv®Off£t
) {

156 
	gtimeUn™s
) {

157 
	gNANOSECONDS
:

158 
MICROSECONDS
:

159 
MILLISECONDS
:

160 
SECONDS
:

161  
š‹rv®Off£t
 * 
š‹rv®
;

162 
	gMINUTES
:

163  
š‹rv®Off£t
 * 
š‹rv®
 * () 60;

164 
	gHOURS
:

165  
š‹rv®Off£t
 * 
š‹rv®
 * () (60 * 60);

166 
	gDAYS
:

167  
š‹rv®Off£t
 * 
š‹rv®
 * () (60 * 60 * 24);

169 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("UnhªdËdimun™y³: " + 
timeUn™s
);

173 @
Ov”ride


174 
public
 
LÚg
 
Ï¡V®ue
() {

175  
	gÏ¡Time¡amp
;

179 
public
 
cu¼’tV®ue
() {

180  
	gcu¼’tTime¡amp
;

	@core/src/main/java/site/ycsb/generator/ZipfianGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

42 
public
 cÏs 
	cZfŸnG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

43 
public
 
fš®
 
	mZIPFIAN_CONSTANT
 = 0.99;

48 
´iv©e
 
fš®
 
	m™ems
;

53 
´iv©e
 
fš®
 
	mba£
;

58 
´iv©e
 
fš®
 
	mzfŸncÚ¡ªt
;

63 
´iv©e
 
	m®pha
, 
	mz‘ª
, 
	m‘a
, 
	mth‘a
, 
	mz‘a2th‘a
;

68 
´iv©e
 
	mcouÁfÜz‘a
;

82 
´iv©e
 
boŞ—n
 
	m®low™emcouÁdeü—£
 = 
çl£
;

90 
public
 
	$ZfŸnG’”©Ü
(
™ems
) {

91 
	`this
(0, 
™ems
 - 1);

99 
public
 
	$ZfŸnG’”©Ü
(
mš
, 
max
) {

100 
	`this
(
mš
, 
max
, 
ZIPFIAN_CONSTANT
);

101 
	}
}

109 
public
 
	$ZfŸnG’”©Ü
(
™ems
, 
zfŸncÚ¡ªt
) {

110 
	`this
(0, 
™ems
 - 1, 
zfŸncÚ¡ªt
);

111 
	}
}

119 
public
 
	$ZfŸnG’”©Ü
(
mš
, 
max
, 
zfŸncÚ¡ªt
) {

120 
	`this
(
mš
, 
max
, 
zfŸncÚ¡ªt
, 
	`z‘a¡©ic
(max - min + 1, zipfianconstant));

121 
	}
}

132 
public
 
	$ZfŸnG’”©Ü
(
mš
, 
max
, 
zfŸncÚ¡ªt
, 
z‘ª
) {

134 
™ems
 = 
max
 - 
mš
 + 1;

135 
ba£
 = 
mš
;

136 
this
.
zfŸncÚ¡ªt
 = zipfianconstant;

138 
th‘a
 = 
this
.
zfŸncÚ¡ªt
;

140 
z‘a2th‘a
 = 
	`z‘a
(2, 
th‘a
);

142 
®pha
 = 1.0 / (1.0 - 
th‘a
);

143 
this
.
z‘ª
 = zetan;

144 
couÁfÜz‘a
 = 
™ems
;

145 
‘a
 = (1 - 
M©h
.
	`pow
(2.0 / 
™ems
, 1 - 
th‘a
)è/ (1 - 
z‘a2th‘a
 / 
this
.
z‘ª
);

147 
	`ÃxtV®ue
();

148 
	}
}

159 
	$z‘a
(
n
, 
th‘aV®
) {

160 
couÁfÜz‘a
 = 
n
;

161  
	`z‘a¡©ic
(
n
, 
th‘aV®
);

162 
	}
}

170 
	$z‘a¡©ic
(
n
, 
th‘a
) {

171  
	`z‘a¡©ic
(0, 
n
, 
th‘a
, 0);

172 
	}
}

184 
	$z‘a
(
¡
, 
n
, 
th‘aV®
, 
š™Ÿlsum
) {

185 
couÁfÜz‘a
 = 
n
;

186  
	`z‘a¡©ic
(
¡
, 
n
, 
th‘aV®
, 
š™Ÿlsum
);

187 
	}
}

198 
	$z‘a¡©ic
(
¡
, 
n
, 
th‘a
, 
š™Ÿlsum
) {

199 
sum
 = 
š™Ÿlsum
;

200 
i
 = 
¡
; i < 
n
; i++) {

202 
sum
 +ğ1 / (
M©h
.
	`pow
(
i
 + 1, 
th‘a
));

207  
sum
;

208 
	}
}

219 
	$ÃxtLÚg
(
™emcouÁ
) {

222 ià(
™emcouÁ
 !ğ
couÁfÜz‘a
) {

225 
	`synchrÚized
 (
this
) {

226 ià(
™emcouÁ
 > 
couÁfÜz‘a
) {

231 
z‘ª
 = 
	`z‘a
(
couÁfÜz‘a
, 
™emcouÁ
, 
th‘a
, zetan);

232 
‘a
 = (1 - 
M©h
.
	`pow
(2.0 / 
™ems
, 1 - 
th‘a
)è/ (1 - 
z‘a2th‘a
 / 
z‘ª
);

233 } ià((
™emcouÁ
 < 
couÁfÜz‘a
è&& (
®low™emcouÁdeü—£
)) {

241 
Sy¡em
.
”r
.
	`´šn
("WARNING: Recomputing Zipfian distribtion. This is slow‡nd should be‡voided. " +

242 "(™emcouÁ=" + 
™emcouÁ
 + " couÁfÜz‘a=" + 
couÁfÜz‘a
 + ")");

244 
z‘ª
 = 
	`z‘a
(
™emcouÁ
, 
th‘a
);

245 
‘a
 = (1 - 
M©h
.
	`pow
(2.0 / 
™ems
, 1 - 
th‘a
)è/ (1 - 
z‘a2th‘a
 / 
z‘ª
);

250 
u
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtDoubË
();

251 
uz
 = 
u
 * 
z‘ª
;

253 ià(
uz
 < 1.0) {

254  
ba£
;

257 ià(
uz
 < 1.0 + 
M©h
.
	`pow
(0.5, 
th‘a
)) {

258  
ba£
 + 1;

261 
»t
 = 
ba£
 + (è((
™emcouÁ
è* 
M©h
.
	`pow
(
‘a
 * 
u
 -ƒ + 1, 
®pha
));

262 
	`£tLa¡V®ue
(
»t
);

263  
»t
;

264 
	}
}

272 @
Ov”ride


273 
public
 
LÚg
 
	$ÃxtV®ue
() {

274  
	`ÃxtLÚg
(
™ems
);

275 
	}
}

277 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

278 
Ãw
 
	`ZfŸnG’”©Ü
(
SüambËdZfŸnG’”©Ü
.
ITEM_COUNT
);

279 
	}
}

284 @
Ov”ride


285 
public
 
	$m—n
() {

286 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("@todo implement ZipfianGenerator.mean()");

287 
	}
}

	@core/src/main/java/site/ycsb/generator/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

	@core/src/main/java/site/ycsb/measurements/Measurements.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

30 
public
 cÏs 
	cM—su»m’ts
 {

34 
public
 
	eM—su»m’tTy³
 {

35 
	mHISTOGRAM
,

36 
	mHDRHISTOGRAM
,

37 
	mHDRHISTOGRAM_AND_HISTOGRAM
,

38 
	mHDRHISTOGRAM_AND_RAW
,

39 
	mTIMESERIES
,

40 
	mRAW


43 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_TYPE_PROPERTY
 = "measurementtype";

44 
´iv©e
 
fš®
 
SŒšg
 
	gMEASUREMENT_TYPE_PROPERTY_DEFAULT
 = "hdrhistogram";

46 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_INTERVAL
 = "measurement.interval";

47 
´iv©e
 
fš®
 
SŒšg
 
	gMEASUREMENT_INTERVAL_DEFAULT
 = "op";

49 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_TRACK_JVM_PROPERTY
 = "measurement.trackjvm";

50 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_TRACK_JVM_PROPERTY_DEFAULT
 = "false";

52 
´iv©e
 
M—su»m’ts
 
	gsšgËtÚ
 = 
nuÎ
;

53 
´iv©e
 
Prİ”t›s
 
	gm—su»m’rİ”t›s
 = 
nuÎ
;

55 
public
 
	$£tPrİ”t›s
(
Prİ”t›s
 
´İs
) {

56 
m—su»m’rİ”t›s
 = 
´İs
;

57 
	}
}

62 
public
 
synchrÚized
 
M—su»m’ts
 
	$g‘M—su»m’ts
() {

63 ià(
sšgËtÚ
 =ğ
nuÎ
) {

64 
sšgËtÚ
 = 
Ãw
 
	`M—su»m’ts
(
m—su»m’rİ”t›s
);

66  
sšgËtÚ
;

67 
	}
}

69 
´iv©e
 
fš®
 
	gCÚcu¼’tHashM­
<
	gSŒšg
, 
	gOÃM—su»m’t
> 
	gİToMesu»m’tM­
;

70 
´iv©e
 
fš®
 
	gCÚcu¼’tHashM­
<
	gSŒšg
, 
	gOÃM—su»m’t
> 
	gİToIÁ’dedMesu»m’tM­
;

71 
´iv©e
 
fš®
 
M—su»m’tTy³
 
	gm—su»m’tTy³
;

72 
´iv©e
 
fš®
 
	gm—su»m’tIÁ”v®
;

73 
´iv©e
 
fš®
 
Prİ”t›s
 
	g´İs
;

78 
public
 
	$M—su»m’ts
(
Prİ”t›s
 
´İs
) {

79 
İToMesu»m’tM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

80 
İToIÁ’dedMesu»m’tM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

82 
this
.
´İs
 =…rops;

84 
SŒšg
 
mTy³SŒšg
 = 
this
.
´İs
.
	`g‘Prİ”ty
(
MEASUREMENT_TYPE_PROPERTY
, 
MEASUREMENT_TYPE_PROPERTY_DEFAULT
);

85 
mTy³SŒšg
) {

87 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HISTOGRAM
;

90 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HDRHISTOGRAM
;

93 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HDRHISTOGRAM_AND_HISTOGRAM
;

96 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HDRHISTOGRAM_AND_RAW
;

99 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
TIMESERIES
;

102 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
RAW
;

105 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("unknowÀ" + 
MEASUREMENT_TYPE_PROPERTY
 + "=" + 
mTy³SŒšg
);

108 
SŒšg
 
mIÁ”v®SŒšg
 = 
this
.
´İs
.
	`g‘Prİ”ty
(
MEASUREMENT_INTERVAL
, 
MEASUREMENT_INTERVAL_DEFAULT
);

109 
mIÁ”v®SŒšg
) {

111 
m—su»m’tIÁ”v®
 = 0;

114 
m—su»m’tIÁ”v®
 = 1;

117 
m—su»m’tIÁ”v®
 = 2;

120 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("unknowÀ" + 
MEASUREMENT_INTERVAL
 + "=" + 
mIÁ”v®SŒšg
);

122 
	}
}

124 
´iv©e
 
OÃM—su»m’t
 
	$cÚ¡ruùOÃM—su»m’t
(
SŒšg
 
Çme
) {

125 
m—su»m’tTy³
) {

126 
HISTOGRAM
:

127  
Ãw
 
	`OÃM—su»m’tHi¡og¿m
(
Çme
, 
´İs
);

128 
HDRHISTOGRAM
:

129  
Ãw
 
	`OÃM—su»m’tHdrHi¡og¿m
(
Çme
, 
´İs
);

130 
HDRHISTOGRAM_AND_HISTOGRAM
:

131  
Ãw
 
	`TwoInOÃM—su»m’t
(
Çme
,

132 
Ãw
 
	`OÃM—su»m’tHdrHi¡og¿m
("Hdr" + 
Çme
, 
´İs
),

133 
Ãw
 
	`OÃM—su»m’tHi¡og¿m
("Buck‘" + 
Çme
, 
´İs
));

134 
HDRHISTOGRAM_AND_RAW
:

135  
Ãw
 
	`TwoInOÃM—su»m’t
(
Çme
,

136 
Ãw
 
	`OÃM—su»m’tHdrHi¡og¿m
("Hdr" + 
Çme
, 
´İs
),

137 
Ãw
 
	`OÃM—su»m’tRaw
("Raw" + 
Çme
, 
´İs
));

138 
TIMESERIES
:

139  
Ãw
 
	`OÃM—su»m’tTimeS”›s
(
Çme
, 
´İs
);

140 
RAW
:

141  
Ãw
 
	`OÃM—su»m’tRaw
(
Çme
, 
´İs
);

143 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("Impossibleo be here. Dead code„eached. Bugs?");

145 
	}
}

147 şas 
	cS¹TimeHŞd”
 {

148 
´Ùeùed
 
	gtime
;

150 
¡¬tTime
() {

151 ià(
	gtime
 == 0) {

152  
Sy¡em
.
ÇnoTime
();

154  
	gtime
;

159 
´iv©e
 
fš®
 
	gTh»adLoÿl
<
	gS¹TimeHŞd”
> 
	gIÁ’dedS¹Time
 = 
Ãw
 
Th»adLoÿl
<
M—su»m’ts
.
S¹TimeHŞd”
>() {

160 
´Ùeùed
 
S¹TimeHŞd”
 
š™ŸlV®ue
() {

161  
Ãw
 
S¹TimeHŞd”
();

165 
public
 
	$£tIÁ’dedS¹TimeNs
(
time
) {

166 ià(
m—su»m’tIÁ”v®
 == 0) {

169 
IÁ’dedS¹Time
.
	`g‘
().
time
 =ime;

170 
	}
}

172 
public
 
	$g‘IÁ’dedS¹TimeNs
() {

173 ià(
m—su»m’tIÁ”v®
 == 0) {

176  
IÁ’dedS¹Time
.
	`g‘
().
	`¡¬tTime
();

177 
	}
}

183 
public
 
	$m—su»
(
SŒšg
 
İ”©iÚ
, 
Ï‹ncy
) {

184 ià(
m—su»m’tIÁ”v®
 == 1) {

187 
Œy
 {

188 
OÃM—su»m’t
 
m
 = 
	`g‘OpM—su»m’t
(
İ”©iÚ
);

189 
m
.
	`m—su»
(
Ï‹ncy
);

190 } 
	`ÿtch
 (
java
.
Ïng
.
A¼ayIndexOutOfBoundsExû±iÚ
 
e
) {

192 
Sy¡em
.
out
.
	`´šn
("ERROR: java.lang.ArrayIndexOutOfBoundsException - ignoring‡nd continuing");

193 
e
.
	`´štSckT¿û
();

194 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

196 
	}
}

202 
public
 
	$m—su»IÁ’ded
(
SŒšg
 
İ”©iÚ
, 
Ï‹ncy
) {

203 ià(
m—su»m’tIÁ”v®
 == 0) {

206 
Œy
 {

207 
OÃM—su»m’t
 
m
 = 
	`g‘OpIÁ’dedM—su»m’t
(
İ”©iÚ
);

208 
m
.
	`m—su»
(
Ï‹ncy
);

209 } 
	`ÿtch
 (
java
.
Ïng
.
A¼ayIndexOutOfBoundsExû±iÚ
 
e
) {

211 
Sy¡em
.
out
.
	`´šn
("ERROR: java.lang.ArrayIndexOutOfBoundsException - ignoring‡nd continuing");

212 
e
.
	`´štSckT¿û
();

213 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

215 
	}
}

217 
´iv©e
 
OÃM—su»m’t
 
	$g‘OpM—su»m’t
(
SŒšg
 
İ”©iÚ
) {

218 
OÃM—su»m’t
 
m
 = 
İToMesu»m’tM­
.
	`g‘
(
İ”©iÚ
);

219 ià(
m
 =ğ
nuÎ
) {

220 
m
 = 
	`cÚ¡ruùOÃM—su»m’t
(
İ”©iÚ
);

221 
OÃM—su»m’t
 
ŞdM
 = 
İToMesu»m’tM­
.
	`putIfAb£Á
(
İ”©iÚ
, 
m
);

222 ià(
ŞdM
 !ğ
nuÎ
) {

223 
m
 = 
ŞdM
;

226  
m
;

227 
	}
}

229 
´iv©e
 
OÃM—su»m’t
 
	$g‘OpIÁ’dedM—su»m’t
(
SŒšg
 
İ”©iÚ
) {

230 
OÃM—su»m’t
 
m
 = 
İToIÁ’dedMesu»m’tM­
.
	`g‘
(
İ”©iÚ
);

231 ià(
m
 =ğ
nuÎ
) {

232 
fš®
 
SŒšg
 
Çme
 = 
m—su»m’tIÁ”v®
 =ğ1 ? 
İ”©iÚ
 : "Intended-" + operation;

233 
m
 = 
	`cÚ¡ruùOÃM—su»m’t
(
Çme
);

234 
OÃM—su»m’t
 
ŞdM
 = 
İToIÁ’dedMesu»m’tM­
.
	`putIfAb£Á
(
İ”©iÚ
, 
m
);

235 ià(
ŞdM
 !ğ
nuÎ
) {

236 
m
 = 
ŞdM
;

239  
m
;

240 
	}
}

245 
public
 
	$»pÜtStus
(
fš®
 
SŒšg
 
İ”©iÚ
, fš® 
Stus
 
¡©us
) {

246 
OÃM—su»m’t
 
m
 = 
m—su»m’tIÁ”v®
 == 1 ?

247 
	`g‘OpIÁ’dedM—su»m’t
(
İ”©iÚ
) :

248 
	`g‘OpM—su»m’t
(
İ”©iÚ
);

249 
m
.
	`»pÜtStus
(
¡©us
);

250 
	}
}

258 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

259 
OÃM—su»m’t
 
m—su»m’t
 : 
İToMesu»m’tM­
.
	`v®ues
()) {

260 
m—su»m’t
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

262 
OÃM—su»m’t
 
m—su»m’t
 : 
İToIÁ’dedMesu»m’tM­
.
	`v®ues
()) {

263 
m—su»m’t
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

265 
	}
}

270 
public
 
synchrÚized
 
SŒšg
 
	$g‘Summ¬y
() {

271 
SŒšg
 
»t
 = "";

272 
OÃM—su»m’t
 
m
 : 
İToMesu»m’tM­
.
	`v®ues
()) {

273 
»t
 +ğ
m
.
	`g‘Summ¬y
() + " ";

275 
OÃM—su»m’t
 
m
 : 
İToIÁ’dedMesu»m’tM­
.
	`v®ues
()) {

276 
»t
 +ğ
m
.
	`g‘Summ¬y
() + " ";

278  
»t
;

279 
	}
}

	@core/src/main/java/site/ycsb/measurements/OneMeasurement.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

31 
public
 
ab¡¿ù
 cÏs 
	cOÃM—su»m’t
 {

33 
´iv©e
 
fš®
 
SŒšg
 
	mÇme
;

34 
´iv©e
 
fš®
 
	mCÚcu¼’tHashM­
<
	mStus
, 
	mAtomicIÁeg”
> 
	m»tuºcodes
;

36 
public
 
SŒšg
 
	$g‘Name
() {

37  
Çme
;

43 
public
 
	$OÃM—su»m’t
(
SŒšg
 
Çme
) {

44 
this
.
Çme
 =‚ame;

45 
this
.
»tuºcodes
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

46 
	}
}

48 
public
 
ab¡¿ù
 
m—su»
(
Ï‹ncy
);

50 
public
 
ab¡¿ù
 
SŒšg
 
g‘Summ¬y
();

55 
public
 
	$»pÜtStus
(
Stus
 
¡©us
) {

56 
AtomicIÁeg”
 
couÁ”
 = 
»tuºcodes
.
	`g‘
(
¡©us
);

58 ià(
couÁ”
 =ğ
nuÎ
) {

59 
couÁ”
 = 
Ãw
 
	`AtomicIÁeg”
();

60 
AtomicIÁeg”
 
Ùh”
 = 
»tuºcodes
.
	`putIfAb£Á
(
¡©us
, 
couÁ”
);

61 ià(
Ùh”
 !ğ
nuÎ
) {

62 
couÁ”
 = 
Ùh”
;

66 
couÁ”
.
	`šüem’tAndG‘
();

67 
	}
}

75 
public
 
ab¡¿ù
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
;

77 
´Ùeùed
 
fš®
 
	$expÜtStusCouÁs
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

78 
M­
.
EÁry
<
Stus
, 
AtomicIÁeg”
> 
’Œy
 : 
»tuºcodes
.
	`’ŒyS‘
()) {

79 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "R‘uº=" + 
’Œy
.
	`g‘Key
().g‘Name(),ƒÁry.
	`g‘V®ue
().
	`g‘
());

81 
	}
}

	@core/src/main/java/site/ycsb/measurements/OneMeasurementHdrHistogram.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

21 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gHi¡og¿m
;

22 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gHi¡og¿mI‹¿tiÚV®ue
;

23 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gHi¡og¿mLogWr™”
;

24 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gRecÜd”
;

26 
impÜt
 
	gjava
.
	gio
.
	gFeNÙFoundExû±iÚ
;

27 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

28 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

29 
impÜt
 
	gjava
.
	gio
.
	gPrštSŒ—m
;

30 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

31 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

32 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

33 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

39 
public
 cÏs 
	cOÃM—su»m’tHdrHi¡og¿m
 
ex‹nds
 
	mOÃM—su»m’t
 {

42 
´iv©e
 
fš®
 
PrštSŒ—m
 
	mlog
;

43 
´iv©e
 
fš®
 
Hi¡og¿mLogWr™”
 
	mhi¡og¿mLogWr™”
;

45 
´iv©e
 
fš®
 
RecÜd”
 
	mhi¡og¿m
;

46 
´iv©e
 
Hi¡og¿m
 
	mtÙ®Hi¡og¿m
;

51 
public
 
fš®
 
SŒšg
 
	mPERCENTILES_PROPERTY
 = "hdrhistogram.percentiles";

56 
public
 
fš®
 
SŒšg
 
	mPERCENTILES_PROPERTY_DEFAULT
 = "95,99";

61 
public
 
fš®
 
SŒšg
 
	mVERBOSE_PROPERTY
 = "measurement.histogram.verbose";

66 
´iv©e
 
fš®
 
boŞ—n
 
	mv”bo£
;

68 
´iv©e
 
fš®
 
	mLi¡
<
	mDoubË
> 
	m³rûÁes
;

70 
public
 
	$OÃM—su»m’tHdrHi¡og¿m
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

71 
	`su³r
(
Çme
);

72 
³rûÁes
 = 
	`g‘P”ûÁeV®ues
(
´İs
.
	`g‘Prİ”ty
(
PERCENTILES_PROPERTY
, 
PERCENTILES_PROPERTY_DEFAULT
));

73 
v”bo£
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
VERBOSE_PROPERTY
, 
SŒšg
.v®ueOf(
çl£
)));

74 
boŞ—n
 
shouldLog
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("hdrhistogram.fileoutput", "false"));

75 ià(!
shouldLog
) {

76 
log
 = 
nuÎ
;

77 
hi¡og¿mLogWr™”
 = 
nuÎ
;

79 
Œy
 {

80 
fš®
 
SŒšg
 
hdrOuutF’ame
 = 
´İs
.
	`g‘Prİ”ty
("hdrhi¡og¿m.ouut.·th", ""è+ 
Çme
 + ".hdr";

81 
log
 = 
Ãw
 
	`PrštSŒ—m
Òew 
	`FeOuutSŒ—m
(
hdrOuutF’ame
), 
çl£
);

82 } 
	`ÿtch
 (
FeNÙFoundExû±iÚ
 
e
) {

83 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("FaedØİ’ hd¸hi¡og¿m ouuˆfe", 
e
);

85 
hi¡og¿mLogWr™”
 = 
Ãw
 
	`Hi¡og¿mLogWr™”
(
log
);

86 
hi¡og¿mLogWr™”
.
	`ouutComm’t
("[Loggšg fÜ: " + 
Çme
 + "]");

87 
hi¡og¿mLogWr™”
.
	`ouutLogFÜm©V”siÚ
();

88 
now
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

89 
hi¡og¿mLogWr™”
.
	`ouutS¹Time
(
now
);

90 
hi¡og¿mLogWr™”
.
	`£tBa£Time
(
now
);

91 
hi¡og¿mLogWr™”
.
	`ouutLeg’d
();

93 
hi¡og¿m
 = 
Ãw
 
	`RecÜd”
(3);

100 
public
 
	$m—su»
(
Ï‹ncyInMiüos
) {

101 
hi¡og¿m
.
	`»cÜdV®ue
(
Ï‹ncyInMiüos
);

102 
	}
}

107 @
Ov”ride


108 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

110 
Hi¡og¿m
 
š‹rv®Hi¡og¿m
 = 
	`g‘IÁ”v®Hi¡og¿mAndAccumuÏ‹
();

111 ià(
hi¡og¿mLogWr™”
 !ğ
nuÎ
) {

112 
hi¡og¿mLogWr™”
.
	`ouutIÁ”v®Hi¡og¿m
(
š‹rv®Hi¡og¿m
);

114 
log
.
	`şo£
();

116 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "O³¿tiÚs", 
tÙ®Hi¡og¿m
.
	`g‘TÙ®CouÁ
());

117 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Av”ageL©’cy(us)", 
tÙ®Hi¡og¿m
.
	`g‘M—n
());

118 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MšL©’cy(us)", 
tÙ®Hi¡og¿m
.
	`g‘MšV®ue
());

119 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MaxL©’cy(us)", 
tÙ®Hi¡og¿m
.
	`g‘MaxV®ue
());

121 
DoubË
 
³rûÁe
 : 
³rûÁes
) {

122 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
	`Üdš®
(
³rûÁe
) + "PercentileLatency(us)",

123 
tÙ®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(
³rûÁe
));

126 
	`expÜtStusCouÁs
(
expÜ‹r
);

129 ià(
v”bo£
) {

130 
Hi¡og¿mI‹¿tiÚV®ue
 
v
 : 
tÙ®Hi¡og¿m
.
	`»cÜdedV®ues
()) {

131 
v®ue
;

132 ià(
v
.
	`g‘V®ueI‹¿‹dTo
(è> ()
IÁeg”
.
MAX_VALUE
) {

133 
v®ue
 = 
IÁeg”
.
MAX_VALUE
;

135 
v®ue
 = ()
v
.
	`g‘V®ueI‹¿‹dTo
();

138 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
IÁeg”
.
	`toSŒšg
(
v®ue
), ()
v
.
	`g‘CouÁAtV®ueI‹¿‹dTo
());

141 
	}
}

150 @
Ov”ride


151 
public
 
SŒšg
 
	$g‘Summ¬y
() {

152 
Hi¡og¿m
 
š‹rv®Hi¡og¿m
 = 
	`g‘IÁ”v®Hi¡og¿mAndAccumuÏ‹
();

154 ià(
hi¡og¿mLogWr™”
 !ğ
nuÎ
) {

155 
hi¡og¿mLogWr™”
.
	`ouutIÁ”v®Hi¡og¿m
(
š‹rv®Hi¡og¿m
);

158 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

159  "[" + 
	`g‘Name
(è+ ": CouÁ=" + 
š‹rv®Hi¡og¿m
.
	`g‘TÙ®CouÁ
() + ", Max="

160 + 
š‹rv®Hi¡og¿m
.
	`g‘MaxV®ue
(è+ ", Mš=" + iÁ”v®Hi¡og¿m.
	`g‘MšV®ue
() + ", Avg="

161 + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘M—n
()è+ ", 90=" + d.fÜm©(š‹rv®Hi¡og¿m.
	`g‘V®ueAtP”ûÁe
(90))

162 + ", 99=" + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(99)) + ", 99.9="

163 + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(99.9)) + ", 99.99="

164 + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(99.99)) + "]";

165 
	}
}

167 
´iv©e
 
Hi¡og¿m
 
	$g‘IÁ”v®Hi¡og¿mAndAccumuÏ‹
() {

168 
Hi¡og¿m
 
š‹rv®Hi¡og¿m
 = 
hi¡og¿m
.
	`g‘IÁ”v®Hi¡og¿m
();

170 ià(
tÙ®Hi¡og¿m
 =ğ
nuÎ
) {

171 
tÙ®Hi¡og¿m
 = 
š‹rv®Hi¡og¿m
;

173 
tÙ®Hi¡og¿m
.
	`add
(
š‹rv®Hi¡og¿m
);

175  
š‹rv®Hi¡og¿m
;

176 
	}
}

184 
´iv©e
 
	gLi¡
<
	gDoubË
> 
	$g‘P”ûÁeV®ues
(
SŒšg
 
³rûÁeSŒšg
) {

185 
Li¡
<
DoubË
> 
³rûÁeV®ues
 = 
Ãw
 
A¼ayLi¡
<>();

187 
Œy
 {

188 
SŒšg
 
¿wP”ûÁe
 : 
³rûÁeSŒšg
.
	`¥l™
(",")) {

189 
³rûÁeV®ues
.
	`add
(
DoubË
.
	`·r£DoubË
(
¿wP”ûÁe
));

191 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

194 
Sy¡em
.
”r
.
	`´šn
("[WARN] Couldn'ˆ»ad " + 
PERCENTILES_PROPERTY
 + " v®ue: '" + 
³rûÁeSŒšg
 +

195 "',hdeçuÉ oà'" + 
PERCENTILES_PROPERTY_DEFAULT
 + "' will be used.");

196 
e
.
	`´štSckT¿û
();

197  
	`g‘P”ûÁeV®ues
(
PERCENTILES_PROPERTY_DEFAULT
);

200  
³rûÁeV®ues
;

201 
	}
}

208 
´iv©e
 
SŒšg
 
	$Üdš®
(
DoubË
 
i
) {

209 
SŒšg
[] 
suffixes
 = 
Ãw
 String[]{"th", "st", "nd", "rd", "th", "th", "th", "th", "th", "th"};

210 
IÁeg”
 
j
 = 
i
.
	`štV®ue
();

211 ià(
i
 % 1 == 0) {

212 
j
 % 100) {

216  
j
 + "th";

218  
j
 + 
suffixes
[j % 10];

221  
i
.
	`toSŒšg
();

223 
	}
}

	@core/src/main/java/site/ycsb/measurements/OneMeasurementHistogram.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

30 
public
 cÏs 
	cOÃM—su»m’tHi¡og¿m
 
ex‹nds
 
	mOÃM—su»m’t
 {

31 
public
 
fš®
 
SŒšg
 
	mBUCKETS
 = "histogram.buckets";

32 
public
 
fš®
 
SŒšg
 
	mBUCKETS_DEFAULT
 = "1000";

33 
public
 
fš®
 
SŒšg
 
	mVERBOSE_PROPERTY
 = "measurement.histogram.verbose";

38 
´iv©e
 
fš®
 
	mbuck‘s
;

43 
´iv©e
 [] 
	mhi¡og¿m
;

48 
´iv©e
 
	mhi¡og¿mov”æow
;

53 
´iv©e
 
	mİ”©iÚs
;

59 
´iv©e
 
	mtÙ®Ï‹ncy
;

66 
´iv©e
 
	mtÙ®squ¬edÏ‹ncy
;

71 
´iv©e
 
fš®
 
boŞ—n
 
	mv”bo£
;

74 
´iv©e
 
	mwšdowİ”©iÚs
;

75 
´iv©e
 
	mwšdowtÙ®Ï‹ncy
;

77 
´iv©e
 
	mmš
;

78 
´iv©e
 
	mmax
;

80 
public
 
	$OÃM—su»m’tHi¡og¿m
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

81 
	`su³r
(
Çme
);

82 
buck‘s
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
BUCKETS
, 
BUCKETS_DEFAULT
));

83 
v”bo£
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
VERBOSE_PROPERTY
, 
SŒšg
.v®ueOf(
çl£
)));

84 
hi¡og¿m
 = 
Ãw
 [
buck‘s
];

85 
hi¡og¿mov”æow
 = 0;

86 
İ”©iÚs
 = 0;

87 
tÙ®Ï‹ncy
 = 0;

88 
tÙ®squ¬edÏ‹ncy
 = 0;

89 
wšdowİ”©iÚs
 = 0;

90 
wšdowtÙ®Ï‹ncy
 = 0;

91 
mš
 = -1;

92 
max
 = -1;

98 
public
 
synchrÚized
 
	$m—su»
(
Ï‹ncy
) {

100 ià(
Ï‹ncy
 / 1000 >ğ
buck‘s
) {

101 
hi¡og¿mov”æow
++;

103 
hi¡og¿m
[
Ï‹ncy
 / 1000]++;

105 
İ”©iÚs
++;

106 
tÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

107 
tÙ®squ¬edÏ‹ncy
 +ğ((è
Ï‹ncy
) * (()†atency);

108 
wšdowİ”©iÚs
++;

109 
wšdowtÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

111 ià((
mš
 < 0è|| (
Ï‹ncy
 < min)) {

112 
mš
 = 
Ï‹ncy
;

115 ià((
max
 < 0è|| (
Ï‹ncy
 > max)) {

116 
max
 = 
Ï‹ncy
;

118 
	}
}

120 @
Ov”ride


121 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

122 
m—n
 = 
tÙ®Ï‹ncy
 / ((è
İ”©iÚs
);

123 
v¬Ÿnû
 = 
tÙ®squ¬edÏ‹ncy
 / ((è
İ”©iÚs
è- (
m—n
 * mean);

124 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "O³¿tiÚs", 
İ”©iÚs
);

125 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Av”ageL©’cy(us)", 
m—n
);

126 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "L©’cyV¬Ÿnû(us)", 
v¬Ÿnû
);

127 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MšL©’cy(us)", 
mš
);

128 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MaxL©’cy(us)", 
max
);

130 
İcouÁ”
=0;

131 
boŞ—n
 
dÚe95th
 = 
çl£
;

132 
i
 = 0; i < 
buck‘s
; i++) {

133 
İcouÁ”
 +ğ
hi¡og¿m
[
i
];

134 ià((!
dÚe95th
è&& (((è
İcouÁ”
è/ ((è
İ”©iÚs
) >= 0.95)) {

135 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "95thP”ûÁeL©’cy(us)", 
i
 * 1000);

136 
dÚe95th
 = 
Œue
;

138 ià(((è
İcouÁ”
è/ ((è
İ”©iÚs
) >= 0.99) {

139 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "99thP”ûÁeL©’cy(us)", 
i
 * 1000);

144 
	`expÜtStusCouÁs
(
expÜ‹r
);

146 ià(
v”bo£
) {

147 
i
 = 0; i < 
buck‘s
; i++) {

148 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
IÁeg”
.
	`toSŒšg
(
i
), 
hi¡og¿m
[i]);

151 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), ">" + 
buck‘s
, 
hi¡og¿mov”æow
);

153 
	}
}

155 @
Ov”ride


156 
public
 
SŒšg
 
	$g‘Summ¬y
() {

157 ià(
wšdowİ”©iÚs
 == 0) {

160 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

161 
»pÜt
 = ((è
wšdowtÙ®Ï‹ncy
è/ ((è
wšdowİ”©iÚs
);

162 
wšdowtÙ®Ï‹ncy
 = 0;

163 
wšdowİ”©iÚs
 = 0;

164  "[" + 
	`g‘Name
(è+ " Av”ageL©’cy(us)=" + 
d
.
	`fÜm©
(
»pÜt
) + "]";

165 
	}
}

	@core/src/main/java/site/ycsb/measurements/OneMeasurementRaw.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gjava
.
	gio
.
	gFeNÙFoundExû±iÚ
;

23 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gPrštSŒ—m
;

26 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

27 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

28 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

29 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

36 
public
 cÏs 
	cOÃM—su»m’tRaw
 
ex‹nds
 
	mOÃM—su»m’t
 {

41 şas 
	cRawD©aPošt
 {

42 
´iv©e
 
fš®
 
	mtime¡amp
;

43 
´iv©e
 
fš®
 
	mv®ue
;

45 
public
 
RawD©aPošt
(
v®ue
) {

46 
	mthis
.
	mtime¡amp
 = 
Sy¡em
.
cu¼’tTimeMlis
();

47 
	mthis
.
	mv®ue
 = 
v®ue
;

50 
public
 
timeSmp
() {

51  
	mtime¡amp
;

54 
public
 
v®ue
() {

55  
	mv®ue
;

59 
şass
 
RawD©aPoštCom·¿tÜ
 
im¶em’ts
 
	gCom·¿tÜ
<
	gRawD©aPošt
> {

60 @
Ov”ride


61 
public
 
com·»
(
RawD©aPošt
 
p1
, RawD©aPošˆ
p2
) {

62 ià(
	gp1
.
v®ue
(è< 
	gp2
.value()) {

64 } ià(
	gp1
.
v®ue
(è=ğ
p2
.value()) {

77 
public
 
fš®
 
SŒšg
 
	gOUTPUT_FILE_PATH
 = "measurement.raw.output_file";

78 
public
 
fš®
 
SŒšg
 
	gOUTPUT_FILE_PATH_DEFAULT
 = "";

88 
public
 
fš®
 
SŒšg
 
	gNO_SUMMARY_STATS
 = "measurement.raw.no_summary";

89 
public
 
fš®
 
SŒšg
 
	gNO_SUMMARY_STATS_DEFAULT
 = "false";

91 
´iv©e
 
fš®
 
PrštSŒ—m
 
	gouutSŒ—m
;

93 
´iv©e
 
boŞ—n
 
	gnoSumm¬ySts
 = 
çl£
;

95 
´iv©e
 
	gLškedLi¡
<
	gRawD©aPošt
> 
	gm—su»m’ts
;

96 
´iv©e
 
	gtÙ®L©’cy
 = 0;

101 
´iv©e
 
	gwšdowO³¿tiÚs
 = 0;

102 
´iv©e
 
	gwšdowTÙ®L©’cy
 = 0;

104 
public
 
	$OÃM—su»m’tRaw
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

105 
	`su³r
(
Çme
);

107 
SŒšg
 
ouutFeP©h
 = 
´İs
.
	`g‘Prİ”ty
(
OUTPUT_FILE_PATH
, 
OUTPUT_FILE_PATH_DEFAULT
);

108 ià(!
ouutFeP©h
.
	`isEm±y
()) {

109 
Sy¡em
.
out
.
	`´šn
("Raw data measurement: will outputo„esult file: " +

110 
ouutFeP©h
);

112 
Œy
 {

113 
ouutSŒ—m
 = 
Ãw
 
	`PrštSŒ—m
(

114 
Ãw
 
	`FeOuutSŒ—m
(
ouutFeP©h
, 
Œue
),

115 
Œue
);

116 } 
	`ÿtch
 (
FeNÙFoundExû±iÚ
 
e
) {

117 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("FaedØİ’„aw d©¨ouuˆfe", 
e
);

121 
Sy¡em
.
out
.
	`´šn
("Raw data measurement: will outputo stdout.");

122 
ouutSŒ—m
 = 
Sy¡em
.
out
;

126 
noSumm¬ySts
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
(
NO_SUMMARY_STATS
,

127 
NO_SUMMARY_STATS_DEFAULT
));

129 
m—su»m’ts
 = 
Ãw
 
LškedLi¡
<>();

130 
	}
}

132 @
Ov”ride


133 
public
 
synchrÚized
 
	$m—su»
(
Ï‹ncy
) {

134 
tÙ®L©’cy
 +ğ
Ï‹ncy
;

135 
wšdowTÙ®L©’cy
 +ğ
Ï‹ncy
;

136 
wšdowO³¿tiÚs
++;

138 
m—su»m’ts
.
	`add
(
Ãw
 
	`RawD©aPošt
(
Ï‹ncy
));

139 
	}
}

141 @
Ov”ride


142 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
)

143 
throws
 
IOExû±iÚ
 {

147 
ouutSŒ—m
.
	`´šn
(
	`g‘Name
() +

149 
RawD©aPošt
 
pošt
 : 
m—su»m’ts
) {

150 
ouutSŒ—m
.
	`´šn
(

151 
SŒšg
.
	`fÜm©
("%s,%d,%d", 
	`g‘Name
(), 
pošt
.
	`timeSmp
(),

152 
pošt
.
	`v®ue
()));

154 ià(
ouutSŒ—m
 !ğ
Sy¡em
.
out
) {

155 
ouutSŒ—m
.
	`şo£
();

158 
tÙ®Ops
 = 
m—su»m’ts
.
	`size
();

159 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "TÙ® O³¿tiÚs", 
tÙ®Ops
);

160 ià(
tÙ®Ops
 > 0 && !
noSumm¬ySts
) {

161 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(),

163 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Average",

164 (è
tÙ®L©’cy
 / (è
tÙ®Ops
);

166 
CŞËùiÚs
.
	`sÜt
(
m—su»m’ts
, 
Ãw
 
	`RawD©aPoštCom·¿tÜ
());

168 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Mš", 
m—su»m’ts
.
	`g‘
(0).
	`v®ue
());

169 
expÜ‹r
.
	`wr™e
(

170 
	`g‘Name
(), "Max", 
m—su»m’ts
.
	`g‘
(
tÙ®Ops
 - 1).
	`v®ue
());

171 
expÜ‹r
.
	`wr™e
(

172 
	`g‘Name
(), "p1", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.01)).
	`v®ue
());

173 
expÜ‹r
.
	`wr™e
(

174 
	`g‘Name
(), "p5", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.05)).
	`v®ue
());

175 
expÜ‹r
.
	`wr™e
(

176 
	`g‘Name
(), "p50", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.5)).
	`v®ue
());

177 
expÜ‹r
.
	`wr™e
(

178 
	`g‘Name
(), "p90", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.9)).
	`v®ue
());

179 
expÜ‹r
.
	`wr™e
(

180 
	`g‘Name
(), "p95", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.95)).
	`v®ue
());

181 
expÜ‹r
.
	`wr™e
(

182 
	`g‘Name
(), "p99", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.99)).
	`v®ue
());

183 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "p99.9",

184 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.999)).
	`v®ue
());

185 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "p99.99",

186 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.9999)).
	`v®ue
());

189 
	`expÜtStusCouÁs
(
expÜ‹r
);

190 
	}
}

192 @
Ov”ride


193 
public
 
synchrÚized
 
SŒšg
 
	$g‘Summ¬y
() {

194 ià(
wšdowO³¿tiÚs
 == 0) {

198 
SŒšg
 
toR‘uº
 = SŒšg.
	`fÜm©
("%s count: %d,‡verage†atency(us): %.2f",

199 
	`g‘Name
(), 
wšdowO³¿tiÚs
,

200 (è
wšdowTÙ®L©’cy
 / (è
wšdowO³¿tiÚs
);

202 
wšdowTÙ®L©’cy
 = 0;

203 
wšdowO³¿tiÚs
 = 0;

205  
toR‘uº
;

206 
	}
}

	@core/src/main/java/site/ycsb/measurements/OneMeasurementTimeSeries.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

27 şas 
	cS”›sUn™
 {

32 
public
 
	$S”›sUn™
(
time
, 
av”age
) {

33 
this
.
time
 =ime;

34 
this
.
av”age
 =‡verage;

37 
´Ùeùed
 
fš®
 
time
;

38 
´Ùeùed
 
fš®
 
av”age
;

39 
	}
}

44 
public
 cÏs 
	cOÃM—su»m’tTimeS”›s
 
ex‹nds
 
	mOÃM—su»m’t
 {

49 
public
 
fš®
 
SŒšg
 
	mGRANULARITY
 = "timeseries.granularity";

50 
public
 
fš®
 
SŒšg
 
	mGRANULARITY_DEFAULT
 = "1000";

52 
´iv©e
 
fš®
 
	mg¿nuÏr™y
;

53 
´iv©e
 
fš®
 
	mVeùÜ
<
	mS”›sUn™
> 
	mm—su»m’ts
;

55 
´iv©e
 
	m¡¬t
 = -1;

56 
´iv©e
 
	mcu¼’tun™
 = -1;

57 
´iv©e
 
	mcouÁ
 = 0;

58 
´iv©e
 
	msum
 = 0;

59 
´iv©e
 
	mİ”©iÚs
 = 0;

60 
´iv©e
 
	mtÙ®Ï‹ncy
 = 0;

63 
´iv©e
 
	mwšdowİ”©iÚs
 = 0;

64 
´iv©e
 
	mwšdowtÙ®Ï‹ncy
 = 0;

66 
´iv©e
 
	mmš
 = -1;

67 
´iv©e
 
	mmax
 = -1;

69 
public
 
	$OÃM—su»m’tTimeS”›s
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

70 
	`su³r
(
Çme
);

71 
g¿nuÏr™y
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
GRANULARITY
, 
GRANULARITY_DEFAULT
));

72 
m—su»m’ts
 = 
Ãw
 
VeùÜ
<>();

75 
´iv©e
 
synchrÚized
 
	$checkEndOfUn™
(
boŞ—n
 
fÜû’d
) {

76 
now
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

78 ià(
¡¬t
 < 0) {

79 
cu¼’tun™
 = 0;

80 
¡¬t
 = 
now
;

83 
un™
 = ((
now
 - 
¡¬t
è/ 
g¿nuÏr™y
) * granularity;

85 ià((
un™
 > 
cu¼’tun™
è|| (
fÜû’d
)) {

86 
avg
 = ((è
sum
è/ ((è
couÁ
);

87 
m—su»m’ts
.
	`add
(
Ãw
 
	`S”›sUn™
(
cu¼’tun™
, 
avg
));

89 
cu¼’tun™
 = 
un™
;

91 
couÁ
 = 0;

92 
sum
 = 0;

94 
	}
}

96 @
Ov”ride


97 
public
 
	$m—su»
(
Ï‹ncy
) {

98 
	`checkEndOfUn™
(
çl£
);

100 
couÁ
++;

101 
sum
 +ğ
Ï‹ncy
;

102 
tÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

103 
İ”©iÚs
++;

104 
wšdowİ”©iÚs
++;

105 
wšdowtÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

107 ià(
Ï‹ncy
 > 
max
) {

108 
max
 = 
Ï‹ncy
;

111 ià((
Ï‹ncy
 < 
mš
) || (min < 0)) {

112 
mš
 = 
Ï‹ncy
;

114 
	}
}

117 @
Ov”ride


118 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

119 
	`checkEndOfUn™
(
Œue
);

121 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "O³¿tiÚs", 
İ”©iÚs
);

122 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Av”ageL©’cy(us)", (((è
tÙ®Ï‹ncy
è/ ((è
İ”©iÚs
)));

123 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MšL©’cy(us)", 
mš
);

124 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MaxL©’cy(us)", 
max
);

128 
	`expÜtStusCouÁs
(
expÜ‹r
);

129 
S”›sUn™
 
un™
 : 
m—su»m’ts
) {

130 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
LÚg
.
	`toSŒšg
(
un™
.
time
), un™.
av”age
);

132 
	}
}

134 @
Ov”ride


135 
public
 
SŒšg
 
	$g‘Summ¬y
() {

136 ià(
wšdowİ”©iÚs
 == 0) {

139 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

140 
»pÜt
 = ((è
wšdowtÙ®Ï‹ncy
è/ ((è
wšdowİ”©iÚs
);

141 
wšdowtÙ®Ï‹ncy
 = 0;

142 
wšdowİ”©iÚs
 = 0;

143  "[" + 
	`g‘Name
(è+ " Av”ageL©’cy(us)=" + 
d
.
	`fÜm©
(
»pÜt
) + "]";

144 
	}
}

	@core/src/main/java/site/ycsb/measurements/TwoInOneMeasurement.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

28 
public
 cÏs 
	cTwoInOÃM—su»m’t
 
ex‹nds
 
	mOÃM—su»m’t
 {

30 
´iv©e
 
fš®
 
OÃM—su»m’t
 
	mthšg1
, 
	mthšg2
;

32 
public
 
	$TwoInOÃM—su»m’t
(
SŒšg
 
Çme
, 
OÃM—su»m’t
 
thšg1
, OÃM—su»m’ˆ
thšg2
) {

33 
	`su³r
(
Çme
);

34 
this
.
thšg1
 =hing1;

35 
this
.
thšg2
 =hing2;

41 @
Ov”ride


42 
public
 
	$»pÜtStus
(
fš®
 
Stus
 
¡©us
) {

43 
thšg1
.
	`»pÜtStus
(
¡©us
);

44 
	}
}

50 @
Ov”ride


51 
public
 
	$m—su»
(
Ï‹ncyInMiüos
) {

52 
thšg1
.
	`m—su»
(
Ï‹ncyInMiüos
);

53 
thšg2
.
	`m—su»
(
Ï‹ncyInMiüos
);

54 
	}
}

59 @
Ov”ride


60 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

61 
thšg1
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

62 
thšg2
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

63 
	}
}

71 @
Ov”ride


72 
public
 
SŒšg
 
	$g‘Summ¬y
() {

73  
thšg1
.
	`g‘Summ¬y
(è+ "\n" + 
thšg2
.getSummary();

74 
	}
}

	@core/src/main/java/site/ycsb/measurements/exporter/JSONArrayMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚFaùÜy
;

20 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚG’”©Ü
;

21 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gut
.
	gDeçuÉP»‰yPrš‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

26 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

31 
public
 cÏs 
	cJSONA¼ayM—su»m’tsExpÜ‹r
 
im¶em’ts
 
	mM—su»m’tsExpÜ‹r
 {

32 
´iv©e
 
fš®
 
JsÚFaùÜy
 
	mçùÜy
 = 
Ãw
 JsonFactory();

33 
´iv©e
 
JsÚG’”©Ü
 
	mg
;

35 
public
 
	$JSONA¼ayM—su»m’tsExpÜ‹r
(
OuutSŒ—m
 
os
è
throws
 
IOExû±iÚ
 {

36 
Bufã»dWr™”
 
bw
 = 
Ãw
 
	`Bufã»dWr™”
Òew 
	`OuutSŒ—mWr™”
(
os
));

37 
g
 = 
çùÜy
.
	`ü—‹JsÚG’”©Ü
(
bw
);

38 
g
.
	`£tP»‰yPrš‹r
(
Ãw
 
	`DeçuÉP»‰yPrš‹r
());

39 
g
.
	`wr™eS¹A¼ay
();

42 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

43 
g
.
	`wr™eS¹Objeù
();

44 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

45 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

46 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

47 
g
.
	`wr™eEndObjeù
();

48 
	}
}

50 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

51 
g
.
	`wr™eS¹Objeù
();

52 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

53 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

54 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

55 
g
.
	`wr™eEndObjeù
();

56 
	}
}

58 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
IOExû±iÚ
 {

59 
g
.
	`wr™eS¹Objeù
();

60 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

61 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

62 
g
.
	`wr™eNumb”F›ld
("v®ue", 
d
);

63 
g
.
	`wr™eEndObjeù
();

64 
	}
}

66 
public
 
	$şo£
(è
throws
 
IOExû±iÚ
 {

67 ià(
g
 !ğ
nuÎ
) {

68 
g
.
	`wr™eEndA¼ay
();

69 
g
.
	`şo£
();

71 
	}
}

	@core/src/main/java/site/ycsb/measurements/exporter/JSONMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚFaùÜy
;

20 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚG’”©Ü
;

21 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gut
.
	gDeçuÉP»‰yPrš‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

26 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

31 
public
 cÏs 
	cJSONM—su»m’tsExpÜ‹r
 
im¶em’ts
 
	mM—su»m’tsExpÜ‹r
 {

33 
´iv©e
 
fš®
 
JsÚFaùÜy
 
	mçùÜy
 = 
Ãw
 JsonFactory();

34 
´iv©e
 
JsÚG’”©Ü
 
	mg
;

36 
public
 
	$JSONM—su»m’tsExpÜ‹r
(
OuutSŒ—m
 
os
è
throws
 
IOExû±iÚ
 {

38 
Bufã»dWr™”
 
bw
 = 
Ãw
 
	`Bufã»dWr™”
Òew 
	`OuutSŒ—mWr™”
(
os
));

39 
g
 = 
çùÜy
.
	`ü—‹JsÚG’”©Ü
(
bw
);

40 
g
.
	`£tP»‰yPrš‹r
(
Ãw
 
	`DeçuÉP»‰yPrš‹r
());

43 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

44 
g
.
	`wr™eS¹Objeù
();

45 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

46 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

47 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

48 
g
.
	`wr™eEndObjeù
();

49 
	}
}

51 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

52 
g
.
	`wr™eS¹Objeù
();

53 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

54 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

55 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

56 
g
.
	`wr™eEndObjeù
();

57 
	}
}

59 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
IOExû±iÚ
 {

60 
g
.
	`wr™eS¹Objeù
();

61 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

62 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

63 
g
.
	`wr™eNumb”F›ld
("v®ue", 
d
);

64 
g
.
	`wr™eEndObjeù
();

65 
	}
}

67 
public
 
	$şo£
(è
throws
 
IOExû±iÚ
 {

68 ià(
g
 !ğ
nuÎ
) {

69 
g
.
	`şo£
();

71 
	}
}

	@core/src/main/java/site/ycsb/measurements/exporter/MeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gjava
.
	gio
.
	gClo£abË
;

20 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
public
 
š‹rçû
 
M—su»m’tsExpÜ‹r
 
ex‹nds
 
	gClo£abË
 {

35 
wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
	gIOExû±iÚ
;

45 
wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
	gIOExû±iÚ
;

55 
wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
	gIOExû±iÚ
;

	@core/src/main/java/site/ycsb/measurements/exporter/TextMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

20 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

21 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

22 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

27 
public
 cÏs 
	cTextM—su»m’tsExpÜ‹r
 
im¶em’ts
 
	mM—su»m’tsExpÜ‹r
 {

28 
´iv©e
 
fš®
 
Bufã»dWr™”
 
	mbw
;

30 
public
 
	$TextM—su»m’tsExpÜ‹r
(
OuutSŒ—m
 
os
) {

31 
this
.
bw
 = 
Ãw
 
	`Bufã»dWr™”
Òew 
	`OuutSŒ—mWr™”
(
os
));

34 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

35 
bw
.
	`wr™e
("[" + 
m‘ric
 + "], " + 
m—su»m’t
 + ", " + 
i
);

36 
bw
.
	`ÃwLše
();

37 
	}
}

39 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

40 
bw
.
	`wr™e
("[" + 
m‘ric
 + "], " + 
m—su»m’t
 + ", " + 
i
);

41 
bw
.
	`ÃwLše
();

42 
	}
}

44 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
IOExû±iÚ
 {

45 
bw
.
	`wr™e
("[" + 
m‘ric
 + "], " + 
m—su»m’t
 + ", " + 
d
);

46 
bw
.
	`ÃwLše
();

47 
	}
}

49 
public
 
	$şo£
(è
throws
 
IOExû±iÚ
 {

50 
this
.
bw
.
	`şo£
();

51 
	}
}

	@core/src/main/java/site/ycsb/measurements/exporter/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

	@core/src/main/java/site/ycsb/measurements/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

	@core/src/main/java/site/ycsb/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
;

	@core/src/main/java/site/ycsb/workloads/ConstantOccupancyWorkload.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gNumb”G’”©Ü
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

45 
public
 cÏs 
	cCÚ¡ªtOccu·ncyWÜklßd
 
ex‹nds
 
	mCÜeWÜklßd
 {

46 
´iv©e
 
	mdisksize
;

47 
´iv©e
 
	m¡Üag—ges
;

48 
´iv©e
 
	moccu·ncy
;

50 
´iv©e
 
	mobjeùCouÁ
;

52 
public
 
fš®
 
SŒšg
 
	mSTORAGE_AGE_PROPERTY
 = "storageages";

53 
public
 
fš®
 
	mSTORAGE_AGE_PROPERTY_DEFAULT
 = 10;

55 
public
 
fš®
 
SŒšg
 
	mDISK_SIZE_PROPERTY
 = "disksize";

56 
public
 
fš®
 
	mDISK_SIZE_PROPERTY_DEFAULT
 = 100 * 1000 * 1000;

58 
public
 
fš®
 
SŒšg
 
	mOCCUPANCY_PROPERTY
 = "occupancy";

59 
public
 
fš®
 
	mOCCUPANCY_PROPERTY_DEFAULT
 = 0.9;

61 @
Ov”ride


62 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

63 
disksize
 = 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
DISK_SIZE_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
DISK_SIZE_PROPERTY_DEFAULT
)));

64 
¡Üag—ges
 = 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
STORAGE_AGE_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
STORAGE_AGE_PROPERTY_DEFAULT
)));

65 
occu·ncy
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
OCCUPANCY_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
OCCUPANCY_PROPERTY_DEFAULT
)));

67 ià(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
è!ğ
nuÎ
 ||

68 
p
.
	`g‘Prİ”ty
(
Cl›Á
.
INSERT_COUNT_PROPERTY
è!ğ
nuÎ
 ||

69 
p
.
	`g‘Prİ”ty
(
Cl›Á
.
OPERATION_COUNT_PROPERTY
è!ğ
nuÎ
) {

70 
Sy¡em
.
”r
.
	`´šn
("Warning:„ecord, insert or operation count was set…rioro initting " +

73 
Numb”G’”©Ü
 
g
 = 
CÜeWÜklßd
.
	`g‘F›ldL’gthG’”©Ü
(
p
);

74 
f›ldsize
 = 
g
.
	`m—n
();

75 
f›ldcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
FIELD_COUNT_PROPERTY
, 
FIELD_COUNT_PROPERTY_DEFAULT
));

77 
objeùCouÁ
 = (è(
occu·ncy
 * (
disksize
 / (
f›ldsize
 * 
f›ldcouÁ
)));

78 ià(
objeùCouÁ
 == 0) {

79 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Object count was zero. Perhaps disksize isoo†ow?");

81 
p
.
	`£tPrİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
objeùCouÁ
));

82 
p
.
	`£tPrİ”ty
(
Cl›Á
.
OPERATION_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
¡Üag—ges
 * 
objeùCouÁ
));

83 
p
.
	`£tPrİ”ty
(
Cl›Á
.
INSERT_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
objeùCouÁ
));

85 
su³r
.
	`š™
(
p
);

88 
	}
}

	@core/src/main/java/site/ycsb/workloads/CoreWorkload.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

20 
impÜt
 
	gs™e
.
	gycsb
.*;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.*;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnifÜmLÚgG’”©Ü
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

25 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gjava
.
	gut
.*;

68 
public
 cÏs 
	cCÜeWÜklßd
 
ex‹nds
 
	mWÜklßd
 {

72 
public
 
fš®
 
SŒšg
 
	mTABLENAME_PROPERTY
 = "table";

77 
public
 
fš®
 
SŒšg
 
	mTABLENAME_PROPERTY_DEFAULT
 = "usertable";

79 
´Ùeùed
 
SŒšg
 
	mbË
;

84 
public
 
fš®
 
SŒšg
 
	mFIELD_COUNT_PROPERTY
 = "fieldcount";

89 
public
 
fš®
 
SŒšg
 
	mFIELD_COUNT_PROPERTY_DEFAULT
 = "10";

91 
´iv©e
 
	mLi¡
<
	mSŒšg
> 
	mf›ldÇmes
;

101 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_PROPERTY
 = "fieldlengthdistribution";

106 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
 = "constant";

111 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_PROPERTY
 = "fieldlength";

116 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_PROPERTY_DEFAULT
 = "100";

121 
public
 
fš®
 
SŒšg
 
	mMIN_FIELD_LENGTH_PROPERTY
 = "minfieldlength";

126 
public
 
fš®
 
SŒšg
 
	mMIN_FIELD_LENGTH_PROPERTY_DEFAULT
 = "1";

132 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_HISTOGRAM_FILE_PROPERTY
 = "fieldlengthhistogram";

137 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_HISTOGRAM_FILE_PROPERTY_DEFAULT
 = "hist.txt";

143 
´Ùeùed
 
Numb”G’”©Ü
 
	mf›ldËngthg’”©Ü
;

149 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_PROPERTY
 = "readallfields";

154 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_PROPERTY_DEFAULT
 = "true";

156 
´Ùeùed
 
boŞ—n
 
	m»ad®lf›lds
;

164 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_BY_NAME_PROPERTY
 = "readallfieldsbyname";

169 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_BY_NAME_PROPERTY_DEFAULT
 = "false";

171 
´Ùeùed
 
boŞ—n
 
	m»ad®lf›ldsbyÇme
;

177 
public
 
fš®
 
SŒšg
 
	mWRITE_ALL_FIELDS_PROPERTY
 = "writeallfields";

182 
public
 
fš®
 
SŒšg
 
	mWRITE_ALL_FIELDS_PROPERTY_DEFAULT
 = "false";

184 
´Ùeùed
 
boŞ—n
 
	mwr™—Îf›lds
;

190 
public
 
fš®
 
SŒšg
 
	mDATA_INTEGRITY_PROPERTY
 = "dataintegrity";

195 
public
 
fš®
 
SŒšg
 
	mDATA_INTEGRITY_PROPERTY_DEFAULT
 = "false";

201 
´iv©e
 
boŞ—n
 
	md©aš‹gr™y
;

206 
public
 
fš®
 
SŒšg
 
	mREAD_PROPORTION_PROPERTY
 = "readproportion";

211 
public
 
fš®
 
SŒšg
 
	mREAD_PROPORTION_PROPERTY_DEFAULT
 = "0.95";

216 
public
 
fš®
 
SŒšg
 
	mUPDATE_PROPORTION_PROPERTY
 = "updateproportion";

221 
public
 
fš®
 
SŒšg
 
	mUPDATE_PROPORTION_PROPERTY_DEFAULT
 = "0.05";

226 
public
 
fš®
 
SŒšg
 
	mINSERT_PROPORTION_PROPERTY
 = "insertproportion";

231 
public
 
fš®
 
SŒšg
 
	mINSERT_PROPORTION_PROPERTY_DEFAULT
 = "0.0";

236 
public
 
fš®
 
SŒšg
 
	mSCAN_PROPORTION_PROPERTY
 = "scanproportion";

241 
public
 
fš®
 
SŒšg
 
	mSCAN_PROPORTION_PROPERTY_DEFAULT
 = "0.0";

246 
public
 
fš®
 
SŒšg
 
	mREADMODIFYWRITE_PROPORTION_PROPERTY
 = "readmodifywriteproportion";

251 
public
 
fš®
 
SŒšg
 
	mREADMODIFYWRITE_PROPORTION_PROPERTY_DEFAULT
 = "0.0";

257 
public
 
fš®
 
SŒšg
 
	mREQUEST_DISTRIBUTION_PROPERTY
 = "requestdistribution";

262 
public
 
fš®
 
SŒšg
 
	mREQUEST_DISTRIBUTION_PROPERTY_DEFAULT
 = "uniform";

268 
public
 
fš®
 
SŒšg
 
	mZERO_PADDING_PROPERTY
 = "zeropadding";

273 
public
 
fš®
 
SŒšg
 
	mZERO_PADDING_PROPERTY_DEFAULT
 = "1";

279 
public
 
fš®
 
SŒšg
 
	mMIN_SCAN_LENGTH_PROPERTY
 = "minscanlength";

284 
public
 
fš®
 
SŒšg
 
	mMIN_SCAN_LENGTH_PROPERTY_DEFAULT
 = "1";

289 
public
 
fš®
 
SŒšg
 
	mMAX_SCAN_LENGTH_PROPERTY
 = "maxscanlength";

294 
public
 
fš®
 
SŒšg
 
	mMAX_SCAN_LENGTH_PROPERTY_DEFAULT
 = "1000";

300 
public
 
fš®
 
SŒšg
 
	mSCAN_LENGTH_DISTRIBUTION_PROPERTY
 = "scanlengthdistribution";

305 
public
 
fš®
 
SŒšg
 
	mSCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
 = "uniform";

310 
public
 
fš®
 
SŒšg
 
	mINSERT_ORDER_PROPERTY
 = "insertorder";

315 
public
 
fš®
 
SŒšg
 
	mINSERT_ORDER_PROPERTY_DEFAULT
 = "hashed";

320 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_DATA_FRACTION
 = "hotspotdatafraction";

325 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_DATA_FRACTION_DEFAULT
 = "0.2";

330 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_OPN_FRACTION
 = "hotspotopnfraction";

335 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_OPN_FRACTION_DEFAULT
 = "0.8";

340 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_LIMIT
 = "core_workload_insertion_retry_limit";

341 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_LIMIT_DEFAULT
 = "0";

346 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_INTERVAL
 = "core_workload_insertion_retry_interval";

347 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_INTERVAL_DEFAULT
 = "3";

352 
public
 
fš®
 
SŒšg
 
	mFIELD_NAME_PREFIX
 = "fieldnameprefix";

357 
public
 
fš®
 
SŒšg
 
	mFIELD_NAME_PREFIX_DEFAULT
 = "field";

359 
´Ùeùed
 
Numb”G’”©Ü
 
	mkey£qu’û
;

360 
´Ùeùed
 
Disü‘eG’”©Ü
 
	mİ”©iÚchoo£r
;

361 
´Ùeùed
 
Numb”G’”©Ü
 
	mkeychoo£r
;

362 
´Ùeùed
 
Numb”G’”©Ü
 
	mf›ldchoo£r
;

363 
´Ùeùed
 
AcknowËdgedCouÁ”G’”©Ü
 
	mŒª§ùiÚš£¹key£qu’û
;

364 
´Ùeùed
 
Numb”G’”©Ü
 
	msÿÆ’gth
;

365 
´Ùeùed
 
boŞ—n
 
	mÜd”edš£¹s
;

366 
´Ùeùed
 
	mf›ldcouÁ
;

367 
´Ùeùed
 
	m»cÜdcouÁ
;

368 
´Ùeùed
 
	mz”İaddšg
;

369 
´Ùeùed
 
	mš£¹iÚR‘ryLim™
;

370 
´Ùeùed
 
	mš£¹iÚR‘ryIÁ”v®
;

372 
´iv©e
 
M—su»m’ts
 
	mm—su»m’ts
 = M—su»m’ts.
g‘M—su»m’ts
();

374 
public
 
SŒšg
 
	$budKeyName
(
keynum
, 
z”İaddšg
, 
boŞ—n
 
Üd”edš£¹s
) {

375 ià(!
Üd”edš£¹s
) {

376 
keynum
 = 
Uts
.
	`hash
(keynum);

378 
SŒšg
 
v®ue
 = 
LÚg
.
	`toSŒšg
(
keynum
);

379 
fl
 = 
z”İaddšg
 - 
v®ue
.
	`Ëngth
();

380 
SŒšg
 
´ekey
 = "user";

381 
i
 = 0; i < 
fl
; i++) {

382 
´ekey
 += '0';

384  
´ekey
 + 
v®ue
;

387 
´Ùeùed
 
Numb”G’”©Ü
 
	$g‘F›ldL’gthG’”©Ü
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

388 
Numb”G’”©Ü
 
f›ldËngthg’”©Ü
;

389 
SŒšg
 
f›ldËngthdi¡ributiÚ
 = 
p
.
	`g‘Prİ”ty
(

390 
FIELD_LENGTH_DISTRIBUTION_PROPERTY
, 
FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

391 
f›ldËngth
 =

392 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
FIELD_LENGTH_PROPERTY
, 
FIELD_LENGTH_PROPERTY_DEFAULT
));

393 
mšf›ldËngth
 =

394 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
MIN_FIELD_LENGTH_PROPERTY
, 
MIN_FIELD_LENGTH_PROPERTY_DEFAULT
));

395 
SŒšg
 
f›ldËngthhi¡og¿m
 = 
p
.
	`g‘Prİ”ty
(

396 
FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY
, 
FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY_DEFAULT
);

397 ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("constant") == 0) {

398 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`CÚ¡ªtIÁeg”G’”©Ü
(
f›ldËngth
);

399 } ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("uniform") == 0) {

400 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(
mšf›ldËngth
, 
f›ldËngth
);

401 } ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("zipfian") == 0) {

402 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
mšf›ldËngth
, 
f›ldËngth
);

403 } ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("histogram") == 0) {

404 
Œy
 {

405 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`Hi¡og¿mG’”©Ü
(
f›ldËngthhi¡og¿m
);

406 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

407 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

408 "Couldn'ˆ»ad f›ld†’gth hi¡og¿m fe: " + 
f›ldËngthhi¡og¿m
, 
e
);

411 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

412 "UnknowÀf›ld†’gth di¡ributiÚ \"" + 
f›ldËngthdi¡ributiÚ
 + "\"");

414  
f›ldËngthg’”©Ü
;

415 
	}
}

421 @
Ov”ride


422 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

423 
bË
 = 
p
.
	`g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

425 
f›ldcouÁ
 =

426 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
FIELD_COUNT_PROPERTY
, 
FIELD_COUNT_PROPERTY_DEFAULT
));

427 
fš®
 
SŒšg
 
f›ldÇm•»fix
 = 
p
.
	`g‘Prİ”ty
(
FIELD_NAME_PREFIX
, 
FIELD_NAME_PREFIX_DEFAULT
);

428 
f›ldÇmes
 = 
Ãw
 
A¼ayLi¡
<>();

429 
i
 = 0; i < 
f›ldcouÁ
; i++) {

430 
f›ldÇmes
.
	`add
(
f›ldÇm•»fix
 + 
i
);

432 
f›ldËngthg’”©Ü
 = 
CÜeWÜklßd
.
	`g‘F›ldL’gthG’”©Ü
(
p
);

434 
»cÜdcouÁ
 =

435 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
, Cl›Á.
DEFAULT_RECORD_COUNT
));

436 ià(
»cÜdcouÁ
 == 0) {

437 
»cÜdcouÁ
 = 
IÁeg”
.
MAX_VALUE
;

439 
SŒšg
 
»que¡di¡rib
 =

440 
p
.
	`g‘Prİ”ty
(
REQUEST_DISTRIBUTION_PROPERTY
, 
REQUEST_DISTRIBUTION_PROPERTY_DEFAULT
);

441 
mšsÿÆ’gth
 =

442 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
MIN_SCAN_LENGTH_PROPERTY
, 
MIN_SCAN_LENGTH_PROPERTY_DEFAULT
));

443 
maxsÿÆ’gth
 =

444 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
MAX_SCAN_LENGTH_PROPERTY
, 
MAX_SCAN_LENGTH_PROPERTY_DEFAULT
));

445 
SŒšg
 
sÿÆ’gthdi¡rib
 =

446 
p
.
	`g‘Prİ”ty
(
SCAN_LENGTH_DISTRIBUTION_PROPERTY
, 
SCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

448 
š£¹¡¬t
 =

449 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
INSERT_START_PROPERTY
, 
INSERT_START_PROPERTY_DEFAULT
));

450 
š£¹couÁ
=

451 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
INSERT_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
»cÜdcouÁ
 - 
š£¹¡¬t
)));

453 ià(
»cÜdcouÁ
 < (
š£¹¡¬t
 + 
š£¹couÁ
)) {

454 
Sy¡em
.
”r
.
	`´šn
("Invalid combination of insertstart, insertcount‡nd„ecordcount.");

455 
Sy¡em
.
”r
.
	`´šn
("recordcount must be biggerhan insertstart + insertcount.");

456 
Sy¡em
.
	`ex™
(-1);

458 
z”İaddšg
 =

459 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
ZERO_PADDING_PROPERTY
, 
ZERO_PADDING_PROPERTY_DEFAULT
));

461 
»ad®lf›lds
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

462 
p
.
	`g‘Prİ”ty
(
READ_ALL_FIELDS_PROPERTY
, 
READ_ALL_FIELDS_PROPERTY_DEFAULT
));

463 
»ad®lf›ldsbyÇme
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

464 
p
.
	`g‘Prİ”ty
(
READ_ALL_FIELDS_BY_NAME_PROPERTY
, 
READ_ALL_FIELDS_BY_NAME_PROPERTY_DEFAULT
));

465 
wr™—Îf›lds
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

466 
p
.
	`g‘Prİ”ty
(
WRITE_ALL_FIELDS_PROPERTY
, 
WRITE_ALL_FIELDS_PROPERTY_DEFAULT
));

468 
d©aš‹gr™y
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

469 
p
.
	`g‘Prİ”ty
(
DATA_INTEGRITY_PROPERTY
, 
DATA_INTEGRITY_PROPERTY_DEFAULT
));

472 ià(
d©aš‹gr™y
 && !(
p
.
	`g‘Prİ”ty
(

473 
FIELD_LENGTH_DISTRIBUTION_PROPERTY
,

474 
FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
)).
	`equ®s
("constant")) {

475 
Sy¡em
.
”r
.
	`´šn
("Must have constant field sizeo check data integrity.");

476 
Sy¡em
.
	`ex™
(-1);

478 ià(
d©aš‹gr™y
) {

479 
Sy¡em
.
out
.
	`´šn
("Data integrity isƒnabled.");

482 ià(
p
.
	`g‘Prİ”ty
(
INSERT_ORDER_PROPERTY
, 
INSERT_ORDER_PROPERTY_DEFAULT
).
	`com·»To
("hashed") == 0) {

483 
Üd”edš£¹s
 = 
çl£
;

485 
Üd”edš£¹s
 = 
Œue
;

488 
key£qu’û
 = 
Ãw
 
	`CouÁ”G’”©Ü
(
š£¹¡¬t
);

489 
İ”©iÚchoo£r
 = 
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

491 
Œª§ùiÚš£¹key£qu’û
 = 
Ãw
 
	`AcknowËdgedCouÁ”G’”©Ü
(
»cÜdcouÁ
);

492 ià(
»que¡di¡rib
.
	`com·»To
("uniform") == 0) {

493 
keychoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 - 1);

494 } ià(
»que¡di¡rib
.
	`com·»To
("exponential") == 0) {

495 
³rûÁe
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(

496 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_PROPERTY
,

497 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_DEFAULT
));

498 
äac
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(

499 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_PROPERTY
,

500 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_DEFAULT
));

501 
keychoo£r
 = 
Ãw
 
	`ExpÚ’tŸlG’”©Ü
(
³rûÁe
, 
»cÜdcouÁ
 * 
äac
);

502 } ià(
»que¡di¡rib
.
	`com·»To
("sequential") == 0) {

503 
keychoo£r
 = 
Ãw
 
	`Sequ’tŸlG’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 - 1);

504 } ià(
»que¡di¡rib
.
	`com·»To
("zipfian") == 0) {

514 
fš®
 
š£¹´İÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

515 
p
.
	`g‘Prİ”ty
(
INSERT_PROPORTION_PROPERTY
, 
INSERT_PROPORTION_PROPERTY_DEFAULT
));

516 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
OPERATION_COUNT_PROPERTY
));

517 
ex³ùedÃwkeys
 = (è((
İcouÁ
è* 
š£¹´İÜtiÚ
 * 2.0);

519 
keychoo£r
 = 
Ãw
 
	`SüambËdZfŸnG’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 + 
ex³ùedÃwkeys
);

520 } ià(
»que¡di¡rib
.
	`com·»To
("latest") == 0) {

521 
keychoo£r
 = 
Ãw
 
	`SkewedL©e¡G’”©Ü
(
Œª§ùiÚš£¹key£qu’û
);

522 } ià(
»que¡di¡rib
.
	`equ®s
("hotspot")) {

523 
hÙ£täaùiÚ
 =

524 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_DATA_FRACTION
, 
HOTSPOT_DATA_FRACTION_DEFAULT
));

525 
hÙİnäaùiÚ
 =

526 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_OPN_FRACTION
, 
HOTSPOT_OPN_FRACTION_DEFAULT
));

527 
keychoo£r
 = 
Ãw
 
	`HÙ¥ÙIÁeg”G’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 - 1,

528 
hÙ£täaùiÚ
, 
hÙİnäaùiÚ
);

530 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀ»que¡ di¡ributiÚ \"" + 
»que¡di¡rib
 + "\"");

533 
f›ldchoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(0, 
f›ldcouÁ
 - 1);

535 ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("uniform") == 0) {

536 
sÿÆ’gth
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(
mšsÿÆ’gth
, 
maxsÿÆ’gth
);

537 } ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("zipfian") == 0) {

538 
sÿÆ’gth
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
mšsÿÆ’gth
, 
maxsÿÆ’gth
);

540 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

541 "Di¡ributiÚ \"" + 
sÿÆ’gthdi¡rib
 + "\"‚ot‡llowed for scan†ength");

544 
š£¹iÚR‘ryLim™
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(

545 
INSERTION_RETRY_LIMIT
, 
INSERTION_RETRY_LIMIT_DEFAULT
));

546 
š£¹iÚR‘ryIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(

547 
INSERTION_RETRY_INTERVAL
, 
INSERTION_RETRY_INTERVAL_DEFAULT
));

548 
	}
}

553 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	$budSšgËV®ue
(
SŒšg
 
key
) {

554 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ue
 = 
Ãw
 HashMap<>();

556 
SŒšg
 
f›ldkey
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

557 
By‹I‹¿tÜ
 
d©a
;

558 ià(
d©aš‹gr™y
) {

559 
d©a
 = 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
key
, 
f›ldkey
));

562 
d©a
 = 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
());

564 
v®ue
.
	`put
(
f›ldkey
, 
d©a
);

566  
v®ue
;

567 
	}
}

572 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	$budV®ues
(
SŒšg
 
key
) {

573 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<>();

575 
SŒšg
 
f›ldkey
 : 
f›ldÇmes
) {

576 
By‹I‹¿tÜ
 
d©a
;

577 ià(
d©aš‹gr™y
) {

578 
d©a
 = 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
key
, 
f›ldkey
));

581 
d©a
 = 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
());

583 
v®ues
.
	`put
(
f›ldkey
, 
d©a
);

585  
v®ues
;

586 
	}
}

591 
´iv©e
 
SŒšg
 
	$budD‘”mši¡icV®ue
(
SŒšg
 
key
, SŒšg 
f›ldkey
) {

592 
size
 = 
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`štV®ue
();

593 
SŒšgBud”
 
sb
 = 
Ãw
 
	`SŒšgBud”
(
size
);

594 
sb
.
	`­³nd
(
key
);

595 
sb
.
	`­³nd
(':');

596 
sb
.
	`­³nd
(
f›ldkey
);

597 
sb
.
	`Ëngth
(è< 
size
) {

598 
sb
.
	`­³nd
(':');

599 
sb
.
	`­³nd
(sb.
	`toSŒšg
().
	`hashCode
());

601 
sb
.
	`£tL’gth
(
size
);

603  
sb
.
	`toSŒšg
();

604 
	}
}

612 @
Ov”ride


613 
public
 
boŞ—n
 
	$doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

614 
keynum
 = 
key£qu’û
.
	`ÃxtV®ue
().
	`štV®ue
();

615 
SŒšg
 
dbkey
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

616 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
	`budV®ues
(
dbkey
);

618 
Stus
 
¡©us
;

619 
numOfR‘r›s
 = 0;

621 
¡©us
 = 
db
.
	`š£¹
(
bË
, 
dbkey
, 
v®ues
);

622 ià(
nuÎ
 !ğ
¡©us
 && stus.
	`isOk
()) {

628 ià(++
numOfR‘r›s
 <ğ
š£¹iÚR‘ryLim™
) {

629 
Sy¡em
.
”r
.
	`´šn
("R‘ryšg in£¹iÚ,„‘ry couÁ: " + 
numOfR‘r›s
);

630 
Œy
 {

632 
¦“pTime
 = (è(1000 * 
š£¹iÚR‘ryIÁ”v®
 * (0.8 + 0.4 * 
M©h
.
	`¿ndom
()));

633 
Th»ad
.
	`¦“p
(
¦“pTime
);

634 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

639 
Sy¡em
.
”r
.
	`´šn
("E¼Ü in£¹šg,‚Ù„‘ryšg‡ny mÜe.‚umb” oà©‹m±s: " + 
numOfR‘r›s
 +

640 "In£¹iÚ R‘ry Lim™: " + 
š£¹iÚR‘ryLim™
);

644 } 
Œue
);

646  
nuÎ
 !ğ
¡©us
 && stus.
	`isOk
();

647 
	}
}

655 @
Ov”ride


656 
public
 
boŞ—n
 
	$doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

657 
SŒšg
 
İ”©iÚ
 = 
İ”©iÚchoo£r
.
	`ÃxtSŒšg
();

658 if(
İ”©iÚ
 =ğ
nuÎ
) {

659  
çl£
;

662 
İ”©iÚ
) {

664 
	`doT¿n§ùiÚR—d
(
db
);

667 
	`doT¿n§ùiÚUpd©e
(
db
);

670 
	`doT¿n§ùiÚIn£¹
(
db
);

673 
	`doT¿n§ùiÚSÿn
(
db
);

676 
	`doT¿n§ùiÚR—dModifyWr™e
(
db
);

679  
Œue
;

680 
	}
}

689 
´Ùeùed
 
v”ifyRow
(
SŒšg
 
key
, 
HashM­
<SŒšg, 
By‹I‹¿tÜ
> 
ûÎs
) {

690 
Stus
 
	gv”ifyStus
 = Stus.
OK
;

691 
	g¡¬tTime
 = 
Sy¡em
.
ÇnoTime
();

692 ià(!
	gûÎs
.
isEm±y
()) {

693 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
ûÎs
.
’ŒyS‘
()) {

694 ià(!
’Œy
.
g‘V®ue
().
toSŒšg
().
equ®s
(
budD‘”mši¡icV®ue
(
key
,ƒÁry.
g‘Key
()))) {

695 
	gv”ifyStus
 = 
Stus
.
UNEXPECTED_STATE
;

701 
	gv”ifyStus
 = 
Stus
.
ERROR
;

703 
	g’dTime
 = 
Sy¡em
.
ÇnoTime
();

704 
	gm—su»m’ts
.
m—su»
("VERIFY", (è(
’dTime
 - 
¡¬tTime
) / 1000);

705 
	gm—su»m’ts
.
»pÜtStus
("VERIFY", 
v”ifyStus
);

708 
	$ÃxtKeynum
() {

709 
keynum
;

710 ià(
keychoo£r
 
š¡ªûof
 
ExpÚ’tŸlG’”©Ü
) {

712 
keynum
 = 
Œª§ùiÚš£¹key£qu’û
.
	`Ï¡V®ue
(è- 
keychoo£r
.
	`ÃxtV®ue
().
	`štV®ue
();

713 } 
keynum
 < 0);

716 
keynum
 = 
keychoo£r
.
	`ÃxtV®ue
().
	`štV®ue
();

717 } 
keynum
 > 
Œª§ùiÚš£¹key£qu’û
.
	`Ï¡V®ue
());

719  
keynum
;

720 
	}
}

722 
public
 
	$doT¿n§ùiÚR—d
(
DB
 
db
) {

724 
keynum
 = 
	`ÃxtKeynum
();

726 
SŒšg
 
keyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

728 
HashS‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

730 ià(!
»ad®lf›lds
) {

732 
SŒšg
 
f›ldÇme
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

734 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>();

735 
f›lds
.
	`add
(
f›ldÇme
);

736 } ià(
d©aš‹gr™y
 || 
»ad®lf›ldsbyÇme
) {

738 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>(
f›ldÇmes
);

741 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 HashMap<String, ByteIterator>();

742 
db
.
	`»ad
(
bË
, 
keyÇme
, 
f›lds
, 
ûÎs
);

744 ià(
d©aš‹gr™y
) {

745 
	`v”ifyRow
(
keyÇme
, 
ûÎs
);

747 
	}
}

749 
public
 
	$doT¿n§ùiÚR—dModifyWr™e
(
DB
 
db
) {

751 
keynum
 = 
	`ÃxtKeynum
();

753 
SŒšg
 
keyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

755 
HashS‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

757 ià(!
»ad®lf›lds
) {

759 
SŒšg
 
f›ldÇme
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

761 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>();

762 
f›lds
.
	`add
(
f›ldÇme
);

765 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
;

767 ià(
wr™—Îf›lds
) {

769 
v®ues
 = 
	`budV®ues
(
keyÇme
);

772 
v®ues
 = 
	`budSšgËV®ue
(
keyÇme
);

777 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 HashMap<String, ByteIterator>();

780 
i¡
 = 
m—su»m’ts
.
	`g‘IÁ’dedS¹TimeNs
();

781 
¡
 = 
Sy¡em
.
	`ÇnoTime
();

782 
db
.
	`»ad
(
bË
, 
keyÇme
, 
f›lds
, 
ûÎs
);

784 
db
.
	`upd©e
(
bË
, 
keyÇme
, 
v®ues
);

786 
’
 = 
Sy¡em
.
	`ÇnoTime
();

788 ià(
d©aš‹gr™y
) {

789 
	`v”ifyRow
(
keyÇme
, 
ûÎs
);

792 
m—su»m’ts
.
	`m—su»
("READ-MODIFY-WRITE", (è((
’
 - 
¡
) / 1000));

793 
m—su»m’ts
.
	`m—su»IÁ’ded
("READ-MODIFY-WRITE", (è((
’
 - 
i¡
) / 1000));

794 
	}
}

796 
public
 
	$doT¿n§ùiÚSÿn
(
DB
 
db
) {

798 
keynum
 = 
	`ÃxtKeynum
();

800 
SŒšg
 
¡¬tkeyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

803 
Ën
 = 
sÿÆ’gth
.
	`ÃxtV®ue
().
	`štV®ue
();

805 
HashS‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

807 ià(!
»ad®lf›lds
) {

809 
SŒšg
 
f›ldÇme
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

811 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>();

812 
f›lds
.
	`add
(
f›ldÇme
);

815 
db
.
	`sÿn
(
bË
, 
¡¬tkeyÇme
, 
Ën
, 
f›lds
, 
Ãw
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>>());

816 
	}
}

818 
public
 
	$doT¿n§ùiÚUpd©e
(
DB
 
db
) {

820 
keynum
 = 
	`ÃxtKeynum
();

822 
SŒšg
 
keyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

824 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
;

826 ià(
wr™—Îf›lds
) {

828 
v®ues
 = 
	`budV®ues
(
keyÇme
);

831 
v®ues
 = 
	`budSšgËV®ue
(
keyÇme
);

834 
db
.
	`upd©e
(
bË
, 
keyÇme
, 
v®ues
);

835 
	}
}

837 
public
 
	$doT¿n§ùiÚIn£¹
(
DB
 
db
) {

839 
keynum
 = 
Œª§ùiÚš£¹key£qu’û
.
	`ÃxtV®ue
();

841 
Œy
 {

842 
SŒšg
 
dbkey
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

844 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
	`budV®ues
(
dbkey
);

845 
db
.
	`š£¹
(
bË
, 
dbkey
, 
v®ues
);

846 } 
fš®ly
 {

847 
Œª§ùiÚš£¹key£qu’û
.
	`acknowËdge
(
keynum
);

849 
	}
}

861 
´Ùeùed
 
Disü‘eG’”©Ü
 
	$ü—‹O³¿tiÚG’”©Ü
(
fš®
 
Prİ”t›s
 
p
) {

862 ià(
p
 =ğ
nuÎ
) {

863 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Properties object cannot be‚ull");

865 
fš®
 
»ad´İÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

866 
p
.
	`g‘Prİ”ty
(
READ_PROPORTION_PROPERTY
, 
READ_PROPORTION_PROPERTY_DEFAULT
));

867 
fš®
 
upd©•rİÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

868 
p
.
	`g‘Prİ”ty
(
UPDATE_PROPORTION_PROPERTY
, 
UPDATE_PROPORTION_PROPERTY_DEFAULT
));

869 
fš®
 
š£¹´İÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

870 
p
.
	`g‘Prİ”ty
(
INSERT_PROPORTION_PROPERTY
, 
INSERT_PROPORTION_PROPERTY_DEFAULT
));

871 
fš®
 
sÿÅrİÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

872 
p
.
	`g‘Prİ”ty
(
SCAN_PROPORTION_PROPERTY
, 
SCAN_PROPORTION_PROPERTY_DEFAULT
));

873 
fš®
 
»admodifywr™•rİÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(

874 
READMODIFYWRITE_PROPORTION_PROPERTY
, 
READMODIFYWRITE_PROPORTION_PROPERTY_DEFAULT
));

876 
fš®
 
Disü‘eG’”©Ü
 
İ”©iÚchoo£r
 = 
Ãw
 
	`Disü‘eG’”©Ü
();

877 ià(
»ad´İÜtiÚ
 > 0) {

878 
İ”©iÚchoo£r
.
	`addV®ue
(
»ad´İÜtiÚ
, "READ");

881 ià(
upd©•rİÜtiÚ
 > 0) {

882 
İ”©iÚchoo£r
.
	`addV®ue
(
upd©•rİÜtiÚ
, "UPDATE");

885 ià(
š£¹´İÜtiÚ
 > 0) {

886 
İ”©iÚchoo£r
.
	`addV®ue
(
š£¹´İÜtiÚ
, "INSERT");

889 ià(
sÿÅrİÜtiÚ
 > 0) {

890 
İ”©iÚchoo£r
.
	`addV®ue
(
sÿÅrİÜtiÚ
, "SCAN");

893 ià(
»admodifywr™•rİÜtiÚ
 > 0) {

894 
İ”©iÚchoo£r
.
	`addV®ue
(
»admodifywr™•rİÜtiÚ
, "READMODIFYWRITE");

896  
İ”©iÚchoo£r
;

897 
	}
}

	@core/src/main/java/site/ycsb/workloads/RestWorkload.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gRªdomBy‹I‹¿tÜ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.*;

26 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

27 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

28 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnifÜmLÚgG’”©Ü
;

42 
public
 cÏs 
	cRe¡WÜklßd
 
ex‹nds
 
	mCÜeWÜklßd
 {

48 
public
 
fš®
 
SŒšg
 
	mDELETE_PROPORTION_PROPERTY
 = "deleteproportion";

53 
public
 
fš®
 
SŒšg
 
	mDELETE_PROPORTION_PROPERTY_DEFAULT
 = "0.00";

58 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_FILE_PROPERTY
 = "fieldlengthdistfile";

63 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_FILE_PROPERTY_DEFAULT
 = "fieldLengthDistFile.txt";

73 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_TRACE_FILE
 = "url.trace.read";

74 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_TRACE_FILE_DEFAULT
 = "readtrace.txt";

75 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_ZIPFIAN_CONSTANT
 = "readzipfconstant";

76 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

77 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_RECORD_COUNT_PROPERTY
 = "readrecordcount";

79 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_TRACE_FILE
 = "url.trace.insert";

80 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_TRACE_FILE_DEFAULT
 = "inserttrace.txt";

81 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_ZIPFIAN_CONSTANT
 = "insertzipfconstant";

82 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

83 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_SIZE_ZIPFIAN_CONSTANT
 = "insertsizezipfconstant";

84 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_SIZE_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

85 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_RECORD_COUNT_PROPERTY
 = "insertrecordcount";

87 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_TRACE_FILE
 = "url.trace.delete";

88 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_TRACE_FILE_DEFAULT
 = "deletetrace.txt";

89 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_ZIPFIAN_CONSTANT
 = "deletezipfconstant";

90 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

91 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_RECORD_COUNT_PROPERTY
 = "deleterecordcount";

93 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_TRACE_FILE
 = "url.trace.update";

94 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_TRACE_FILE_DEFAULT
 = "updatetrace.txt";

95 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_ZIPFIAN_CONSTANT
 = "updatezipfconstant";

96 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

97 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_RECORD_COUNT_PROPERTY
 = "updaterecordcount";

99 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	m»adU¾M­
;

100 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	mš£¹U¾M­
;

101 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	md–‘eU¾M­
;

102 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	mupd©eU¾M­
;

103 
´iv©e
 
	m»adRecÜdCouÁ
;

104 
´iv©e
 
	mš£¹RecÜdCouÁ
;

105 
´iv©e
 
	md–‘eRecÜdCouÁ
;

106 
´iv©e
 
	mupd©eRecÜdCouÁ
;

107 
´iv©e
 
Numb”G’”©Ü
 
	m»adKeyChoo£r
;

108 
´iv©e
 
Numb”G’”©Ü
 
	mš£¹KeyChoo£r
;

109 
´iv©e
 
Numb”G’”©Ü
 
	md–‘eKeyChoo£r
;

110 
´iv©e
 
Numb”G’”©Ü
 
	mupd©eKeyChoo£r
;

111 
´iv©e
 
Numb”G’”©Ü
 
	mf›ldËngthg’”©Ü
;

112 
´iv©e
 
Disü‘eG’”©Ü
 
	mİ”©iÚchoo£r
;

114 @
Ov”ride


115 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

117 
»adRecÜdCouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
READ_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(IÁeg”.
MAX_VALUE
)));

118 
š£¹RecÜdCouÁ
 = 
IÁeg”


119 .
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
INSERT_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
IÁeg”
.
MAX_VALUE
)));

120 
d–‘eRecÜdCouÁ
 = 
IÁeg”


121 .
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
DELETE_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
IÁeg”
.
MAX_VALUE
)));

122 
upd©eRecÜdCouÁ
 = 
IÁeg”


123 .
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
UPDATE_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
IÁeg”
.
MAX_VALUE
)));

125 
»adU¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
READ_TRACE_FILE
, 
READ_TRACE_FILE_DEFAULT
), 
»adRecÜdCouÁ
);

126 
š£¹U¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
INSERT_TRACE_FILE
, 
INSERT_TRACE_FILE_DEFAULT
), 
š£¹RecÜdCouÁ
);

127 
d–‘eU¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
DELETE_TRACE_FILE
, 
DELETE_TRACE_FILE_DEFAULT
), 
d–‘eRecÜdCouÁ
);

128 
upd©eU¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
UPDATE_TRACE_FILE
, 
UPDATE_TRACE_FILE_DEFAULT
), 
upd©eRecÜdCouÁ
);

130 
İ”©iÚchoo£r
 = 
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

133 
SŒšg
 
»que¡Di¡rib
 = 
p
.
	`g‘Prİ”ty
(
REQUEST_DISTRIBUTION_PROPERTY
, 
REQUEST_DISTRIBUTION_PROPERTY_DEFAULT
);

135 
»adZfcÚ¡ªt
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
READ_ZIPFIAN_CONSTANT
, 
READ_ZIPFIAN_CONSTANT_DEAFULT
));

136 
»adKeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
»adU¾M­
.
	`size
(), 
»adZfcÚ¡ªt
, 
p
);

137 
upd©eZfcÚ¡ªt
 = 
DoubË


138 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
UPDATE_ZIPFIAN_CONSTANT
, 
UPDATE_ZIPFIAN_CONSTANT_DEAFULT
));

139 
upd©eKeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
upd©eU¾M­
.
	`size
(), 
upd©eZfcÚ¡ªt
, 
p
);

140 
š£¹ZfcÚ¡ªt
 = 
DoubË


141 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
INSERT_ZIPFIAN_CONSTANT
, 
INSERT_ZIPFIAN_CONSTANT_DEAFULT
));

142 
š£¹KeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
š£¹U¾M­
.
	`size
(), 
š£¹ZfcÚ¡ªt
, 
p
);

143 
d–‘eZfcÚ¡ªt
 = 
DoubË


144 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
DELETE_ZIPFIAN_CONSTANT
, 
DELETE_ZIPFIAN_CONSTANT_DEAFULT
));

145 
d–‘eKeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
d–‘eU¾M­
.
	`size
(), 
d–‘eZfcÚ¡ªt
, 
p
);

147 
f›ldËngthg’”©Ü
 = 
	`g‘F›ldL’gthG’”©Ü
(
p
);

150 
public
 
Disü‘eG’”©Ü
 
	$ü—‹O³¿tiÚG’”©Ü
(
fš®
 
Prİ”t›s
 
p
) {

152 
fš®
 
Disü‘eG’”©Ü
 
İ”©iÚChoo£r
 = 
CÜeWÜklßd
.
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

154 
d–‘•rİÜtiÚ
 = 
DoubË


155 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
DELETE_PROPORTION_PROPERTY
, 
DELETE_PROPORTION_PROPERTY_DEFAULT
));

156 ià(
d–‘•rİÜtiÚ
 > 0) {

157 
İ”©iÚChoo£r
.
	`addV®ue
(
d–‘•rİÜtiÚ
, "DELETE");

159  
İ”©iÚChoo£r
;

160 
	}
}

162 
´iv©e
 
Numb”G’”©Ü
 
	$g‘KeyChoo£r
(
SŒšg
 
»que¡Di¡rib
, 
»cÜdCouÁ
, 
zfCÚÁ
,

163 
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

164 
Numb”G’”©Ü
 
keychoo£r
;

166 
»que¡Di¡rib
) {

168 
³rûÁe
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_PROPERTY
,

169 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_DEFAULT
));

170 
äac
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_PROPERTY
,

171 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_DEFAULT
));

172 
keychoo£r
 = 
Ãw
 
	`ExpÚ’tŸlG’”©Ü
(
³rûÁe
, 
»cÜdCouÁ
 * 
äac
);

175 
keychoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(0, 
»cÜdCouÁ
 - 1);

178 
keychoo£r
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
»cÜdCouÁ
, 
zfCÚÁ
);

181 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Latest„equest distribution is‚ot supported for RestWorkload.");

183 
hÙ£täaùiÚ
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_DATA_FRACTION
, 
HOTSPOT_DATA_FRACTION_DEFAULT
));

184 
hÙİnäaùiÚ
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_OPN_FRACTION
, 
HOTSPOT_OPN_FRACTION_DEFAULT
));

185 
keychoo£r
 = 
Ãw
 
	`HÙ¥ÙIÁeg”G’”©Ü
(0, 
»cÜdCouÁ
 - 1, 
hÙ£täaùiÚ
, 
hÙİnäaùiÚ
);

188 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀ»que¡ di¡ributiÚ \"" + 
»que¡Di¡rib
 + "\"");

190  
keychoo£r
;

191 
	}
}

193 
´Ùeùed
 
Numb”G’”©Ü
 
	$g‘F›ldL’gthG’”©Ü
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

195 
Numb”G’”©Ü
 
f›ldL’gthG’”©Ü
 = 
CÜeWÜklßd
.
	`g‘F›ldL’gthG’”©Ü
(
p
);

196 
SŒšg
 
f›ldËngthdi¡ributiÚ
 = 
p
.
	`g‘Prİ”ty
(
FIELD_LENGTH_DISTRIBUTION_PROPERTY
,

197 
FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

199 ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("zipfian") == 0) {

200 
f›ldËngth
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
FIELD_LENGTH_PROPERTY
, 
FIELD_LENGTH_PROPERTY_DEFAULT
));

201 
š£¹sizezfcÚ¡ªt
 = 
DoubË


202 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
INSERT_SIZE_ZIPFIAN_CONSTANT
, 
INSERT_SIZE_ZIPFIAN_CONSTANT_DEAFULT
));

203 
f›ldL’gthG’”©Ü
 = 
Ãw
 
	`ZfŸnG’”©Ü
(1, 
f›ldËngth
, 
š£¹sizezfcÚ¡ªt
);

205  
f›ldL’gthG’”©Ü
;

206 
	}
}

211 
´iv©e
 
	gM­
<
	gIÁeg”
, 
	gSŒšg
> 
	$g‘T¿û
(
SŒšg
 
feP©h
, 
»cÜdCouÁ
)

212 
throws
 
WÜklßdExû±iÚ
 {

213 
M­
<
IÁeg”
, 
SŒšg
> 
u¾M­
 = 
Ãw
 
HashM­
<Integer, String>();

214 
couÁ
 = 0;

215 
SŒšg
 
lše
;

216 
Œy
 {

217 
FeR—d”
 
šputFe
 = 
Ãw
 
	`FeR—d”
(
feP©h
);

218 
Bufã»dR—d”
 
bufãrR—d”
 = 
Ãw
 
	`Bufã»dR—d”
(
šputFe
);

219 (
lše
 = 
bufãrR—d”
.
	`»adLše
()è!ğ
nuÎ
) {

220 
u¾M­
.
	`put
(
couÁ
++, 
lše
.
	`Œim
());

221 ià(
couÁ
 >ğ
»cÜdCouÁ
) {

225 
bufãrR—d”
.
	`şo£
();

226 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

227 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

229 + 
e
.
	`g‘LoÿlizedMes§ge
());

231  
u¾M­
;

232 
	}
}

237 @
Ov”ride


238 
public
 
boŞ—n
 
	$doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

239  
çl£
;

240 
	}
}

242 @
Ov”ride


243 
public
 
boŞ—n
 
	$doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

244 
SŒšg
 
İ”©iÚ
 = 
İ”©iÚchoo£r
.
	`ÃxtSŒšg
();

245 ià(
İ”©iÚ
 =ğ
nuÎ
) {

246  
çl£
;

249 
İ”©iÚ
) {

251 
	`doT¿n§ùiÚUpd©e
(
db
);

254 
	`doT¿n§ùiÚIn£¹
(
db
);

257 
	`doT¿n§ùiÚD–‘e
(
db
);

260 
	`doT¿n§ùiÚR—d
(
db
);

262  
Œue
;

263 
	}
}

268 
´iv©e
 
SŒšg
 
	$g‘NextURL
(
İTy³
) {

269 ià(
İTy³
 == 1) {

270  
»adU¾M­
.
	`g‘
(
»adKeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

271 } ià(
İTy³
 == 2) {

272  
š£¹U¾M­
.
	`g‘
(
š£¹KeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

273 } ià(
İTy³
 == 3) {

274  
d–‘eU¾M­
.
	`g‘
(
d–‘eKeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

276  
upd©eU¾M­
.
	`g‘
(
upd©eKeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

278 
	}
}

280 @
Ov”ride


281 
public
 
	$doT¿n§ùiÚR—d
(
DB
 
db
) {

282 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

283 
db
.
	`»ad
(
nuÎ
, 
	`g‘NextURL
(1),‚uÎ, 
»suÉ
);

284 
	}
}

286 @
Ov”ride


287 
public
 
	$doT¿n§ùiÚIn£¹
(
DB
 
db
) {

288 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ue
 = 
Ãw
 HashMap<String, ByteIterator>();

290 
v®ue
.
	`put
("d©a", 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
()));

291 
db
.
	`š£¹
(
nuÎ
, 
	`g‘NextURL
(2), 
v®ue
);

292 
	}
}

294 
public
 
	$doT¿n§ùiÚD–‘e
(
DB
 
db
) {

295 
db
.
	`d–‘e
(
nuÎ
, 
	`g‘NextURL
(3));

296 
	}
}

298 @
Ov”ride


299 
public
 
	$doT¿n§ùiÚUpd©e
(
DB
 
db
) {

300 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ue
 = 
Ãw
 HashMap<String, ByteIterator>();

302 
v®ue
.
	`put
("d©a", 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
()));

303 
db
.
	`upd©e
(
nuÎ
, 
	`g‘NextURL
(4), 
v®ue
);

304 
	}
}

	@core/src/main/java/site/ycsb/workloads/TimeSeriesWorkload.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

19 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

24 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

25 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
impÜt
 
	gjava
.
	gut
.
	gT»eM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

32 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

34 
impÜt
 
	gs™e
.
	gycsb
.
	gNum”icBy‹I‹¿tÜ
;

35 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßd
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gDisü‘eG’”©Ü
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gG’”©Ü
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gHÙ¥ÙIÁeg”G’”©Ü
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gInüem’tšgPršbËSŒšgG’”©Ü
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gNumb”G’”©Ü
;

45 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gRªdomDisü‘eTime¡ampG’”©Ü
;

46 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gSüambËdZfŸnG’”©Ü
;

47 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gSequ’tŸlG’”©Ü
;

48 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnifÜmLÚgG’”©Ü
;

49 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnixEpochTime¡ampG’”©Ü
;

50 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gZfŸnG’”©Ü
;

51 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

284 
public
 cÏs 
	cTimeS”›sWÜklßd
 
ex‹nds
 
	mWÜklßd
 {

289 
public
 
	eV®ueTy³
 {

290 
INTEGERS
("integers"),

291 
FLOATS
("floats"),

292 
MIXED
("mixednumbers");

294 
´Ùeùed
 
fš®
 
SŒšg
 
	mÇme
;

296 
V®ueTy³
(
fš®
 
SŒšg
 
Çme
) {

297 
	mthis
.
	mÇme
 = 
Çme
;

300 
public
 
V®ueTy³
 
äomSŒšg
(
fš®
 
SŒšg
 
Çme
) {

301 
fš®
 
V®ueTy³
 
	mty³
 : V®ueTy³.
v®ues
()) {

302 ià(
ty³
.
Çme
.
equ®sIgnÜeCa£
(name)) {

303  
ty³
;

306 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("UÄecognizedy³: " + 
Çme
);

311 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_KEY_PROPERTY
 = "timestampkey";

312 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_KEY_PROPERTY_DEFAULT
 = "YCSBTS";

315 
public
 
fš®
 
SŒšg
 
	gVALUE_KEY_PROPERTY
 = "valuekey";

316 
public
 
fš®
 
SŒšg
 
	gVALUE_KEY_PROPERTY_DEFAULT
 = "YCSBV";

319 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_INTERVAL_PROPERTY
 = "timestampinterval";

320 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_INTERVAL_PROPERTY_DEFAULT
 = "60";

323 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_UNITS_PROPERTY
 = "timestampunits";

324 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_UNITS_PROPERTY_DEFAULT
 = "SECONDS";

327 
public
 
fš®
 
SŒšg
 
	gTAG_COUNT_PROPERTY
 = "tagcount";

328 
public
 
fš®
 
SŒšg
 
	gTAG_COUNT_PROPERTY_DEFAULT
 = "4";

331 
public
 
fš®
 
SŒšg
 
	gTAG_CARDINALITY_PROPERTY
 = "tagcardinality";

332 
public
 
fš®
 
SŒšg
 
	gTAG_CARDINALITY_PROPERTY_DEFAULT
 = "1, 2, 4, 8";

335 
public
 
fš®
 
SŒšg
 
	gTAG_KEY_LENGTH_PROPERTY
 = "tagkeylength";

336 
public
 
fš®
 
SŒšg
 
	gTAG_KEY_LENGTH_PROPERTY_DEFAULT
 = "8";

339 
public
 
fš®
 
SŒšg
 
	gTAG_VALUE_LENGTH_PROPERTY
 = "tagvaluelength";

340 
public
 
fš®
 
SŒšg
 
	gTAG_VALUE_LENGTH_PROPERTY_DEFAULT
 = "8";

343 
public
 
fš®
 
SŒšg
 
	gPAIR_DELIMITER_PROPERTY
 = "tagpairdelimiter";

344 
public
 
fš®
 
SŒšg
 
	gPAIR_DELIMITER_PROPERTY_DEFAULT
 = "=";

347 
public
 
fš®
 
SŒšg
 
	gDELETE_DELIMITER_PROPERTY
 = "deletedelimiter";

348 
public
 
fš®
 
SŒšg
 
	gDELETE_DELIMITER_PROPERTY_DEFAULT
 = ":";

351 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESTAMP_ORDER_PROPERTY
 = "randomwritetimestamporder";

352 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESTAMP_ORDER_PROPERTY_DEFAULT
 = "false";

355 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESERIES_ORDER_PROPERTY
 = "randomtimeseriesorder";

356 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESERIES_ORDER_PROPERTY_DEFAULT
 = "true";

359 
public
 
fš®
 
SŒšg
 
	gVALUE_TYPE_PROPERTY
 = "valuetype";

360 
public
 
fš®
 
SŒšg
 
	gVALUE_TYPE_PROPERTY_DEFAULT
 = "floats";

363 
public
 
fš®
 
SŒšg
 
	gSPARSITY_PROPERTY
 = "sparsity";

364 
public
 
fš®
 
SŒšg
 
	gSPARSITY_PROPERTY_DEFAULT
 = "0.00";

367 
public
 
fš®
 
SŒšg
 
	gDELAYED_SERIES_PROPERTY
 = "delayedseries";

368 
public
 
fš®
 
SŒšg
 
	gDELAYED_SERIES_PROPERTY_DEFAULT
 = "0.10";

371 
public
 
fš®
 
SŒšg
 
	gDELAYED_INTERVALS_PROPERTY
 = "delayedintervals";

372 
public
 
fš®
 
SŒšg
 
	gDELAYED_INTERVALS_PROPERTY_DEFAULT
 = "5";

375 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_PROPERTY
 = "querytimespan";

376 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_PROPERTY_DEFAULT
 = "0";

379 
public
 
fš®
 
SŒšg
 
	gQUERY_RANDOM_TIMESPAN_PROPERTY
 = "queryrandomtimespan";

380 
public
 
fš®
 
SŒšg
 
	gQUERY_RANDOM_TIMESPAN_PROPERTY_DEFAULT
 = "false";

383 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_DELIMITER_PROPERTY
 = "querytimespandelimiter";

384 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
 = ",";

387 
public
 
fš®
 
SŒšg
 
	gGROUPBY_KEY_PROPERTY
 = "groupbykey";

388 
public
 
fš®
 
SŒšg
 
	gGROUPBY_KEY_PROPERTY_DEFAULT
 = "YCSBGB";

391 
public
 
fš®
 
SŒšg
 
	gGROUPBY_PROPERTY
 = "groupbyfunction";

394 
public
 
fš®
 
SŒšg
 
	gGROUPBY_KEYS_PROPERTY
 = "groupbykeys";

397 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_KEY_PROPERTY
 = "downsamplingkey";

398 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_KEY_PROPERTY_DEFAULT
 = "YCSBDS";

401 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_FUNCTION_PROPERTY
 = "downsamplingfunction";

404 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_INTERVAL_PROPERTY
 = "downsamplinginterval";

407 
´Ùeùed
 
Prİ”t›s
 
	g´İ”t›s
;

410 
´Ùeùed
 
	gG’”©Ü
<
	gSŒšg
> 
	gkeyG’”©Ü
;

411 
´Ùeùed
 
	gG’”©Ü
<
	gSŒšg
> 
	ggKeyG’”©Ü
;

412 
´Ùeùed
 
	gG’”©Ü
<
	gSŒšg
> 
	ggV®ueG’”©Ü
;

415 
´Ùeùed
 
SŒšg
 
	gtime¡ampKey
;

418 
´Ùeùed
 
SŒšg
 
	gv®ueKey
;

421 
´Ùeùed
 
	gtime¡ampIÁ”v®
;

424 
´Ùeùed
 
TimeUn™
 
	gtimeUn™s
;

427 
´Ùeùed
 
boŞ—n
 
	g¿ndomizeTime¡ampOrd”
;

431 
´Ùeùed
 
boŞ—n
 
	g¿ndomizeTime£r›sOrd”
;

434 
´Ùeùed
 
V®ueTy³
 
	gv®ueTy³
;

437 
´Ùeùed
 [] 
	gcumuÏtiveC¬dš®™y
;

440 
´Ùeùed
 
	gtÙ®C¬dš®™y
;

444 
´Ùeùed
 
	g³rKeyC¬dš®™y
;

447 
´Ùeùed
 
Numb”G’”©Ü
 
	gsÿÆ’gth
;

450 
´Ùeùed
 
Numb”G’”©Ü
 
	gkeychoo£r
;

453 
´Ùeùed
 
Disü‘eG’”©Ü
 
	gİ”©iÚchoo£r
;

457 
´Ùeùed
 
	gmaxOff£ts
;

460 
´Ùeùed
 
	g»cÜdcouÁ
;

463 
´Ùeùed
 
	ggPaœs
;

466 
´Ùeùed
 
SŒšg
 
	gbË
;

469 
´Ùeùed
 
	gnumKeys
;

472 
´Ùeùed
 
	gSŒšg
[] 
	gkeys
;

475 
´Ùeùed
 
	gSŒšg
[] 
	ggKeys
;

478 
´Ùeùed
 
	gSŒšg
[] 
	ggV®ues
;

481 
´Ùeùed
 [] 
	ggC¬dš®™y
;

484 
´Ùeùed
 
	gfœ¡Inüem’bËC¬dš®™y
;

487 
´Ùeùed
 
	g¥¬s™y
;

490 
´Ùeùed
 
	gd–ayedS”›s
;

493 
´Ùeùed
 
	gd–ayedIÁ”v®s
;

496 
´Ùeùed
 
	gqu”yTimeS·n
;

500 
´Ùeùed
 
boŞ—n
 
	gqu”yRªdomTimeS·n
;

503 
´Ùeùed
 
SŒšg
 
	ggPaœD–im™”
;

506 
´Ùeùed
 
SŒšg
 
	gd–‘eD–im™”
;

509 
´Ùeùed
 
SŒšg
 
	gqu”yTimeS·nD–im™”
;

512 
´Ùeùed
 
boŞ—n
 
	ggroupBy
;

515 
´Ùeùed
 
SŒšg
 
	ggroupByKey
;

518 
´Ùeùed
 
SŒšg
 
	ggroupByFunùiÚ
;

521 
´Ùeùed
 
	gboŞ—n
[] 
	ggroupBys
;

524 
´Ùeùed
 
boŞ—n
 
	gdown§m¶e
;

527 
´Ùeùed
 
SŒšg
 
	gdown§m¶eKey
;

530 
´Ùeùed
 
SŒšg
 
	gdown§m¶eFunùiÚ
;

533 
´Ùeùed
 
	gdown§m¶eIÁ”v®
;

539 
´Ùeùed
 
boŞ—n
 
	gd©aš‹gr™y
;

542 
´Ùeùed
 
M—su»m’ts
 
	gm—su»m’ts
 = M—su»m’ts.
g‘M—su»m’ts
();

544 @
Ov”ride


545 
public
 
	$š™
(
fš®
 
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

546 
´İ”t›s
 = 
p
;

547 
»cÜdcouÁ
 =

548 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
,

549 
Cl›Á
.
DEFAULT_RECORD_COUNT
));

550 ià(
»cÜdcouÁ
 == 0) {

551 
»cÜdcouÁ
 = 
IÁeg”
.
MAX_VALUE
;

553 
time¡ampKey
 = 
p
.
	`g‘Prİ”ty
(
TIMESTAMP_KEY_PROPERTY
, 
TIMESTAMP_KEY_PROPERTY_DEFAULT
);

554 
v®ueKey
 = 
p
.
	`g‘Prİ”ty
(
VALUE_KEY_PROPERTY
, 
VALUE_KEY_PROPERTY_DEFAULT
);

555 
İ”©iÚchoo£r
 = 
CÜeWÜklßd
.
	`ü—‹O³¿tiÚG’”©Ü
(
´İ”t›s
);

557 
fš®
 
maxsÿÆ’gth
 =

558 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
MAX_SCAN_LENGTH_PROPERTY
,

559 
CÜeWÜklßd
.
MAX_SCAN_LENGTH_PROPERTY_DEFAULT
));

560 
SŒšg
 
sÿÆ’gthdi¡rib
 =

561 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
SCAN_LENGTH_DISTRIBUTION_PROPERTY
,

562 
CÜeWÜklßd
.
SCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

564 ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("uniform") == 0) {

565 
sÿÆ’gth
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(1, 
maxsÿÆ’gth
);

566 } ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("zipfian") == 0) {

567 
sÿÆ’gth
 = 
Ãw
 
	`ZfŸnG’”©Ü
(1, 
maxsÿÆ’gth
);

569 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

570 "Di¡ributiÚ \"" + 
sÿÆ’gthdi¡rib
 + "\"‚ot‡llowed for scan†ength");

573 
¿ndomizeTime¡ampOrd”
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
p
.
	`g‘Prİ”ty
(

574 
RANDOMIZE_TIMESTAMP_ORDER_PROPERTY
,

575 
RANDOMIZE_TIMESTAMP_ORDER_PROPERTY_DEFAULT
));

576 
¿ndomizeTime£r›sOrd”
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
p
.
	`g‘Prİ”ty
(

577 
RANDOMIZE_TIMESERIES_ORDER_PROPERTY
,

578 
RANDOMIZE_TIMESERIES_ORDER_PROPERTY_DEFAULT
));

581 
numKeys
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
,

582 
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY_DEFAULT
));

583 
gPaœs
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
TAG_COUNT_PROPERTY
,

584 
TAG_COUNT_PROPERTY_DEFAULT
));

585 
¥¬s™y
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
SPARSITY_PROPERTY
, 
SPARSITY_PROPERTY_DEFAULT
));

586 
gC¬dš®™y
 = 
Ãw
 [
gPaœs
];

588 
fš®
 
SŒšg
 
»que¡di¡rib
 =

589 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
REQUEST_DISTRIBUTION_PROPERTY
,

590 
CÜeWÜklßd
.
REQUEST_DISTRIBUTION_PROPERTY_DEFAULT
);

591 ià(
»que¡di¡rib
.
	`com·»To
("uniform") == 0) {

592 
keychoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(0, 
numKeys
 - 1);

593 } ià(
»que¡di¡rib
.
	`com·»To
("sequential") == 0) {

594 
keychoo£r
 = 
Ãw
 
	`Sequ’tŸlG’”©Ü
(0, 
numKeys
 - 1);

595 } ià(
»que¡di¡rib
.
	`com·»To
("zipfian") == 0) {

596 
keychoo£r
 = 
Ãw
 
	`SüambËdZfŸnG’”©Ü
(0, 
numKeys
 - 1);

599 } ià(
»que¡di¡rib
.
	`equ®s
("hotspot")) {

600 
hÙ£täaùiÚ
 =

601 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
HOTSPOT_DATA_FRACTION
,

602 
CÜeWÜklßd
.
HOTSPOT_DATA_FRACTION_DEFAULT
));

603 
hÙİnäaùiÚ
 =

604 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
HOTSPOT_OPN_FRACTION
,

605 
CÜeWÜklßd
.
HOTSPOT_OPN_FRACTION_DEFAULT
));

606 
keychoo£r
 = 
Ãw
 
	`HÙ¥ÙIÁeg”G’”©Ü
(0, 
numKeys
 - 1,

607 
hÙ£täaùiÚ
, 
hÙİnäaùiÚ
);

609 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀ»que¡ di¡ributiÚ \"" + 
»que¡di¡rib
 + "\"");

613 
Œy
 {

614 
time¡ampIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(

615 
TIMESTAMP_INTERVAL_PROPERTY
, 
TIMESTAMP_INTERVAL_PROPERTY_DEFAULT
));

616 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

617 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Unableo…arsehe " +

618 
TIMESTAMP_INTERVAL_PROPERTY
, 
nã
);

621 
Œy
 {

622 
timeUn™s
 = 
TimeUn™
.
	`v®ueOf
(
p
.
	`g‘Prİ”ty
(
TIMESTAMP_UNITS_PROPERTY
,

623 
TIMESTAMP_UNITS_PROPERTY_DEFAULT
).
	`toUµ”Ca£
());

624 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

625 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀtimun™y³", 
e
);

627 ià(
timeUn™s
 =ğ
TimeUn™
.
NANOSECONDS
 ||imeUn™ =ğTimeUn™.
MICROSECONDS
) {

628 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("YCSB dÛ¢'ˆsuµÜˆ" + 
timeUn™s
 +

632 
gPaœD–im™”
 = 
p
.
	`g‘Prİ”ty
(
PAIR_DELIMITER_PROPERTY
, 
PAIR_DELIMITER_PROPERTY_DEFAULT
);

633 
d–‘eD–im™”
 = 
p
.
	`g‘Prİ”ty
(
DELETE_DELIMITER_PROPERTY
, 
DELETE_DELIMITER_PROPERTY_DEFAULT
);

634 
d©aš‹gr™y
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

635 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
DATA_INTEGRITY_PROPERTY
,

636 
CÜeWÜklßd
.
DATA_INTEGRITY_PROPERTY_DEFAULT
));

637 ià(
d©aš‹gr™y
) {

638 
Sy¡em
.
out
.
	`´šn
("Data integrity isƒnabled.");

641 
qu”yTimeS·n
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
QUERY_TIMESPAN_PROPERTY
,

642 
QUERY_TIMESPAN_PROPERTY_DEFAULT
));

643 
qu”yRªdomTimeS·n
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
p
.
	`g‘Prİ”ty
(
QUERY_RANDOM_TIMESPAN_PROPERTY
,

644 
QUERY_RANDOM_TIMESPAN_PROPERTY_DEFAULT
));

645 
qu”yTimeS·nD–im™”
 = 
p
.
	`g‘Prİ”ty
(
QUERY_TIMESPAN_DELIMITER_PROPERTY
,

646 
QUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
);

648 
groupByKey
 = 
p
.
	`g‘Prİ”ty
(
GROUPBY_KEY_PROPERTY
, 
GROUPBY_KEY_PROPERTY_DEFAULT
);

649 
groupByFunùiÚ
 = 
p
.
	`g‘Prİ”ty
(
GROUPBY_PROPERTY
);

650 ià(
groupByFunùiÚ
 !ğ
nuÎ
 && !groupByFunùiÚ.
	`isEm±y
()) {

651 
fš®
 
SŒšg
 
groupByKeys
 = 
p
.
	`g‘Prİ”ty
(
GROUPBY_KEYS_PROPERTY
);

652 ià(
groupByKeys
 =ğ
nuÎ
 || groupByKeys.
	`isEm±y
()) {

653 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Group by wasƒnabled but‚o keys were specified.");

655 
fš®
 
SŒšg
[] 
gbKeys
 = 
groupByKeys
.
	`¥l™
(",");

656 ià(
gbKeys
.
Ëngth
 !ğ
gKeys
.length) {

657 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("OÆy " + 
gbKeys
.
Ëngth
 + " group by keys "

658 + "w”¥ecif›d buˆth”w”" + 
gKeys
.
Ëngth
 + "ag keys given.");

660 
groupBys
 = 
Ãw
 
boŞ—n
[
gbKeys
.
Ëngth
];

661 
i
 = 0; i < 
gbKeys
.
Ëngth
; i++) {

662 
groupBys
[
i
] = 
IÁeg”
.
	`·r£IÁ
(
gbKeys
[i].
	`Œim
()è=ğ0 ? 
çl£
 : 
Œue
;

664 
groupBy
 = 
Œue
;

667 
down§m¶eKey
 = 
p
.
	`g‘Prİ”ty
(
DOWNSAMPLING_KEY_PROPERTY
, 
DOWNSAMPLING_KEY_PROPERTY_DEFAULT
);

668 
down§m¶eFunùiÚ
 = 
p
.
	`g‘Prİ”ty
(
DOWNSAMPLING_FUNCTION_PROPERTY
);

669 ià(
down§m¶eFunùiÚ
 !ğ
nuÎ
 && !down§m¶eFunùiÚ.
	`isEm±y
()) {

670 
fš®
 
SŒšg
 
š‹rv®
 = 
p
.
	`g‘Prİ”ty
(
DOWNSAMPLING_INTERVAL_PROPERTY
);

671 ià(
š‹rv®
 =ğ
nuÎ
 || iÁ”v®.
	`isEm±y
()) {

672 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("'" + 
DOWNSAMPLING_INTERVAL_PROPERTY
 + "' was missing despite '"

673 + 
DOWNSAMPLING_FUNCTION_PROPERTY
 + "' being set.");

675 
down§m¶eIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
š‹rv®
);

676 
down§m¶e
 = 
Œue
;

679 
d–ayedS”›s
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
DELAYED_SERIES_PROPERTY
, 
DELAYED_SERIES_PROPERTY_DEFAULT
));

680 
d–ayedIÁ”v®s
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
DELAYED_INTERVALS_PROPERTY
, 
DELAYED_INTERVALS_PROPERTY_DEFAULT
));

682 
v®ueTy³
 = 
V®ueTy³
.
	`äomSŒšg
(
p
.
	`g‘Prİ”ty
(
VALUE_TYPE_PROPERTY
, 
VALUE_TYPE_PROPERTY_DEFAULT
));

683 
bË
 = 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, CÜeWÜklßd.
TABLENAME_PROPERTY_DEFAULT
);

684 
	`š™KeysAndTags
();

685 
	`v®id©eS‘tšgs
();

686 
	}
}

688 @
Ov”ride


689 
public
 
Objeù
 
	$š™Th»ad
(
Prİ”t›s
 
p
, 
myth»adid
, 
th»adcouÁ
è
throws
 
WÜklßdExû±iÚ
 {

690 ià(
´İ”t›s
 =ğ
nuÎ
) {

691 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Workload has‚ot been initialized.");

693  
Ãw
 
	`Th»adS‹
(
myth»adid
, 
th»adcouÁ
);

694 
	}
}

696 @
Ov”ride


697 
public
 
boŞ—n
 
	$doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

698 ià(
th»ad¡©e
 =ğ
nuÎ
) {

699 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Missinghread state.");

701 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
gs
 = 
Ãw
 
T»eM­
<String, ByteIterator>();

702 
fš®
 
SŒšg
 
key
 = ((
Th»adS‹
)
th»ad¡©e
).
	`ÃxtD©aPošt
(
gs
, 
Œue
);

703 ià(
db
.
	`š£¹
(
bË
, 
key
, 
gs
è=ğ
Stus
.
OK
) {

704  
Œue
;

706  
çl£
;

707 
	}
}

709 @
Ov”ride


710 
public
 
boŞ—n
 
	$doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

711 ià(
th»ad¡©e
 =ğ
nuÎ
) {

712 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Missinghread state.");

714 
İ”©iÚchoo£r
.
	`ÃxtSŒšg
()) {

716 
	`doT¿n§ùiÚR—d
(
db
, 
th»ad¡©e
);

719 
	`doT¿n§ùiÚUpd©e
(
db
, 
th»ad¡©e
);

722 
	`doT¿n§ùiÚIn£¹
(
db
, 
th»ad¡©e
);

725 
	`doT¿n§ùiÚSÿn
(
db
, 
th»ad¡©e
);

728 
	`doT¿n§ùiÚD–‘e
(
db
, 
th»ad¡©e
);

731  
çl£
;

733  
Œue
;

734 
	}
}

736 
´Ùeùed
 
	$doT¿n§ùiÚR—d
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

737 
fš®
 
Th»adS‹
 
¡©e
 = (Th»adS‹è
th»ad¡©e
;

738 
fš®
 
SŒšg
 
keyÇme
 = 
keys
[
keychoo£r
.
	`ÃxtV®ue
().
	`štV®ue
()];

739 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

740 
off£ts
 = 
¡©e
.
qu”yOff£tG’”©Ü
.
	`ÃxtV®ue
().
	`štV®ue
();

742 
fš®
 
¡¬tTime¡amp
;

743 ià(
off£ts
 > 0) {

744 
¡¬tTime¡amp
 = 
¡©e
.¡¬tTime¡am°+ s‹.
time¡ampG’”©Ü
.
	`g‘Off£t
(
off£ts
);

746 
¡¬tTime¡amp
 = 
¡©e
.startTimestamp;

750 
S‘
<
SŒšg
> 
f›lds
 = 
Ãw
 
HashS‘
<String>();

751 
i
 = 0; i < 
gPaœs
; ++i) {

752 ià(
groupBy
 && 
groupBys
[
i
]) {

753 
f›lds
.
	`add
(
gKeys
[
i
]);

755 
f›lds
.
	`add
(
gKeys
[
i
] + 
gPaœD–im™”
 +

756 
gV®ues
[
¿ndom
.
	`ÃxtIÁ
(
gC¬dš®™y
[
i
])]);

760 ià(
qu”yTimeS·n
 > 0) {

761 
fš®
 
’dTime¡amp
;

762 ià(
qu”yRªdomTimeS·n
) {

763 
’dTime¡amp
 = 
¡¬tTime¡amp
 + (
time¡ampIÁ”v®
 * 
¿ndom
.
	`ÃxtIÁ
(
qu”yTimeS·n
 /imestampInterval));

765 
’dTime¡amp
 = 
¡¬tTime¡amp
 + 
qu”yTimeS·n
;

767 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
 + 
qu”yTimeS·nD–im™”
 + 
’dTime¡amp
);

769 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
);

771 ià(
groupBy
) {

772 
f›lds
.
	`add
(
groupByKey
 + 
gPaœD–im™”
 + 
groupByFunùiÚ
);

774 ià(
down§m¶e
) {

775 
f›lds
.
	`add
(
down§m¶eKey
 + 
gPaœD–im™”
 + 
down§m¶eFunùiÚ
 + 
down§m¶eIÁ”v®
);

778 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 
HashM­
<String, ByteIterator>();

779 
fš®
 
Stus
 
¡©us
 = 
db
.
	`»ad
(
bË
, 
keyÇme
, 
f›lds
, 
ûÎs
);

781 ià(
d©aš‹gr™y
 && 
¡©us
 =ğ
Stus
.
OK
) {

782 
	`v”ifyRow
(
keyÇme
, 
ûÎs
);

784 
	}
}

786 
´Ùeùed
 
	$doT¿n§ùiÚUpd©e
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

787 ià(
th»ad¡©e
 =ğ
nuÎ
) {

788 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Missinghread state.");

790 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
gs
 = 
Ãw
 
T»eM­
<String, ByteIterator>();

791 
fš®
 
SŒšg
 
key
 = ((
Th»adS‹
)
th»ad¡©e
).
	`ÃxtD©aPošt
(
gs
, 
çl£
);

792 
db
.
	`upd©e
(
bË
, 
key
, 
gs
);

793 
	}
}

795 
´Ùeùed
 
	$doT¿n§ùiÚIn£¹
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

796 
	`doIn£¹
(
db
, 
th»ad¡©e
);

797 
	}
}

799 
´Ùeùed
 
	$doT¿n§ùiÚSÿn
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

800 
fš®
 
Th»adS‹
 
¡©e
 = (Th»adS‹è
th»ad¡©e
;

801 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

802 
fš®
 
SŒšg
 
keyÇme
 = 
keys
[
¿ndom
.
	`ÃxtIÁ
(keys.
Ëngth
)];

805 
Ën
 = 
sÿÆ’gth
.
	`ÃxtV®ue
().
	`štV®ue
();

807 
off£ts
 = 
¿ndom
.
	`ÃxtIÁ
(
maxOff£ts
 - 1);

808 
fš®
 
¡¬tTime¡amp
;

809 ià(
off£ts
 > 0) {

810 
¡¬tTime¡amp
 = 
¡©e
.¡¬tTime¡am°+ s‹.
time¡ampG’”©Ü
.
	`g‘Off£t
(
off£ts
);

812 
¡¬tTime¡amp
 = 
¡©e
.startTimestamp;

816 
S‘
<
SŒšg
> 
f›lds
 = 
Ãw
 
HashS‘
<String>();

817 
i
 = 0; i < 
gPaœs
; ++i) {

818 ià(
groupBy
 && 
groupBys
[
i
]) {

819 
f›lds
.
	`add
(
gKeys
[
i
]);

821 
f›lds
.
	`add
(
gKeys
[
i
] + 
gPaœD–im™”
 +

822 
gV®ues
[
¿ndom
.
	`ÃxtIÁ
(
gC¬dš®™y
[
i
])]);

826 ià(
qu”yTimeS·n
 > 0) {

827 
fš®
 
’dTime¡amp
;

828 ià(
qu”yRªdomTimeS·n
) {

829 
’dTime¡amp
 = 
¡¬tTime¡amp
 + (
time¡ampIÁ”v®
 * 
¿ndom
.
	`ÃxtIÁ
(
qu”yTimeS·n
 /imestampInterval));

831 
’dTime¡amp
 = 
¡¬tTime¡amp
 + 
qu”yTimeS·n
;

833 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
 + 
qu”yTimeS·nD–im™”
 + 
’dTime¡amp
);

835 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
);

837 ià(
groupBy
) {

838 
f›lds
.
	`add
(
groupByKey
 + 
gPaœD–im™”
 + 
groupByFunùiÚ
);

840 ià(
down§m¶e
) {

841 
f›lds
.
	`add
(
down§m¶eKey
 + 
gPaœD–im™”
 + 
down§m¶eFunùiÚ
 +agPaœD–im™” + 
down§m¶eIÁ”v®
);

844 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉs
 = 
Ãw
 Vector<HashMap<String, ByteIterator>>();

845 
db
.
	`sÿn
(
bË
, 
keyÇme
, 
Ën
, 
f›lds
, 
»suÉs
);

846 
	}
}

848 
´Ùeùed
 
	$doT¿n§ùiÚD–‘e
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

849 
fš®
 
Th»adS‹
 
¡©e
 = (Th»adS‹è
th»ad¡©e
;

850 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

851 
fš®
 
SŒšgBud”
 
buf
 = 
Ãw
 
	`SŒšgBud”
().
	`­³nd
(
keys
[
¿ndom
.
	`ÃxtIÁ
(keys.
Ëngth
)]);

853 
off£ts
 = 
¿ndom
.
	`ÃxtIÁ
(
maxOff£ts
 - 1);

854 
fš®
 
¡¬tTime¡amp
;

855 ià(
off£ts
 > 0) {

856 
¡¬tTime¡amp
 = 
¡©e
.¡¬tTime¡am°+ s‹.
time¡ampG’”©Ü
.
	`g‘Off£t
(
off£ts
);

858 
¡¬tTime¡amp
 = 
¡©e
.startTimestamp;

862 
i
 = 0; i < 
gPaœs
; ++i) {

863 ià(
groupBy
 && 
groupBys
[
i
]) {

864 
buf
.
	`­³nd
(
d–‘eD–im™”
)

865 .
	`­³nd
(
gKeys
[
i
]);

867 
buf
.
	`­³nd
(
d–‘eD–im™”
).­³nd(
gKeys
[
i
] + 
gPaœD–im™”
 +

868 
gV®ues
[
¿ndom
.
	`ÃxtIÁ
(
gC¬dš®™y
[
i
])]);

872 ià(
qu”yTimeS·n
 > 0) {

873 
fš®
 
’dTime¡amp
;

874 ià(
qu”yRªdomTimeS·n
) {

875 
’dTime¡amp
 = 
¡¬tTime¡amp
 + (
time¡ampIÁ”v®
 * 
¿ndom
.
	`ÃxtIÁ
(
qu”yTimeS·n
 /imestampInterval));

877 
’dTime¡amp
 = 
¡¬tTime¡amp
 + 
qu”yTimeS·n
;

879 
buf
.
	`­³nd
(
d–‘eD–im™”
)

880 .
	`­³nd
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
 + 
qu”yTimeS·nD–im™”
 + 
’dTime¡amp
);

882 
buf
.
	`­³nd
(
d–‘eD–im™”
)

883 .
	`­³nd
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
);

886 
db
.
	`d–‘e
(
bË
, 
buf
.
	`toSŒšg
());

887 
	}
}

898 
´Ùeùed
 
Stus
 
v”ifyRow
(
fš®
 
SŒšg
 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
ûÎs
) {

899 
Stus
 
	gv”ifyStus
 = Stus.
UNEXPECTED_STATE
;

900 
	g¡¬tTime
 = 
Sy¡em
.
ÇnoTime
();

902 
	gv®ue
 = 0;

903 
	gtime¡amp
 = 0;

904 
fš®
 
	gT»eM­
<
	gSŒšg
, SŒšg> 
	gv®id©iÚTags
 = 
Ãw
 
T»eM­
<
SŒšg
, String>();

905 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
ûÎs
.
’ŒyS‘
()) {

906 ià(
’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

907 
fš®
 
Num”icBy‹I‹¿tÜ
 
™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

908 
	gtime¡amp
 = 
™
.
g‘LÚg
();

909 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

910 
fš®
 
Num”icBy‹I‹¿tÜ
 
	g™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

911 
	gv®ue
 = 
™
.
isFlßtšgPošt
(è? it.
g‘DoubË
(è: it.
g‘LÚg
();

913 
	gv®id©iÚTags
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

917 ià(
v®id©iÚFunùiÚ
(
key
, 
time¡amp
, 
v®id©iÚTags
è=ğ
v®ue
) {

918 
v”ifyStus
 = 
Stus
.
OK
;

920 
	g’dTime
 = 
Sy¡em
.
ÇnoTime
();

921 
	gm—su»m’ts
.
m—su»
("VERIFY", (è(
’dTime
 - 
¡¬tTime
) / 1000);

922 
	gm—su»m’ts
.
»pÜtStus
("VERIFY", 
v”ifyStus
);

923  
	gv”ifyStus
;

935 
´Ùeùed
 
v®id©iÚFunùiÚ
(
fš®
 
SŒšg
 
key
, fš® 
time¡amp
,

936 
fš®
 
T»eM­
<
SŒšg
, SŒšg> 
gs
) {

937 
fš®
 
SŒšgBud”
 
	gv®id©iÚBufãr
 = 
Ãw
 SŒšgBud”(
keys
[0].
Ëngth
() +

938 (
gPaœs
 * 
gKeys
[0].
Ëngth
()è+ (gPaœ * 
gC¬dš®™y
[1]));

939 
fš®
 
	gEÁry
<
	gSŒšg
, SŒšg> 
	g·œ
 : 
gs
.
’ŒyS‘
()) {

940 
v®id©iÚBufãr
.
­³nd
(
·œ
.
g‘Key
()).­³ndÕaœ.
g‘V®ue
());

942  (è
	gv®id©iÚBufãr
.
toSŒšg
().
hashCode
(è^ 
	gtime¡amp
;

950 
´Ùeùed
 
	$š™KeysAndTags
(è
throws
 
WÜklßdExû±iÚ
 {

951 
fš®
 
keyL’gth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

952 
CÜeWÜklßd
.
FIELD_LENGTH_PROPERTY
,

953 
CÜeWÜklßd
.
FIELD_LENGTH_PROPERTY_DEFAULT
));

954 
fš®
 
gKeyL’gth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

955 
TAG_KEY_LENGTH_PROPERTY
, 
TAG_KEY_LENGTH_PROPERTY_DEFAULT
));

956 
fš®
 
gV®ueL’gth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

957 
TAG_VALUE_LENGTH_PROPERTY
, 
TAG_VALUE_LENGTH_PROPERTY_DEFAULT
));

959 
keyG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
keyL’gth
);

960 
gKeyG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
gKeyL’gth
);

961 
gV®ueG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
gV®ueL’gth
);

963 
fš®
 
th»ads
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
Cl›Á
.
THREAD_COUNT_PROPERTY
, "1"));

964 
fš®
 
SŒšg
 
gC¬dš®™ySŒšg
 = 
´İ”t›s
.
	`g‘Prİ”ty
(

965 
TAG_CARDINALITY_PROPERTY
,

966 
TAG_CARDINALITY_PROPERTY_DEFAULT
);

967 
fš®
 
SŒšg
[] 
gC¬dš®™yP¬ts
 = 
gC¬dš®™ySŒšg
.
	`¥l™
(",");

968 
idx
 = 0;

969 
tÙ®C¬dš®™y
 = 
numKeys
;

970 
³rKeyC¬dš®™y
 = 1;

971 
maxC¬dš®™y
 = 0;

972 
fš®
 
SŒšg
 
ÿrd
 : 
gC¬dš®™yP¬ts
) {

973 
Œy
 {

974 
gC¬dš®™y
[
idx
] = 
IÁeg”
.
	`·r£IÁ
(
ÿrd
.
	`Œim
());

975 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

976 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Unableo…arse cardinality: " +

977 
ÿrd
, 
nã
);

979 ià(
gC¬dš®™y
[
idx
] < 1) {

980 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Cardinality must be greaterhan zero: " +

981 
gC¬dš®™y
[
idx
]);

983 
tÙ®C¬dš®™y
 *ğ
gC¬dš®™y
[
idx
];

984 
³rKeyC¬dš®™y
 *ğ
gC¬dš®™y
[
idx
];

985 ià(
gC¬dš®™y
[
idx
] > 
maxC¬dš®™y
) {

986 
maxC¬dš®™y
 = 
gC¬dš®™y
[
idx
];

988 ++
idx
;

989 ià(
idx
 >ğ
gPaœs
) {

994 ià(
numKeys
 < 
th»ads
) {

995 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("F›ld couÁ " + 
numKeys
 + " (keys forime "

997 + "th»ad " + 
th»ads
);

1001 ià(
idx
 < 
gPaœs
) {

1002 
gC¬dš®™y
[
idx
++] = 1;

1005 
i
 = 0; i < 
gC¬dš®™y
.
Ëngth
; ++i) {

1006 ià(
gC¬dš®™y
[
i
] > 1) {

1007 
fœ¡Inüem’bËC¬dš®™y
 = 
i
;

1012 
keys
 = 
Ãw
 
SŒšg
[
numKeys
];

1013 
gKeys
 = 
Ãw
 
SŒšg
[
gPaœs
];

1014 
gV®ues
 = 
Ãw
 
SŒšg
[
maxC¬dš®™y
];

1015 
i
 = 0; i < 
numKeys
; ++i) {

1016 
keys
[
i
] = 
keyG’”©Ü
.
	`ÃxtSŒšg
();

1019 
i
 = 0; i < 
gPaœs
; ++i) {

1020 
gKeys
[
i
] = 
gKeyG’”©Ü
.
	`ÃxtSŒšg
();

1023 
i
 = 0; i < 
maxC¬dš®™y
; i++) {

1024 
gV®ues
[
i
] = 
gV®ueG’”©Ü
.
	`ÃxtSŒšg
();

1026 ià(
¿ndomizeTime£r›sOrd”
) {

1027 
Uts
.
	`shufæeA¼ay
(
keys
);

1028 
Uts
.
	`shufæeA¼ay
(
gV®ues
);

1031 
maxOff£ts
 = (
»cÜdcouÁ
 / 
tÙ®C¬dš®™y
) + 1;

1032 
fš®
 [] 
keyAndTagC¬dš®™y
 = 
Ãw
 [
gPaœs
 + 1];

1033 
keyAndTagC¬dš®™y
[0] = 
numKeys
;

1034 
i
 = 0; i < 
gPaœs
; i++) {

1035 
keyAndTagC¬dš®™y
[
i
 + 1] = 
gC¬dš®™y
[i];

1038 
cumuÏtiveC¬dš®™y
 = 
Ãw
 [
keyAndTagC¬dš®™y
.
Ëngth
];

1039 
i
 = 0; i < 
keyAndTagC¬dš®™y
.
Ëngth
; i++) {

1040 
cumuÏtiÚ
 = 1;

1041 
x
 = 
i
; x <ğ
keyAndTagC¬dš®™y
.
Ëngth
 - 1; x++) {

1042 
cumuÏtiÚ
 *ğ
keyAndTagC¬dš®™y
[
x
];

1044 ià(
i
 > 0) {

1045 
cumuÏtiveC¬dš®™y
[
i
 - 1] = 
cumuÏtiÚ
;

1048 
cumuÏtiveC¬dš®™y
[cumuÏtiveC¬dš®™y.
Ëngth
 - 1] = 1;

1049 
	}
}

1055 
´Ùeùed
 
	$v®id©eS‘tšgs
(è
throws
 
WÜklßdExû±iÚ
 {

1056 ià(
d©aš‹gr™y
) {

1057 ià(
v®ueTy³
 !ğ
V®ueTy³
.
INTEGERS
) {

1058 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'valuetype' must "

1061 ià(
groupBy
) {

1062 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'groupbyfunction' must "

1065 ià(
down§m¶e
) {

1066 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'downsamplingfunction' must "

1069 ià(
qu”yTimeS·n
 > 0) {

1070 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'querytimespan' must "

1073 ià(
¿ndomizeTime£r›sOrd”
) {

1074 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'randomizetimeseriesorder' must "

1077 
fš®
 
SŒšg
 
¡¬tTime¡amp
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
INSERT_START_PROPERTY
);

1078 ià(
¡¬tTime¡amp
 =ğ
nuÎ
 || s¹Time¡amp.
	`isEm±y
()) {

1079 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'insertstart' must "

1083 
	}
}

1088 
´Ùeùed
 cÏs 
	cTh»adS‹
 {

1090 
´Ùeùed
 
fš®
 
UnixEpochTime¡ampG’”©Ü
 
	gtime¡ampG’”©Ü
;

1093 
´Ùeùed
 
fš®
 
Numb”G’”©Ü
 
	gqu”yOff£tG’”©Ü
;

1096 
´Ùeùed
 
	gkeyIdx
;

1099 
´Ùeùed
 
	gkeyIdxS¹
;

1102 
´Ùeùed
 
	gkeyIdxEnd
;

1105 
´Ùeùed
 [] 
	ggV®ueIdxs
;

1108 
´Ùeùed
 
boŞ—n
 
	grŞlov”
;

1111 
´Ùeùed
 
	g¡¬tTime¡amp
;

1119 
´Ùeùed
 
Th»adS‹
(
fš®
 
th»adID
, fš® 
th»adCouÁ
è
throws
 
	gWÜklßdExû±iÚ
 {

1120 
	gtÙ®Th»ads
 = 
th»adCouÁ
 > 0 ?hreadCount : 1;

1122 ià(
	gth»adID
 >ğ
tÙ®Th»ads
) {

1123 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Th»ad ID " + 
th»adID
 + " cannot be greater "

1124 + "thª o¸equ®hªhth»ad couÁ " + 
tÙ®Th»ads
);

1126 ià(
	gkeys
.
	gËngth
 < 
	gth»adCouÁ
) {

1127 
throw
 
Ãw
 
WÜklßdExû±iÚ
("Th»ad couÁ " + 
tÙ®Th»ads
 + " must be greater "

1128 + "thª o¸equ®Økey couÁ " + 
keys
.
Ëngth
);

1131 
	gkeysP”Th»ad
 = 
keys
.
Ëngth
 / 
tÙ®Th»ads
;

1132 
	gkeyIdx
 = 
keysP”Th»ad
 * 
th»adID
;

1133 
	gkeyIdxS¹
 = 
keyIdx
;

1134 ià(
	gtÙ®Th»ads
 - 1 =ğ
th»adID
) {

1135 
keyIdxEnd
 = 
keys
.
Ëngth
;

1137 
	gkeyIdxEnd
 = 
keyIdxS¹
 + 
keysP”Th»ad
;

1140 
	ggV®ueIdxs
 = 
Ãw
 [
gPaœs
];

1142 
fš®
 
SŒšg
 
	g¡¬tšgTime¡amp
 =

1143 
´İ”t›s
.
g‘Prİ”ty
(
CÜeWÜklßd
.
INSERT_START_PROPERTY
);

1144 ià(
	g¡¬tšgTime¡amp
 =ğ
nuÎ
 || 
¡¬tšgTime¡amp
.
isEm±y
()) {

1145 
time¡ampG’”©Ü
 = 
¿ndomizeTime¡ampOrd”
 ?

1146 
Ãw
 
RªdomDisü‘eTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
, 
maxOff£ts
) :

1147 
Ãw
 
UnixEpochTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
);

1149 
	gŒy
 {

1150 
	gtime¡ampG’”©Ü
 = 
¿ndomizeTime¡ampOrd”
 ?

1151 
Ãw
 
RªdomDisü‘eTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
,

1152 
LÚg
.
·r£LÚg
(
¡¬tšgTime¡amp
), 
maxOff£ts
) :

1153 
Ãw
 
UnixEpochTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
,

1154 
LÚg
.
·r£LÚg
(
¡¬tšgTime¡amp
));

1155 } 
ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

1156 
throw
 
Ãw
 
WÜklßdExû±iÚ
("Unableo…arsehe " +

1157 
CÜeWÜklßd
.
INSERT_START_PROPERTY
, 
nã
);

1162 
	g¡¬tTime¡amp
 = 
time¡ampG’”©Ü
.
ÃxtV®ue
();

1164 
	gqu”yOff£tG’”©Ü
 = 
Ãw
 
UnifÜmLÚgG’”©Ü
(0, 
maxOff£ts
 - 2);

1175 
´Ùeùed
 
SŒšg
 
ÃxtD©aPošt
(
fš®
 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
m­
, fš® 
boŞ—n
 
isIn£¹
) {

1176 
fš®
 
Rªdom
 
	g¿ndom
 = 
Th»adLoÿlRªdom
.
cu¼’t
();

1177 
	g™”©iÚs
 = 
¥¬s™y
 <ğ0 ? 1 : 
¿ndom
.
ÃxtIÁ
((è((è
³rKeyC¬dš®™y
 * sparsity));

1178 ià(
	g™”©iÚs
 < 1) {

1179 
	g™”©iÚs
 = 1;

1181 
	gŒue
) {

1182 
	g™”©iÚs
--;

1183 ià(
	grŞlov”
) {

1184 
	gtime¡ampG’”©Ü
.
ÃxtV®ue
();

1185 
	grŞlov”
 = 
çl£
;

1187 
SŒšg
 
	gkey
 = 
nuÎ
;

1188 ià(
	g™”©iÚs
 <= 0) {

1189 
fš®
 
T»eM­
<
SŒšg
, SŒšg> 
v®id©iÚTags
;

1190 ià(
	gd©aš‹gr™y
) {

1191 
	gv®id©iÚTags
 = 
Ãw
 
T»eM­
<
SŒšg
, 
	gSŒšg
>();

1193 
	gv®id©iÚTags
 = 
nuÎ
;

1195 
	gkey
 = 
keys
[
keyIdx
];

1196 
	gov”®lIdx
 = 
keyIdx
 * 
cumuÏtiveC¬dš®™y
[0];

1197 
	gi
 = 0; i < 
	ggPaœs
; ++i) {

1198 
	gtvidx
 = 
gV®ueIdxs
[
i
];

1199 
	gm­
.
put
(
gKeys
[
i
], 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
gV®ues
[
tvidx
]));

1200 ià(
	gd©aš‹gr™y
) {

1201 
	gv®id©iÚTags
.
put
(
gKeys
[
i
], 
gV®ues
[
tvidx
]);

1203 ià(
	gd–ayedS”›s
 > 0) {

1204 
	gov”®lIdx
 +ğ(
tvidx
 * 
cumuÏtiveC¬dš®™y
[
i
 + 1]);

1208 ià(!
	gisIn£¹
) {

1209 
fš®
 
	gd–
 = (
time¡ampG’”©Ü
.
cu¼’tV®ue
(è- 
¡¬tTime¡amp
è/ 
time¡ampIÁ”v®
;

1210 
fš®
 
	gš‹rv®s
 = 
¿ndom
.
ÃxtIÁ
((è
d–
);

1211 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¡¬tTime¡amp
 + (
š‹rv®s
 * 
time¡ampIÁ”v®
)));

1212 } ià(
	gd–ayedS”›s
 > 0) {

1215 
	gpù
 = (è
ov”®lIdx
 / (è
tÙ®C¬dš®™y
;

1216 ià(
	gpù
 < 
	gd–ayedS”›s
) {

1217 
	gmodulo
 = 
ov”®lIdx
 % 
d–ayedIÁ”v®s
;

1218 ià(
	gmodulo
 < 0) {

1219 
	gmodulo
 *= -1;

1221 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
time¡ampG’”©Ü
.
cu¼’tV®ue
() -

1222 
time¡ampIÁ”v®
 * 
modulo
));

1224 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
time¡ampG’”©Ü
.
cu¼’tV®ue
()));

1227 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
time¡ampG’”©Ü
.
cu¼’tV®ue
()));

1230 ià(
	gd©aš‹gr™y
) {

1231 
	gm­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
v®id©iÚFunùiÚ
(
key
,

1232 
time¡ampG’”©Ü
.
cu¼’tV®ue
(), 
v®id©iÚTags
)));

1234 
	gv®ueTy³
) {

1235 
	gINTEGERS
:

1236 
m­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtIÁ
()));

1238 
	gFLOATS
:

1239 
m­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtDoubË
() * () 100000));

1241 
	gMIXED
:

1242 ià(
¿ndom
.
ÃxtBoŞ—n
()) {

1243 
m­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtIÁ
()));

1245 
	gm­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtDoubË
() * () 100000));

1249 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Somehow we didn't have‡ value "

1250 + "ty³ cÚfigu»dh© wsuµÜt: " + 
v®ueTy³
);

1255 
boŞ—n
 
	ggRŞlov”
 = 
çl£
;

1256 
	gi
 = 
gC¬dš®™y
.
Ëngth
 - 1; i >= 0; --i) {

1257 ià(
	ggC¬dš®™y
[
i
] <= 1) {

1258 
gRŞlov”
 = 
Œue
;

1262 ià(
	ggV®ueIdxs
[
i
] + 1 >ğ
gC¬dš®™y
[i]) {

1263 
gV®ueIdxs
[
i
] = 0;

1264 ià(
	gi
 =ğ
fœ¡Inüem’bËC¬dš®™y
) {

1265 
gRŞlov”
 = 
Œue
;

1268 ++
	ggV®ueIdxs
[
i
];

1273 ià(
	ggRŞlov”
) {

1274 ià(
	gkeyIdx
 + 1 >ğ
keyIdxEnd
) {

1275 
keyIdx
 = 
keyIdxS¹
;

1276 
	grŞlov”
 = 
Œue
;

1278 ++
	gkeyIdx
;

1282 ià(
	g™”©iÚs
 <= 0) {

1283  
key
;

	@core/src/main/java/site/ycsb/workloads/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

	@core/src/test/java/site/ycsb/TestByteIterator.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

21 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹JUn™
.*;

23 
public
 cÏs 
	cTe¡By‹I‹¿tÜ
 {

24 @
Te¡


25 
public
 
	$‹¡RªdomBy‹I‹¿tÜ
() {

26 
size
 = 100;

27 
By‹I‹¿tÜ
 
™Ü
 = 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
size
);

28 
	`as£¹True
(
™Ü
.
	`hasNext
());

29 
	`as£¹Equ®s
(
size
, 
™Ü
.
	`by‹sLeá
());

30 
	`as£¹Equ®s
(
size
, 
™Ü
.
	`toSŒšg
().
	`g‘By‹s
().
Ëngth
);

31 
	`as£¹F®£
(
™Ü
.
	`hasNext
());

32 
	`as£¹Equ®s
(0, 
™Ü
.
	`by‹sLeá
());

34 
™Ü
 = 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
size
);

35 
	`as£¹Equ®s
(
size
, 
™Ü
.
	`toA¼ay
().
Ëngth
);

36 
	`as£¹F®£
(
™Ü
.
	`hasNext
());

37 
	`as£¹Equ®s
(0, 
™Ü
.
	`by‹sLeá
());

39 
	}
}

	@core/src/test/java/site/ycsb/TestNumericByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

20 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹JUn™
.*;

22 
public
 cÏs 
	cTe¡Num”icBy‹I‹¿tÜ
 {

24 @
Te¡


25 
public
 
	$‹¡LÚg
(è
throws
 
Exû±iÚ
 {

26 
Num”icBy‹I‹¿tÜ
 
™
 = 
Ãw
 
	`Num”icBy‹I‹¿tÜ
(42L);

27 
	`as£¹F®£
(
™
.
	`isFlßtšgPošt
());

28 
	`as£¹Equ®s
(42L, 
™
.
	`g‘LÚg
());

30 
Œy
 {

31 
™
.
	`g‘DoubË
();

32 
	`ç
("Expected IllegalStateException.");

33 } 
	`ÿtch
 (
IÎeg®S‹Exû±iÚ
 
e
) { }

34 
Œy
 {

35 
™
.
	`Ãxt
();

36 
	`ç
("Expected UnsupportedOperationException.");

37 } 
	`ÿtch
 (
UnsuµÜ‹dO³¿tiÚExû±iÚ
 
e
) { }

39 
	`as£¹Equ®s
(8, 
™
.
	`by‹sLeá
());

40 
	`as£¹True
(
™
.
	`hasNext
());

41 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

42 
	`as£¹Equ®s
(7, 
™
.
	`by‹sLeá
());

43 
	`as£¹True
(
™
.
	`hasNext
());

44 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

45 
	`as£¹Equ®s
(6, 
™
.
	`by‹sLeá
());

46 
	`as£¹True
(
™
.
	`hasNext
());

47 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

48 
	`as£¹Equ®s
(5, 
™
.
	`by‹sLeá
());

49 
	`as£¹True
(
™
.
	`hasNext
());

50 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

51 
	`as£¹Equ®s
(4, 
™
.
	`by‹sLeá
());

52 
	`as£¹True
(
™
.
	`hasNext
());

53 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

54 
	`as£¹Equ®s
(3, 
™
.
	`by‹sLeá
());

55 
	`as£¹True
(
™
.
	`hasNext
());

56 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

57 
	`as£¹Equ®s
(2, 
™
.
	`by‹sLeá
());

58 
	`as£¹True
(
™
.
	`hasNext
());

59 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

60 
	`as£¹Equ®s
(1, 
™
.
	`by‹sLeá
());

61 
	`as£¹True
(
™
.
	`hasNext
());

62 
	`as£¹Equ®s
((
by‹
è42, (by‹è
™
.
	`ÃxtBy‹
());

63 
	`as£¹Equ®s
(0, 
™
.
	`by‹sLeá
());

64 
	`as£¹F®£
(
™
.
	`hasNext
());

66 
™
.
	`»£t
();

67 
	`as£¹True
(
™
.
	`hasNext
());

68 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

71 @
Te¡


72 
public
 
	$‹¡DoubË
(è
throws
 
Exû±iÚ
 {

73 
Num”icBy‹I‹¿tÜ
 
™
 = 
Ãw
 
	`Num”icBy‹I‹¿tÜ
(42.75);

74 
	`as£¹True
(
™
.
	`isFlßtšgPošt
());

75 
	`as£¹Equ®s
(42.75, 
™
.
	`g‘DoubË
(), 0.001);

77 
Œy
 {

78 
™
.
	`g‘LÚg
();

79 
	`ç
("Expected IllegalStateException.");

80 } 
	`ÿtch
 (
IÎeg®S‹Exû±iÚ
 
e
) { }

81 
Œy
 {

82 
™
.
	`Ãxt
();

83 
	`ç
("Expected UnsupportedOperationException.");

84 } 
	`ÿtch
 (
UnsuµÜ‹dO³¿tiÚExû±iÚ
 
e
) { }

86 
	`as£¹Equ®s
(8, 
™
.
	`by‹sLeá
());

87 
	`as£¹True
(
™
.
	`hasNext
());

88 
	`as£¹Equ®s
((
by‹
è64, (by‹è
™
.
	`ÃxtBy‹
());

89 
	`as£¹Equ®s
(7, 
™
.
	`by‹sLeá
());

90 
	`as£¹True
(
™
.
	`hasNext
());

91 
	`as£¹Equ®s
((
by‹
è69, (by‹è
™
.
	`ÃxtBy‹
());

92 
	`as£¹Equ®s
(6, 
™
.
	`by‹sLeá
());

93 
	`as£¹True
(
™
.
	`hasNext
());

94 
	`as£¹Equ®s
((
by‹
è96, (by‹è
™
.
	`ÃxtBy‹
());

95 
	`as£¹Equ®s
(5, 
™
.
	`by‹sLeá
());

96 
	`as£¹True
(
™
.
	`hasNext
());

97 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

98 
	`as£¹Equ®s
(4, 
™
.
	`by‹sLeá
());

99 
	`as£¹True
(
™
.
	`hasNext
());

100 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

101 
	`as£¹Equ®s
(3, 
™
.
	`by‹sLeá
());

102 
	`as£¹True
(
™
.
	`hasNext
());

103 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

104 
	`as£¹Equ®s
(2, 
™
.
	`by‹sLeá
());

105 
	`as£¹True
(
™
.
	`hasNext
());

106 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

107 
	`as£¹Equ®s
(1, 
™
.
	`by‹sLeá
());

108 
	`as£¹True
(
™
.
	`hasNext
());

109 
	`as£¹Equ®s
((
by‹
è0, (by‹è
™
.
	`ÃxtBy‹
());

110 
	`as£¹Equ®s
(0, 
™
.
	`by‹sLeá
());

111 
	`as£¹F®£
(
™
.
	`hasNext
());

113 
™
.
	`»£t
();

114 
	`as£¹True
(
™
.
	`hasNext
());

115 
	`as£¹Equ®s
((
by‹
è64, (by‹è
™
.
	`ÃxtBy‹
());

116 
	}
}

	@core/src/test/java/site/ycsb/TestStatus.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

21 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹F®£
;

22 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹True
;

27 
public
 cÏs 
	cTe¡Stus
 {

29 @
Te¡


30 
public
 
	$‹¡Acû±abËStus
() {

31 
	`as£¹True
(
Stus
.
OK
.
	`isOk
());

32 
	`as£¹True
(
Stus
.
BATCHED_OK
.
	`isOk
());

33 
	`as£¹F®£
(
Stus
.
BAD_REQUEST
.
	`isOk
());

34 
	`as£¹F®£
(
Stus
.
ERROR
.
	`isOk
());

35 
	`as£¹F®£
(
Stus
.
FORBIDDEN
.
	`isOk
());

36 
	`as£¹F®£
(
Stus
.
NOT_FOUND
.
	`isOk
());

37 
	`as£¹F®£
(
Stus
.
NOT_IMPLEMENTED
.
	`isOk
());

38 
	`as£¹F®£
(
Stus
.
SERVICE_UNAVAILABLE
.
	`isOk
());

39 
	`as£¹F®£
(
Stus
.
UNEXPECTED_STATE
.
	`isOk
());

41 
	}
}

	@core/src/test/java/site/ycsb/TestUtils.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹Equ®s
;

21 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹True
;

23 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

25 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

27 
public
 cÏs 
	cTe¡Uts
 {

29 @
Te¡


30 
public
 
	$by‹sToFromLÚg
(è
throws
 
Exû±iÚ
 {

31 
by‹
[] 
by‹s
 = 
Ãw
 byte[8];

32 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
by‹s
), 0L);

33 
	`as£¹A¼ayEqu®s
(
Uts
.
	`lÚgToBy‹s
(0), 
by‹s
);

35 
by‹s
[7] = 1;

36 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
by‹s
), 1L);

37 
	`as£¹A¼ayEqu®s
(
Uts
.
	`lÚgToBy‹s
(1L), 
by‹s
);

39 
by‹s
 = 
Ãw
 
by‹
[] { 127, -1, -1, -1, -1, -1, -1, -1 };

40 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
by‹s
), 
LÚg
.
MAX_VALUE
);

41 
	`as£¹A¼ayEqu®s
(
Uts
.
	`lÚgToBy‹s
(
LÚg
.
MAX_VALUE
), 
by‹s
);

43 
by‹s
 = 
Ãw
 
by‹
[] { -128, 0, 0, 0, 0, 0, 0, 0 };

44 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
by‹s
), 
LÚg
.
MIN_VALUE
);

45 
	`as£¹A¼ayEqu®s
(
Uts
.
	`lÚgToBy‹s
(
LÚg
.
MIN_VALUE
), 
by‹s
);

47 
by‹s
 = 
Ãw
 
by‹
[] { (byte) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF,

48 (
by‹
) 0xFF, (byte) 0xFF, (byte) 0xFF, (byte) 0xFF };

49 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
by‹s
), -1L);

50 
	`as£¹A¼ayEqu®s
(
Uts
.
	`lÚgToBy‹s
(-1L), 
by‹s
);

53 
by‹s
 = 
Ãw
 
by‹
[] { 0, 0, 0, 0, 0, 0, 0, 1, 42, 42, 42 };

54 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
by‹s
), 1L);

57 @
Te¡


58 
public
 
	$by‹sToFromDoubË
(è
throws
 
Exû±iÚ
 {

59 
by‹
[] 
by‹s
 = 
Ãw
 byte[8];

60 
	`as£¹Equ®s
(
Uts
.
	`by‹sToDoubË
(
by‹s
), 0, 0.0001);

61 
	`as£¹A¼ayEqu®s
(
Uts
.
	`doubËToBy‹s
(0), 
by‹s
);

63 
by‹s
 = 
Ãw
 
by‹
[] { 63, -16, 0, 0, 0, 0, 0, 0 };

64 
	`as£¹Equ®s
(
Uts
.
	`by‹sToDoubË
(
by‹s
), 1, 0.0001);

65 
	`as£¹A¼ayEqu®s
(
Uts
.
	`doubËToBy‹s
(1), 
by‹s
);

67 
by‹s
 = 
Ãw
 
by‹
[] { -65, -16, 0, 0, 0, 0, 0, 0 };

68 
	`as£¹Equ®s
(
Uts
.
	`by‹sToDoubË
(
by‹s
), -1, 0.0001);

69 
	`as£¹A¼ayEqu®s
(
Uts
.
	`doubËToBy‹s
(-1), 
by‹s
);

71 
by‹s
 = 
Ãw
 
by‹
[] { 127, -17, -1, -1, -1, -1, -1, -1 };

72 
	`as£¹Equ®s
(
Uts
.
	`by‹sToDoubË
(
by‹s
), 
DoubË
.
MAX_VALUE
, 0.0001);

73 
	`as£¹A¼ayEqu®s
(
Uts
.
	`doubËToBy‹s
(
DoubË
.
MAX_VALUE
), 
by‹s
);

75 
by‹s
 = 
Ãw
 
by‹
[] { 0, 0, 0, 0, 0, 0, 0, 1 };

76 
	`as£¹Equ®s
(
Uts
.
	`by‹sToDoubË
(
by‹s
), 
DoubË
.
MIN_VALUE
, 0.0001);

77 
	`as£¹A¼ayEqu®s
(
Uts
.
	`doubËToBy‹s
(
DoubË
.
MIN_VALUE
), 
by‹s
);

79 
by‹s
 = 
Ãw
 
by‹
[] { 127, -8, 0, 0, 0, 0, 0, 0 };

80 
	`as£¹True
(
DoubË
.
	`isNaN
(
Uts
.
	`by‹sToDoubË
(
by‹s
)));

81 
	`as£¹A¼ayEqu®s
(
Uts
.
	`doubËToBy‹s
(
DoubË
.
NaN
), 
by‹s
);

83 
by‹s
 = 
Ãw
 
by‹
[] { 63, -16, 0, 0, 0, 0, 0, 0, 42, 42, 42 };

84 
	`as£¹Equ®s
(
Uts
.
	`by‹sToDoubË
(
by‹s
), 1, 0.0001);

85 
	}
}

87 @
	$Te¡
 (
ex³ùedExû±iÚs
 = 
NuÎPoš‹rExû±iÚ
.
şass
)

88 
public
 
	$by‹sToLÚgNuÎ
(è
throws
 
Exû±iÚ
 {

89 
Uts
.
	`by‹sToLÚg
(
nuÎ
);

90 
	}
}

92 @
	$Te¡
 (
ex³ùedExû±iÚs
 = 
IndexOutOfBoundsExû±iÚ
.
şass
)

93 
public
 
	$by‹sToLÚgTooShÜt
(è
throws
 
Exû±iÚ
 {

94 
Uts
.
	`by‹sToLÚg
(
Ãw
 
by‹
[] { 0, 0, 0, 0, 0, 0, 0 });

95 
	}
}

97 @
	$Te¡
 (
ex³ùedExû±iÚs
 = 
IÎeg®Argum’tExû±iÚ
.
şass
)

98 
public
 
	$by‹sToDoubËTooShÜt
(è
throws
 
Exû±iÚ
 {

99 
Uts
.
	`by‹sToDoubË
(
Ãw
 
by‹
[] { 0, 0, 0, 0, 0, 0, 0 });

100 
	}
}

102 @
Te¡


103 
public
 
	$jvmUts
(è
throws
 
Exû±iÚ
 {

105 
	`as£¹True
(
Uts
.
	`g‘AùiveTh»adCouÁ
() > 0);

107 
	`as£¹True
(
Uts
.
	`g‘U£dMemÜyBy‹s
() > 0);

110 
Uts
.
	`g‘Sy¡emLßdAv”age
();

112 
	`as£¹True
(
Uts
.
	`g‘GCTÙ®CŞËùiÚCouÁ
() >= 0);

114 
	`as£¹True
(
Uts
.
	`g‘GCTÙ®Time
() >= 0);

116 
	`as£¹True
(
Uts
.
	`g‘GCSt¡
().
	`size
() >= 0);

117 
	}
}

126 
public
 
	$as£¹A¼ayEqu®s
(
fš®
 
by‹
[] 
aùu®
, fš® by‹[] 
ex³ùed
) {

127 ià(
aùu®
 =ğ
nuÎ
 && 
ex³ùed
 !=‚ull) {

128 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("Ex³ùed " + 
A¼ays
.
	`toSŒšg
(
ex³ùed
) +

131 ià(
aùu®
 !ğ
nuÎ
 && 
ex³ùed
 ==‚ull) {

132 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("Expected [null] but found " +

133 
A¼ays
.
	`toSŒšg
(
aùu®
));

135 ià(
aùu®
.
Ëngth
 !ğ
ex³ùed
.length) {

136 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("Ex³ùed†’gth " + 
ex³ùed
.
Ëngth
 +

137 " buˆfound " + 
aùu®
.
Ëngth
);

139 
i
 = 0; i < 
ex³ùed
.
Ëngth
; i++) {

140 ià(
aùu®
[
i
] !ğ
ex³ùed
[i]) {

141 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("Ex³ùed by‹ [" + 
ex³ùed
[
i
] +

142 "]‡ˆšdex " + 
i
 + " buˆfound [" + 
aùu®
[i] + "]");

145 
	}
}

	@core/src/test/java/site/ycsb/generator/AcknowledgedCounterGeneratorTest.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gA¼ayBlockšgQueue
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gBlockšgQueue
;

23 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

28 
public
 cÏs 
	cAcknowËdgedCouÁ”G’”©ÜTe¡
 {

33 @
Te¡


34 
public
 
	$‹¡Inüem’tPa¡IÁeg”MaxV®ue
() {

35 
fš®
 
toTry
 = 
AcknowËdgedCouÁ”G’”©Ü
.
WINDOW_SIZE
 * 3;

37 
AcknowËdgedCouÁ”G’”©Ü
 
g’”©Ü
 =

38 
Ãw
 
	`AcknowËdgedCouÁ”G’”©Ü
(
IÁeg”
.
MAX_VALUE
 - 1000);

40 
Rªdom
 
¿nd
 = 
Ãw
 
	`Rªdom
(
Sy¡em
.
	`cu¼’tTimeMlis
());

41 
BlockšgQueue
<
LÚg
> 
³ndšg
 = 
Ãw
 
A¼ayBlockšgQueue
<Long>(1000);

42 
i
 = 0; i < 
toTry
; ++i) {

43 
v®ue
 = 
g’”©Ü
.
	`ÃxtV®ue
();

45 !
³ndšg
.
	`ofãr
(
v®ue
)) {

47 
LÚg
 
fœ¡
 = 
³ndšg
.
	`pŞl
();

50 ià(
¿nd
.
	`ÃxtBoŞ—n
()) {

51 
g’”©Ü
.
	`acknowËdge
(
fœ¡
);

53 
LÚg
 
£cÚd
 = 
³ndšg
.
	`pŞl
();

54 
³ndšg
.
	`add
(
fœ¡
);

55 
g’”©Ü
.
	`acknowËdge
(
£cÚd
);

61 
	}
}

	@core/src/test/java/site/ycsb/generator/TestIncrementingPrintableStringGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹Equ®s
;

20 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹NuÎ
;

21 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gç
;

23 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

25 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

27 
public
 cÏs 
	cTe¡Inüem’tšgPršbËSŒšgG’”©Ü
 {

28 
´iv©e
 
fš®
 [] 
	mATOC
 = 
Ãw
 [] { 65, 66, 67 };

30 @
Te¡


31 
public
 
	$rŞlov”OK
(è
throws
 
Exû±iÚ
 {

32 
fš®
 
Inüem’tšgPršbËSŒšgG’”©Ü
 
g’
 =

33 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(2, 
ATOC
);

35 
	`as£¹NuÎ
(
g’
.
	`Ï¡V®ue
());

36 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "AA");

37 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "AA");

38 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "AB");

39 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "AB");

40 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "AC");

41 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "AC");

42 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "BA");

43 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "BA");

44 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "BB");

45 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "BB");

46 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "BC");

47 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "BC");

48 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "CA");

49 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "CA");

50 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "CB");

51 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "CB");

52 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "CC");

53 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "CC");

54 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "AA");

55 
	`as£¹Equ®s
(
g’
.
	`Ï¡V®ue
(), "AA");

56 
	}
}

58 @
Te¡


59 
public
 
	$rŞlov”OÃCh¬aù”OK
(è
throws
 
Exû±iÚ
 {

61 
fš®
 
Inüem’tšgPršbËSŒšgG’”©Ü
 
g’
 =

62 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(2,‚ew [] { 65 });

63 
i
 = 0; i < 5; i++) {

64 
	`as£¹Equ®s
(
g’
.
	`ÃxtV®ue
(), "AA");

66 
	}
}

68 @
Te¡


69 
public
 
	$rŞlov”Exû±iÚ
(è
throws
 
Exû±iÚ
 {

70 
fš®
 
Inüem’tšgPršbËSŒšgG’”©Ü
 
g’
 =

71 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(2, 
ATOC
);

72 
g’
.
	`£tThrowExû±iÚOnRŞlov”
(
Œue
);

74 
i
 = 0;

75 
Œy
 {

76 
i
 < 11) {

77 ++
i
;

78 
g’
.
	`ÃxtV®ue
();

80 
	`ç
("Expected NoSuchElementException");

81 } 
	`ÿtch
 (
NoSuchEËm’tExû±iÚ
 
e
) {

82 
	`as£¹Equ®s
(
i
, 10);

84 
	}
}

86 @
Te¡


87 
public
 
	$rŞlov”OÃCh¬aù”Exû±iÚ
(è
throws
 
Exû±iÚ
 {

89 
fš®
 
Inüem’tšgPršbËSŒšgG’”©Ü
 
g’
 =

90 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(2,‚ew [] { 65 });

91 
g’
.
	`£tThrowExû±iÚOnRŞlov”
(
Œue
);

93 
i
 = 0;

94 
Œy
 {

95 
i
 < 3) {

96 ++
i
;

97 
g’
.
	`ÃxtV®ue
();

99 
	`ç
("Expected NoSuchElementException");

100 } 
	`ÿtch
 (
NoSuchEËm’tExû±iÚ
 
e
) {

101 
	`as£¹Equ®s
(
i
, 2);

103 
	}
}

105 @
Te¡


106 
public
 
	$šv®idL’gths
(è
throws
 
Exû±iÚ
 {

107 
Œy
 {

108 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(0, 
ATOC
);

109 
	`ç
("Expected IllegalArgumentException");

110 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) { }

112 
Œy
 {

113 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(-42, 
ATOC
);

114 
	`ç
("Expected IllegalArgumentException");

115 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) { }

116 
	}
}

118 @
Te¡


119 
public
 
	$šv®idCh¬aù”S‘s
(è
throws
 
Exû±iÚ
 {

120 
Œy
 {

121 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(2, 
nuÎ
);

122 
	`ç
("Expected IllegalArgumentException");

123 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) { }

125 
Œy
 {

126 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(2,‚ew [] {});

127 
	`ç
("Expected IllegalArgumentException");

128 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) { }

129 
	}
}

	@core/src/test/java/site/ycsb/generator/TestRandomDiscreteTimestampGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹Equ®s
;

20 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gç
;

22 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

23 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

26 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

27 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gcŞËùiÚs
.
	gLi¡s
;

29 
public
 cÏs 
	cTe¡RªdomDisü‘eTime¡ampG’”©Ü
 {

31 @
Te¡


32 
public
 
	$sy¡emTime
(è
throws
 
Exû±iÚ
 {

33 
fš®
 
RªdomDisü‘eTime¡ampG’”©Ü
 
g’”©Ü
 =

34 
Ãw
 
	`RªdomDisü‘eTime¡ampG’”©Ü
(60, 
TimeUn™
.
SECONDS
, 60);

35 
Li¡
<
LÚg
> 
g’”©ed
 = 
Li¡s
.
	`ÃwA¼ayLi¡
();

36 
i
 = 0; i < 60; i++) {

37 
g’”©ed
.
	`add
(
g’”©Ü
.
	`ÃxtV®ue
());

39 
	`as£¹Equ®s
(
g’”©ed
.
	`size
(), 60);

40 
Œy
 {

41 
g’”©Ü
.
	`ÃxtV®ue
();

42 
	`ç
("Expected IllegalStateException");

43 } 
	`ÿtch
 (
IÎeg®S‹Exû±iÚ
 
e
) { }

46 @
Te¡


47 
public
 
	$w™hS¹Time
(è
throws
 
Exû±iÚ
 {

48 
fš®
 
RªdomDisü‘eTime¡ampG’”©Ü
 
g’”©Ü
 =

49 
Ãw
 
	`RªdomDisü‘eTime¡ampG’”©Ü
(60, 
TimeUn™
.
SECONDS
, 1072915200L, 60);

50 
Li¡
<
LÚg
> 
g’”©ed
 = 
Li¡s
.
	`ÃwA¼ayLi¡
();

51 
i
 = 0; i < 60; i++) {

52 
g’”©ed
.
	`add
(
g’”©Ü
.
	`ÃxtV®ue
());

54 
	`as£¹Equ®s
(
g’”©ed
.
	`size
(), 60);

55 
CŞËùiÚs
.
	`sÜt
(
g’”©ed
);

56 
ts
 = 1072915200L - 60;

57 
fš®
 
t
 : 
g’”©ed
) {

58 
	`as£¹Equ®s
(
t
, 
ts
);

59 
ts
 += 60;

61 
Œy
 {

62 
g’”©Ü
.
	`ÃxtV®ue
();

63 
	`ç
("Expected IllegalStateException");

64 } 
	`ÿtch
 (
IÎeg®S‹Exû±iÚ
 
e
) { }

65 
	}
}

67 @
	$Te¡
 (
ex³ùedExû±iÚs
 = 
IÎeg®Argum’tExû±iÚ
.
şass
)

68 
public
 
	$tooL¬ge
(è
throws
 
Exû±iÚ
 {

69 
Ãw
 
	`RªdomDisü‘eTime¡ampG’”©Ü
(60, 
TimeUn™
.
SECONDS
,

70 
RªdomDisü‘eTime¡ampG’”©Ü
.
MAX_INTERVALS
 + 1);

71 
	}
}

	@core/src/test/java/site/ycsb/generator/TestUnixEpochTimestampGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹Equ®s
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

22 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

24 
public
 cÏs 
	cTe¡UnixEpochTime¡ampG’”©Ü
 {

26 @
Te¡


27 
public
 
	$deçuÉCtÜ
(è
throws
 
Exû±iÚ
 {

28 
fš®
 
UnixEpochTime¡ampG’”©Ü
 
g’”©Ü
 =

29 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
();

30 
fš®
 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

31 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 60);

32 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

33 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 120);

34 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 + 60);

35 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 180);

38 @
Te¡


39 
public
 
	$ùÜW™hIÁ”v®AndUn™s
(è
throws
 
Exû±iÚ
 {

40 
fš®
 
UnixEpochTime¡ampG’”©Ü
 
g’”©Ü
 =

41 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(120, 
TimeUn™
.
SECONDS
);

42 
fš®
 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

43 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 120);

44 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

45 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 240);

46 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 + 120);

47 
	}
}

49 @
Te¡


50 
public
 
	$ùÜW™hIÁ”v®AndUn™sAndS¹
(è
throws
 
Exû±iÚ
 {

51 
fš®
 
UnixEpochTime¡ampG’”©Ü
 
g’”©Ü
 =

52 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(120, 
TimeUn™
.
SECONDS
, 1072915200L);

53 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 1072915200L);

54 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 1072915200L - 120);

55 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 1072915200L + 120);

56 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 1072915200L);

57 
	}
}

59 @
Te¡


60 
public
 
	$v¬iousIÁ”v®sAndUn™s
(è
throws
 
Exû±iÚ
 {

62 
UnixEpochTime¡ampG’”©Ü
 
g’”©Ü
 =

63 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(-60, 
TimeUn™
.
SECONDS
);

64 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

65 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 - 60);

66 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

67 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 - 120);

68 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 - 60);

70 
g’”©Ü
 = 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(100, 
TimeUn™
.
NANOSECONDS
);

71 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

72 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 100);

73 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

74 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 200);

75 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 + 100);

77 
g’”©Ü
 = 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(100, 
TimeUn™
.
MICROSECONDS
);

78 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

79 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 100);

80 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

81 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 200);

82 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 + 100);

84 
g’”©Ü
 = 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(100, 
TimeUn™
.
MILLISECONDS
);

85 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

86 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 100);

87 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

88 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 200);

89 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 + 100);

91 
g’”©Ü
 = 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(100, 
TimeUn™
.
SECONDS
);

92 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

93 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 100);

94 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

95 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + 200);

96 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 + 100);

98 
g’”©Ü
 = 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(1, 
TimeUn™
.
MINUTES
);

99 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

100 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + (1 * 60));

101 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

102 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + (2 * 60));

103 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 + (1 * 60));

105 
g’”©Ü
 = 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(1, 
TimeUn™
.
HOURS
);

106 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

107 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + (1 * 60 * 60));

108 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

109 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + (2 * 60 * 60));

110 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 + (1 * 60 * 60));

112 
g’”©Ü
 = 
Ãw
 
	`UnixEpochTime¡ampG’”©Ü
(1, 
TimeUn™
.
DAYS
);

113 
¡¬tTime
 = 
g’”©Ü
.
	`cu¼’tV®ue
();

114 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + (1 * 60 * 60 * 24));

115 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
);

116 
	`as£¹Equ®s
((è
g’”©Ü
.
	`ÃxtV®ue
(), 
¡¬tTime
 + (2 * 60 * 60 * 24));

117 
	`as£¹Equ®s
((è
g’”©Ü
.
	`Ï¡V®ue
(), 
¡¬tTime
 + (1 * 60 * 60 * 24));

118 
	}
}

	@core/src/test/java/site/ycsb/generator/TestZipfianGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

22 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹JUn™
.
	gas£¹F®£
;

25 
public
 cÏs 
	cTe¡ZfŸnG’”©Ü
 {

26 @
Te¡


27 
public
 
	$‹¡MšAndMaxP¬am‘”
() {

28 
mš
 = 5;

29 
max
 = 10;

30 
ZfŸnG’”©Ü
 
zfŸn
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
mš
, 
max
);

32 
i
 = 0; i < 10000; i++) {

33 
ºd
 = 
zfŸn
.
	`ÃxtV®ue
();

34 
	`as£¹F®£
(
ºd
 < 
mš
);

35 
	`as£¹F®£
(
ºd
 > 
max
);

39 
	}
}

	@core/src/test/java/site/ycsb/measurements/exporter/TestMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gZfŸnG’”©Ü
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gOÃM—su»m’tHi¡og¿m
;

23 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚNode
;

24 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gm­
.
	gObjeùM­³r
;

25 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

27 
impÜt
 
	gjava
.
	gio
.
	gBy‹A¼ayOuutSŒ—m
;

28 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

31 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹JUn™
.
	gas£¹Equ®s
;

32 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹JUn™
.
	gas£¹True
;

34 
public
 cÏs 
	cTe¡M—su»m’tsExpÜ‹r
 {

35 @
Te¡


36 
public
 
	$‹¡JSONA¼ayM—su»m’tsExpÜ‹r
(è
throws
 
IOExû±iÚ
 {

37 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

38 
´İs
.
	`put
(
M—su»m’ts
.
MEASUREMENT_TYPE_PROPERTY
, "histogram");

39 
´İs
.
	`put
(
OÃM—su»m’tHi¡og¿m
.
VERBOSE_PROPERTY
, "true");

40 
M—su»m’ts
 
mm
 = 
Ãw
 
	`M—su»m’ts
(
´İs
);

41 
By‹A¼ayOuutSŒ—m
 
out
 = 
Ãw
 
	`By‹A¼ayOuutSŒ—m
();

42 
JSONA¼ayM—su»m’tsExpÜ‹r
 
expÜt
 = 
Ãw
 
	`JSONA¼ayM—su»m’tsExpÜ‹r
(
out
);

44 
mš
 = 5000;

45 
max
 = 100000;

46 
ZfŸnG’”©Ü
 
zfŸn
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
mš
, 
max
);

47 
i
 = 0; i < 1000; i++) {

48 
ºd
 = 
zfŸn
.
	`ÃxtV®ue
().
	`štV®ue
();

49 
mm
.
	`m—su»
("UPDATE", 
ºd
);

51 
mm
.
	`expÜtM—su»m’ts
(
expÜt
);

52 
expÜt
.
	`şo£
();

54 
ObjeùM­³r
 
m­³r
 = 
Ãw
 
	`ObjeùM­³r
();

55 
JsÚNode
 
jsÚ
 = 
m­³r
.
	`»adT»e
(
out
.
	`toSŒšg
("UTF-8"));

56 
	`as£¹True
(
jsÚ
.
	`isA¼ay
());

57 
	`as£¹Equ®s
(
jsÚ
.
	`g‘
(0).g‘("m—su»m’t").
	`asText
(), "Operations");

58 
	`as£¹Equ®s
(
jsÚ
.
	`g‘
(4).g‘("m—su»m’t").
	`asText
(), "MaxLatency(us)");

59 
	`as£¹Equ®s
(
jsÚ
.
	`g‘
(11).g‘("m—su»m’t").
	`asText
(), "4");

61 
	}
}

	@core/src/test/java/site/ycsb/workloads/TestCoreWorkload.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

19 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹True
;

21 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

23 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gDisü‘eG’”©Ü
;

27 
public
 cÏs 
	cTe¡CÜeWÜklßd
 {

29 @
Te¡


30 
public
 
	$ü—‹O³¿tiÚChoo£r
() {

31 
fš®
 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

32 
p
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
READ_PROPORTION_PROPERTY
, "0.20");

33 
p
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
UPDATE_PROPORTION_PROPERTY
, "0.20");

34 
p
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
INSERT_PROPORTION_PROPERTY
, "0.20");

35 
p
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
SCAN_PROPORTION_PROPERTY
, "0.20");

36 
p
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
READMODIFYWRITE_PROPORTION_PROPERTY
, "0.20");

37 
fš®
 
Disü‘eG’”©Ü
 
g’”©Ü
 = 
CÜeWÜklßd
.
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

38 
fš®
 [] 
couÁs
 = 
Ãw
 [5];

40 
i
 = 0; i < 100; ++i) {

41 
g’”©Ü
.
	`ÃxtSŒšg
()) {

43 ++
couÁs
[0];

46 ++
couÁs
[1];

49 ++
couÁs
[2];

52 ++
couÁs
[3];

55 ++
couÁs
[4];

59 
i
 : 
couÁs
) {

62 
	`as£¹True
(
i
 > 1);

66 @
	$Te¡
 (
ex³ùedExû±iÚs
 = 
IÎeg®Argum’tExû±iÚ
.
şass
)

67 
public
 
	$ü—‹O³¿tiÚChoo£rNuÎPrİ”t›s
() {

68 
CÜeWÜklßd
.
	`ü—‹O³¿tiÚG’”©Ü
(
nuÎ
);

69 
	}
}

	@core/src/test/java/site/ycsb/workloads/TestTimeSeriesWorkload.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

19 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹Equ®s
;

20 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹F®£
;

21 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

22 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gas£¹True
;

23 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gAs£¹
.
	gç
;

25 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

26 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

28 
impÜt
 
	gjava
.
	gut
.
	gM­
;

29 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

31 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

32 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

33 
impÜt
 
	gjava
.
	gut
.
	gT»eM­
;

34 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gNum”icBy‹I‹¿tÜ
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

46 
impÜt
 
	gÜg
.
	g‹¡ng
.
	gªnÙ©iÚs
.
	gTe¡
;

48 
public
 cÏs 
	cTe¡TimeS”›sWÜklßd
 {

50 @
Te¡


51 
public
 
	$twoTh»ads
(è
throws
 
Exû±iÚ
 {

52 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

53 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

55 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
Ãw
 
	`TimeS”›sWÜklßd
();

56 
wl
.
	`š™
(
p
);

57 
Objeù
 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 0, 2);

59 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

60 
i
 = 0; i < 74; i++) {

61 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

64 
	`as£¹Equ®s
(
db
.
keys
.
	`size
(), 74);

65 
	`as£¹Equ®s
(
db
.
v®ues
.
	`size
(), 74);

66 
time¡amp
 = 1451606400;

67 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

68 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAA");

69 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

70 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

71 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

72 
	`as£¹NÙNuÎ
(
db
.
v®ues
.
	`g‘
(
i
).g‘(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
));

73 ià(
i
 % 2 == 0) {

74 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAA");

76 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAB");

77 
time¡amp
 += 60;

81 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 1, 2);

82 
db
 = 
Ãw
 
	`MockDB
();

83 
i
 = 0; i < 74; i++) {

84 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

87 
	`as£¹Equ®s
(
db
.
keys
.
	`size
(), 74);

88 
	`as£¹Equ®s
(
db
.
v®ues
.
	`size
(), 74);

89 
time¡amp
 = 1451606400;

90 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

91 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAB");

92 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

93 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

94 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

95 
	`as£¹NÙNuÎ
(
db
.
v®ues
.
	`g‘
(
i
).g‘(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
));

96 ià(
i
 % 2 == 0) {

97 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAA");

99 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAB");

100 
time¡amp
 += 60;

105 @
	$Te¡
 (
ex³ùedExû±iÚs
 = 
WÜklßdExû±iÚ
.
şass
)

106 
public
 
	$badTimeUn™
(è
throws
 
Exû±iÚ
 {

107 
fš®
 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

108 
p
.
	`put
(
TimeS”›sWÜklßd
.
TIMESTAMP_UNITS_PROPERTY
, "foobar");

109 
	`g‘WÜklßd
(
p
, 
Œue
);

110 
	}
}

112 @
	$Te¡
 (
ex³ùedExû±iÚs
 = 
WÜklßdExû±iÚ
.
şass
)

113 
public
 
	$çedToIn™WÜklßdBefÜeTh»adIn™
(è
throws
 
Exû±iÚ
 {

114 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

115 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
çl£
);

117 
fš®
 
Objeù
 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 0, 2);

119 
fš®
 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

120 
wl
.
	`doIn£¹
(
db
, 
th»adS‹
);

121 
	}
}

123 @
	$Te¡
 (
ex³ùedExû±iÚs
 = 
IÎeg®S‹Exû±iÚ
.
şass
)

124 
public
 
	$çedToIn™Th»ad
(è
throws
 
Exû±iÚ
 {

125 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

126 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
Œue
);

128 
fš®
 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

129 
wl
.
	`doIn£¹
(
db
, 
nuÎ
);

130 
	}
}

132 @
Te¡


133 
public
 
	$š£¹OÃKeyOÃTagC¬dš®™yOÃ
(è
throws
 
Exû±iÚ
 {

134 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

135 
p
.
	`put
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
, "1");

136 
p
.
	`put
(
TimeS”›sWÜklßd
.
TAG_COUNT_PROPERTY
, "1");

137 
p
.
	`put
(
TimeS”›sWÜklßd
.
TAG_CARDINALITY_PROPERTY
, "1");

138 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
Œue
);

139 
fš®
 
Objeù
 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 0, 1);

141 
fš®
 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

142 
i
 = 0; i < 74; i++) {

143 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

145 
	`as£¹Equ®s
(
db
.
keys
.
	`size
(), 74);

146 
	`as£¹Equ®s
(
db
.
v®ues
.
	`size
(), 74);

147 
time¡amp
 = 1451606400;

148 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

149 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAA");

150 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

151 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

152 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

153 
	`as£¹True
(((
Num”icBy‹I‹¿tÜ
è
db
.
v®ues
.
	`g‘
(
i
)

154 .
	`g‘
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
)).
	`isFlßtšgPošt
());

155 
time¡amp
 += 60;

157 
	}
}

159 @
Te¡


160 
public
 
	$š£¹OÃKeyTwoTagsLowC¬dš®™y
(è
throws
 
Exû±iÚ
 {

161 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

162 
p
.
	`put
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
, "1");

163 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
Œue
);

164 
fš®
 
Objeù
 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 0, 1);

166 
fš®
 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

167 
i
 = 0; i < 74; i++) {

168 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

171 
	`as£¹Equ®s
(
db
.
keys
.
	`size
(), 74);

172 
	`as£¹Equ®s
(
db
.
v®ues
.
	`size
(), 74);

173 
time¡amp
 = 1451606400;

174 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

175 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAA");

176 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

177 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

178 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

179 
	`as£¹True
(((
Num”icBy‹I‹¿tÜ
è
db
.
v®ues
.
	`g‘
(
i
)

180 .
	`g‘
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
)).
	`isFlßtšgPošt
());

181 ià(
i
 % 2 == 0) {

182 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAA");

184 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAB");

185 
time¡amp
 += 60;

188 
	}
}

190 @
Te¡


191 
public
 
	$š£¹TwoKeysTwoTagsLowC¬dš®™y
(è
throws
 
Exû±iÚ
 {

192 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

194 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
Œue
);

195 
fš®
 
Objeù
 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 0, 1);

197 
fš®
 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

198 
i
 = 0; i < 74; i++) {

199 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

202 
	`as£¹Equ®s
(
db
.
keys
.
	`size
(), 74);

203 
	`as£¹Equ®s
(
db
.
v®ues
.
	`size
(), 74);

204 
time¡amp
 = 1451606400;

205 
m‘ricCŒ
 = 0;

206 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

207 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

208 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

209 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

210 
	`as£¹True
(((
Num”icBy‹I‹¿tÜ
è
db
.
v®ues
.
	`g‘
(
i
)

211 .
	`g‘
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
)).
	`isFlßtšgPošt
());

212 ià(
i
 % 2 == 0) {

213 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAA");

215 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAB");

217 ià(
m‘ricCŒ
++ > 1) {

218 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAB");

219 ià(
m‘ricCŒ
 >= 4) {

220 
m‘ricCŒ
 = 0;

221 
time¡amp
 += 60;

224 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAA");

227 
	}
}

229 @
Te¡


230 
public
 
	$š£¹TwoKeysTwoTh»ads
(è
throws
 
Exû±iÚ
 {

231 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

233 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
Œue
);

234 
Objeù
 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 0, 2);

236 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

237 
i
 = 0; i < 74; i++) {

238 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

241 
	`as£¹Equ®s
(
db
.
keys
.
	`size
(), 74);

242 
	`as£¹Equ®s
(
db
.
v®ues
.
	`size
(), 74);

243 
time¡amp
 = 1451606400;

244 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

245 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAA");

246 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

247 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

248 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

249 
	`as£¹True
(((
Num”icBy‹I‹¿tÜ
è
db
.
v®ues
.
	`g‘
(
i
)

250 .
	`g‘
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
)).
	`isFlßtšgPošt
());

251 ià(
i
 % 2 == 0) {

252 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAA");

254 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAB");

255 
time¡amp
 += 60;

259 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 1, 2);

260 
db
 = 
Ãw
 
	`MockDB
();

261 
i
 = 0; i < 74; i++) {

262 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

265 
	`as£¹Equ®s
(
db
.
keys
.
	`size
(), 74);

266 
	`as£¹Equ®s
(
db
.
v®ues
.
	`size
(), 74);

267 
time¡amp
 = 1451606400;

268 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

269 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAB");

270 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

271 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

272 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

273 
	`as£¹NÙNuÎ
(
db
.
v®ues
.
	`g‘
(
i
).g‘(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
));

274 ià(
i
 % 2 == 0) {

275 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAA");

277 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAB");

278 
time¡amp
 += 60;

281 
	}
}

283 @
Te¡


284 
public
 
	$š£¹Th»eKeysTwoTh»ads
(è
throws
 
Exû±iÚ
 {

286 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

287 
p
.
	`put
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
, "3");

289 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
Œue
);

290 
Objeù
 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 0, 2);

292 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

293 
i
 = 0; i < 74; i++) {

294 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

297 
	`as£¹Equ®s
(
db
.
keys
.
	`size
(), 74);

298 
	`as£¹Equ®s
(
db
.
v®ues
.
	`size
(), 74);

299 
time¡amp
 = 1451606400;

300 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

301 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAA");

302 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

303 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

304 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

305 
	`as£¹True
(((
Num”icBy‹I‹¿tÜ
è
db
.
v®ues
.
	`g‘
(
i
)

306 .
	`g‘
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
)).
	`isFlßtšgPošt
());

307 ià(
i
 % 2 == 0) {

308 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAA");

310 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAB");

311 
time¡amp
 += 60;

315 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 1, 2);

316 
db
 = 
Ãw
 
	`MockDB
();

317 
i
 = 0; i < 74; i++) {

318 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

321 
time¡amp
 = 1451606400;

322 
m‘ricCŒ
 = 0;

323 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

324 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

325 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

326 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

327 
	`as£¹NÙNuÎ
(
db
.
v®ues
.
	`g‘
(
i
).g‘(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
));

328 ià(
i
 % 2 == 0) {

329 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAA");

331 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAB");

333 ià(
m‘ricCŒ
++ > 1) {

334 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAC");

335 ià(
m‘ricCŒ
 >= 4) {

336 
m‘ricCŒ
 = 0;

337 
time¡amp
 += 60;

340 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAB");

343 
	}
}

345 @
Te¡


346 
public
 
	$š£¹W™hV®id©iÚ
(è
throws
 
Exû±iÚ
 {

347 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

348 
p
.
	`put
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
, "1");

349 
p
.
	`put
(
CÜeWÜklßd
.
DATA_INTEGRITY_PROPERTY
, "true");

350 
p
.
	`put
(
TimeS”›sWÜklßd
.
VALUE_TYPE_PROPERTY
, "integers");

351 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
Œue
);

352 
fš®
 
Objeù
 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 0, 1);

354 
fš®
 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

355 
i
 = 0; i < 74; i++) {

356 
	`as£¹True
(
wl
.
	`doIn£¹
(
db
, 
th»adS‹
));

359 
	`as£¹Equ®s
(
db
.
keys
.
	`size
(), 74);

360 
	`as£¹Equ®s
(
db
.
v®ues
.
	`size
(), 74);

361 
time¡amp
 = 1451606400;

362 
i
 = 0; i < 
db
.
keys
.
	`size
(); i++) {

363 
	`as£¹Equ®s
(
db
.
keys
.
	`g‘
(
i
), "AAAA");

364 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AA").
	`toSŒšg
(), "AAAA");

365 
	`as£¹Equ®s
(
Uts
.
	`by‹sToLÚg
(
db
.
v®ues
.
	`g‘
(
i
).get(

366 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
).
	`toA¼ay
()), 
time¡amp
);

367 
	`as£¹F®£
(((
Num”icBy‹I‹¿tÜ
è
db
.
v®ues
.
	`g‘
(
i
)

368 .
	`g‘
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
)).
	`isFlßtšgPošt
());

371 
fš®
 
T»eM­
<
SŒšg
, SŒšg> 
v®id©iÚTags
 = 
Ãw
 TreeMap<String, String>();

372 
fš®
 
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’Œy
 : 
db
.
v®ues
.
	`g‘
(
i
).
	`’ŒyS‘
()) {

373 ià(
’Œy
.
	`g‘Key
().
	`equ®s
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
) ||

374 
’Œy
.
	`g‘Key
().
	`equ®s
(
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
)) {

377 
v®id©iÚTags
.
	`put
(
’Œy
.
	`g‘Key
(),ƒÁry.
	`g‘V®ue
().
	`toSŒšg
());

379 
	`as£¹Equ®s
(
wl
.
	`v®id©iÚFunùiÚ
(
db
.
keys
.
	`g‘
(
i
), 
time¡amp
, 
v®id©iÚTags
),

380 ((
Num”icBy‹I‹¿tÜ
è
db
.
v®ues
.
	`g‘
(
i
).g‘(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
)).
	`g‘LÚg
());

382 ià(
i
 % 2 == 0) {

383 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAA");

385 
	`as£¹Equ®s
(
db
.
v®ues
.
	`g‘
(
i
).g‘("AB").
	`toSŒšg
(), "AAAB");

386 
time¡amp
 += 60;

389 
	}
}

391 @
Te¡


392 
public
 
	$»ad
(è
throws
 
Exû±iÚ
 {

393 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

394 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
Œue
);

395 
fš®
 
Objeù
 
th»adS‹
 = 
wl
.
	`š™Th»ad
(
p
, 0, 1);

397 
fš®
 
MockDB
 
db
 = 
Ãw
 
	`MockDB
();

398 
i
 = 0; i < 20; i++) {

399 
wl
.
	`doT¿n§ùiÚR—d
(
db
, 
th»adS‹
);

401 
	}
}

403 @
Te¡


404 
public
 
	$v”ifyRow
(è
throws
 
Exû±iÚ
 {

405 
fš®
 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

406 
fš®
 
TimeS”›sWÜklßd
 
wl
 = 
	`g‘WÜklßd
(
p
, 
Œue
);

408 
fš®
 
T»eM­
<
SŒšg
, SŒšg> 
v®id©iÚTags
 = 
Ãw
 TreeMap<String, String>();

409 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 HashMap<String, ByteIterator>();

411 
v®id©iÚTags
.
	`put
("AA", "AAAA");

412 
ûÎs
.
	`put
("AA", 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
("AAAA"));

413 
v®id©iÚTags
.
	`put
("AB", "AAAB");

414 
ûÎs
.
	`put
("AB", 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
("AAAB"));

415 
hash
 = 
wl
.
	`v®id©iÚFunùiÚ
("AAAA", 1451606400L, 
v®id©iÚTags
);

417 
ûÎs
.
	`put
(
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
, 
Ãw
 
	`Num”icBy‹I‹¿tÜ
(1451606400L));

418 
ûÎs
.
	`put
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
, 
Ãw
 
	`Num”icBy‹I‹¿tÜ
(
hash
));

420 
	`as£¹Equ®s
(
wl
.
	`v”ifyRow
("AAAA", 
ûÎs
), 
Stus
.
OK
);

423 
fš®
 
By‹I‹¿tÜ
 
™
 : 
ûÎs
.
	`v®ues
()) {

424 
™
.
	`»£t
();

426 
ûÎs
.
	`put
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
, 
Ãw
 
	`Num”icBy‹I‹¿tÜ
(
hash
 + 1));

427 
	`as£¹Equ®s
(
wl
.
	`v”ifyRow
("AAAA", 
ûÎs
), 
Stus
.
UNEXPECTED_STATE
);

430 
fš®
 
By‹I‹¿tÜ
 
™
 : 
ûÎs
.
	`v®ues
()) {

431 
™
.
	`»£t
();

433 
ûÎs
.
	`»move
(
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
);

434 
	`as£¹Equ®s
(
wl
.
	`v”ifyRow
("AAAA", 
ûÎs
), 
Stus
.
UNEXPECTED_STATE
);

435 
	}
}

437 @
Te¡


438 
public
 
	$v®id©eS‘tšgsD©aIÁegr™y
(è
throws
 
Exû±iÚ
 {

439 
Prİ”t›s
 
p
 = 
	`g‘UTPrİ”t›s
();

442 
p
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
DATA_INTEGRITY_PROPERTY
, "true");

443 
Œy
 {

444 
	`g‘WÜklßd
(
p
, 
Œue
);

445 
	`ç
("Expected WorkloadException");

446 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) { }

448 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
VALUE_TYPE_PROPERTY
, "integers");

449 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
GROUPBY_PROPERTY
, "sum");

450 
Œy
 {

451 
	`g‘WÜklßd
(
p
, 
Œue
);

452 
	`ç
("Expected WorkloadException");

453 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) { }

455 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
GROUPBY_PROPERTY
, "");

456 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_FUNCTION_PROPERTY
, "sum");

457 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_INTERVAL_PROPERTY
, "60");

458 
Œy
 {

459 
	`g‘WÜklßd
(
p
, 
Œue
);

460 
	`ç
("Expected WorkloadException");

461 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) { }

463 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_FUNCTION_PROPERTY
, "");

464 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_INTERVAL_PROPERTY
, "");

465 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_PROPERTY
, "60");

466 
Œy
 {

467 
	`g‘WÜklßd
(
p
, 
Œue
);

468 
	`ç
("Expected WorkloadException");

469 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) { }

471 
p
 = 
	`g‘UTPrİ”t›s
();

472 
p
.
	`£tPrİ”ty
(
CÜeWÜklßd
.
DATA_INTEGRITY_PROPERTY
, "true");

473 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
VALUE_TYPE_PROPERTY
, "integers");

474 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
RANDOMIZE_TIMESERIES_ORDER_PROPERTY
, "true");

475 
Œy
 {

476 
	`g‘WÜklßd
(
p
, 
Œue
);

477 
	`ç
("Expected WorkloadException");

478 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) { }

480 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
RANDOMIZE_TIMESERIES_ORDER_PROPERTY
, "false");

481 
p
.
	`£tPrİ”ty
(
TimeS”›sWÜklßd
.
INSERT_START_PROPERTY
, "");

482 
Œy
 {

483 
	`g‘WÜklßd
(
p
, 
Œue
);

484 
	`ç
("Expected WorkloadException");

485 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) { }

486 
	}
}

489 
´iv©e
 
Prİ”t›s
 
	$g‘UTPrİ”t›s
() {

490 
fš®
 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

491 
p
.
	`put
(
Cl›Á
.
RECORD_COUNT_PROPERTY
, "10");

492 
p
.
	`put
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
, "2");

493 
p
.
	`put
(
CÜeWÜklßd
.
FIELD_LENGTH_PROPERTY
, "4");

494 
p
.
	`put
(
TimeS”›sWÜklßd
.
TAG_KEY_LENGTH_PROPERTY
, "2");

495 
p
.
	`put
(
TimeS”›sWÜklßd
.
TAG_VALUE_LENGTH_PROPERTY
, "4");

496 
p
.
	`put
(
TimeS”›sWÜklßd
.
TAG_COUNT_PROPERTY
, "2");

497 
p
.
	`put
(
TimeS”›sWÜklßd
.
TAG_CARDINALITY_PROPERTY
, "1,2");

498 
p
.
	`put
(
CÜeWÜklßd
.
INSERT_START_PROPERTY
, "1451606400");

499 
p
.
	`put
(
TimeS”›sWÜklßd
.
DELAYED_SERIES_PROPERTY
, "0");

500 
p
.
	`put
(
TimeS”›sWÜklßd
.
RANDOMIZE_TIMESERIES_ORDER_PROPERTY
, "false");

501  
p
;

502 
	}
}

505 
´iv©e
 
TimeS”›sWÜklßd
 
	$g‘WÜklßd
(
fš®
 
Prİ”t›s
 
p
, fš® 
boŞ—n
 
š™
)

506 
throws
 
WÜklßdExû±iÚ
 {

507 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

508 ià(!
š™
) {

509  
Ãw
 
	`TimeS”›sWÜklßd
();

511 
fš®
 
TimeS”›sWÜklßd
 
wÜklßd
 = 
Ãw
 
	`TimeS”›sWÜklßd
();

512 
wÜklßd
.
	`š™
(
p
);

513  
wÜklßd
;

515 
	}
}

517 şas 
	cMockDB
 
ex‹nds
 
	gDB
 {

518 
fš®
 
	gLi¡
<
	gSŒšg
> 
	gkeys
 = 
Ãw
 
A¼ayLi¡
<
SŒšg
>();

519 
fš®
 
	gLi¡
<
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
>> 
	gv®ues
 =

520 
Ãw
 
A¼ayLi¡
<
M­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>>();

522 @
Ov”ride


523 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

524 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

525  
	gStus
.
	gOK
;

528 @
Ov”ride


529 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

530 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

532  
	gStus
.
	gOK
;

535 @
Ov”ride


536 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

537 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

539  
	gStus
.
	gOK
;

542 @
Ov”ride


543 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

544 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

545 
	gkeys
.
add
(
key
);

546 
	gthis
.
	gv®ues
.
add
(
v®ues
);

547  
	gStus
.
	gOK
;

550 @
Ov”ride


551 
public
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

553  
	gStus
.
	gOK
;

556 
public
 
dumpStdout
() {

557 
	gi
 = 0; i < 
	gkeys
.
size
(); i++) {

558 
	gSy¡em
.
	gout
.
´št
("[" + 
i
 + "] Key: " + 
keys
.
g‘
(i) + " Values: {");

559 
	gx
 = 0;

560 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
g‘
(
i
).
’ŒyS‘
()) {

561 ià(
x
++ > 0) {

562 
Sy¡em
.
out
.
´št
(", ");

564 
	gSy¡em
.
	gout
.
´št
("{" + 
’Œy
.
g‘Key
() + " => ");

565 ià(
	g’Œy
.
g‘Key
().
equ®s
("YCSBV")) {

566 
	gSy¡em
.
	gout
.
´št
(
Ãw
 
SŒšg
(
Uts
.
by‹sToDoubË
(
’Œy
.
g‘V®ue
().
toA¼ay
()) + "}"));

567 } ià(
	g’Œy
.
g‘Key
().
equ®s
("YCSBTS")) {

568 
	gSy¡em
.
	gout
.
´št
(
Ãw
 
SŒšg
(
Uts
.
by‹sToLÚg
(
’Œy
.
g‘V®ue
().
toA¼ay
()) + "}"));

570 
	gSy¡em
.
	gout
.
´št
(
Ãw
 
SŒšg
(
’Œy
.
g‘V®ue
().
toA¼ay
()) + "}");

573 
	gSy¡em
.
	gout
.
´šn
("}");

	@couchbase/src/main/java/site/ycsb/db/CouchbaseClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	g´ÙocŞ
.
	gv›ws
.*;

21 
impÜt
 
	gcom
.
	gç¡”xml
.
	gjacksÚ
.
	gcÜe
.
	gJsÚFaùÜy
;

22 
impÜt
 
	gcom
.
	gç¡”xml
.
	gjacksÚ
.
	gcÜe
.
	gJsÚG’”©Ü
;

23 
impÜt
 
	gcom
.
	gç¡”xml
.
	gjacksÚ
.
	gd©abšd
.
	gJsÚNode
;

24 
impÜt
 
	gcom
.
	gç¡”xml
.
	gjacksÚ
.
	gd©abšd
.
	gObjeùM­³r
;

25 
impÜt
 
	gcom
.
	gç¡”xml
.
	gjacksÚ
.
	gd©abšd
.
	gnode
.
	gObjeùNode
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

32 
impÜt
 
	gÃt
.
	g¥y
.
	gmemÿched
.
	gP”si¡To
;

33 
impÜt
 
	gÃt
.
	g¥y
.
	gmemÿched
.
	gR•liÿ‹To
;

34 
impÜt
 
	gÃt
.
	g¥y
.
	gmemÿched
.
	gš‹º®
.
	gO³¿tiÚFutu»
;

36 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

37 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

39 
impÜt
 
	gjava
.
	gio
.
	gSŒšgWr™”
;

40 
impÜt
 
	gjava
.
	gio
.
	gWr™”
;

41 
impÜt
 
	gjava
.
	gÃt
.
	gURI
;

42 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

43 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

44 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

45 
impÜt
 
	gjava
.
	gut
.
	gM­
;

46 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

47 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

48 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

54 
public
 cÏs 
	cCouchba£Cl›Á
 
ex‹nds
 
	mDB
 {

55 
public
 
fš®
 
SŒšg
 
	mURL_PROPERTY
 = "couchbase.url";

56 
public
 
fš®
 
SŒšg
 
	mBUCKET_PROPERTY
 = "couchbase.bucket";

57 
public
 
fš®
 
SŒšg
 
	mPASSWORD_PROPERTY
 = "couchbase.password";

58 
public
 
fš®
 
SŒšg
 
	mCHECKF_PROPERTY
 = "couchbase.checkFutures";

59 
public
 
fš®
 
SŒšg
 
	mPERSIST_PROPERTY
 = "couchbase.persistTo";

60 
public
 
fš®
 
SŒšg
 
	mREPLICATE_PROPERTY
 = "couchbase.replicateTo";

61 
public
 
fš®
 
SŒšg
 
	mJSON_PROPERTY
 = "couchbase.json";

62 
public
 
fš®
 
SŒšg
 
	mDESIGN_DOC_PROPERTY
 = "couchbase.ddoc";

63 
public
 
fš®
 
SŒšg
 
	mVIEW_PROPERTY
 = "couchbase.view";

64 
public
 
fš®
 
SŒšg
 
	mSTALE_PROPERTY
 = "couchbase.stale";

65 
public
 
fš®
 
SŒšg
 
	mSCAN_PROPERTY
 = "scanproportion";

67 
public
 
fš®
 
SŒšg
 
	mSTALE_PROPERTY_DEFAULT
 = 
SË
.
OK
.
Çme
();

68 
public
 
fš®
 
SŒšg
 
	mSCAN_PROPERTY_DEFAULT
 = "0.0";

70 
´Ùeùed
 
fš®
 
ObjeùM­³r
 
	mJSON_MAPPER
 = 
Ãw
 ObjectMapper();

72 
´iv©e
 
	mcom
.
	mcouchba£
.
	mş›Á
.
Couchba£Cl›Á
 client;

73 
´iv©e
 
P”si¡To
 
	m³rsi¡To
;

74 
´iv©e
 
R•liÿ‹To
 
	m»¶iÿ‹To
;

75 
´iv©e
 
boŞ—n
 
	mcheckFutu»s
;

76 
´iv©e
 
boŞ—n
 
	mu£JsÚ
;

77 
´iv©e
 
SŒšg
 
	mdesignDoc
;

78 
´iv©e
 
SŒšg
 
	mv›wName
;

79 
´iv©e
 
SË
 
	m¡®e
;

80 
´iv©e
 
V›w
 
	mv›w
;

81 
´iv©e
 
fš®
 
Logg”
 
	mlog
 = 
Logg”FaùÜy
.
g‘Logg”
(
g‘CÏss
());

83 @
Ov”ride


84 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

85 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

87 
SŒšg
 
u¾
 = 
´İs
.
	`g‘Prİ”ty
(
URL_PROPERTY
, "http://127.0.0.1:8091/pools");

88 
SŒšg
 
buck‘
 = 
´İs
.
	`g‘Prİ”ty
(
BUCKET_PROPERTY
, "default");

89 
SŒšg
 
·sswÜd
 = 
´İs
.
	`g‘Prİ”ty
(
PASSWORD_PROPERTY
, "");

91 
checkFutu»s
 = 
´İs
.
	`g‘Prİ”ty
(
CHECKF_PROPERTY
, "Œue").
	`equ®s
("true");

92 
u£JsÚ
 = 
´İs
.
	`g‘Prİ”ty
(
JSON_PROPERTY
, "Œue").
	`equ®s
("true");

94 
³rsi¡To
 = 
	`·r£P”si¡To
(
´İs
.
	`g‘Prİ”ty
(
PERSIST_PROPERTY
, "0"));

95 
»¶iÿ‹To
 = 
	`·r£R•liÿ‹To
(
´İs
.
	`g‘Prİ”ty
(
REPLICATE_PROPERTY
, "0"));

97 
designDoc
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
DESIGN_DOC_PROPERTY
);

98 
v›wName
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
VIEW_PROPERTY
);

99 
¡®e
 = 
SË
.
	`v®ueOf
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
STALE_PROPERTY
, 
STALE_PROPERTY_DEFAULT
).
	`toUµ”Ca£
());

101 
DoubË
 
sÿÅrİÜtiÚ
 = DoubË.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
SCAN_PROPERTY
, 
SCAN_PROPERTY_DEFAULT
));

103 
Prİ”t›s
 
sy¡emPrİ”t›s
 = 
Sy¡em
.
	`g‘Prİ”t›s
();

104 
sy¡emPrİ”t›s
.
	`put
("net.spy.log.LoggerImpl", "net.spy.memcached.compat.log.SLF4JLogger");

105 
Sy¡em
.
	`£tPrİ”t›s
(
sy¡emPrİ”t›s
);

107 
Œy
 {

108 
ş›Á
 = 
Ãw
 
com
.
couchba£
.ş›Á.
	`Couchba£Cl›Á
(
A¼ays
.
	`asLi¡
Òew 
	`URI
(
u¾
)), 
buck‘
, 
·sswÜd
);

109 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

110 
throw
 
Ãw
 
	`DBExû±iÚ
("Could‚Ù c»©Couchba£Cl›Á objeù.", 
e
);

113 ià(
sÿÅrİÜtiÚ
 > 0) {

114 
Œy
 {

115 
v›w
 = 
ş›Á
.
	`g‘V›w
(
designDoc
, 
v›wName
);

116 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

117 
throw
 
Ãw
 
	`DBExû±iÚ
(
SŒšg
.
	`fÜm©
("%s=%s‡nd %s=%s…rovided, unableo connecto view.",

118 
DESIGN_DOC_PROPERTY
, 
designDoc
, 
VIEW_PROPERTY
, 
v›wName
), 
e
.
	`g‘Cau£
());

130 
´iv©e
 
R•liÿ‹To
 
	$·r£R•liÿ‹To
(
fš®
 
SŒšg
 
´İ”ty
è
throws
 
DBExû±iÚ
 {

131 
v®ue
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”ty
);

133 
v®ue
) {

135  
R•liÿ‹To
.
ZERO
;

137  
R•liÿ‹To
.
ONE
;

139  
R•liÿ‹To
.
TWO
;

141  
R•liÿ‹To
.
THREE
;

143 
throw
 
Ãw
 
	`DBExû±iÚ
(
REPLICATE_PROPERTY
 + " must be between 0‡nd 3");

145 
	}
}

154 
´iv©e
 
P”si¡To
 
	$·r£P”si¡To
(
fš®
 
SŒšg
 
´İ”ty
è
throws
 
DBExû±iÚ
 {

155 
v®ue
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”ty
);

157 
v®ue
) {

159  
P”si¡To
.
ZERO
;

161  
P”si¡To
.
ONE
;

163  
P”si¡To
.
TWO
;

165  
P”si¡To
.
THREE
;

167  
P”si¡To
.
FOUR
;

169 
throw
 
Ãw
 
	`DBExû±iÚ
(
PERSIST_PROPERTY
 + " must be between 0‡nd 4");

171 
	}
}

176 @
Ov”ride


177 
public
 
	$ş—nup
() {

178 
ş›Á
.
	`shutdown
();

179 
	}
}

181 @
Ov”ride


182 
public
 
Stus
 
»ad
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
S‘
<SŒšg> 
f›lds
,

183 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

184 
SŒšg
 
	gfÜm©‹dKey
 = 
fÜm©Key
(
bË
, 
key
);

186 
	gŒy
 {

187 
Objeù
 
	glßded
 = 
ş›Á
.
g‘
(
fÜm©‹dKey
);

189 ià(
	glßded
 =ğ
nuÎ
) {

190  
Stus
.
ERROR
;

193 
decode
(
lßded
, 
f›lds
, 
»suÉ
);

194  
	gStus
.
	gOK
;

195 } 
ÿtch
 (
Exû±iÚ
 
e
) {

196 ià(
	glog
.
isE¼ÜEÇbËd
()) {

197 
	glog
.
”rÜ
("Could‚Ù„—d v®ufÜ key " + 
fÜm©‹dKey
, 
e
);

199  
	gStus
.
	gERROR
;

203 @
Ov”ride


204 
public
 
Stus
 
sÿn
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
¡¬tkey
, fš® 
»cÜdcouÁ
, fš® 
S‘
<SŒšg> 
f›lds
,

205 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

206 
	gŒy
 {

207 
Qu”y
 
	gqu”y
 = 
Ãw
 Qu”y().
£tRªgeS¹
(
¡¬tkey
)

208 .
£tLim™
(
»cÜdcouÁ
)

209 .
£tInşudeDocs
(
Œue
)

210 .
£tSË
(
¡®e
);

211 
V›wRe¥Ú£
 
	g»¥Ú£
 = 
ş›Á
.
qu”y
(
v›w
, query);

213 
V›wRow
 
	grow
 : 
»¥Ú£
) {

214 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
> 
	growM­
 = 
Ãw
 HashMap();

215 
decode
(
row
.
g‘Docum’t
(), 
f›lds
, 
rowM­
);

216 
	g»suÉ
.
add
(
rowM­
);

219  
	gStus
.
	gOK
;

220 } 
ÿtch
 (
Exû±iÚ
 
e
) {

221 
	glog
.
”rÜ
(
e
.
g‘Mes§ge
());

224  
	gStus
.
	gERROR
;

227 @
Ov”ride


228 
public
 
Stus
 
upd©e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

229 
SŒšg
 
	gfÜm©‹dKey
 = 
fÜm©Key
(
bË
, 
key
);

231 
	gŒy
 {

232 
fš®
 
	gO³¿tiÚFutu»
<
	gBoŞ—n
> 
	gfutu»
 = 
ş›Á
.
»¶aû
(
fÜm©‹dKey
, 
’code
(
v®ues
), 
³rsi¡To
, 
»¶iÿ‹To
);

233  
checkFutu»Stus
(
futu»
);

234 } 
ÿtch
 (
Exû±iÚ
 
e
) {

235 ià(
	glog
.
isE¼ÜEÇbËd
()) {

236 
	glog
.
”rÜ
("Could‚Ù upd©v®ufÜ key " + 
fÜm©‹dKey
, 
e
);

238  
	gStus
.
	gERROR
;

242 @
Ov”ride


243 
public
 
Stus
 
š£¹
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

244 
SŒšg
 
	gfÜm©‹dKey
 = 
fÜm©Key
(
bË
, 
key
);

246 
	gŒy
 {

247 
fš®
 
	gO³¿tiÚFutu»
<
	gBoŞ—n
> 
	gfutu»
 = 
ş›Á
.
add
(
fÜm©‹dKey
, 
’code
(
v®ues
), 
³rsi¡To
, 
»¶iÿ‹To
);

248  
checkFutu»Stus
(
futu»
);

249 } 
ÿtch
 (
Exû±iÚ
 
e
) {

250 ià(
	glog
.
isE¼ÜEÇbËd
()) {

251 
	glog
.
”rÜ
("Could‚Ù in£¹ v®ufÜ key " + 
fÜm©‹dKey
, 
e
);

253  
	gStus
.
	gERROR
;

257 @
Ov”ride


258 
public
 
Stus
 
	$d–‘e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
) {

259 
SŒšg
 
fÜm©‹dKey
 = 
	`fÜm©Key
(
bË
, 
key
);

261 
Œy
 {

262 
fš®
 
O³¿tiÚFutu»
<
BoŞ—n
> 
futu»
 = 
ş›Á
.
	`d–‘e
(
fÜm©‹dKey
, 
³rsi¡To
, 
»¶iÿ‹To
);

263  
	`checkFutu»Stus
(
futu»
);

264 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

265 ià(
log
.
	`isE¼ÜEÇbËd
()) {

266 
log
.
	`”rÜ
("Could‚Ù d–‘v®ufÜ key " + 
fÜm©‹dKey
, 
e
);

268  
Stus
.
ERROR
;

270 
	}
}

279 
´iv©e
 
SŒšg
 
	$fÜm©Key
(
fš®
 
SŒšg
 
´efix
, fš® SŒšg 
key
) {

280  
´efix
 + ":" + 
key
;

281 
	}
}

289 
´iv©e
 
Stus
 
checkFutu»Stus
(
fš®
 
O³¿tiÚFutu»
<?> 
futu»
) {

290 ià(
	gcheckFutu»s
) {

291  
	gfutu»
.
g‘Stus
().
isSucûss
(è? 
	gStus
.
	gOK
 : 
Stus
.
ERROR
;

293  
	gStus
.
	gOK
;

304 
´iv©e
 
decode
(
fš®
 
Objeù
 
sourû
, fš® 
S‘
<
SŒšg
> 
f›lds
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
de¡
) {

305 ià(
	gu£JsÚ
) {

306 
	gŒy
 {

307 
JsÚNode
 
	gjsÚ
 = 
JSON_MAPPER
.
»adT»e
((
SŒšg
è
sourû
);

308 
boŞ—n
 
	gcheckF›lds
 = 
f›lds
 !ğ
nuÎ
 && !f›lds.
isEm±y
();

309 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
>> 
	gjsÚF›lds
 = 
jsÚ
.
f›lds
(); jsÚF›lds.
hasNext
();) {

310 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
> 
	gjsÚF›ld
 = 
jsÚF›lds
.
Ãxt
();

311 
SŒšg
 
	gÇme
 = 
jsÚF›ld
.
g‘Key
();

312 ià(
	gcheckF›lds
 && 
	gf›lds
.
cÚšs
(
Çme
)) {

315 
JsÚNode
 
	gjsÚV®ue
 = 
jsÚF›ld
.
g‘V®ue
();

316 ià(
	gjsÚV®ue
 !ğ
nuÎ
 && !
jsÚV®ue
.
isNuÎ
()) {

317 
de¡
.
put
(
Çme
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
jsÚV®ue
.
asText
()));

320 } 
ÿtch
 (
Exû±iÚ
 
e
) {

321 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Could‚ot decode JSON");

324 
	gM­
<
	gSŒšg
, SŒšg> 
	gcÚv”‹d
 = (
HashM­
<
SŒšg
, SŒšg>è
	gsourû
;

325 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
cÚv”‹d
.
’ŒyS‘
()) {

326 
de¡
.
put
(
’Œy
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
ÓÁry.
g‘V®ue
()));

337 
´iv©e
 
Objeù
 
’code
(
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
sourû
) {

338 
	gM­
<
	gSŒšg
, SŒšg> 
	g¡ršgM­
 = 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
sourû
);

339 ià(!
	gu£JsÚ
) {

340  
	g¡ršgM­
;

343 
ObjeùNode
 
	gnode
 = 
JSON_MAPPER
.
ü—‹ObjeùNode
();

344 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g·œ
 : 
¡ršgM­
.
’ŒyS‘
()) {

345 
node
.
put
(
·œ
.
g‘Key
(),…aœ.
g‘V®ue
());

347 
JsÚFaùÜy
 
	gjsÚFaùÜy
 = 
Ãw
 JsonFactory();

348 
Wr™”
 
	gwr™”
 = 
Ãw
 
SŒšgWr™”
();

349 
	gŒy
 {

350 
JsÚG’”©Ü
 
	gjsÚG’”©Ü
 = 
jsÚFaùÜy
.
ü—‹G’”©Ü
(
wr™”
);

351 
	gJSON_MAPPER
.
wr™eT»e
(
jsÚG’”©Ü
, 
node
);

352 } 
ÿtch
 (
Exû±iÚ
 
e
) {

353 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Could‚otƒncode JSON value");

355  
	gwr™”
.
toSŒšg
();

	@couchbase/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@couchbase2/src/main/java/site/ycsb/db/couchbase2/Couchbase2Client.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gcouchba£2
;

20 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gcÜe
.
	g’v
.
	gDeçuÉCÜeEnvœÚm’t
;

21 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gcÜe
.
	g’v
.
	g»sourûs
.
	gIoPoŞShutdownHook
;

22 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gcÜe
.
	gloggšg
.
	gCouchba£Logg”
;

23 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gcÜe
.
	gloggšg
.
	gCouchba£Logg”FaùÜy
;

24 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gcÜe
.
	gm‘rics
.
	gDeçuÉL©’cyM‘ricsCŞËùÜCÚfig
;

25 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gcÜe
.
	gm‘rics
.
	gDeçuÉM‘ricsCŞËùÜCÚfig
;

26 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gcÜe
.
	gm‘rics
.
	gL©’cyM‘ricsCŞËùÜCÚfig
;

27 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gcÜe
.
	gm‘rics
.
	gM‘ricsCŞËùÜCÚfig
;

28 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.com.
	gç¡”xml
.
	gjacksÚ
.
	gcÜe
.
	gJsÚFaùÜy
;

29 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.com.
	gç¡”xml
.
	gjacksÚ
.
	gcÜe
.
	gJsÚG’”©Ü
;

30 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.com.
	gç¡”xml
.
	gjacksÚ
.
	gd©abšd
.
	gJsÚNode
;

31 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.com.
	gç¡”xml
.
	gjacksÚ
.
	gd©abšd
.
	gnode
.
	gObjeùNode
;

32 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gDeçuÉS–eùSŒ©egyFaùÜy
;

33 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

34 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gS–eùSŒ©egy
;

35 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gS–eùSŒ©egyFaùÜy
;

36 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.
	gio
.
	gÃ‰y
.
	gchªÃl
.
	g•Şl
.
	gEpŞlEv’tLoİGroup
;

37 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gnio
.
	gNioEv’tLoİGroup
;

38 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.
	gio
.
	gÃ‰y
.
	gut
.
	gIÁSuµl›r
;

39 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gd•s
.
	gio
.
	gÃ‰y
.
	gut
.
	gcÚcu¼’t
.
	gDeçuÉTh»adFaùÜy
;

40 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gBuck‘
;

41 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gClu¡”
;

42 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gCouchba£Clu¡”
;

43 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gP”si¡To
;

44 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gR•liÿ‹To
;

45 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gdocum’t
.
	gDocum’t
;

46 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gdocum’t
.
	gRawJsÚDocum’t
;

47 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gdocum’t
.
	gjsÚ
.
	gJsÚA¼ay
;

48 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gdocum’t
.
	gjsÚ
.
	gJsÚObjeù
;

49 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	g’v
.
	gCouchba£EnvœÚm’t
;

50 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	g’v
.
	gDeçuÉCouchba£EnvœÚm’t
;

51 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	g”rÜ
.
	gTempÜ¬yFau»Exû±iÚ
;

52 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gqu”y
.*;

53 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gŒªscod”
.
	gJacksÚT¿nsfÜm”s
;

54 
impÜt
 
	gcom
.
	gcouchba£
.
	gş›Á
.
	gjava
.
	gut
.
	gBlockšg
;

55 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

56 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

57 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

58 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

59 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

60 
impÜt
 
	grx
.
	gOb£rvabË
;

61 
impÜt
 
	grx
.
	gSubsüib”
;

62 
impÜt
 
	grx
.
	gfunùiÚs
.
	gAùiÚ1
;

63 
impÜt
 
	grx
.
	gfunùiÚs
.
	gFunc1
;

65 
impÜt
 
	gjava
.
	gio
.
	gSŒšgWr™”
;

66 
impÜt
 
	gjava
.
	gio
.
	gWr™”
;

67 
impÜt
 
	gjava
.
	gnio
.
	gchªÃls
.
	g¥i
.
	gS–eùÜProvid”
;

68 
impÜt
 
	gjava
.
	gut
.*;

69 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜy
;

70 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

71 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

100 
public
 cÏs 
	cCouchba£2Cl›Á
 
ex‹nds
 
	mDB
 {

104 
	mSy¡em
.
£tPrİ”ty
("com.couchbase.query.encodedPlanEnabled", "false");

107 
´iv©e
 
fš®
 
SŒšg
 
	gSEPARATOR
 = ":";

108 
´iv©e
 
fš®
 
Couchba£Logg”
 
	gLOGGER
 = 
Couchba£Logg”FaùÜy
.
g‘In¡ªû
(
Couchba£2Cl›Á
.
şass
);

109 
´iv©e
 
fš®
 
Objeù
 
	gINIT_COORDINATOR
 = 
Ãw
 Object();

111 
´iv©e
 vŞ©
Couchba£EnvœÚm’t
 
	g’v
 = 
nuÎ
;

113 
´iv©e
 
Clu¡”
 
	gşu¡”
;

114 
´iv©e
 
Buck‘
 
	gbuck‘
;

115 
´iv©e
 
SŒšg
 
	gbuck‘Name
;

116 
´iv©e
 
boŞ—n
 
	gup£¹
;

117 
´iv©e
 
P”si¡To
 
	g³rsi¡To
;

118 
´iv©e
 
R•liÿ‹To
 
	g»¶iÿ‹To
;

119 
´iv©e
 
boŞ—n
 
	gsyncMutRe¥Ú£
;

120 
´iv©e
 
boŞ—n
 
	g•Şl
;

121 
´iv©e
 
	gkvTimeout
;

122 
´iv©e
 
boŞ—n
 
	gadhoc
;

123 
´iv©e
 
boŞ—n
 
	gkv
;

124 
´iv©e
 
	gmaxP¬®Ëlism
;

125 
´iv©e
 
SŒšg
 
	gho¡
;

126 
´iv©e
 
	gkvEndpošts
;

127 
´iv©e
 
	gqu”yEndpošts
;

128 
´iv©e
 
	gboo¡
;

129 
´iv©e
 
	gÃtwÜkM‘ricsIÁ”v®
;

130 
´iv©e
 
	gruÁimeM‘ricsIÁ”v®
;

131 
´iv©e
 
SŒšg
 
	gsÿnAÎQu”y
;

132 
´iv©e
 
	gdocum’tExpœy
;

134 @
Ov”ride


135 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

136 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

138 
ho¡
 = 
´İs
.
	`g‘Prİ”ty
("couchbase.host", "127.0.0.1");

139 
buck‘Name
 = 
´İs
.
	`g‘Prİ”ty
("couchbase.bucket", "default");

140 
SŒšg
 
buck‘PasswÜd
 = 
´İs
.
	`g‘Prİ”ty
("couchbase.password", "");

142 
up£¹
 = 
´İs
.
	`g‘Prİ”ty
("couchba£.up£¹", "çl£").
	`equ®s
("true");

143 
³rsi¡To
 = 
	`·r£P”si¡To
(
´İs
.
	`g‘Prİ”ty
("couchbase.persistTo", "0"));

144 
»¶iÿ‹To
 = 
	`·r£R•liÿ‹To
(
´İs
.
	`g‘Prİ”ty
("couchbase.replicateTo", "0"));

145 
syncMutRe¥Ú£
 = 
´İs
.
	`g‘Prİ”ty
("couchba£.syncMutiÚRe¥Ú£", "Œue").
	`equ®s
("true");

146 
adhoc
 = 
´İs
.
	`g‘Prİ”ty
("couchba£.adhoc", "çl£").
	`equ®s
("true");

147 
kv
 = 
´İs
.
	`g‘Prİ”ty
("couchba£.kv", "Œue").
	`equ®s
("true");

148 
maxP¬®Ëlism
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("couchbase.maxParallelism", "1"));

149 
kvEndpošts
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("couchbase.kvEndpoints", "1"));

150 
qu”yEndpošts
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("couchbase.queryEndpoints", "1"));

151 
•Şl
 = 
´İs
.
	`g‘Prİ”ty
("couchba£.•Şl", "çl£").
	`equ®s
("true");

152 
boo¡
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("couchbase.boost", "3"));

153 
ÃtwÜkM‘ricsIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("couchbase.networkMetricsInterval", "0"));

154 
ruÁimeM‘ricsIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("couchbase.runtimeMetricsInterval", "0"));

155 
docum’tExpœy
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("couchbase.documentExpiry", "0"));

156 
sÿnAÎQu”y
 = "SELECT RAW m‘a().id FROM `" + 
buck‘Name
 +

159 
Œy
 {

160 
	`synchrÚized
 (
INIT_COORDINATOR
) {

161 ià(
’v
 =ğ
nuÎ
) {

163 
L©’cyM‘ricsCŞËùÜCÚfig
 
Ï‹ncyCÚfig
 = 
ÃtwÜkM‘ricsIÁ”v®
 <= 0

164 ? 
DeçuÉL©’cyM‘ricsCŞËùÜCÚfig
.
	`di§bËd
()

165 : 
DeçuÉL©’cyM‘ricsCŞËùÜCÚfig


166 .
	`bud”
()

167 .
	`em™F»qu’cy
(
ÃtwÜkM‘ricsIÁ”v®
)

168 .
	`em™F»qu’cyUn™
(
TimeUn™
.
SECONDS
)

169 .
	`bud
();

171 
M‘ricsCŞËùÜCÚfig
 
ruÁimeCÚfig
 = 
ruÁimeM‘ricsIÁ”v®
 <= 0

172 ? 
DeçuÉM‘ricsCŞËùÜCÚfig
.
	`di§bËd
()

173 : 
DeçuÉM‘ricsCŞËùÜCÚfig
.
	`ü—‹
(
ruÁimeM‘ricsIÁ”v®
, 
TimeUn™
.
SECONDS
);

175 
DeçuÉCouchba£EnvœÚm’t
.
Bud”
 
bud”
 = DefaultCouchbaseEnvironment

176 .
	`bud”
()

177 .
	`qu”yEndpošts
(
qu”yEndpošts
)

178 .
	`ÿÎbacksOnIoPoŞ
(
Œue
)

179 .
	`ruÁimeM‘ricsCŞËùÜCÚfig
(
ruÁimeCÚfig
)

180 .
	`ÃtwÜkL©’cyM‘ricsCŞËùÜCÚfig
(
Ï‹ncyCÚfig
)

181 .
	`sock‘CÚÃùTimeout
(10000)

182 .
	`cÚÃùTimeout
(30000)

183 .
	`kvTimeout
(10000)

184 .
	`kvEndpošts
(
kvEndpošts
);

187 
S–eùSŒ©egyFaùÜy
 
çùÜy
 = 
boo¡
 > 0 ?

188 
Ãw
 
	`BackoffS–eùSŒ©egyFaùÜy
(è: 
DeçuÉS–eùSŒ©egyFaùÜy
.
INSTANCE
;

190 
poŞSize
 = 
boo¡
 > 0 ? boo¡ : 
IÁeg”
.
	`·r£IÁ
(

191 
Sy¡em
.
	`g‘Prİ”ty
("com.couchba£.ioPoŞSize", 
IÁeg”
.
	`toSŒšg
(
DeçuÉCÜeEnvœÚm’t
.
IO_POOL_SIZE
))

193 
Th»adFaùÜy
 
th»adFaùÜy
 = 
Ãw
 
	`DeçuÉTh»adFaùÜy
("cb-io", 
Œue
);

195 
Ev’tLoİGroup
 
group
 = 
•Şl
 ? 
Ãw
 
	`EpŞlEv’tLoİGroup
(
poŞSize
, 
th»adFaùÜy
, 
çùÜy
)

196 : 
Ãw
 
	`NioEv’tLoİGroup
(
poŞSize
, 
th»adFaùÜy
, 
S–eùÜProvid”
.
	`´ovid”
(), 
çùÜy
);

197 
bud”
.
	`ioPoŞ
(
group
, 
Ãw
 
	`IoPoŞShutdownHook
(group));

199 
’v
 = 
bud”
.
	`bud
();

200 
	`logP¬ams
();

204 
şu¡”
 = 
Couchba£Clu¡”
.
	`ü—‹
(
’v
, 
ho¡
);

205 
buck‘
 = 
şu¡”
.
	`İ’Buck‘
(
buck‘Name
, 
buck‘PasswÜd
);

206 
kvTimeout
 = 
’v
.
	`kvTimeout
();

207 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

208 
throw
 
Ãw
 
	`DBExû±iÚ
("Could‚Ù cÚÃùØCouchba£ Buck‘.", 
ex
);

211 ià(!
kv
 && !
syncMutRe¥Ú£
) {

212 
throw
 
Ãw
 
	`DBExû±iÚ
("Not waiting for N1QL„esponses on mutations‚ot yet implemented.");

214 
	}
}

219 
´iv©e
 
	$logP¬ams
() {

220 
SŒšgBud”
 
sb
 = 
Ãw
 
	`SŒšgBud”
();

222 
sb
.
	`­³nd
("ho¡=").­³nd(
ho¡
);

223 
sb
.
	`­³nd
(", buck‘=").­³nd(
buck‘Name
);

224 
sb
.
	`­³nd
(", up£¹=").­³nd(
up£¹
);

225 
sb
.
	`­³nd
(",…”si¡To=").­³nd(
³rsi¡To
);

226 
sb
.
	`­³nd
(",„•liÿ‹To=").­³nd(
»¶iÿ‹To
);

227 
sb
.
	`­³nd
(", syncMutRe¥Ú£=").­³nd(
syncMutRe¥Ú£
);

228 
sb
.
	`­³nd
(",‡dhoc=").­³nd(
adhoc
);

229 
sb
.
	`­³nd
(", kv=").­³nd(
kv
);

230 
sb
.
	`­³nd
(", maxP¬®Ëlism=").­³nd(
maxP¬®Ëlism
);

231 
sb
.
	`­³nd
(", qu”yEndpošts=").­³nd(
qu”yEndpošts
);

232 
sb
.
	`­³nd
(", kvEndpošts=").­³nd(
kvEndpošts
);

233 
sb
.
	`­³nd
(", qu”yEndpošts=").­³nd(
qu”yEndpošts
);

234 
sb
.
	`­³nd
(",ƒpŞl=").­³nd(
•Şl
);

235 
sb
.
	`­³nd
(", boo¡=").­³nd(
boo¡
);

236 
sb
.
	`­³nd
(",‚‘wÜkM‘ricsIÁ”v®=").­³nd(
ÃtwÜkM‘ricsIÁ”v®
);

237 
sb
.
	`­³nd
(",„uÁimeM‘ricsIÁ”v®=").­³nd(
ruÁimeM‘ricsIÁ”v®
);

239 
LOGGER
.
	`šfo
("===> Usšg P¬ams: " + 
sb
.
	`toSŒšg
());

240 
	}
}

242 @
Ov”ride


243 
public
 
Stus
 
»ad
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

244 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

245 
	gŒy
 {

246 
SŒšg
 
	gdocId
 = 
fÜm©Id
(
bË
, 
key
);

247 ià(
	gkv
) {

248  
»adKv
(
docId
, 
f›lds
, 
»suÉ
);

250  
»adN1ql
(
docId
, 
f›lds
, 
»suÉ
);

252 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

253 
	gex
.
´štSckT¿û
();

254  
	gStus
.
	gERROR
;

266 
´iv©e
 
Stus
 
»adKv
(
fš®
 
SŒšg
 
docId
, fš® 
S‘
<SŒšg> 
f›lds
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
)

267 
throws
 
	gExû±iÚ
 {

268 
RawJsÚDocum’t
 
	glßded
 = 
buck‘
.
g‘
(
docId
, RawJsÚDocum’t.
şass
);

269 ià(
	glßded
 =ğ
nuÎ
) {

270  
Stus
.
NOT_FOUND
;

272 
decode
(
lßded
.
cÚ‹Á
(), 
f›lds
, 
»suÉ
);

273  
	gStus
.
	gOK
;

286 
´iv©e
 
Stus
 
»adN1ql
(
fš®
 
SŒšg
 
docId
, 
S‘
<SŒšg> 
f›lds
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
)

287 
throws
 
	gExû±iÚ
 {

288 
SŒšg
 
	g»adQu”y
 = "SELECT " + 
jošF›lds
(
f›lds
è+ " FROM `" + 
buck‘Name
 + "` USE KEYS [$1]";

289 
N1qlQu”yResuÉ
 
	gqu”yResuÉ
 = 
buck‘
.
qu”y
(
N1qlQu”y
.
·¿m‘”ized
(

290 
»adQu”y
,

291 
JsÚA¼ay
.
äom
(
docId
),

292 
N1qlP¬ams
.
bud
().
adhoc
×dhoc).
maxP¬®Ëlism
(maxParallelism)

295 ià(!
	gqu”yResuÉ
.
·r£Sucûss
(è|| !qu”yResuÉ.
fš®Sucûss
()) {

296 
throw
 
Ãw
 
DBExû±iÚ
("E¼Ü wh·rsšg N1QL ResuÉ. Qu”y: " + 
»adQu”y


297 + ", E¼Üs: " + 
qu”yResuÉ
.
”rÜs
());

300 
N1qlQu”yRow
 
	grow
;

301 
	gŒy
 {

302 
	grow
 = 
qu”yResuÉ
.
rows
().
Ãxt
();

303 } 
ÿtch
 (
NoSuchEËm’tExû±iÚ
 
ex
) {

304  
	gStus
.
	gNOT_FOUND
;

307 
JsÚObjeù
 
	gcÚ‹Á
 = 
row
.
v®ue
();

308 ià(
	gf›lds
 =ğ
nuÎ
) {

309 
cÚ‹Á
 = cÚ‹Á.
g‘Objeù
(
buck‘Name
);

310 
	gf›lds
 = 
cÚ‹Á
.
g‘Names
();

313 
SŒšg
 
	gf›ld
 : 
f›lds
) {

314 
Objeù
 
v®ue
 = 
cÚ‹Á
.
g‘
(
f›ld
);

315 
	g»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
 !ğ
nuÎ
 ? v®ue.
toSŒšg
() : ""));

318  
	gStus
.
	gOK
;

321 @
Ov”ride


322 
public
 
Stus
 
upd©e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

323 ià(
	gup£¹
) {

324  
up£¹
(
bË
, 
key
, 
v®ues
);

327 
	gŒy
 {

328 
SŒšg
 
	gdocId
 = 
fÜm©Id
(
bË
, 
key
);

329 ià(
	gkv
) {

330  
upd©eKv
(
docId
, 
v®ues
);

332  
upd©eN1ql
(
docId
, 
v®ues
);

334 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

335 
	gex
.
´štSckT¿û
();

336  
	gStus
.
	gERROR
;

347 
´iv©e
 
Stus
 
upd©eKv
(
fš®
 
SŒšg
 
docId
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

348 
wa™FÜMutiÚRe¥Ú£
(
buck‘
.
async
().
»¶aû
(

349 
RawJsÚDocum’t
.
ü—‹
(
docId
, 
docum’tExpœy
, 
’code
(
v®ues
)),

350 
³rsi¡To
,

351 
»¶iÿ‹To


353  
	gStus
.
	gOK
;

365 
´iv©e
 
Stus
 
upd©eN1ql
(
fš®
 
SŒšg
 
docId
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
)

366 
throws
 
	gExû±iÚ
 {

367 
SŒšg
 
	gf›lds
 = 
’codeN1qlF›lds
(
v®ues
);

368 
SŒšg
 
	gupd©eQu”y
 = "UPDATE `" + 
buck‘Name
 + "` USE KEYS [$1] SET " + 
f›lds
;

370 
N1qlQu”yResuÉ
 
	gqu”yResuÉ
 = 
buck‘
.
qu”y
(
N1qlQu”y
.
·¿m‘”ized
(

371 
upd©eQu”y
,

372 
JsÚA¼ay
.
äom
(
docId
),

373 
N1qlP¬ams
.
bud
().
adhoc
×dhoc).
maxP¬®Ëlism
(maxParallelism)

376 ià(!
	gqu”yResuÉ
.
·r£Sucûss
(è|| !qu”yResuÉ.
fš®Sucûss
()) {

377 
throw
 
Ãw
 
DBExû±iÚ
("E¼Ü wh·rsšg N1QL ResuÉ. Qu”y: " + 
upd©eQu”y


378 + ", E¼Üs: " + 
qu”yResuÉ
.
”rÜs
());

380  
	gStus
.
	gOK
;

383 @
Ov”ride


384 
public
 
Stus
 
š£¹
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

385 ià(
	gup£¹
) {

386  
up£¹
(
bË
, 
key
, 
v®ues
);

389 
	gŒy
 {

390 
SŒšg
 
	gdocId
 = 
fÜm©Id
(
bË
, 
key
);

391 ià(
	gkv
) {

392  
š£¹Kv
(
docId
, 
v®ues
);

394  
š£¹N1ql
(
docId
, 
v®ues
);

396 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

397 
	gex
.
´štSckT¿û
();

398  
	gStus
.
	gERROR
;

413 
´iv©e
 
Stus
 
š£¹Kv
(
fš®
 
SŒšg
 
docId
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

414 
	gŒ›s
 = 60;

416 
	gi
 = 0; i < 
	gŒ›s
; i++) {

417 
	gŒy
 {

418 
wa™FÜMutiÚRe¥Ú£
(
buck‘
.
async
().
š£¹
(

419 
RawJsÚDocum’t
.
ü—‹
(
docId
, 
docum’tExpœy
, 
’code
(
v®ues
)),

420 
³rsi¡To
,

421 
»¶iÿ‹To


423  
	gStus
.
	gOK
;

424 } 
ÿtch
 (
TempÜ¬yFau»Exû±iÚ
 
ex
) {

425 
	gŒy
 {

426 
	gTh»ad
.
¦“p
(1000);

427 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

428 
throw
 
Ãw
 
RuÁimeExû±iÚ
("IÁ”ru±ed wh¦“pšg oÀTMPFAIL backoff.", 
ex
);

433 
throw
 
Ãw
 
RuÁimeExû±iÚ
("StÈ»ûivšg TMPFAIL fromh£rv”‡á”ryšg " + 
Œ›s
 + "imes. " +

446 
´iv©e
 
Stus
 
š£¹N1ql
(
fš®
 
SŒšg
 
docId
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
)

447 
throws
 
	gExû±iÚ
 {

448 
SŒšg
 
	gš£¹Qu”y
 = "INSERT INTO `" + 
buck‘Name
 + "`(KEY,VALUE) VALUES ($1,$2)";

450 
N1qlQu”yResuÉ
 
	gqu”yResuÉ
 = 
buck‘
.
qu”y
(
N1qlQu”y
.
·¿m‘”ized
(

451 
š£¹Qu”y
,

452 
JsÚA¼ay
.
äom
(
docId
, 
v®uesToJsÚObjeù
(
v®ues
)),

453 
N1qlP¬ams
.
bud
().
adhoc
×dhoc).
maxP¬®Ëlism
(maxParallelism)

456 ià(!
	gqu”yResuÉ
.
·r£Sucûss
(è|| !qu”yResuÉ.
fš®Sucûss
()) {

457 
throw
 
Ãw
 
DBExû±iÚ
("E¼Ü wh·rsšg N1QL ResuÉ. Qu”y: " + 
š£¹Qu”y


458 + ", E¼Üs: " + 
qu”yResuÉ
.
”rÜs
());

460  
	gStus
.
	gOK
;

473 
´iv©e
 
Stus
 
up£¹
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

474 
	gŒy
 {

475 
SŒšg
 
	gdocId
 = 
fÜm©Id
(
bË
, 
key
);

476 ià(
	gkv
) {

477  
up£¹Kv
(
docId
, 
v®ues
);

479  
up£¹N1ql
(
docId
, 
v®ues
);

481 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

482 
	gex
.
´štSckT¿û
();

483  
	gStus
.
	gERROR
;

496 
´iv©e
 
Stus
 
up£¹Kv
(
fš®
 
SŒšg
 
docId
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

497 
wa™FÜMutiÚRe¥Ú£
(
buck‘
.
async
().
up£¹
(

498 
RawJsÚDocum’t
.
ü—‹
(
docId
, 
docum’tExpœy
, 
’code
(
v®ues
)),

499 
³rsi¡To
,

500 
»¶iÿ‹To


502  
	gStus
.
	gOK
;

514 
´iv©e
 
Stus
 
up£¹N1ql
(
fš®
 
SŒšg
 
docId
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
)

515 
throws
 
	gExû±iÚ
 {

516 
SŒšg
 
	gup£¹Qu”y
 = "UPSERT INTO `" + 
buck‘Name
 + "`(KEY,VALUE) VALUES ($1,$2)";

518 
N1qlQu”yResuÉ
 
	gqu”yResuÉ
 = 
buck‘
.
qu”y
(
N1qlQu”y
.
·¿m‘”ized
(

519 
up£¹Qu”y
,

520 
JsÚA¼ay
.
äom
(
docId
, 
v®uesToJsÚObjeù
(
v®ues
)),

521 
N1qlP¬ams
.
bud
().
adhoc
×dhoc).
maxP¬®Ëlism
(maxParallelism)

524 ià(!
	gqu”yResuÉ
.
·r£Sucûss
(è|| !qu”yResuÉ.
fš®Sucûss
()) {

525 
throw
 
Ãw
 
DBExû±iÚ
("E¼Ü wh·rsšg N1QL ResuÉ. Qu”y: " + 
up£¹Qu”y


526 + ", E¼Üs: " + 
qu”yResuÉ
.
”rÜs
());

528  
	gStus
.
	gOK
;

531 @
Ov”ride


532 
public
 
Stus
 
	$d–‘e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
) {

533 
Œy
 {

534 
SŒšg
 
docId
 = 
	`fÜm©Id
(
bË
, 
key
);

535 ià(
kv
) {

536  
	`d–‘eKv
(
docId
);

538  
	`d–‘eN1ql
(
docId
);

540 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

541 
ex
.
	`´štSckT¿û
();

542  
Stus
.
ERROR
;

544 
	}
}

552 
´iv©e
 
Stus
 
	$d–‘eKv
(
fš®
 
SŒšg
 
docId
) {

553 
	`wa™FÜMutiÚRe¥Ú£
(
buck‘
.
	`async
().
	`»move
(

554 
docId
,

555 
³rsi¡To
,

556 
»¶iÿ‹To


558  
Stus
.
OK
;

559 
	}
}

569 
´iv©e
 
Stus
 
	$d–‘eN1ql
(
fš®
 
SŒšg
 
docId
è
throws
 
Exû±iÚ
 {

570 
SŒšg
 
d–‘eQu”y
 = "DELETE FROM `" + 
buck‘Name
 + "` USE KEYS [$1]";

571 
N1qlQu”yResuÉ
 
qu”yResuÉ
 = 
buck‘
.
	`qu”y
(
N1qlQu”y
.
	`·¿m‘”ized
(

572 
d–‘eQu”y
,

573 
JsÚA¼ay
.
	`äom
(
docId
),

574 
N1qlP¬ams
.
	`bud
().
	`adhoc
(
adhoc
).
	`maxP¬®Ëlism
(
maxP¬®Ëlism
)

577 ià(!
qu”yResuÉ
.
	`·r£Sucûss
(è|| !qu”yResuÉ.
	`fš®Sucûss
()) {

578 
throw
 
Ãw
 
	`DBExû±iÚ
("E¼Ü wh·rsšg N1QL ResuÉ. Qu”y: " + 
d–‘eQu”y


579 + ", E¼Üs: " + 
qu”yResuÉ
.
	`”rÜs
());

581  
Stus
.
OK
;

582 
	}
}

584 @
Ov”ride


585 
public
 
Stus
 
sÿn
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
¡¬tkey
, fš® 
»cÜdcouÁ
, fš® 
S‘
<SŒšg> 
f›lds
,

586 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

587 
	gŒy
 {

588 ià(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
isEm±y
()) {

589  
sÿnAÎF›lds
(
bË
, 
¡¬tkey
, 
»cÜdcouÁ
, 
»suÉ
);

591  
sÿnS³cificF›lds
(
bË
, 
¡¬tkey
, 
»cÜdcouÁ
, 
f›lds
, 
»suÉ
);

593 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

594 
	gex
.
´štSckT¿û
();

595  
	gStus
.
	gERROR
;

612 
´iv©e
 
Stus
 
sÿnAÎF›lds
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
¡¬tkey
, fš® 
»cÜdcouÁ
,

613 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

614 
fš®
 
	gLi¡
<
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
>> 
	gd©a
 = 
Ãw
 
A¼ayLi¡
<
HashM­
<
SŒšg
, By‹I‹¿tÜ>>(
	g»cÜdcouÁ
);

615 
	gbuck‘
.
async
()

616 .
qu”y
(
N1qlQu”y
.
·¿m‘”ized
(

617 
sÿnAÎQu”y
,

618 
JsÚA¼ay
.
äom
(
fÜm©Id
(
bË
, 
¡¬tkey
), 
»cÜdcouÁ
),

619 
N1qlP¬ams
.
bud
().
adhoc
×dhoc).
maxP¬®Ëlism
(maxParallelism)

621 .
doOnNext
(
Ãw
 
AùiÚ1
<
AsyncN1qlQu”yResuÉ
>() {

622 @
Ov”ride


623 
public
 
ÿÎ
(
AsyncN1qlQu”yResuÉ
 
»suÉ
) {

624 ià(!
»suÉ
.
·r£Sucûss
()) {

625 
throw
 
Ãw
 
RuÁimeExû±iÚ
("E¼Ü wh·rsšg N1QL ResuÉ. Qu”y: " + 
sÿnAÎQu”y


626 + ", E¼Üs: " + 
»suÉ
.
”rÜs
());

630 .
æ©M­
(
Ãw
 
Func1
<
AsyncN1qlQu”yResuÉ
, 
Ob£rvabË
<
AsyncN1qlQu”yRow
>>() {

631 @
Ov”ride


632 
public
 
Ob£rvabË
<
AsyncN1qlQu”yRow
> 
ÿÎ
(
AsyncN1qlQu”yResuÉ
 
»suÉ
) {

633  
»suÉ
.
rows
();

636 .
æ©M­
(
Ãw
 
Func1
<
AsyncN1qlQu”yRow
, 
Ob£rvabË
<
RawJsÚDocum’t
>>() {

637 @
Ov”ride


638 
public
 
Ob£rvabË
<
RawJsÚDocum’t
> 
ÿÎ
(
AsyncN1qlQu”yRow
 
row
) {

639 
SŒšg
 
id
 = 
Ãw
 SŒšg(
row
.
by‹V®ue
()).
Œim
();

640  
buck‘
.
async
().
g‘
(
id
.
sub¡ršg
(1, id.
Ëngth
()-1), 
RawJsÚDocum’t
.
şass
);

643 .
m­
(
Ãw
 
Func1
<
RawJsÚDocum’t
, 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>>() {

644 @
Ov”ride


645 
public
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ÿÎ
(
RawJsÚDocum’t
 
docum’t
) {

646 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
tu¶e
 = 
Ãw
 HashMap<String, ByteIterator>();

647 
decode
(
docum’t
.
cÚ‹Á
(), 
nuÎ
, 
tu¶e
);

648  
tu¶e
;

651 .
toBlockšg
()

652 .
fÜEach
(
Ãw
 
AùiÚ1
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>>() {

653 @
Ov”ride


654 
public
 
ÿÎ
(
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
tu¶e
) {

655 
d©a
.
add
(
tu¶e
);

659 
	g»suÉ
.
addAÎ
(
d©a
);

660  
	gStus
.
	gOK
;

673 
´iv©e
 
Stus
 
sÿnS³cificF›lds
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
¡¬tkey
, fš® 
»cÜdcouÁ
,

674 
fš®
 
S‘
<
SŒšg
> 
f›lds
, fš® 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

675 
SŒšg
 
	gsÿnS³cQu”y
 = "SELECT " + 
jošF›lds
(
f›lds
è+ " FROM `" + 
buck‘Name


677 
N1qlQu”yResuÉ
 
	gqu”yResuÉ
 = 
buck‘
.
qu”y
(
N1qlQu”y
.
·¿m‘”ized
(

678 
sÿnS³cQu”y
,

679 
JsÚA¼ay
.
äom
(
fÜm©Id
(
bË
, 
¡¬tkey
), 
»cÜdcouÁ
),

680 
N1qlP¬ams
.
bud
().
adhoc
×dhoc).
maxP¬®Ëlism
(maxParallelism)

683 ià(!
	gqu”yResuÉ
.
·r£Sucûss
(è|| !qu”yResuÉ.
fš®Sucûss
()) {

684 
throw
 
Ãw
 
RuÁimeExû±iÚ
("E¼Ü wh·rsšg N1QL ResuÉ. Qu”y: " + 
sÿnS³cQu”y


685 + ", E¼Üs: " + 
qu”yResuÉ
.
”rÜs
());

688 
boŞ—n
 
	g®lF›lds
 = 
f›lds
 =ğ
nuÎ
 || f›lds.
isEm±y
();

689 
	g»suÉ
.
’su»C­ac™y
(
»cÜdcouÁ
);

691 
N1qlQu”yRow
 
	grow
 : 
qu”yResuÉ
) {

692 
JsÚObjeù
 
v®ue
 = 
row
.value();

693 ià(
	gf›lds
 =ğ
nuÎ
) {

694 
v®ue
 = v®ue.
g‘Objeù
(
buck‘Name
);

696 
	gS‘
<
	gSŒšg
> 
	gf
 = 
®lF›lds
 ? 
v®ue
.
g‘Names
(è: 
f›lds
;

697 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gtu¶e
 = 
Ãw
 
HashM­
<
SŒšg
, By‹I‹¿tÜ>(
	gf
.
size
());

698 
SŒšg
 
	gf›ld
 : 
f
) {

699 
tu¶e
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
.
g‘SŒšg
(field)));

701 
	g»suÉ
.
add
(
tu¶e
);

703  
	gStus
.
	gOK
;

716 
´iv©e
 
wa™FÜMutiÚRe¥Ú£
(
fš®
 
Ob£rvabË
<? 
ex‹nds
 
Docum’t
<?>> 
šput
) {

717 ià(!
	gsyncMutRe¥Ú£
) {

718 ((
	gOb£rvabË
<
	gDocum’t
<?>>)
	gšput
).
subsüibe
(
Ãw
 
Subsüib”
<
Docum’t
<?>>() {

719 @
Ov”ride


720 
public
 
ÚCom¶‘ed
() {

723 @
Ov”ride


724 
public
 
ÚE¼Ü
(
ThrowabË
 
e
) {

727 @
Ov”ride


728 
public
 
ÚNext
(
Docum’t
<?> 
docum’t
) {

732 
	gBlockšg
.
blockFÜSšgË
(
šput
, 
kvTimeout
, 
TimeUn™
.
MILLISECONDS
);

742 
´iv©e
 
SŒšg
 
’codeN1qlF›lds
(
fš®
 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

743 ià(
	gv®ues
.
isEm±y
()) {

747 
SŒšgBud”
 
	gsb
 = 
Ãw
 StringBuilder();

748 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

749 
SŒšg
 
¿w
 = 
’Œy
.
g‘V®ue
().
toSŒšg
();

750 
SŒšg
 
	gesÿ³d
 = 
¿w
.
»¶aû
("\"", "\\\"").replace("\'", "\\\'");

751 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=\"").­³nd(
esÿ³d
).append("\" ");

753 
SŒšg
 
	gtoR‘uº
 = 
sb
.
toSŒšg
();

754  
	gtoR‘uº
.
sub¡ršg
(0, 
toR‘uº
.
Ëngth
() - 1);

763 
´iv©e
 
JsÚObjeù
 
v®uesToJsÚObjeù
(
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

764 
JsÚObjeù
 
	g»suÉ
 = JsÚObjeù.
ü—‹
();

765 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

766 
»suÉ
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

768  
	g»suÉ
;

777 
´iv©e
 
SŒšg
 
jošF›lds
(
fš®
 
S‘
<SŒšg> 
f›lds
) {

778 ià(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
isEm±y
()) {

781 
SŒšgBud”
 
	gbud”
 = 
Ãw
 StringBuilder();

782 
SŒšg
 
	gf
 : 
f›lds
) {

783 
bud”
.
­³nd
("`").­³nd(
f
).append("`").append(",");

785 
SŒšg
 
	gtoR‘uº
 = 
bud”
.
toSŒšg
();

786  
	gtoR‘uº
.
sub¡ršg
(0, 
toR‘uº
.
Ëngth
() - 1);

796 
´iv©e
 
SŒšg
 
	$fÜm©Id
(
fš®
 
SŒšg
 
´efix
, fš® SŒšg 
key
) {

797  
´efix
 + 
SEPARATOR
 + 
key
;

798 
	}
}

806 
´iv©e
 
R•liÿ‹To
 
	$·r£R•liÿ‹To
(
fš®
 
SŒšg
 
´İ”ty
è
throws
 
DBExû±iÚ
 {

807 
v®ue
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”ty
);

809 
v®ue
) {

811  
R•liÿ‹To
.
NONE
;

813  
R•liÿ‹To
.
ONE
;

815  
R•liÿ‹To
.
TWO
;

817  
R•liÿ‹To
.
THREE
;

819 
throw
 
Ãw
 
	`DBExû±iÚ
("\"couchbase.replicateTo\" must be between 0‡nd 3");

821 
	}
}

829 
´iv©e
 
P”si¡To
 
	$·r£P”si¡To
(
fš®
 
SŒšg
 
´İ”ty
è
throws
 
DBExû±iÚ
 {

830 
v®ue
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”ty
);

832 
v®ue
) {

834  
P”si¡To
.
NONE
;

836  
P”si¡To
.
ONE
;

838  
P”si¡To
.
TWO
;

840  
P”si¡To
.
THREE
;

842  
P”si¡To
.
FOUR
;

844 
throw
 
Ãw
 
	`DBExû±iÚ
("\"couchbase.persistTo\" must be between 0‡nd 4");

846 
	}
}

855 
´iv©e
 
decode
(
fš®
 
SŒšg
 
sourû
, fš® 
S‘
<SŒšg> 
f›lds
,

856 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
de¡
) {

857 
	gŒy
 {

858 
JsÚNode
 
	gjsÚ
 = 
JacksÚT¿nsfÜm”s
.
MAPPER
.
»adT»e
(
sourû
);

859 
boŞ—n
 
	gcheckF›lds
 = 
f›lds
 !ğ
nuÎ
 && !f›lds.
isEm±y
();

860 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
>> 
	gjsÚF›lds
 = 
jsÚ
.
f›lds
(); jsÚF›lds.
hasNext
();) {

861 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
> 
	gjsÚF›ld
 = 
jsÚF›lds
.
Ãxt
();

862 
SŒšg
 
	gÇme
 = 
jsÚF›ld
.
g‘Key
();

863 ià(
	gcheckF›lds
 && !
	gf›lds
.
cÚšs
(
Çme
)) {

866 
JsÚNode
 
	gjsÚV®ue
 = 
jsÚF›ld
.
g‘V®ue
();

867 ià(
	gjsÚV®ue
 !ğ
nuÎ
 && !
jsÚV®ue
.
isNuÎ
()) {

868 
de¡
.
put
(
Çme
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
jsÚV®ue
.
asText
()));

871 } 
ÿtch
 (
Exû±iÚ
 
e
) {

872 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Could‚ot decode JSON");

882 
´iv©e
 
SŒšg
 
’code
(
fš®
 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
sourû
) {

883 
	gM­
<
	gSŒšg
, SŒšg> 
	g¡ršgM­
 = 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
sourû
);

884 
ObjeùNode
 
	gnode
 = 
JacksÚT¿nsfÜm”s
.
MAPPER
.
ü—‹ObjeùNode
();

885 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g·œ
 : 
¡ršgM­
.
’ŒyS‘
()) {

886 
node
.
put
(
·œ
.
g‘Key
(),…aœ.
g‘V®ue
());

888 
JsÚFaùÜy
 
	gjsÚFaùÜy
 = 
Ãw
 JsonFactory();

889 
Wr™”
 
	gwr™”
 = 
Ãw
 
SŒšgWr™”
();

890 
	gŒy
 {

891 
JsÚG’”©Ü
 
	gjsÚG’”©Ü
 = 
jsÚFaùÜy
.
ü—‹G’”©Ü
(
wr™”
);

892 
	gJacksÚT¿nsfÜm”s
.
	gMAPPER
.
wr™eT»e
(
jsÚG’”©Ü
, 
node
);

893 } 
ÿtch
 (
Exû±iÚ
 
e
) {

894 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Could‚otƒncode JSON value");

896  
	gwr™”
.
toSŒšg
();

903 şas 
	cBackoffS–eùSŒ©egyFaùÜy
 
im¶em’ts
 
	mS–eùSŒ©egyFaùÜy
 {

904 @
Ov”ride


905 
public
 
S–eùSŒ©egy
 
	$ÃwS–eùSŒ©egy
() {

906  
Ãw
 
	`BackoffS–eùSŒ©egy
();

908 
	}
}

913 şas 
	cBackoffS–eùSŒ©egy
 
im¶em’ts
 
	mS–eùSŒ©egy
 {

915 
´iv©e
 
	mcouÁ”
 = 0;

917 @
Ov”ride


918 
public
 
	$ÿlcuÏ‹SŒ©egy
(
fš®
 
IÁSuµl›r
 
suµl›r
, fš® 
boŞ—n
 
hasTasks
è
throws
 
Exû±iÚ
 {

919 
£ËùNowResuÉ
 = 
suµl›r
.
	`g‘
();

920 ià(
hasTasks
 || 
£ËùNowResuÉ
 != 0) {

921 
couÁ”
 = 0;

922  
£ËùNowResuÉ
;

924 
couÁ”
++;

926 ià(
couÁ”
 > 2000) {

927 
LockSuµÜt
.
	`·rkNªos
(1);

928 } ià(
couÁ”
 > 3000) {

929 
Th»ad
.
	`y›ld
();

930 } ià(
couÁ”
 > 4000) {

931 
LockSuµÜt
.
	`·rkNªos
(1000);

932 } ià(
couÁ”
 > 5000) {

934 
couÁ”
 = 0;

935  
S–eùSŒ©egy
.
SELECT
;

938  
S–eùSŒ©egy
.
CONTINUE
;

940 
	}
}

	@couchbase2/src/main/java/site/ycsb/db/couchbase2/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gcouchba£2
;

	@crail/src/main/java/site/ycsb/db/crail/CrailClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	güa
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

25 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

26 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	güa
.
	gC¿Bufã»dIÅutSŒ—m
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	güa
.
	gC¿Bufã»dOuutSŒ—m
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	güa
.
	gC¿StÜe
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	güa
.
	gC¿KeyV®ue
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	güa
.
	gC¿LoÿtiÚCÏss
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	güa
.
	gC¿NodeTy³
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	güa
.
	gC¿StÜageCÏss
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	güa
.
	gcÚf
.
	gC¿CÚfigu¿tiÚ
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

45 
public
 cÏs 
	cC¿Cl›Á
 
ex‹nds
 
	mDB
 {

46 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = 
Logg”FaùÜy
.
g‘Logg”
(
C¿Cl›Á
.
şass
);

48 
´iv©e
 
C¿StÜe
 
	mş›Á
;

49 
´iv©e
 
	m¡¬tTime
;

50 
´iv©e
 
	m’dTime
;

51 
´iv©e
 
SŒšg
 
	mu£¹abË
;

52 
´iv©e
 
boŞ—n
 
	m’um”©eKeys
;

54 @
Ov”ride


55 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

56 
su³r
.
	`š™
();

57 
Œy
 {

58 
C¿CÚfigu¿tiÚ
 
üaCÚf
 = 
Ãw
 
	`C¿CÚfigu¿tiÚ
();

59 
this
.
ş›Á
 = 
C¿StÜe
.
	`ÃwIn¡ªû
(
üaCÚf
);

61 
u£¹abË
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("table", "usertable");

62 
’um”©eKeys
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("crail.enumeratekeys", "false"));

64 ià(
ş›Á
.
	`lookup
(
u£¹abË
).
	`g‘
(è=ğ
nuÎ
) {

65 
ş›Á
.
	`ü—‹
(
u£¹abË
, 
C¿NodeTy³
.
TABLE
, 
C¿StÜageCÏss
.
DEFAULT
,

66 
C¿LoÿtiÚCÏss
.
DEFAULT
, 
Œue
).
	`g‘
().
	`syncDœ
();

68 
this
.
¡¬tTime
 = 
Sy¡em
.
	`ÇnoTime
();

69 } 
	`ÿtch
(
Exû±iÚ
 
e
){

70 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

74 @
Ov”ride


75 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

76 
Œy
 {

77 
this
.
’dTime
 = 
Sy¡em
.
	`ÇnoTime
();

78 
runTime
 = (
’dTime
 - 
¡¬tTime
) / 1000000;

79 
ş›Á
.
	`şo£
();

80 } 
	`ÿtch
(
Exû±iÚ
 
e
){

81 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

83 
	}
}

85 @
Ov”ride


86 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

87 
	gŒy
 {

88 
SŒšg
 
	g·th
 = 
bË
 + "/" + 
key
;

89 
C¿KeyV®ue
 
	gfe
 = 
ş›Á
.
lookup
(
·th
).
g‘
().
asKeyV®ue
();

90 
C¿Bufã»dIÅutSŒ—m
 
	g¡»am
 = 
fe
.
g‘Bufã»dIÅutSŒ—m
(1024);

91 
	g¡»am
.
avaabË
(è< 
	gIÁeg”
.
	gBYTES
){

92 
as£¹
 
	gŒue
;

94 
	gf›ldKeyL’gth
 = 
¡»am
.
»adIÁ
();

95 
	g¡»am
.
avaabË
(è< 
	gf›ldKeyL’gth
){

96 
as£¹
 
	gŒue
;

98 
	gby‹
[] 
	gf›ldKey
 = 
Ãw
 
by‹
[
f›ldKeyL’gth
];

99 
	g»s
 = 
¡»am
.
»ad
(
f›ldKey
);

100 ià(
	g»s
 !ğ
f›ldKey
.
Ëngth
){

101 
¡»am
.
şo£
();

102  
	gStus
.
	gERROR
;

104 
	g¡»am
.
avaabË
(è< 
	gIÁeg”
.
	gBYTES
){

105 
as£¹
 
	gŒue
;

107 
	gf›ldV®ueL’gth
 = 
¡»am
.
»adIÁ
();

108 
	g¡»am
.
avaabË
(è< 
	gf›ldV®ueL’gth
){

109 
as£¹
 
	gŒue
;

111 
	gby‹
[] 
	gf›ldV®ue
 = 
Ãw
 
by‹
[
f›ldV®ueL’gth
];

112 
	g»s
 = 
¡»am
.
»ad
(
f›ldV®ue
);

113 ià(
	g»s
 !ğ
f›ldV®ue
.
Ëngth
){

114 
¡»am
.
şo£
();

115  
	gStus
.
	gERROR
;

117 
	g»suÉ
.
put
(
Ãw
 
SŒšg
(
f›ldKey
),‚ew 
By‹A¼ayBy‹I‹¿tÜ
(
f›ldV®ue
));

119 
	g¡»am
.
şo£
();

120  
	gStus
.
	gOK
;

121 } 
ÿtch
(
Exû±iÚ
 
e
){

122 
	gLOG
.
”rÜ
("E¼Ü duršg„—d,abË " + 
bË
 + ", key " + 
key
 + ",ƒxû±iÚ " + 
e
.
g‘Mes§ge
());

123  
Ãw
 
Stus
("readƒrror", "readingƒxception");

127 @
Ov”ride


128 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tKey
, 
»cÜdCouÁ
, 
S‘
<SŒšg> 
f›lds
,

129 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

130  
	gStus
.
	gNOT_IMPLEMENTED
;

133 @
Ov”ride


134 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

135  
š£¹
(
bË
, 
key
, 
v®ues
);

138 @
Ov”ride


139 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

140 
	gŒy
 {

141 
SŒšg
 
	g·th
 = 
bË
 + "/" + 
key
;

142 
C¿KeyV®ue
 
	gfe
 = 
ş›Á
.
ü—‹
(
·th
, 
C¿NodeTy³
.
KEYVALUE
, 
C¿StÜageCÏss
.
DEFAULT
,

143 
C¿LoÿtiÚCÏss
.
DEFAULT
, 
’um”©eKeys
).
g‘
().
asKeyV®ue
();

144 
C¿Bufã»dOuutSŒ—m
 
	g¡»am
 = 
fe
.
g‘Bufã»dOuutSŒ—m
(1024);

145 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()){

146 
by‹
[] 
f›ldKey
 = 
’Œy
.
g‘Key
().
g‘By‹s
();

147 
	gf›ldKeyL’gth
 = 
f›ldKey
.
Ëngth
;

148 
	gby‹
[] 
	gf›ldV®ue
 = 
’Œy
.
g‘V®ue
().
toA¼ay
();

149 
	gf›ldV®ueL’gth
 = 
f›ldV®ue
.
Ëngth
;

150 
	g¡»am
.
wr™eIÁ
(
f›ldKeyL’gth
);

151 
	g¡»am
.
wr™e
(
f›ldKey
);

152 
	g¡»am
.
wr™eIÁ
(
f›ldV®ueL’gth
);

153 
	g¡»am
.
wr™e
(
f›ldV®ue
);

155 
	gfe
.
syncDœ
();

156 
	g¡»am
.
şo£
();

157 } 
ÿtch
(
Exû±iÚ
 
e
){

158 
	gLOG
.
”rÜ
("E¼Ü duršg in£¹,abË " + 
bË
 + ", key " + 
key
 + ",ƒxû±iÚ " + 
e
.
g‘Mes§ge
());

159  
	gStus
.
	gERROR
;

161  
	gStus
.
	gOK
;

164 @
Ov”ride


165 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

166 
Œy
 {

167 
SŒšg
 
·th
 = 
bË
 + "/" + 
key
;

168 
ş›Á
.
	`d–‘e
(
·th
, 
çl£
).
	`g‘
().
	`syncDœ
();

169 } 
	`ÿtch
(
Exû±iÚ
 
e
){

170 
LOG
.
	`”rÜ
("E¼Ü duršg d–‘e,abË " + 
bË
 + ", key " + 
key
 + ",ƒxû±iÚ " + 
e
.
	`g‘Mes§ge
());

171  
Stus
.
ERROR
;

173  
Stus
.
OK
;

174 
	}
}

	@crail/src/main/java/site/ycsb/db/crail/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	güa
;

	@dynamodb/src/main/java/site/ycsb/db/DynamoDBClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gcom
.
	gamazÚaws
.
	gAmazÚCl›ÁExû±iÚ
;

20 
impÜt
 
	gcom
.
	gamazÚaws
.
	gAmazÚS”viûExû±iÚ
;

21 
impÜt
 
	gcom
.
	gamazÚaws
.
	gCl›ÁCÚfigu¿tiÚ
;

22 
impÜt
 
	gcom
.
	gamazÚaws
.
	gauth
.
	gAWSSticC»d’tŸlsProvid”
;

23 
impÜt
 
	gcom
.
	gamazÚaws
.
	gauth
.
	gPrİ”t›sC»d’tŸls
;

24 
impÜt
 
	gcom
.
	gamazÚaws
.
	gş›Á
.
	gbud”
.
	gAwsCl›ÁBud”
;

25 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gdyÇmodbv2
.
	gAmazÚDyÇmoDB
;

26 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gdyÇmodbv2
.
	gAmazÚDyÇmoDBCl›ÁBud”
;

27 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gdyÇmodbv2
.
	gmod–
.*;

28 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLev–
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

30 
impÜt
 
	gs™e
.
	gycsb
.*;

32 
impÜt
 
	gjava
.
	gio
.
	gFe
;

33 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

34 
impÜt
 
	gjava
.
	gut
.
	gM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

36 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

37 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

43 
public
 cÏs 
	cDyÇmoDBCl›Á
 
ex‹nds
 
	mDB
 {

52 
´iv©e
 
	ePrim¬yKeyTy³
 {

53 
	mHASH
,

54 
	mHASH_AND_RANGE


57 
´iv©e
 
AmazÚDyÇmoDB
 
	gdyÇmoDB
;

58 
´iv©e
 
SŒšg
 
	g´im¬yKeyName
;

59 
´iv©e
 
Prim¬yKeyTy³
 
	g´im¬yKeyTy³
 = Prim¬yKeyTy³.
HASH
;

64 
´iv©e
 
SŒšg
 
	ghashKeyV®ue
;

65 
´iv©e
 
SŒšg
 
	ghashKeyName
;

67 
´iv©e
 
boŞ—n
 
	gcÚsi¡’tR—d
 = 
çl£
;

68 
´iv©e
 
SŒšg
 
	g»giÚ
 = "us-east-1";

69 
´iv©e
 
SŒšg
 
	g’dpošt
 = 
nuÎ
;

70 
´iv©e
 
	gmaxCÚÃùs
 = 50;

71 
´iv©e
 
fš®
 
Logg”
 
	gLOGGER
 = Logg”.
g‘Logg”
(
DyÇmoDBCl›Á
.
şass
);

72 
´iv©e
 
fš®
 
Stus
 
	gCLIENT_ERROR
 = 
Ãw
 Status("CLIENT_ERROR", "Anƒrror occurred onhe client.");

73 
´iv©e
 
fš®
 
SŒšg
 
	gDEFAULT_HASH_KEY_VALUE
 = "YCSB_0";

75 @
Ov”ride


76 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

77 
SŒšg
 
debug
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.debug", 
nuÎ
);

79 ià(
nuÎ
 !ğ
debug
 && "Œue".
	`equ®sIgnÜeCa£
(debug)) {

80 
LOGGER
.
	`£tLev–
(
Lev–
.
DEBUG
);

83 
SŒšg
 
cÚfigu»dEndpošt
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.’dpošt", 
nuÎ
);

84 
SŒšg
 
üed’tŸlsFe
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.awsC»d’tŸlsFe", 
nuÎ
);

85 
SŒšg
 
´im¬yKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.´im¬yKey", 
nuÎ
);

86 
SŒšg
 
´im¬yKeyTy³SŒšg
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.´im¬yKeyTy³", 
nuÎ
);

87 
SŒšg
 
cÚsi¡’tR—ds
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.cÚsi¡’tR—ds", 
nuÎ
);

88 
SŒšg
 
cÚÃùMax
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.cÚÃùMax", 
nuÎ
);

89 
SŒšg
 
cÚfigu»dRegiÚ
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.»giÚ", 
nuÎ
);

91 ià(
nuÎ
 !ğ
cÚÃùMax
) {

92 
this
.
maxCÚÃùs
 = 
IÁeg”
.
	`·r£IÁ
(
cÚÃùMax
);

95 ià(
nuÎ
 !ğ
cÚsi¡’tR—ds
 && "Œue".
	`equ®sIgnÜeCa£
(consistentReads)) {

96 
this
.
cÚsi¡’tR—d
 = 
Œue
;

99 ià(
nuÎ
 !ğ
cÚfigu»dEndpošt
) {

100 
this
.
’dpošt
 = 
cÚfigu»dEndpošt
;

103 ià(
nuÎ
 =ğ
´im¬yKey
 ||…rim¬yKey.
	`Ëngth
() < 1) {

104 
throw
 
Ãw
 
	`DBExû±iÚ
("Missing…rimary key‡ttribute‚ame, cannot continue");

107 ià(
nuÎ
 !ğ
´im¬yKeyTy³SŒšg
) {

108 
Œy
 {

109 
this
.
´im¬yKeyTy³
 = 
Prim¬yKeyTy³
.
	`v®ueOf
(
´im¬yKeyTy³SŒšg
.
	`Œim
().
	`toUµ”Ca£
());

110 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

111 
throw
 
Ãw
 
	`DBExû±iÚ
("Inv®id…rim¬y key mod¥ecif›d: " + 
´im¬yKeyTy³SŒšg
 +

116 ià(
this
.
´im¬yKeyTy³
 =ğ
Prim¬yKeyTy³
.
HASH_AND_RANGE
) {

122 
SŒšg
 
cÚfigu»dHashKeyName
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.hashKeyName", 
nuÎ
);

123 ià(
nuÎ
 =ğ
cÚfigu»dHashKeyName
 || cÚfigu»dHashKeyName.
	`isEm±y
()) {

124 
throw
 
Ãw
 
	`DBExû±iÚ
("Must specify‡‚on-empty hash key‚ame whenhe…rimary keyype is HASH_AND_RANGE.");

126 
this
.
hashKeyName
 = 
cÚfigu»dHashKeyName
;

127 
this
.
hashKeyV®ue
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("dyÇmodb.hashKeyV®ue", 
DEFAULT_HASH_KEY_VALUE
);

130 ià(
nuÎ
 !ğ
cÚfigu»dRegiÚ
 && cÚfigu»dRegiÚ.
	`Ëngth
() > 0) {

131 
»giÚ
 = 
cÚfigu»dRegiÚ
;

134 
Œy
 {

135 
AmazÚDyÇmoDBCl›ÁBud”
 
dyÇmoDBBud”
 = AmazÚDyÇmoDBCl›ÁBud”.
	`¡ªd¬d
();

136 
dyÇmoDBBud”
 = 
nuÎ
 =ğ
’dpošt
 ?

137 
dyÇmoDBBud”
.
	`w™hRegiÚ
(
this
.
»giÚ
) :

138 
dyÇmoDBBud”
.
	`w™hEndpoštCÚfigu¿tiÚ
(

139 
Ãw
 
AwsCl›ÁBud”
.
	`EndpoštCÚfigu¿tiÚ
(
this
.
’dpošt
,his.
»giÚ
)

141 
dyÇmoDB
 = 
dyÇmoDBBud”


142 .
	`w™hCl›ÁCÚfigu¿tiÚ
(

143 
Ãw
 
	`Cl›ÁCÚfigu¿tiÚ
()

144 .
	`w™hTıK“pAlive
(
Œue
)

145 .
	`w™hMaxCÚÃùiÚs
(
this
.
maxCÚÃùs
)

147 .
	`w™hC»d’tŸls
(
Ãw
 
	`AWSSticC»d’tŸlsProvid”
Òew 
	`Prİ”t›sC»d’tŸls
Òew 
	`Fe
(
üed’tŸlsFe
))))

148 .
	`bud
();

149 
´im¬yKeyName
 = 
´im¬yKey
;

150 
LOGGER
.
	`šfo
("dyÇmodb cÚÃùiÚ c»©ed w™h " + 
this
.
’dpošt
);

151 } 
	`ÿtch
 (
Exû±iÚ
 
e1
) {

152 
LOGGER
.
	`”rÜ
("DyÇmoDBCl›Á.š™(): Could‚Ù in™ŸlizDyÇmoDB cl›Á.", 
e1
);

154 
	}
}

156 @
Ov”ride


157 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

158 ià(
	gLOGGER
.
isDebugEÇbËd
()) {

159 
	gLOGGER
.
debug
("»adkey: " + 
key
 + " fromabË: " + 
bË
);

162 
G‘I‹mReque¡
 
	g»q
 = 
Ãw
 G‘I‹mReque¡(
bË
, 
ü—‹Prim¬yKey
(
key
));

163 
	g»q
.
£tA‰ribu‹sToG‘
(
f›lds
);

164 
	g»q
.
£tCÚsi¡’tR—d
(
cÚsi¡’tR—d
);

165 
G‘I‹mResuÉ
 
	g»s
;

167 
	gŒy
 {

168 
	g»s
 = 
dyÇmoDB
.
g‘I‹m
(
»q
);

169 } 
ÿtch
 (
AmazÚS”viûExû±iÚ
 
ex
) {

170 
	gLOGGER
.
”rÜ
(
ex
);

171  
	gStus
.
	gERROR
;

172 } 
ÿtch
 (
AmazÚCl›ÁExû±iÚ
 
ex
) {

173 
	gLOGGER
.
”rÜ
(
ex
);

174  
	gCLIENT_ERROR
;

177 ià(
	gnuÎ
 !ğ
»s
.
g‘I‹m
()) {

178 
»suÉ
.
putAÎ
(
exŒaùResuÉ
(
»s
.
g‘I‹m
()));

179 ià(
	gLOGGER
.
isDebugEÇbËd
()) {

180 
	gLOGGER
.
debug
("ResuÉ: " + 
»s
.
toSŒšg
());

183  
	gStus
.
	gOK
;

186 @
Ov”ride


187 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

188 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

190 ià(
	gLOGGER
.
isDebugEÇbËd
()) {

191 
	gLOGGER
.
debug
("sÿÀ" + 
»cÜdcouÁ
 + "„ecÜd äom key: " + 
¡¬tkey
 + " oÀbË: " + 
bË
);

198 
G‘I‹mReque¡
 
	gg»q
 = 
Ãw
 G‘I‹mReque¡(
bË
, 
ü—‹Prim¬yKey
(
¡¬tkey
));

199 
	gg»q
.
£tA‰ribu‹sToG‘
(
f›lds
);

201 
G‘I‹mResuÉ
 
	gg»s
;

203 
	gŒy
 {

204 
	gg»s
 = 
dyÇmoDB
.
g‘I‹m
(
g»q
);

205 } 
ÿtch
 (
AmazÚS”viûExû±iÚ
 
ex
) {

206 
	gLOGGER
.
”rÜ
(
ex
);

207  
	gStus
.
	gERROR
;

208 } 
ÿtch
 (
AmazÚCl›ÁExû±iÚ
 
ex
) {

209 
	gLOGGER
.
”rÜ
(
ex
);

210  
	gCLIENT_ERROR
;

213 ià(
	gnuÎ
 !ğ
g»s
.
g‘I‹m
()) {

214 
»suÉ
.
add
(
exŒaùResuÉ
(
g»s
.
g‘I‹m
()));

217 
	gcouÁ
 = 1;

219 
	gM­
<
	gSŒšg
, 
	gA‰ribu‹V®ue
> 
	g¡¬tKey
 = 
ü—‹Prim¬yKey
(
¡¬tkey
);

220 
SÿnReque¡
 
	g»q
 = 
Ãw
 SÿnReque¡(
bË
);

221 
	g»q
.
£tA‰ribu‹sToG‘
(
f›lds
);

222 
	gcouÁ
 < 
	g»cÜdcouÁ
) {

223 
	g»q
.
£tExşusiveS¹Key
(
¡¬tKey
);

224 
	g»q
.
£tLim™
(
»cÜdcouÁ
 - 
couÁ
);

225 
SÿnResuÉ
 
	g»s
;

226 
	gŒy
 {

227 
	g»s
 = 
dyÇmoDB
.
sÿn
(
»q
);

228 } 
ÿtch
 (
AmazÚS”viûExû±iÚ
 
ex
) {

229 
	gLOGGER
.
”rÜ
(
ex
);

230  
	gStus
.
	gERROR
;

231 } 
ÿtch
 (
AmazÚCl›ÁExû±iÚ
 
ex
) {

232 
	gLOGGER
.
”rÜ
(
ex
);

233  
	gCLIENT_ERROR
;

236 
	gcouÁ
 +ğ
»s
.
g‘CouÁ
();

237 
	gM­
<
	gSŒšg
, 
	gA‰ribu‹V®ue
> 
	g™ems
 : 
»s
.
g‘I‹ms
()) {

238 
»suÉ
.
add
(
exŒaùResuÉ
(
™ems
));

240 
	g¡¬tKey
 = 
»s
.
g‘La¡Ev®u©edKey
();

244  
	gStus
.
	gOK
;

247 @
Ov”ride


248 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

249 ià(
	gLOGGER
.
isDebugEÇbËd
()) {

250 
	gLOGGER
.
debug
("upd©ekey: " + 
key
 + " fromabË: " + 
bË
);

253 
	gM­
<
	gSŒšg
, 
	gA‰ribu‹V®ueUpd©e
> 
	g©Œibu‹s
 = 
Ãw
 
HashM­
<>(
v®ues
.
size
());

254 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gv®
 : 
v®ues
.
’ŒyS‘
()) {

255 
A‰ribu‹V®ue
 
v
 = 
Ãw
 A‰ribu‹V®ue(
v®
.
g‘V®ue
().
toSŒšg
());

256 
	g©Œibu‹s
.
put
(
v®
.
g‘Key
(), 
Ãw
 
A‰ribu‹V®ueUpd©e
().
w™hV®ue
(
v
).
w™hAùiÚ
("PUT"));

259 
Upd©eI‹mReque¡
 
	g»q
 = 
Ãw
 Upd©eI‹mReque¡(
bË
, 
ü—‹Prim¬yKey
(
key
), 
©Œibu‹s
);

261 
	gŒy
 {

262 
	gdyÇmoDB
.
upd©eI‹m
(
»q
);

263 } 
ÿtch
 (
AmazÚS”viûExû±iÚ
 
ex
) {

264 
	gLOGGER
.
”rÜ
(
ex
);

265  
	gStus
.
	gERROR
;

266 } 
ÿtch
 (
AmazÚCl›ÁExû±iÚ
 
ex
) {

267 
	gLOGGER
.
”rÜ
(
ex
);

268  
	gCLIENT_ERROR
;

270  
	gStus
.
	gOK
;

273 @
Ov”ride


274 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

275 ià(
	gLOGGER
.
isDebugEÇbËd
()) {

276 
	gLOGGER
.
debug
("š£¹key: " + 
´im¬yKeyName
 + "-" + 
key
 + " fromabË: " + 
bË
);

279 
	gM­
<
	gSŒšg
, 
	gA‰ribu‹V®ue
> 
	g©Œibu‹s
 = 
ü—‹A‰ribu‹s
(
v®ues
);

281 
	g©Œibu‹s
.
put
(
´im¬yKeyName
, 
Ãw
 
A‰ribu‹V®ue
(
key
));

282 ià(
	g´im¬yKeyTy³
 =ğ
Prim¬yKeyTy³
.
HASH_AND_RANGE
) {

286 
©Œibu‹s
.
put
(
hashKeyName
, 
Ãw
 
A‰ribu‹V®ue
(
hashKeyV®ue
));

289 
PutI‹mReque¡
 
	gputI‹mReque¡
 = 
Ãw
 PutI‹mReque¡(
bË
, 
©Œibu‹s
);

290 
	gŒy
 {

291 
	gdyÇmoDB
.
putI‹m
(
putI‹mReque¡
);

292 } 
ÿtch
 (
AmazÚS”viûExû±iÚ
 
ex
) {

293 
	gLOGGER
.
”rÜ
(
ex
);

294  
	gStus
.
	gERROR
;

295 } 
ÿtch
 (
AmazÚCl›ÁExû±iÚ
 
ex
) {

296 
	gLOGGER
.
”rÜ
(
ex
);

297  
	gCLIENT_ERROR
;

299  
	gStus
.
	gOK
;

302 @
Ov”ride


303 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

304 ià(
LOGGER
.
	`isDebugEÇbËd
()) {

305 
LOGGER
.
	`debug
("d–‘ekey: " + 
key
 + " fromabË: " + 
bË
);

308 
D–‘eI‹mReque¡
 
»q
 = 
Ãw
 
	`D–‘eI‹mReque¡
(
bË
, 
	`ü—‹Prim¬yKey
(
key
));

310 
Œy
 {

311 
dyÇmoDB
.
	`d–‘eI‹m
(
»q
);

312 } 
	`ÿtch
 (
AmazÚS”viûExû±iÚ
 
ex
) {

313 
LOGGER
.
	`”rÜ
(
ex
);

314  
Stus
.
ERROR
;

315 } 
	`ÿtch
 (
AmazÚCl›ÁExû±iÚ
 
ex
) {

316 
LOGGER
.
	`”rÜ
(
ex
);

317  
CLIENT_ERROR
;

319  
Stus
.
OK
;

320 
	}
}

322 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gA‰ribu‹V®ue
> 
ü—‹A‰ribu‹s
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

323 
	gM­
<
	gSŒšg
, 
	gA‰ribu‹V®ue
> 
	g©Œibu‹s
 = 
Ãw
 
HashM­
<>(
v®ues
.
size
() + 1);

324 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gv®
 : 
v®ues
.
’ŒyS‘
()) {

325 
©Œibu‹s
.
put
(
v®
.
g‘Key
(), 
Ãw
 
A‰ribu‹V®ue
(v®.
g‘V®ue
().
toSŒšg
()));

327  
	g©Œibu‹s
;

330 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
exŒaùResuÉ
(
M­
<
SŒšg
, 
A‰ribu‹V®ue
> 
™em
) {

331 ià(
	gnuÎ
 =ğ
™em
) {

332  
nuÎ
;

334 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	grI‹ms
 = 
Ãw
 
HashM­
<>(
™em
.
size
());

336 
	gEÁry
<
	gSŒšg
, 
	gA‰ribu‹V®ue
> 
	g©Œ
 : 
™em
.
’ŒyS‘
()) {

337 ià(
LOGGER
.
isDebugEÇbËd
()) {

338 
LOGGER
.
debug
(
SŒšg
.
fÜm©
("ResuÉ- key: %s, v®ue: %s", 
©Œ
.
g‘Key
(),‡‰r.
g‘V®ue
()));

340 
	grI‹ms
.
put
(
©Œ
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
×‰r.
g‘V®ue
().
g‘S
()));

342  
	grI‹ms
;

345 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gA‰ribu‹V®ue
> 
	$ü—‹Prim¬yKey
(
SŒšg
 
key
) {

346 
M­
<
SŒšg
, 
A‰ribu‹V®ue
> 
k
 = 
Ãw
 
HashM­
<>();

347 ià(
´im¬yKeyTy³
 =ğ
Prim¬yKeyTy³
.
HASH
) {

348 
k
.
	`put
(
´im¬yKeyName
, 
Ãw
 
	`A‰ribu‹V®ue
().
	`w™hS
(
key
));

349 } ià(
´im¬yKeyTy³
 =ğ
Prim¬yKeyTy³
.
HASH_AND_RANGE
) {

350 
k
.
	`put
(
hashKeyName
, 
Ãw
 
	`A‰ribu‹V®ue
().
	`w™hS
(
hashKeyV®ue
));

351 
k
.
	`put
(
´im¬yKeyName
, 
Ãw
 
	`A‰ribu‹V®ue
().
	`w™hS
(
key
));

353 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Assertion Error: impossible…rimary keyype");

355  
k
;

356 
	}
}

	@dynamodb/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@elasticsearch/src/main/java/site/ycsb/db/ElasticsearchClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	g£‰šgs
.
	gS‘tšgs
.
	gBud”
;

21 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	gxcÚ‹Á
.
	gXCÚ‹ÁFaùÜy
.
	gjsÚBud”
;

22 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gšdex
.
	gqu”y
.
	gQu”yBud”s
.
	g¿ngeQu”y
;

23 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gnode
.
	gNodeBud”
.
	gnodeBud”
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

31 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gadmš
.
	gşu¡”
.
	gh—Éh
.
	gClu¡”H—ÉhReque¡
;

32 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gadmš
.
	gšdiûs
.
	gü—‹
.
	gC»©eIndexReque¡
;

33 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gd–‘e
.
	gD–‘eRe¥Ú£
;

34 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gg‘
.
	gG‘Re¥Ú£
;

35 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	g£¬ch
.
	gS—rchRe¥Ú£
;

36 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gş›Á
.
	gCl›Á
;

37 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gş›Á
.
	gReque¡s
;

38 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gş›Á
.
	gŒª¥Üt
.
	gT¿n¥ÜtCl›Á
;

39 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	g£‰šgs
.
	gS‘tšgs
;

40 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	gŒª¥Üt
.
	gIÃtSock‘T¿n¥ÜtAdd»ss
;

41 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	gxcÚ‹Á
.
	gXCÚ‹ÁBud”
;

42 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gšdex
.
	gqu”y
.
	gRªgeQu”yBud”
;

43 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gnode
.
	gNode
;

44 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	g£¬ch
.
	gS—rchH™
;

46 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtAdd»ss
;

47 
impÜt
 
	gjava
.
	gÃt
.
	gUnknownHo¡Exû±iÚ
;

48 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

49 
impÜt
 
	gjava
.
	gut
.
	gM­
;

50 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

51 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

52 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

53 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

68 
public
 cÏs 
	cEÏ¡ic£¬chCl›Á
 
ex‹nds
 
	mDB
 {

70 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_CLUSTER_NAME
 = "es.ycsb.cluster";

71 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_INDEX_KEY
 = "es.ycsb";

72 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_REMOTE_HOST
 = "localhost:9300";

73 
´iv©e
 
fš®
 
	mNUMBER_OF_SHARDS
 = 1;

74 
´iv©e
 
fš®
 
	mNUMBER_OF_REPLICAS
 = 0;

75 
´iv©e
 
Node
 
	mnode
;

76 
´iv©e
 
Cl›Á
 
	mş›Á
;

77 
´iv©e
 
SŒšg
 
	mšdexKey
;

78 
´iv©e
 
BoŞ—n
 
	m»mÙeMode
;

84 @
Ov”ride


85 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

86 
fš®
 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

90 
»mÙeMode
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("es.remote", "false"));

92 
fš®
 
SŒšg
 
·thHome
 = 
´İs
.
	`g‘Prİ”ty
("path.home");

95 ià(!
»mÙeMode
 && (
·thHome
 =ğ
nuÎ
 ||…©hHome.
	`isEm±y
())) {

96 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("path.home must be specified when„unning inƒmbedded mode");

99 
this
.
šdexKey
 = 
´İs
.
	`g‘Prİ”ty
("es.šdex.key", 
DEFAULT_INDEX_KEY
);

101 
numb”OfSh¬ds
 = 
	`·r£IÁeg”Prİ”ty
(
´İs
, "es.numb”_of_sh¬ds", 
NUMBER_OF_SHARDS
);

102 
numb”OfR•liÿs
 = 
	`·r£IÁeg”Prİ”ty
(
´İs
, "es.numb”_of_»¶iÿs", 
NUMBER_OF_REPLICAS
);

104 
BoŞ—n
 
Ãwdb
 = BoŞ—n.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("es.newdb", "false"));

105 
Bud”
 
£‰šgs
 = 
S‘tšgs
.
	`£‰šgsBud”
()

106 .
	`put
("şu¡”.Çme", 
DEFAULT_CLUSTER_NAME
)

107 .
	`put
("node.loÿl", 
BoŞ—n
.
	`toSŒšg
(!
»mÙeMode
))

108 .
	`put
("·th.home", 
·thHome
);

112 
£‰šgs
.
	`put
(
´İs
);

113 
fš®
 
SŒšg
 
şu¡”Name
 = 
£‰šgs
.
	`g‘
("cluster.name");

114 
Sy¡em
.
”r
.
	`´šn
("EÏ¡ic£¬ch s¹šg‚odğ" + 
şu¡”Name
);

115 
Sy¡em
.
”r
.
	`´šn
("EÏ¡ic£¬ch‚od·th.homğ" + 
£‰šgs
.
	`g‘
("path.home"));

116 
Sy¡em
.
”r
.
	`´šn
("EÏ¡ic£¬ch RemÙModğ" + 
»mÙeMode
);

118 ià(
»mÙeMode
) {

119 
£‰šgs
.
	`put
("ş›Á.Œª¥Üt.¢iff", 
Œue
)

120 .
	`put
("ş›Á.Œª¥Üt.ignÜe_şu¡”_Çme", 
çl£
)

121 .
	`put
("client.transport.ping_timeout", "30s")

122 .
	`put
("client.transport.nodes_sampler_interval", "30s");

124 
SŒšg
[] 
nodeLi¡
 = 
´İs
.
	`g‘Prİ”ty
("es.ho¡s.li¡", 
DEFAULT_REMOTE_HOST
).
	`¥l™
(",");

125 
Sy¡em
.
out
.
	`´šn
("EÏ¡ic£¬ch RemÙHo¡ ğ" + 
´İs
.
	`g‘Prİ”ty
("es.ho¡s.li¡", 
DEFAULT_REMOTE_HOST
));

126 
T¿n¥ÜtCl›Á
 
tCl›Á
 = T¿n¥ÜtCl›Á.
	`bud”
().
	`£‰šgs
(
£‰šgs
).
	`bud
();

127 
SŒšg
 
h
 : 
nodeLi¡
) {

128 
SŒšg
[] 
nodes
 = 
h
.
	`¥l™
(":");

129 
Œy
 {

130 
tCl›Á
.
	`addT¿n¥ÜtAdd»ss
(
Ãw
 
	`IÃtSock‘T¿n¥ÜtAdd»ss
(

131 
IÃtAdd»ss
.
	`g‘ByName
(
nodes
[0]),

132 
IÁeg”
.
	`·r£IÁ
(
nodes
[1])

134 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
e
) {

135 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("UÇbËØ·r£…Üˆnumb”.", 
e
);

136 } 
	`ÿtch
 (
UnknownHo¡Exû±iÚ
 
e
) {

137 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("UÇbËØId’tify ho¡.", 
e
);

140 
ş›Á
 = 
tCl›Á
;

142 
node
 = 
	`nodeBud”
().
	`şu¡”Name
(
şu¡”Name
).
	`£‰šgs
(
£‰šgs
).
	`node
();

143 
node
.
	`¡¬t
();

144 
ş›Á
 = 
node
.
	`ş›Á
();

147 
fš®
 
boŞ—n
 
exi¡s
 =

148 
ş›Á
.
	`admš
().
	`šdiûs
()

149 .
	`exi¡s
(
Reque¡s
.
	`šdiûsExi¡sReque¡
(
šdexKey
)).
	`aùiÚG‘
()

150 .
	`isExi¡s
();

151 ià(
exi¡s
 && 
Ãwdb
) {

152 
ş›Á
.
	`admš
().
	`šdiûs
().
	`´•¬eD–‘e
(
šdexKey
).
	`execu‹
().
	`aùiÚG‘
();

154 ià(!
exi¡s
 || 
Ãwdb
) {

155 
ş›Á
.
	`admš
().
	`šdiûs
().
	`ü—‹
(

156 
Ãw
 
	`C»©eIndexReque¡
(
šdexKey
)

157 .
	`£‰šgs
(

158 
S‘tšgs
.
	`bud”
()

159 .
	`put
("šdex.numb”_of_sh¬ds", 
numb”OfSh¬ds
)

160 .
	`put
("šdex.numb”_of_»¶iÿs", 
numb”OfR•liÿs
)

161 .
	`put
("šdex.m­pšg._id.šdexed", 
Œue
)

162 )).
	`aùiÚG‘
();

164 
ş›Á
.
	`admš
().
	`şu¡”
().
	`h—Éh
(
Ãw
 
	`Clu¡”H—ÉhReque¡
().
	`wa™FÜG»’Stus
()).
	`aùiÚG‘
();

167 
´iv©e
 
	$·r£IÁeg”Prİ”ty
(
Prİ”t›s
 
´İ”t›s
, 
SŒšg
 
key
, 
deçuÉV®ue
) {

168 
SŒšg
 
v®ue
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
key
);

169  
v®ue
 =ğ
nuÎ
 ? 
deçuÉV®ue
 : 
IÁeg”
.
	`·r£IÁ
(value);

170 
	}
}

172 @
Ov”ride


173 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

174 ià(!
»mÙeMode
) {

175 ià(!
node
.
	`isClo£d
()) {

176 
ş›Á
.
	`şo£
();

177 
node
.
	`şo£
();

180 
ş›Á
.
	`şo£
();

182 
	}
}

198 @
Ov”ride


199 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

200 
	gŒy
 {

201 
fš®
 
XCÚ‹ÁBud”
 
	gdoc
 = 
jsÚBud”
().
¡¬tObjeù
();

203 
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
).
’ŒyS‘
()) {

204 
doc
.
f›ld
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

207 
	gdoc
.
’dObjeù
();

209 
	gş›Á
.
´•¬eIndex
(
šdexKey
, 
bË
, 
key
).
£tSourû
(
doc
).
execu‹
().
aùiÚG‘
();

211  
	gStus
.
	gOK
;

212 } 
ÿtch
 (
Exû±iÚ
 
e
) {

213 
	ge
.
´štSckT¿û
();

214  
	gStus
.
	gERROR
;

228 @
Ov”ride


229 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

230 
Œy
 {

231 
D–‘eRe¥Ú£
 
»¥Ú£
 = 
ş›Á
.
	`´•¬eD–‘e
(
šdexKey
, 
bË
, 
key
).
	`execu‹
().
	`aùiÚG‘
();

232 ià(
»¥Ú£
.
	`isFound
()) {

233  
Stus
.
OK
;

235  
Stus
.
NOT_FOUND
;

237 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

238 
e
.
	`´štSckT¿û
();

239  
Stus
.
ERROR
;

241 
	}
}

257 @
Ov”ride


258 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

259 
	gŒy
 {

260 
fš®
 
G‘Re¥Ú£
 
	g»¥Ú£
 = 
ş›Á
.
´•¬eG‘
(
šdexKey
, 
bË
, 
key
).
execu‹
().
aùiÚG‘
();

262 ià(
	g»¥Ú£
.
isExi¡s
()) {

263 ià(
	gf›lds
 !ğ
nuÎ
) {

264 
SŒšg
 
f›ld
 : 
f›lds
) {

265 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(

266 (
SŒšg
è
»¥Ú£
.
g‘Sourû
().
g‘
(
f›ld
)));

269 
SŒšg
 
	gf›ld
 : 
»¥Ú£
.
g‘Sourû
().
keyS‘
()) {

270 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(

271 (
SŒšg
è
»¥Ú£
.
g‘Sourû
().
g‘
(
f›ld
)));

274  
	gStus
.
	gOK
;

276  
	gStus
.
	gNOT_FOUND
;

278 } 
ÿtch
 (
Exû±iÚ
 
e
) {

279 
	ge
.
´štSckT¿û
();

280  
	gStus
.
	gERROR
;

298 @
Ov”ride


299 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

300 
	gŒy
 {

301 
fš®
 
G‘Re¥Ú£
 
	g»¥Ú£
 = 
ş›Á
.
´•¬eG‘
(
šdexKey
, 
bË
, 
key
).
execu‹
().
aùiÚG‘
();

303 ià(
	g»¥Ú£
.
isExi¡s
()) {

304 
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
).
’ŒyS‘
()) {

305 
»¥Ú£
.
g‘Sourû
().
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

308 
	gş›Á
.
´•¬eIndex
(
šdexKey
, 
bË
, 
key
).
£tSourû
(
»¥Ú£
.
g‘Sourû
()).
execu‹
().
aùiÚG‘
();

310  
	gStus
.
	gOK
;

312  
	gStus
.
	gNOT_FOUND
;

314 } 
ÿtch
 (
Exû±iÚ
 
e
) {

315 
	ge
.
´štSckT¿û
();

316  
	gStus
.
	gERROR
;

338 @
Ov”ride


339 
public
 
Stus
 
sÿn
(

340 
SŒšg
 
bË
,

341 
SŒšg
 
¡¬tkey
,

342 
»cÜdcouÁ
,

343 
S‘
<
SŒšg
> 
f›lds
,

344 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

345 
	gŒy
 {

346 
fš®
 
RªgeQu”yBud”
 
	g¿ngeQu”y
 = 
¿ngeQu”y
("_id").
g‹
(
¡¬tkey
);

347 
fš®
 
S—rchRe¥Ú£
 
	g»¥Ú£
 = 
ş›Á
.
´•¬eS—rch
(
šdexKey
)

348 .
£tTy³s
(
bË
)

349 .
£tQu”y
(
¿ngeQu”y
)

350 .
£tSize
(
»cÜdcouÁ
)

351 .
execu‹
()

352 .
aùiÚG‘
();

354 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
;

356 
S—rchH™
 
	gh™
 : 
»¥Ú£
.
g‘H™s
()) {

357 
’Œy
 = 
Ãw
 
HashM­
<>(
f›lds
.
size
());

358 
SŒšg
 
	gf›ld
 : 
f›lds
) {

359 
’Œy
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
h™
.
g‘Sourû
().
g‘
(field)));

361 
	g»suÉ
.
add
(
’Œy
);

364  
	gStus
.
	gOK
;

365 } 
ÿtch
 (
Exû±iÚ
 
e
) {

366 
	ge
.
´štSckT¿û
();

367  
	gStus
.
	gERROR
;

	@elasticsearch/src/main/java/site/ycsb/db/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@elasticsearch/src/test/java/site/ycsb/db/ElasticsearchClientTest.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

29 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

30 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

31 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

32 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

33 
impÜt
 
	gÜg
.
	gjun™
.
	gCÏssRuË
;

34 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

35 
impÜt
 
	gÜg
.
	gjun™
.
	gruËs
.
	gTempÜ¬yFŞd”
;

37 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

38 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

39 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

40 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

42 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

44 
public
 cÏs 
	cEÏ¡ic£¬chCl›ÁTe¡
 {

46 @
CÏssRuË
 
public
 
fš®
 
TempÜ¬yFŞd”
 
	m‹mp
 = 
Ãw
 TemporaryFolder();

47 
´iv©e
 
fš®
 
EÏ¡ic£¬chCl›Á
 
	mš¡ªû
 = 
Ãw
 ElasticsearchClient();

48 
´iv©e
 
fš®
 
	mHashM­
<
	mSŒšg
, 
	mBy‹I‹¿tÜ
> 
	mMOCK_DATA
;

49 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_TABLE
 = "MOCK_TABLE";

50 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_KEY0
 = "0";

51 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_KEY1
 = "1";

52 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_KEY2
 = "2";

53 
´iv©e
 
fš®
 
SŒšg
 
	mFIELD_PREFIX
 = 
CÜeWÜklßd
.
FIELD_NAME_PREFIX_DEFAULT
;

56 
	mMOCK_DATA
 = 
Ãw
 
HashM­
<>(10);

57 
	mi
 = 1; i <= 10; i++) {

58 
	mMOCK_DATA
.
put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
("value" + i));

62 @
BefÜeCÏss


63 
public
 
	$£tUpCÏss
(è
throws
 
DBExû±iÚ
 {

64 
fš®
 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

65 
´İs
.
	`put
("·th.home", 
‹mp
.
	`g‘RoÙ
().
	`toSŒšg
());

66 
š¡ªû
.
	`£tPrİ”t›s
(
´İs
);

67 
š¡ªû
.
	`š™
();

68 
	}
}

70 @
Aá”CÏss


71 
public
 
	$‹¬DownCÏss
(è
throws
 
DBExû±iÚ
 {

72 
š¡ªû
.
	`ş—nup
();

73 
	}
}

75 @
BefÜe


76 
public
 
	$£tUp
() {

77 
š¡ªû
.
	`š£¹
(
MOCK_TABLE
, 
MOCK_KEY1
, 
MOCK_DATA
);

78 
š¡ªû
.
	`š£¹
(
MOCK_TABLE
, 
MOCK_KEY2
, 
MOCK_DATA
);

79 
	}
}

81 @
Aá”


82 
public
 
	$‹¬Down
() {

83 
š¡ªû
.
	`d–‘e
(
MOCK_TABLE
, 
MOCK_KEY1
);

84 
š¡ªû
.
	`d–‘e
(
MOCK_TABLE
, 
MOCK_KEY2
);

85 
	}
}

90 @
Te¡


91 
public
 
	$‹¡In£¹
() {

92 
Stus
 
»suÉ
 = 
š¡ªû
.
	`š£¹
(
MOCK_TABLE
, 
MOCK_KEY0
, 
MOCK_DATA
);

93 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

94 
	}
}

99 @
Te¡


100 
public
 
	$‹¡D–‘e
() {

101 
Stus
 
»suÉ
 = 
š¡ªû
.
	`d–‘e
(
MOCK_TABLE
, 
MOCK_KEY1
);

102 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

103 
	}
}

108 @
Te¡


109 
public
 
	$‹¡R—d
() {

110 
S‘
<
SŒšg
> 
f›lds
 = 
MOCK_DATA
.
	`keyS‘
();

111 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉP¬am
 = 
Ãw
 HashMap<>(10);

112 
Stus
 
»suÉ
 = 
š¡ªû
.
	`»ad
(
MOCK_TABLE
, 
MOCK_KEY1
, 
f›lds
, 
»suÉP¬am
);

113 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

114 
	}
}

119 @
Te¡


120 
public
 
	$‹¡Upd©e
() {

121 
i
;

122 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ÃwV®ues
 = 
Ãw
 HashMap<>(10);

124 
i
 = 1; i <= 10; i++) {

125 
ÃwV®ues
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
("newvalue" + i));

128 
Stus
 
»suÉ
 = 
š¡ªû
.
	`upd©e
(
MOCK_TABLE
, 
MOCK_KEY1
, 
ÃwV®ues
);

129 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

132 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉP¬am
 = 
Ãw
 HashMap<>(10);

133 
š¡ªû
.
	`»ad
(
MOCK_TABLE
, 
MOCK_KEY1
, 
MOCK_DATA
.
	`keyS‘
(), 
»suÉP¬am
);

135 
i
 = 1; i <= 10; i++) {

136 
	`as£¹Equ®s
("Ãwv®ue" + 
i
, 
»suÉP¬am
.
	`g‘
(
FIELD_PREFIX
 + i).
	`toSŒšg
());

138 
	}
}

143 @
Te¡


144 
public
 
	$‹¡Sÿn
() {

145 
»cÜdcouÁ
 = 10;

146 
S‘
<
SŒšg
> 
f›lds
 = 
MOCK_DATA
.
	`keyS‘
();

147 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉP¬am
 = 
Ãw
 Vector<>(10);

148 
Stus
 
»suÉ
 = 
š¡ªû
.
	`sÿn
(
MOCK_TABLE
, 
MOCK_KEY1
, 
»cÜdcouÁ
, 
f›lds
, 
»suÉP¬am
);

149 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

150 
	}
}

	@elasticsearch5/src/main/java/site/ycsb/db/elasticsearch5/Elasticsearch5.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
;

20 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

22 
fš®
 cÏs 
	cEÏ¡ic£¬ch5
 {

24 
´iv©e
 
	$EÏ¡ic£¬ch5
() {

28 
fš®
 
SŒšg
 
KEY
 = "key";

30 
	$·r£IÁeg”Prİ”ty
(
fš®
 
Prİ”t›s
 
´İ”t›s
, fš® 
SŒšg
 
key
, fš® 
deçuÉV®ue
) {

31 
fš®
 
SŒšg
 
v®ue
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
key
);

32  
v®ue
 =ğ
nuÎ
 ? 
deçuÉV®ue
 : 
IÁeg”
.
	`·r£IÁ
(value);

33 
	}
}

	@elasticsearch5/src/main/java/site/ycsb/db/elasticsearch5/ElasticsearchClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

25 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gDocWr™eRe¥Ú£
;

26 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gadmš
.
	gşu¡”
.
	gh—Éh
.
	gClu¡”H—ÉhReque¡
;

27 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gadmš
.
	gšdiûs
.
	gü—‹
.
	gC»©eIndexReque¡
;

28 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gadmš
.
	gšdiûs
.
	g»äesh
.
	gReäeshReque¡
;

29 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gd–‘e
.
	gD–‘eRe¥Ú£
;

30 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	gšdex
.
	gIndexRe¥Ú£
;

31 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gaùiÚ
.
	g£¬ch
.
	gS—rchRe¥Ú£
;

32 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gş›Á
.
	gReque¡s
;

33 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gş›Á
.
	gŒª¥Üt
.
	gT¿n¥ÜtCl›Á
;

34 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	g£‰šgs
.
	gS‘tšgs
;

35 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	gŒª¥Üt
.
	gIÃtSock‘T¿n¥ÜtAdd»ss
;

36 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	gxcÚ‹Á
.
	gXCÚ‹ÁBud”
;

37 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gšdex
.
	gqu”y
.
	gRªgeQu”yBud”
;

38 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gšdex
.
	gqu”y
.
	gT”mQu”yBud”
;

39 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	g£¬ch
.
	gS—rchH™
;

40 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gŒª¥Üt
.
	gş›Á
.
	gP»ButT¿n¥ÜtCl›Á
;

42 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtAdd»ss
;

43 
impÜt
 
	gjava
.
	gÃt
.
	gUnknownHo¡Exû±iÚ
;

44 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

45 
impÜt
 
	gjava
.
	gut
.
	gM­
;

46 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

47 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

48 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

49 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

51 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
.
	gEÏ¡ic£¬ch5
.
	gKEY
;

52 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
.
	gEÏ¡ic£¬ch5
.
	g·r£IÁeg”Prİ”ty
;

53 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	g£‰šgs
.
	gS‘tšgs
.
	gBud”
;

54 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	gxcÚ‹Á
.
	gXCÚ‹ÁFaùÜy
.
	gjsÚBud”
;

59 
public
 cÏs 
	cEÏ¡ic£¬chCl›Á
 
ex‹nds
 
	mDB
 {

61 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_CLUSTER_NAME
 = "es.ycsb.cluster";

62 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_INDEX_KEY
 = "es.ycsb";

63 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_REMOTE_HOST
 = "localhost:9300";

64 
´iv©e
 
fš®
 
	mNUMBER_OF_SHARDS
 = 1;

65 
´iv©e
 
fš®
 
	mNUMBER_OF_REPLICAS
 = 0;

66 
´iv©e
 
T¿n¥ÜtCl›Á
 
	mş›Á
;

67 
´iv©e
 
SŒšg
 
	mšdexKey
;

74 @
Ov”ride


75 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

76 
fš®
 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

78 
this
.
šdexKey
 = 
´İs
.
	`g‘Prİ”ty
("es.šdex.key", 
DEFAULT_INDEX_KEY
);

80 
fš®
 
numb”OfSh¬ds
 = 
	`·r£IÁeg”Prİ”ty
(
´İs
, "es.numb”_of_sh¬ds", 
NUMBER_OF_SHARDS
);

81 
fš®
 
numb”OfR•liÿs
 = 
	`·r£IÁeg”Prİ”ty
(
´İs
, "es.numb”_of_»¶iÿs", 
NUMBER_OF_REPLICAS
);

83 
fš®
 
BoŞ—n
 
ÃwIndex
 = BoŞ—n.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("es.new_index", "false"));

84 
fš®
 
Bud”
 
£‰šgs
 = 
S‘tšgs
.
	`bud”
().
	`put
("şu¡”.Çme", 
DEFAULT_CLUSTER_NAME
);

88 
fš®
 
EÁry
<
Objeù
, Objeù> 
e
 : 
´İs
.
	`’ŒyS‘
()) {

89 ià(
e
.
	`g‘Key
(è
š¡ªûof
 
SŒšg
) {

90 
fš®
 
SŒšg
 
key
 = (SŒšgè
e
.
	`g‘Key
();

91 ià(
key
.
	`¡¬tsW™h
("es.setting.")) {

92 
£‰šgs
.
	`put
(
key
.
	`sub¡ršg
("es.£‰šg.".
	`Ëngth
()), 
e
.
	`g‘V®ue
());

97 
£‰šgs
.
	`put
("ş›Á.Œª¥Üt.¢iff", 
Œue
)

98 .
	`put
("ş›Á.Œª¥Üt.ignÜe_şu¡”_Çme", 
çl£
)

99 .
	`put
("client.transport.ping_timeout", "30s")

100 .
	`put
("client.transport.nodes_sampler_interval", "30s");

102 
fš®
 
SŒšg
[] 
nodeLi¡
 = 
´İs
.
	`g‘Prİ”ty
("es.ho¡s.li¡", 
DEFAULT_REMOTE_HOST
).
	`¥l™
(",");

103 
ş›Á
 = 
Ãw
 
	`P»ButT¿n¥ÜtCl›Á
(
£‰šgs
.
	`bud
());

104 
SŒšg
 
h
 : 
nodeLi¡
) {

105 
SŒšg
[] 
nodes
 = 
h
.
	`¥l™
(":");

107 
fš®
 
IÃtAdd»ss
 
add»ss
;

108 
Œy
 {

109 
add»ss
 = 
IÃtAdd»ss
.
	`g‘ByName
(
nodes
[0]);

110 } 
	`ÿtch
 (
UnknownHo¡Exû±iÚ
 
e
) {

111 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("uÇbËØid’t™y ho¡ [" + 
nodes
[0]+ "]", 
e
);

113 
fš®
 
pÜt
;

114 
Œy
 {

115 
pÜt
 = 
IÁeg”
.
	`·r£IÁ
(
nodes
[1]);

116 } 
	`ÿtch
 (
fš®
 
Numb”FÜm©Exû±iÚ
 
e
) {

117 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("uÇbËØ·r£…Üˆ[" + 
nodes
[1] + "]", 
e
);

119 
ş›Á
.
	`addT¿n¥ÜtAdd»ss
(
Ãw
 
	`IÃtSock‘T¿n¥ÜtAdd»ss
(
add»ss
, 
pÜt
));

122 
fš®
 
boŞ—n
 
exi¡s
 =

123 
ş›Á
.
	`admš
().
	`šdiûs
()

124 .
	`exi¡s
(
Reque¡s
.
	`šdiûsExi¡sReque¡
(
šdexKey
)).
	`aùiÚG‘
()

125 .
	`isExi¡s
();

126 ià(
exi¡s
 && 
ÃwIndex
) {

127 
ş›Á
.
	`admš
().
	`šdiûs
().
	`´•¬eD–‘e
(
šdexKey
).
	`g‘
();

129 ià(!
exi¡s
 || 
ÃwIndex
) {

130 
ş›Á
.
	`admš
().
	`šdiûs
().
	`ü—‹
(

131 
Ãw
 
	`C»©eIndexReque¡
(
šdexKey
)

132 .
	`£‰šgs
(

133 
S‘tšgs
.
	`bud”
()

134 .
	`put
("šdex.numb”_of_sh¬ds", 
numb”OfSh¬ds
)

135 .
	`put
("šdex.numb”_of_»¶iÿs", 
numb”OfR•liÿs
)

136 )).
	`aùiÚG‘
();

138 
ş›Á
.
	`admš
().
	`şu¡”
().
	`h—Éh
(
Ãw
 
	`Clu¡”H—ÉhReque¡
().
	`wa™FÜG»’Stus
()).
	`aùiÚG‘
();

141 @
Ov”ride


142 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

143 ià(
ş›Á
 !ğ
nuÎ
) {

144 
ş›Á
.
	`şo£
();

145 
ş›Á
 = 
nuÎ
;

147 
	}
}

149 
´iv©e
 vŞ©
boŞ—n
 
	gisReäeshN“ded
 = 
çl£
;

151 @
Ov”ride


152 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

153 
Œy
 (
XCÚ‹ÁBud”
 
doc
 = 
jsÚBud”
()) {

155 
doc
.
¡¬tObjeù
();

156 
fš®
 
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
).
’ŒyS‘
()) {

157 
doc
.
f›ld
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

159 
	gdoc
.
f›ld
(
KEY
, 
key
);

160 
	gdoc
.
’dObjeù
();

162 
fš®
 
IndexRe¥Ú£
 
	gšdexRe¥Ú£
 = 
ş›Á
.
´•¬eIndex
(
šdexKey
, 
bË
).
£tSourû
(
doc
).
g‘
();

163 ià(
	gšdexRe¥Ú£
.
g‘ResuÉ
(è!ğ
DocWr™eRe¥Ú£
.
ResuÉ
.
CREATED
) {

164  
Stus
.
ERROR
;

167 ià(!
	gisReäeshN“ded
) {

168 
synchrÚized
 (
this
) {

169 
	gisReäeshN“ded
 = 
Œue
;

173  
	gStus
.
	gOK
;

174 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

175 
	ge
.
´štSckT¿û
();

176  
	gStus
.
	gERROR
;

180 @
Ov”ride


181 
public
 
Stus
 
	$d–‘e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
) {

182 
Œy
 {

183 
fš®
 
S—rchRe¥Ú£
 
£¬chRe¥Ú£
 = 
	`£¬ch
(
bË
, 
key
);

184 ià(
£¬chRe¥Ú£
.
	`g‘H™s
().
tÙ®H™s
 == 0) {

185  
Stus
.
NOT_FOUND
;

188 
fš®
 
SŒšg
 
id
 = 
£¬chRe¥Ú£
.
	`g‘H™s
().
	`g‘At
(0).
	`g‘Id
();

190 
fš®
 
D–‘eRe¥Ú£
 
d–‘eRe¥Ú£
 = 
ş›Á
.
	`´•¬eD–‘e
(
šdexKey
, 
bË
, 
id
).
	`g‘
();

191 ià(
d–‘eRe¥Ú£
.
	`g‘ResuÉ
(è=ğ
DocWr™eRe¥Ú£
.
ResuÉ
.
NOT_FOUND
) {

192  
Stus
.
NOT_FOUND
;

195 ià(!
isReäeshN“ded
) {

196 
	`synchrÚized
 (
this
) {

197 
isReäeshN“ded
 = 
Œue
;

201  
Stus
.
OK
;

202 } 
	`ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

203 
e
.
	`´štSckT¿û
();

204  
Stus
.
ERROR
;

206 
	}
}

208 @
Ov”ride


209 
public
 
Stus
 
»ad
(

210 
fš®
 
SŒšg
 
bË
,

211 
fš®
 
SŒšg
 
key
,

212 
fš®
 
S‘
<
SŒšg
> 
f›lds
,

213 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

214 
	gŒy
 {

215 
fš®
 
S—rchRe¥Ú£
 
	g£¬chRe¥Ú£
 = 
£¬ch
(
bË
, 
key
);

216 ià(
	g£¬chRe¥Ú£
.
g‘H™s
().
	gtÙ®H™s
 == 0) {

217  
Stus
.
NOT_FOUND
;

220 
fš®
 
S—rchH™
 
	gh™
 = 
£¬chRe¥Ú£
.
g‘H™s
().
g‘At
(0);

221 ià(
	gf›lds
 !ğ
nuÎ
) {

222 
fš®
 
SŒšg
 
f›ld
 : 
f›lds
) {

223 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
h™
.
g‘Sourû
().
g‘
(field)));

226 
fš®
 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gObjeù
> 
	ge
 : 
h™
.
g‘Sourû
().
’ŒyS‘
()) {

227 ià(
KEY
.
equ®s
(
e
.
g‘Key
())) {

230 
	g»suÉ
.
put
(
e
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
èe.
g‘V®ue
()));

234  
	gStus
.
	gOK
;

235 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

236 
	ge
.
´štSckT¿û
();

237  
	gStus
.
	gERROR
;

241 @
Ov”ride


242 
public
 
Stus
 
upd©e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

243 
	gŒy
 {

244 
fš®
 
S—rchRe¥Ú£
 
	g»¥Ú£
 = 
£¬ch
(
bË
, 
key
);

245 ià(
	g»¥Ú£
.
g‘H™s
().
	gtÙ®H™s
 == 0) {

246  
Stus
.
NOT_FOUND
;

249 
fš®
 
S—rchH™
 
	gh™
 = 
»¥Ú£
.
g‘H™s
().
g‘At
(0);

250 
fš®
 
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
).
’ŒyS‘
()) {

251 
h™
.
g‘Sourû
().
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

254 
fš®
 
IndexRe¥Ú£
 
	gšdexRe¥Ú£
 =

255 
ş›Á
.
´•¬eIndex
(
šdexKey
, 
bË
, 
h™
.
g‘Id
()).
£tSourû
(h™.
g‘Sourû
()).
g‘
();

257 ià(
	gšdexRe¥Ú£
.
g‘ResuÉ
(è!ğ
DocWr™eRe¥Ú£
.
ResuÉ
.
UPDATED
) {

258  
Stus
.
ERROR
;

261 ià(!
	gisReäeshN“ded
) {

262 
synchrÚized
 (
this
) {

263 
	gisReäeshN“ded
 = 
Œue
;

267  
	gStus
.
	gOK
;

268 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

269 
	ge
.
´štSckT¿û
();

270  
	gStus
.
	gERROR
;

274 @
Ov”ride


275 
public
 
Stus
 
sÿn
(

276 
fš®
 
SŒšg
 
bË
,

277 
fš®
 
SŒšg
 
¡¬tkey
,

278 
fš®
 
»cÜdcouÁ
,

279 
fš®
 
S‘
<
SŒšg
> 
f›lds
,

280 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

281 
	gŒy
 {

282 
»äeshIfN“ded
();

283 
fš®
 
RªgeQu”yBud”
 
	gqu”y
 = 
Ãw
 RªgeQu”yBud”(
KEY
).
g‹
(
¡¬tkey
);

284 
fš®
 
S—rchRe¥Ú£
 
	g»¥Ú£
 = 
ş›Á
.
´•¬eS—rch
(
šdexKey
).
£tQu”y
(
qu”y
).
£tSize
(
»cÜdcouÁ
).
g‘
();

286 
fš®
 
S—rchH™
 
	gh™
 : 
»¥Ú£
.
g‘H™s
()) {

287 
fš®
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
;

288 ià(
	gf›lds
 !ğ
nuÎ
) {

289 
’Œy
 = 
Ãw
 
HashM­
<>(
f›lds
.
size
());

290 
fš®
 
SŒšg
 
	gf›ld
 : 
f›lds
) {

291 
’Œy
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
h™
.
g‘Sourû
().
g‘
(field)));

294 
	g’Œy
 = 
Ãw
 
HashM­
<>(
h™
.
g‘Sourû
().
size
());

295 
fš®
 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gObjeù
> 
	gf›ld
 : 
h™
.
g‘Sourû
().
’ŒyS‘
()) {

296 ià(
KEY
.
equ®s
(
f›ld
.
g‘Key
())) {

299 
	g’Œy
.
put
(
f›ld
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
èf›ld.
g‘V®ue
()));

302 
	g»suÉ
.
add
(
’Œy
);

304  
	gStus
.
	gOK
;

305 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

306 
	ge
.
´štSckT¿û
();

307  
	gStus
.
	gERROR
;

311 
´iv©e
 
	$»äeshIfN“ded
() {

312 ià(
isReäeshN“ded
) {

313 
fš®
 
boŞ—n
 
»äesh
;

314 
	`synchrÚized
 (
this
) {

315 ià(
isReäeshN“ded
) {

316 
»äesh
 = 
Œue
;

317 
isReäeshN“ded
 = 
çl£
;

319 
»äesh
 = 
çl£
;

322 ià(
»äesh
) {

323 
ş›Á
.
	`admš
().
	`šdiûs
().
	`»äesh
(
Ãw
 
	`ReäeshReque¡
()).
	`aùiÚG‘
();

326 
	}
}

328 
´iv©e
 
S—rchRe¥Ú£
 
	$£¬ch
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
) {

329 
	`»äeshIfN“ded
();

330  
ş›Á
.
	`´•¬eS—rch
(
šdexKey
).
	`£tTy³s
(
bË
).
	`£tQu”y
(
Ãw
 
	`T”mQu”yBud”
(
KEY
, 
key
)).
	`g‘
();

331 
	}
}

	@elasticsearch5/src/main/java/site/ycsb/db/elasticsearch5/ElasticsearchRestClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gH—d”
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gH‰pEÁ™y
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gH‰pHo¡
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gH‰pStus
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	g’t™y
.
	gCÚ‹ÁTy³
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	g’t™y
.
	gSŒšgEÁ™y
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gmes§ge
.
	gBasicH—d”
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gnio
.
	g’t™y
.
	gNSŒšgEÁ™y
;

33 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gm­
.
	gObjeùM­³r
;

34 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gş›Á
.
	gRe¥Ú£
;

35 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gş›Á
.
	gRe¡Cl›Á
;

36 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	gxcÚ‹Á
.
	gXCÚ‹ÁBud”
;

38 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

39 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

40 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

41 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

42 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

43 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

44 
impÜt
 
	gjava
.
	gut
.
	gM­
;

45 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

46 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

47 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

49 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
.
	gEÏ¡ic£¬ch5
.
	gKEY
;

50 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
.
	gEÏ¡ic£¬ch5
.
	g·r£IÁeg”Prİ”ty
;

51 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
.
	gem±yM­
;

52 
impÜt
 
	gÜg
.
	g–a¡ic£¬ch
.
	gcommÚ
.
	gxcÚ‹Á
.
	gXCÚ‹ÁFaùÜy
.
	gjsÚBud”
;

57 
public
 cÏs 
	cEÏ¡ic£¬chRe¡Cl›Á
 
ex‹nds
 
	mDB
 {

59 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_INDEX_KEY
 = "es.ycsb";

60 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_REMOTE_HOST
 = "localhost:9200";

61 
´iv©e
 
fš®
 
	mNUMBER_OF_SHARDS
 = 1;

62 
´iv©e
 
fš®
 
	mNUMBER_OF_REPLICAS
 = 0;

63 
´iv©e
 
Re¡Cl›Á
 
	m»¡Cl›Á
;

64 
´iv©e
 
SŒšg
 
	mšdexKey
;

71 @
Ov”ride


72 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

73 
fš®
 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

75 
this
.
šdexKey
 = 
´İs
.
	`g‘Prİ”ty
("es.šdex.key", 
DEFAULT_INDEX_KEY
);

77 
fš®
 
numb”OfSh¬ds
 = 
	`·r£IÁeg”Prİ”ty
(
´İs
, "es.numb”_of_sh¬ds", 
NUMBER_OF_SHARDS
);

78 
fš®
 
numb”OfR•liÿs
 = 
	`·r£IÁeg”Prİ”ty
(
´İs
, "es.numb”_of_»¶iÿs", 
NUMBER_OF_REPLICAS
);

80 
fš®
 
BoŞ—n
 
ÃwIndex
 = BoŞ—n.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("es.new_index", "false"));

82 
fš®
 
SŒšg
[] 
nodeLi¡
 = 
´İs
.
	`g‘Prİ”ty
("es.ho¡s.li¡", 
DEFAULT_REMOTE_HOST
).
	`¥l™
(",");

84 
fš®
 
Li¡
<
H‰pHo¡
> 
esH‰pHo¡s
 = 
Ãw
 
A¼ayLi¡
<>(
nodeLi¡
.
Ëngth
);

85 
SŒšg
 
h
 : 
nodeLi¡
) {

86 
SŒšg
[] 
nodes
 = 
h
.
	`¥l™
(":");

87 
esH‰pHo¡s
.
	`add
(
Ãw
 
	`H‰pHo¡
(
nodes
[0], 
IÁeg”
.
	`v®ueOf
(nodes[1]), "http"));

90 
»¡Cl›Á
 = 
Re¡Cl›Á
.
	`bud”
(
esH‰pHo¡s
.
	`toA¼ay
(
Ãw
 
H‰pHo¡
[esH‰pHo¡s.
	`size
()])).
	`bud
();

92 
fš®
 
Re¥Ú£
 
exi¡sRe¥Ú£
 = 
	`³rfÜmReque¡
(
»¡Cl›Á
, "HEAD", "/" + 
šdexKey
);

93 
fš®
 
boŞ—n
 
exi¡s
 = 
exi¡sRe¥Ú£
.
	`g‘StusLše
().
	`g‘StusCode
(è=ğ
H‰pStus
.
SC_OK
;

95 ià(
exi¡s
 && 
ÃwIndex
) {

96 
fš®
 
Re¥Ú£
 
d–‘eRe¥Ú£
 = 
	`³rfÜmReque¡
(
»¡Cl›Á
, "DELETE", "/" + 
šdexKey
);

97 
fš®
 
¡©usCode
 = 
d–‘eRe¥Ú£
.
	`g‘StusLše
().
	`g‘StusCode
();

98 ià(
¡©usCode
 !ğ
H‰pStus
.
SC_OK
) {

99 
throw
 
Ãw
 
	`DBExû±iÚ
("d–‘[" + 
šdexKey
 + "] faed w™h stu [" + 
¡©usCode
 + "]");

103 ià(!
exi¡s
 || 
ÃwIndex
) {

104 
	`Œy
 (
XCÚ‹ÁBud”
 
bud”
 = 
	`jsÚBud”
()) {

105 
bud”
.
	`¡¬tObjeù
();

106 
bud”
.
	`¡¬tObjeù
("settings");

107 
bud”
.
	`f›ld
("šdex.numb”_of_sh¬ds", 
numb”OfSh¬ds
);

108 
bud”
.
	`f›ld
("šdex.numb”_of_»¶iÿs", 
numb”OfR•liÿs
);

109 
bud”
.
	`’dObjeù
();

110 
bud”
.
	`’dObjeù
();

111 
fš®
 
M­
<
SŒšg
, SŒšg> 
·¿ms
 = 
	`em±yM­
();

112 
fš®
 
SŒšgEÁ™y
 
’t™y
 = 
Ãw
 
	`SŒšgEÁ™y
(
bud”
.
	`¡ršg
());

113 
fš®
 
Re¥Ú£
 
ü—‹Re¥Ú£
 = 
	`³rfÜmReque¡
(
»¡Cl›Á
, "PUT", "/" + 
šdexKey
, 
·¿ms
, 
’t™y
);

114 
fš®
 
¡©usCode
 = 
ü—‹Re¥Ú£
.
	`g‘StusLše
().
	`g‘StusCode
();

115 ià(
¡©usCode
 !ğ
H‰pStus
.
SC_OK
) {

116 
throw
 
Ãw
 
	`DBExû±iÚ
("ü—‹ [" + 
šdexKey
 + "] faed w™h stu [" + 
¡©usCode
 + "]");

118 } 
	`ÿtch
 (
fš®
 
IOExû±iÚ
 
e
) {

119 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

123 
fš®
 
M­
<
SŒšg
, SŒšg> 
·¿ms
 = 
CŞËùiÚs
.
	`sšgËtÚM­
("wait_for_status", "green");

124 
fš®
 
Re¥Ú£
 
h—ÉhRe¥Ú£
 = 
	`³rfÜmReque¡
(
»¡Cl›Á
, "GET", "/_şu¡”/h—Éh/" + 
šdexKey
, 
·¿ms
);

125 
fš®
 
h—ÉhStusCode
 = 
h—ÉhRe¥Ú£
.
	`g‘StusLše
().
	`g‘StusCode
();

126 ià(
h—ÉhStusCode
 !ğ
H‰pStus
.
SC_OK
) {

127 
throw
 
Ãw
 
	`DBExû±iÚ
("şu¡” h—Éh [" + 
šdexKey
 + "] faed w™h stu [" + 
h—ÉhStusCode
 + "]");

131 
´iv©e
 
Re¥Ú£
 
	$³rfÜmReque¡
(

132 
fš®
 
Re¡Cl›Á
 
»¡Cl›Á
,

133 
fš®
 
SŒšg
 
m‘hod
,

134 
fš®
 
SŒšg
 
’dpošt
è
throws
 
DBExû±iÚ
 {

135 
fš®
 
M­
<
SŒšg
, SŒšg> 
·¿ms
 = 
	`em±yM­
();

136  
	`³rfÜmReque¡
(
»¡Cl›Á
, 
m‘hod
, 
’dpošt
, 
·¿ms
);

137 
	}
}

139 
´iv©e
 
Re¥Ú£
 
³rfÜmReque¡
(

140 
fš®
 
Re¡Cl›Á
 
»¡Cl›Á
,

141 
fš®
 
SŒšg
 
m‘hod
,

142 
fš®
 
SŒšg
 
’dpošt
,

143 
fš®
 
M­
<
SŒšg
, SŒšg> 
·¿ms
è
throws
 
	gDBExû±iÚ
 {

144  
³rfÜmReque¡
(
»¡Cl›Á
, 
m‘hod
, 
’dpošt
, 
·¿ms
, 
nuÎ
);

147 
´iv©e
 
fš®
 
	gH—d”
[] 
	gEMPTY_HEADERS
 = 
Ãw
 
H—d”
[0];

149 
´iv©e
 
Re¥Ú£
 
³rfÜmReque¡
(

150 
fš®
 
Re¡Cl›Á
 
»¡Cl›Á
,

151 
fš®
 
SŒšg
 
m‘hod
,

152 
fš®
 
SŒšg
 
’dpošt
,

153 
fš®
 
M­
<
SŒšg
, SŒšg> 
·¿ms
,

154 
fš®
 
H‰pEÁ™y
 
’t™y
è
throws
 
	gDBExû±iÚ
 {

155 
	gŒy
 {

156 
fš®
 
	gH—d”
[] 
	gh—d”s
;

157 ià(
	g’t™y
 !ğ
nuÎ
) {

158 
h—d”s
 = 
Ãw
 
H—d”
[]{Ãw 
BasicH—d”
("cÚ‹Á-ty³", 
CÚ‹ÁTy³
.
APPLICATION_JSON
.
toSŒšg
())};

160 
	gh—d”s
 = 
EMPTY_HEADERS
;

162  
	g»¡Cl›Á
.
³rfÜmReque¡
(

163 
m‘hod
,

164 
’dpošt
,

165 
·¿ms
,

166 
’t™y
,

167 
h—d”s
);

168 } 
ÿtch
 (
fš®
 
IOExû±iÚ
 
e
) {

169 
	ge
.
´štSckT¿û
();

170 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

174 @
Ov”ride


175 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

176 ià(
»¡Cl›Á
 !ğ
nuÎ
) {

177 
Œy
 {

178 
»¡Cl›Á
.
	`şo£
();

179 
»¡Cl›Á
 = 
nuÎ
;

180 } 
	`ÿtch
 (
fš®
 
IOExû±iÚ
 
e
) {

181 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

184 
	}
}

186 
´iv©e
 vŞ©
boŞ—n
 
	gisReäeshN“ded
 = 
çl£
;

188 @
Ov”ride


189 
public
 
Stus
 
š£¹
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

190 
	gŒy
 {

191 
fš®
 
	gM­
<
	gSŒšg
, SŒšg> 
	gd©a
 = 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
);

192 
	gd©a
.
put
(
KEY
, 
key
);

194 
fš®
 
Re¥Ú£
 
	g»¥Ú£
 = 
»¡Cl›Á
.
³rfÜmReque¡
(

196 "/" + 
šdexKey
 + "/" + 
bË
 + "/",

197 
CŞËùiÚs
.<
SŒšg
, SŒšg>
em±yM­
(),

198 
Ãw
 
NSŒšgEÁ™y
Òew 
ObjeùM­³r
().
wr™eV®ueAsSŒšg
(
d©a
), 
CÚ‹ÁTy³
.
APPLICATION_JSON
));

200 ià(
	g»¥Ú£
.
g‘StusLše
().
g‘StusCode
(è!ğ
H‰pStus
.
SC_CREATED
) {

201  
Stus
.
ERROR
;

204 ià(!
	gisReäeshN“ded
) {

205 
synchrÚized
 (
this
) {

206 
	gisReäeshN“ded
 = 
Œue
;

210  
	gStus
.
	gOK
;

211 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

212 
	ge
.
´štSckT¿û
();

213  
	gStus
.
	gERROR
;

217 @
Ov”ride


218 
public
 
Stus
 
	$d–‘e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
) {

219 
Œy
 {

220 
fš®
 
Re¥Ú£
 
£¬chRe¥Ú£
 = 
	`£¬ch
(
bË
, 
key
);

221 
fš®
 
¡©usCode
 = 
£¬chRe¥Ú£
.
	`g‘StusLše
().
	`g‘StusCode
();

222 ià(
¡©usCode
 =ğ
H‰pStus
.
SC_NOT_FOUND
) {

223  
Stus
.
NOT_FOUND
;

224 } ià(
¡©usCode
 !ğ
H‰pStus
.
SC_OK
) {

225  
Stus
.
ERROR
;

228 
fš®
 
M­
<
SŒšg
, 
Objeù
> 
m­
 = 
	`m­
(
£¬chRe¥Ú£
);

229 @
	`Suµ»ssW¬nšgs
("unchecked"è
fš®
 
M­
<
SŒšg
, 
Objeù
> 
h™s
 = (M­<SŒšg, Objeù>)
m­
.
	`g‘
("hits");

230 
fš®
 
tÙ®
 = ()
h™s
.
	`g‘
("total");

231 ià(
tÙ®
 == 0) {

232  
Stus
.
NOT_FOUND
;

234 @
	`Suµ»ssW¬nšgs
("unchecked"è
fš®
 
M­
<
SŒšg
, 
Objeù
> 
h™
 =

235 (
M­
<
SŒšg
, 
Objeù
>)((
Li¡
<Objeù>)
h™s
.
	`g‘
("hits")).get(0);

236 
fš®
 
Re¥Ú£
 
d–‘eRe¥Ú£
 =

237 
»¡Cl›Á
.
	`³rfÜmReque¡
("DELETE", "/" + 
šdexKey
 + "/" + 
bË
 + "/" + 
h™
.
	`g‘
("_id"));

238 ià(
d–‘eRe¥Ú£
.
	`g‘StusLše
().
	`g‘StusCode
(è!ğ
H‰pStus
.
SC_OK
) {

239  
Stus
.
ERROR
;

242 ià(!
isReäeshN“ded
) {

243 
	`synchrÚized
 (
this
) {

244 
isReäeshN“ded
 = 
Œue
;

248  
Stus
.
OK
;

249 } 
	`ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

250 
e
.
	`´štSckT¿û
();

251  
Stus
.
ERROR
;

253 
	}
}

255 @
Ov”ride


256 
public
 
Stus
 
»ad
(

257 
fš®
 
SŒšg
 
bË
,

258 
fš®
 
SŒšg
 
key
,

259 
fš®
 
S‘
<
SŒšg
> 
f›lds
,

260 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

261 
	gŒy
 {

262 
fš®
 
Re¥Ú£
 
	g£¬chRe¥Ú£
 = 
£¬ch
(
bË
, 
key
);

263 
fš®
 
	g¡©usCode
 = 
£¬chRe¥Ú£
.
g‘StusLše
().
g‘StusCode
();

264 ià(
	g¡©usCode
 == 404) {

265  
Stus
.
NOT_FOUND
;

266 } ià(
	g¡©usCode
 !ğ
H‰pStus
.
SC_OK
) {

267  
Stus
.
ERROR
;

270 
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gm­
 = 
m­
(
£¬chRe¥Ú£
);

271 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gh™s
 = (
M­
<
SŒšg
, Objeù>)
	gm­
.
g‘
("hits");

272 
fš®
 
	gtÙ®
 = ()
h™s
.
g‘
("total");

273 ià(
	gtÙ®
 == 0) {

274  
Stus
.
NOT_FOUND
;

276 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gh™
 =

277 (
M­
<
SŒšg
, 
	gObjeù
>)((
	gLi¡
<Objeù>)
	gh™s
.
g‘
("hits")).get(0);

278 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gsourû
 = (
M­
<
SŒšg
, Objeù>)
	gh™
.
g‘
("_source");

279 ià(
	gf›lds
 !ğ
nuÎ
) {

280 
fš®
 
SŒšg
 
f›ld
 : 
f›lds
) {

281 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
sourû
.
g‘
(field)));

284 
fš®
 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gObjeù
> 
	ge
 : 
sourû
.
’ŒyS‘
()) {

285 ià(
KEY
.
equ®s
(
e
.
g‘Key
())) {

288 
	g»suÉ
.
put
(
e
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
èe.
g‘V®ue
()));

292  
	gStus
.
	gOK
;

293 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

294 
	ge
.
´štSckT¿û
();

295  
	gStus
.
	gERROR
;

299 @
Ov”ride


300 
public
 
Stus
 
upd©e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

301 
	gŒy
 {

302 
fš®
 
Re¥Ú£
 
	g£¬chRe¥Ú£
 = 
£¬ch
(
bË
, 
key
);

303 
fš®
 
	g¡©usCode
 = 
£¬chRe¥Ú£
.
g‘StusLše
().
g‘StusCode
();

304 ià(
	g¡©usCode
 == 404) {

305  
Stus
.
NOT_FOUND
;

306 } ià(
	g¡©usCode
 !ğ
H‰pStus
.
SC_OK
) {

307  
Stus
.
ERROR
;

310 
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gm­
 = 
m­
(
£¬chRe¥Ú£
);

311 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gh™s
 = (
M­
<
SŒšg
, Objeù>è
	gm­
.
g‘
("hits");

312 
fš®
 
	gtÙ®
 = (è
h™s
.
g‘
("total");

313 ià(
	gtÙ®
 == 0) {

314  
Stus
.
NOT_FOUND
;

316 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gh™
 =

317 (
M­
<
SŒšg
, 
	gObjeù
>è((
	gLi¡
<Objeù>è
	gh™s
.
g‘
("hits")).get(0);

318 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gsourû
 = (
M­
<
SŒšg
, Objeù>è
	gh™
.
g‘
("_source");

319 
fš®
 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
).
’ŒyS‘
()) {

320 
sourû
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

322 
fš®
 
	gM­
<
	gSŒšg
, SŒšg> 
	g·¿ms
 = 
em±yM­
();

323 
fš®
 
Re¥Ú£
 
	g»¥Ú£
 = 
»¡Cl›Á
.
³rfÜmReque¡
(

325 "/" + 
šdexKey
 + "/" + 
bË
 + "/" + 
h™
.
g‘
("_id"),

326 
·¿ms
,

327 
Ãw
 
NSŒšgEÁ™y
Òew 
ObjeùM­³r
().
wr™eV®ueAsSŒšg
(
sourû
), 
CÚ‹ÁTy³
.
APPLICATION_JSON
));

328 ià(
	g»¥Ú£
.
g‘StusLše
().
g‘StusCode
(è!ğ
H‰pStus
.
SC_OK
) {

329  
Stus
.
ERROR
;

332 ià(!
	gisReäeshN“ded
) {

333 
synchrÚized
 (
this
) {

334 
	gisReäeshN“ded
 = 
Œue
;

338  
	gStus
.
	gOK
;

339 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

340 
	ge
.
´štSckT¿û
();

341  
	gStus
.
	gERROR
;

345 @
Ov”ride


346 
public
 
Stus
 
sÿn
(

347 
fš®
 
SŒšg
 
bË
,

348 
fš®
 
SŒšg
 
¡¬tkey
,

349 
fš®
 
»cÜdcouÁ
,

350 
fš®
 
S‘
<
SŒšg
> 
f›lds
,

351 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

352 
	gŒy
 {

353 
fš®
 
Re¥Ú£
 
	g»¥Ú£
;

354 
Œy
 (
XCÚ‹ÁBud”
 
bud”
 = 
jsÚBud”
()) {

355 
bud”
.
¡¬tObjeù
();

356 
	gbud”
.
¡¬tObjeù
("query");

357 
	gbud”
.
¡¬tObjeù
("range");

358 
	gbud”
.
¡¬tObjeù
(
KEY
);

359 
	gbud”
.
f›ld
("g‹", 
¡¬tkey
);

360 
	gbud”
.
’dObjeù
();

361 
	gbud”
.
’dObjeù
();

362 
	gbud”
.
’dObjeù
();

363 
	gbud”
.
f›ld
("size", 
»cÜdcouÁ
);

364 
	gbud”
.
’dObjeù
();

365 
	g»¥Ú£
 = 
£¬ch
(
bË
, 
bud”
);

366 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gm­
 = 
m­
(
»¥Ú£
);

367 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gh™s
 = (
M­
<
SŒšg
, Objeù>)
	gm­
.
g‘
("hits");

368 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
	gLi¡
<
	gM­
<
	gSŒšg
, 
	gObjeù
>> 
	gli¡
 =

369 (
Li¡
<
M­
<
SŒšg
, 
	gObjeù
>>è
	gh™s
.
g‘
("hits");

371 
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gh™
 : 
li¡
) {

372 @
Suµ»ssW¬nšgs
("unchecked"è
fš®
 
M­
<
SŒšg
, 
	gObjeù
> 
	gsourû
 = (M­<SŒšg, Objeù>)
	gh™
.
g‘
("_source");

373 
fš®
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
;

374 ià(
	gf›lds
 !ğ
nuÎ
) {

375 
’Œy
 = 
Ãw
 
HashM­
<>(
f›lds
.
size
());

376 
fš®
 
SŒšg
 
	gf›ld
 : 
f›lds
) {

377 
’Œy
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
sourû
.
g‘
(field)));

380 
	g’Œy
 = 
Ãw
 
HashM­
<>(
h™
.
size
());

381 
fš®
 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gObjeù
> 
	gf›ld
 : 
sourû
.
’ŒyS‘
()) {

382 ià(
KEY
.
equ®s
(
f›ld
.
g‘Key
())) {

385 
	g’Œy
.
put
(
f›ld
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
èf›ld.
g‘V®ue
()));

388 
	g»suÉ
.
add
(
’Œy
);

391  
	gStus
.
	gOK
;

392 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

393 
	ge
.
´štSckT¿û
();

394  
	gStus
.
	gERROR
;

398 
´iv©e
 
	$»äeshIfN“ded
(è
throws
 
IOExû±iÚ
 {

399 ià(
isReäeshN“ded
) {

400 
fš®
 
boŞ—n
 
»äesh
;

401 
	`synchrÚized
 (
this
) {

402 ià(
isReäeshN“ded
) {

403 
»äesh
 = 
Œue
;

404 
isReäeshN“ded
 = 
çl£
;

406 
»äesh
 = 
çl£
;

409 ià(
»äesh
) {

410 
»¡Cl›Á
.
	`³rfÜmReque¡
("POST", "/" + 
šdexKey
 + "/_refresh");

413 
	}
}

415 
´iv©e
 
Re¥Ú£
 
	$£¬ch
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
è
throws
 
IOExû±iÚ
 {

416 
	`Œy
 (
XCÚ‹ÁBud”
 
bud”
 = 
	`jsÚBud”
()) {

417 
bud”
.
	`¡¬tObjeù
();

418 
bud”
.
	`¡¬tObjeù
("query");

419 
bud”
.
	`¡¬tObjeù
("term");

420 
bud”
.
	`f›ld
(
KEY
, 
key
);

421 
bud”
.
	`’dObjeù
();

422 
bud”
.
	`’dObjeù
();

423 
bud”
.
	`’dObjeù
();

424  
	`£¬ch
(
bË
, 
bud”
);

426 
	}
}

428 
´iv©e
 
Re¥Ú£
 
	$£¬ch
(
fš®
 
SŒšg
 
bË
, fš® 
XCÚ‹ÁBud”
 
bud”
è
throws
 
IOExû±iÚ
 {

429 
	`»äeshIfN“ded
();

430 
fš®
 
M­
<
SŒšg
, SŒšg> 
·¿ms
 = 
	`em±yM­
();

431 
fš®
 
SŒšgEÁ™y
 
’t™y
 = 
Ãw
 
	`SŒšgEÁ™y
(
bud”
.
	`¡ršg
());

432 
fš®
 
H—d”
 
h—d”
 = 
Ãw
 
	`BasicH—d”
("cÚ‹Á-ty³", 
CÚ‹ÁTy³
.
APPLICATION_JSON
.
	`toSŒšg
());

433  
»¡Cl›Á
.
	`³rfÜmReque¡
("GET", "/" + 
šdexKey
 + "/" + 
bË
 + "/_£¬ch", 
·¿ms
, 
’t™y
, 
h—d”
);

434 
	}
}

436 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	$m­
(
fš®
 
Re¥Ú£
 
»¥Ú£
è
throws
 
IOExû±iÚ
 {

437 
	`Œy
 (
IÅutSŒ—m
 
is
 = 
»¥Ú£
.
	`g‘EÁ™y
().
	`g‘CÚ‹Á
()) {

438 
fš®
 
ObjeùM­³r
 
m­³r
 = 
Ãw
 
	`ObjeùM­³r
();

439 @
	`Suµ»ssW¬nšgs
("unchecked"è
fš®
 
M­
<
SŒšg
, 
Objeù
> 
m­
 = 
m­³r
.
	`»adV®ue
(
is
, M­.
şass
);

440  
m­
;

442 
	}
}

	@elasticsearch5/src/main/java/site/ycsb/db/elasticsearch5/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
;

	@elasticsearch5/src/test/java/site/ycsb/db/elasticsearch5/ElasticsearchClientIT.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
public
 cÏs 
	cEÏ¡ic£¬chCl›ÁIT
 
ex‹nds
 
	mEÏ¡ic£¬chIÁegTe¡Ba£
 {

24 @
Ov”ride


25 
DB
 
	$ÃwDB
() {

26  
Ãw
 
	`EÏ¡ic£¬chCl›Á
();

29 
	}
}

	@elasticsearch5/src/test/java/site/ycsb/db/elasticsearch5/ElasticsearchIntegTestBase.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

26 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

27 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

28 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

30 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

32 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

33 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

35 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

37 
public
 
ab¡¿ù
 cÏs 
	cEÏ¡ic£¬chIÁegTe¡Ba£
 {

39 
´iv©e
 
DB
 
	mdb
;

41 
ab¡¿ù
 
DB
 
ÃwDB
();

43 
´iv©e
 
fš®
 
	mHashM­
<
	mSŒšg
, 
	mBy‹I‹¿tÜ
> 
	mMOCK_DATA
;

44 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_TABLE
 = "MOCK_TABLE";

45 
´iv©e
 
fš®
 
SŒšg
 
	mFIELD_PREFIX
 = 
CÜeWÜklßd
.
FIELD_NAME_PREFIX_DEFAULT
;

48 
	mMOCK_DATA
 = 
Ãw
 
HashM­
<>(10);

49 
	mi
 = 1; i <= 10; i++) {

50 
	mMOCK_DATA
.
put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
("value" + i));

54 @
BefÜe


55 
public
 
	$£tUp
(è
throws
 
DBExû±iÚ
 {

56 
fš®
 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

57 
´İs
.
	`put
("es.new_index", "true");

58 
´İs
.
	`put
("es.setting.cluster.name", "test");

59 
db
 = 
	`ÃwDB
();

60 
db
.
	`£tPrİ”t›s
(
´İs
);

61 
db
.
	`š™
();

62 
i
 = 0; i < 16; i++) {

63 
db
.
	`š£¹
(
MOCK_TABLE
, 
IÁeg”
.
	`toSŒšg
(
i
), 
MOCK_DATA
);

65 
	}
}

67 @
Aá”


68 
public
 
	$‹¬Down
(è
throws
 
DBExû±iÚ
 {

69 
db
.
	`ş—nup
();

70 
	}
}

72 @
Te¡


73 
public
 
	$‹¡In£¹
() {

74 
fš®
 
Stus
 
»suÉ
 = 
db
.
	`š£¹
(
MOCK_TABLE
, "0", 
MOCK_DATA
);

75 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

76 
	}
}

81 @
Te¡


82 
public
 
	$‹¡D–‘e
() {

83 
fš®
 
Stus
 
»suÉ
 = 
db
.
	`d–‘e
(
MOCK_TABLE
, "1");

84 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

85 
	}
}

90 @
Te¡


91 
public
 
	$‹¡R—d
() {

92 
fš®
 
S‘
<
SŒšg
> 
f›lds
 = 
MOCK_DATA
.
	`keyS‘
();

93 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉP¬am
 = 
Ãw
 HashMap<>(10);

94 
fš®
 
Stus
 
»suÉ
 = 
db
.
	`»ad
(
MOCK_TABLE
, "1", 
f›lds
, 
»suÉP¬am
);

95 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

96 
	}
}

101 @
Te¡


102 
public
 
	$‹¡Upd©e
() {

103 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ÃwV®ues
 = 
Ãw
 HashMap<>(10);

105 
i
 = 1; i <= 10; i++) {

106 
ÃwV®ues
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
("newvalue" + i));

109 
fš®
 
Stus
 
upd©eResuÉ
 = 
db
.
	`upd©e
(
MOCK_TABLE
, "1", 
ÃwV®ues
);

110 
	`as£¹Equ®s
(
Stus
.
OK
, 
upd©eResuÉ
);

113 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉP¬am
 = 
Ãw
 HashMap<>(10);

114 
fš®
 
Stus
 
»adResuÉ
 = 
db
.
	`»ad
(
MOCK_TABLE
, "1", 
MOCK_DATA
.
	`keyS‘
(), 
»suÉP¬am
);

115 
	`as£¹Equ®s
(
Stus
.
OK
, 
»adResuÉ
);

117 
i
 = 1; i <= 10; i++) {

118 
	`as£¹Equ®s
("Ãwv®ue" + 
i
, 
»suÉP¬am
.
	`g‘
(
FIELD_PREFIX
 + i).
	`toSŒšg
());

121 
	}
}

126 @
Te¡


127 
public
 
	$‹¡Sÿn
() {

128 
fš®
 
»cÜdcouÁ
 = 10;

129 
fš®
 
S‘
<
SŒšg
> 
f›lds
 = 
MOCK_DATA
.
	`keyS‘
();

130 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉP¬am
 = 
Ãw
 Vector<>(10);

131 
fš®
 
Stus
 
»suÉ
 = 
db
.
	`sÿn
(
MOCK_TABLE
, "1", 
»cÜdcouÁ
, 
f›lds
, 
»suÉP¬am
);

132 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

134 
	`as£¹Equ®s
(10, 
»suÉP¬am
.
	`size
());

135 
	}
}

	@elasticsearch5/src/test/java/site/ycsb/db/elasticsearch5/ElasticsearchRestClientIT.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g–a¡ic£¬ch5
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
public
 cÏs 
	cEÏ¡ic£¬chRe¡Cl›ÁIT
 
ex‹nds
 
	mEÏ¡ic£¬chIÁegTe¡Ba£
 {

24 @
Ov”ride


25 
DB
 
	$ÃwDB
() {

26  
Ãw
 
	`EÏ¡ic£¬chRe¡Cl›Á
();

29 
	}
}

	@foundationdb/src/main/java/site/ycsb/db/foundationdb/FoundationDBClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gfound©iÚdb
;

20 
impÜt
 
	gcom
.
	g­¶e
.
	gfound©iÚdb
.*;

21 
impÜt
 
	gcom
.
	g­¶e
.
	gfound©iÚdb
.
	gasync
.
	gAsyncI‹¿bË
;

22 
impÜt
 
	gcom
.
	g­¶e
.
	gfound©iÚdb
.
	gtu¶e
.
	gTu¶e
;

24 
impÜt
 
	gs™e
.
	gycsb
.*;

25 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

26 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

27 
impÜt
 
	gÜg
.
	g¦f4j
.
	gh–³rs
.
	gMes§geFÜm©‹r
;

29 
impÜt
 
	gjava
.
	gut
.*;

35 
public
 cÏs 
	cFound©iÚDBCl›Á
 
ex‹nds
 
	mDB
 {

36 
´iv©e
 
FDB
 
	mfdb
;

37 
´iv©e
 
D©aba£
 
	mdb
;

38 
´iv©e
 
SŒšg
 
	mdbName
;

39 
´iv©e
 
	mb©chSize
;

40 
´iv©e
 
	mb©chCouÁ
;

41 
´iv©e
 
fš®
 
SŒšg
 
	mAPI_VERSION
 = "foundationdb.apiversion";

42 
´iv©e
 
fš®
 
SŒšg
 
	mAPI_VERSION_DEFAULT
 = "520";

43 
´iv©e
 
fš®
 
SŒšg
 
	mCLUSTER_FILE
 = "foundationdb.clusterfile";

44 
´iv©e
 
fš®
 
SŒšg
 
	mCLUSTER_FILE_DEFAULT
 = "./fdb.cluster";

45 
´iv©e
 
fš®
 
SŒšg
 
	mDB_NAME
 = "foundationdb.dbname";

46 
´iv©e
 
fš®
 
SŒšg
 
	mDB_NAME_DEFAULT
 = "DB";

47 
´iv©e
 
fš®
 
SŒšg
 
	mDB_BATCH_SIZE_DEFAULT
 = "0";

48 
´iv©e
 
fš®
 
SŒšg
 
	mDB_BATCH_SIZE
 = "foundationdb.batchsize";

50 
´iv©e
 
	mVeùÜ
<
	mSŒšg
> 
	mb©chKeys
;

51 
´iv©e
 
	mVeùÜ
<
	mM­
<
	mSŒšg
, 
	mBy‹I‹¿tÜ
>> 
	mb©chV®ues
;

53 
´iv©e
 
Logg”
 
	mlogg”
 = 
Logg”FaùÜy
.
g‘Logg”
(
Found©iÚDBCl›Á
.
şass
);

58 @
Ov”ride


59 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

61 
fš®
 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

62 
SŒšg
 
­iV”siÚ
 = 
´İs
.
	`g‘Prİ”ty
(
API_VERSION
, 
API_VERSION_DEFAULT
);

63 
SŒšg
 
şu¡”Fe
 = 
´İs
.
	`g‘Prİ”ty
(
CLUSTER_FILE
, 
CLUSTER_FILE_DEFAULT
);

64 
SŒšg
 
dbB©chSize
 = 
´İs
.
	`g‘Prİ”ty
(
DB_BATCH_SIZE
, 
DB_BATCH_SIZE_DEFAULT
);

65 
dbName
 = 
´İs
.
	`g‘Prİ”ty
(
DB_NAME
, 
DB_NAME_DEFAULT
);

67 
logg”
.
	`šfo
("API V”siÚ: {}", 
­iV”siÚ
);

68 
logg”
.
	`šfo
("Clu¡” Fe: {}\n", 
şu¡”Fe
);

70 
Œy
 {

71 
fdb
 = 
FDB
.
	`£ËùAPIV”siÚ
(
IÁeg”
.
	`·r£IÁ
(
­iV”siÚ
.
	`Œim
()));

72 
db
 = 
fdb
.
	`İ’
(
şu¡”Fe
);

73 
b©chSize
 = 
IÁeg”
.
	`·r£IÁ
(
dbB©chSize
);

74 
b©chCouÁ
 = 0;

75 
b©chKeys
 = 
Ãw
 
VeùÜ
<
SŒšg
>(
b©chSize
+1);

76 
b©chV®ues
 = 
Ãw
 
VeùÜ
<
M­
<
SŒšg
, 
By‹I‹¿tÜ
>>(
b©chSize
+1);

77 } 
	`ÿtch
 (
FDBExû±iÚ
 
e
) {

78 
logg”
.
	`”rÜ
(
Mes§geFÜm©‹r
.
	`fÜm©
("E¼Ü iÀd©aba£ o³¿tiÚ: {}", "š™").
	`g‘Mes§ge
(), 
e
);

79 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

80 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
e
) {

81 
logg”
.
	`”rÜ
(
Mes§geFÜm©‹r
.
	`fÜm©
("Inv®id v®ufÜ‡piv”siÚ…rİ”ty: {}", 
­iV”siÚ
).
	`g‘Mes§ge
(), 
e
);

82 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

86 @
Ov”ride


87 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

88 ià(
b©chCouÁ
 > 0) {

89 
	`b©chIn£¹
();

90 
b©chCouÁ
 = 0;

92 
Œy
 {

93 
db
.
	`şo£
();

94 } 
	`ÿtch
 (
FDBExû±iÚ
 
e
) {

95 
logg”
.
	`”rÜ
(
Mes§geFÜm©‹r
.
	`fÜm©
("E¼Ü iÀd©aba£ o³¿tiÚ: {}", "ş—nup").
	`g‘Mes§ge
(), 
e
);

96 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

98 
	}
}

100 
´iv©e
 
SŒšg
 
	$g‘RowKey
(
SŒšg
 
db
, SŒšg 
bË
, SŒšg 
key
) {

102  
db
 + ":" + 
bË
 + ":" + 
key
;

103 
	}
}

105 
´iv©e
 
SŒšg
 
	$g‘EndRowKey
(
SŒšg
 
bË
) {

106  
bË
 + ";";

107 
	}
}

109 
´iv©e
 
Stus
 
cÚvTu¶eToM­
(
Tu¶e
 
tu¶e
, 
S‘
<
SŒšg
> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

110 
	gi
 = 0; i < 
	gtu¶e
.
size
(); i++) {

111 
Tu¶e
 
	gv
 = 
tu¶e
.
g‘Ne¡edTu¶e
(
i
);

112 
SŒšg
 
	gf›ld
 = 
v
.
g‘SŒšg
(0);

113 
SŒšg
 
	gv®ue
 = 
v
.
g‘SŒšg
(1);

115 
	g»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
));

117 ià(
	gf›lds
 !ğ
nuÎ
) {

118 
SŒšg
 
f›ld
 : 
f›lds
) {

119 ià(
»suÉ
.
g‘
(
f›ld
è=ğ
nuÎ
) {

120 
logg”
.
debug
("f›ld‚Ù fouÁ: {}", 
f›ld
);

121  
	gStus
.
	gNOT_FOUND
;

125  
	gStus
.
	gOK
;

128 
´iv©e
 
	$b©chIn£¹
() {

129 
Œy
 {

130 
db
.
	`run
(
Œ
 -> {

131 
i
 = 0; i < 
b©chCouÁ
; ++i) {

132 
Tu¶e
 
t
 = 
Ãw
 
	`Tu¶e
();

133 
M­
.
EÁry
<
SŒšg
, SŒšg> 
’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
	`g‘SŒšgM­
(
b©chV®ues
.
	`g‘
(
i
)).
	`’ŒyS‘
()) {

134 
Tu¶e
 
v
 = 
Ãw
 
	`Tu¶e
();

135 
v
 = v.
	`add
(
’Œy
.
	`g‘Key
());

136 
v
 = v.
	`add
(
’Œy
.
	`g‘V®ue
());

137 
t
 =.
	`add
(
v
);

139 
Œ
.
	`£t
(
Tu¶e
.
	`äom
(
b©chKeys
.
	`g‘
(
i
)).
	`·ck
(), 
t
.pack());

141  
nuÎ
;

143 } 
	`ÿtch
 (
FDBExû±iÚ
 
e
) {

144 
i
 = 0; i < 
b©chCouÁ
; ++i) {

145 
logg”
.
	`”rÜ
(
Mes§geFÜm©‹r
.
	`fÜm©
("E¼Ü b©ch in£¹šg key {}", 
b©chKeys
.
	`g‘
(
i
)).
	`g‘Mes§ge
(), 
e
);

147 
e
.
	`´štSckT¿û
();

148 } 
	`ÿtch
 (
ThrowabË
 
e
) {

149 
i
 = 0; i < 
b©chCouÁ
; ++i) {

150 
logg”
.
	`”rÜ
(
Mes§geFÜm©‹r
.
	`fÜm©
("E¼Ü b©ch in£¹šg key {}", 
b©chKeys
.
	`g‘
(
i
)).
	`g‘Mes§ge
(), 
e
);

152 
e
.
	`´štSckT¿û
();

153 } 
fš®ly
 {

154 
b©chKeys
.
	`ş—r
();

155 
b©chV®ues
.
	`ş—r
();

157 
	}
}

159 @
Ov”ride


160 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

161 
SŒšg
 
	growKey
 = 
g‘RowKey
(
dbName
, 
bË
, 
key
);

162 
	glogg”
.
debug
("š£¹ key = {}", 
rowKey
);

163 
	gŒy
 {

164 
	gb©chKeys
.
addEËm’t
(
rowKey
);

165 
	gb©chV®ues
.
addEËm’t
(
Ãw
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>(
v®ues
));

166 
	gb©chCouÁ
++;

167 ià(
	gb©chSize
 =ğ0 || 
b©chSize
 =ğ
b©chCouÁ
) {

168 
b©chIn£¹
();

169 
	gb©chCouÁ
 = 0;

171  
	gStus
.
	gOK
;

172 } 
ÿtch
 (
ThrowabË
 
e
) {

173 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü in£¹šg key: {}", 
rowKey
).
g‘Mes§ge
(), 
e
);

174 
	ge
.
´štSckT¿û
();

176  
	gStus
.
	gERROR
;

179 @
Ov”ride


180 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

181 
SŒšg
 
rowKey
 = 
	`g‘RowKey
(
dbName
, 
bË
, 
key
);

182 
logg”
.
	`debug
("d–‘key = {}", 
rowKey
);

183 
Œy
 {

184 
db
.
	`run
(
Œ
 -> {

185 
Œ
.
	`ş—r
(
Tu¶e
.
	`äom
(
rowKey
).
	`·ck
());

186  
nuÎ
;

188  
Stus
.
OK
;

189 } 
	`ÿtch
 (
FDBExû±iÚ
 
e
) {

190 
logg”
.
	`”rÜ
(
Mes§geFÜm©‹r
.
	`fÜm©
("E¼Ü d–‘šg key: {}", 
rowKey
).
	`g‘Mes§ge
(), 
e
);

191 
e
.
	`´štSckT¿û
();

192 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

193 
logg”
.
	`”rÜ
(
Mes§geFÜm©‹r
.
	`fÜm©
("E¼Ü d–‘šg key: {}", 
rowKey
).
	`g‘Mes§ge
(), 
e
);

194 
e
.
	`´štSckT¿û
();

196  
Stus
.
ERROR
;

197 
	}
}

199 @
Ov”ride


200 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

201 
SŒšg
 
	growKey
 = 
g‘RowKey
(
dbName
, 
bË
, 
key
);

202 
	glogg”
.
debug
("»ad key = {}", 
rowKey
);

203 
	gŒy
 {

204 
	gby‹
[] 
	grow
 = 
db
.
run
(
Œ
 -> {

205 
by‹
[] 
r
 = 
Œ
.
g‘
(
Tu¶e
.
äom
(
rowKey
).
·ck
()).
još
();

206  
r
;

208 
Tu¶e
 
	gt
 = Tu¶e.
äomBy‹s
(
row
);

209 ià(
	gt
.
size
() == 0) {

210 
logg”
.
debug
("key‚Ù fouÁ: {}", 
rowKey
);

211  
	gStus
.
	gNOT_FOUND
;

213  
cÚvTu¶eToM­
(
t
, 
f›lds
, 
»suÉ
);

214 } 
ÿtch
 (
FDBExû±iÚ
 
e
) {

215 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü„—dšg key: {}", 
rowKey
).
g‘Mes§ge
(), 
e
);

216 
	ge
.
´štSckT¿û
();

217 } 
ÿtch
 (
Exû±iÚ
 
e
) {

218 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü„—dšg key: {}", 
rowKey
).
g‘Mes§ge
(), 
e
);

219 
	ge
.
´štSckT¿û
();

221  
	gStus
.
	gERROR
;

224 @
Ov”ride


225 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

226 
SŒšg
 
	growKey
 = 
g‘RowKey
(
dbName
, 
bË
, 
key
);

227 
	glogg”
.
debug
("upd©key = {}", 
rowKey
);

228 
	gŒy
 {

229 
Stus
 
	gs
 = 
db
.
run
(
Œ
 -> {

230 
by‹
[] 
row
 = 
Œ
.
g‘
(
Tu¶e
.
äom
(
rowKey
).
·ck
()).
još
();

231 
Tu¶e
 
o
 = Tu¶e.
äomBy‹s
(
row
);

232 ià(
o
.
size
() == 0) {

233 
logg”
.
debug
("key‚Ù fouÁ: {}", 
rowKey
);

234  
Stus
.
NOT_FOUND
;

236 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

237 ià(
cÚvTu¶eToM­
(
o
, 
nuÎ
, 
»suÉ
è!ğ
Stus
.
OK
) {

238  
Stus
.
ERROR
;

240 
SŒšg
 
k
 : 
v®ues
.
keyS‘
()) {

241 ià(
»suÉ
.
cÚšsKey
(
k
)) {

242 
»suÉ
.
put
(
k
, 
v®ues
.
g‘
(k));

244 
logg”
.
debug
("f›ld‚Ù fouÁ: {}", 
k
);

245  
Stus
.
NOT_FOUND
;

248 
Tu¶e
 
t
 = 
Ãw
 Tuple();

249 
M­
.
EÁry
<
SŒšg
, SŒšg> 
’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
»suÉ
).
’ŒyS‘
()) {

250 
Tu¶e
 
v
 = 
Ãw
 Tuple();

251 
v
 = v.
add
(
’Œy
.
g‘Key
());

252 
v
 = v.
add
(
’Œy
.
g‘V®ue
());

253 
t
 =.
add
(
v
);

255 
Œ
.
£t
(
Tu¶e
.
äom
(
rowKey
).
·ck
(), 
t
.pack());

256  
Stus
.
OK
;

258  
	gs
;

259 } 
ÿtch
 (
FDBExû±iÚ
 
e
) {

260 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü upd©šg key: {}", 
rowKey
).
g‘Mes§ge
(), 
e
);

261 
	ge
.
´štSckT¿û
();

262 } 
ÿtch
 (
Exû±iÚ
 
e
) {

263 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü upd©šg key: {}", 
rowKey
).
g‘Mes§ge
(), 
e
);

264 
	ge
.
´štSckT¿û
();

266  
	gStus
.
	gERROR
;

269 @
Ov”ride


270 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

271 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

272 
SŒšg
 
	g¡¬tRowKey
 = 
g‘RowKey
(
dbName
, 
bË
, 
¡¬tkey
);

273 
SŒšg
 
	g’dRowKey
 = 
g‘EndRowKey
(
bË
);

274 
	glogg”
.
debug
("sÿÀkey from {}Ø{}†im™ {} ", 
¡¬tkey
, 
’dRowKey
, 
»cÜdcouÁ
);

275 
Œy
 (
T¿n§ùiÚ
 
Œ
 = 
db
.
ü—‹T¿n§ùiÚ
()) {

276 
Œ
.
İtiÚs
().
£tR—dYourWr™esDi§bË
();

277 
	gAsyncI‹¿bË
<
	gKeyV®ue
> 
	g’ŒyLi¡
 = 
Œ
.
g‘Rªge
(
Tu¶e
.
äom
(
¡¬tRowKey
).
·ck
(), Tu¶e.äom(
’dRowKey
).pack(),

278 
»cÜdcouÁ
 > 0 ?„ecordcount : 0);

279 
	gLi¡
<
	gKeyV®ue
> 
	g’Œ›s
 = 
’ŒyLi¡
.
asLi¡
().
još
();

280 
	gi
 = 0; i < 
	g’Œ›s
.
size
(); ++i) {

281 
fš®
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gm­
 = 
Ãw
 
HashM­
<>();

282 
Tu¶e
 
	gv®ue
 = Tu¶e.
äomBy‹s
(
’Œ›s
.
g‘
(
i
).
g‘V®ue
());

283 ià(
cÚvTu¶eToM­
(
v®ue
, 
f›lds
, 
m­
è=ğ
Stus
.
OK
) {

284 
»suÉ
.
add
(
m­
);

286 
	glogg”
.
”rÜ
("E¼Ü sÿÂšg keys: from {}Ø{}†im™ {} ", 
¡¬tRowKey
, 
’dRowKey
, 
»cÜdcouÁ
);

287  
	gStus
.
	gERROR
;

290  
	gStus
.
	gOK
;

291 } 
ÿtch
 (
FDBExû±iÚ
 
e
) {

292 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("Error scanning keys: from {}o {} ",

293 
¡¬tRowKey
, 
’dRowKey
).
g‘Mes§ge
(), 
e
);

294 
	ge
.
´štSckT¿û
();

295 } 
ÿtch
 (
Exû±iÚ
 
e
) {

296 
	glogg”
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("Error scanning keys: from {}o {} ",

297 
¡¬tRowKey
, 
’dRowKey
).
g‘Mes§ge
(), 
e
);

298 
	ge
.
´štSckT¿û
();

300  
	gStus
.
	gERROR
;

	@foundationdb/src/main/java/site/ycsb/db/foundationdb/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gfound©iÚdb
;

	@geode/src/main/java/site/ycsb/db/GeodeClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtSock‘Add»ss
;

21 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

24 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

25 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

26 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gM©ch”
;

27 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gP©‹º
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

32 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gCache
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gCacheFaùÜy
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gGemFœeCache
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gRegiÚ
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gRegiÚExi¡sExû±iÚ
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gRegiÚFaùÜy
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gRegiÚShÜtcut
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gş›Á
.
	gCl›ÁCache
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gş›Á
.
	gCl›ÁCacheFaùÜy
;

44 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gş›Á
.
	gCl›ÁRegiÚFaùÜy
;

45 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gÿche
.
	gş›Á
.
	gCl›ÁRegiÚShÜtcut
;

46 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gpdx
.
	gJSONFÜm©‹r
;

47 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gpdx
.
	gPdxIn¡ªû
;

48 
impÜt
 
	gÜg
.
	g­ache
.
	ggeode
.
	gpdx
.
	gPdxIn¡ªûFaùÜy
;

70 
public
 cÏs 
	cGeodeCl›Á
 
ex‹nds
 
	mDB
 {

74 
´iv©e
 
fš®
 
SŒšg
 
	mSERVERPORT_PROPERTY_NAME
 = "geode.serverport";

79 
´iv©e
 
fš®
 
SŒšg
 
	mSERVERHOST_PROPERTY_NAME
 = "geode.serverhost";

84 
´iv©e
 
fš®
 
SŒšg
 
	mSERVERHOST_PROPERTY_DEFAULT
 = "localhost";

90 
´iv©e
 
fš®
 
SŒšg
 
	mLOCATOR_PROPERTY_NAME
 = "geode.locator";

95 
´iv©e
 
fš®
 
SŒšg
 
	mTOPOLOGY_PROPERTY_NAME
 = "geode.topology";

101 
´iv©e
 
fš®
 
SŒšg
 
	mTOPOLOGY_P2P_VALUE
 = "p2p";

106 
´iv©e
 
fš®
 
P©‹º
 
	mLOCATOR_PATTERN
 = P©‹º.
compe
("(.+)\\[(\\d+)\\]");;

108 
´iv©e
 
GemFœeCache
 
	mÿche
;

113 
´iv©e
 
boŞ—n
 
	misCl›Á
;

115 @
Ov”ride


116 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

117 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

119 
SŒšg
 
£rv”Ho¡
 = 
nuÎ
;

121 
£rv”PÜt
 = 0;

122 
SŒšg
 
loÿtÜSŒ
 = 
nuÎ
;

124 ià(
´İs
 !ğ
nuÎ
 && !´İs.
	`isEm±y
()) {

125 
SŒšg
 
£rv”PÜtSŒ
 = 
´İs
.
	`g‘Prİ”ty
(
SERVERPORT_PROPERTY_NAME
);

126 ià(
£rv”PÜtSŒ
 !ğ
nuÎ
) {

127 
£rv”PÜt
 = 
IÁeg”
.
	`·r£IÁ
(
£rv”PÜtSŒ
);

129 
£rv”Ho¡
 = 
´İs
.
	`g‘Prİ”ty
(
SERVERHOST_PROPERTY_NAME
, 
SERVERHOST_PROPERTY_DEFAULT
);

130 
loÿtÜSŒ
 = 
´İs
.
	`g‘Prİ”ty
(
LOCATOR_PROPERTY_NAME
);

132 
SŒšg
 
tİŞogy
 = 
´İs
.
	`g‘Prİ”ty
(
TOPOLOGY_PROPERTY_NAME
);

133 ià(
tİŞogy
 !ğ
nuÎ
 &&İŞogy.
	`equ®s
(
TOPOLOGY_P2P_VALUE
)) {

134 
CacheFaùÜy
 
cf
 = 
Ãw
 
	`CacheFaùÜy
();

135 ià(
loÿtÜSŒ
 !ğ
nuÎ
) {

136 
cf
.
	`£t
("loÿtÜs", 
loÿtÜSŒ
);

138 
ÿche
 = 
cf
.
	`ü—‹
();

139 
isCl›Á
 = 
çl£
;

143 
isCl›Á
 = 
Œue
;

145 
Cl›ÁCacheFaùÜy
 
ccf
 = 
Ãw
 
	`Cl›ÁCacheFaùÜy
();

146 
ccf
.
	`£tPdxR—dS”Ÿlized
(
Œue
);

147 ià(
£rv”PÜt
 != 0) {

148 
ccf
.
	`addPoŞS”v”
(
£rv”Ho¡
, 
£rv”PÜt
);

150 
IÃtSock‘Add»ss
 
loÿtÜAdd»ss
 = 
	`g‘LoÿtÜAdd»ss
(
loÿtÜSŒ
);

151 
ccf
.
	`addPoŞLoÿtÜ
(
loÿtÜAdd»ss
.
	`g‘Ho¡Name
(),†oÿtÜAdd»ss.
	`g‘PÜt
());

153 
ÿche
 = 
ccf
.
	`ü—‹
();

156 
IÃtSock‘Add»ss
 
	$g‘LoÿtÜAdd»ss
(
SŒšg
 
loÿtÜSŒ
) {

157 
M©ch”
 
m©ch”
 = 
LOCATOR_PATTERN
.
	`m©ch”
(
loÿtÜSŒ
);

158 if(!
m©ch”
.
	`m©ches
()) {

159 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("UÇbËØ·r£†oÿtÜ: " + 
loÿtÜSŒ
);

161  
Ãw
 
	`IÃtSock‘Add»ss
(
m©ch”
.
	`group
(1), 
IÁeg”
.
	`·r£IÁ
(matcher.group(2)));

162 
	}
}

164 @
Ov”ride


165 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

166 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

167 
	gRegiÚ
<
	gSŒšg
, 
	gPdxIn¡ªû
> 
	gr
 = 
g‘RegiÚ
(
bË
);

168 
PdxIn¡ªû
 
	gv®
 = 
r
.
g‘
(
key
);

169 ià(
	gv®
 !ğ
nuÎ
) {

170 ià(
f›lds
 =ğ
nuÎ
) {

171 
SŒšg
 
f›ldName
 : 
v®
.
g‘F›ldNames
()) {

172 
»suÉ
.
put
(
f›ldName
, 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
((
by‹
[]è
v®
.
g‘F›ld
(fieldName)));

175 
SŒšg
 
	gf›ld
 : 
f›lds
) {

176 
»suÉ
.
put
(
f›ld
, 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
((
by‹
[]è
v®
.
g‘F›ld
(field)));

179  
	gStus
.
	gOK
;

181  
	gStus
.
	gERROR
;

184 @
Ov”ride


185 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

186 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

188  
	gStus
.
	gERROR
;

191 @
Ov”ride


192 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

193 
g‘RegiÚ
(
bË
).
put
(
key
, 
cÚv”tToBy‹¬¿yM­
(
v®ues
));

194  
	gStus
.
	gOK
;

197 @
Ov”ride


198 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

199 
g‘RegiÚ
(
bË
).
put
(
key
, 
cÚv”tToBy‹¬¿yM­
(
v®ues
));

200  
	gStus
.
	gOK
;

203 @
Ov”ride


204 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

205 
	`g‘RegiÚ
(
bË
).
	`de¡roy
(
key
);

206  
Stus
.
OK
;

207 
	}
}

209 
´iv©e
 
PdxIn¡ªû
 
cÚv”tToBy‹¬¿yM­
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

210 
PdxIn¡ªûFaùÜy
 
	gpdxIn¡ªûFaùÜy
 = 
ÿche
.
ü—‹PdxIn¡ªûFaùÜy
(
JSONFÜm©‹r
.
JSON_CLASSNAME
);

212 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

213 
pdxIn¡ªûFaùÜy
.
wr™eBy‹A¼ay
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toA¼ay
());

215  
	gpdxIn¡ªûFaùÜy
.
ü—‹
();

218 
´iv©e
 
	gRegiÚ
<
	gSŒšg
, 
	gPdxIn¡ªû
> 
	$g‘RegiÚ
(
SŒšg
 
bË
) {

219 
RegiÚ
<
SŒšg
, 
PdxIn¡ªû
> 
r
 = 
ÿche
.
	`g‘RegiÚ
(
bË
);

220 ià(
r
 =ğ
nuÎ
) {

221 
Œy
 {

222 ià(
isCl›Á
) {

223 
Cl›ÁRegiÚFaùÜy
<
SŒšg
, 
PdxIn¡ªû
> 
üf
 =

224 ((
Cl›ÁCache
è
ÿche
).
	`ü—‹Cl›ÁRegiÚFaùÜy
(
Cl›ÁRegiÚShÜtcut
.
PROXY
);

225 
r
 = 
üf
.
	`ü—‹
(
bË
);

227 
RegiÚFaùÜy
<
SŒšg
, 
PdxIn¡ªû
> 
rf
 = ((
Cache
è
ÿche
).
	`ü—‹RegiÚFaùÜy
(
RegiÚShÜtcut
.
PARTITION
);

228 
r
 = 
rf
.
	`ü—‹
(
bË
);

230 } 
	`ÿtch
 (
RegiÚExi¡sExû±iÚ
 
e
) {

232 
r
 = 
ÿche
.
	`g‘RegiÚ
(
bË
);

235  
r
;

236 
	}
}

	@geode/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@googlebigtable/src/main/java/site/ycsb/db/GoogleBigtableClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

20 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gCh¬£t
;

21 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

22 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

25 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

27 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gHBa£CÚfigu¿tiÚ
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gut
.
	gBy‹s
;

33 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

34 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

35 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

37 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gCŞumn
;

38 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gFamy
;

39 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gMu‹RowReque¡
;

40 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gMutiÚ
;

41 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gR—dRowsReque¡
;

42 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gRow
;

43 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gRowF‹r
;

44 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gRowRªge
;

45 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gRowS‘
;

46 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gMutiÚ
.
	gD–‘eFromRow
;

47 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gMutiÚ
.
	gS‘C–l
;

48 
impÜt
 
	gcom
.
	ggoogË
.
	gbigbË
.
	gv2
.
	gRowF‹r
.
	gChaš
.
	gBud”
;

49 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	gbigbË
.
	gcÚfig
.
	gBigbËO±iÚs
;

50 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	gbigbË
.
	gg½c
.
	gBigbËD©aCl›Á
;

51 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	gbigbË
.
	gg½c
.
	gBigbËSessiÚ
;

52 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	gbigbË
.
	gg½c
.
	gBigbËTabËName
;

53 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	gbigbË
.
	gg½c
.
	gasync
.
	gBulkMutiÚ
;

54 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	gbigbË
.
	ghba£
.
	gBigbËO±iÚsFaùÜy
;

55 
impÜt
 
	gcom
.
	ggoogË
.
	gşoud
.
	gbigbË
.
	gut
.
	gBy‹SŒšg”
;

56 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
;

57 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

58 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

59 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

60 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

70 
public
 
şass
 
GoogËBigbËCl›Á
 
ex‹nds
 
	gs™e
.
	gycsb
.
	gDB
 {

71 
public
 
fš®
 
Ch¬£t
 
	gUTF8_CHARSET
 = Ch¬£t.
fÜName
("UTF8");

74 
´iv©e
 
fš®
 
SŒšg
 
	gASYNC_MUTATOR_MAX_MEMORY
 = "mutatorMaxMemory";

75 
´iv©e
 
fš®
 
SŒšg
 
	gASYNC_MAX_INFLIGHT_RPCS
 = "mutatorMaxInflightRPCs";

76 
´iv©e
 
fš®
 
SŒšg
 
	gCLIENT_SIDE_BUFFERING
 = "clientbuffering";

79 
´iv©e
 
	gth»adCouÁ
 = 0;

82 
´iv©e
 
fš®
 
CÚfigu¿tiÚ
 
	gCONFIG
 = 
HBa£CÚfigu¿tiÚ
.
ü—‹
();

85 
´iv©e
 
boŞ—n
 
	gdebug
 = 
çl£
;

88 
´iv©e
 
BigbËO±iÚs
 
	gİtiÚs
;

89 
´iv©e
 
BigbËSessiÚ
 
	g£ssiÚ
;

92 
´iv©e
 
BigbËD©aCl›Á
 
	gş›Á
;

95 
´iv©e
 
	gby‹
[] 
	gcŞumnFamyBy‹s
;

98 
´iv©e
 
SŒšg
 
	gÏ¡TabË
 = "";

99 
´iv©e
 
	gby‹
[] 
	gÏ¡TabËBy‹s
;

105 
´iv©e
 
boŞ—n
 
	gş›ÁSideBufãršg
 = 
çl£
;

107 
´iv©e
 
BulkMutiÚ
 
	gbulkMutiÚ
;

109 @
Ov”ride


110 
public
 
š™
(è
throws
 
	gDBExû±iÚ
 {

111 
Prİ”t›s
 
	g´İs
 = 
g‘Prİ”t›s
();

114 ià(
g‘Prİ”t›s
().
cÚšsKey
(
ASYNC_MUTATOR_MAX_MEMORY
)) {

115 
	gCONFIG
.
£t
(
BigbËO±iÚsFaùÜy
.
BIGTABLE_BUFFERED_MUTATOR_MAX_MEMORY_KEY
,

116 
g‘Prİ”t›s
().
g‘Prİ”ty
(
ASYNC_MUTATOR_MAX_MEMORY
));

118 ià(
g‘Prİ”t›s
().
cÚšsKey
(
ASYNC_MAX_INFLIGHT_RPCS
)) {

119 
	gCONFIG
.
£t
(
BigbËO±iÚsFaùÜy
.
BIGTABLE_BULK_MAX_ROW_KEY_COUNT
,

120 
g‘Prİ”t›s
().
g‘Prİ”ty
(
ASYNC_MAX_INFLIGHT_RPCS
));

123 
fš®
 
	gI‹¿tÜ
<
	gEÁry
<
	gObjeù
, Objeù>> 
	g™
 = 
´İs
.
’ŒyS‘
().
™”©Ü
();

124 
	g™
.
hasNext
()) {

125 
	gEÁry
<
	gObjeù
, Objeù> 
	g’Œy
 = 
™
.
Ãxt
();

126 
	gCONFIG
.
£t
((
SŒšg
)
’Œy
.
g‘Key
(), (SŒšgëÁry.
g‘V®ue
());

129 
	gş›ÁSideBufãršg
 = 
g‘Prİ”t›s
()

130 .
g‘Prİ”ty
(
CLIENT_SIDE_BUFFERING
, "çl£").
equ®s
("true");

132 
	gSy¡em
.
	g”r
.
´šn
("Running Google Bigtable with Proto API" +

133 (
ş›ÁSideBufãršg
 ? "‡nd client side buffering." : "."));

135 
synchrÚized
 (
CONFIG
) {

136 ++
	gth»adCouÁ
;

137 ià(
	g£ssiÚ
 =ğ
nuÎ
) {

138 
Œy
 {

139 
İtiÚs
 = 
BigbËO±iÚsFaùÜy
.
äomCÚfigu¿tiÚ
(
CONFIG
);

140 
	g£ssiÚ
 = 
Ãw
 
BigbËSessiÚ
(
İtiÚs
);

144 
	gş›Á
 = 
£ssiÚ
.
g‘D©aCl›Á
();

145 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

146 
throw
 
Ãw
 
DBExû±iÚ
("E¼Ü†ßdšg o±iÚ äom cÚfig: ", 
e
);

149 
	gş›Á
 = 
£ssiÚ
.
g‘D©aCl›Á
();

153 ià((
g‘Prİ”t›s
().
g‘Prİ”ty
("debug"è!ğ
nuÎ
)

154 && (
g‘Prİ”t›s
().
g‘Prİ”ty
("debug").
com·»To
("true") == 0)) {

155 
debug
 = 
Œue
;

158 
fš®
 
SŒšg
 
	gcŞumnFamy
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
("columnfamily");

159 ià(
	gcŞumnFamy
 =ğ
nuÎ
) {

160 
Sy¡em
.
”r
.
´šn
("Error, must specify‡ columnfamily for Bigtableable");

161 
throw
 
Ãw
 
DBExû±iÚ
("No columnfamily specified");

163 
	gcŞumnFamyBy‹s
 = 
By‹s
.
toBy‹s
(
cŞumnFamy
);

166 @
Ov”ride


167 
public
 
ş—nup
(è
throws
 
	gDBExû±iÚ
 {

168 ià(
	gbulkMutiÚ
 !ğ
nuÎ
) {

169 
Œy
 {

170 
bulkMutiÚ
.
æush
();

171 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

172 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

173 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

174 } 
ÿtch
(
RuÁimeExû±iÚ
 
e
){

175 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

179 
synchrÚized
 (
CONFIG
) {

180 --
	gth»adCouÁ
;

181 ià(
	gth»adCouÁ
 <= 0) {

182 
Œy
 {

183 
£ssiÚ
.
şo£
();

184 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

185 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

191 @
Ov”ride


192 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

193 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

194 ià(
	gdebug
) {

195 
	gSy¡em
.
	gout
.
´šn
("Doing„ead from Bigtable columnfamily "

196 + 
Ãw
 
SŒšg
(
cŞumnFamyBy‹s
));

197 
	gSy¡em
.
	gout
.
´šn
("Došg„—d fÜ key: " + 
key
);

200 
£tTabË
(
bË
);

202 
RowF‹r
 
	gf‹r
 = RowF‹r.
ÃwBud”
()

203 .
£tFamyNameRegexF‹rBy‹s
(
By‹SŒšg”
.
w¿p
(
cŞumnFamyBy‹s
))

204 .
bud
();

205 ià(
	gf›lds
 !ğ
nuÎ
 && 
f›lds
.
size
() > 0) {

206 
Bud”
 
f‹rChaš
 = 
RowF‹r
.
Chaš
.
ÃwBud”
();

207 
	gf‹rChaš
.
addF‹rs
(
f‹r
);

208 
	gf‹rChaš
.
addF‹rs
(
RowF‹r
.
ÃwBud”
()

209 .
£tC–lsP”CŞumnLim™F‹r
(1)

210 .
bud
());

211 
	gcouÁ
 = 0;

213 
fš®
 
SŒšgBud”
 
	g»gex
 = 
Ãw
 SŒšgBud”(
f›lds
.
size
() * 6);

214 
fš®
 
SŒšg
 
	gf›ld
 : 
f›lds
) {

215 ià(
couÁ
++ > 0) {

216 
»gex
.
­³nd
("|");

218 
	g»gex
.
­³nd
(
f›ld
);

220 
	gf‹rChaš
.
addF‹rs
(
RowF‹r
.
ÃwBud”
()

221 .
£tCŞumnQu®if›rRegexF‹r
(

222 
By‹SŒšg”
.
w¿p
(
»gex
.
toSŒšg
().
g‘By‹s
()))).
bud
();

223 
	gf‹r
 = 
RowF‹r
.
ÃwBud”
().
£tChaš
(
f‹rChaš
.
bud
()).build();

226 
fš®
 
	gR—dRowsReque¡
.
Bud”
 
	g¼r
 = 
R—dRowsReque¡
.
ÃwBud”
()

227 .
£tTabËNameBy‹s
(
By‹SŒšg”
.
w¿p
(
Ï¡TabËBy‹s
))

228 .
£tF‹r
(
f‹r
)

229 .
£tRows
(
RowS‘
.
ÃwBud”
()

230 .
addRowKeys
(
By‹SŒšg”
.
w¿p
(
key
.
g‘By‹s
())));

232 
	gLi¡
<
	gRow
> 
	grows
;

233 
	gŒy
 {

234 
	grows
 = 
ş›Á
.
»adRowsAsync
(
¼r
.
bud
()).
g‘
();

235 ià(
	grows
 =ğ
nuÎ
 || 
rows
.
isEm±y
()) {

236  
Stus
.
NOT_FOUND
;

238 
fš®
 
Row
 
	grow
 : 
rows
) {

239 
fš®
 
Famy
 
çmy
 : 
row
.
g‘Fam›sLi¡
()) {

240 ià(
A¼ays
.
equ®s
(
çmy
.
g‘NameBy‹s
().
toBy‹A¼ay
(), 
cŞumnFamyBy‹s
)) {

241 
fš®
 
CŞumn
 
	gcŞumn
 : 
çmy
.
g‘CŞumnsLi¡
()) {

243 
»suÉ
.
put
(
cŞumn
.
g‘Qu®if›r
().
toSŒšg
(
UTF8_CHARSET
),

244 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
cŞumn
.
g‘C–ls
(0).
g‘V®ue
().
toBy‹A¼ay
()));

245 ià(
	gdebug
) {

246 
	gSy¡em
.
	gout
.
´šn
(

247 "ResuÉ fÜ f›ld: " + 
cŞumn
.
g‘Qu®if›r
().
toSŒšg
(
UTF8_CHARSET
)

248 + " is: " + 
cŞumn
.
g‘C–ls
(0).
g‘V®ue
().
toSŒšg
(
UTF8_CHARSET
));

255  
	gStus
.
	gOK
;

256 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

257 
	gSy¡em
.
	g”r
.
´šn
("IÁ”ru±ed duršg g‘: " + 
e
);

258 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

259  
	gStus
.
	gERROR
;

260 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

261 
	gSy¡em
.
	g”r
.
´šn
("Exû±iÚ duršg g‘: " + 
e
);

262  
	gStus
.
	gERROR
;

266 @
Ov”ride


267 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

268 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

269 
£tTabË
(
bË
);

271 
RowF‹r
 
	gf‹r
 = RowF‹r.
ÃwBud”
()

272 .
£tFamyNameRegexF‹rBy‹s
(
By‹SŒšg”
.
w¿p
(
cŞumnFamyBy‹s
))

273 .
bud
();

274 ià(
	gf›lds
 !ğ
nuÎ
 && 
f›lds
.
size
() > 0) {

275 
Bud”
 
f‹rChaš
 = 
RowF‹r
.
Chaš
.
ÃwBud”
();

276 
	gf‹rChaš
.
addF‹rs
(
f‹r
);

277 
	gf‹rChaš
.
addF‹rs
(
RowF‹r
.
ÃwBud”
()

278 .
£tC–lsP”CŞumnLim™F‹r
(1)

279 .
bud
());

280 
	gcouÁ
 = 0;

282 
fš®
 
SŒšgBud”
 
	g»gex
 = 
Ãw
 SŒšgBud”(
f›lds
.
size
() * 6);

283 
fš®
 
SŒšg
 
	gf›ld
 : 
f›lds
) {

284 ià(
couÁ
++ > 0) {

285 
»gex
.
­³nd
("|");

287 
	g»gex
.
­³nd
(
f›ld
);

289 
	gf‹rChaš
.
addF‹rs
(
RowF‹r
.
ÃwBud”
()

290 .
£tCŞumnQu®if›rRegexF‹r
(

291 
By‹SŒšg”
.
w¿p
(
»gex
.
toSŒšg
().
g‘By‹s
()))).
bud
();

292 
	gf‹r
 = 
RowF‹r
.
ÃwBud”
().
£tChaš
(
f‹rChaš
.
bud
()).build();

295 
fš®
 
RowRªge
 
	g¿nge
 = RowRªge.
ÃwBud”
()

296 .
£tS¹KeyClo£d
(
By‹SŒšg”
.
w¿p
(
¡¬tkey
.
g‘By‹s
()))

297 .
bud
();

299 
fš®
 
RowS‘
 
	growS‘
 = RowS‘.
ÃwBud”
()

300 .
addRowRªges
(
¿nge
)

301 .
bud
();

303 
fš®
 
	gR—dRowsReque¡
.
Bud”
 
	g¼r
 = 
R—dRowsReque¡
.
ÃwBud”
()

304 .
£tTabËNameBy‹s
(
By‹SŒšg”
.
w¿p
(
Ï¡TabËBy‹s
))

305 .
£tF‹r
(
f‹r
)

306 .
£tRows
(
rowS‘
);

308 
	gLi¡
<
	gRow
> 
	grows
;

309 
	gŒy
 {

310 
	grows
 = 
ş›Á
.
»adRowsAsync
(
¼r
.
bud
()).
g‘
();

311 ià(
	grows
 =ğ
nuÎ
 || 
rows
.
isEm±y
()) {

312  
Stus
.
NOT_FOUND
;

314 
	gnumResuÉs
 = 0;

316 
fš®
 
Row
 
	grow
 : 
rows
) {

317 
fš®
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
> 
	growResuÉ
 =

318 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>(
	gf›lds
 !ğ
nuÎ
 ? 
f›lds
.
size
() : 10);

320 
fš®
 
Famy
 
	gçmy
 : 
row
.
g‘Fam›sLi¡
()) {

321 ià(
A¼ays
.
equ®s
(
çmy
.
g‘NameBy‹s
().
toBy‹A¼ay
(), 
cŞumnFamyBy‹s
)) {

322 
fš®
 
CŞumn
 
	gcŞumn
 : 
çmy
.
g‘CŞumnsLi¡
()) {

324 
rowResuÉ
.
put
(
cŞumn
.
g‘Qu®if›r
().
toSŒšg
(
UTF8_CHARSET
),

325 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
cŞumn
.
g‘C–ls
(0).
g‘V®ue
().
toBy‹A¼ay
()));

326 ià(
	gdebug
) {

327 
	gSy¡em
.
	gout
.
´šn
(

328 "ResuÉ fÜ f›ld: " + 
cŞumn
.
g‘Qu®if›r
().
toSŒšg
(
UTF8_CHARSET
)

329 + " is: " + 
cŞumn
.
g‘C–ls
(0).
g‘V®ue
().
toSŒšg
(
UTF8_CHARSET
));

335 
	g»suÉ
.
add
(
rowResuÉ
);

337 
	gnumResuÉs
++;

338 ià(
	gnumResuÉs
 >ğ
»cÜdcouÁ
) {

342  
	gStus
.
	gOK
;

343 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

344 
	gSy¡em
.
	g”r
.
´šn
("IÁ”ru±ed duršg sÿn: " + 
e
);

345 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

346  
	gStus
.
	gERROR
;

347 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

348 
	gSy¡em
.
	g”r
.
´šn
("Exû±iÚ duršg sÿn: " + 
e
);

349  
	gStus
.
	gERROR
;

353 @
Ov”ride


354 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

355 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

356 ià(
	gdebug
) {

357 
	gSy¡em
.
	gout
.
´šn
("S‘tšg u°puˆfÜ key: " + 
key
);

360 
£tTabË
(
bË
);

362 
fš®
 
	gMu‹RowReque¡
.
Bud”
 
	growMutiÚ
 = 
Mu‹RowReque¡
.
ÃwBud”
();

363 
	growMutiÚ
.
£tRowKey
(
By‹SŒšg
.
cİyFromUtf8
(
key
));

364 
	growMutiÚ
.
£tTabËNameBy‹s
(
By‹SŒšg”
.
w¿p
(
Ï¡TabËBy‹s
));

366 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

367 
fš®
 
MutiÚ
.
Bud”
 
mutiÚBud”
 = 
rowMutiÚ
.
addMutiÚsBud”
();

368 
fš®
 
	gS‘C–l
.
Bud”
 
	g£tC–lBud”
 = 
mutiÚBud”
.
g‘S‘C–lBud”
();

370 
	g£tC–lBud”
.
£tFamyNameBy‹s
(
By‹SŒšg”
.
w¿p
(
cŞumnFamyBy‹s
));

371 
	g£tC–lBud”
.
£tCŞumnQu®if›r
(
By‹SŒšg”
.
w¿p
(
’Œy
.
g‘Key
().
g‘By‹s
()));

372 
	g£tC–lBud”
.
£tV®ue
(
By‹SŒšg”
.
w¿p
(
’Œy
.
g‘V®ue
().
toA¼ay
()));

375 
	g£tC–lBud”
.
£tTime¡ampMiüos
(
Sy¡em
.
cu¼’tTimeMlis
() * 1000);

378 
	gŒy
 {

379 ià(
	gş›ÁSideBufãršg
) {

380 
	gbulkMutiÚ
.
add
(
rowMutiÚ
.
bud
());

382 
	gş›Á
.
mu‹Row
(
rowMutiÚ
.
bud
());

384  
	gStus
.
	gOK
;

385 } 
ÿtch
 (
RuÁimeExû±iÚ
 
e
) {

386 
	gSy¡em
.
	g”r
.
´šn
("FaedØš£¹ key: " + 
key
 + " " + 
e
.
g‘Mes§ge
());

387  
	gStus
.
	gERROR
;

391 @
Ov”ride


392 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

393 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

394  
upd©e
(
bË
, 
key
, 
v®ues
);

397 @
Ov”ride


398 
public
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

399 ià(
	gdebug
) {

400 
	gSy¡em
.
	gout
.
´šn
("Došg d–‘fÜ key: " + 
key
);

403 
£tTabË
(
bË
);

405 
fš®
 
	gMu‹RowReque¡
.
Bud”
 
	growMutiÚ
 = 
Mu‹RowReque¡
.
ÃwBud”
()

406 .
£tRowKey
(
By‹SŒšg
.
cİyFromUtf8
(
key
))

407 .
£tTabËNameBy‹s
(
By‹SŒšg”
.
w¿p
(
Ï¡TabËBy‹s
));

408 
	growMutiÚ
.
addMutiÚsBud”
().
£tD–‘eFromRow
(

409 
D–‘eFromRow
.
g‘DeçuÉIn¡ªû
());

411 
	gŒy
 {

412 ià(
	gş›ÁSideBufãršg
) {

413 
	gbulkMutiÚ
.
add
(
rowMutiÚ
.
bud
());

415 
	gş›Á
.
mu‹Row
(
rowMutiÚ
.
bud
());

417  
	gStus
.
	gOK
;

418 } 
ÿtch
 (
RuÁimeExû±iÚ
 
e
) {

419 
	gSy¡em
.
	g”r
.
´šn
("FaedØd–‘key: " + 
key
 + " " + 
e
.
g‘Mes§ge
());

420  
	gStus
.
	gERROR
;

429 
´iv©e
 
£tTabË
(
fš®
 
SŒšg
 
bË
) {

430 ià(!
	gÏ¡TabË
.
equ®s
(
bË
)) {

431 
	gÏ¡TabË
 = 
bË
;

432 
BigbËTabËName
 
	gbËName
 = 
İtiÚs


433 .
g‘In¡ªûName
()

434 .
toTabËName
(
bË
);

435 
	gÏ¡TabËBy‹s
 = 
bËName


436 .
toSŒšg
()

437 .
g‘By‹s
();

438 
synchrÚized
(
this
) {

439 ià(
	gbulkMutiÚ
 !ğ
nuÎ
) {

440 
Œy
 {

441 
bulkMutiÚ
.
æush
();

442 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

443 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

444 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

447 
	gbulkMutiÚ
 = 
£ssiÚ
.
ü—‹BulkMutiÚ
(
bËName
);

	@googlebigtable/src/main/java/site/ycsb/db/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@googledatastore/src/main/java/site/ycsb/db/GoogleDatastoreClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gcom
.
	ggoogË
.
	g­i
.
	gş›Á
.
	gauth
.
	gßuth2
.
	gC»d’tŸl
;

21 
impÜt
 
	gcom
.
	ggoogË
.
	g­i
.
	gş›Á
.
	ggoogË­is
.
	gauth
.
	gßuth2
.
	gGoogËC»d’tŸl
;

22 
impÜt
 
	gcom
.
	ggoogË
.
	gd©a¡Üe
.
	gv1
.*;

23 
impÜt
 
	gcom
.
	ggoogË
.
	gd©a¡Üe
.
	gv1
.
	gComm™Reque¡
.
	gMode
;

24 
impÜt
 
	gcom
.
	ggoogË
.
	gd©a¡Üe
.
	gv1
.
	gR—dO±iÚs
.
	gR—dCÚsi¡’cy
;

25 
impÜt
 
	gcom
.
	ggoogË
.
	gd©a¡Üe
.
	gv1
.
	gş›Á
.
	gD©a¡Üe
;

26 
impÜt
 
	gcom
.
	ggoogË
.
	gd©a¡Üe
.
	gv1
.
	gş›Á
.
	gD©a¡ÜeExû±iÚ
;

27 
impÜt
 
	gcom
.
	ggoogË
.
	gd©a¡Üe
.
	gv1
.
	gş›Á
.
	gD©a¡ÜeFaùÜy
;

28 
impÜt
 
	gcom
.
	ggoogË
.
	gd©a¡Üe
.
	gv1
.
	gş›Á
.
	gD©a¡ÜeH–³r
;

29 
impÜt
 
	gcom
.
	ggoogË
.
	gd©a¡Üe
.
	gv1
.
	gş›Á
.
	gD©a¡ÜeO±iÚs
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

32 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

34 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

35 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLev–
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

40 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

41 
impÜt
 
	gjava
.
	g£cur™y
.
	gG’”®Secur™yExû±iÚ
;

42 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

43 
impÜt
 
	gjava
.
	gut
.
	gM­
;

44 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

45 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

46 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

48 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

54 
public
 cÏs 
	cGoogËD©a¡ÜeCl›Á
 
ex‹nds
 
	mDB
 {

58 
´iv©e
 
	eMutiÚTy³
 {

59 
	mUPSERT
,

60 
	mUPDATE
,

61 
	mDELETE


67 
´iv©e
 
	eEÁ™yGroupšgMode
 {

68 
	gONE_ENTITY_PER_GROUP
,

69 
	gMULTI_ENTITY_PER_GROUP


72 
´iv©e
 
Logg”
 
	glogg”
 =

73 
Logg”
.
g‘Logg”
(
GoogËD©a¡ÜeCl›Á
.
şass
);

77 
´iv©e
 
R—dCÚsi¡’cy
 
	g»adCÚsi¡’cy
 = R—dCÚsi¡’cy.
STRONG
;

79 
´iv©e
 
EÁ™yGroupšgMode
 
	g’t™yGroupšgMode
 =

80 
EÁ™yGroupšgMode
.
ONE_ENTITY_PER_GROUP
;

82 
´iv©e
 
SŒšg
 
	groÙEÁ™yName
;

84 
´iv©e
 
D©a¡Üe
 
	gd©a¡Üe
 = 
nuÎ
;

86 
´iv©e
 
boŞ—n
 
	gskIndex
 = 
Œue
;

92 @
Ov”ride


93 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

94 
SŒšg
 
debug
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("googËd©a¡Üe.debug", 
nuÎ
);

95 ià(
nuÎ
 !ğ
debug
 && "Œue".
	`equ®sIgnÜeCa£
(debug)) {

96 
logg”
.
	`£tLev–
(
Lev–
.
DEBUG
);

99 
SŒšg
 
skIndexSŒšg
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

100 "googËd©a¡Üe.skIndex", 
nuÎ
);

101 ià(
nuÎ
 !ğ
skIndexSŒšg
 && "çl£".
	`equ®sIgnÜeCa£
(skipIndexString)) {

102 
skIndex
 = 
çl£
;

110 
SŒšg
 
d©a£tId
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

111 "googËd©a¡Üe.d©a£tId", 
nuÎ
);

112 ià(
d©a£tId
 =ğ
nuÎ
) {

113 
throw
 
Ãw
 
	`DBExû±iÚ
(

117 
SŒšg
 
´iv©eKeyFe
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

118 "googËd©a¡Üe.´iv©eKeyFe", 
nuÎ
);

119 
SŒšg
 
£rviûAccouÁEma
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

120 "googËd©a¡Üe.£rviûAccouÁEma", 
nuÎ
);

124 
SŒšg
 
»adCÚsi¡’cyCÚfig
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

125 "googËd©a¡Üe.»adCÚsi¡’cy", 
nuÎ
);

126 ià(
»adCÚsi¡’cyCÚfig
 !ğ
nuÎ
) {

127 
Œy
 {

128 
this
.
»adCÚsi¡’cy
 = 
R—dCÚsi¡’cy
.
	`v®ueOf
(

129 
»adCÚsi¡’cyCÚfig
.
	`Œim
().
	`toUµ”Ca£
());

130 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

131 
throw
 
Ãw
 
	`DBExû±iÚ
("Invalid„ead consistency specified: " +

132 
»adCÚsi¡’cyCÚfig
 + ". Expecting STRONG or EVENTUAL.");

140 
SŒšg
 
’t™yGroupšgCÚfig
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

141 "googËd©a¡Üe.’t™yGroupšgMode", 
nuÎ
);

142 ià(
’t™yGroupšgCÚfig
 !ğ
nuÎ
) {

143 
Œy
 {

144 
this
.
’t™yGroupšgMode
 = 
EÁ™yGroupšgMode
.
	`v®ueOf
(

145 
’t™yGroupšgCÚfig
.
	`Œim
().
	`toUµ”Ca£
());

146 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

147 
throw
 
Ãw
 
	`DBExû±iÚ
("Invalidƒntity grouping mode specified: " +

148 
’t™yGroupšgCÚfig
 + ". Expecting ONE_ENTITY_PER_GROUP or " +

153 
this
.
roÙEÁ™yName
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

156 
Œy
 {

159 
D©a¡ÜeO±iÚs
.
Bud”
 
İtiÚs
 = 
Ãw
 D©a¡ÜeO±iÚs.
	`Bud”
();

160 
C»d’tŸl
 
üed’tŸl
 = 
GoogËC»d’tŸl
.
	`g‘AµliÿtiÚDeçuÉ
();

161 ià(
£rviûAccouÁEma
 !ğ
nuÎ
 && 
´iv©eKeyFe
 !=‚ull) {

162 
üed’tŸl
 = 
D©a¡ÜeH–³r
.
	`g‘S”viûAccouÁC»d’tŸl
(

163 
£rviûAccouÁEma
, 
´iv©eKeyFe
);

164 
logg”
.
	`šfo
("Using JWT Service Account credential.");

165 
logg”
.
	`šfo
("D©a£tID: " + 
d©a£tId
 + ", Service Account Email: " +

166 
£rviûAccouÁEma
 + ", Priv©Key FP©h: " + 
´iv©eKeyFe
);

168 
logg”
.
	`šfo
("Using default gcloud credential.");

169 
logg”
.
	`šfo
("D©a£tID: " + 
d©a£tId


170 + ", S”viû AccouÁ Ema: " + ((
GoogËC»d’tŸl
è
üed’tŸl
).
	`g‘S”viûAccouÁId
());

173 
d©a¡Üe
 = 
D©a¡ÜeFaùÜy
.
	`g‘
().
	`ü—‹
(

174 
İtiÚs
.
	`üed’tŸl
(
üed’tŸl
).
	`´ojeùId
(
d©a£tId
).
	`bud
());

176 } 
	`ÿtch
 (
G’”®Secur™yExû±iÚ
 
exû±iÚ
) {

177 
throw
 
Ãw
 
	`DBExû±iÚ
("Securityƒrror connectingohe datastore: " +

178 
exû±iÚ
.
	`g‘Mes§ge
(),ƒxception);

180 } 
	`ÿtch
 (
IOExû±iÚ
 
exû±iÚ
) {

181 
throw
 
Ãw
 
	`DBExû±iÚ
("I/Oƒrror connectingohe datastore: " +

182 
exû±iÚ
.
	`g‘Mes§ge
(),ƒxception);

185 
logg”
.
	`šfo
("Datastore client instance created: " +

186 
d©a¡Üe
.
	`toSŒšg
());

187 
	}
}

189 @
Ov”ride


190 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

191 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

192 
	gLookupReque¡
.
Bud”
 
	glookupReque¡
 = 
LookupReque¡
.
ÃwBud”
();

193 
	glookupReque¡
.
addKeys
(
budPrim¬yKey
(
bË
, 
key
));

194 
	glookupReque¡
.
g‘R—dO±iÚsBud”
().
£tR—dCÚsi¡’cy
(

195 
this
.
»adCÚsi¡’cy
);

199 
	glogg”
.
debug
("Buˆlooku°»que¡‡s: " + 
lookupReque¡
.
toSŒšg
());

201 
LookupRe¥Ú£
 
	g»¥Ú£
 = 
nuÎ
;

202 
	gŒy
 {

203 
	g»¥Ú£
 = 
d©a¡Üe
.
lookup
(
lookupReque¡
.
bud
());

205 } 
ÿtch
 (
D©a¡ÜeExû±iÚ
 
exû±iÚ
) {

206 
	glogg”
.
”rÜ
(

207 
SŒšg
.
fÜm©
("Datastore Exception when„eading (%s): %s %s",

208 
exû±iÚ
.
g‘Mes§ge
(),

209 
exû±iÚ
.
g‘M‘hodName
(),

210 
exû±iÚ
.
g‘Code
()));

214  
Ãw
 
Stus
("ERROR-" + 
exû±iÚ
.
g‘Code
(),ƒxû±iÚ.
g‘Mes§ge
());

217 ià(
	g»¥Ú£
.
g‘FoundCouÁ
() == 0) {

218  
Ãw
 
Stus
("ERROR-404", "NÙ Found, key is: " + 
key
);

219 } ià(
	g»¥Ú£
.
g‘FoundCouÁ
() > 1) {

222  
	gStus
.
	gUNEXPECTED_STATE
;

225 
EÁ™y
 
	g’t™y
 = 
»¥Ú£
.
g‘Found
(0).
g‘EÁ™y
();

226 
	glogg”
.
debug
("R—dƒÁ™y: " + 
’t™y
.
toSŒšg
());

228 
	gM­
<
	gSŒšg
, 
	gV®ue
> 
	g´İ”t›s
 = 
’t™y
.
g‘Prİ”t›s
();

229 
	gS‘
<
	gSŒšg
> 
	g´İ”t›sToR‘uº
 =

230 (
f›lds
 =ğ
nuÎ
 ? 
´İ”t›s
.
keyS‘
() : fields);

232 
SŒšg
 
	gÇme
 : 
´İ”t›sToR‘uº
) {

233 ià(
´İ”t›s
.
cÚšsKey
(
Çme
)) {

234 
»suÉ
.
put
(
Çme
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
´İ”t›s
.
g‘
(name)

235 .
g‘SŒšgV®ue
()));

239  
	gStus
.
	gOK
;

242 @
Ov”ride


243 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

244 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

246  
	gStus
.
	gNOT_IMPLEMENTED
;

249 @
Ov”ride


250 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

251 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

253  
doSšgËI‹mMutiÚ
(
bË
, 
key
, 
v®ues
, 
MutiÚTy³
.
UPDATE
);

256 @
Ov”ride


257 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

258 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

263  
doSšgËI‹mMutiÚ
(
bË
, 
key
, 
v®ues
, 
MutiÚTy³
.
UPSERT
);

266 @
Ov”ride


267 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

268  
	`doSšgËI‹mMutiÚ
(
bË
, 
key
, 
nuÎ
, 
MutiÚTy³
.
DELETE
);

269 
	}
}

271 
´iv©e
 
	gKey
.
Bud”
 
	$budPrim¬yKey
(
SŒšg
 
bË
, SŒšg 
key
) {

272 
Key
.
Bud”
 
»suÉ
 = Key.
	`ÃwBud”
();

274 ià(
this
.
’t™yGroupšgMode
 =ğ
EÁ™yGroupšgMode
.
MULTI_ENTITY_PER_GROUP
) {

276 
»suÉ
.
	`addP©h
(
Key
.
P©hEËm’t
.
	`ÃwBud”
().
	`£tKšd
(
bË
).

277 
	`£tName
(
roÙEÁ™yName
));

280  
»suÉ
.
	`addP©h
(
Key
.
P©hEËm’t
.
	`ÃwBud”
().
	`£tKšd
(
bË
)

281 .
	`£tName
(
key
));

282 
	}
}

284 
´iv©e
 
Stus
 
doSšgËI‹mMutiÚ
(
SŒšg
 
bË
, SŒšg 
key
,

285 @
NuÎabË
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
,

286 
MutiÚTy³
 
mutiÚTy³
) {

288 
	gKey
.
Bud”
 
	gd©a¡ÜeKey
 = 
budPrim¬yKey
(
bË
, 
key
);

294 
	gComm™Reque¡
.
Bud”
 
	gcomm™Reque¡
 = 
Comm™Reque¡
.
ÃwBud”
();

295 
	gcomm™Reque¡
.
£tMode
(
Mode
.
NON_TRANSACTIONAL
);

297 ià(
	gmutiÚTy³
 =ğ
MutiÚTy³
.
DELETE
) {

298 
comm™Reque¡
.
addMutiÚsBud”
().
£tD–‘e
(
d©a¡ÜeKey
);

302 
	gEÁ™y
.
Bud”
 
	g’t™yBud”
 = 
EÁ™y
.
ÃwBud”
();

303 
	g’t™yBud”
.
£tKey
(
d©a¡ÜeKey
);

304 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gv®
 : 
v®ues
.
’ŒyS‘
()) {

305 
’t™yBud”
.
g‘MubËPrİ”t›s
()

306 .
put
(
v®
.
g‘Key
(),

307 
V®ue
.
ÃwBud”
()

308 .
£tSŒšgV®ue
(
v®
.
g‘V®ue
().
toSŒšg
())

309 .
£tExşudeFromIndexes
(
skIndex
).
bud
());

311 
EÁ™y
 
	g’t™y
 = 
’t™yBud”
.
bud
();

312 
	glogg”
.
debug
("’t™y buˆas: " + 
’t™y
.
toSŒšg
());

314 ià(
	gmutiÚTy³
 =ğ
MutiÚTy³
.
UPSERT
) {

315 
comm™Reque¡
.
addMutiÚsBud”
().
£tUp£¹
(
’t™y
);

316 } ià(
	gmutiÚTy³
 =ğ
MutiÚTy³
.
UPDATE
){

317 
comm™Reque¡
.
addMutiÚsBud”
().
£tUpd©e
(
’t™y
);

319 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Impossible MutationType, code bug.");

323 
	gŒy
 {

324 
	gd©a¡Üe
.
comm™
(
comm™Reque¡
.
bud
());

325 
	glogg”
.
debug
("successfully committed.");

327 } 
ÿtch
 (
D©a¡ÜeExû±iÚ
 
exû±iÚ
) {

330 
	glogg”
.
”rÜ
(

331 
SŒšg
.
fÜm©
("Datastore Exception when committing (%s): %s %s",

332 
exû±iÚ
.
g‘Mes§ge
(),

333 
exû±iÚ
.
g‘M‘hodName
(),

334 
exû±iÚ
.
g‘Code
()));

338  
Ãw
 
Stus
("ERROR-" + 
exû±iÚ
.
g‘Code
(),ƒxû±iÚ.
g‘Mes§ge
());

341  
	gStus
.
	gOK
;

	@googledatastore/src/main/java/site/ycsb/db/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@griddb/src/main/java/site/ycsb/db/griddb/GridDBClient.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	ggriddb
;

21 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

22 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

26 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

27 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

28 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

29 
impÜt
 
	gjava
.
	gut
.
	gloggšg
.
	gLogg”
;

31 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gCŞumnInfo
;

32 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gCÚš”
;

33 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gCÚš”Info
;

34 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gCÚš”Ty³
;

35 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gGSExû±iÚ
;

36 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gGSTy³
;

37 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gGridStÜe
;

38 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gGridStÜeFaùÜy
;

39 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gP¬t™iÚCÚŒŞËr
;

40 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gRow
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

50 
public
 
şass
 
GridDBCl›Á
 
ex‹nds
 
	gs™e
.
	gycsb
.
	gDB
 {

52 
´iv©e
 
SŒšg
 
	gnÙifiÿtiÚAdd»ss
 = "";

53 
´iv©e
 
SŒšg
 
	gnÙifiÿtiÚPÜt
 = "";

55 
´iv©e
 
SŒšg
 
	gnÙifiÿtiÚMemb”
 = "";

57 
´iv©e
 
SŒšg
 
	gu£rName
 = "";

58 
´iv©e
 
SŒšg
 
	g·sswÜd
 = "";

59 
´iv©e
 
SŒšg
 
	gşu¡”Name
 = "";

62 
public
 
fš®
 
SŒšg
 
	gVALUE_COLUMN_NAME_PREFIX
= "field";

63 
public
 
fš®
 
	gROW_KEY_COLUMN_POS
 = 0;

65 
´iv©e
 
SŒšg
 
	gcÚš”P»fix
 = "";

67 
public
 
fš®
 
	gDEFAULT_CACHE_CONTAINER_NUM
 = 1000;

68 
public
 
fš®
 
	gFIELD_NUM
 = 10;

70 
´iv©e
 
	gnumCÚš”
 = 0;

71 
public
 
fš®
 
GSTy³
 
	gSCHEMA_TYPE
 = GSTy³.
STRING
;

73 
´iv©e
 
GridStÜe
 
	g¡Üe
;

74 
´iv©e
 
CÚš”Info
 
	gcÚš”Info
 = 
nuÎ
;

75 
´iv©e
 
fš®
 
Logg”
 
	gLOGGER
 = Logg”.
g‘Logg”
(
GridDBCl›Á
.
şass
.
g‘Name
());

77 
şass
 
RowCom·¿tÜ
 
im¶em’ts
 
	gCom·¿tÜ
<
	gRow
> {

78 
public
 
com·»
(
Row
 
row1
, Row 
row2
è
throws
 
	gNuÎPoš‹rExû±iÚ
 {

79 
	g»suÉ
 = 0;

80 
	gŒy
 {

81 
Objeù
 
	gv®1
 = 
row1
.
g‘V®ue
(0);

82 
Objeù
 
	gv®2
 = 
row2
.
g‘V®ue
(0);

83 
	g»suÉ
 = ((
SŒšg
)
v®1
).
com·»To
((SŒšg)
v®2
);

84 } 
ÿtch
 (
GSExû±iÚ
 
e
) {

85 
	gLOGGER
.
£v”e
("Th”i ¨exû±iÚ: " + 
e
.
g‘Mes§ge
());

86 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

88  
	g»suÉ
;

92 
public
 
š™
(è
throws
 
	gDBExû±iÚ
 {

93 
	gLOGGER
.
šfo
("GridDBClient");

95 
fš®
 
Prİ”t›s
 
	g´İs
 = 
g‘Prİ”t›s
();

96 
	gnÙifiÿtiÚAdd»ss
 = 
´İs
.
g‘Prİ”ty
("notificationAddress");

97 
	gnÙifiÿtiÚPÜt
 = 
´İs
.
g‘Prİ”ty
("notificationPort");

98 
	gnÙifiÿtiÚMemb”
 = 
´İs
.
g‘Prİ”ty
("notificationMember");

99 
	gşu¡”Name
 = 
´İs
.
g‘Prİ”ty
("clusterName");

100 
	gu£rName
 = 
´İs
.
g‘Prİ”ty
("userName");

101 
	g·sswÜd
 = 
´İs
.
g‘Prİ”ty
("password");

102 
	gcÚš”P»fix
 = 
´İs
.
g‘Prİ”ty
("table", "usertable") + "@";

103 
SŒšg
 
	gf›ldcouÁ
 = 
´İs
.
g‘Prİ”ty
("fieldcount");

104 
SŒšg
 
	gf›ldËngth
 = 
´İs
.
g‘Prİ”ty
("fieldlength");

106 
	gLOGGER
.
šfo
("nÙifiÿtiÚAdd»ss=" + 
nÙifiÿtiÚAdd»ss
 + "‚ÙifiÿtiÚPÜt=" + 
nÙifiÿtiÚPÜt
 +

107 "‚ÙifiÿtiÚMemb”=" + 
nÙifiÿtiÚMemb”
);

108 
	gLOGGER
.
šfo
("şu¡”Name=" + 
şu¡”Name
 + " u£rName=" + 
u£rName
);

109 
	gLOGGER
.
šfo
("f›ldcouÁ=" + 
f›ldcouÁ
 + " f›ldËngth=" + 
f›ldËngth
);

112 
fš®
 
Prİ”t›s
 
	ggrid¡ÜePrİ
 = 
Ãw
 Properties();

113 ià(
	gşu¡”Name
 =ğ
nuÎ
 || 
u£rName
 =ğnuÎ || 
·sswÜd
 ==‚ull) {

114 
LOGGER
.
£v”e
("[ERROR] clusterName or userName or…assword‡rgument‚ot specified");

115 
throw
 
Ãw
 
DBExû±iÚ
();

117 ià(
	gf›ldcouÁ
 =ğ
nuÎ
 || 
f›ldËngth
 ==‚ull) {

118 
LOGGER
.
£v”e
("[ERROR] fieldcount or fieldlength‡rgument‚ot specified");

119 
throw
 
Ãw
 
DBExû±iÚ
();

121 ià(!
	gf›ldcouÁ
.
equ®s
(
SŒšg
.
v®ueOf
(
FIELD_NUM
)è|| !
	gf›ldËngth
.equals("100")) {

122 
	gLOGGER
.
£v”e
("[ERROR] Invalid‡rgment: fieldcount or fieldlength");

123 
throw
 
Ãw
 
DBExû±iÚ
();

126 ià(
	gnÙifiÿtiÚAdd»ss
 !ğ
nuÎ
) {

127 ià(
nÙifiÿtiÚPÜt
 =ğ
nuÎ
) {

128 
LOGGER
.
£v”e
("[ERROR]‚otificationPort‡rgument‚ot specified");

129 
throw
 
Ãw
 
DBExû±iÚ
();

132 
	ggrid¡ÜePrİ
.
£tPrİ”ty
("nÙifiÿtiÚAdd»ss", 
nÙifiÿtiÚAdd»ss
);

133 
	ggrid¡ÜePrİ
.
£tPrİ”ty
("nÙifiÿtiÚPÜt", 
nÙifiÿtiÚPÜt
);

134 } ià(
	gnÙifiÿtiÚMemb”
 !ğ
nuÎ
) {

136 
grid¡ÜePrİ
.
£tPrİ”ty
("nÙifiÿtiÚMemb”", 
nÙifiÿtiÚMemb”
);

138 
	gLOGGER
.
£v”e
("[ERROR]‚otificationAddress‡nd‚otificationMember‡rgument‚ot specified");

139 
throw
 
Ãw
 
DBExû±iÚ
();

141 
	ggrid¡ÜePrİ
.
£tPrİ”ty
("şu¡”Name", 
şu¡”Name
);

142 
	ggrid¡ÜePrİ
.
£tPrİ”ty
("u£r", 
u£rName
);

143 
	ggrid¡ÜePrİ
.
£tPrİ”ty
("·sswÜd", 
·sswÜd
);

145 
	ggrid¡ÜePrİ
.
£tPrİ”ty
("cÚš”CacheSize", 
SŒšg
.
v®ueOf
(
DEFAULT_CACHE_CONTAINER_NUM
));

147 
	gLi¡
<
	gCŞumnInfo
> 
	gcŞumnInfoLi¡
 = 
Ãw
 
A¼ayLi¡
<
CŞumnInfo
>();

148 
CŞumnInfo
 
	gkeyInfo
 = 
Ãw
 CŞumnInfo("key", 
SCHEMA_TYPE
);

149 
	gcŞumnInfoLi¡
.
add
(
keyInfo
);

150 
	gi
 = 0; i < 
	gFIELD_NUM
; i++) {

151 
SŒšg
 
	gcŞumnName
 = SŒšg.
fÜm©
(
VALUE_COLUMN_NAME_PREFIX
 + "%d", 
i
);

152 
CŞumnInfo
 
	gšfo
 = 
Ãw
 CŞumnInfo(
cŞumnName
, 
SCHEMA_TYPE
);

153 
	gcŞumnInfoLi¡
.
add
(
šfo
);

155 
	gcÚš”Info
 = 
Ãw
 
CÚš”Info
(
nuÎ
, 
CÚš”Ty³
.
COLLECTION
, 
cŞumnInfoLi¡
, 
Œue
);

157 
	gŒy
 {

158 
	gGridStÜeFaùÜy
.
g‘In¡ªû
().
£tPrİ”t›s
(
grid¡ÜePrİ
);

159 
	g¡Üe
 = 
GridStÜeFaùÜy
.
g‘In¡ªû
().
g‘GridStÜe
(
grid¡ÜePrİ
);

160 
P¬t™iÚCÚŒŞËr
 
	gcÚŒŞËr
 = 
¡Üe
.
g‘P¬t™iÚCÚŒŞËr
();

161 
	gnumCÚš”
 = 
cÚŒŞËr
.
g‘P¬t™iÚCouÁ
();

163 
	gk
 = 0; k < 
	gnumCÚš”
; k++) {

164 
SŒšg
 
	gÇme
 = 
cÚš”P»fix
 + 
k
;

165 
	g¡Üe
.
putCÚš”
(
Çme
, 
cÚš”Info
, 
çl£
);

167 } 
ÿtch
 (
GSExû±iÚ
 
e
) {

168 
	gLOGGER
.
£v”e
("Exû±iÚ: " + 
e
.
g‘Mes§ge
());

169 
throw
 
Ãw
 
DBExû±iÚ
();

172 
	gLOGGER
.
šfo
("numCÚš”=" + 
numCÚš”
 + " containerCasheSize=" +

173 
SŒšg
.
v®ueOf
(
DEFAULT_CACHE_CONTAINER_NUM
));

177 
public
 
ş—nup
(è
throws
 
	gDBExû±iÚ
 {

178 
	gŒy
 {

179 
	g¡Üe
.
şo£
();

180 } 
ÿtch
 (
GSExû±iÚ
 
e
) {

181 
	gLOGGER
.
£v”e
("Exû±iÚ wh’ clo£." + 
e
.
g‘Mes§ge
());

182 
throw
 
Ãw
 
DBExû±iÚ
();

186 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

187 
	gŒy
 {

189 
Objeù
 
	growKey
 = 
makeRowKey
(
key
);

190 
SŒšg
 
	gcÚš”Key
 = 
makeCÚš”Key
(
key
);

192 
fš®
 
	gCÚš”
<
	gObjeù
, 
	gRow
> 
	gcÚš”
 = 
¡Üe
.
g‘CÚš”
(
cÚš”Key
);

193 if(
	gcÚš”
 =ğ
nuÎ
) {

194 
LOGGER
.
£v”e
("[ERROR]g‘CŞËùiÚ " + 
cÚš”Key
 + " in„ead()");

195  
	gStus
.
	gERROR
;

198 
Row
 
	grg‘Row
 = 
cÚš”
.
g‘
(
rowKey
);

199 ià(
	grg‘Row
 =ğ
nuÎ
) {

200 
LOGGER
.
£v”e
("[ERROR]get(rowKey) in„ead()");

201  
	gStus
.
	gERROR
;

204 
	gi
 = 1; i < 
	gcÚš”Info
.
g‘CŞumnCouÁ
(); i++) {

205 
	g»suÉ
.
put
(
cÚš”Info
.
g‘CŞumnInfo
(
i
).
g‘Name
(),

206 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
rg‘Row
.
g‘V®ue
(
i
).
toSŒšg
().
g‘By‹s
()));

209  
	gStus
.
	gOK
;

211 } 
ÿtch
 (
GSExû±iÚ
 
e
) {

212 
	gLOGGER
.
£v”e
("Exû±iÚ: " + 
e
.
g‘Mes§ge
());

213  
	gStus
.
	gERROR
;

217 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

218 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

219 
	gLOGGER
.
£v”e
("[ERROR]scan()‚ot supported");

220  
	gStus
.
	gERROR
;

223 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

224 
	gŒy
 {

225 
Objeù
 
	growKey
 = 
makeRowKey
(
key
);

226 
SŒšg
 
	gcÚš”Key
 = 
makeCÚš”Key
(
key
);

228 
fš®
 
	gCÚš”
<
	gObjeù
, 
	gRow
> 
	gcÚš”
 = 
¡Üe
.
g‘CÚš”
(
cÚš”Key
);

229 if(
	gcÚš”
 =ğ
nuÎ
) {

230 
LOGGER
.
£v”e
("[ERROR]g‘CŞËùiÚ " + 
cÚš”Key
 + " in update()");

231  
	gStus
.
	gERROR
;

234 
Row
 
	grg‘Row
 = 
cÚš”
.
g‘
(
rowKey
);

235 ià(
	grg‘Row
 =ğ
nuÎ
) {

236 
LOGGER
.
£v”e
("[ERROR]get(rowKey) in update()");

237  
	gStus
.
	gERROR
;

240 
	g£tCouÁ
 = 0;

241 
	gi
 = 1; i < 
	gcÚš”Info
.
g‘CŞumnCouÁ
(è&& 
	g£tCouÁ
 < 
	gv®ues
.
size
(); i++) {

242 
	gcÚš”Info
.
g‘CŞumnInfo
(
i
).
g‘Name
();

243 
By‹I‹¿tÜ
 
	gby‹I‹¿tÜ
 = 
v®ues
.
g‘
(
cÚš”Info
.
g‘CŞumnInfo
(
i
).
g‘Name
());

244 ià(
	gby‹I‹¿tÜ
 !ğ
nuÎ
) {

245 
Objeù
 
v®ue
 = 
makeV®ue
(
by‹I‹¿tÜ
);

246 
	grg‘Row
.
£tV®ue
(
i
, 
v®ue
);

247 
	g£tCouÁ
++;

250 ià(
	g£tCouÁ
 !ğ
v®ues
.
size
()) {

251 
LOGGER
.
£v”e
("E¼Ü s‘CouÁ = " + 
£tCouÁ
);

252  
	gStus
.
	gERROR
;

255 
	gcÚš”
.
put
(
rg‘Row
);

257  
	gStus
.
	gOK
;

258 } 
ÿtch
 (
GSExû±iÚ
 
e
) {

259 
	gLOGGER
.
£v”e
("Exû±iÚ: " + 
e
.
g‘Mes§ge
());

260  
	gStus
.
	gERROR
;

264 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

265 
	gŒy
 {

267 
Objeù
 
	growKey
 = 
makeRowKey
(
key
);

268 
SŒšg
 
	gcÚš”Key
 = 
makeCÚš”Key
(
key
);

270 
fš®
 
	gCÚš”
<
	gObjeù
, 
	gRow
> 
	gcÚš”
 = 
¡Üe
.
g‘CÚš”
(
cÚš”Key
);

271 if(
	gcÚš”
 =ğ
nuÎ
) {

272 
LOGGER
.
£v”e
("[ERROR]g‘CŞËùiÚ " + 
cÚš”Key
 + " in insert()");

275 
Row
 
	grow
 = 
cÚš”
.
ü—‹Row
();

277 
	grow
.
£tV®ue
(
ROW_KEY_COLUMN_POS
, 
rowKey
);

279 
	gi
 = 1; i < 
	gcÚš”Info
.
g‘CŞumnCouÁ
(); i++) {

280 
By‹I‹¿tÜ
 
	gby‹I‹¿tÜ
 = 
v®ues
.
g‘
(
cÚš”Info
.
g‘CŞumnInfo
(
i
).
g‘Name
());

281 
Objeù
 
	gv®ue
 = 
makeV®ue
(
by‹I‹¿tÜ
);

282 
	grow
.
£tV®ue
(
i
, 
v®ue
);

285 
	gcÚš”
.
put
(
row
);

287 } 
ÿtch
 (
GSExû±iÚ
 
e
) {

288 
	gLOGGER
.
£v”e
("Exû±iÚ: " + 
e
.
g‘Mes§ge
());

289  
	gStus
.
	gERROR
;

292  
	gStus
.
	gOK
;

295 
public
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

296 
	gŒy
 {

297 
Objeù
 
	growKey
 = 
makeRowKey
(
key
);

298 
SŒšg
 
	gcÚš”Key
 = 
makeCÚš”Key
(
key
);

300 
fš®
 
	gCÚš”
<
	gObjeù
, 
	gRow
> 
	gcÚš”
 = 
¡Üe
.
g‘CÚš”
(
cÚš”Key
);

301 if(
	gcÚš”
 =ğ
nuÎ
) {

302 
LOGGER
.
£v”e
("[ERROR]g‘CŞËùiÚ " + 
cÚš”Key
 + " in„ead()");

303  
	gStus
.
	gERROR
;

306 
boŞ—n
 
	gisD–‘e
 = 
cÚš”
.
»move
(
rowKey
);

307 ià(!
	gisD–‘e
) {

308 
	gLOGGER
.
£v”e
("[ERROR]remove(rowKey) in„emove()");

309  
	gStus
.
	gERROR
;

311 }
ÿtch
 (
GSExû±iÚ
 
e
) {

312 
	gLOGGER
.
£v”e
("Exû±iÚ: " + 
e
.
g‘Mes§ge
());

313  
	gStus
.
	gERROR
;

315  
	gStus
.
	gOK
;

318 
´Ùeùed
 
SŒšg
 
makeCÚš”Key
(SŒšg 
key
) {

319  
	gcÚš”P»fix
 + 
	gM©h
.
abs
(
key
.
hashCode
(è% 
numCÚš”
);

322 
´Ùeùed
 
Objeù
 
makeRowKey
(
SŒšg
 
key
) {

323  
	gkey
;

326 
´Ùeùed
 
Objeù
 
makeV®ue
(
By‹I‹¿tÜ
 
by‹I‹¿tÜ
) {

327  
	gby‹I‹¿tÜ
.
toSŒšg
();

330 
´Ùeùed
 
Objeù
 
makeQu”yL™”®
(Objeù 
v®ue
) {

331  "'" + 
	gv®ue
.
toSŒšg
() + "'";

	@griddb/src/main/java/site/ycsb/db/griddb/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	ggriddb
;

	@griddb/src/test/java/site/ycsb/db/griddb/GridDBClientTest.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	ggriddb
;

21 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gCÜeM©ch”s
.
	gnÙ
;

22 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”As£¹
.
	gas£¹Th©
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.*;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeNoExû±iÚ
;

26 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

27 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtAdd»ss
;

28 
impÜt
 
	gjava
.
	gÃt
.
	gSock‘
;

29 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

30 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

31 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

32 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

33 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

34 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

36 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

37 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

38 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

39 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

41 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gCŞumnInfo
;

42 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gCÚš”Info
;

43 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gCÚš”Ty³
;

44 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gGSExû±iÚ
;

45 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gGSTy³
;

46 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gGridStÜe
;

47 
impÜt
 
	gcom
.
	gtoshiba
.
	gmwşoud
.
	ggs
.
	gGridStÜeFaùÜy
;

48 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

49 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

50 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

51 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

52 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

53 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

54 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

56 
public
 cÏs 
	cGridDBCl›ÁTe¡
 {

58 
´iv©e
 
fš®
 
	mGRIDDB_DEFAULT_PORT
 = 10040;

61 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_TABLE
 = "testtable";

62 
´iv©e
 
fš®
 
SŒšg
 
	mNOTIFICATION_PORT
 = "31999";

63 
´iv©e
 
fš®
 
SŒšg
 
	mNOTIFICATION_ADDR
 = "239.0.0.1";

64 
´iv©e
 
fš®
 
SŒšg
 
	mCLUSTER_NAME
 = "ycsbcluster";

65 
´iv©e
 
fš®
 
SŒšg
 
	mUSER_NAME
 = "admin";

66 
´iv©e
 
fš®
 
SŒšg
 
	mPASS
 = "admin";

67 
´iv©e
 
fš®
 
	mFIELD_COUNT
 = 10;

68 
´iv©e
 
fš®
 
SŒšg
 
	mFIELD_LENGTH
 = "100";

70 
´iv©e
 
DB
 
	mmyCl›Á
 = 
nuÎ
;

71 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_ROW_KEY
 = "user1";

72 
public
 
fš®
 
SŒšg
 
	mVALUE_COLUMN_NAME_PREFIX
= "field";

73 
´iv©e
 
CÚš”Info
 
	mcÚš”Info
 = 
nuÎ
;

74 
´iv©e
 
GridStÜe
 
	m¡Üe
;

80 @
BefÜeCÏss


81 
public
 
	$£tUpBefÜeCÏss
() {

83 
Sock‘
 
sock‘
 = 
nuÎ
;

84 
Œy
 {

86 
sock‘
 = 
Ãw
 
	`Sock‘
(
IÃtAdd»ss
.
	`g‘LoÿlHo¡
(), 
GRIDDB_DEFAULT_PORT
);

87 
	`as£¹Th©
("Sock‘ i nÙ bound.", 
sock‘
.
	`g‘LoÿlPÜt
(), 
	`nÙ
(-1));

88 } 
	`ÿtch
 (
IOExû±iÚ
 
cÚÃùFaed
) {

89 
	`assumeNoExû±iÚ
("GridDB is‚ot„unning. Skippingests.",

90 
cÚÃùFaed
);

91 } 
fš®ly
 {

92 ià(
sock‘
 !ğ
nuÎ
) {

93 
Œy
 {

94 
sock‘
.
	`şo£
();

95 } 
	`ÿtch
 (
IOExû±iÚ
 
ignÜe
) {

99 
sock‘
 = 
nuÎ
;

107 @
BefÜe


108 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

110 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

111 
p
.
	`£tPrİ”ty
("nÙifiÿtiÚAdd»ss", 
NOTIFICATION_ADDR
);

112 
p
.
	`£tPrİ”ty
("nÙifiÿtiÚPÜt", 
NOTIFICATION_PORT
);

113 
p
.
	`£tPrİ”ty
("şu¡”Name", 
CLUSTER_NAME
);

114 
p
.
	`£tPrİ”ty
("u£rName", 
USER_NAME
);

115 
p
.
	`£tPrİ”ty
("u£r", 
USER_NAME
);

116 
p
.
	`£tPrİ”ty
("·sswÜd", 
PASS
);

117 
p
.
	`£tPrİ”ty
("f›ldcouÁ", 
SŒšg
.
	`v®ueOf
(
FIELD_COUNT
));

118 
p
.
	`£tPrİ”ty
("f›ldËngth", 
FIELD_LENGTH
);

120 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

121 
fš®
 
CÜeWÜklßd
 
wÜklßd
 = 
Ãw
 
	`CÜeWÜklßd
();

122 
wÜklßd
.
	`š™
(
p
);

123 
	`g‘DB
(
p
);

127 
Li¡
<
CŞumnInfo
> 
cŞumnInfoLi¡
 = 
Ãw
 
A¼ayLi¡
<ColumnInfo>();

128 
CŞumnInfo
 
keyInfo
 = 
Ãw
 
	`CŞumnInfo
("key", 
GSTy³
.
STRING
);

129 
cŞumnInfoLi¡
.
	`add
(
keyInfo
);

130 
i
 = 0; i < 
FIELD_COUNT
; i++) {

131 
SŒšg
 
cŞumnName
 = SŒšg.
	`fÜm©
(
VALUE_COLUMN_NAME_PREFIX
 + "%d", 
i
);

132 
CŞumnInfo
 
šfo
 = 
Ãw
 
	`CŞumnInfo
(
cŞumnName
, 
GSTy³
.
STRING
);

133 
cŞumnInfoLi¡
.
	`add
(
šfo
);

135 
cÚš”Info
 = 
Ãw
 
	`CÚš”Info
(
nuÎ
, 
CÚš”Ty³
.
COLLECTION
, 
cŞumnInfoLi¡
, 
Œue
);

137 
Œy
 {

138 
GridStÜeFaùÜy
.
	`g‘In¡ªû
().
	`£tPrİ”t›s
(
p
);

139 
¡Üe
 = 
GridStÜeFaùÜy
.
	`g‘In¡ªû
().
	`g‘GridStÜe
(
p
);

140 
¡Üe
.
	`putCÚš”
(
TEST_TABLE
, 
cÚš”Info
, 
çl£
);

141 } 
	`ÿtch
 (
GSExû±iÚ
 
e
) {

142 
e
.
	`´štSckT¿û
();

143 
throw
 
Ãw
 
	`DBExû±iÚ
();

145 
	}
}

150 
´iv©e
 
	$š£¹ToD©aba£
() {

151 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<String, ByteIterator>();

154 
i
 = 0; i < 
FIELD_COUNT
; i++) {

155 
v®ues
.
	`put
(
VALUE_COLUMN_NAME_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
("value" + i));

157 
myCl›Á
.
	`š£¹
(
TEST_TABLE
, 
DEFAULT_ROW_KEY
, 
v®ues
);

158 
	}
}

160 @
Te¡


161 
public
 
	$‹¡R—dNoExi¡edRow
() {

162 
S‘
<
SŒšg
> 
f›lds
 = 
CŞËùiÚs
.
	`sšgËtÚ
("field0");

164 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

165 
	`š£¹ToD©aba£
();

166 
Stus
 
»adStus
 = 
myCl›Á
.
	`»ad
(
TEST_TABLE
, "Missšg„ow", 
f›lds
, 
»suÉ
);

168 
	`as£¹Equ®s
(
»adStus
, 
Stus
.
ERROR
);

169 
	`as£¹Equ®s
(
»suÉ
.
	`size
(), 0);

170 
	}
}

172 @
Te¡


173 
public
 
	$‹¡R—dSšgËRow
() {

174 
S‘
<
SŒšg
> 
f›lds
 = 
CŞËùiÚs
.
	`sšgËtÚ
("field1");

175 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

176 
	`š£¹ToD©aba£
();

177 
Stus
 
»adStus
 = 
myCl›Á
.
	`»ad
(
TEST_TABLE
, 
DEFAULT_ROW_KEY
, 
f›lds
, 
»suÉ
);

179 
	`as£¹Equ®s
(
»adStus
, 
Stus
.
OK
);

180 
	`as£¹NÙEqu®s
(
»suÉ
.
	`’ŒyS‘
(), 0);

182 
SŒšg
 
key
 : 
f›lds
) {

183 
By‹I‹¿tÜ
 
™”
 = 
»suÉ
.
	`g‘
(
key
);

184 
by‹
[] 
by‹A¼ay1
 = 
™”
.
	`toA¼ay
();

186 
SŒšg
 
v®ue
 = 
Ãw
 
	`SŒšg
(
by‹A¼ay1
);

187 
	`as£¹Equ®s
(
v®ue
, "value1");

189 
	}
}

191 @
Te¡


192 
public
 
	$‹¡R—dAÎ
() {

193 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

194 
	`š£¹ToD©aba£
();

195 
Stus
 
»adStus
 = 
myCl›Á
.
	`»ad
(
TEST_TABLE
, 
DEFAULT_ROW_KEY
, 
nuÎ
, 
»suÉ
);

197 
	`as£¹Equ®s
(
»adStus
, 
Stus
.
OK
);

198 
	`as£¹Equ®s
(
»suÉ
.
	`size
(), 
FIELD_COUNT
);

200 
i
 = 0; i < 
FIELD_COUNT
; i++) {

201 
By‹I‹¿tÜ
 
™”
 = 
»suÉ
.
	`g‘
("f›ld" + 
i
);

202 
by‹
[] 
by‹A¼ay1
 = 
™”
.
	`toA¼ay
();

204 
SŒšg
 
v®ue
 = 
Ãw
 
	`SŒšg
(
by‹A¼ay1
);

205 
	`as£¹Equ®s
(
v®ue
, "v®ue" + 
i
);

207 
	}
}

209 @
Te¡


210 
public
 
	$‹¡Upd©e
() {

211 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

212 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<String, ByteIterator>();

213 
	`š£¹ToD©aba£
();

215 
SŒšg
 
keyFÜUpd©e
 = "field2";

216 
S‘
<
SŒšg
> 
f›lds
 = 
CŞËùiÚs
.
	`sšgËtÚ
(
keyFÜUpd©e
);

218 
SŒšg
 
¡rV®ueToUpd©e
 = "new_value_2";

219 
By‹I‹¿tÜ
 
v®FÜUpd©e
 = 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
¡rV®ueToUpd©e
);

220 
v®ues
.
	`put
(
keyFÜUpd©e
, 
v®FÜUpd©e
);

222 
Stus
 
upd©eStus
 = 
myCl›Á
.
	`upd©e
(
TEST_TABLE
, 
DEFAULT_ROW_KEY
, 
v®ues
);

223 
	`as£¹Equ®s
(
upd©eStus
, 
Stus
.
OK
);

226 
myCl›Á
.
	`»ad
(
TEST_TABLE
, 
DEFAULT_ROW_KEY
, 
f›lds
, 
»suÉ
);

227 
	`as£¹NÙEqu®s
(
»suÉ
.
	`’ŒyS‘
(), 0);

229 
boŞ—n
 
found
 = 
çl£
;

230 
i
 = 0; i < 
FIELD_COUNT
; i++) {

231 
By‹I‹¿tÜ
 
™”
 = 
»suÉ
.
	`g‘
("f›ld" + 
i
);

232 
by‹
[] 
by‹A¼ay1
 = 
™”
.
	`toA¼ay
();

234 
SŒšg
 
v®ue
 = 
Ãw
 
	`SŒšg
(
by‹A¼ay1
);

236 ià(
v®ue
.
	`equ®s
(
¡rV®ueToUpd©e
)) {

237 
found
 = 
Œue
;

240 
	`as£¹Equ®s
(
found
, 
Œue
);

241 
	}
}

243 @
Te¡


244 
public
 
	$‹¡In£¹
() {

245 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<String, ByteIterator>();

246 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

249 
i
 = 0; i < 
FIELD_COUNT
; i++) {

250 
v®ues
.
	`put
("f›ld" + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
("value" + i));

253 
Stus
 
š£¹Stus
 = 
myCl›Á
.
	`š£¹
(
TEST_TABLE
, 
DEFAULT_ROW_KEY
, 
v®ues
);

255 
	`as£¹Equ®s
(
š£¹Stus
, 
Stus
.
OK
);

257 
myCl›Á
.
	`»ad
(
TEST_TABLE
, 
DEFAULT_ROW_KEY
, 
nuÎ
, 
»suÉ
);

259 
	`as£¹Equ®s
(
»suÉ
.
	`size
(), 
FIELD_COUNT
);

261 
i
 = 0; i < 
FIELD_COUNT
; i++) {

262 
By‹I‹¿tÜ
 
™”
 = 
»suÉ
.
	`g‘
("f›ld" + 
i
);

263 
by‹
[] 
by‹A¼ay1
 = 
™”
.
	`toA¼ay
();

265 
SŒšg
 
v®ue
 = 
Ãw
 
	`SŒšg
(
by‹A¼ay1
);

266 
	`as£¹Equ®s
(
v®ue
, "v®ue" + 
i
);

268 
	}
}

270 @
Te¡


271 
public
 
	$‹¡D–‘e
() {

272 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

273 
	`š£¹ToD©aba£
();

275 
Stus
 
d–‘eStus
 = 
myCl›Á
.
	`d–‘e
(
TEST_TABLE
, 
DEFAULT_ROW_KEY
);

276 
	`as£¹Equ®s
(
d–‘eStus
, 
Stus
.
OK
);

278 
Stus
 
»adStus
 = 
myCl›Á
.
	`»ad
(
TEST_TABLE
, 
DEFAULT_ROW_KEY
, 
nuÎ
, 
»suÉ
);

279 
	`as£¹Equ®s
(
»adStus
, 
Stus
.
ERROR
);

280 
	`as£¹Equ®s
(
»suÉ
.
	`size
(), 0);

281 
	}
}

283 @
Te¡


284 
public
 
	$‹¡Combš©iÚ
() {

285 
fš®
 
LOOP_COUNT
 = 3;

286 
i
 = 0; i < 
LOOP_COUNT
; i++) {

287 
	`‹¡R—dNoExi¡edRow
();

288 
	`‹¡R—dSšgËRow
();

289 
	`‹¡R—dAÎ
();

290 
	`‹¡In£¹
();

291 
	`‹¡Upd©e
();

292 
	`‹¡D–‘e
();

294 
	}
}

299 @
Aá”


300 
public
 
	$‹¬Down
() {

301 
Œy
 {

302 
myCl›Á
.
	`ş—nup
();

303 
¡Üe
.
	`drİCÚš”
(
TEST_TABLE
);

304 } 
	`ÿtch
 (
Exû±iÚ
 
”rÜ
) {

306 } 
fš®ly
 {

307 
myCl›Á
 = 
nuÎ
;

309 
	}
}

318 
´Ùeùed
 
DB
 
	$g‘DB
(
Prİ”t›s
 
´İs
) {

319 ifĞ
myCl›Á
 =ğ
nuÎ
 ) {

320 
myCl›Á
 = 
Ãw
 
	`GridDBCl›Á
();

321 
myCl›Á
.
	`£tPrİ”t›s
(
´İs
);

322 
Œy
 {

323 
myCl›Á
.
	`š™
();

324 } 
	`ÿtch
 (
Exû±iÚ
 
”rÜ
) {

325 
	`assumeNoExû±iÚ
(
”rÜ
);

328  
myCl›Á
;

329 
	}
}

	@hbase1/src/main/java/site/ycsb/db/hbase1/HBaseClient1.java

16 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	ghba£1
;

18 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	g£cur™y
.
	gU£rGroupInfÜm©iÚ
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gC–l
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gC–lUt
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gHBa£CÚfigu¿tiÚ
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gTabËName
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gAdmš
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gBufã»dMutÜ
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gBufã»dMutÜP¬ams
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gCÚÃùiÚ
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gCÚÃùiÚFaùÜy
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gD–‘e
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gDu¿b™y
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gG‘
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gPut
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉSÿÂ”
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gSÿn
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gTabË
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gf‹r
.
	gPageF‹r
;

44 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gut
.
	gBy‹s
;

46 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

47 
impÜt
 
	gjava
.
	gut
.
	gCÚcu¼’tModifiÿtiÚExû±iÚ
;

48 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

49 
impÜt
 
	gjava
.
	gut
.
	gM­
;

50 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

51 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

52 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

54 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY
;

55 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY_DEFAULT
;

62 
public
 
şass
 
HBa£Cl›Á1
 
ex‹nds
 
	gs™e
.
	gycsb
.
	gDB
 {

63 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	gTHREAD_COUNT
 = 
Ãw
 AtomicInteger(0);

65 
´iv©e
 
CÚfigu¿tiÚ
 
	gcÚfig
 = 
HBa£CÚfigu¿tiÚ
.
ü—‹
();

67 
´iv©e
 
boŞ—n
 
	gdebug
 = 
çl£
;

69 
´iv©e
 
SŒšg
 
	gbËName
 = "";

78 
´iv©e
 
CÚÃùiÚ
 
	gcÚÃùiÚ
 = 
nuÎ
;

82 
´iv©e
 
TabË
 
	gcu¼’tTabË
 = 
nuÎ
;

83 
´iv©e
 
Bufã»dMutÜ
 
	gbufã»dMutÜ
 = 
nuÎ
;

85 
´iv©e
 
SŒšg
 
	gcŞumnFamy
 = "";

86 
´iv©e
 
	gby‹
[] 
	gcŞumnFamyBy‹s
;

91 
´iv©e
 
Du¿b™y
 
	gdu¿b™y
 = Du¿b™y.
USE_DEFAULT
;

94 
´iv©e
 
boŞ—n
 
	gu£PageF‹r
 = 
Œue
;

101 
´iv©e
 
boŞ—n
 
	gş›ÁSideBufãršg
 = 
çl£
;

102 
´iv©e
 
	gwr™eBufãrSize
 = 1024 * 1024 * 12;

108 @
Ov”ride


109 
public
 
š™
(è
throws
 
	gDBExû±iÚ
 {

111 .
equ®s
(
g‘Prİ”t›s
().
g‘Prİ”ty
("clientbuffering", "false"))) {

112 
	gthis
.
	gş›ÁSideBufãršg
 = 
Œue
;

114 ià(
g‘Prİ”t›s
().
cÚšsKey
("writebuffersize")) {

115 
	gwr™eBufãrSize
 =

116 
LÚg
.
·r£LÚg
(
g‘Prİ”t›s
().
g‘Prİ”ty
("writebuffersize"));

119 ià(
g‘Prİ”t›s
().
g‘Prİ”ty
("du¿b™y"è!ğ
nuÎ
) {

120 
this
.
du¿b™y
 =

121 
Du¿b™y
.
v®ueOf
(
g‘Prİ”t›s
().
g‘Prİ”ty
("durability"));

124 ià("k”b”os".
equ®sIgnÜeCa£
(
cÚfig
.
g‘
("hbase.security.authentication"))) {

125 
	gcÚfig
.
£t
("hadoop.security.authentication", "Kerberos");

126 
	gU£rGroupInfÜm©iÚ
.
£tCÚfigu¿tiÚ
(
cÚfig
);

129 ià((
g‘Prİ”t›s
().
g‘Prİ”ty
("´šc®")!=
nuÎ
)

130 && (
g‘Prİ”t›s
().
g‘Prİ”ty
("keyb")!=
nuÎ
)) {

131 
Œy
 {

132 
U£rGroupInfÜm©iÚ
.
logšU£rFromKeyb
(
g‘Prİ”t›s
().
g‘Prİ”ty
("principal"),

133 
g‘Prİ”t›s
().
g‘Prİ”ty
("keytab"));

134 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

135 
	gSy¡em
.
	g”r
.
´šn
("Keytab file is‚ot„eadable or‚ot found");

136 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

140 
SŒšg
 
	gbË
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

141 
	gŒy
 {

142 
	gTHREAD_COUNT
.
g‘AndInüem’t
();

143 
synchrÚized
 (
THREAD_COUNT
) {

144 ià(
	gcÚÃùiÚ
 =ğ
nuÎ
) {

146 
cÚÃùiÚ
 = 
CÚÃùiÚFaùÜy
.
ü—‹CÚÃùiÚ
(
cÚfig
);

151 
fš®
 
TabËName
 
	gtName
 = TabËName.
v®ueOf
(
bË
);

152 
Œy
 (
Admš
 
admš
 = 
cÚÃùiÚ
.
g‘Admš
()) {

153 ià(!
admš
.
bËExi¡s
(
tName
)) {

154 
throw
 
Ãw
 
DBExû±iÚ
("TabË " + 
tName
 + " does‚otƒxists");

159 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

160 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

163 ià((
g‘Prİ”t›s
().
g‘Prİ”ty
("debug"è!ğ
nuÎ
)

164 && (
g‘Prİ”t›s
().
g‘Prİ”ty
("debug").
com·»To
("true") == 0)) {

165 
debug
 = 
Œue
;

169 .
equ®s
(
g‘Prİ”t›s
().
g‘Prİ”ty
("hbase.usepagefilter", "true"))) {

170 
	gu£PageF‹r
 = 
çl£
;

173 
	gcŞumnFamy
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
("columnfamily");

174 ià(
	gcŞumnFamy
 =ğ
nuÎ
) {

175 
Sy¡em
.
”r
.
´šn
("Error, must specify‡ columnfamily for HBaseable");

176 
throw
 
Ãw
 
DBExû±iÚ
("No columnfamily specified");

178 
	gcŞumnFamyBy‹s
 = 
By‹s
.
toBy‹s
(
cŞumnFamy
);

185 @
Ov”ride


186 
public
 
ş—nup
(è
throws
 
	gDBExû±iÚ
 {

190 
M—su»m’ts
 
	gm—su»m’ts
 = M—su»m’ts.
g‘M—su»m’ts
();

191 
	gŒy
 {

192 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

193 ià(
	gbufã»dMutÜ
 !ğ
nuÎ
) {

194 
bufã»dMutÜ
.
şo£
();

196 ià(
	gcu¼’tTabË
 !ğ
nuÎ
) {

197 
cu¼’tTabË
.
şo£
();

199 
	g’
 = 
Sy¡em
.
ÇnoTime
();

200 
fš®
 
SŒšg
 
	gty³
 = 
ş›ÁSideBufãršg
 ? "UPDATE" : "CLEANUP";

201 
	gm—su»m’ts
.
m—su»
(
ty³
, (è((
’
 - 
¡
) / 1000));

202 
	gth»adCouÁ
 = 
THREAD_COUNT
.
deüem’tAndG‘
();

203 ià(
	gth»adCouÁ
 <= 0) {

205 
synchrÚized
 (
THREAD_COUNT
) {

206 ià(
cÚÃùiÚ
 !ğ
nuÎ
) {

207 
cÚÃùiÚ
.
şo£
();

208 
	gcÚÃùiÚ
 = 
nuÎ
;

212 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

213 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

217 
public
 
g‘HTabË
(
SŒšg
 
bË
è
throws
 
	gIOExû±iÚ
 {

218 
fš®
 
TabËName
 
	gtName
 = TabËName.
v®ueOf
(
bË
);

219 
	gthis
.
	gcu¼’tTabË
 = 
cÚÃùiÚ
.
g‘TabË
(
tName
);

220 ià(
	gş›ÁSideBufãršg
) {

221 
fš®
 
Bufã»dMutÜP¬ams
 
	gp
 = 
Ãw
 Bufã»dMutÜP¬ams(
tName
);

222 
	gp
.
wr™eBufãrSize
(writeBufferSize);

223 
	gthis
.
	gbufã»dMutÜ
 = 
cÚÃùiÚ
.
g‘Bufã»dMutÜ
(
p
);

241 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

242 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

244 ià(!
	gbËName
.
equ®s
(
bË
)) {

245 
	gcu¼’tTabË
 = 
nuÎ
;

246 
	gŒy
 {

247 
g‘HTabË
(
bË
);

248 
	gbËName
 = 
bË
;

249 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

250 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü‡cûssšg HBa£abË: " + 
e
);

251  
	gStus
.
	gERROR
;

255 
ResuÉ
 
	gr
 = 
nuÎ
;

256 
	gŒy
 {

257 ià(
	gdebug
) {

258 
	gSy¡em
.
	gout


259 .
´šn
("Došg„—d from HBa£ cŞumnçmy " + 
cŞumnFamy
);

260 
	gSy¡em
.
	gout
.
´šn
("Došg„—d fÜ key: " + 
key
);

262 
G‘
 
	gg
 = 
Ãw
 G‘(
By‹s
.
toBy‹s
(
key
));

263 ià(
	gf›lds
 =ğ
nuÎ
) {

264 
g
.
addFamy
(
cŞumnFamyBy‹s
);

266 
SŒšg
 
	gf›ld
 : 
f›lds
) {

267 
g
.
addCŞumn
(
cŞumnFamyBy‹s
, 
By‹s
.
toBy‹s
(
f›ld
));

270 
	gr
 = 
cu¼’tTabË
.
g‘
(
g
);

271 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

272 ià(
	gdebug
) {

273 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü došg g‘: " + 
e
);

275  
	gStus
.
	gERROR
;

276 } 
ÿtch
 (
CÚcu¼’tModifiÿtiÚExû±iÚ
 
e
) {

278  
	gStus
.
	gERROR
;

281 ià(
	gr
.
isEm±y
()) {

282  
	gStus
.
	gNOT_FOUND
;

285 
	gr
.
advªû
()) {

286 
fš®
 
C–l
 
	gc
 = 
r
.
cu¼’t
();

287 
	g»suÉ
.
put
(
By‹s
.
toSŒšg
(
C–lUt
.
şÚeQu®if›r
(
c
)),

288 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
C–lUt
.
şÚeV®ue
(
c
)));

289 ià(
	gdebug
) {

290 
	gSy¡em
.
	gout
.
´šn
(

291 "ResuÉ fÜ f›ld: " + 
By‹s
.
toSŒšg
(
C–lUt
.
şÚeQu®if›r
(
c
))

292 + " is: " + 
By‹s
.
toSŒšg
(
C–lUt
.
şÚeV®ue
(
c
)));

295  
	gStus
.
	gOK
;

315 @
Ov”ride


316 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

317 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

319 ià(!
	gbËName
.
equ®s
(
bË
)) {

320 
	gcu¼’tTabË
 = 
nuÎ
;

321 
	gŒy
 {

322 
g‘HTabË
(
bË
);

323 
	gbËName
 = 
bË
;

324 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

325 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü‡cûssšg HBa£abË: " + 
e
);

326  
	gStus
.
	gERROR
;

330 
Sÿn
 
	gs
 = 
Ãw
 Sÿn(
By‹s
.
toBy‹s
(
¡¬tkey
));

334 
	gs
.
£tCachšg
(
»cÜdcouÁ
);

335 ià(
	gthis
.
	gu£PageF‹r
) {

336 
	gs
.
£tF‹r
(
Ãw
 
PageF‹r
(
»cÜdcouÁ
));

340 ià(
	gf›lds
 =ğ
nuÎ
) {

341 
s
.
addFamy
(
cŞumnFamyBy‹s
);

343 
SŒšg
 
	gf›ld
 : 
f›lds
) {

344 
s
.
addCŞumn
(
cŞumnFamyBy‹s
, 
By‹s
.
toBy‹s
(
f›ld
));

349 
ResuÉSÿÂ”
 
	gsÿÂ”
 = 
nuÎ
;

350 
	gŒy
 {

351 
	gsÿÂ”
 = 
cu¼’tTabË
.
g‘SÿÂ”
(
s
);

352 
	gnumResuÉs
 = 0;

353 
ResuÉ
 
	g¼
 = 
sÿÂ”
.
Ãxt
();„¸!ğ
nuÎ
;„r = scanner.next()) {

355 
SŒšg
 
key
 = 
By‹s
.
toSŒšg
(
¼
.
g‘Row
());

357 ià(
	gdebug
) {

358 
	gSy¡em
.
	gout
.
´šn
("GÙ sÿÀ»suÉ fÜ key: " + 
key
);

361 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	growResuÉ
 =

362 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

364 
	g¼
.
advªû
()) {

365 
fš®
 
C–l
 
	gûÎ
 = 
¼
.
cu¼’t
();

366 
	growResuÉ
.
put
(
By‹s
.
toSŒšg
(
C–lUt
.
şÚeQu®if›r
(
ûÎ
)),

367 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
C–lUt
.
şÚeV®ue
(
ûÎ
)));

371 
	g»suÉ
.
add
(
rowResuÉ
);

372 
	gnumResuÉs
++;

377 ià(
	gnumResuÉs
 >ğ
»cÜdcouÁ
) {

381 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

382 ià(
	gdebug
) {

383 
	gSy¡em
.
	gout
.
´šn
("E¼Ü iÀg‘tšg/·rsšg sÿÀ»suÉ: " + 
e
);

385  
	gStus
.
	gERROR
;

386 } 
	gfš®ly
 {

387 ià(
	gsÿÂ”
 !ğ
nuÎ
) {

388 
sÿÂ”
.
şo£
();

392  
	gStus
.
	gOK
;

408 @
Ov”ride


409 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

410 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

412 ià(!
	gbËName
.
equ®s
(
bË
)) {

413 
	gcu¼’tTabË
 = 
nuÎ
;

414 
	gŒy
 {

415 
g‘HTabË
(
bË
);

416 
	gbËName
 = 
bË
;

417 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

418 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü‡cûssšg HBa£abË: " + 
e
);

419  
	gStus
.
	gERROR
;

423 ià(
	gdebug
) {

424 
	gSy¡em
.
	gout
.
´šn
("S‘tšg u°puˆfÜ key: " + 
key
);

426 
Put
 
	gp
 = 
Ãw
 Put(
By‹s
.
toBy‹s
(
key
));

427 
	gp
.
£tDu¿b™y
(
du¿b™y
);

428 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

429 
by‹
[] 
v®ue
 = 
’Œy
.
g‘V®ue
().
toA¼ay
();

430 ià(
	gdebug
) {

431 
	gSy¡em
.
	gout
.
´šn
("Addšg f›ld/v®u" + 
’Œy
.
g‘Key
() + "/"

432 + 
By‹s
.
toSŒšgBš¬y
(
v®ue
) + "o…ut„equest");

434 
	gp
.
addCŞumn
(
cŞumnFamyBy‹s
, 
By‹s
.
toBy‹s
(
’Œy
.
g‘Key
()), 
v®ue
);

437 
	gŒy
 {

438 ià(
	gş›ÁSideBufãršg
) {

440 
	gbufã»dMutÜ
.
mu‹
(
p
);

442 
	gcu¼’tTabË
.
put
(
p
);

444 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

445 ià(
	gdebug
) {

446 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü došg…ut: " + 
e
);

448  
	gStus
.
	gERROR
;

449 } 
ÿtch
 (
CÚcu¼’tModifiÿtiÚExû±iÚ
 
e
) {

451  
	gStus
.
	gERROR
;

454  
	gStus
.
	gOK
;

470 @
Ov”ride


471 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

472 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

473  
upd©e
(
bË
, 
key
, 
v®ues
);

485 @
Ov”ride


486 
public
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

488 ià(!
	gbËName
.
equ®s
(
bË
)) {

489 
	gcu¼’tTabË
 = 
nuÎ
;

490 
	gŒy
 {

491 
g‘HTabË
(
bË
);

492 
	gbËName
 = 
bË
;

493 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

494 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü‡cûssšg HBa£abË: " + 
e
);

495  
	gStus
.
	gERROR
;

499 ià(
	gdebug
) {

500 
	gSy¡em
.
	gout
.
´šn
("Došg d–‘fÜ key: " + 
key
);

503 
fš®
 
D–‘e
 
	gd
 = 
Ãw
 D–‘e(
By‹s
.
toBy‹s
(
key
));

504 
	gd
.
£tDu¿b™y
(
du¿b™y
);

505 
	gŒy
 {

506 ià(
	gş›ÁSideBufãršg
) {

508 
	gbufã»dMutÜ
.
mu‹
(
d
);

510 
	gcu¼’tTabË
.
d–‘e
(
d
);

512 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

513 ià(
	gdebug
) {

514 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü došg d–‘e: " + 
e
);

516  
	gStus
.
	gERROR
;

519  
	gStus
.
	gOK
;

523 
£tCÚfigu¿tiÚ
(
fš®
 
CÚfigu¿tiÚ
 
ÃwCÚfig
) {

524 
	gthis
.
	gcÚfig
 = 
ÃwCÚfig
;

	@hbase1/src/main/java/site/ycsb/db/hbase1/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	ghba£1
;

	@hbase1/src/test/java/site/ycsb/db/hbase1/HBaseClient1Test.java

16 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	ghba£1
;

18 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY_DEFAULT
;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹F®£
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeTrue
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gHBa£Te¡šgUt™y
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gTabËName
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gG‘
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gPut
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gTabË
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gut
.
	gBy‹s
;

40 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

41 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

42 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

43 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

44 
impÜt
 
	gÜg
.
	gjun™
.
	gIgnÜe
;

45 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

47 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

48 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

49 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

50 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

51 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

52 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

57 
public
 cÏs 
	cHBa£Cl›Á1Te¡
 {

59 
´iv©e
 
fš®
 
SŒšg
 
	mCOLUMN_FAMILY
 = "cf";

61 
´iv©e
 
HBa£Te¡šgUt™y
 
	m‹¡šgUt
;

62 
´iv©e
 
HBa£Cl›Á1
 
	mş›Á
;

63 
´iv©e
 
TabË
 
	mbË
 = 
nuÎ
;

64 
´iv©e
 
SŒšg
 
	mbËName
;

66 
´iv©e
 
boŞ—n
 
	$isWšdows
() {

67 
fš®
 
SŒšg
 
os
 = 
Sy¡em
.
	`g‘Prİ”ty
("os.name");

68  
os
.
	`¡¬tsW™h
("Windows");

76 @
BefÜeCÏss


77 
public
 
	$£tUpCÏss
(è
throws
 
Exû±iÚ
 {

80 
	`assumeTrue
(!
	`isWšdows
());

81 
‹¡šgUt
 = 
HBa£Te¡šgUt™y
.
	`ü—‹LoÿlHTU
();

82 
‹¡šgUt
.
	`¡¬tMšiClu¡”
();

83 
	}
}

88 @
Aá”CÏss


89 
public
 
	$‹¬DownCÏss
(è
throws
 
Exû±iÚ
 {

90 ià(
‹¡šgUt
 !ğ
nuÎ
) {

91 
‹¡šgUt
.
	`shutdownMšiClu¡”
();

93 
	}
}

100 @
BefÜe


101 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

102 
ş›Á
 = 
Ãw
 
	`HBa£Cl›Á1
();

103 
ş›Á
.
	`£tCÚfigu¿tiÚ
(
Ãw
 
	`CÚfigu¿tiÚ
(
‹¡šgUt
.
	`g‘CÚfigu¿tiÚ
()));

105 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

106 
p
.
	`£tPrİ”ty
("cŞumnçmy", 
COLUMN_FAMILY
);

108 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

109 
fš®
 
CÜeWÜklßd
 
wÜklßd
 = 
Ãw
 
	`CÜeWÜklßd
();

110 
wÜklßd
.
	`š™
(
p
);

112 
bËName
 = 
p
.
	`g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

113 
bË
 = 
‹¡šgUt
.
	`ü—‹TabË
(
TabËName
.
	`v®ueOf
(
bËName
), 
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
));

115 
ş›Á
.
	`£tPrİ”t›s
(
p
);

116 
ş›Á
.
	`š™
();

117 
	}
}

119 @
Aá”


120 
public
 
	$‹¬Down
(è
throws
 
Exû±iÚ
 {

121 
bË
.
	`şo£
();

122 
‹¡šgUt
.
	`d–‘eTabË
(
bËName
);

123 
	}
}

125 @
Te¡


126 
public
 
	$‹¡R—d
(è
throws
 
Exû±iÚ
 {

127 
fš®
 
SŒšg
 
rowKey
 = "row1";

128 
fš®
 
Put
 
p
 = 
Ãw
 
	`Put
(
By‹s
.
	`toBy‹s
(
rowKey
));

129 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
),

130 
By‹s
.
	`toBy‹s
("column1"), Bytes.toBytes("value1"));

131 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
),

132 
By‹s
.
	`toBy‹s
("column2"), Bytes.toBytes("value2"));

133 
bË
.
	`put
(
p
);

135 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

136 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, 
rowKey
, 
nuÎ
, 
»suÉ
);

137 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

138 
	`as£¹Equ®s
(2, 
»suÉ
.
	`size
());

139 
	`as£¹Equ®s
("v®ue1", 
»suÉ
.
	`g‘
("cŞumn1").
	`toSŒšg
());

140 
	`as£¹Equ®s
("v®ue2", 
»suÉ
.
	`g‘
("cŞumn2").
	`toSŒšg
());

141 
	}
}

143 @
Te¡


144 
public
 
	$‹¡R—dMissšgRow
(è
throws
 
Exû±iÚ
 {

145 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

146 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, "Missšg„ow", 
nuÎ
, 
»suÉ
);

147 
	`as£¹Equ®s
(
Stus
.
NOT_FOUND
, 
¡©us
);

148 
	`as£¹Equ®s
(0, 
»suÉ
.
	`size
());

149 
	}
}

151 @
Te¡


152 
public
 
	$‹¡Sÿn
(è
throws
 
Exû±iÚ
 {

154 
fš®
 
SŒšg
 
cŞSŒ
 = "row_number";

155 
fš®
 
by‹
[] 
cŞ
 = 
By‹s
.
	`toBy‹s
(
cŞSŒ
);

156 
fš®
 
n
 = 10;

157 
fš®
 
Li¡
<
Put
> 
puts
 = 
Ãw
 
A¼ayLi¡
<Put>(
n
);

158 
i
 = 0; i < 
n
; i++) {

159 
fš®
 
by‹
[] 
key
 = 
By‹s
.
	`toBy‹s
(
SŒšg
.
	`fÜm©
("%05d", 
i
));

160 
fš®
 
by‹
[] 
v®ue
 = 
java
.
nio
.
By‹Bufãr
.
	`®loÿ‹
(4).
	`putIÁ
(
i
).
	`¬¿y
();

161 
fš®
 
Put
 
p
 = 
Ãw
 
	`Put
(
key
);

162 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
), 
cŞ
, 
v®ue
);

163 
puts
.
	`add
(
p
);

165 
bË
.
	`put
(
puts
);

168 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
 =

169 
Ãw
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>>();

172 
ş›Á
.
	`sÿn
(
bËName
, "00001", 5, 
nuÎ
, 
»suÉ
);

174 
	`as£¹Equ®s
(5, 
»suÉ
.
	`size
());

175 
i
 = 0; i < 5; i++) {

176 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
row
 = 
»suÉ
.
	`g‘
(
i
);

177 
	`as£¹Equ®s
(1, 
row
.
	`size
());

178 
	`as£¹True
(
row
.
	`cÚšsKey
(
cŞSŒ
));

179 
fš®
 
by‹
[] 
by‹s
 = 
row
.
	`g‘
(
cŞSŒ
).
	`toA¼ay
();

180 
fš®
 
By‹Bufãr
 
buf
 = By‹Bufãr.
	`w¿p
(
by‹s
);

181 
fš®
 
rowNum
 = 
buf
.
	`g‘IÁ
();

182 
	`as£¹Equ®s
(
i
 + 1, 
rowNum
);

184 
	}
}

186 @
Te¡


187 
public
 
	$‹¡Upd©e
(è
throws
 
Exû±iÚ
{

188 
fš®
 
SŒšg
 
key
 = "key";

189 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 HashMap<String, String>();

190 
šput
.
	`put
("column1", "value1");

191 
šput
.
	`put
("column2", "value2");

192 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`š£¹
(
bËName
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

193 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

196 
fš®
 
G‘
 
g‘
 = 
Ãw
 
	`G‘
(
By‹s
.
	`toBy‹s
(
key
));

197 
fš®
 
ResuÉ
 
»suÉ
 = 
this
.
bË
.
	`g‘
(
g‘
);

198 
	`as£¹F®£
(
»suÉ
.
	`isEm±y
());

199 
	`as£¹Equ®s
(2, 
»suÉ
.
	`size
());

200 
fš®
 
java
.
ut
.
M­
.
EÁry
<
SŒšg
, SŒšg> 
’Œy
 : 
šput
.
	`’ŒyS‘
()) {

201 
	`as£¹Equ®s
(
’Œy
.
	`g‘V®ue
(),

202 
Ãw
 
	`SŒšg
(
»suÉ
.
	`g‘V®ue
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
),

203 
By‹s
.
	`toBy‹s
(
’Œy
.
	`g‘Key
()))));

205 
	}
}

207 @
	gTe¡


208 @
IgnÜe
("Not yet implemented")

209 
public
 
	$‹¡D–‘e
() {

210 
	`ç
("Not yet implemented");

211 
	}
}

	@hbase2/src/main/java/site/ycsb/db/hbase2/HBaseClient2.java

16 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	ghba£2
;

18 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gCom·»O³¿tÜ
;

19 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gf‹r
.
	gBš¬yCom·¿tÜ
;

20 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gf‹r
.
	gBy‹A¼ayCom·¿bË
;

21 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gf‹r
.
	gF‹rLi¡
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gf‹r
.
	gV®ueF‹r
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	g£cur™y
.
	gU£rGroupInfÜm©iÚ
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gC–l
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gC–lUt
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gHBa£CÚfigu¿tiÚ
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gTabËName
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gAdmš
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gBufã»dMutÜ
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gBufã»dMutÜP¬ams
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gCÚÃùiÚ
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gCÚÃùiÚFaùÜy
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gD–‘e
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gDu¿b™y
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gG‘
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gPut
;

44 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

45 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉSÿÂ”
;

46 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gSÿn
;

47 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gTabË
;

48 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gf‹r
.
	gPageF‹r
;

49 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gut
.
	gBy‹s
;

51 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

52 
impÜt
 
	gjava
.
	gut
.
	gCÚcu¼’tModifiÿtiÚExû±iÚ
;

53 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

54 
impÜt
 
	gjava
.
	gut
.
	gM­
;

55 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

56 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

57 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

59 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY
;

60 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY_DEFAULT
;

67 
public
 
şass
 
HBa£Cl›Á2
 
ex‹nds
 
	gs™e
.
	gycsb
.
	gDB
 {

68 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	gTHREAD_COUNT
 = 
Ãw
 AtomicInteger(0);

70 
´iv©e
 
CÚfigu¿tiÚ
 
	gcÚfig
 = 
HBa£CÚfigu¿tiÚ
.
ü—‹
();

72 
´iv©e
 
boŞ—n
 
	gdebug
 = 
çl£
;

74 
´iv©e
 
SŒšg
 
	gbËName
 = "";

83 
´iv©e
 
CÚÃùiÚ
 
	gcÚÃùiÚ
 = 
nuÎ
;

87 
´iv©e
 
TabË
 
	gcu¼’tTabË
 = 
nuÎ
;

88 
´iv©e
 
Bufã»dMutÜ
 
	gbufã»dMutÜ
 = 
nuÎ
;

90 
´iv©e
 
SŒšg
 
	gcŞumnFamy
 = "";

91 
´iv©e
 
	gby‹
[] 
	gcŞumnFamyBy‹s
;

96 
´iv©e
 
Du¿b™y
 
	gdu¿b™y
 = Du¿b™y.
USE_DEFAULT
;

99 
´iv©e
 
boŞ—n
 
	gu£PageF‹r
 = 
Œue
;

106 
´iv©e
 
boŞ—n
 
	gş›ÁSideBufãršg
 = 
çl£
;

107 
´iv©e
 
	gwr™eBufãrSize
 = 1024 * 1024 * 12;

112 
´iv©e
 
boŞ—n
 
	gu£SÿnV®ueF‹ršg
 = 
çl£
;

113 
´iv©e
 
Com·»O³¿tÜ
 
	gsÿnF‹rO³¿tÜ
;

114 
´iv©e
 
fš®
 
SŒšg
 
	gDEFAULT_SCAN_FILTER_OPERATOR
 = "less_or_equal";

115 
´iv©e
 
By‹A¼ayCom·¿bË
 
	gsÿnF‹rV®ue
;

116 
´iv©e
 
fš®
 
SŒšg
 
	gDEFAULT_SCAN_FILTER_VALUE
 =

124 @
Ov”ride


125 
public
 
š™
(è
throws
 
	gDBExû±iÚ
 {

127 .
equ®s
(
g‘Prİ”t›s
().
g‘Prİ”ty
("clientbuffering", "false"))) {

128 
	gthis
.
	gş›ÁSideBufãršg
 = 
Œue
;

130 ià(
g‘Prİ”t›s
().
cÚšsKey
("writebuffersize")) {

131 
	gwr™eBufãrSize
 =

132 
LÚg
.
·r£LÚg
(
g‘Prİ”t›s
().
g‘Prİ”ty
("writebuffersize"));

135 ià(
g‘Prİ”t›s
().
g‘Prİ”ty
("du¿b™y"è!ğ
nuÎ
) {

136 
this
.
du¿b™y
 =

137 
Du¿b™y
.
v®ueOf
(
g‘Prİ”t›s
().
g‘Prİ”ty
("durability"));

140 ià("k”b”os".
equ®sIgnÜeCa£
(
cÚfig
.
g‘
("hbase.security.authentication"))) {

141 
	gcÚfig
.
£t
("hadoop.security.authentication", "Kerberos");

142 
	gU£rGroupInfÜm©iÚ
.
£tCÚfigu¿tiÚ
(
cÚfig
);

145 ià((
g‘Prİ”t›s
().
g‘Prİ”ty
("´šc®"è!ğ
nuÎ
)

146 && (
g‘Prİ”t›s
().
g‘Prİ”ty
("keyb"è!ğ
nuÎ
)) {

147 
Œy
 {

148 
U£rGroupInfÜm©iÚ
.
logšU£rFromKeyb
(
g‘Prİ”t›s
().
g‘Prİ”ty
("principal"),

149 
g‘Prİ”t›s
().
g‘Prİ”ty
("keytab"));

150 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

151 
	gSy¡em
.
	g”r
.
´šn
("Keytab file is‚ot„eadable or‚ot found");

152 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

156 
SŒšg
 
	gbË
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

157 
	gŒy
 {

158 
	gTHREAD_COUNT
.
g‘AndInüem’t
();

159 
synchrÚized
 (
THREAD_COUNT
) {

160 ià(
	gcÚÃùiÚ
 =ğ
nuÎ
) {

162 
cÚÃùiÚ
 = 
CÚÃùiÚFaùÜy
.
ü—‹CÚÃùiÚ
(
cÚfig
);

167 
fš®
 
TabËName
 
	gtName
 = TabËName.
v®ueOf
(
bË
);

168 
Œy
 (
Admš
 
admš
 = 
cÚÃùiÚ
.
g‘Admš
()) {

169 ià(!
admš
.
bËExi¡s
(
tName
)) {

170 
throw
 
Ãw
 
DBExû±iÚ
("TabË " + 
tName
 + " does‚otƒxists");

175 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

176 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

179 ià((
g‘Prİ”t›s
().
g‘Prİ”ty
("debug"è!ğ
nuÎ
)

180 && (
g‘Prİ”t›s
().
g‘Prİ”ty
("debug").
com·»To
("true") == 0)) {

181 
debug
 = 
Œue
;

184 
	gu£PageF‹r
 = 
isBoŞ—nP¬amS‘
("hba£.u£·gef‹r", 
u£PageF‹r
);

187 ià(
isBoŞ—nP¬amS‘
("hba£.u£sÿnv®uef‹ršg", 
çl£
)) {

188 
	gu£SÿnV®ueF‹ršg
=
Œue
;

189 
SŒšg
 
	gİ”©Ü
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
("hbase.scanfilteroperator");

190 
	gİ”©Ü
 = 
İ”©Ü
 =ğ
nuÎ
 || o³¿tÜ.
Œim
().
isEm±y
(è? 
DEFAULT_SCAN_FILTER_OPERATOR
 : operator;

191 
	gsÿnF‹rO³¿tÜ
 = 
Com·»O³¿tÜ
.
v®ueOf
(
İ”©Ü
.
toUµ”Ca£
());

192 
SŒšg
 
	gf‹rV®ue
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
("hbase.scanfiltervalue");

193 
	gf‹rV®ue
 = 
f‹rV®ue
 =ğ
nuÎ
 || f‹rV®ue.
Œim
().
isEm±y
(è? 
DEFAULT_SCAN_FILTER_VALUE
 : filterValue;

194 
	gsÿnF‹rV®ue
 = 
Ãw
 
Bš¬yCom·¿tÜ
(
By‹s
.
äomHex
(
f‹rV®ue
));

197 
	gcŞumnFamy
 = 
g‘Prİ”t›s
().
g‘Prİ”ty
("columnfamily");

198 ià(
	gcŞumnFamy
 =ğ
nuÎ
) {

199 
Sy¡em
.
”r
.
´šn
("Error, must specify‡ columnfamily for HBaseable");

200 
throw
 
Ãw
 
DBExû±iÚ
("No columnfamily specified");

202 
	gcŞumnFamyBy‹s
 = 
By‹s
.
toBy‹s
(
cŞumnFamy
);

209 @
Ov”ride


210 
public
 
ş—nup
(è
throws
 
	gDBExû±iÚ
 {

214 
M—su»m’ts
 
	gm—su»m’ts
 = M—su»m’ts.
g‘M—su»m’ts
();

215 
	gŒy
 {

216 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

217 ià(
	gbufã»dMutÜ
 !ğ
nuÎ
) {

218 
bufã»dMutÜ
.
şo£
();

220 ià(
	gcu¼’tTabË
 !ğ
nuÎ
) {

221 
cu¼’tTabË
.
şo£
();

223 
	g’
 = 
Sy¡em
.
ÇnoTime
();

224 
fš®
 
SŒšg
 
	gty³
 = 
ş›ÁSideBufãršg
 ? "UPDATE" : "CLEANUP";

225 
	gm—su»m’ts
.
m—su»
(
ty³
, (è((
’
 - 
¡
) / 1000));

226 
	gth»adCouÁ
 = 
THREAD_COUNT
.
deüem’tAndG‘
();

227 ià(
	gth»adCouÁ
 <= 0) {

229 
synchrÚized
 (
THREAD_COUNT
) {

230 ià(
cÚÃùiÚ
 !ğ
nuÎ
) {

231 
cÚÃùiÚ
.
şo£
();

232 
	gcÚÃùiÚ
 = 
nuÎ
;

236 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

237 
throw
 
Ãw
 
DBExû±iÚ
(
e
);

241 
public
 
g‘HTabË
(
SŒšg
 
bË
è
throws
 
	gIOExû±iÚ
 {

242 
fš®
 
TabËName
 
	gtName
 = TabËName.
v®ueOf
(
bË
);

243 
	gthis
.
	gcu¼’tTabË
 = 
cÚÃùiÚ
.
g‘TabË
(
tName
);

244 ià(
	gş›ÁSideBufãršg
) {

245 
fš®
 
Bufã»dMutÜP¬ams
 
	gp
 = 
Ãw
 Bufã»dMutÜP¬ams(
tName
);

246 
	gp
.
wr™eBufãrSize
(writeBufferSize);

247 
	gthis
.
	gbufã»dMutÜ
 = 
cÚÃùiÚ
.
g‘Bufã»dMutÜ
(
p
);

265 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

266 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

268 ià(!
	gbËName
.
equ®s
(
bË
)) {

269 
	gcu¼’tTabË
 = 
nuÎ
;

270 
	gŒy
 {

271 
g‘HTabË
(
bË
);

272 
	gbËName
 = 
bË
;

273 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

274 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü‡cûssšg HBa£abË: " + 
e
);

275  
	gStus
.
	gERROR
;

279 
ResuÉ
 
	gr
 = 
nuÎ
;

280 
	gŒy
 {

281 ià(
	gdebug
) {

282 
	gSy¡em
.
	gout


283 .
´šn
("Došg„—d from HBa£ cŞumnçmy " + 
cŞumnFamy
);

284 
	gSy¡em
.
	gout
.
´šn
("Došg„—d fÜ key: " + 
key
);

286 
G‘
 
	gg
 = 
Ãw
 G‘(
By‹s
.
toBy‹s
(
key
));

287 ià(
	gf›lds
 =ğ
nuÎ
) {

288 
g
.
addFamy
(
cŞumnFamyBy‹s
);

290 
SŒšg
 
	gf›ld
 : 
f›lds
) {

291 
g
.
addCŞumn
(
cŞumnFamyBy‹s
, 
By‹s
.
toBy‹s
(
f›ld
));

294 
	gr
 = 
cu¼’tTabË
.
g‘
(
g
);

295 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

296 ià(
	gdebug
) {

297 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü došg g‘: " + 
e
);

299  
	gStus
.
	gERROR
;

300 } 
ÿtch
 (
CÚcu¼’tModifiÿtiÚExû±iÚ
 
e
) {

302  
	gStus
.
	gERROR
;

305 ià(
	gr
.
isEm±y
()) {

306  
	gStus
.
	gNOT_FOUND
;

309 
	gr
.
advªû
()) {

310 
fš®
 
C–l
 
	gc
 = 
r
.
cu¼’t
();

311 
	g»suÉ
.
put
(
By‹s
.
toSŒšg
(
C–lUt
.
şÚeQu®if›r
(
c
)),

312 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
C–lUt
.
şÚeV®ue
(
c
)));

313 ià(
	gdebug
) {

314 
	gSy¡em
.
	gout
.
´šn
(

315 "ResuÉ fÜ f›ld: " + 
By‹s
.
toSŒšg
(
C–lUt
.
şÚeQu®if›r
(
c
))

316 + " is: " + 
By‹s
.
toSŒšg
(
C–lUt
.
şÚeV®ue
(
c
)));

319  
	gStus
.
	gOK
;

339 @
Ov”ride


340 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

341 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

343 ià(!
	gbËName
.
equ®s
(
bË
)) {

344 
	gcu¼’tTabË
 = 
nuÎ
;

345 
	gŒy
 {

346 
g‘HTabË
(
bË
);

347 
	gbËName
 = 
bË
;

348 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

349 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü‡cûssšg HBa£abË: " + 
e
);

350  
	gStus
.
	gERROR
;

354 
Sÿn
 
	gs
 = 
Ãw
 Sÿn(
By‹s
.
toBy‹s
(
¡¬tkey
));

358 
F‹rLi¡
 
	gf‹rLi¡
 = 
Ãw
 F‹rLi¡(F‹rLi¡.
O³¿tÜ
.
MUST_PASS_ALL
);

360 
	gs
.
£tCachšg
(
»cÜdcouÁ
);

361 ià(
	gthis
.
	gu£PageF‹r
) {

362 
	gf‹rLi¡
.
addF‹r
(
Ãw
 
PageF‹r
(
»cÜdcouÁ
));

366 ià(
	gf›lds
 =ğ
nuÎ
) {

367 
s
.
addFamy
(
cŞumnFamyBy‹s
);

369 
SŒšg
 
	gf›ld
 : 
f›lds
) {

370 
s
.
addCŞumn
(
cŞumnFamyBy‹s
, 
By‹s
.
toBy‹s
(
f›ld
));

375 ià(
	gu£SÿnV®ueF‹ršg
){

376 
	gf‹rLi¡
.
addF‹r
(
Ãw
 
V®ueF‹r
(
sÿnF‹rO³¿tÜ
, 
sÿnF‹rV®ue
));

379 
	gs
.
£tF‹r
(
f‹rLi¡
);

382 
ResuÉSÿÂ”
 
	gsÿÂ”
 = 
nuÎ
;

383 
	gŒy
 {

384 
	gsÿÂ”
 = 
cu¼’tTabË
.
g‘SÿÂ”
(
s
);

385 
	gnumResuÉs
 = 0;

386 
ResuÉ
 
	g¼
 = 
sÿÂ”
.
Ãxt
();„¸!ğ
nuÎ
;„r = scanner.next()) {

388 
SŒšg
 
key
 = 
By‹s
.
toSŒšg
(
¼
.
g‘Row
());

390 ià(
	gdebug
) {

391 
	gSy¡em
.
	gout
.
´šn
("GÙ sÿÀ»suÉ fÜ key: " + 
key
);

394 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	growResuÉ
 =

395 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

397 
	g¼
.
advªû
()) {

398 
fš®
 
C–l
 
	gûÎ
 = 
¼
.
cu¼’t
();

399 
	growResuÉ
.
put
(
By‹s
.
toSŒšg
(
C–lUt
.
şÚeQu®if›r
(
ûÎ
)),

400 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
C–lUt
.
şÚeV®ue
(
ûÎ
)));

404 
	g»suÉ
.
add
(
rowResuÉ
);

405 
	gnumResuÉs
++;

410 ià(
	gnumResuÉs
 >ğ
»cÜdcouÁ
) {

414 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

415 ià(
	gdebug
) {

416 
	gSy¡em
.
	gout
.
´šn
("E¼Ü iÀg‘tšg/·rsšg sÿÀ»suÉ: " + 
e
);

418  
	gStus
.
	gERROR
;

419 } 
	gfš®ly
 {

420 ià(
	gsÿÂ”
 !ğ
nuÎ
) {

421 
sÿÂ”
.
şo£
();

425  
	gStus
.
	gOK
;

441 @
Ov”ride


442 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

443 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

445 ià(!
	gbËName
.
equ®s
(
bË
)) {

446 
	gcu¼’tTabË
 = 
nuÎ
;

447 
	gŒy
 {

448 
g‘HTabË
(
bË
);

449 
	gbËName
 = 
bË
;

450 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

451 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü‡cûssšg HBa£abË: " + 
e
);

452  
	gStus
.
	gERROR
;

456 ià(
	gdebug
) {

457 
	gSy¡em
.
	gout
.
´šn
("S‘tšg u°puˆfÜ key: " + 
key
);

459 
Put
 
	gp
 = 
Ãw
 Put(
By‹s
.
toBy‹s
(
key
));

460 
	gp
.
£tDu¿b™y
(
du¿b™y
);

461 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

462 
by‹
[] 
v®ue
 = 
’Œy
.
g‘V®ue
().
toA¼ay
();

463 ià(
	gdebug
) {

464 
	gSy¡em
.
	gout
.
´šn
("Addšg f›ld/v®u" + 
’Œy
.
g‘Key
() + "/"

465 + 
By‹s
.
toSŒšgBš¬y
(
v®ue
) + "o…ut„equest");

467 
	gp
.
addCŞumn
(
cŞumnFamyBy‹s
, 
By‹s
.
toBy‹s
(
’Œy
.
g‘Key
()), 
v®ue
);

470 
	gŒy
 {

471 ià(
	gş›ÁSideBufãršg
) {

473 
	gbufã»dMutÜ
.
mu‹
(
p
);

475 
	gcu¼’tTabË
.
put
(
p
);

477 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

478 ià(
	gdebug
) {

479 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü došg…ut: " + 
e
);

481  
	gStus
.
	gERROR
;

482 } 
ÿtch
 (
CÚcu¼’tModifiÿtiÚExû±iÚ
 
e
) {

484  
	gStus
.
	gERROR
;

487  
	gStus
.
	gOK
;

503 @
Ov”ride


504 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

505 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

506  
upd©e
(
bË
, 
key
, 
v®ues
);

518 @
Ov”ride


519 
public
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

521 ià(!
	gbËName
.
equ®s
(
bË
)) {

522 
	gcu¼’tTabË
 = 
nuÎ
;

523 
	gŒy
 {

524 
g‘HTabË
(
bË
);

525 
	gbËName
 = 
bË
;

526 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

527 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü‡cûssšg HBa£abË: " + 
e
);

528  
	gStus
.
	gERROR
;

532 ià(
	gdebug
) {

533 
	gSy¡em
.
	gout
.
´šn
("Došg d–‘fÜ key: " + 
key
);

536 
fš®
 
D–‘e
 
	gd
 = 
Ãw
 D–‘e(
By‹s
.
toBy‹s
(
key
));

537 
	gd
.
£tDu¿b™y
(
du¿b™y
);

538 
	gŒy
 {

539 ià(
	gş›ÁSideBufãršg
) {

541 
	gbufã»dMutÜ
.
mu‹
(
d
);

543 
	gcu¼’tTabË
.
d–‘e
(
d
);

545 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

546 ià(
	gdebug
) {

547 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü došg d–‘e: " + 
e
);

549  
	gStus
.
	gERROR
;

552  
	gStus
.
	gOK
;

556 
£tCÚfigu¿tiÚ
(
fš®
 
CÚfigu¿tiÚ
 
ÃwCÚfig
) {

557 
	gthis
.
	gcÚfig
 = 
ÃwCÚfig
;

560 
´iv©e
 
boŞ—n
 
isBoŞ—nP¬amS‘
(
SŒšg
 
·¿m
, boŞ—À
deçuÉV®ue
){

561  
	gBoŞ—n
.
·r£BoŞ—n
(
g‘Prİ”t›s
().
g‘Prİ”ty
(
·¿m
, 
BoŞ—n
.
toSŒšg
(
deçuÉV®ue
)));

	@hbase2/src/main/java/site/ycsb/db/hbase2/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	ghba£2
;

	@hbase2/src/test/java/site/ycsb/db/hbase2/HBaseClient2Test.java

16 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	ghba£2
;

18 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹A¼ayEqu®s
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY_DEFAULT
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹F®£
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeTrue
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gHBa£Te¡šgUt™y
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gTabËName
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gG‘
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gPut
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gTabË
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gut
.
	gBy‹s
;

41 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

42 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

43 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

44 
impÜt
 
	gÜg
.
	gjun™
.
	gIgnÜe
;

45 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

47 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

48 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

49 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

50 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

51 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

52 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

53 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

58 
public
 cÏs 
	cHBa£Cl›Á2Te¡
 {

60 
´iv©e
 
fš®
 
SŒšg
 
	mCOLUMN_FAMILY
 = "cf";

62 
´iv©e
 
HBa£Te¡šgUt™y
 
	m‹¡šgUt
;

63 
´iv©e
 
HBa£Cl›Á2
 
	mş›Á
;

64 
´iv©e
 
TabË
 
	mbË
 = 
nuÎ
;

65 
´iv©e
 
SŒšg
 
	mbËName
;

67 
´iv©e
 
boŞ—n
 
	$isWšdows
() {

68 
fš®
 
SŒšg
 
os
 = 
Sy¡em
.
	`g‘Prİ”ty
("os.name");

69  
os
.
	`¡¬tsW™h
("Windows");

76 @
BefÜeCÏss


77 
public
 
	$£tUpCÏss
(è
throws
 
Exû±iÚ
 {

80 
	`assumeTrue
(!
	`isWšdows
());

81 
‹¡šgUt
 = 
HBa£Te¡šgUt™y
.
	`ü—‹LoÿlHTU
();

82 
‹¡šgUt
.
	`¡¬tMšiClu¡”
();

83 
	}
}

88 @
Aá”CÏss


89 
public
 
	$‹¬DownCÏss
(è
throws
 
Exû±iÚ
 {

90 ià(
‹¡šgUt
 !ğ
nuÎ
) {

91 
‹¡šgUt
.
	`shutdownMšiClu¡”
();

93 
	}
}

98 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

99 
	`£tUp
(
Ãw
 
	`Prİ”t›s
());

100 
	}
}

105 
public
 
	$£tUp
(
Prİ”t›s
 
p
è
throws
 
Exû±iÚ
 {

106 
ş›Á
 = 
Ãw
 
	`HBa£Cl›Á2
();

107 
ş›Á
.
	`£tCÚfigu¿tiÚ
(
Ãw
 
	`CÚfigu¿tiÚ
(
‹¡šgUt
.
	`g‘CÚfigu¿tiÚ
()));

109 
p
.
	`£tPrİ”ty
("cŞumnçmy", 
COLUMN_FAMILY
);

111 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

112 
fš®
 
CÜeWÜklßd
 
wÜklßd
 = 
Ãw
 
	`CÜeWÜklßd
();

113 
wÜklßd
.
	`š™
(
p
);

115 
bËName
 = 
p
.
	`g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

116 
bË
 = 
‹¡šgUt
.
	`ü—‹TabË
(
TabËName
.
	`v®ueOf
(
bËName
), 
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
));

118 
ş›Á
.
	`£tPrİ”t›s
(
p
);

119 
ş›Á
.
	`š™
();

120 
	}
}

122 @
Aá”


123 
public
 
	$‹¬Down
(è
throws
 
Exû±iÚ
 {

124 
bË
.
	`şo£
();

125 
‹¡šgUt
.
	`d–‘eTabË
(
TabËName
.
	`v®ueOf
(
bËName
));

126 
	}
}

128 @
Te¡


129 
public
 
	$‹¡R—d
(è
throws
 
Exû±iÚ
 {

130 
	`£tUp
();

131 
fš®
 
SŒšg
 
rowKey
 = "row1";

132 
fš®
 
Put
 
p
 = 
Ãw
 
	`Put
(
By‹s
.
	`toBy‹s
(
rowKey
));

133 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
),

134 
By‹s
.
	`toBy‹s
("column1"), Bytes.toBytes("value1"));

135 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
),

136 
By‹s
.
	`toBy‹s
("column2"), Bytes.toBytes("value2"));

137 
bË
.
	`put
(
p
);

139 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

140 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, 
rowKey
, 
nuÎ
, 
»suÉ
);

141 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

142 
	`as£¹Equ®s
(2, 
»suÉ
.
	`size
());

143 
	`as£¹Equ®s
("v®ue1", 
»suÉ
.
	`g‘
("cŞumn1").
	`toSŒšg
());

144 
	`as£¹Equ®s
("v®ue2", 
»suÉ
.
	`g‘
("cŞumn2").
	`toSŒšg
());

145 
	}
}

147 @
Te¡


148 
public
 
	$‹¡R—dMissšgRow
(è
throws
 
Exû±iÚ
 {

149 
	`£tUp
();

150 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

151 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, "Missšg„ow", 
nuÎ
, 
»suÉ
);

152 
	`as£¹Equ®s
(
Stus
.
NOT_FOUND
, 
¡©us
);

153 
	`as£¹Equ®s
(0, 
»suÉ
.
	`size
());

154 
	}
}

156 @
Te¡


157 
public
 
	$‹¡Sÿn
(è
throws
 
Exû±iÚ
 {

158 
	`£tUp
();

160 
fš®
 
SŒšg
 
cŞSŒ
 = "row_number";

161 
fš®
 
by‹
[] 
cŞ
 = 
By‹s
.
	`toBy‹s
(
cŞSŒ
);

162 
fš®
 
n
 = 10;

163 
fš®
 
Li¡
<
Put
> 
puts
 = 
Ãw
 
A¼ayLi¡
<Put>(
n
);

164 
i
 = 0; i < 
n
; i++) {

165 
fš®
 
by‹
[] 
key
 = 
By‹s
.
	`toBy‹s
(
SŒšg
.
	`fÜm©
("%05d", 
i
));

166 
fš®
 
by‹
[] 
v®ue
 = 
java
.
nio
.
By‹Bufãr
.
	`®loÿ‹
(4).
	`putIÁ
(
i
).
	`¬¿y
();

167 
fš®
 
Put
 
p
 = 
Ãw
 
	`Put
(
key
);

168 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
), 
cŞ
, 
v®ue
);

169 
puts
.
	`add
(
p
);

171 
bË
.
	`put
(
puts
);

174 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
 =

175 
Ãw
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>>();

178 
ş›Á
.
	`sÿn
(
bËName
, "00001", 5, 
nuÎ
, 
»suÉ
);

180 
	`as£¹Equ®s
(5, 
»suÉ
.
	`size
());

181 
i
 = 0; i < 5; i++) {

182 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
row
 = 
»suÉ
.
	`g‘
(
i
);

183 
	`as£¹Equ®s
(1, 
row
.
	`size
());

184 
	`as£¹True
(
row
.
	`cÚšsKey
(
cŞSŒ
));

185 
fš®
 
by‹
[] 
by‹s
 = 
row
.
	`g‘
(
cŞSŒ
).
	`toA¼ay
();

186 
fš®
 
By‹Bufãr
 
buf
 = By‹Bufãr.
	`w¿p
(
by‹s
);

187 
fš®
 
rowNum
 = 
buf
.
	`g‘IÁ
();

188 
	`as£¹Equ®s
(
i
 + 1, 
rowNum
);

190 
	}
}

192 @
Te¡


193 
public
 
	$‹¡SÿnW™hV®ueF‹ršgUsšgDeçuÉPrİ”t›s
(è
throws
 
Exû±iÚ
 {

194 
	`‹¡SÿnW™hV®ueF‹ršg
(
nuÎ
,‚uÎ, 100, 
Ãw
 
by‹
[][] {

195 
By‹s
.
	`äomHex
("0000"), Bytes.fromHex("1111"), Bytes.fromHex("2222"), Bytes.fromHex("3333"),

196 
By‹s
.
	`äomHex
("4444"), Bytes.fromHex("5555"), Bytes.fromHex("6666"), Bytes.fromHex("7777"),

198 
	}
}

200 @
Te¡


201 
public
 
	$‹¡SÿnW™hV®ueF‹ršgO³¿tiÚLessOrEqu®
(è
throws
 
Exû±iÚ
 {

202 
	`‹¡SÿnW™hV®ueF‹ršg
("Ëss_Ü_equ®", "3333", 100, 
Ãw
 
by‹
[][] {

203 
By‹s
.
	`äomHex
("0000"), Bytes.fromHex("1111"), Bytes.fromHex("2222"), Bytes.fromHex("3333"),

205 
	}
}

207 @
Te¡


208 
public
 
	$‹¡SÿnW™hV®ueF‹ršgO³¿tiÚEqu®
(è
throws
 
Exû±iÚ
 {

209 
	`‹¡SÿnW™hV®ueF‹ršg
("equ®", "AAAA", 100, 
Ãw
 
by‹
[][]{

210 
By‹s
.
	`äomHex
("AAAA")

212 
	}
}

214 @
Te¡


215 
public
 
	$‹¡SÿnW™hV®ueF‹ršgO³¿tiÚNÙEqu®
(è
throws
 
Exû±iÚ
 {

216 
	`‹¡SÿnW™hV®ueF‹ršg
("nÙ_equ®", "AAAA", 100 , 
Ãw
 
by‹
[][]{

217 
By‹s
.
	`äomHex
("0000"), Bytes.fromHex("1111"), Bytes.fromHex("2222"), Bytes.fromHex("3333"),

218 
By‹s
.
	`äomHex
("4444"), Bytes.fromHex("5555"), Bytes.fromHex("6666"), Bytes.fromHex("7777"),

219 
By‹s
.
	`äomHex
("8888"), Bytes.fromHex("9999"), Bytes.fromHex("BBBB"),

220 
By‹s
.
	`äomHex
("CCCC"), Bytes.fromHex("DDDD"), Bytes.fromHex("EEEE"), Bytes.fromHex("FFFF")

222 
	}
}

224 @
Te¡


225 
public
 
	$‹¡SÿnW™hV®ueF‹ršgAndRowLim™
(è
throws
 
Exû±iÚ
 {

226 
	`‹¡SÿnW™hV®ueF‹ršg
("g»©”", "8887", 3, 
Ãw
 
by‹
[][] {

227 
By‹s
.
	`äomHex
("8888"), Bytes.fromHex("9999"), Bytes.fromHex("AAAA")

229 
	}
}

231 @
Te¡


232 
public
 
	$‹¡Upd©e
(è
throws
 
Exû±iÚ
{

233 
	`£tUp
();

234 
fš®
 
SŒšg
 
key
 = "key";

235 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 HashMap<String, String>();

236 
šput
.
	`put
("column1", "value1");

237 
šput
.
	`put
("column2", "value2");

238 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`š£¹
(
bËName
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

239 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

242 
fš®
 
G‘
 
g‘
 = 
Ãw
 
	`G‘
(
By‹s
.
	`toBy‹s
(
key
));

243 
fš®
 
ResuÉ
 
»suÉ
 = 
this
.
bË
.
	`g‘
(
g‘
);

244 
	`as£¹F®£
(
»suÉ
.
	`isEm±y
());

245 
	`as£¹Equ®s
(2, 
»suÉ
.
	`size
());

246 
fš®
 
java
.
ut
.
M­
.
EÁry
<
SŒšg
, SŒšg> 
’Œy
 : 
šput
.
	`’ŒyS‘
()) {

247 
	`as£¹Equ®s
(
’Œy
.
	`g‘V®ue
(),

248 
Ãw
 
	`SŒšg
(
»suÉ
.
	`g‘V®ue
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
),

249 
By‹s
.
	`toBy‹s
(
’Œy
.
	`g‘Key
()))));

251 
	}
}

253 @
	gTe¡


254 @
IgnÜe
("Not yet implemented")

255 
public
 
	$‹¡D–‘e
() {

256 
	`ç
("Not yet implemented");

257 
	}
}

259 
´iv©e
 
	$‹¡SÿnW™hV®ueF‹ršg
(
SŒšg
 
İ”©iÚ
, SŒšg 
f‹rV®ue
, 
sÿnRowLim™
,

260 
by‹
[][] 
ex³ùedV®uesR‘uºed
è
throws
 
Exû±iÚ
 {

261 
Prİ”t›s
 
´İ”t›s
 = 
Ãw
 
	`Prİ”t›s
();

262 
´İ”t›s
.
	`£tPrİ”ty
("hba£.u£sÿnv®uef‹ršg", 
SŒšg
.
	`v®ueOf
(
Œue
));

263 if(
İ”©iÚ
 !ğ
nuÎ
) {

264 
´İ”t›s
.
	`£tPrİ”ty
("hba£.sÿnf‹rİ”©Ü", 
İ”©iÚ
);

266 if(
f‹rV®ue
 !ğ
nuÎ
) {

267 
´İ”t›s
.
	`£tPrİ”ty
("hba£.sÿnf‹rv®ue", 
f‹rV®ue
);

271 
	`£tUp
(
´İ”t›s
);

272 
	`£tupTabËCŞumnW™hHexV®ues
("col_1");

273 
	`£tupTabËCŞumnW™hHexV®ues
("col_2");

275 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
 = 
Ãw
 Vector<>();

278 
ş›Á
.
	`sÿn
(
bËName
, "00000", 
sÿnRowLim™
, 
nuÎ
, 
»suÉ
);

280 
	`as£¹Equ®s
(
ex³ùedV®uesR‘uºed
.
Ëngth
, 
»suÉ
.
	`size
());

281 
i
 = 0; i < 
ex³ùedV®uesR‘uºed
.
Ëngth
; i++) {

282 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
row
 = 
»suÉ
.
	`g‘
(
i
);

283 
	`as£¹Equ®s
(2, 
row
.
	`size
());

284 
	`as£¹True
(
row
.
	`cÚšsKey
("col_1") &&„ow.containsKey("col_2"));

285 
	`as£¹A¼ayEqu®s
(
ex³ùedV®uesR‘uºed
[
i
], 
row
.
	`g‘
("cŞ_1").
	`toA¼ay
());

286 
	`as£¹A¼ayEqu®s
(
ex³ùedV®uesR‘uºed
[
i
], 
row
.
	`g‘
("cŞ_2").
	`toA¼ay
());

290 
»suÉ
 = 
Ãw
 
VeùÜ
<>();

291 
ş›Á
.
	`sÿn
(
bËName
, "00000", 
sÿnRowLim™
, 
CŞËùiÚs
.
	`sšgËtÚ
("cŞ_1"), 
»suÉ
);

293 
	`as£¹Equ®s
(
ex³ùedV®uesR‘uºed
.
Ëngth
, 
»suÉ
.
	`size
());

294 
i
 = 0; i < 
ex³ùedV®uesR‘uºed
.
Ëngth
; i++) {

295 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
row
 = 
»suÉ
.
	`g‘
(
i
);

296 
	`as£¹Equ®s
(1, 
row
.
	`size
());

297 
	`as£¹True
(
row
.
	`cÚšsKey
("col_1"));

298 
	`as£¹A¼ayEqu®s
(
ex³ùedV®uesR‘uºed
[
i
], 
row
.
	`g‘
("cŞ_1").
	`toA¼ay
());

300 
	}
}

302 
´iv©e
 
	$£tupTabËCŞumnW™hHexV®ues
(
SŒšg
 
cŞSŒ
è
throws
 
Exû±iÚ
 {

303 
fš®
 
by‹
[] 
cŞ
 = 
By‹s
.
	`toBy‹s
(
cŞSŒ
);

304 
fš®
 
by‹
[][] 
v®ues
 = {

305 
By‹s
.
	`äomHex
("0000"), Bytes.fromHex("1111"), Bytes.fromHex("2222"), Bytes.fromHex("3333"),

306 
By‹s
.
	`äomHex
("4444"), Bytes.fromHex("5555"), Bytes.fromHex("6666"), Bytes.fromHex("7777"),

307 
By‹s
.
	`äomHex
("8888"), Bytes.fromHex("9999"), Bytes.fromHex("AAAA"), Bytes.fromHex("BBBB"),

308 
By‹s
.
	`äomHex
("CCCC"), Bytes.fromHex("DDDD"), Bytes.fromHex("EEEE"), Bytes.fromHex("FFFF")

310 
fš®
 
Li¡
<
Put
> 
puts
 = 
Ãw
 
A¼ayLi¡
<>(16);

311 
i
 = 0; i < 16; i++) {

312 
fš®
 
by‹
[] 
key
 = 
By‹s
.
	`toBy‹s
(
SŒšg
.
	`fÜm©
("%05d", 
i
));

313 
fš®
 
by‹
[] 
v®ue
 = 
v®ues
[
i
];

314 
fš®
 
Put
 
p
 = 
Ãw
 
	`Put
(
key
);

315 
p
.
	`addCŞumn
(
By‹s
.
	`toBy‹s
(
COLUMN_FAMILY
), 
cŞ
, 
v®ue
);

316 
puts
.
	`add
(
p
);

318 
bË
.
	`put
(
puts
);

319 
	}
}

	@ignite/src/main/java/site/ycsb/db/ignite/IgniteAbstractClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gign™e
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

24 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

25 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gLškedHashS‘
;

27 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

28 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gIgn™eCheckedExû±iÚ
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	glogg”
.
	glog4j2
.
	gLog4J2Logg”
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gIgn™e
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gIgn™eCache
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gIgn™iÚ
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gbš¬y
.
	gBš¬yObjeù
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gcÚfigu¿tiÚ
.
	gIgn™eCÚfigu¿tiÚ
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	g¥i
.
	gdiscov”y
.
	gtı
.
	gTıDiscov”ySpi
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	g¥i
.
	gdiscov”y
.
	gtı
.
	gfšd”
.
	gTıDiscov”yIpFšd”
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	g¥i
.
	gdiscov”y
.
	gtı
.
	gfšd”
.
	gvm
.
	gTıDiscov”yVmIpFšd”
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	gloggšg
.
	glog4j
.
	gLogMªag”
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	gloggšg
.
	glog4j
.
	gLogg”
;

48 
public
 
ab¡¿ù
 cÏs 
	cIgn™eAb¡¿ùCl›Á
 
ex‹nds
 
	mDB
 {

50 
´Ùeùed
 
Logg”
 
	mlog
 = 
LogMªag”
.
g‘Logg”
(
Ign™eAb¡¿ùCl›Á
.
şass
);

52 
´Ùeùed
 
fš®
 
SŒšg
 
	mDEFAULT_CACHE_NAME
 = "usertable";

53 
´Ùeùed
 
fš®
 
SŒšg
 
	mHOSTS_PROPERTY
 = "hosts";

54 
´Ùeùed
 
fš®
 
SŒšg
 
	mPORTS_PROPERTY
 = "ports";

55 
´Ùeùed
 
fš®
 
SŒšg
 
	mCLIENT_NODE_NAME
 = "YCSB client‚ode";

56 
´Ùeùed
 
fš®
 
SŒšg
 
	mPORTS_DEFAULTS
 = "47500..47509";

62 
´Ùeùed
 
fš®
 
AtomicIÁeg”
 
	mINIT_COUNT
 = 
Ãw
 AtomicInteger(0);

64 
´Ùeùed
 
Ign™e
 
	mşu¡”
 = 
nuÎ
;

66 
´Ùeùed
 
	mIgn™eCache
<
	mSŒšg
, 
	mBš¬yObjeù
> 
	mÿche
 = 
nuÎ
;

68 
´Ùeùed
 
boŞ—n
 
	mdebug
 = 
çl£
;

70 
´Ùeùed
 
TıDiscov”yIpFšd”
 
	mFšd”
 = 
Ãw
 
TıDiscov”yVmIpFšd”
(
Œue
);

77 @
Ov”ride


78 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

81 
INIT_COUNT
.
	`šüem’tAndG‘
();

85 
	`synchrÚized
 (
INIT_COUNT
) {

88 ià(
şu¡”
 !ğ
nuÎ
) {

92 
Œy
 {

93 
debug
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("debug", "false"));

95 
Ign™eCÚfigu¿tiÚ
 
igcfg
 = 
Ãw
 
	`Ign™eCÚfigu¿tiÚ
();

96 
igcfg
.
	`£tIgn™eIn¡ªûName
(
CLIENT_NODE_NAME
);

98 
SŒšg
 
ho¡
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
HOSTS_PROPERTY
);

99 ià(
ho¡
 =ğ
nuÎ
) {

100 
throw
 
Ãw
 
	`DBExû±iÚ
(
SŒšg
.
	`fÜm©
(

102 
HOSTS_PROPERTY
));

105 
SŒšg
 
pÜts
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
PORTS_PROPERTY
, 
PORTS_DEFAULTS
);

107 ià(
pÜts
 =ğ
nuÎ
) {

108 
throw
 
Ãw
 
	`DBExû±iÚ
(
SŒšg
.
	`fÜm©
(

110 
PORTS_PROPERTY
));

114 
Sy¡em
.
	`£tPrİ”ty
("IGNITE_QUIET", "false");

116 
TıDiscov”ySpi
 
disco
 = 
Ãw
 
	`TıDiscov”ySpi
();

118 
CŞËùiÚ
<
SŒšg
> 
addrs
 = 
Ãw
 
LškedHashS‘
<>();

119 
addrs
.
	`add
(
ho¡
 + ":" + 
pÜts
);

121 ((
TıDiscov”yVmIpFšd”
è
Fšd”
).
	`£tAdd»s£s
(
addrs
);

122 
disco
.
	`£tIpFšd”
(
Fšd”
);

124 
igcfg
.
	`£tDiscov”ySpi
(
disco
);

125 
igcfg
.
	`£tN‘wÜkTimeout
(2000);

126 
igcfg
.
	`£tCl›ÁMode
(
Œue
);

128 
Log4J2Logg”
 
logg”
 = 
Ãw
 
	`Log4J2Logg”
(
this
.
	`g‘CÏss
().
	`g‘CÏssLßd”
().
	`g‘Resourû
("log4j2.xml"));

129 
igcfg
.
	`£tGridLogg”
(
logg”
);

131 
log
.
	`šfo
("Start Ignite client‚ode.");

132 
şu¡”
 = 
Ign™iÚ
.
	`¡¬t
(
igcfg
);

134 
log
.
	`šfo
("Activate Ignite cluster.");

135 
şu¡”
.
	`aùive
(
Œue
);

137 
ÿche
 = 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`w™hK“pBš¬y
();

139 if(
ÿche
 =ğ
nuÎ
) {

140 
throw
 
Ãw
 
	`DBExû±iÚ
Òew 
	`Ign™eCheckedExû±iÚ
("FaedØfšd cach" + 
DEFAULT_CACHE_NAME
));

142 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

143 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

152 @
Ov”ride


153 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

154 
	`synchrÚized
 (
INIT_COUNT
) {

155 
fš®
 
curIn™CouÁ
 = 
INIT_COUNT
.
	`deüem’tAndG‘
();

157 ià(
curIn™CouÁ
 <= 0) {

158 
şu¡”
.
	`şo£
();

159 
şu¡”
 = 
nuÎ
;

162 ià(
curIn™CouÁ
 < 0) {

164 
throw
 
Ãw
 
	`DBExû±iÚ
(

165 
SŒšg
.
	`fÜm©
("š™CouÁ i Ãg©ive: %d", 
curIn™CouÁ
));

168 
	}
}

170 @
Ov”ride


171 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

172 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

173  
	gStus
.
	gNOT_IMPLEMENTED
;

	@ignite/src/main/java/site/ycsb/db/ignite/IgniteClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gign™e
;

19 
impÜt
 
	gs™e
.
	gycsb
.*;

20 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gbš¬y
.
	gBš¬yF›ld
;

21 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gbš¬y
.
	gBš¬yObjeù
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gbš¬y
.
	gBš¬yObjeùBud”
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gbš¬y
.
	gBš¬yTy³
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gÿche
.
	gCacheEÁryProûssÜ
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gš‹º®
.
	gut
..
	gF
;

27 
impÜt
 
	gjavax
.
	gÿche
.
	g´oûssÜ
.
	gEÁryProûssÜExû±iÚ
;

28 
impÜt
 
	gjavax
.
	gÿche
.
	g´oûssÜ
.
	gMubËEÁry
;

29 
impÜt
 
	gjava
.
	gut
.*;

30 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	gloggšg
.
	glog4j
.
	gLogMªag”
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	gloggšg
.
	glog4j
.
	gLogg”
;

41 
public
 cÏs 
	cIgn™eCl›Á
 
ex‹nds
 
	mIgn™eAb¡¿ùCl›Á
 {

43 
´iv©e
 
Logg”
 
	mlog
 = 
LogMªag”
.
g‘Logg”
(
Ign™eCl›Á
.
şass
);

48 
´iv©e
 
Bš¬yTy³
 
	mbšTy³
 = 
nuÎ
;

50 
´iv©e
 
fš®
 
	mCÚcu¼’tHashM­
<
	mSŒšg
, 
	mBš¬yF›ld
> 
	mf›ldsCache
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

65 @
Ov”ride


66 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

67 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

68 
	mŒy
 {

69 
Bš¬yObjeù
 
	mpo
 = 
ÿche
.
g‘
(
key
);

71 ià(
	mpo
 =ğ
nuÎ
) {

72  
Stus
.
NOT_FOUND
;

75 ià(
	mbšTy³
 =ğ
nuÎ
) {

76 
bšTy³
 = 
po
.
ty³
();

79 
SŒšg
 
	ms
 : 
F
.
isEm±y
(
f›lds
è? 
bšTy³
.
f›ldNames
() : fields) {

80 
Bš¬yF›ld
 
bæd
 = 
f›ldsCache
.
g‘
(
s
);

82 ià(
	mbæd
 =ğ
nuÎ
) {

83 
bæd
 = 
bšTy³
.
f›ld
(
s
);

84 
	mf›ldsCache
.
put
(
s
, 
bæd
);

87 
SŒšg
 
	mv®
 = 
bæd
.
v®ue
(
po
);

88 ià(
	mv®
 !ğ
nuÎ
) {

89 
»suÉ
.
put
(
s
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®
));

92 ià(
	mdebug
) {

93 
	mlog
.
šfo
("bË:{" + 
bË
 + "}, key:{" + 
key
 + "}" + ", f›lds:{" + 
f›lds
 + "}");

94 
	mlog
.
šfo
("f›ld š…o{" + 
bšTy³
.
f›ldNames
() + "}");

95 
	mlog
.
šfo
("»suÉ {" + 
»suÉ
 + "}");

99  
	mStus
.
	mOK
;

101 } 
ÿtch
 (
Exû±iÚ
 
e
) {

102 
	mlog
.
”rÜ
(
SŒšg
.
fÜm©
("E¼Ü„—dšg key: %s", 
key
), 
e
);

104  
	mStus
.
	mERROR
;

118 @
Ov”ride


119 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

120 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

121 
	gŒy
 {

122 
	gÿche
.
švoke
(
key
, 
Ãw
 
Upd©”
(
v®ues
));

124  
	gStus
.
	gOK
;

125 } 
ÿtch
 (
Exû±iÚ
 
e
) {

126 
	glog
.
”rÜ
(
SŒšg
.
fÜm©
("E¼Ü upd©šg key: %s", 
key
), 
e
);

128  
	gStus
.
	gERROR
;

142 @
Ov”ride


143 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

144 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

145 
	gŒy
 {

146 
Bš¬yObjeùBud”
 
	gbob
 = 
şu¡”
.
bš¬y
().
bud”
("CustomType");

148 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

149 
bob
.
£tF›ld
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

151 ià(
	gdebug
) {

152 
	glog
.
šfo
(
’Œy
.
g‘Key
(è+ ":" +ƒÁry.
g‘V®ue
());

156 
Bš¬yObjeù
 
	gbo
 = 
bob
.
bud
();

158 ià(
	gbË
.
equ®s
(
DEFAULT_CACHE_NAME
)) {

159 
	gÿche
.
put
(
key
, 
bo
);

161 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("UÃx³ùedabË‚ame: " + 
bË
);

164  
	gStus
.
	gOK
;

165 } 
ÿtch
 (
Exû±iÚ
 
e
) {

166 
	glog
.
”rÜ
(
SŒšg
.
fÜm©
("E¼Ü in£¹šg key: %s", 
key
), 
e
);

168  
	gStus
.
	gERROR
;

179 @
Ov”ride


180 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

181 
Œy
 {

182 
ÿche
.
	`»move
(
key
);

183  
Stus
.
OK
;

184 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

185 
log
.
	`”rÜ
(
SŒšg
.
	`fÜm©
("E¼Ü d–‘šg key: % ", 
key
), 
e
);

188  
Stus
.
ERROR
;

189 
	}
}

194 
public
 
şass
 
Upd©”
 
im¶em’ts
 
	gCacheEÁryProûssÜ
<
	gSŒšg
, 
	gBš¬yObjeù
, 
	gObjeù
> {

195 
´iv©e
 
	gSŒšg
[] 
	gæds
;

196 
´iv©e
 
	gSŒšg
[] 
	gv®s
;

201 
Upd©”
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

202 
	gæds
 = 
Ãw
 
SŒšg
[
v®ues
.
size
()];

203 
	gv®s
 = 
Ãw
 
SŒšg
[
v®ues
.
size
()];

205 
	gidx
 = 0;

206 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	ge
 : 
v®ues
.
’ŒyS‘
()) {

207 
æds
[
idx
] = 
e
.
g‘Key
();

208 
	gv®s
[
idx
] = 
e
.
g‘V®ue
().
toSŒšg
();

209 ++
	gidx
;

216 @
Ov”ride


217 
public
 
Objeù
 
´oûss
(
MubËEÁry
<
SŒšg
, 
Bš¬yObjeù
> 
mubËEÁry
, Objeù... 
objeùs
)

218 
throws
 
	gEÁryProûssÜExû±iÚ
 {

219 
Bš¬yObjeùBud”
 
	gbob
 = 
mubËEÁry
.
g‘V®ue
().
toBud”
();

221 
	gi
 = 0; i < 
	gæds
.
	gËngth
; ++i) {

222 
	gbob
.
£tF›ld
(
æds
[
i
], 
v®s
[i]);

225 
	gmubËEÁry
.
£tV®ue
(
bob
.
bud
());

227  
	gnuÎ
;

	@ignite/src/main/java/site/ycsb/db/ignite/IgniteSqlClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gign™e
;

19 
impÜt
 
	gs™e
.
	gycsb
.*;

20 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gÿche
.
	gqu”y
.
	gF›ldsQu”yCursÜ
;

21 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gÿche
.
	gqu”y
.
	gSqlF›ldsQu”y
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gš‹º®
.
	gut
..
	gF
;

24 
impÜt
 
	gjavax
.
	gÿche
.
	gCacheExû±iÚ
;

25 
impÜt
 
	gjava
.
	gut
.*;

27 
impÜt
 
	gÜg
.
	g­ache
.
	gloggšg
.
	glog4j
.
	gLogMªag”
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	gloggšg
.
	glog4j
.
	gLogg”
;

35 
public
 cÏs 
	cIgn™eSqlCl›Á
 
ex‹nds
 
	mIgn™eAb¡¿ùCl›Á
 {

37 
´iv©e
 
Logg”
 
	mlog
 = 
LogMªag”
.
g‘Logg”
(
Ign™eSqlCl›Á
.
şass
);

39 
´iv©e
 
fš®
 
SŒšg
 
	mPRIMARY_KEY
 = "YCSB_KEY";

50 @
Ov”ride


51 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

52 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

53 
	mŒy
 {

54 
SŒšgBud”
 
	msb
 = 
Ãw
 SŒšgBud”("SELECT * FROM ").
­³nd
(
bË
)

55 .
­³nd
(" WHERE ").­³nd(
PRIMARY_KEY
).append("=?");

57 
SqlF›ldsQu”y
 
	mqry
 = 
Ãw
 SqlF›ldsQu”y(
sb
.
toSŒšg
());

58 
	mqry
.
£tArgs
(
key
);

60 
	mF›ldsQu”yCursÜ
<
	mLi¡
<?>> 
	mcur
 = 
ÿche
.
qu”y
(
qry
);

61 
	mI‹¿tÜ
<
	mLi¡
<?>> 
	m™
 = 
cur
.
™”©Ü
();

63 ià(!
	m™
.
hasNext
()) {

64  
	mStus
.
	mNOT_FOUND
;

67 
	mSŒšg
[] 
	mcŞNames
 = 
Ãw
 
SŒšg
[
cur
.
g‘CŞumnsCouÁ
()];

68 
	mi
 = 0; i < 
	mcŞNames
.
	mËngth
; ++i) {

69 
SŒšg
 
	mcŞName
 = 
cur
.
g‘F›ldName
(
i
);

70 ià(
	mF
.
isEm±y
(
f›lds
)) {

71 
	mcŞNames
[
i
] = 
cŞName
.
toLow”Ca£
();

73 
SŒšg
 
	mf
 : 
f›lds
) {

74 ià(
f
.
equ®sIgnÜeCa£
(
cŞName
)) {

75 
cŞNames
[
i
] = 
f
;

81 
	m™
.
hasNext
()) {

82 
	mLi¡
<?> 
	mrow
 = 
™
.
Ãxt
();

84 
	mi
 = 0; i < 
	mcŞNames
.
	mËngth
; ++i) {

85 ià(
	mcŞNames
[
i
] !ğ
nuÎ
) {

86 
»suÉ
.
put
(
cŞNames
[
i
], 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
row
.
g‘
(i)));

91  
	mStus
.
	mOK
;

92 } 
ÿtch
 (
Exû±iÚ
 
e
) {

93 
	mlog
.
”rÜ
(
SŒšg
.
fÜm©
("E¼Ü iÀ´oûssšg„—d fromabË: %s", 
bË
), 
e
);

95  
	mStus
.
	mERROR
;

109 @
Ov”ride


110 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

111 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

112 
	gŒue
) {

113 
	gŒy
 {

114 
Upd©eD©a
 
	gupdD©a
 = 
Ãw
 Upd©eD©a(
key
, 
v®ues
);

115 
SŒšgBud”
 
	gsb
 = 
Ãw
 SŒšgBud”("UPDATE ").
­³nd
(
bË
).append(" SET ");

117 
	gi
 = 0; i < 
	gupdD©a
.
g‘F›lds
().
	gËngth
; ++i) {

118 
	gsb
.
­³nd
(
updD©a
.
g‘F›lds
()[
i
]).append("=?");

119 ià(
	gi
 < 
	gupdD©a
.
g‘F›lds
().
	gËngth
 - 1) {

120 
	gsb
.
­³nd
(", ");

124 
	gsb
.
­³nd
(" WHERE ").­³nd(
PRIMARY_KEY
).append("=?");

126 
SqlF›ldsQu”y
 
	gqry
 = 
Ãw
 SqlF›ldsQu”y(
sb
.
toSŒšg
());

127 
	gqry
.
£tArgs
(
updD©a
.
g‘Args
());

129 
	gÿche
.
qu”y
(
qry
).
g‘AÎ
();

131  
	gStus
.
	gOK
;

132 } 
ÿtch
 (
CacheExû±iÚ
 
e
) {

133 ià(!
	ge
.
g‘Mes§ge
().
cÚšs
("Failedo update some keys becausehey had been modified concurrently")) {

134 
	glog
.
”rÜ
(
SŒšg
.
fÜm©
("E¼Ü iÀ´oûssšg upd©bË: %s", 
bË
), 
e
);

136  
	gStus
.
	gERROR
;

138 } 
ÿtch
 (
Exû±iÚ
 
e
) {

139 
	glog
.
”rÜ
(
SŒšg
.
fÜm©
("E¼Ü iÀ´oûssšg upd©bË: %s", 
bË
), 
e
);

141  
	gStus
.
	gERROR
;

156 @
Ov”ride


157 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

158 
	gŒy
 {

159 
In£¹D©a
 
	gš£¹D©a
 = 
Ãw
 In£¹D©a(
key
, 
v®ues
);

160 
SŒšgBud”
 
	gsb
 = 
Ãw
 SŒšgBud”("INSERT INTO ").
­³nd
(
bË
).append(" (")

161 .
­³nd
(
š£¹D©a
.
g‘In£¹F›lds
()).append(") VALUES (")

162 .
­³nd
(
š£¹D©a
.
g‘In£¹P¬ams
()).append(')');

164 
SqlF›ldsQu”y
 
	gqry
 = 
Ãw
 SqlF›ldsQu”y(
sb
.
toSŒšg
());

165 
	gqry
.
£tArgs
(
š£¹D©a
.
g‘Args
());

167 
	gÿche
.
qu”y
(
qry
).
g‘AÎ
();

169  
	gStus
.
	gOK
;

170 } 
ÿtch
 (
Exû±iÚ
 
e
) {

171 
	glog
.
”rÜ
(
SŒšg
.
fÜm©
("E¼Ü iÀ´oûssšg in£¹ØbË: %s", 
bË
), 
e
);

173  
	gStus
.
	gERROR
;

184 @
Ov”ride


185 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

186 
Œy
 {

187 
SŒšgBud”
 
sb
 = 
Ãw
 
	`SŒšgBud”
("DELETE FROM ").
	`­³nd
(
bË
)

188 .
	`­³nd
(" WHERE ").­³nd(
PRIMARY_KEY
).append(" = ?");

190 
SqlF›ldsQu”y
 
qry
 = 
Ãw
 
	`SqlF›ldsQu”y
(
sb
.
	`toSŒšg
());

191 
qry
.
	`£tArgs
(
key
);

192 
ÿche
.
	`qu”y
(
qry
).
	`g‘AÎ
();

193  
Stus
.
OK
;

194 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

195 
log
.
	`”rÜ
(
SŒšg
.
	`fÜm©
("E¼Ü iÀ´oûssšg„—d fromabË: %s", 
bË
), 
e
);

197  
Stus
.
ERROR
;

199 
	}
}

204 
´iv©e
 şas 
	cIn£¹D©a
 {

205 
´iv©e
 
fš®
 
	gObjeù
[] 
	g¬gs
;

206 
´iv©e
 
fš®
 
SŒšg
 
	gš£¹F›lds
;

207 
´iv©e
 
fš®
 
SŒšg
 
	gš£¹P¬ams
;

213 
In£¹D©a
(
SŒšg
 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

214 
	g¬gs
 = 
Ãw
 
SŒšg
[
v®ues
.
size
() + 1];

216 
	gidx
 = 0;

217 
	g¬gs
[
idx
++] = 
key
;

219 
SŒšgBud”
 
	gsbF›lds
 = 
Ãw
 SŒšgBud”(
PRIMARY_KEY
);

220 
SŒšgBud”
 
	gsbP¬ams
 = 
Ãw
 StringBuilder("?");

222 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	ge
 : 
v®ues
.
’ŒyS‘
()) {

223 
¬gs
[
idx
++] = 
e
.
g‘V®ue
().
toSŒšg
();

224 
	gsbF›lds
.
­³nd
(',').­³nd(
e
.
g‘Key
());

225 
	gsbP¬ams
.
­³nd
(", ?");

228 
	gš£¹F›lds
 = 
sbF›lds
.
toSŒšg
();

229 
	gš£¹P¬ams
 = 
sbP¬ams
.
toSŒšg
();

232 
public
 
	gObjeù
[] 
g‘Args
() {

233  
	g¬gs
;

236 
public
 
SŒšg
 
g‘In£¹F›lds
() {

237  
	gš£¹F›lds
;

240 
public
 
SŒšg
 
g‘In£¹P¬ams
() {

241  
	gš£¹P¬ams
;

248 
´iv©e
 şas 
	cUpd©eD©a
 {

249 
´iv©e
 
fš®
 
	gObjeù
[] 
	g¬gs
;

250 
´iv©e
 
fš®
 
	gSŒšg
[] 
	gf›lds
;

256 
Upd©eD©a
(
SŒšg
 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

257 
	g¬gs
 = 
Ãw
 
SŒšg
[
v®ues
.
size
() + 1];

258 
	gf›lds
 = 
Ãw
 
SŒšg
[
v®ues
.
size
()];

260 
	gidx
 = 0;

262 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	ge
 : 
v®ues
.
’ŒyS‘
()) {

263 
¬gs
[
idx
] = 
e
.
g‘V®ue
().
toSŒšg
();

264 
	gf›lds
[
idx
++] = 
e
.
g‘Key
();

267 
	g¬gs
[
idx
] = 
key
;

270 
public
 
	gObjeù
[] 
g‘Args
() {

271  
	g¬gs
;

274 
public
 
	gSŒšg
[] 
g‘F›lds
() {

275  
	gf›lds
;

	@ignite/src/main/java/site/ycsb/db/ignite/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gign™e
;

	@ignite/src/test/java/site/ycsb/db/ignite/IgniteClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gign™e
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gIgn™eCheckedExû±iÚ
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gIgn™iÚ
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gcÚfigu¿tiÚ
.
	gCacheCÚfigu¿tiÚ
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gcÚfigu¿tiÚ
.
	gIgn™eCÚfigu¿tiÚ
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	glogg”
.
	glog4j2
.
	gLog4J2Logg”
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	g¥i
.
	gdiscov”y
.
	gtı
.
	gTıDiscov”ySpi
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	g¥i
.
	gdiscov”y
.
	gtı
.
	gfšd”
.
	gTıDiscov”yIpFšd”
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	g¥i
.
	gdiscov”y
.
	gtı
.
	gfšd”
.
	gvm
.
	gTıDiscov”yVmIpFšd”
;

32 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

33 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

34 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

36 
impÜt
 
	gjava
.
	gut
.*;

38 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”As£¹
.
	gas£¹Th©
;

39 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	ghasEÁry
;

40 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	gis
;

45 
public
 cÏs 
	cIgn™eCl›ÁTe¡
 
ex‹nds
 
	mIgn™eCl›ÁTe¡Ba£
 {

46 
´iv©e
 
fš®
 
SŒšg
 
	mHOST
 = "127.0.0.1";

47 
´iv©e
 
fš®
 
SŒšg
 
	mPORTS
 = "47500..47509";

48 
´iv©e
 
fš®
 
SŒšg
 
	mSERVER_NODE_NAME
 = "YCSB Server Node";

49 
´iv©e
 
TıDiscov”yIpFšd”
 
	mFšd”
 = 
Ãw
 
TıDiscov”yVmIpFšd”
(
Œue
);

51 @
BefÜeCÏss


52 
public
 
	$befÜeTe¡
(è
throws
 
Ign™eCheckedExû±iÚ
 {

53 
Ign™eCÚfigu¿tiÚ
 
igcfg
 = 
Ãw
 
	`Ign™eCÚfigu¿tiÚ
();

54 
igcfg
.
	`£tIgn™eIn¡ªûName
(
SERVER_NODE_NAME
);

55 
igcfg
.
	`£tCl›ÁMode
(
çl£
);

57 
TıDiscov”ySpi
 
disco
 = 
Ãw
 
	`TıDiscov”ySpi
();

58 
CŞËùiÚ
<
SŒšg
> 
add”s
 = 
Ãw
 
LškedHashS‘
<>();

59 
add”s
.
	`add
(
HOST
 + ":" + 
PORTS
);

61 ((
TıDiscov”yVmIpFšd”
è
Fšd”
).
	`£tAdd»s£s
(
add”s
);

62 
disco
.
	`£tIpFšd”
(
Fšd”
);

64 
igcfg
.
	`£tDiscov”ySpi
(
disco
);

65 
igcfg
.
	`£tN‘wÜkTimeout
(2000);

67 
CacheCÚfigu¿tiÚ
 
ccfg
 = 
Ãw
 
	`CacheCÚfigu¿tiÚ
().
	`£tName
(
DEFAULT_CACHE_NAME
);

69 
igcfg
.
	`£tCacheCÚfigu¿tiÚ
(
ccfg
);

71 
Log4J2Logg”
 
logg”
 = 
Ãw
 
	`Log4J2Logg”
(
Ign™eCl›ÁTe¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("log4j2.xml"));

72 
igcfg
.
	`£tGridLogg”
(
logg”
);

74 
şu¡”
 = 
Ign™iÚ
.
	`¡¬t
(
igcfg
);

75 
şu¡”
.
	`aùive
();

78 @
BefÜe


79 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

80 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

81 
p
.
	`£tPrİ”ty
("ho¡s", 
HOST
);

82 
p
.
	`£tPrİ”ty
("pÜts", 
PORTS
);

83 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

85 
ş›Á
 = 
Ãw
 
	`Ign™eCl›Á
();

86 
ş›Á
.
	`£tPrİ”t›s
(
p
);

87 
ş›Á
.
	`š™
();

88 
	}
}

90 @
Te¡


91 
public
 
	$‹¡In£¹
(è
throws
 
Exû±iÚ
 {

92 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

93 
fš®
 
SŒšg
 
key
 = "key";

94 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

95 
šput
.
	`put
("field0", "value1");

96 
šput
.
	`put
("field1", "value2");

97 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`š£¹
(
DEFAULT_CACHE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

98 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

99 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

100 
	}
}

102 @
Te¡


103 
public
 
	$‹¡D–‘e
(è
throws
 
Exû±iÚ
 {

104 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

105 
fš®
 
SŒšg
 
key1
 = "key1";

106 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput1
 = 
Ãw
 
HashM­
<>();

107 
šput1
.
	`put
("field0", "value1");

108 
šput1
.
	`put
("field1", "value2");

109 
fš®
 
Stus
 
¡©us1
 = 
ş›Á
.
	`š£¹
(
DEFAULT_CACHE_NAME
, 
key1
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput1
));

110 
	`as£¹Th©
(
¡©us1
, 
	`is
(
Stus
.
OK
));

111 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

113 
fš®
 
SŒšg
 
key2
 = "key2";

114 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput2
 = 
Ãw
 
HashM­
<>();

115 
šput2
.
	`put
("field0", "value1");

116 
šput2
.
	`put
("field1", "value2");

117 
fš®
 
Stus
 
¡©us2
 = 
ş›Á
.
	`š£¹
(
DEFAULT_CACHE_NAME
, 
key2
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput2
));

118 
	`as£¹Th©
(
¡©us2
, 
	`is
(
Stus
.
OK
));

119 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(2));

121 
fš®
 
Stus
 
¡©us3
 = 
ş›Á
.
	`d–‘e
(
DEFAULT_CACHE_NAME
, 
key2
);

122 
	`as£¹Th©
(
¡©us3
, 
	`is
(
Stus
.
OK
));

123 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

125 
	}
}

127 @
Te¡


128 
public
 
	$‹¡R—d
(è
throws
 
Exû±iÚ
 {

129 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

130 
fš®
 
SŒšg
 
key
 = "key";

131 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

132 
šput
.
	`put
("field0", "value1");

133 
šput
.
	`put
("field1", "value2A");

134 
šput
.
	`put
("f›ld3", 
nuÎ
);

135 
fš®
 
Stus
 
sPut
 = 
ş›Á
.
	`š£¹
(
DEFAULT_CACHE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

136 
	`as£¹Th©
(
sPut
, 
	`is
(
Stus
.
OK
));

137 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

139 
fš®
 
S‘
<
SŒšg
> 
æd
 = 
Ãw
 
T»eS‘
<>();

140 
æd
.
	`add
("field0");

141 
æd
.
	`add
("field1");

142 
æd
.
	`add
("field3");

144 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

145 
fš®
 
Stus
 
sG‘
 = 
ş›Á
.
	`»ad
(
DEFAULT_CACHE_NAME
, 
key
, 
æd
, 
»suÉ
);

146 
	`as£¹Th©
(
sG‘
, 
	`is
(
Stus
.
OK
));

148 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
¡rResuÉ
 = 
Ãw
 HashMap<String, String>();

149 
fš®
 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
e
 : 
»suÉ
.
	`’ŒyS‘
()) {

150 ià(
e
.
	`g‘V®ue
(è!ğ
nuÎ
) {

151 
¡rResuÉ
.
	`put
(
e
.
	`g‘Key
(),ƒ.
	`g‘V®ue
().
	`toSŒšg
());

154 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field0", "value1"));

155 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field1", "value2A"));

156 
	}
}

158 @
Te¡


159 
public
 
	$‹¡R—dAÎF›lds
(è
throws
 
Exû±iÚ
 {

160 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

161 
fš®
 
SŒšg
 
key
 = "key";

162 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

163 
šput
.
	`put
("field0", "value1");

164 
šput
.
	`put
("field1", "value2A");

165 
šput
.
	`put
("f›ld3", 
nuÎ
);

166 
fš®
 
Stus
 
sPut
 = 
ş›Á
.
	`š£¹
(
DEFAULT_CACHE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

167 
	`as£¹Th©
(
sPut
, 
	`is
(
Stus
.
OK
));

168 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

170 
fš®
 
S‘
<
SŒšg
> 
æd
 = 
Ãw
 
T»eS‘
<>();

172 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ1
 = 
Ãw
 HashMap<>();

173 
fš®
 
Stus
 
sG‘
 = 
ş›Á
.
	`»ad
(
DEFAULT_CACHE_NAME
, 
key
, 
æd
, 
»suÉ1
);

174 
	`as£¹Th©
(
sG‘
, 
	`is
(
Stus
.
OK
));

176 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
¡rResuÉ
 = 
Ãw
 HashMap<String, String>();

177 
fš®
 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
e
 : 
»suÉ1
.
	`’ŒyS‘
()) {

178 ià(
e
.
	`g‘V®ue
(è!ğ
nuÎ
) {

179 
¡rResuÉ
.
	`put
(
e
.
	`g‘Key
(),ƒ.
	`g‘V®ue
().
	`toSŒšg
());

182 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field0", "value1"));

183 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field1", "value2A"));

184 
	}
}

186 @
Te¡


187 
public
 
	$‹¡R—dNÙP»£Á
(è
throws
 
Exû±iÚ
 {

188 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

189 
fš®
 
SŒšg
 
key
 = "key";

190 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

191 
šput
.
	`put
("field0", "value1");

192 
šput
.
	`put
("field1", "value2A");

193 
šput
.
	`put
("f›ld3", 
nuÎ
);

194 
fš®
 
Stus
 
sPut
 = 
ş›Á
.
	`š£¹
(
DEFAULT_CACHE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

195 
	`as£¹Th©
(
sPut
, 
	`is
(
Stus
.
OK
));

196 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

198 
fš®
 
S‘
<
SŒšg
> 
æd
 = 
Ãw
 
T»eS‘
<>();

200 
fš®
 
SŒšg
 
ÃwKey
 = "newKey";

201 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ1
 = 
Ãw
 HashMap<>();

202 
fš®
 
Stus
 
sG‘
 = 
ş›Á
.
	`»ad
(
DEFAULT_CACHE_NAME
, 
ÃwKey
, 
æd
, 
»suÉ1
);

203 
	`as£¹Th©
(
sG‘
, 
	`is
(
Stus
.
NOT_FOUND
));

205 
	}
}

	@ignite/src/test/java/site/ycsb/db/ignite/IgniteClientTestBase.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gign™e
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gIgn™e
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

26 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

27 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

29 
impÜt
 
	gjava
.
	gut
.*;

31 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”As£¹
.
	gas£¹Th©
;

32 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	gis
;

37 
public
 cÏs 
	cIgn™eCl›ÁTe¡Ba£
 {

38 
´Ùeùed
 
fš®
 
SŒšg
 
	mDEFAULT_CACHE_NAME
 = "usertable";

41 
´Ùeùed
 
Ign™e
 
	mşu¡”
;

44 
´Ùeùed
 
DB
 
	mş›Á
;

49 @
Aá”


50 
public
 
	$‹¬Down
(è
throws
 
Exû±iÚ
 {

51 
ş›Á
.
	`ş—nup
();

57 @
Aá”CÏss


58 
public
 
	$aá”CÏss
() {

59 
şu¡”
.
	`şo£
();

61 
Œy
 {

62 
Th»ad
.
	`¦“p
(1000);

64 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

65 
e
.
	`´štSckT¿û
();

67 
	}
}

69 @
Te¡


70 
public
 
	$sÿnNÙIm¶em’‹d
() {

71 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

72 
fš®
 
SŒšg
 
key
 = "key";

73 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

74 
šput
.
	`put
("field0", "value1");

75 
šput
.
	`put
("field1", "value2");

76 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`š£¹
(
DEFAULT_CACHE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

77 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

78 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

79 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉs
 = 
Ãw
 Vector<>();

80 
fš®
 
Stus
 
sÿn
 = 
ş›Á
.
	`sÿn
(
DEFAULT_CACHE_NAME
, 
key
, 1, 
nuÎ
, 
»suÉs
);

81 
	`as£¹Th©
(
sÿn
, 
	`is
(
Stus
.
NOT_IMPLEMENTED
));

82 
	}
}

	@ignite/src/test/java/site/ycsb/db/ignite/IgniteSqlClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gign™e
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gIgn™eCheckedExû±iÚ
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gIgn™iÚ
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gÿche
.
	gQu”yEÁ™y
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gcÚfigu¿tiÚ
.
	gCacheCÚfigu¿tiÚ
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	gcÚfigu¿tiÚ
.
	gIgn™eCÚfigu¿tiÚ
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	glogg”
.
	glog4j2
.
	gLog4J2Logg”
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	g¥i
.
	gdiscov”y
.
	gtı
.
	gTıDiscov”ySpi
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	g¥i
.
	gdiscov”y
.
	gtı
.
	gfšd”
.
	gTıDiscov”yIpFšd”
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	gign™e
.
	g¥i
.
	gdiscov”y
.
	gtı
.
	gfšd”
.
	gvm
.
	gTıDiscov”yVmIpFšd”
;

33 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

34 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

35 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

37 
impÜt
 
	gjava
.
	gut
.*;

38 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

39 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

40 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

41 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

43 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”As£¹
.
	gas£¹Th©
;

44 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	ghasEÁry
;

45 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	gis
;

50 
public
 cÏs 
	cIgn™eSqlCl›ÁTe¡
 
ex‹nds
 
	mIgn™eCl›ÁTe¡Ba£
 {

51 
´iv©e
 
fš®
 
SŒšg
 
	mTABLE_NAME
 = "usertable";

52 
´iv©e
 
fš®
 
SŒšg
 
	mHOST
 = "127.0.0.1";

53 
´iv©e
 
fš®
 
SŒšg
 
	mPORTS
 = "47500..47509";

54 
´iv©e
 
fš®
 
SŒšg
 
	mSERVER_NODE_NAME
 = "YCSB Server Node";

55 
´iv©e
 
TıDiscov”yIpFšd”
 
	mFšd”
 = 
Ãw
 
TıDiscov”yVmIpFšd”
(
Œue
);

60 @
BefÜeCÏss


61 
public
 
	$befÜeTe¡
(è
throws
 
Ign™eCheckedExû±iÚ
 {

62 
Ign™eCÚfigu¿tiÚ
 
igcfg
 = 
Ãw
 
	`Ign™eCÚfigu¿tiÚ
();

63 
igcfg
.
	`£tIgn™eIn¡ªûName
(
SERVER_NODE_NAME
);

64 
igcfg
.
	`£tCl›ÁMode
(
çl£
);

66 
TıDiscov”ySpi
 
disco
 = 
Ãw
 
	`TıDiscov”ySpi
();

67 
CŞËùiÚ
<
SŒšg
> 
add”s
 = 
Ãw
 
LškedHashS‘
<>();

68 
add”s
.
	`add
(
HOST
 + ":" + 
PORTS
);

70 
Qu”yEÁ™y
 
qe
 = 
Ãw
 
	`Qu”yEÁ™y
("java.lang.String", "UserTableType")

71 .
	`addQu”yF›ld
("ycsb_key", "java.Ïng.SŒšg", 
nuÎ
)

72 .
	`addQu”yF›ld
("f›ld0", "java.Ïng.SŒšg", 
nuÎ
)

73 .
	`addQu”yF›ld
("f›ld1", "java.Ïng.SŒšg", 
nuÎ
)

74 .
	`addQu”yF›ld
("f›ld2", "java.Ïng.SŒšg", 
nuÎ
)

75 .
	`addQu”yF›ld
("f›ld3", "java.Ïng.SŒšg", 
nuÎ
)

76 .
	`addQu”yF›ld
("f›ld4", "java.Ïng.SŒšg", 
nuÎ
)

77 .
	`addQu”yF›ld
("f›ld5", "java.Ïng.SŒšg", 
nuÎ
)

78 .
	`addQu”yF›ld
("f›ld6", "java.Ïng.SŒšg", 
nuÎ
)

79 .
	`addQu”yF›ld
("f›ld7", "java.Ïng.SŒšg", 
nuÎ
)

80 .
	`addQu”yF›ld
("f›ld8", "java.Ïng.SŒšg", 
nuÎ
)

81 .
	`addQu”yF›ld
("f›ld9", "java.Ïng.SŒšg", 
nuÎ
)

82 .
	`£tKeyF›ldName
("ycsb_key");

84 
qe
.
	`£tTabËName
("usertable");

86 
CacheCÚfigu¿tiÚ
 
ccfg
 = 
Ãw
 
	`CacheCÚfigu¿tiÚ
().
	`£tQu”yEÁ™›s
(
CŞËùiÚs
.
	`sšgËtÚ
(
qe
))

87 .
	`£tName
(
DEFAULT_CACHE_NAME
);

89 
igcfg
.
	`£tCacheCÚfigu¿tiÚ
(
ccfg
);

91 ((
TıDiscov”yVmIpFšd”
è
Fšd”
).
	`£tAdd»s£s
(
add”s
);

92 
disco
.
	`£tIpFšd”
(
Fšd”
);

94 
igcfg
.
	`£tDiscov”ySpi
(
disco
);

95 
igcfg
.
	`£tN‘wÜkTimeout
(2000);

97 
Log4J2Logg”
 
logg”
 = 
Ãw
 
	`Log4J2Logg”
(
Ign™eSqlCl›ÁTe¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("log4j2.xml"));

98 
igcfg
.
	`£tGridLogg”
(
logg”
);

100 
şu¡”
 = 
Ign™iÚ
.
	`¡¬t
(
igcfg
);

101 
şu¡”
.
	`aùive
();

104 @
BefÜe


105 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

106 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

107 
p
.
	`£tPrİ”ty
("ho¡s", 
HOST
);

108 
p
.
	`£tPrİ”ty
("pÜts", 
PORTS
);

109 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

111 
ş›Á
 = 
Ãw
 
	`Ign™eSqlCl›Á
();

112 
ş›Á
.
	`£tPrİ”t›s
(
p
);

113 
ş›Á
.
	`š™
();

114 
	}
}

116 @
Te¡


117 
public
 
	$‹¡In£¹
(è
throws
 
Exû±iÚ
 {

118 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

119 
fš®
 
SŒšg
 
key
 = "key";

120 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

121 
šput
.
	`put
("field0", "value1");

122 
šput
.
	`put
("field1", "value2");

123 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`š£¹
(
TABLE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

124 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

125 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

126 
	}
}

128 @
Te¡


129 
public
 
	$‹¡D–‘e
(è
throws
 
Exû±iÚ
 {

130 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

131 
fš®
 
SŒšg
 
key1
 = "key1";

132 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput1
 = 
Ãw
 
HashM­
<>();

133 
šput1
.
	`put
("field0", "value1");

134 
šput1
.
	`put
("field1", "value2");

135 
fš®
 
Stus
 
¡©us1
 = 
ş›Á
.
	`š£¹
(
TABLE_NAME
, 
key1
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput1
));

136 
	`as£¹Th©
(
¡©us1
, 
	`is
(
Stus
.
OK
));

137 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

139 
fš®
 
SŒšg
 
key2
 = "key2";

140 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput2
 = 
Ãw
 
HashM­
<>();

141 
šput2
.
	`put
("field0", "value1");

142 
šput2
.
	`put
("field1", "value2");

143 
fš®
 
Stus
 
¡©us2
 = 
ş›Á
.
	`š£¹
(
TABLE_NAME
, 
key2
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput2
));

144 
	`as£¹Th©
(
¡©us2
, 
	`is
(
Stus
.
OK
));

145 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(2));

147 
fš®
 
Stus
 
¡©us3
 = 
ş›Á
.
	`d–‘e
(
TABLE_NAME
, 
key2
);

148 
	`as£¹Th©
(
¡©us3
, 
	`is
(
Stus
.
OK
));

149 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

151 
	}
}

153 @
Te¡


154 
public
 
	$‹¡R—d
(è
throws
 
Exû±iÚ
 {

155 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

156 
fš®
 
SŒšg
 
key
 = "key";

157 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

158 
šput
.
	`put
("field0", "value1");

159 
šput
.
	`put
("field1", "value2A");

160 
šput
.
	`put
("f›ld3", 
nuÎ
);

161 
fš®
 
Stus
 
sPut
 = 
ş›Á
.
	`š£¹
(
TABLE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

162 
	`as£¹Th©
(
sPut
, 
	`is
(
Stus
.
OK
));

163 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

165 
fš®
 
S‘
<
SŒšg
> 
æd
 = 
Ãw
 
T»eS‘
<>();

166 
æd
.
	`add
("field0");

167 
æd
.
	`add
("field1");

168 
æd
.
	`add
("field3");

170 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

171 
fš®
 
Stus
 
sG‘
 = 
ş›Á
.
	`»ad
(
TABLE_NAME
, 
key
, 
æd
, 
»suÉ
);

172 
	`as£¹Th©
(
sG‘
, 
	`is
(
Stus
.
OK
));

174 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
¡rResuÉ
 = 
Ãw
 HashMap<String, String>();

175 
fš®
 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
e
 : 
»suÉ
.
	`’ŒyS‘
()) {

176 ià(
e
.
	`g‘V®ue
(è!ğ
nuÎ
) {

177 
¡rResuÉ
.
	`put
(
e
.
	`g‘Key
(),ƒ.
	`g‘V®ue
().
	`toSŒšg
());

180 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field0", "value1"));

181 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field1", "value2A"));

182 
	}
}

184 @
Te¡


185 
public
 
	$‹¡Upd©e
(è
throws
 
Exû±iÚ
 {

186 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

187 
fš®
 
SŒšg
 
key
 = "key";

188 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

189 
šput
.
	`put
("field0", "value1");

190 
šput
.
	`put
("field1", "value2A");

191 
šput
.
	`put
("f›ld3", 
nuÎ
);

192 
ş›Á
.
	`š£¹
(
TABLE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

194 
šput
.
	`put
("field1", "value2B");

195 
šput
.
	`put
("field4", "value4A");

197 
fš®
 
Stus
 
sUpd
 = 
ş›Á
.
	`upd©e
(
TABLE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

198 
	`as£¹Th©
(
sUpd
, 
	`is
(
Stus
.
OK
));

200 
fš®
 
S‘
<
SŒšg
> 
æd
 = 
Ãw
 
T»eS‘
<>();

201 
æd
.
	`add
("field0");

202 
æd
.
	`add
("field1");

203 
æd
.
	`add
("field3");

204 
æd
.
	`add
("field4");

206 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

207 
fš®
 
Stus
 
sG‘
 = 
ş›Á
.
	`»ad
(
TABLE_NAME
, 
key
, 
æd
, 
»suÉ
);

208 
	`as£¹Th©
(
sG‘
, 
	`is
(
Stus
.
OK
));

210 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
¡rResuÉ
 = 
Ãw
 HashMap<String, String>();

211 
fš®
 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
e
 : 
»suÉ
.
	`’ŒyS‘
()) {

212 ià(
e
.
	`g‘V®ue
(è!ğ
nuÎ
) {

213 
¡rResuÉ
.
	`put
(
e
.
	`g‘Key
(),ƒ.
	`g‘V®ue
().
	`toSŒšg
());

216 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field0", "value1"));

217 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field1", "value2B"));

218 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field4", "value4A"));

219 
	}
}

221 @
Te¡


222 
public
 
	$‹¡CÚcu¼’tUpd©e
(è
throws
 
Exû±iÚ
 {

223 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

224 
fš®
 
SŒšg
 
key
 = "key";

225 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

226 
šput
.
	`put
("field0", "value1");

227 
šput
.
	`put
("field1", "value2A");

228 
šput
.
	`put
("f›ld3", 
nuÎ
);

229 
ş›Á
.
	`š£¹
(
TABLE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

231 
šput
.
	`put
("field1", "value2B");

232 
šput
.
	`put
("field4", "value4A");

234 
ExecutÜS”viû
 
exec
 = 
ExecutÜs
.
	`ÃwCachedTh»adPoŞ
();

236 
fš®
 
AtomicLÚg
 
l
 = 
Ãw
 
	`AtomicLÚg
(0);

237 
fš®
 
BoŞ—n
[] 
updE¼Ü
 = {
çl£
};

239 
RuÂabË
 
sk
 = 
Ãw
 
	`RuÂabË
() {

240 @
Ov”ride


241 
public
 
	`run
() {

242 
i
 = 0; i < 100; ++i) {

243 
šput
.
	`put
("f›ld1", "v®ue2B_" + 
l
.
	`šüem’tAndG‘
());

244 
fš®
 
Stus
 
sUpd
 = 
ş›Á
.
	`upd©e
(
TABLE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

246 ià(!
sUpd
.
	`isOk
()) {

247 
updE¼Ü
[0] = 
Œue
;

254 
i
 = 0; i < 32; ++i) {

255 
exec
.
	`execu‹
(
sk
);

258 
exec
.
	`awa™T”mš©iÚ
(60, 
TimeUn™
.
SECONDS
);

259 
exec
.
	`shutdownNow
();

261 
	`as£¹Th©
(
updE¼Ü
[0], 
	`is
(
çl£
));

262 
	}
}

264 @
Te¡


265 
public
 
	$‹¡R—dAÎF›lds
(è
throws
 
Exû±iÚ
 {

266 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

267 
fš®
 
SŒšg
 
key
 = "key";

268 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

269 
šput
.
	`put
("field0", "value1");

270 
šput
.
	`put
("field1", "value2A");

271 
šput
.
	`put
("f›ld3", 
nuÎ
);

272 
fš®
 
Stus
 
sPut
 = 
ş›Á
.
	`š£¹
(
DEFAULT_CACHE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

273 
	`as£¹Th©
(
sPut
, 
	`is
(
Stus
.
OK
));

274 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

276 
fš®
 
S‘
<
SŒšg
> 
æd
 = 
Ãw
 
T»eS‘
<>();

278 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ1
 = 
Ãw
 HashMap<>();

279 
fš®
 
Stus
 
sG‘
 = 
ş›Á
.
	`»ad
(
TABLE_NAME
, 
key
, 
æd
, 
»suÉ1
);

280 
	`as£¹Th©
(
sG‘
, 
	`is
(
Stus
.
OK
));

282 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
¡rResuÉ
 = 
Ãw
 HashMap<String, String>();

283 
fš®
 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
e
 : 
»suÉ1
.
	`’ŒyS‘
()) {

284 ià(
e
.
	`g‘V®ue
(è!ğ
nuÎ
) {

285 
¡rResuÉ
.
	`put
(
e
.
	`g‘Key
(),ƒ.
	`g‘V®ue
().
	`toSŒšg
());

288 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field0", "value1"));

289 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field1", "value2A"));

290 
	}
}

292 @
Te¡


293 
public
 
	$‹¡R—dNÙP»£Á
(è
throws
 
Exû±iÚ
 {

294 
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`ş—r
();

295 
fš®
 
SŒšg
 
key
 = "key";

296 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

297 
šput
.
	`put
("field0", "value1");

298 
šput
.
	`put
("field1", "value2A");

299 
šput
.
	`put
("f›ld3", 
nuÎ
);

300 
fš®
 
Stus
 
sPut
 = 
ş›Á
.
	`š£¹
(
TABLE_NAME
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

301 
	`as£¹Th©
(
sPut
, 
	`is
(
Stus
.
OK
));

302 
	`as£¹Th©
(
şu¡”
.
	`ÿche
(
DEFAULT_CACHE_NAME
).
	`size
(), 
	`is
(1));

304 
fš®
 
S‘
<
SŒšg
> 
æd
 = 
Ãw
 
T»eS‘
<>();

306 
fš®
 
SŒšg
 
ÃwKey
 = "newKey";

307 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ1
 = 
Ãw
 HashMap<>();

308 
fš®
 
Stus
 
sG‘
 = 
ş›Á
.
	`»ad
(
TABLE_NAME
, 
ÃwKey
, 
æd
, 
»suÉ1
);

309 
	`as£¹Th©
(
sG‘
, 
	`is
(
Stus
.
NOT_FOUND
));

311 
	}
}

	@infinispan/src/main/java/site/ycsb/db/InfinispanClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

26 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gCache
;

27 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	g©omic
.
	gAtomicM­
;

28 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	g©omic
.
	gAtomicM­Lookup
;

29 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gmªag”
.
	gDeçuÉCacheMªag”
;

30 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gmªag”
.
	gEmbeddedCacheMªag”
;

31 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gut
.
	gloggšg
.
	gLog
;

32 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gut
.
	gloggšg
.
	gLogFaùÜy
;

34 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

35 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

36 
impÜt
 
	gjava
.
	gut
.
	gM­
;

37 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

38 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

43 
public
 cÏs 
	cInfši¥ªCl›Á
 
ex‹nds
 
	mDB
 {

44 
´iv©e
 
fš®
 
Log
 
	mLOGGER
 = 
LogFaùÜy
.
g‘Log
(
Infši¥ªCl›Á
.
şass
);

47 
´iv©e
 
fš®
 
boŞ—n
 
	mşu¡”ed
;

49 
´iv©e
 
EmbeddedCacheMªag”
 
	mšfši¥ªMªag”
;

51 
public
 
	$Infši¥ªCl›Á
() {

52 
şu¡”ed
 = 
BoŞ—n
.
	`g‘BoŞ—n
("infinispan.clustered");

55 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

56 
Œy
 {

57 
šfši¥ªMªag”
 = 
Ãw
 
	`DeçuÉCacheMªag”
("infinispan-config.xml");

58 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

59 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

61 
	}
}

63 
public
 
	$ş—nup
() {

64 
šfši¥ªMªag”
.
	`¡İ
();

65 
šfši¥ªMªag”
 = 
nuÎ
;

66 
	}
}

68 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

69 
	gŒy
 {

70 
	gM­
<
	gSŒšg
, SŒšg> 
	grow
;

71 ià(
	gşu¡”ed
) {

72 
	grow
 = 
AtomicM­Lookup
.
g‘AtomicM­
(
šfši¥ªMªag”
.
g‘Cache
(
bË
), 
key
, 
çl£
);

74 
	gCache
<
	gSŒšg
, 
	gM­
<SŒšg, SŒšg>> 
	gÿche
 = 
šfši¥ªMªag”
.
g‘Cache
(
bË
);

75 
	grow
 = 
ÿche
.
g‘
(
key
);

77 ià(
	grow
 !ğ
nuÎ
) {

78 
»suÉ
.
ş—r
();

79 ià(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
isEm±y
()) {

80 
SŒšgBy‹I‹¿tÜ
.
putAÎAsBy‹I‹¿tÜs
(
»suÉ
, 
row
);

82 
SŒšg
 
	gf›ld
 : 
f›lds
) {

83 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
row
.
g‘
(field)));

87  
	gStus
.
	gOK
;

88 } 
ÿtch
 (
Exû±iÚ
 
e
) {

89 
	gLOGGER
.
”rÜ
(
e
);

90  
	gStus
.
	gERROR
;

94 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

95 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

96 
	gLOGGER
.
w¬n
("Infinispan does‚ot support scan semantics");

97  
	gStus
.
	gOK
;

100 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

101 
	gŒy
 {

102 ià(
	gşu¡”ed
) {

103 
	gAtomicM­
<
	gSŒšg
, SŒšg> 
	grow
 = 
AtomicM­Lookup
.
g‘AtomicM­
(
šfši¥ªMªag”
.
g‘Cache
(
bË
), 
key
);

104 
	gSŒšgBy‹I‹¿tÜ
.
putAÎAsSŒšgs
(
row
, 
v®ues
);

106 
	gCache
<
	gSŒšg
, 
	gM­
<SŒšg, SŒšg>> 
	gÿche
 = 
šfši¥ªMªag”
.
g‘Cache
(
bË
);

107 
	gM­
<
	gSŒšg
, SŒšg> 
	grow
 = 
ÿche
.
g‘
(
key
);

108 ià(
	grow
 =ğ
nuÎ
) {

109 
row
 = 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
);

110 
	gÿche
.
put
(
key
, 
row
);

112 
	gSŒšgBy‹I‹¿tÜ
.
putAÎAsSŒšgs
(
row
, 
v®ues
);

116  
	gStus
.
	gOK
;

117 } 
ÿtch
 (
Exû±iÚ
 
e
) {

118 
	gLOGGER
.
”rÜ
(
e
);

119  
	gStus
.
	gERROR
;

123 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

124 
	gŒy
 {

125 ià(
	gşu¡”ed
) {

126 
	gAtomicM­
<
	gSŒšg
, SŒšg> 
	grow
 = 
AtomicM­Lookup
.
g‘AtomicM­
(
šfši¥ªMªag”
.
g‘Cache
(
bË
), 
key
);

127 
	grow
.
ş—r
();

128 
	gSŒšgBy‹I‹¿tÜ
.
putAÎAsSŒšgs
(
row
, 
v®ues
);

130 
	gšfši¥ªMªag”
.
g‘Cache
(
bË
).
put
(
key
, 
v®ues
);

133  
	gStus
.
	gOK
;

134 } 
ÿtch
 (
Exû±iÚ
 
e
) {

135 
	gLOGGER
.
”rÜ
(
e
);

136  
	gStus
.
	gERROR
;

140 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

141 
Œy
 {

142 ià(
şu¡”ed
) {

143 
AtomicM­Lookup
.
	`»moveAtomicM­
(
šfši¥ªMªag”
.
	`g‘Cache
(
bË
), 
key
);

145 
šfši¥ªMªag”
.
	`g‘Cache
(
bË
).
	`»move
(
key
);

147  
Stus
.
OK
;

148 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

149 
LOGGER
.
	`”rÜ
(
e
);

150  
Stus
.
ERROR
;

152 
	}
}

	@infinispan/src/main/java/site/ycsb/db/InfinispanRemoteClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gs™e
.
	gycsb
.*;

21 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gş›Á
.
	ghÙrod
.
	gRemÙeCache
;

22 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gş›Á
.
	ghÙrod
.
	gRemÙeCacheMªag”
;

23 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gut
.
	gloggšg
.
	gLog
;

24 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gut
.
	gloggšg
.
	gLogFaùÜy
;

26 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gM­
;

28 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

29 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

34 
public
 cÏs 
	cInfši¥ªRemÙeCl›Á
 
ex‹nds
 
	mDB
 {

36 
´iv©e
 
fš®
 
Log
 
	mLOGGER
 = 
LogFaùÜy
.
g‘Log
(
Infši¥ªRemÙeCl›Á
.
şass
);

38 
´iv©e
 
RemÙeCacheMªag”
 
	m»mÙeI¥nMªag”
;

39 
´iv©e
 
SŒšg
 
	mÿcheName
 = 
nuÎ
;

41 @
Ov”ride


42 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

43 
»mÙeI¥nMªag”
 = 
RemÙeCacheMªag”HŞd”
.
	`g‘In¡ªû
(
	`g‘Prİ”t›s
());

44 
ÿcheName
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("cache");

47 @
Ov”ride


48 
public
 
	$ş—nup
() {

49 
»mÙeI¥nMªag”
.
	`¡İ
();

50 
»mÙeI¥nMªag”
 = 
nuÎ
;

51 
	}
}

53 @
Ov”ride


54 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
»cÜdKey
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

55 
SŒšg
 
	gcompos™Key
 = 
ü—‹Key
(
bË
, 
»cÜdKey
);

56 
	gM­
<
	gSŒšg
, SŒšg> 
	g¡ršgV®ues
 = 
Ãw
 
HashM­
<>();

57 
	gSŒšgBy‹I‹¿tÜ
.
putAÎAsSŒšgs
(
¡ršgV®ues
, 
v®ues
);

58 
	gŒy
 {

59 
ÿche
().
put
(
compos™Key
, 
¡ršgV®ues
);

60  
	gStus
.
	gOK
;

61 } 
ÿtch
 (
Exû±iÚ
 
e
) {

62 
	gLOGGER
.
”rÜ
(
e
);

63  
	gStus
.
	gERROR
;

67 @
Ov”ride


68 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
»cÜdKey
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

69 
SŒšg
 
	gcompos™Key
 = 
ü—‹Key
(
bË
, 
»cÜdKey
);

70 
	gŒy
 {

71 
	gM­
<
	gSŒšg
, SŒšg> 
	gv®ues
 = 
ÿche
().
g‘
(
compos™Key
);

73 ià(
	gv®ues
 =ğ
nuÎ
 || 
v®ues
.
isEm±y
()) {

74  
Stus
.
NOT_FOUND
;

77 ià(
	gf›lds
 =ğ
nuÎ
) {

78 
SŒšgBy‹I‹¿tÜ
.
putAÎAsBy‹I‹¿tÜs
(
»suÉ
, 
v®ues
);

80 
SŒšg
 
	gf›ld
 : 
f›lds
) {

81 
SŒšg
 
v®ue
 = 
v®ues
.
g‘
(
f›ld
);

82 ià(
	gv®ue
 !ğ
nuÎ
) {

83 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
));

88  
	gStus
.
	gOK
;

89 } 
ÿtch
 (
Exû±iÚ
 
e
) {

90 
	gLOGGER
.
”rÜ
(
e
);

91  
	gStus
.
	gERROR
;

95 @
Ov”ride


96 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

97 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

98 
	gLOGGER
.
w¬n
("Infinispan does‚ot support scan semantics");

99  
	gStus
.
	gNOT_IMPLEMENTED
;

102 @
Ov”ride


103 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
»cÜdKey
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

104 
SŒšg
 
	gcompos™Key
 = 
ü—‹Key
(
bË
, 
»cÜdKey
);

105 
	gŒy
 {

106 
	gM­
<
	gSŒšg
, SŒšg> 
	g¡ršgV®ues
 = 
Ãw
 
HashM­
<>();

107 
	gSŒšgBy‹I‹¿tÜ
.
putAÎAsSŒšgs
(
¡ršgV®ues
, 
v®ues
);

108 
ÿche
().
put
(
compos™Key
, 
¡ršgV®ues
);

109  
	gStus
.
	gOK
;

110 } 
ÿtch
 (
Exû±iÚ
 
e
) {

111 
	gLOGGER
.
”rÜ
(
e
);

112  
	gStus
.
	gERROR
;

116 @
Ov”ride


117 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
»cÜdKey
) {

118 
SŒšg
 
compos™Key
 = 
	`ü—‹Key
(
bË
, 
»cÜdKey
);

119 
Œy
 {

120 
	`ÿche
().
	`»move
(
compos™Key
);

121  
Stus
.
OK
;

122 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

123 
LOGGER
.
	`”rÜ
(
e
);

124  
Stus
.
ERROR
;

126 
	}
}

128 
´iv©e
 
	gRemÙeCache
<
	gSŒšg
, 
	gM­
<SŒšg, SŒšg>> 
	$ÿche
() {

129 ià(
this
.
ÿcheName
 !ğ
nuÎ
) {

130  
»mÙeI¥nMªag”
.
	`g‘Cache
(
ÿcheName
);

132  
»mÙeI¥nMªag”
.
	`g‘Cache
();

134 
	}
}

136 
´iv©e
 
SŒšg
 
	$ü—‹Key
(
SŒšg
 
bË
, SŒšg 
»cÜdKey
) {

137  
bË
 + "-" + 
»cÜdKey
;

138 
	}
}

	@infinispan/src/main/java/site/ycsb/db/RemoteCacheManagerHolder.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

22 
impÜt
 
	gÜg
.
	gšfši¥ª
.
	gş›Á
.
	ghÙrod
.
	gRemÙeCacheMªag”
;

27 
fš®
 cÏs 
	cRemÙeCacheMªag”HŞd”
 {

29 
´iv©e
 vŞ©
RemÙeCacheMªag”
 
	mÿcheMªag”
 = 
nuÎ
;

31 
´iv©e
 
	$RemÙeCacheMªag”HŞd”
() {

34 
RemÙeCacheMªag”
 
	$g‘In¡ªû
(
Prİ”t›s
 
´İs
) {

35 
RemÙeCacheMªag”
 
»suÉ
 = 
ÿcheMªag”
;

36 ià(
»suÉ
 =ğ
nuÎ
) {

37 
	`synchrÚized
 (
RemÙeCacheMªag”HŞd”
.
şass
) {

38 
»suÉ
 = 
ÿcheMªag”
;

39 ià(
»suÉ
 =ğ
nuÎ
) {

40 
»suÉ
 = 
Ãw
 
	`RemÙeCacheMªag”
(
´İs
);

41 
ÿcheMªag”
 = 
Ãw
 
	`RemÙeCacheMªag”
(
´İs
);

45  
»suÉ
;

46 
	}
}

	@infinispan/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@jdbc/src/main/java/site/ycsb/db/JdbcDBCli.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

20 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

21 
impÜt
 
	gjava
.
	gsql
.
	gCÚÃùiÚ
;

22 
impÜt
 
	gjava
.
	gsql
.
	gDriv”Mªag”
;

23 
impÜt
 
	gjava
.
	gsql
.
	gSQLExû±iÚ
;

24 
impÜt
 
	gjava
.
	gsql
.
	gS‹m’t
;

25 
impÜt
 
	gjava
.
	gut
.
	gEnum”©iÚ
;

26 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

33 
public
 
fš®
 cÏs 
	cJdbcDBCli
 {

35 
´iv©e
 
	$u§geMes§ge
() {

36 
Sy¡em
.
out
.
	`´šn
("JdbcCli. Options:");

37 
Sy¡em
.
out
.
	`´šn
(" -p key=value…roperties defined.");

38 
Sy¡em
.
out
.
	`´šn
(" -P†ocation ofhe…roperties fileo†oad.");

39 
Sy¡em
.
out
.
	`´šn
(" -c SQL commandoƒxecute.");

42 
´iv©e
 
	$execu‹Commªd
(
Prİ”t›s
 
´İs
, 
SŒšg
 
sql
è
throws
 
SQLExû±iÚ
 {

43 
SŒšg
 
driv”
 = 
´İs
.
	`g‘Prİ”ty
(
JdbcDBCl›Á
.
DRIVER_CLASS
);

44 
SŒšg
 
u£ºame
 = 
´İs
.
	`g‘Prİ”ty
(
JdbcDBCl›Á
.
CONNECTION_USER
);

45 
SŒšg
 
·sswÜd
 = 
´İs
.
	`g‘Prİ”ty
(
JdbcDBCl›Á
.
CONNECTION_PASSWD
, "");

46 
SŒšg
 
u¾
 = 
´İs
.
	`g‘Prİ”ty
(
JdbcDBCl›Á
.
CONNECTION_URL
);

47 ià(
driv”
 =ğ
nuÎ
 || 
u£ºame
 =ğnuÎ || 
u¾
 ==‚ull) {

48 
throw
 
Ãw
 
	`SQLExû±iÚ
("Missing connection information.");

51 
CÚÃùiÚ
 
cÚn
 = 
nuÎ
;

53 
Œy
 {

54 
CÏss
.
	`fÜName
(
driv”
);

56 
cÚn
 = 
Driv”Mªag”
.
	`g‘CÚÃùiÚ
(
u¾
, 
u£ºame
, 
·sswÜd
);

57 
S‹m’t
 
¡mt
 = 
cÚn
.
	`ü—‹S‹m’t
();

58 
¡mt
.
	`execu‹
(
sql
);

59 
Sy¡em
.
out
.
	`´šn
("Commªd \"" + 
sql
 + "\" successfullyƒxecuted.");

60 } 
	`ÿtch
 (
CÏssNÙFoundExû±iÚ
 
e
) {

61 
throw
 
Ãw
 
	`SQLExû±iÚ
("JDBC Driver class‚ot found.");

62 } 
fš®ly
 {

63 ià(
cÚn
 !ğ
nuÎ
) {

64 
Sy¡em
.
out
.
	`´šn
("Closing database connection.");

65 
cÚn
.
	`şo£
();

68 
	}
}

73 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

75 ià(
¬gs
.
Ëngth
 == 0) {

76 
	`u§geMes§ge
();

77 
Sy¡em
.
	`ex™
(0);

80 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

81 
Prİ”t›s
 
f•rİs
 = 
Ãw
 
	`Prİ”t›s
();

82 
SŒšg
 
sql
 = 
nuÎ
;

85 
¬gšdex
 = 0;

86 
¬gs
[
¬gšdex
].
	`¡¬tsW™h
("-")) {

87 ià(
¬gs
[
¬gšdex
].
	`com·»To
("-P") == 0) {

88 
¬gšdex
++;

89 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

90 
	`u§geMes§ge
();

91 
Sy¡em
.
	`ex™
(0);

93 
SŒšg
 
´İfe
 = 
¬gs
[
¬gšdex
];

94 
¬gšdex
++;

96 
Prİ”t›s
 
myf•rİs
 = 
Ãw
 
	`Prİ”t›s
();

97 
Œy
 {

98 
myf•rİs
.
	`lßd
(
Ãw
 
	`FeIÅutSŒ—m
(
´İfe
));

99 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

100 
Sy¡em
.
out
.
	`´šn
(
e
.
	`g‘Mes§ge
());

101 
Sy¡em
.
	`ex™
(0);

106 
Enum”©iÚ
<?> 
e
 = 
myf•rİs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

107 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

109 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
myf•rİs
.
	`g‘Prİ”ty
(prop));

112 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-p") == 0) {

113 
¬gšdex
++;

114 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

115 
	`u§geMes§ge
();

116 
Sy¡em
.
	`ex™
(0);

118 
eq
 = 
¬gs
[
¬gšdex
].
	`šdexOf
('=');

119 ià(
eq
 < 0) {

120 
	`u§geMes§ge
();

121 
Sy¡em
.
	`ex™
(0);

124 
SŒšg
 
Çme
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(0, 
eq
);

125 
SŒšg
 
v®ue
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(
eq
 + 1);

126 
´İs
.
	`put
(
Çme
, 
v®ue
);

127 
¬gšdex
++;

128 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-c") == 0) {

129 
¬gšdex
++;

130 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

131 
	`u§geMes§ge
();

132 
Sy¡em
.
	`ex™
(0);

134 
sql
 = 
¬gs
[
¬gšdex
++];

136 
Sy¡em
.
out
.
	`´šn
("UnknowÀİtiÚ " + 
¬gs
[
¬gšdex
]);

137 
	`u§geMes§ge
();

138 
Sy¡em
.
	`ex™
(0);

141 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

146 ià(
¬gšdex
 !ğ
¬gs
.
Ëngth
) {

147 
	`u§geMes§ge
();

148 
Sy¡em
.
	`ex™
(0);

155 
Enum”©iÚ
<?> 
e
 = 
´İs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

156 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

158 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
´İs
.
	`g‘Prİ”ty
(prop));

161 ià(
sql
 =ğ
nuÎ
) {

162 
Sy¡em
.
”r
.
	`´šn
("Missing command.");

163 
	`u§geMes§ge
();

164 
Sy¡em
.
	`ex™
(1);

167 
Œy
 {

168 
	`execu‹Commªd
(
f•rİs
, 
sql
);

169 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

170 
Sy¡em
.
”r
.
	`´šn
("E¼Ü iÀexecutšg commªd. " + 
e
);

171 
Sy¡em
.
	`ex™
(1);

173 
	}
}

178 
´iv©e
 
	$JdbcDBCli
() {

179 
	`su³r
();

180 
	}
}

	@jdbc/src/main/java/site/ycsb/db/JdbcDBClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

25 
impÜt
 
	gjava
.
	gsql
.*;

26 
impÜt
 
	gjava
.
	gut
.*;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gæavÜs
.
	gDBFÏvÜ
;

45 
public
 cÏs 
	cJdbcDBCl›Á
 
ex‹nds
 
	mDB
 {

48 
public
 
fš®
 
SŒšg
 
	mDRIVER_CLASS
 = "db.driver";

51 
public
 
fš®
 
SŒšg
 
	mCONNECTION_URL
 = "db.url";

54 
public
 
fš®
 
SŒšg
 
	mCONNECTION_USER
 = "db.user";

57 
public
 
fš®
 
SŒšg
 
	mCONNECTION_PASSWD
 = "db.passwd";

60 
public
 
fš®
 
SŒšg
 
	mDB_BATCH_SIZE
 = "db.batchsize";

63 
public
 
fš®
 
SŒšg
 
	mJDBC_FETCH_SIZE
 = "jdbc.fetchsize";

66 
public
 
fš®
 
SŒšg
 
	mJDBC_AUTO_COMMIT
 = "jdbc.autocommit";

68 
public
 
fš®
 
SŒšg
 
	mJDBC_BATCH_UPDATES
 = "jdbc.batchupdateapi";

71 
public
 
fš®
 
SŒšg
 
	mFIELD_COUNT_PROPERTY
 = "fieldcount";

74 
public
 
fš®
 
SŒšg
 
	mFIELD_COUNT_PROPERTY_DEFAULT
 = "10";

77 
public
 
fš®
 
SŒšg
 
	mNULL_VALUE
 = "NULL";

80 
public
 
fš®
 
SŒšg
 
	mPRIMARY_KEY
 = "YCSB_KEY";

83 
public
 
fš®
 
SŒšg
 
	mCOLUMN_PREFIX
 = "FIELD";

86 
´iv©e
 
boŞ—n
 
	msqÏnsiSÿns
 = 
çl£
;

88 
´iv©e
 
boŞ—n
 
	msql£rv”Sÿns
 = 
çl£
;

90 
´iv©e
 
	mLi¡
<
	mCÚÃùiÚ
> 
	mcÚns
;

91 
´iv©e
 
boŞ—n
 
	mš™Ÿlized
 = 
çl£
;

92 
´iv©e
 
Prİ”t›s
 
	m´İs
;

93 
´iv©e
 
	mjdbcF‘chSize
;

94 
´iv©e
 
	mb©chSize
;

95 
´iv©e
 
boŞ—n
 
	mautoComm™
;

96 
´iv©e
 
boŞ—n
 
	mb©chUpd©es
;

97 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_PROP
 = "";

98 
´iv©e
 
	mCÚcu¼’tM­
<
	mS‹m’tTy³
, 
	mP»·»dS‹m’t
> 
	mÿchedS‹m’ts
;

99 
´iv©e
 
	mnumRowsInB©ch
 = 0;

102 
´iv©e
 
DBFÏvÜ
 
	mdbFÏvÜ
;

107 
´iv©e
 şas 
	cOrd”edF›ldInfo
 {

108 
´iv©e
 
SŒšg
 
	mf›ldKeys
;

109 
´iv©e
 
	mLi¡
<
	mSŒšg
> 
	mf›ldV®ues
;

111 
Ord”edF›ldInfo
(
SŒšg
 
f›ldKeys
, 
Li¡
<SŒšg> 
f›ldV®ues
) {

112 
	mthis
.
	mf›ldKeys
 = 
f›ldKeys
;

113 
	mthis
.
	mf›ldV®ues
 = 
f›ldV®ues
;

116 
SŒšg
 
g‘F›ldKeys
() {

117  
	mf›ldKeys
;

120 
	mLi¡
<
	mSŒšg
> 
g‘F›ldV®ues
() {

121  
	mf›ldV®ues
;

131 
´iv©e
 
	$g‘Sh¬dIndexByKey
(
SŒšg
 
key
) {

132 
»t
 = 
M©h
.
	`abs
(
key
.
	`hashCode
()è% 
cÚns
.
	`size
();

133  
»t
;

134 
	}
}

143 
´iv©e
 
CÚÃùiÚ
 
	$g‘Sh¬dCÚÃùiÚByKey
(
SŒšg
 
key
) {

144  
cÚns
.
	`g‘
(
	`g‘Sh¬dIndexByKey
(
key
));

145 
	}
}

147 
´iv©e
 
	$ş—nupAÎCÚÃùiÚs
(è
throws
 
SQLExû±iÚ
 {

148 
CÚÃùiÚ
 
cÚn
 : 
cÚns
) {

149 ià(!
autoComm™
) {

150 
cÚn
.
	`comm™
();

152 
cÚn
.
	`şo£
();

154 
	}
}

157 
´iv©e
 
	$g‘IÁPrİ”ty
(
Prİ”t›s
 
´İs
, 
SŒšg
 
key
è
throws
 
DBExû±iÚ
 {

158 
SŒšg
 
v®ueSŒ
 = 
´İs
.
	`g‘Prİ”ty
(
key
);

159 ià(
v®ueSŒ
 !ğ
nuÎ
) {

160 
Œy
 {

161  
IÁeg”
.
	`·r£IÁ
(
v®ueSŒ
);

162 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

163 
Sy¡em
.
”r
.
	`´šn
("Inv®id " + 
key
 + " s³cif›d: " + 
v®ueSŒ
);

164 
throw
 
Ãw
 
	`DBExû±iÚ
(
nã
);

168 
	}
}

171 
´iv©e
 
boŞ—n
 
	$g‘BoŞPrİ”ty
(
Prİ”t›s
 
´İs
, 
SŒšg
 
key
, 
boŞ—n
 
deçuÉV®
) {

172 
SŒšg
 
v®ueSŒ
 = 
´İs
.
	`g‘Prİ”ty
(
key
);

173 ià(
v®ueSŒ
 !ğ
nuÎ
) {

174  
BoŞ—n
.
	`·r£BoŞ—n
(
v®ueSŒ
);

176  
deçuÉV®
;

177 
	}
}

179 @
Ov”ride


180 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

181 ià(
š™Ÿlized
) {

182 
Sy¡em
.
”r
.
	`´šn
("Client connection‡lready initialized.");

185 
´İs
 = 
	`g‘Prİ”t›s
();

186 
SŒšg
 
u¾s
 = 
´İs
.
	`g‘Prİ”ty
(
CONNECTION_URL
, 
DEFAULT_PROP
);

187 
SŒšg
 
u£r
 = 
´İs
.
	`g‘Prİ”ty
(
CONNECTION_USER
, 
DEFAULT_PROP
);

188 
SŒšg
 
·sswd
 = 
´İs
.
	`g‘Prİ”ty
(
CONNECTION_PASSWD
, 
DEFAULT_PROP
);

189 
SŒšg
 
driv”
 = 
´İs
.
	`g‘Prİ”ty
(
DRIVER_CLASS
);

191 
this
.
jdbcF‘chSize
 = 
	`g‘IÁPrİ”ty
(
´İs
, 
JDBC_FETCH_SIZE
);

192 
this
.
b©chSize
 = 
	`g‘IÁPrİ”ty
(
´İs
, 
DB_BATCH_SIZE
);

194 
this
.
autoComm™
 = 
	`g‘BoŞPrİ”ty
(
´İs
, 
JDBC_AUTO_COMMIT
, 
Œue
);

195 
this
.
b©chUpd©es
 = 
	`g‘BoŞPrİ”ty
(
´İs
, 
JDBC_BATCH_UPDATES
, 
çl£
);

197 
Œy
 {

203 ià(
driv”
 !ğ
nuÎ
) {

204 ià(
driv”
.
	`cÚšs
("sqlserver")) {

205 
sql£rv”Sÿns
 = 
Œue
;

206 
sqÏnsiSÿns
 = 
çl£
;

208 ià(
driv”
.
	`cÚšs
("oracle")) {

209 
sql£rv”Sÿns
 = 
çl£
;

210 
sqÏnsiSÿns
 = 
Œue
;

212 ià(
driv”
.
	`cÚšs
("postgres")) {

213 
sql£rv”Sÿns
 = 
çl£
;

214 
sqÏnsiSÿns
 = 
Œue
;

216 
CÏss
.
	`fÜName
(
driv”
);

218 
sh¬dCouÁ
 = 0;

219 
cÚns
 = 
Ãw
 
A¼ayLi¡
<
CÚÃùiÚ
>(3);

223 
fš®
 
SŒšg
[] 
u¾A¼
 = 
u¾s
.
	`¥l™
(";");

224 
SŒšg
 
u¾
 : 
u¾A¼
) {

225 
Sy¡em
.
out
.
	`´šn
("Addšg sh¬d‚odURL: " + 
u¾
);

226 
CÚÃùiÚ
 
cÚn
 = 
Driv”Mªag”
.
	`g‘CÚÃùiÚ
(
u¾
, 
u£r
, 
·sswd
);

232 
cÚn
.
	`£tAutoComm™
(
autoComm™
);

234 
sh¬dCouÁ
++;

235 
cÚns
.
	`add
(
cÚn
);

238 
Sy¡em
.
out
.
	`´šn
("Usšg sh¬ds: " + 
sh¬dCouÁ
 + ", b©chSize:" + 
b©chSize
 + ", f‘chSize: " + 
jdbcF‘chSize
);

240 
ÿchedS‹m’ts
 = 
Ãw
 
CÚcu¼’tHashM­
<
S‹m’tTy³
, 
P»·»dS‹m’t
>();

242 
this
.
dbFÏvÜ
 = 
DBFÏvÜ
.
	`äomJdbcU¾
(
u¾A¼
[0]);

243 } 
	`ÿtch
 (
CÏssNÙFoundExû±iÚ
 
e
) {

244 
Sy¡em
.
”r
.
	`´šn
("E¼Ü iÀš™ŸlizšghJDBS driv”: " + 
e
);

245 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

246 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

247 
Sy¡em
.
”r
.
	`´šn
("E¼Ü iÀd©aba£ o³¿tiÚ: " + 
e
);

248 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

249 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
e
) {

250 
Sy¡em
.
”r
.
	`´šn
("Inv®id v®ufÜ f›ldcouÁ…rİ”ty. " + 
e
);

251 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

254 
š™Ÿlized
 = 
Œue
;

255 
	}
}

257 @
Ov”ride


258 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

259 ià(
b©chSize
 > 0) {

260 
Œy
 {

262 
P»·»dS‹m’t
 
¡
 : 
ÿchedS‹m’ts
.
	`v®ues
()) {

263 ià(!
¡
.
	`g‘CÚÃùiÚ
().
	`isClo£d
(è&& !¡.isClo£d(è&& (
numRowsInB©ch
 % 
b©chSize
 != 0)) {

264 
¡
.
	`execu‹B©ch
();

267 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

268 
Sy¡em
.
”r
.
	`´šn
("E¼Ü iÀş—nu°executiÚ. " + 
e
);

269 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

273 
Œy
 {

274 
	`ş—nupAÎCÚÃùiÚs
();

275 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

276 
Sy¡em
.
”r
.
	`´šn
("E¼Ü iÀşosšghcÚÃùiÚ. " + 
e
);

277 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

279 
	}
}

281 
´iv©e
 
P»·»dS‹m’t
 
	$ü—‹AndCacheIn£¹S‹m’t
(
S‹m’tTy³
 
š£¹Ty³
, 
SŒšg
 
key
)

282 
throws
 
SQLExû±iÚ
 {

283 
SŒšg
 
š£¹
 = 
dbFÏvÜ
.
	`ü—‹In£¹S‹m’t
(
š£¹Ty³
, 
key
);

284 
P»·»dS‹m’t
 
š£¹S‹m’t
 = 
	`g‘Sh¬dCÚÃùiÚByKey
(
key
).
	`´•¬eS‹m’t
(
š£¹
);

285 
P»·»dS‹m’t
 
¡mt
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
š£¹Ty³
, 
š£¹S‹m’t
);

286 ià(
¡mt
 =ğ
nuÎ
) {

287  
š£¹S‹m’t
;

289  
¡mt
;

290 
	}
}

292 
´iv©e
 
P»·»dS‹m’t
 
	$ü—‹AndCacheR—dS‹m’t
(
S‹m’tTy³
 
»adTy³
, 
SŒšg
 
key
)

293 
throws
 
SQLExû±iÚ
 {

294 
SŒšg
 
»ad
 = 
dbFÏvÜ
.
	`ü—‹R—dS‹m’t
(
»adTy³
, 
key
);

295 
P»·»dS‹m’t
 
»adS‹m’t
 = 
	`g‘Sh¬dCÚÃùiÚByKey
(
key
).
	`´•¬eS‹m’t
(
»ad
);

296 
P»·»dS‹m’t
 
¡mt
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
»adTy³
, 
»adS‹m’t
);

297 ià(
¡mt
 =ğ
nuÎ
) {

298  
»adS‹m’t
;

300  
¡mt
;

301 
	}
}

303 
´iv©e
 
P»·»dS‹m’t
 
	$ü—‹AndCacheD–‘eS‹m’t
(
S‹m’tTy³
 
d–‘eTy³
, 
SŒšg
 
key
)

304 
throws
 
SQLExû±iÚ
 {

305 
SŒšg
 
d–‘e
 = 
dbFÏvÜ
.
	`ü—‹D–‘eS‹m’t
(
d–‘eTy³
, 
key
);

306 
P»·»dS‹m’t
 
d–‘eS‹m’t
 = 
	`g‘Sh¬dCÚÃùiÚByKey
(
key
).
	`´•¬eS‹m’t
(
d–‘e
);

307 
P»·»dS‹m’t
 
¡mt
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
d–‘eTy³
, 
d–‘eS‹m’t
);

308 ià(
¡mt
 =ğ
nuÎ
) {

309  
d–‘eS‹m’t
;

311  
¡mt
;

312 
	}
}

314 
´iv©e
 
P»·»dS‹m’t
 
	$ü—‹AndCacheUpd©eS‹m’t
(
S‹m’tTy³
 
upd©eTy³
, 
SŒšg
 
key
)

315 
throws
 
SQLExû±iÚ
 {

316 
SŒšg
 
upd©e
 = 
dbFÏvÜ
.
	`ü—‹Upd©eS‹m’t
(
upd©eTy³
, 
key
);

317 
P»·»dS‹m’t
 
š£¹S‹m’t
 = 
	`g‘Sh¬dCÚÃùiÚByKey
(
key
).
	`´•¬eS‹m’t
(
upd©e
);

318 
P»·»dS‹m’t
 
¡mt
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
upd©eTy³
, 
š£¹S‹m’t
);

319 ià(
¡mt
 =ğ
nuÎ
) {

320  
š£¹S‹m’t
;

322  
¡mt
;

323 
	}
}

325 
´iv©e
 
P»·»dS‹m’t
 
	$ü—‹AndCacheSÿnS‹m’t
(
S‹m’tTy³
 
sÿnTy³
, 
SŒšg
 
key
)

326 
throws
 
SQLExû±iÚ
 {

327 
SŒšg
 
£Ëù
 = 
dbFÏvÜ
.
	`ü—‹SÿnS‹m’t
(
sÿnTy³
, 
key
, 
sql£rv”Sÿns
, 
sqÏnsiSÿns
);

328 
P»·»dS‹m’t
 
sÿnS‹m’t
 = 
	`g‘Sh¬dCÚÃùiÚByKey
(
key
).
	`´•¬eS‹m’t
(
£Ëù
);

329 ià(
this
.
jdbcF‘chSize
 > 0) {

330 
sÿnS‹m’t
.
	`£tF‘chSize
(
this
.
jdbcF‘chSize
);

332 
P»·»dS‹m’t
 
¡mt
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
sÿnTy³
, 
sÿnS‹m’t
);

333 ià(
¡mt
 =ğ
nuÎ
) {

334  
sÿnS‹m’t
;

336  
¡mt
;

337 
	}
}

339 @
Ov”ride


340 
public
 
Stus
 
»ad
(
SŒšg
 
bËName
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

341 
	gŒy
 {

342 
S‹m’tTy³
 
	gty³
 = 
Ãw
 S‹m’tTy³(S‹m’tTy³.
Ty³
.
READ
, 
bËName
, 1, "", 
g‘Sh¬dIndexByKey
(
key
));

343 
P»·»dS‹m’t
 
	g»adS‹m’t
 = 
ÿchedS‹m’ts
.
g‘
(
ty³
);

344 ià(
	g»adS‹m’t
 =ğ
nuÎ
) {

345 
»adS‹m’t
 = 
ü—‹AndCacheR—dS‹m’t
(
ty³
, 
key
);

347 
	g»adS‹m’t
.
£tSŒšg
(1, 
key
);

348 
ResuÉS‘
 
	g»suÉS‘
 = 
»adS‹m’t
.
execu‹Qu”y
();

349 ià(!
	g»suÉS‘
.
Ãxt
()) {

350 
	g»suÉS‘
.
şo£
();

351  
	gStus
.
	gNOT_FOUND
;

353 ià(
	g»suÉ
 !ğ
nuÎ
 && 
f›lds
 !=‚ull) {

354 
SŒšg
 
f›ld
 : 
f›lds
) {

355 
SŒšg
 
v®ue
 = 
»suÉS‘
.
g‘SŒšg
(
f›ld
);

356 
	g»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
));

359 
	g»suÉS‘
.
şo£
();

360  
	gStus
.
	gOK
;

361 } 
ÿtch
 (
SQLExû±iÚ
 
e
) {

362 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü iÀ´oûssšg„—d oàbË " + 
bËName
 + ": " + 
e
);

363  
	gStus
.
	gERROR
;

367 @
Ov”ride


368 
public
 
Stus
 
sÿn
(
SŒšg
 
bËName
, SŒšg 
¡¬tKey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

369 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

370 
	gŒy
 {

371 
S‹m’tTy³
 
	gty³
 = 
Ãw
 S‹m’tTy³(S‹m’tTy³.
Ty³
.
SCAN
, 
bËName
, 1, "", 
g‘Sh¬dIndexByKey
(
¡¬tKey
));

372 
P»·»dS‹m’t
 
	gsÿnS‹m’t
 = 
ÿchedS‹m’ts
.
g‘
(
ty³
);

373 ià(
	gsÿnS‹m’t
 =ğ
nuÎ
) {

374 
sÿnS‹m’t
 = 
ü—‹AndCacheSÿnS‹m’t
(
ty³
, 
¡¬tKey
);

377 ià(
	gsql£rv”Sÿns
) {

378 
	gsÿnS‹m’t
.
£tIÁ
(1, 
»cÜdcouÁ
);

379 
	gsÿnS‹m’t
.
£tSŒšg
(2, 
¡¬tKey
);

382 
	gsÿnS‹m’t
.
£tSŒšg
(1, 
¡¬tKey
);

383 
	gsÿnS‹m’t
.
£tIÁ
(2, 
»cÜdcouÁ
);

385 
ResuÉS‘
 
	g»suÉS‘
 = 
sÿnS‹m’t
.
execu‹Qu”y
();

386 
	gi
 = 0; i < 
	g»cÜdcouÁ
 && 
	g»suÉS‘
.
Ãxt
(); i++) {

387 ià(
	g»suÉ
 !ğ
nuÎ
 && 
f›lds
 !=‚ull) {

388 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashM­<SŒšg, 
	gBy‹I‹¿tÜ
>();

389 
SŒšg
 
	gf›ld
 : 
f›lds
) {

390 
SŒšg
 
v®ue
 = 
»suÉS‘
.
g‘SŒšg
(
f›ld
);

391 
	gv®ues
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
));

393 
	g»suÉ
.
add
(
v®ues
);

396 
	g»suÉS‘
.
şo£
();

397  
	gStus
.
	gOK
;

398 } 
ÿtch
 (
SQLExû±iÚ
 
e
) {

399 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü iÀ´oûssšg sÿÀoàbË: " + 
bËName
 + 
e
);

400  
	gStus
.
	gERROR
;

404 @
Ov”ride


405 
public
 
Stus
 
upd©e
(
SŒšg
 
bËName
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

406 
	gŒy
 {

407 
	gnumF›lds
 = 
v®ues
.
size
();

408 
Ord”edF›ldInfo
 
	gf›ldInfo
 = 
g‘F›ldInfo
(
v®ues
);

409 
S‹m’tTy³
 
	gty³
 = 
Ãw
 S‹m’tTy³(S‹m’tTy³.
Ty³
.
UPDATE
, 
bËName
,

410 
numF›lds
, 
f›ldInfo
.
g‘F›ldKeys
(), 
g‘Sh¬dIndexByKey
(
key
));

411 
P»·»dS‹m’t
 
	gupd©eS‹m’t
 = 
ÿchedS‹m’ts
.
g‘
(
ty³
);

412 ià(
	gupd©eS‹m’t
 =ğ
nuÎ
) {

413 
upd©eS‹m’t
 = 
ü—‹AndCacheUpd©eS‹m’t
(
ty³
, 
key
);

415 
	gšdex
 = 1;

416 
SŒšg
 
	gv®ue
: 
f›ldInfo
.
g‘F›ldV®ues
()) {

417 
upd©eS‹m’t
.
£tSŒšg
(
šdex
++, 
v®ue
);

419 
	gupd©eS‹m’t
.
£tSŒšg
(
šdex
, 
key
);

420 
	g»suÉ
 = 
upd©eS‹m’t
.
execu‹Upd©e
();

421 ià(
	g»suÉ
 == 1) {

422  
Stus
.
OK
;

424  
	gStus
.
	gUNEXPECTED_STATE
;

425 } 
ÿtch
 (
SQLExû±iÚ
 
e
) {

426 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü iÀ´oûssšg upd©tØbË: " + 
bËName
 + 
e
);

427  
	gStus
.
	gERROR
;

431 @
Ov”ride


432 
public
 
Stus
 
š£¹
(
SŒšg
 
bËName
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

433 
	gŒy
 {

434 
	gnumF›lds
 = 
v®ues
.
size
();

435 
Ord”edF›ldInfo
 
	gf›ldInfo
 = 
g‘F›ldInfo
(
v®ues
);

436 
S‹m’tTy³
 
	gty³
 = 
Ãw
 S‹m’tTy³(S‹m’tTy³.
Ty³
.
INSERT
, 
bËName
,

437 
numF›lds
, 
f›ldInfo
.
g‘F›ldKeys
(), 
g‘Sh¬dIndexByKey
(
key
));

438 
P»·»dS‹m’t
 
	gš£¹S‹m’t
 = 
ÿchedS‹m’ts
.
g‘
(
ty³
);

439 ià(
	gš£¹S‹m’t
 =ğ
nuÎ
) {

440 
š£¹S‹m’t
 = 
ü—‹AndCacheIn£¹S‹m’t
(
ty³
, 
key
);

442 
	gš£¹S‹m’t
.
£tSŒšg
(1, 
key
);

443 
	gšdex
 = 2;

444 
SŒšg
 
	gv®ue
: 
f›ldInfo
.
g‘F›ldV®ues
()) {

445 
š£¹S‹m’t
.
£tSŒšg
(
šdex
++, 
v®ue
);

448 ià(
	gb©chUpd©es
) {

449 
	gš£¹S‹m’t
.
addB©ch
();

451 ià(
	gb©chSize
 > 0) {

453 ià(++
	gnumRowsInB©ch
 % 
	gb©chSize
 == 0) {

454 [] 
»suÉs
 = 
š£¹S‹m’t
.
execu‹B©ch
();

455 
	gr
 : 
»suÉs
) {

457 ià(
r
 != 1 &&„ != -2) {

458  
Stus
.
ERROR
;

462 ià(!
	gautoComm™
) {

463 
g‘Sh¬dCÚÃùiÚByKey
(
key
).
comm™
();

465  
	gStus
.
	gOK
;

469  
	gStus
.
	gBATCHED_OK
;

472 
	g»suÉ
 = 
š£¹S‹m’t
.
execu‹Upd©e
();

474 ià(!
	gautoComm™
) {

476 ià(
	gb©chSize
 > 0) {

477 ià(++
	gnumRowsInB©ch
 % 
	gb©chSize
 == 0) {

479 
g‘Sh¬dCÚÃùiÚByKey
(
key
).
comm™
();

482  
	gStus
.
	gOK
;

485 
g‘Sh¬dCÚÃùiÚByKey
(
key
).
comm™
();

488 ià(
	g»suÉ
 == 1) {

489  
Stus
.
OK
;

492  
	gStus
.
	gUNEXPECTED_STATE
;

493 } 
ÿtch
 (
SQLExû±iÚ
 
e
) {

494 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü iÀ´oûssšg in£¹ØbË: " + 
bËName
 + 
e
);

495  
	gStus
.
	gERROR
;

499 @
Ov”ride


500 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bËName
, SŒšg 
key
) {

501 
Œy
 {

502 
S‹m’tTy³
 
ty³
 = 
Ãw
 
	`S‹m’tTy³
(S‹m’tTy³.
Ty³
.
DELETE
, 
bËName
, 1, "", 
	`g‘Sh¬dIndexByKey
(
key
));

503 
P»·»dS‹m’t
 
d–‘eS‹m’t
 = 
ÿchedS‹m’ts
.
	`g‘
(
ty³
);

504 ià(
d–‘eS‹m’t
 =ğ
nuÎ
) {

505 
d–‘eS‹m’t
 = 
	`ü—‹AndCacheD–‘eS‹m’t
(
ty³
, 
key
);

507 
d–‘eS‹m’t
.
	`£tSŒšg
(1, 
key
);

508 
»suÉ
 = 
d–‘eS‹m’t
.
	`execu‹Upd©e
();

509 ià(
»suÉ
 == 1) {

510  
Stus
.
OK
;

512  
Stus
.
UNEXPECTED_STATE
;

513 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

514 
Sy¡em
.
”r
.
	`´šn
("E¼Ü iÀ´oûssšg d–‘tØbË: " + 
bËName
 + 
e
);

515  
Stus
.
ERROR
;

517 
	}
}

519 
´iv©e
 
Ord”edF›ldInfo
 
g‘F›ldInfo
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

520 
SŒšg
 
	gf›ldKeys
 = "";

521 
	gLi¡
<
	gSŒšg
> 
	gf›ldV®ues
 = 
Ãw
 
A¼ayLi¡
<>();

522 
	gcouÁ
 = 0;

523 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

524 
f›ldKeys
 +ğ
’Œy
.
g‘Key
();

525 ià(
	gcouÁ
 < 
	gv®ues
.
size
() - 1) {

526 
	gf›ldKeys
 += ",";

528 
	gf›ldV®ues
.
add
(
couÁ
, 
’Œy
.
g‘V®ue
().
toSŒšg
());

529 
	gcouÁ
++;

532  
Ãw
 
Ord”edF›ldInfo
(
f›ldKeys
, 
f›ldV®ues
);

	@jdbc/src/main/java/site/ycsb/db/JdbcDBCreateTable.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

20 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

21 
impÜt
 
	gjava
.
	gsql
.
	gCÚÃùiÚ
;

22 
impÜt
 
	gjava
.
	gsql
.
	gDriv”Mªag”
;

23 
impÜt
 
	gjava
.
	gsql
.
	gSQLExû±iÚ
;

24 
impÜt
 
	gjava
.
	gsql
.
	gS‹m’t
;

25 
impÜt
 
	gjava
.
	gut
.
	gEnum”©iÚ
;

26 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

33 
public
 
fš®
 cÏs 
	cJdbcDBC»©eTabË
 {

35 
´iv©e
 
	$u§geMes§ge
() {

36 
Sy¡em
.
out
.
	`´šn
("Create Table Client. Options:");

37 
Sy¡em
.
out
.
	`´šn
(" -p key=value…roperties defined.");

38 
Sy¡em
.
out
.
	`´šn
(" -P†ocation ofhe…roperties fileo†oad.");

39 
Sy¡em
.
out
.
	`´šn
(" -n‚ame ofheable.");

40 
Sy¡em
.
out
.
	`´šn
(" -f‚umber of fields (default 10).");

43 
´iv©e
 
	$ü—‹TabË
(
Prİ”t›s
 
´İs
, 
SŒšg
 
bËÇme
è
throws
 
SQLExû±iÚ
 {

44 
SŒšg
 
driv”
 = 
´İs
.
	`g‘Prİ”ty
(
JdbcDBCl›Á
.
DRIVER_CLASS
);

45 
SŒšg
 
u£ºame
 = 
´İs
.
	`g‘Prİ”ty
(
JdbcDBCl›Á
.
CONNECTION_USER
);

46 
SŒšg
 
·sswÜd
 = 
´İs
.
	`g‘Prİ”ty
(
JdbcDBCl›Á
.
CONNECTION_PASSWD
, "");

47 
SŒšg
 
u¾
 = 
´İs
.
	`g‘Prİ”ty
(
JdbcDBCl›Á
.
CONNECTION_URL
);

48 
f›ldcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
JdbcDBCl›Á
.
FIELD_COUNT_PROPERTY
,

49 
JdbcDBCl›Á
.
FIELD_COUNT_PROPERTY_DEFAULT
));

51 ià(
driv”
 =ğ
nuÎ
 || 
u£ºame
 =ğnuÎ || 
u¾
 ==‚ull) {

52 
throw
 
Ãw
 
	`SQLExû±iÚ
("Missing connection information.");

55 
CÚÃùiÚ
 
cÚn
 = 
nuÎ
;

57 
Œy
 {

58 
CÏss
.
	`fÜName
(
driv”
);

60 
cÚn
 = 
Driv”Mªag”
.
	`g‘CÚÃùiÚ
(
u¾
, 
u£ºame
, 
·sswÜd
);

61 
S‹m’t
 
¡mt
 = 
cÚn
.
	`ü—‹S‹m’t
();

63 
SŒšgBud”
 
sql
 = 
Ãw
 
	`SŒšgBud”
("DROP TABLE IF EXISTS ");

64 
sql
.
	`­³nd
(
bËÇme
);

65 
sql
.
	`­³nd
(";");

67 
¡mt
.
	`execu‹
(
sql
.
	`toSŒšg
());

69 
sql
 = 
Ãw
 
	`SŒšgBud”
("CREATE TABLE ");

70 
sql
.
	`­³nd
(
bËÇme
);

71 
sql
.
	`­³nd
(" (YCSB_KEY VARCHAR PRIMARY KEY");

73 
idx
 = 0; idx < 
f›ldcouÁ
; idx++) {

74 
sql
.
	`­³nd
(", FIELD");

75 
sql
.
	`­³nd
(
idx
);

76 
sql
.
	`­³nd
(" TEXT");

78 
sql
.
	`­³nd
(");");

80 
¡mt
.
	`execu‹
(
sql
.
	`toSŒšg
());

82 
Sy¡em
.
out
.
	`´šn
("TabË " + 
bËÇme
 + " created..");

83 } 
	`ÿtch
 (
CÏssNÙFoundExû±iÚ
 
e
) {

84 
throw
 
Ãw
 
	`SQLExû±iÚ
("JDBC Driver class‚ot found.");

85 } 
fš®ly
 {

86 ià(
cÚn
 !ğ
nuÎ
) {

87 
Sy¡em
.
out
.
	`´šn
("Closing database connection.");

88 
cÚn
.
	`şo£
();

91 
	}
}

96 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

98 ià(
¬gs
.
Ëngth
 == 0) {

99 
	`u§geMes§ge
();

100 
Sy¡em
.
	`ex™
(0);

103 
SŒšg
 
bËÇme
 = 
nuÎ
;

104 
f›ldcouÁ
 = -1;

105 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

106 
Prİ”t›s
 
f•rİs
 = 
Ãw
 
	`Prİ”t›s
();

109 
¬gšdex
 = 0;

110 
¬gs
[
¬gšdex
].
	`¡¬tsW™h
("-")) {

111 ià(
¬gs
[
¬gšdex
].
	`com·»To
("-P") == 0) {

112 
¬gšdex
++;

113 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

114 
	`u§geMes§ge
();

115 
Sy¡em
.
	`ex™
(0);

117 
SŒšg
 
´İfe
 = 
¬gs
[
¬gšdex
];

118 
¬gšdex
++;

120 
Prİ”t›s
 
myf•rİs
 = 
Ãw
 
	`Prİ”t›s
();

121 
Œy
 {

122 
myf•rİs
.
	`lßd
(
Ãw
 
	`FeIÅutSŒ—m
(
´İfe
));

123 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

124 
Sy¡em
.
out
.
	`´šn
(
e
.
	`g‘Mes§ge
());

125 
Sy¡em
.
	`ex™
(0);

130 
Enum”©iÚ
<?> 
e
 = 
myf•rİs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

131 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

133 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
myf•rİs
.
	`g‘Prİ”ty
(prop));

136 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-p") == 0) {

137 
¬gšdex
++;

138 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

139 
	`u§geMes§ge
();

140 
Sy¡em
.
	`ex™
(0);

142 
eq
 = 
¬gs
[
¬gšdex
].
	`šdexOf
('=');

143 ià(
eq
 < 0) {

144 
	`u§geMes§ge
();

145 
Sy¡em
.
	`ex™
(0);

148 
SŒšg
 
Çme
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(0, 
eq
);

149 
SŒšg
 
v®ue
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(
eq
 + 1);

150 
´İs
.
	`put
(
Çme
, 
v®ue
);

151 
¬gšdex
++;

152 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-n") == 0) {

153 
¬gšdex
++;

154 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

155 
	`u§geMes§ge
();

156 
Sy¡em
.
	`ex™
(0);

158 
bËÇme
 = 
¬gs
[
¬gšdex
++];

159 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-f") == 0) {

160 
¬gšdex
++;

161 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

162 
	`u§geMes§ge
();

163 
Sy¡em
.
	`ex™
(0);

165 
Œy
 {

166 
f›ldcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[
¬gšdex
++]);

167 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
e
) {

168 
Sy¡em
.
”r
.
	`´šn
("Invalid‚umber for field count");

169 
	`u§geMes§ge
();

170 
Sy¡em
.
	`ex™
(1);

173 
Sy¡em
.
out
.
	`´šn
("UnknowÀİtiÚ " + 
¬gs
[
¬gšdex
]);

174 
	`u§geMes§ge
();

175 
Sy¡em
.
	`ex™
(0);

178 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

183 ià(
¬gšdex
 !ğ
¬gs
.
Ëngth
) {

184 
	`u§geMes§ge
();

185 
Sy¡em
.
	`ex™
(0);

192 
Enum”©iÚ
<?> 
e
 = 
´İs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

193 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

195 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
´İs
.
	`g‘Prİ”ty
(prop));

198 
´İs
 = 
f•rİs
;

200 ià(
bËÇme
 =ğ
nuÎ
) {

201 
Sy¡em
.
”r
.
	`´šn
("table‚ame missing.");

202 
	`u§geMes§ge
();

203 
Sy¡em
.
	`ex™
(1);

206 ià(
f›ldcouÁ
 > 0) {

207 
´İs
.
	`£tPrİ”ty
(
JdbcDBCl›Á
.
FIELD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
f›ldcouÁ
));

210 
Œy
 {

211 
	`ü—‹TabË
(
´İs
, 
bËÇme
);

212 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

213 
Sy¡em
.
”r
.
	`´šn
("E¼Ü iÀü—tšgabË. " + 
e
);

214 
Sy¡em
.
	`ex™
(1);

216 
	}
}

221 
´iv©e
 
	$JdbcDBC»©eTabË
() {

222 
	`su³r
();

223 
	}
}

	@jdbc/src/main/java/site/ycsb/db/StatementType.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

22 
public
 cÏs 
	cS‹m’tTy³
 {

24 
	eTy³
 {

25 
INSERT
(1), 
DELETE
(2), 
READ
(3), 
UPDATE
(4), 
SCAN
(5);

27 
´iv©e
 
fš®
 
	mš‹º®Ty³
;

29 
´iv©e
 
Ty³
(
ty³
) {

30 
	mš‹º®Ty³
 = 
ty³
;

33 
g‘HashCode
() {

34 
fš®
 
	m´ime
 = 31;

35 
	m»suÉ
 = 1;

36 
	m»suÉ
 = 
´ime
 * 
»suÉ
 + 
š‹º®Ty³
;

37  
	m»suÉ
;

41 
´iv©e
 
Ty³
 
	gty³
;

42 
´iv©e
 
	gsh¬dIndex
;

43 
´iv©e
 
	gnumF›lds
;

44 
´iv©e
 
SŒšg
 
	gbËName
;

45 
´iv©e
 
SŒšg
 
	gf›ldSŒšg
;

47 
public
 
	$S‹m’tTy³
(
Ty³
 
ty³
, 
SŒšg
 
bËName
, 
numF›lds
, SŒšg 
f›ldSŒšg
, 
sh¬dIndex
) {

48 
this
.
ty³
 =ype;

49 
this
.
bËName
 =ableName;

50 
this
.
numF›lds
 =‚umFields;

51 
this
.
f›ldSŒšg
 = fieldString;

52 
this
.
sh¬dIndex
 = shardIndex;

53 
	}
}

55 
public
 
SŒšg
 
	$g‘TabËName
() {

56  
bËName
;

57 
	}
}

59 
public
 
SŒšg
 
	$g‘F›ldSŒšg
() {

60  
f›ldSŒšg
;

61 
	}
}

63 
public
 
	$g‘NumF›lds
() {

64  
numF›lds
;

65 
	}
}

67 @
Ov”ride


68 
public
 
	$hashCode
() {

69 
fš®
 
´ime
 = 31;

70 
»suÉ
 = 1;

71 
»suÉ
 = 
´ime
 *„esuÉ + 
numF›lds
 + 100 * 
sh¬dIndex
;

72 
»suÉ
 = 
´ime
 *„esuÉ + ((
bËName
 =ğ
nuÎ
è? 0 :abËName.
	`hashCode
());

73 
»suÉ
 = 
´ime
 *„esuÉ + ((
ty³
 =ğ
nuÎ
è? 0 :y³.
	`g‘HashCode
());

74  
»suÉ
;

75 
	}
}

77 @
Ov”ride


78 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

79 ià(
this
 =ğ
obj
) {

80  
Œue
;

82 ià(
obj
 =ğ
nuÎ
) {

83  
çl£
;

85 ià(
	`g‘CÏss
(è!ğ
obj
.getClass()) {

86  
çl£
;

88 
S‹m’tTy³
 
Ùh”
 = (S‹m’tTy³è
obj
;

89 ià(
numF›lds
 !ğ
Ùh”
.numFields) {

90  
çl£
;

92 ià(
sh¬dIndex
 !ğ
Ùh”
.shardIndex) {

93  
çl£
;

95 ià(
bËName
 =ğ
nuÎ
) {

96 ià(
Ùh”
.
bËName
 !ğ
nuÎ
) {

97  
çl£
;

99 } ià(!
bËName
.
	`equ®s
(
Ùh”
.tableName)) {

100  
çl£
;

102 ià(
ty³
 !ğ
Ùh”
.type) {

103  
çl£
;

105 ià(!
f›ldSŒšg
.
	`equ®s
(
Ùh”
.fieldString)) {

106  
çl£
;

108  
Œue
;

109 
	}
}

	@jdbc/src/main/java/site/ycsb/db/flavors/DBFlavor.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gæavÜs
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gS‹m’tTy³
;

25 
public
 
ab¡¿ù
 cÏs 
	cDBFÏvÜ
 {

27 
	eDBName
 {

28 
	mDEFAULT
,

29 
	mPHOENIX


32 
´iv©e
 
fš®
 
DBName
 
	gdbName
;

34 
public
 
	$DBFÏvÜ
(
DBName
 
dbName
) {

35 
this
.
dbName
 = dbName;

36 
	}
}

38 
public
 
DBFÏvÜ
 
	$äomJdbcU¾
(
SŒšg
 
u¾
) {

39 ià(
u¾
.
	`¡¬tsW™h
("jdbc:phoenix")) {

40  
Ãw
 
	`PhÛnixDBFÏvÜ
();

42  
Ãw
 
	`DeçuÉDBFÏvÜ
();

43 
	}
}

48 
public
 
ab¡¿ù
 
SŒšg
 
ü—‹In£¹S‹m’t
(
S‹m’tTy³
 
š£¹Ty³
, SŒšg 
key
);

53 
public
 
ab¡¿ù
 
SŒšg
 
ü—‹R—dS‹m’t
(
S‹m’tTy³
 
»adTy³
, SŒšg 
key
);

58 
public
 
ab¡¿ù
 
SŒšg
 
ü—‹D–‘eS‹m’t
(
S‹m’tTy³
 
d–‘eTy³
, SŒšg 
key
);

63 
public
 
ab¡¿ù
 
SŒšg
 
ü—‹Upd©eS‹m’t
(
S‹m’tTy³
 
upd©eTy³
, SŒšg 
key
);

68 
public
 
ab¡¿ù
 
SŒšg
 
ü—‹SÿnS‹m’t
(
S‹m’tTy³
 
sÿnTy³
, SŒšg 
key
,

69 
boŞ—n
 
sql£rv”Sÿns
, boŞ—À
sqÏnsiSÿns
);

	@jdbc/src/main/java/site/ycsb/db/flavors/DefaultDBFlavor.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gæavÜs
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gJdbcDBCl›Á
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gS‹m’tTy³
;

25 
public
 cÏs 
	cDeçuÉDBFÏvÜ
 
ex‹nds
 
	mDBFÏvÜ
 {

26 
public
 
	$DeçuÉDBFÏvÜ
() {

27 
	`su³r
(
DBName
.
DEFAULT
);

29 
public
 
	$DeçuÉDBFÏvÜ
(
DBName
 
dbName
) {

30 
	`su³r
(
dbName
);

31 
	}
}

33 @
Ov”ride


34 
public
 
SŒšg
 
	$ü—‹In£¹S‹m’t
(
S‹m’tTy³
 
š£¹Ty³
, 
SŒšg
 
key
) {

35 
SŒšgBud”
 
š£¹
 = 
Ãw
 
	`SŒšgBud”
("INSERT INTO ");

36 
š£¹
.
	`­³nd
(
š£¹Ty³
.
	`g‘TabËName
());

37 
š£¹
.
	`­³nd
(" (" + 
JdbcDBCl›Á
.
PRIMARY_KEY
 + "," + 
š£¹Ty³
.
	`g‘F›ldSŒšg
() + ")");

38 
š£¹
.
	`­³nd
(" VALUES(?");

39 
i
 = 0; i < 
š£¹Ty³
.
	`g‘NumF›lds
(); i++) {

40 
š£¹
.
	`­³nd
(",?");

42 
š£¹
.
	`­³nd
(")");

43  
š£¹
.
	`toSŒšg
();

44 
	}
}

46 @
Ov”ride


47 
public
 
SŒšg
 
	$ü—‹R—dS‹m’t
(
S‹m’tTy³
 
»adTy³
, 
SŒšg
 
key
) {

48 
SŒšgBud”
 
»ad
 = 
Ãw
 
	`SŒšgBud”
("SELECT * FROM ");

49 
»ad
.
	`­³nd
(
»adTy³
.
	`g‘TabËName
());

50 
»ad
.
	`­³nd
(" WHERE ");

51 
»ad
.
	`­³nd
(
JdbcDBCl›Á
.
PRIMARY_KEY
);

52 
»ad
.
	`­³nd
(" = ");

53 
»ad
.
	`­³nd
("?");

54  
»ad
.
	`toSŒšg
();

55 
	}
}

57 @
Ov”ride


58 
public
 
SŒšg
 
	$ü—‹D–‘eS‹m’t
(
S‹m’tTy³
 
d–‘eTy³
, 
SŒšg
 
key
) {

59 
SŒšgBud”
 
d–‘e
 = 
Ãw
 
	`SŒšgBud”
("DELETE FROM ");

60 
d–‘e
.
	`­³nd
(
d–‘eTy³
.
	`g‘TabËName
());

61 
d–‘e
.
	`­³nd
(" WHERE ");

62 
d–‘e
.
	`­³nd
(
JdbcDBCl›Á
.
PRIMARY_KEY
);

63 
d–‘e
.
	`­³nd
(" = ?");

64  
d–‘e
.
	`toSŒšg
();

65 
	}
}

67 @
Ov”ride


68 
public
 
SŒšg
 
	$ü—‹Upd©eS‹m’t
(
S‹m’tTy³
 
upd©eTy³
, 
SŒšg
 
key
) {

69 
SŒšg
[] 
f›ldKeys
 = 
upd©eTy³
.
	`g‘F›ldSŒšg
().
	`¥l™
(",");

70 
SŒšgBud”
 
upd©e
 = 
Ãw
 
	`SŒšgBud”
("UPDATE ");

71 
upd©e
.
	`­³nd
(
upd©eTy³
.
	`g‘TabËName
());

72 
upd©e
.
	`­³nd
(" SET ");

73 
i
 = 0; i < 
f›ldKeys
.
Ëngth
; i++) {

74 
upd©e
.
	`­³nd
(
f›ldKeys
[
i
]);

75 
upd©e
.
	`­³nd
("=?");

76 ià(
i
 < 
f›ldKeys
.
Ëngth
 - 1) {

77 
upd©e
.
	`­³nd
(", ");

80 
upd©e
.
	`­³nd
(" WHERE ");

81 
upd©e
.
	`­³nd
(
JdbcDBCl›Á
.
PRIMARY_KEY
);

82 
upd©e
.
	`­³nd
(" = ?");

83  
upd©e
.
	`toSŒšg
();

84 
	}
}

86 @
Ov”ride


87 
public
 
SŒšg
 
	$ü—‹SÿnS‹m’t
(
S‹m’tTy³
 
sÿnTy³
, 
SŒšg
 
key
, 
boŞ—n
 
sql£rv”Sÿns
, boŞ—À
sqÏnsiSÿns
) {

88 
SŒšgBud”
 
£Ëù
;

89 ià(
sql£rv”Sÿns
) {

90 
£Ëù
 = 
Ãw
 
	`SŒšgBud”
("SELECT TOP (?) * FROM ");

92 
£Ëù
 = 
Ãw
 
	`SŒšgBud”
("SELECT * FROM ");

94 
£Ëù
.
	`­³nd
(
sÿnTy³
.
	`g‘TabËName
());

95 
£Ëù
.
	`­³nd
(" WHERE ");

96 
£Ëù
.
	`­³nd
(
JdbcDBCl›Á
.
PRIMARY_KEY
);

97 
£Ëù
.
	`­³nd
(" >= ?");

98 
£Ëù
.
	`­³nd
(" ORDER BY ");

99 
£Ëù
.
	`­³nd
(
JdbcDBCl›Á
.
PRIMARY_KEY
);

100 ià(!
sql£rv”Sÿns
) {

101 ià(
sqÏnsiSÿns
) {

102 
£Ëù
.
	`­³nd
(" FETCH FIRST ? ROWS ONLY");

104 
£Ëù
.
	`­³nd
(" LIMIT ?");

107  
£Ëù
.
	`toSŒšg
();

108 
	}
}

	@jdbc/src/main/java/site/ycsb/db/flavors/PhoenixDBFlavor.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gæavÜs
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gJdbcDBCl›Á
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gS‹m’tTy³
;

25 
public
 cÏs 
	cPhÛnixDBFÏvÜ
 
ex‹nds
 
	mDeçuÉDBFÏvÜ
 {

26 
public
 
	$PhÛnixDBFÏvÜ
() {

27 
	`su³r
(
DBName
.
PHOENIX
);

30 @
Ov”ride


31 
public
 
SŒšg
 
	$ü—‹In£¹S‹m’t
(
S‹m’tTy³
 
š£¹Ty³
, 
SŒšg
 
key
) {

33 
SŒšgBud”
 
š£¹
 = 
Ãw
 
	`SŒšgBud”
("UPSERT INTO ");

34 
š£¹
.
	`­³nd
(
š£¹Ty³
.
	`g‘TabËName
());

35 
š£¹
.
	`­³nd
(" (" + 
JdbcDBCl›Á
.
PRIMARY_KEY
 + "," + 
š£¹Ty³
.
	`g‘F›ldSŒšg
() + ")");

36 
š£¹
.
	`­³nd
(" VALUES(?");

37 
i
 = 0; i < 
š£¹Ty³
.
	`g‘NumF›lds
(); i++) {

38 
š£¹
.
	`­³nd
(",?");

40 
š£¹
.
	`­³nd
(")");

41  
š£¹
.
	`toSŒšg
();

42 
	}
}

44 @
Ov”ride


45 
public
 
SŒšg
 
	$ü—‹Upd©eS‹m’t
(
S‹m’tTy³
 
upd©eTy³
, 
SŒšg
 
key
) {

47 
SŒšg
[] 
f›ldKeys
 = 
upd©eTy³
.
	`g‘F›ldSŒšg
().
	`¥l™
(",");

48 
SŒšgBud”
 
upd©e
 = 
Ãw
 
	`SŒšgBud”
("UPSERT INTO ");

49 
upd©e
.
	`­³nd
(
upd©eTy³
.
	`g‘TabËName
());

50 
upd©e
.
	`­³nd
(" (");

52 
i
 = 0; i < 
f›ldKeys
.
Ëngth
; i++) {

53 
upd©e
.
	`­³nd
(
f›ldKeys
[
i
]).append(",");

56 
upd©e
.
	`­³nd
(
JdbcDBCl›Á
.
PRIMARY_KEY
).append(") VALUES(");

58 
i
 = 0; i < 
f›ldKeys
.
Ëngth
; i++) {

59 
upd©e
.
	`­³nd
("?, ");

62 
upd©e
.
	`­³nd
("?)");

63  
upd©e
.
	`toSŒšg
();

64 
	}
}

	@jdbc/src/main/java/site/ycsb/db/flavors/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gæavÜs
;

	@jdbc/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@jdbc/src/test/java/site/ycsb/db/JdbcDBClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.*;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

25 
impÜt
 
	gÜg
.
	gjun™
.*;

27 
impÜt
 
	gjava
.
	gsql
.*;

28 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

29 
impÜt
 
	gjava
.
	gut
.
	gM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

31 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

32 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

33 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

35 
public
 cÏs 
	cJdbcDBCl›ÁTe¡
 {

36 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_DB_DRIVER
 = "org.hsqldb.jdbc.JDBCDriver";

37 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_DB_URL
 = "jdbc:hsqldb:mem:ycsb";

38 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_DB_USER
 = "sa";

39 
´iv©e
 
fš®
 
SŒšg
 
	mTABLE_NAME
 = "USERTABLE";

40 
´iv©e
 
fš®
 
	mFIELD_LENGTH
 = 32;

41 
´iv©e
 
fš®
 
SŒšg
 
	mFIELD_PREFIX
 = "FIELD";

42 
´iv©e
 
fš®
 
SŒšg
 
	mKEY_PREFIX
 = "user";

43 
´iv©e
 
fš®
 
SŒšg
 
	mKEY_FIELD
 = "YCSB_KEY";

44 
´iv©e
 
fš®
 
	mNUM_FIELDS
 = 3;

46 
´iv©e
 
CÚÃùiÚ
 
	mjdbcCÚÃùiÚ
 = 
nuÎ
;

47 
´iv©e
 
JdbcDBCl›Á
 
	mjdbcDBCl›Á
 = 
nuÎ
;

49 @
BefÜeCÏss


50 
public
 
	$£tup
() {

51 
	`£tupW™hB©ch
(1, 
Œue
);

54 
public
 
	$£tupW™hB©ch
(
b©chSize
, 
boŞ—n
 
autoComm™
) {

55 
Œy
 {

56 
jdbcCÚÃùiÚ
 = 
Driv”Mªag”
.
	`g‘CÚÃùiÚ
(
TEST_DB_URL
);

57 
jdbcDBCl›Á
 = 
Ãw
 
	`JdbcDBCl›Á
();

59 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

60 
p
.
	`£tPrİ”ty
(
JdbcDBCl›Á
.
CONNECTION_URL
, 
TEST_DB_URL
);

61 
p
.
	`£tPrİ”ty
(
JdbcDBCl›Á
.
DRIVER_CLASS
, 
TEST_DB_DRIVER
);

62 
p
.
	`£tPrİ”ty
(
JdbcDBCl›Á
.
CONNECTION_USER
, 
TEST_DB_USER
);

63 
p
.
	`£tPrİ”ty
(
JdbcDBCl›Á
.
DB_BATCH_SIZE
, 
IÁeg”
.
	`toSŒšg
(
b©chSize
));

64 
p
.
	`£tPrİ”ty
(
JdbcDBCl›Á
.
JDBC_BATCH_UPDATES
, "true");

65 
p
.
	`£tPrİ”ty
(
JdbcDBCl›Á
.
JDBC_AUTO_COMMIT
, 
BoŞ—n
.
	`toSŒšg
(
autoComm™
));

67 
jdbcDBCl›Á
.
	`£tPrİ”t›s
(
p
);

68 
jdbcDBCl›Á
.
	`š™
();

69 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

70 
e
.
	`´štSckT¿û
();

71 
	`ç
("Could‚ot create†ocal Database");

72 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

73 
e
.
	`´štSckT¿û
();

74 
	`ç
("Could‚ot create JdbcDBClient instance");

76 
	}
}

78 @
Aá”CÏss


79 
public
 
	$‹¬down
() {

80 
Œy
 {

81 ià(
jdbcCÚÃùiÚ
 !ğ
nuÎ
) {

82 
jdbcCÚÃùiÚ
.
	`şo£
();

84 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

85 
e
.
	`´štSckT¿û
();

88 
Œy
 {

89 ià(
jdbcDBCl›Á
 !ğ
nuÎ
) {

90 
jdbcDBCl›Á
.
	`ş—nup
();

92 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

93 
e
.
	`´štSckT¿û
();

95 
	}
}

97 @
BefÜe


98 
public
 
	$´•¬eTe¡
() {

99 
Œy
 {

100 
D©aba£M‘aD©a
 
m‘aD©a
 = 
jdbcCÚÃùiÚ
.
	`g‘M‘aD©a
();

101 
ResuÉS‘
 
bËResuÉs
 = 
m‘aD©a
.
	`g‘TabËs
(
nuÎ
,‚uÎ, 
TABLE_NAME
,‚ull);

102 ià(
bËResuÉs
.
	`Ãxt
()) {

104 
jdbcCÚÃùiÚ
.
	`´•¬eS‹m’t
(

105 
SŒšg
.
	`fÜm©
("TRUNCATE TABLE %s", 
TABLE_NAME
)

106 ).
	`execu‹
();

109 
SŒšgBud”
 
ü—‹SŒšg
 = 
Ãw
 
	`SŒšgBud”
(

110 
SŒšg
.
	`fÜm©
("CREATE TABLE % (% VARCHAR(100èPRIMARY KEY", 
TABLE_NAME
, 
KEY_FIELD
)

112 
i
 = 0; i < 
NUM_FIELDS
; i++) {

113 
ü—‹SŒšg
.
	`­³nd
(

114 
SŒšg
.
	`fÜm©
(", %s%d VARCHAR(100)", 
FIELD_PREFIX
, 
i
)

117 
ü—‹SŒšg
.
	`­³nd
(")");

118 
jdbcCÚÃùiÚ
.
	`´•¬eS‹m’t
(
ü—‹SŒšg
.
	`toSŒšg
()).
	`execu‹
();

120 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

121 
e
.
	`´štSckT¿û
();

122 
	`ç
("Failedo…repareest");

124 
	}
}

130 
´iv©e
 
SŒšg
 
	$budD‘”mši¡icV®ue
(
SŒšg
 
key
, SŒšg 
f›ldkey
) {

131 
size
 = 
FIELD_LENGTH
;

132 
SŒšgBud”
 
sb
 = 
Ãw
 
	`SŒšgBud”
(
size
);

133 
sb
.
	`­³nd
(
key
);

134 
sb
.
	`­³nd
(':');

135 
sb
.
	`­³nd
(
f›ldkey
);

136 
sb
.
	`Ëngth
(è< 
size
) {

137 
sb
.
	`­³nd
(':');

138 
sb
.
	`­³nd
(sb.
	`toSŒšg
().
	`hashCode
());

140 
sb
.
	`£tL’gth
(
size
);

142  
sb
.
	`toSŒšg
();

143 
	}
}

148 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	$š£¹Row
(
SŒšg
 
š£¹Key
) {

149 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
Ãw
 HashMap<String, ByteIterator>();

150 
i
 = 0; i < 3; i++) {

151 
š£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
š£¹Key
, FIELD_PREFIX + i)));

153 
jdbcDBCl›Á
.
	`š£¹
(
TABLE_NAME
, 
š£¹Key
, 
š£¹M­
);

155  
š£¹M­
;

156 
	}
}

158 @
Te¡


159 
public
 
	$š£¹Te¡
() {

160 
Œy
 {

161 
SŒšg
 
š£¹Key
 = "user0";

162 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
	`š£¹Row
(
š£¹Key
);

164 
ResuÉS‘
 
»suÉS‘
 = 
jdbcCÚÃùiÚ
.
	`´•¬eS‹m’t
(

165 
SŒšg
.
	`fÜm©
("SELECT * FROM %s", 
TABLE_NAME
)

166 ).
	`execu‹Qu”y
();

169 
	`as£¹True
(
»suÉS‘
.
	`Ãxt
());

171 
	`as£¹Equ®s
(
»suÉS‘
.
	`g‘SŒšg
(
KEY_FIELD
), 
š£¹Key
);

172 
i
 = 0; i < 3; i++) {

173 
	`as£¹Equ®s
(
»suÉS‘
.
	`g‘SŒšg
(
FIELD_PREFIX
 + 
i
), 
š£¹M­
.
	`g‘
(FIELD_PREFIX + i).
	`toSŒšg
());

176 
	`as£¹F®£
(
»suÉS‘
.
	`Ãxt
());

178 
»suÉS‘
.
	`şo£
();

179 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

180 
e
.
	`´štSckT¿û
();

181 
	`ç
("Failed insertTest");

183 
	}
}

185 @
Te¡


186 
public
 
	$upd©eTe¡
() {

187 
Œy
 {

188 
SŒšg
 
´eupd©eSŒšg
 = "preupdate";

189 
SŒšgBud”
 
çuxIn£¹SŒšg
 = 
Ãw
 
	`SŒšgBud”
(

190 
SŒšg
.
	`fÜm©
("INSERT INTO % VALUES(?", 
TABLE_NAME
)

192 
i
 = 0; i < 
NUM_FIELDS
; i++) {

193 
çuxIn£¹SŒšg
.
	`­³nd
(",?");

195 
çuxIn£¹SŒšg
.
	`­³nd
(")");

197 
P»·»dS‹m’t
 
çuxIn£¹S‹m’t
 = 
jdbcCÚÃùiÚ
.
	`´•¬eS‹m’t
(
çuxIn£¹SŒšg
.
	`toSŒšg
());

198 
i
 = 2; i < 
NUM_FIELDS
 + 2; i++) {

199 
çuxIn£¹S‹m’t
.
	`£tSŒšg
(
i
, 
´eupd©eSŒšg
);

202 
çuxIn£¹S‹m’t
.
	`£tSŒšg
(1, "user0");

203 
çuxIn£¹S‹m’t
.
	`execu‹
();

204 
çuxIn£¹S‹m’t
.
	`£tSŒšg
(1, "user1");

205 
çuxIn£¹S‹m’t
.
	`execu‹
();

206 
çuxIn£¹S‹m’t
.
	`£tSŒšg
(1, "user2");

207 
çuxIn£¹S‹m’t
.
	`execu‹
();

209 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
upd©eM­
 = 
Ãw
 HashMap<String, ByteIterator>();

210 
i
 = 0; i < 3; i++) {

211 
upd©eM­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
("user1", FIELD_PREFIX + i)));

214 
jdbcDBCl›Á
.
	`upd©e
(
TABLE_NAME
, "u£r1", 
upd©eM­
);

216 
ResuÉS‘
 
»suÉS‘
 = 
jdbcCÚÃùiÚ
.
	`´•¬eS‹m’t
(

217 
SŒšg
.
	`fÜm©
("SELECT * FROM % ORDER BY %s", 
TABLE_NAME
, 
KEY_FIELD
)

218 ).
	`execu‹Qu”y
();

221 
»suÉS‘
.
	`Ãxt
();

222 
	`as£¹Equ®s
("As£¹ fœ¡„ow key i u£r0", 
»suÉS‘
.
	`g‘SŒšg
(
KEY_FIELD
), "user0");

223 
i
 = 0; i < 3; i++) {

224 
	`as£¹Equ®s
("As£¹ fœ¡„ow f›ld cÚš…»upd©eSŒšg", 
»suÉS‘
.
	`g‘SŒšg
(
FIELD_PREFIX
 + 
i
), 
´eupd©eSŒšg
);

228 
»suÉS‘
.
	`Ãxt
();

229 
	`as£¹Equ®s
(
»suÉS‘
.
	`g‘SŒšg
(
KEY_FIELD
), "user1");

230 
i
 = 0; i < 3; i++) {

231 
	`as£¹Equ®s
(
»suÉS‘
.
	`g‘SŒšg
(
FIELD_PREFIX
 + 
i
), 
upd©eM­
.
	`g‘
(FIELD_PREFIX + i).
	`toSŒšg
());

235 
»suÉS‘
.
	`Ãxt
();

236 
	`as£¹Equ®s
("As£¹hœd„ow key i u£r2", 
»suÉS‘
.
	`g‘SŒšg
(
KEY_FIELD
), "user2");

237 
i
 = 0; i < 3; i++) {

238 
	`as£¹Equ®s
("As£¹hœd„ow f›ld cÚš…»upd©eSŒšg", 
»suÉS‘
.
	`g‘SŒšg
(
FIELD_PREFIX
 + 
i
), 
´eupd©eSŒšg
);

240 
»suÉS‘
.
	`şo£
();

241 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

242 
e
.
	`´štSckT¿û
();

243 
	`ç
("Failed updateTest");

245 
	}
}

247 @
Te¡


248 
public
 
	$»adTe¡
() {

249 
SŒšg
 
š£¹Key
 = "user0";

250 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
	`š£¹Row
(
š£¹Key
);

251 
S‘
<
SŒšg
> 
»adF›lds
 = 
Ãw
 
HashS‘
<String>();

252 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adResuÉM­
 = 
Ãw
 HashMap<String, ByteIterator>();

255 
»adF›lds
.
	`add
("FIELD0");

256 
jdbcDBCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
»adF›lds
, 
»adResuÉM­
);

257 
	`as£¹Equ®s
("As£¹h©„esuÉ ha cÜ»ù‚umb” oàf›lds", 
»adF›lds
.
	`size
(), 
»adResuÉM­
.size());

258 
SŒšg
 
f›ld
: 
»adF›lds
) {

259 
	`as£¹Equ®s
("As£¹ " + 
f›ld
 + " wa »ad cÜ»ùly", 
š£¹M­
.
	`g‘
(f›ld).
	`toSŒšg
(), 
»adResuÉM­
.get(field).toString());

262 
»adResuÉM­
 = 
Ãw
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>();

265 
»adF›lds
.
	`add
("FIELD1");

266 
»adF›lds
.
	`add
("FIELD2");

267 
jdbcDBCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
»adF›lds
, 
»adResuÉM­
);

268 
	`as£¹Equ®s
("As£¹h©„esuÉ ha cÜ»ù‚umb” oàf›lds", 
»adF›lds
.
	`size
(), 
»adResuÉM­
.size());

269 
SŒšg
 
f›ld
: 
»adF›lds
) {

270 
	`as£¹Equ®s
("As£¹ " + 
f›ld
 + " wa »ad cÜ»ùly", 
š£¹M­
.
	`g‘
(f›ld).
	`toSŒšg
(), 
»adResuÉM­
.get(field).toString());

272 
	}
}

274 @
Te¡


275 
public
 
	$d–‘eTe¡
() {

276 
Œy
 {

277 
	`š£¹Row
("user0");

278 
SŒšg
 
d–‘eKey
 = "user1";

279 
	`š£¹Row
(
d–‘eKey
);

280 
	`š£¹Row
("user2");

282 
jdbcDBCl›Á
.
	`d–‘e
(
TABLE_NAME
, 
d–‘eKey
);

284 
ResuÉS‘
 
»suÉS‘
 = 
jdbcCÚÃùiÚ
.
	`´•¬eS‹m’t
(

285 
SŒšg
.
	`fÜm©
("SELECT * FROM %s", 
TABLE_NAME
)

286 ).
	`execu‹Qu”y
();

288 
tÙ®Rows
 = 0;

289 
»suÉS‘
.
	`Ãxt
()) {

290 
	`as£¹NÙEqu®s
("As£¹hi i nÙhd–‘ed„ow key", 
d–‘eKey
, 
»suÉS‘
.
	`g‘SŒšg
(
KEY_FIELD
));

291 
tÙ®Rows
++;

294 
	`as£¹Equ®s
("As£¹ w’ded w™hhcÜ»ù‚umb” oàrows", 
tÙ®Rows
, 2);

296 
»suÉS‘
.
	`şo£
();

297 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

298 
e
.
	`´štSckT¿û
();

299 
	`ç
("Failed deleteTest");

301 
	}
}

303 @
Te¡


304 
public
 
	$sÿnTe¡
(è
throws
 
SQLExû±iÚ
 {

305 
M­
<
SŒšg
, 
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
keyM­
 = 
Ãw
 HashMap<String, HashMap<String, ByteIterator>>();

306 
i
 = 0; i < 5; i++) {

307 
SŒšg
 
š£¹Key
 = 
KEY_PREFIX
 + 
i
;

308 
keyM­
.
	`put
(
š£¹Key
, 
	`š£¹Row
(insertKey));

310 
S‘
<
SŒšg
> 
f›ldS‘
 = 
Ãw
 
HashS‘
<String>();

311 
f›ldS‘
.
	`add
("FIELD0");

312 
f›ldS‘
.
	`add
("FIELD1");

313 
¡¬tIndex
 = 1;

314 
»suÉRows
 = 3;

316 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉVeùÜ
 = 
Ãw
 Vector<HashMap<String, ByteIterator>>();

317 
jdbcDBCl›Á
.
	`sÿn
(
TABLE_NAME
, 
KEY_PREFIX
 + 
¡¬tIndex
, 
»suÉRows
, 
f›ldS‘
, 
»suÉVeùÜ
);

320 
	`as£¹Equ®s
("As£¹hcÜ»ù‚umb” oà»suÉ row w”»tuºed", 
»suÉRows
, 
»suÉVeùÜ
.
	`size
());

322 
‹¡Index
 = 
¡¬tIndex
;

323 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
: 
»suÉVeùÜ
) {

324 
	`as£¹Equ®s
("As£¹h©hi row ha thcÜ»ù‚umb” oàf›lds", 
f›ldS‘
.
	`size
(), 
»suÉ
.size());

325 
SŒšg
 
f›ld
: 
f›ldS‘
) {

326 
	`as£¹Equ®s
("As£¹hi f›ld i cÜ»ù iÀthi row", 
keyM­
.
	`g‘
(
KEY_PREFIX
 + 
‹¡Index
).g‘(
f›ld
).
	`toSŒšg
(), 
»suÉ
.get(field).toString());

328 
‹¡Index
++;

330 
	}
}

332 @
Te¡


333 
public
 
	$š£¹B©chTe¡
(è
throws
 
DBExû±iÚ
 {

334 
	`š£¹B©chTe¡
(20);

335 
	}
}

337 @
Te¡


338 
public
 
	$š£¹P¬tŸlB©chTe¡
(è
throws
 
DBExû±iÚ
 {

339 
	`š£¹B©chTe¡
(19);

340 
	}
}

342 
public
 
	$š£¹B©chTe¡
(
numRows
è
throws
 
DBExû±iÚ
 {

343 
	`‹¬down
();

344 
	`£tupW™hB©ch
(10, 
çl£
);

345 
Œy
 {

346 
SŒšg
 
š£¹Key
 = "user0";

347 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
	`š£¹Row
(
š£¹Key
);

348 
	`as£¹Equ®s
(3, 
š£¹M­
.
	`size
());

350 
ResuÉS‘
 
»suÉS‘
 = 
jdbcCÚÃùiÚ
.
	`´•¬eS‹m’t
(

351 
SŒšg
.
	`fÜm©
("SELECT * FROM %s", 
TABLE_NAME
)

352 ).
	`execu‹Qu”y
();

355 
	`as£¹F®£
(
»suÉS‘
.
	`Ãxt
());

357 
i
 = 1; i < 
numRows
; i++) {

358 
š£¹M­
 = 
	`š£¹Row
("u£r" + 
i
);

362 
	`as£¹NumRows
(10 * (
numRows
 / 10));

365 
jdbcDBCl›Á
.
	`ş—nup
();

367 
jdbcDBCl›Á
 = 
nuÎ
;

370 
	`as£¹NumRows
(
numRows
);

372 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

373 
e
.
	`´štSckT¿û
();

374 
	`ç
("Failed insertBatchTest");

375 } 
fš®ly
 {

376 
	`‹¬down
();

377 
	`£tup
();

379 
	}
}

381 
´iv©e
 
	$as£¹NumRows
(
numRows
è
throws
 
SQLExû±iÚ
 {

382 
ResuÉS‘
 
»suÉS‘
 = 
jdbcCÚÃùiÚ
.
	`´•¬eS‹m’t
(

383 
SŒšg
.
	`fÜm©
("SELECT * FROM %s", 
TABLE_NAME
)

384 ).
	`execu‹Qu”y
();

386 
i
 = 0; i < 
numRows
; i++) {

387 
	`as£¹True
("ex³ùšg " + 
numRows
 + "„esuÉs,„eûived oÆy " + 
i
, 
»suÉS‘
.
	`Ãxt
());

389 
	`as£¹F®£
("ex³ùšg " + 
numRows
 + "„esuÉs,„eûived mÜe", 
»suÉS‘
.
	`Ãxt
());

391 
»suÉS‘
.
	`şo£
();

392 
	}
}

	@kudu/src/main/java/site/ycsb/db/KuduYCSBClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gcom
.
	g¡umbËupÚ
.
	gasync
.
	gTimeoutExû±iÚ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

26 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

27 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	gkudu
.
	gCŞumnSchema
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gkudu
.
	gSchema
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	gkudu
.
	gş›Á
.*;

33 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

34 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gM­
;

36 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

37 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

38 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

39 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
.
	gDEFAULT_RECORD_COUNT
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
.
	gRECORD_COUNT_PROPERTY
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gINSERT_ORDER_PROPERTY
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gINSERT_ORDER_PROPERTY_DEFAULT
;

45 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY
;

46 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY_DEFAULT
;

47 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gZERO_PADDING_PROPERTY
;

48 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gZERO_PADDING_PROPERTY_DEFAULT
;

49 
impÜt
 
	gÜg
.
	g­ache
.
	gkudu
.
	gTy³
.
	gSTRING
;

50 
impÜt
 
	gÜg
.
	g­ache
.
	gkudu
.
	gş›Á
.
	gKuduP»diÿ‹
.
	gCom·risÚOp
.
	gEQUAL
;

51 
impÜt
 
	gÜg
.
	g­ache
.
	gkudu
.
	gş›Á
.
	gKuduP»diÿ‹
.
	gCom·risÚOp
.
	gGREATER_EQUAL
;

72 
public
 
şass
 
KuduYCSBCl›Á
 
ex‹nds
 
	gs™e
.
	gycsb
.
	gDB
 {

73 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = 
Logg”FaùÜy
.
g‘Logg”
(
KuduYCSBCl›Á
.
şass
);

74 
´iv©e
 
fš®
 
SŒšg
 
	gKEY
 = "key";

75 
´iv©e
 
fš®
 
Stus
 
	gTIMEOUT
 = 
Ãw
 Status("TIMEOUT", "The operationimed out.");

76 
´iv©e
 
fš®
 
	gMAX_TABLETS
 = 9000;

77 
´iv©e
 
fš®
 
	gDEFAULT_SLEEP
 = 60000;

78 
´iv©e
 
fš®
 
	gDEFAULT_NUM_CLIENTS
 = 1;

79 
´iv©e
 
fš®
 
	gDEFAULT_NUM_REPLICAS
 = 3;

80 
´iv©e
 
fš®
 
SŒšg
 
	gDEFAULT_PARTITION_SCHEMA
 = "hashPartition";

82 
´iv©e
 
fš®
 
SŒšg
 
	gSYNC_OPS_OPT
 = "kudu_sync_ops";

83 
´iv©e
 
fš®
 
SŒšg
 
	gBUFFER_NUM_OPS_OPT
 = "kudu_buffer_num_ops";

84 
´iv©e
 
fš®
 
SŒšg
 
	gPRE_SPLIT_NUM_TABLETS_OPT
 = "kudu_pre_split_num_tablets";

85 
´iv©e
 
fš®
 
SŒšg
 
	gTABLE_NUM_REPLICAS
 = "kudu_table_num_replicas";

86 
´iv©e
 
fš®
 
SŒšg
 
	gBLOCK_SIZE_OPT
 = "kudu_block_size";

87 
´iv©e
 
fš®
 
SŒšg
 
	gMASTER_ADDRESSES_OPT
 = "kudu_master_addresses";

88 
´iv©e
 
fš®
 
SŒšg
 
	gNUM_CLIENTS_OPT
 = "kudu_num_clients";

89 
´iv©e
 
fš®
 
SŒšg
 
	gPARTITION_SCHEMA_OPT
 = "kudu_partition_schema";

91 
´iv©e
 
fš®
 
	gBLOCK_SIZE_DEFAULT
 = 4096;

92 
´iv©e
 
fš®
 
	gBUFFER_NUM_OPS_DEFAULT
 = 2000;

93 
´iv©e
 
fš®
 
	gLi¡
<
	gSŒšg
> 
	gCOLUMN_NAMES
 = 
Ãw
 
A¼ayLi¡
<>();

95 
´iv©e
 
	gLi¡
<
	gKuduCl›Á
> 
	gş›Ás
 = 
Ãw
 
A¼ayLi¡
<>();

96 
´iv©e
 
	gş›ÁRoundRobš
 = 0;

97 
´iv©e
 
boŞ—n
 
	gbËS‘up
 = 
çl£
;

98 
´iv©e
 
KuduCl›Á
 
	gş›Á
;

99 
´iv©e
 
Schema
 
	gschema
;

100 
´iv©e
 
SŒšg
 
	gbËName
;

101 
´iv©e
 
KuduSessiÚ
 
	g£ssiÚ
;

102 
´iv©e
 
KuduTabË
 
	gkuduTabË
;

103 
´iv©e
 
SŒšg
 
	g·¹™iÚSchema
;

104 
´iv©e
 
	gz”İaddšg
;

105 
´iv©e
 
boŞ—n
 
	gÜd”edš£¹s
;

107 @
Ov”ride


108 
public
 
š™
(è
throws
 
	gDBExû±iÚ
 {

109 
Prİ”t›s
 
	g´İ
 = 
g‘Prİ”t›s
();

110 
	gthis
.
	gbËName
 = 
´İ
.
g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

111 
	gthis
.
	g·¹™iÚSchema
 = 
´İ
.
g‘Prİ”ty
(
PARTITION_SCHEMA_OPT
, 
DEFAULT_PARTITION_SCHEMA
);

112 
	gthis
.
	gz”İaddšg
 = 
IÁeg”
.
·r£IÁ
(
´İ
.
g‘Prİ”ty
(
ZERO_PADDING_PROPERTY
, 
ZERO_PADDING_PROPERTY_DEFAULT
));

113 ià(
	g´İ
.
g‘Prİ”ty
(
INSERT_ORDER_PROPERTY
, 
INSERT_ORDER_PROPERTY_DEFAULT
).
com·»To
("hashed") == 0) {

114 
this
.
Üd”edš£¹s
 = 
çl£
;

116 
	gthis
.
	gÜd”edš£¹s
 = 
Œue
;

118 
š™Cl›Á
();

119 
	gthis
.
	g£ssiÚ
 = 
ş›Á
.
ÃwSessiÚ
();

120 ià(
g‘Prİ”t›s
().
g‘Prİ”ty
(
SYNC_OPS_OPT
è!ğ
nuÎ


121 && 
g‘Prİ”t›s
().
g‘Prİ”ty
(
SYNC_OPS_OPT
).
equ®s
("false")) {

122 
this
.
£ssiÚ
.
£tFlushMode
(
KuduSessiÚ
.
FlushMode
.
AUTO_FLUSH_BACKGROUND
);

123 
	gthis
.
	g£ssiÚ
.
£tMutiÚBufãrS·û
(

124 
g‘IÁFromPrİ
(
g‘Prİ”t›s
(), 
BUFFER_NUM_OPS_OPT
, 
BUFFER_NUM_OPS_DEFAULT
));

126 
	gthis
.
	g£ssiÚ
.
£tFlushMode
(
KuduSessiÚ
.
FlushMode
.
AUTO_FLUSH_SYNC
);

129 
	gŒy
 {

130 
	gthis
.
	gkuduTabË
 = 
ş›Á
.
İ’TabË
(
bËName
);

131 
	gthis
.
	gschema
 = 
kuduTabË
.
g‘Schema
();

132 } 
ÿtch
 (
Exû±iÚ
 
e
) {

133 
throw
 
Ãw
 
DBExû±iÚ
("Could‚Ù o³À¨bË beÿu£ of:", 
e
);

141 
´iv©e
 
š™Cl›Ás
(è
throws
 
	gDBExû±iÚ
 {

142 
synchrÚized
 (
KuduYCSBCl›Á
.
şass
) {

143 ià(!
	gş›Ás
.
isEm±y
()) {

147 
Prİ”t›s
 
	g´İ
 = 
g‘Prİ”t›s
();

149 
SŒšg
 
	gma¡”Add»s£s
 = 
´İ
.
g‘Prİ”ty
(
MASTER_ADDRESSES_OPT
,

151 
	gLOG
.
debug
("CÚÃùšgØthma¡” © {}", 
ma¡”Add»s£s
);

153 
	gnumCl›Ás
 = 
g‘IÁFromPrİ
(
´İ
, 
NUM_CLIENTS_OPT
, 
DEFAULT_NUM_CLIENTS
);

154 
	gi
 = 0; i < 
	gnumCl›Ás
; i++) {

155 
	gş›Ás
.
add
(
Ãw
 
KuduCl›Á
.
KuduCl›ÁBud”
(
ma¡”Add»s£s
)

156 .
deçuÉSock‘R—dTimeoutMs
(
DEFAULT_SLEEP
)

157 .
deçuÉO³¿tiÚTimeoutMs
(
DEFAULT_SLEEP
)

158 .
deçuÉAdmšO³¿tiÚTimeoutMs
(
DEFAULT_SLEEP
)

159 .
bud
());

164 
´iv©e
 
š™Cl›Á
(è
throws
 
	gDBExû±iÚ
 {

165 
š™Cl›Ás
();

166 
synchrÚized
 (
ş›Ás
) {

167 
	gş›Á
 = 
ş›Ás
.
g‘
(
ş›ÁRoundRobš
++ % cl›Ás.
size
());

169 
£tupTabË
();

172 
´iv©e
 
£tupTabË
(è
throws
 
	gDBExû±iÚ
 {

173 
Prİ”t›s
 
	g´İ
 = 
g‘Prİ”t›s
();

174 
synchrÚized
 (
KuduYCSBCl›Á
.
şass
) {

175 ià(
	gbËS‘up
) {

178 
	gnumTabËts
 = 
g‘IÁFromPrİ
(
´İ
, 
PRE_SPLIT_NUM_TABLETS_OPT
, 4);

179 ià(
	gnumTabËts
 > 
	gMAX_TABLETS
) {

180 
throw
 
Ãw
 
DBExû±iÚ
("S³cif›d‚umb” oàbËt (" + 
numTabËts


181 + "èmu¡ bequ® " + "Ü b–ow " + 
MAX_TABLETS
);

183 
	gnumR•liÿs
 = 
g‘IÁFromPrİ
(
´İ
, 
TABLE_NUM_REPLICAS
, 
DEFAULT_NUM_REPLICAS
);

184 
	g»cÜdCouÁ
 = 
LÚg
.
·r£LÚg
(
´İ
.
g‘Prİ”ty
(
RECORD_COUNT_PROPERTY
, 
DEFAULT_RECORD_COUNT
));

185 ià(
	g»cÜdCouÁ
 == 0) {

186 
»cÜdCouÁ
 = 
IÁeg”
.
MAX_VALUE
;

188 
	gblockSize
 = 
g‘IÁFromPrİ
(
´İ
, 
BLOCK_SIZE_OPT
, 
BLOCK_SIZE_DEFAULT
);

189 
	gf›ldCouÁ
 = 
g‘IÁFromPrİ
(
´İ
, 
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
,

190 
IÁeg”
.
·r£IÁ
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY_DEFAULT
));

191 
fš®
 
SŒšg
 
	gf›ld´efix
 = 
´İ
.
g‘Prİ”ty
(
CÜeWÜklßd
.
FIELD_NAME_PREFIX
,

192 
CÜeWÜklßd
.
FIELD_NAME_PREFIX_DEFAULT
);

194 
	gLi¡
<
	gCŞumnSchema
> 
	gcŞumns
 = 
Ãw
 
A¼ayLi¡
<
CŞumnSchema
>(
f›ldCouÁ
 + 1);

196 
CŞumnSchema
 
	gkeyCŞumn
 = 
Ãw
 CŞumnSchema.
CŞumnSchemaBud”
(
KEY
, 
STRING
)

197 .
key
(
Œue
)

198 .
desœedBlockSize
(
blockSize
)

199 .
bud
();

200 
	gcŞumns
.
add
(
keyCŞumn
);

201 
	gCOLUMN_NAMES
.
add
(
KEY
);

202 
	gi
 = 0; i < 
	gf›ldCouÁ
; i++) {

203 
SŒšg
 
	gÇme
 = 
f›ld´efix
 + 
i
;

204 
	gCOLUMN_NAMES
.
add
(
Çme
);

205 
	gcŞumns
.
add
(
Ãw
 
CŞumnSchema
.
CŞumnSchemaBud”
(
Çme
, 
STRING
)

206 .
desœedBlockSize
(
blockSize
)

207 .
bud
());

209 
	gschema
 = 
Ãw
 
Schema
(
cŞumns
);

211 
C»©eTabËO±iÚs
 
	gbud”
 = 
Ãw
 CreateTableOptions();

213 ià(
	g·¹™iÚSchema
.
equ®s
("hashPartition")) {

214 
	gbud”
.
£tRªgeP¬t™iÚCŞumns
(
Ãw
 
A¼ayLi¡
<
SŒšg
>());

215 
	gLi¡
<
	gSŒšg
> 
	ghashP¬t™iÚCŞumns
 = 
Ãw
 
A¼ayLi¡
<>();

216 
	ghashP¬t™iÚCŞumns
.
add
(
KEY
);

217 
	gbud”
.
addHashP¬t™iÚs
(
hashP¬t™iÚCŞumns
, 
numTabËts
);

218 } ià(
	g·¹™iÚSchema
.
equ®s
("rangePartition")) {

219 ià(!
	gÜd”edš£¹s
) {

221 
throw
 
Ãw
 
DBExû±iÚ
("Must specify `insertorder=ordered` if using„angePartition schema.");

224 
SŒšg
 
	gmaxKeyV®ue
 = SŒšg.
v®ueOf
(
»cÜdCouÁ
);

225 ià(
	gz”İaddšg
 < 
	gmaxKeyV®ue
.
Ëngth
()) {

226 
throw
 
Ãw
 
DBExû±iÚ
(
SŒšg
.
fÜm©
("Invalid zeropadding value: %d, zeropadding‚eedso be†arger "

227 + "Üƒqu®Ønumb” oàdig™ šh»cÜd‚umb”: %d.", 
z”İaddšg
, 
maxKeyV®ue
.
Ëngth
()));

230 
	gLi¡
<
	gSŒšg
> 
	g¿ngeP¬t™iÚCŞumns
 = 
Ãw
 
A¼ayLi¡
<>();

231 
	g¿ngeP¬t™iÚCŞumns
.
add
(
KEY
);

232 
	gbud”
.
£tRªgeP¬t™iÚCŞumns
(
¿ngeP¬t™iÚCŞumns
);

234 
	glow”Num
 = 0;

235 
	guµ”Num
 = 0;

236 
	g»mašd”
 = (è
»cÜdCouÁ
 % 
numTabËts
;

237 
	gi
 = 0; i < 
	gnumTabËts
; i++) {

238 
	glow”Num
 = 
uµ”Num
;

239 
	guµ”Num
 = 
low”Num
 + 
»cÜdCouÁ
 / 
numTabËts
;

240 ià(
	gi
 < 
	g»mašd”
) {

241 ++
	guµ”Num
;

243 
P¬tŸlRow
 
	glow”
 = 
schema
.
ÃwP¬tŸlRow
();

244 
	glow”
.
addSŒšg
(
KEY
, 
CÜeWÜklßd
.
budKeyName
(
low”Num
, 
z”İaddšg
, 
Üd”edš£¹s
));

245 
P¬tŸlRow
 
	guµ”
 = 
schema
.
ÃwP¬tŸlRow
();

246 
	guµ”
.
addSŒšg
(
KEY
, 
CÜeWÜklßd
.
budKeyName
(
uµ”Num
, 
z”İaddšg
, 
Üd”edš£¹s
));

247 
	gbud”
.
addRªgeP¬t™iÚ
(
low”
, 
uµ”
);

250 
throw
 
Ãw
 
DBExû±iÚ
("Inv®id…¬t™iÚ_schem¨¥ecif›d: " + 
·¹™iÚSchema


253 
	gbud”
.
£tNumR•liÿs
(
numR•liÿs
);

255 
	gŒy
 {

256 
	gş›Á
.
ü—‹TabË
(
bËName
, 
schema
, 
bud”
);

257 } 
ÿtch
 (
Exû±iÚ
 
e
) {

258 ià(!
	ge
.
g‘Mes§ge
().
cÚšs
("alreadyƒxists")) {

259 
throw
 
Ãw
 
DBExû±iÚ
("Couldn'ˆü—‹hbË", 
e
);

262 
	gbËS‘up
 = 
Œue
;

266 
´iv©e
 
g‘IÁFromPrİ
(
Prİ”t›s
 
´İ
,

267 
SŒšg
 
´İName
,

268 
deçuÉV®ue
è
throws
 
	gDBExû±iÚ
 {

269 
SŒšg
 
	gštSŒ
 = 
´İ
.
g‘Prİ”ty
(
´İName
);

270 ià(
	gštSŒ
 =ğ
nuÎ
) {

271  
deçuÉV®ue
;

273 
	gŒy
 {

274  
	gIÁeg”
.
v®ueOf
(
štSŒ
);

275 } 
ÿtch
 (
Numb”FÜm©Exû±iÚ
 
ex
) {

276 
throw
 
Ãw
 
DBExû±iÚ
("Provided‚umb” fÜ " + 
´İName
 + " isn't‡ valid integer");

281 @
Ov”ride


282 
public
 
ş—nup
(è
throws
 
	gDBExû±iÚ
 {

283 
	gŒy
 {

284 
	gthis
.
	g£ssiÚ
.
şo£
();

285 
	gthis
.
	gş›Á
.
şo£
();

286 } 
ÿtch
 (
Exû±iÚ
 
e
) {

287 
throw
 
Ãw
 
DBExû±iÚ
("Couldn'ˆş—nu°th£ssiÚ", 
e
);

291 @
Ov”ride


292 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

293 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

294 
	gVeùÜ
<
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
>> 
	g»suÉs
 = 
Ãw
 
VeùÜ
<>();

295 
fš®
 
Stus
 
	g¡©us
 = 
sÿn
(
bË
, 
key
, 1, 
f›lds
, 
»suÉs
);

296 ià(!
	g¡©us
.
equ®s
(
Stus
.
OK
)) {

297  
	g¡©us
;

299 ià(
	g»suÉs
.
size
() != 1) {

300  
Stus
.
NOT_FOUND
;

302 
	g»suÉ
.
putAÎ
(
»suÉs
.
fœ¡EËm’t
());

303  
	gStus
.
	gOK
;

306 @
Ov”ride


307 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
,

308 
SŒšg
 
¡¬tkey
,

309 
»cÜdcouÁ
,

310 
S‘
<
SŒšg
> 
f›lds
,

311 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

312 
	gŒy
 {

313 
	gKuduSÿÂ”
.
KuduSÿÂ”Bud”
 
	gsÿÂ”Bud”
 = 
ş›Á
.
ÃwSÿÂ”Bud”
(
kuduTabË
);

314 
	gLi¡
<
	gSŒšg
> 
	gqu”ySchema
;

315 ià(
	gf›lds
 =ğ
nuÎ
) {

316 
qu”ySchema
 = 
COLUMN_NAMES
;

319 
	gqu”ySchema
 = 
Ãw
 
A¼ayLi¡
<>(
f›lds
);

320 
	gsÿÂ”Bud”
.
£tProjeùedCŞumnNames
(
qu”ySchema
);

323 
CŞumnSchema
 
	gcŞumn
 = 
schema
.
g‘CŞumnByIndex
(0);

324 
	gKuduP»diÿ‹
.
Com·risÚOp
 
	g´ediÿ‹Op
 = 
»cÜdcouÁ
 =ğ1 ? 
EQUAL
 : 
GREATER_EQUAL
;

325 
KuduP»diÿ‹
 
	g´ediÿ‹
 = KuduP»diÿ‹.
ÃwCom·risÚP»diÿ‹
(
cŞumn
, 
´ediÿ‹Op
, 
¡¬tkey
);

326 
	gsÿÂ”Bud”
.
addP»diÿ‹
(
´ediÿ‹
);

327 
	gsÿÂ”Bud”
.
lim™
(
»cÜdcouÁ
);

329 
KuduSÿÂ”
 
	gsÿÂ”
 = 
sÿÂ”Bud”
.
bud
();

331 
	gsÿÂ”
.
hasMÜeRows
()) {

332 
RowResuÉI‹¿tÜ
 
	gd©a
 = 
sÿÂ”
.
ÃxtRows
();

333 
addAÎRowsToResuÉ
(
d©a
, 
»cÜdcouÁ
, 
qu”ySchema
, 
»suÉ
);

334 ià(
	g»cÜdcouÁ
 =ğ
»suÉ
.
size
()) {

338 
RowResuÉI‹¿tÜ
 
	gşo£r
 = 
sÿÂ”
.
şo£
();

339 
addAÎRowsToResuÉ
(
şo£r
, 
»cÜdcouÁ
, 
qu”ySchema
, 
»suÉ
);

340 } 
ÿtch
 (
TimeoutExû±iÚ
 
‹
) {

341 
	gLOG
.
šfo
("Wa™edoØlÚg fÜ‡ sÿÀİ”©iÚ w™h s¹ key={}", 
¡¬tkey
);

342  
	gTIMEOUT
;

343 } 
ÿtch
 (
Exû±iÚ
 
e
) {

344 
	gLOG
.
w¬n
("UÃx³ùedƒxû±iÚ", 
e
);

345  
	gStus
.
	gERROR
;

347  
	gStus
.
	gOK
;

350 
´iv©e
 
addAÎRowsToResuÉ
(
RowResuÉI‹¿tÜ
 
™
,

351 
»cÜdcouÁ
,

352 
Li¡
<
SŒšg
> 
qu”ySchema
,

353 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
è
throws
 
	gExû±iÚ
 {

354 
RowResuÉ
 
	grow
;

355 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	growResuÉ
 = 
Ãw
 
HashM­
<>(
qu”ySchema
.
size
());

356 ià(
	g™
 =ğ
nuÎ
) {

359 
	g™
.
hasNext
()) {

360 ià(
	g»suÉ
.
size
(è=ğ
»cÜdcouÁ
) {

363 
	grow
 = 
™
.
Ãxt
();

364 
	gcŞIdx
 = 0;

365 
SŒšg
 
	gcŞ
 : 
qu”ySchema
) {

366 
rowResuÉ
.
put
(
cŞ
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
row
.
g‘SŒšg
(
cŞIdx
)));

367 
	gcŞIdx
++;

369 
	g»suÉ
.
add
(
rowResuÉ
);

373 @
Ov”ride


374 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

375 
Upd©e
 
	gupd©e
 = 
this
.
kuduTabË
.
ÃwUpd©e
();

376 
P¬tŸlRow
 
	grow
 = 
upd©e
.
g‘Row
();

377 
	grow
.
addSŒšg
(
KEY
, 
key
);

378 
	gi
 = 1; i < 
	gschema
.
g‘CŞumnCouÁ
(); i++) {

379 
SŒšg
 
	gcŞumnName
 = 
schema
.
g‘CŞumnByIndex
(
i
).
g‘Name
();

380 
By‹I‹¿tÜ
 
	gb
 = 
v®ues
.
g‘
(
cŞumnName
);

381 ià(
	gb
 !ğ
nuÎ
) {

382 
row
.
addSŒšgUtf8
(
cŞumnName
, 
b
.
toA¼ay
());

385 
­¶y
(
upd©e
);

386  
	gStus
.
	gOK
;

389 @
Ov”ride


390 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

391 
In£¹
 
	gš£¹
 = 
this
.
kuduTabË
.
ÃwIn£¹
();

392 
P¬tŸlRow
 
	grow
 = 
š£¹
.
g‘Row
();

393 
	grow
.
addSŒšg
(
KEY
, 
key
);

394 
	gi
 = 1; i < 
	gschema
.
g‘CŞumnCouÁ
(); i++) {

395 
	grow
.
addSŒšgUtf8
(
i
, 
v®ues
.
g‘
(
schema
.
g‘CŞumnByIndex
(i).
g‘Name
()).
toA¼ay
());

397 
­¶y
(
š£¹
);

398  
	gStus
.
	gOK
;

401 @
Ov”ride


402 
public
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

403 
D–‘e
 
	gd–‘e
 = 
this
.
kuduTabË
.
ÃwD–‘e
();

404 
P¬tŸlRow
 
	grow
 = 
d–‘e
.
g‘Row
();

405 
	grow
.
addSŒšg
(
KEY
, 
key
);

406 
­¶y
(
d–‘e
);

407  
	gStus
.
	gOK
;

410 
´iv©e
 
­¶y
(
O³¿tiÚ
 
İ
) {

411 
	gŒy
 {

412 
O³¿tiÚRe¥Ú£
 
	g»¥Ú£
 = 
£ssiÚ
.
­¶y
(
İ
);

413 ià(
	g»¥Ú£
 !ğ
nuÎ
 && 
»¥Ú£
.
hasRowE¼Ü
()) {

414 
LOG
.
šfo
("Wr™İ”©iÚ faed: {}", 
»¥Ú£
.
g‘RowE¼Ü
());

416 } 
ÿtch
 (
KuduExû±iÚ
 
ex
) {

417 
	gLOG
.
w¬n
("Wr™İ”©iÚ faed", 
ex
);

	@kudu/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@maprdb/src/main/java/site/ycsb/db/mapr/MapRDBClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gm­r
;

24 
public
 
şass
 
M­RDBCl›Á
 
ex‹nds
 
	gs™e
.
	gycsb
.
	gdb
.
	ghba£1
.
	gHBa£Cl›Á1
 {

	@maprdb/src/main/java/site/ycsb/db/mapr/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gm­r
;

	@maprjsondb/src/main/java/site/ycsb/db/mapr/MapRJSONDBClient.java

16 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gm­r
;

18 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

19 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

22 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

24 
impÜt
 
	gÜg
.
	gojai
.
	gDocum’t
;

25 
impÜt
 
	gÜg
.
	gojai
.
	gDocum’tCÚ¡ªts
;

26 
impÜt
 
	gÜg
.
	gojai
.
	gDocum’tSŒ—m
;

27 
impÜt
 
	gÜg
.
	gojai
.
	gV®ue
;

28 
impÜt
 
	gÜg
.
	gojai
.
	g¡Üe
.
	gCÚÃùiÚ
;

29 
impÜt
 
	gÜg
.
	gojai
.
	g¡Üe
.
	gDocum’tMutiÚ
;

30 
impÜt
 
	gÜg
.
	gojai
.
	g¡Üe
.
	gDocum’tStÜe
;

31 
impÜt
 
	gÜg
.
	gojai
.
	g¡Üe
.
	gDriv”
;

32 
impÜt
 
	gÜg
.
	gojai
.
	g¡Üe
.
	gDriv”Mªag”
;

33 
impÜt
 
	gÜg
.
	gojai
.
	g¡Üe
.
	gQu”y
;

34 
impÜt
 
	gÜg
.
	gojai
.
	g¡Üe
.
	gQu”yCÚd™iÚ
;

35 
impÜt
 
	gÜg
.
	gojai
.
	g¡Üe
.
	gQu”yCÚd™iÚ
.
	gOp
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

44 
public
 
şass
 
M­RJSONDBCl›Á
 
ex‹nds
 
	gs™e
.
	gycsb
.
	gDB
 {

46 
´iv©e
 
CÚÃùiÚ
 
	gcÚÃùiÚ
 = 
nuÎ
;

47 
´iv©e
 
Docum’tStÜe
 
	gdocum’tStÜe
 = 
nuÎ
;

48 
´iv©e
 
Driv”
 
	gdriv”
 = 
nuÎ
;

50 @
Ov”ride


51 
public
 
š™
() {

52 
	gcÚÃùiÚ
 = 
Driv”Mªag”
.
g‘CÚÃùiÚ
("ojai:mapr:");

53 
	gdriv”
 = 
cÚÃùiÚ
.
g‘Driv”
();

56 @
Ov”ride


57 
public
 
ş—nup
() {

58 
	gdocum’tStÜe
.
şo£
();

59 
	gcÚÃùiÚ
.
şo£
();

62 @
Ov”ride


63 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

64 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

65 
	gŒy
 {

66 
Docum’tStÜe
 
	gdocStÜe
 = 
g‘TabË
(
bË
);

67 
Docum’t
 
	gdoc
 = 
docStÜe
.
fšdById
(
key
, 
g‘F›ldP©hs
(
f›lds
));

68 
budRowResuÉ
(
doc
, 
»suÉ
);

69  
	gStus
.
	gOK
;

70 } 
ÿtch
 (
Exû±iÚ
 
e
) {

71  
	gStus
.
	gERROR
;

75 @
Ov”ride


76 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

77 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

78 
	gŒy
 {

79 
Docum’tStÜe
 
	gdocStÜe
 = 
g‘TabË
(
bË
);

80 
Qu”yCÚd™iÚ
 
	gcÚd™iÚ
 = 
driv”
.
ÃwCÚd™iÚ
()

81 .
is
(
Docum’tCÚ¡ªts
.
ID_FIELD
, 
Op
.
GREATER_OR_EQUAL
, 
¡¬tkey
)

82 .
bud
();

83 
Qu”y
 
	gqu”y
 = 
driv”
.
ÃwQu”y
()

84 .
£Ëù
(
g‘F›ldP©hs
(
f›lds
))

85 .
wh”e
(
cÚd™iÚ
)

86 .
bud
();

88 
Œy
 (
Docum’tSŒ—m
 
¡»am
 =

89 
docStÜe
.
fšdQu”y
(
qu”y
)) {

90 
numResuÉs
 = 0;

91 
Docum’t
 
	g»cÜd
 : 
¡»am
) {

92 
»suÉ
.
add
(
budRowResuÉ
(
»cÜd
));

93 
	gnumResuÉs
++;

94 ià(
	gnumResuÉs
 >ğ
»cÜdcouÁ
) {

99  
	gStus
.
	gOK
;

100 } 
ÿtch
 (
Exû±iÚ
 
e
) {

101 
	ge
.
´štSckT¿û
();

102  
	gStus
.
	gERROR
;

106 @
Ov”ride


107 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

108 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

109 
	gŒy
 {

110 
Docum’tStÜe
 
	gdocStÜe
 = 
g‘TabË
(
bË
);

111 
	gdocStÜe
.
upd©e
(
key
, 
ÃwMutiÚ
(
v®ues
));

112  
	gStus
.
	gOK
;

113 } 
ÿtch
 (
Exû±iÚ
 
e
) {

114  
	gStus
.
	gERROR
;

118 @
Ov”ride


119 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

120 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

121 
	gŒy
 {

122 
Docum’tStÜe
 
	gdocStÜe
 = 
g‘TabË
(
bË
);

123 
	gdocStÜe
.
š£¹OrR•Ïû
(
key
, 
ÃwDocum’t
(
v®ues
));

124  
	gStus
.
	gOK
;

125 } 
ÿtch
 (
Exû±iÚ
 
e
) {

126  
	gStus
.
	gERROR
;

130 @
Ov”ride


131 
public
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

132 
	gŒy
 {

133 
Docum’tStÜe
 
	gdocStÜe
 = 
g‘TabË
(
bË
);

134 
	gdocStÜe
.
d–‘e
(
key
);

135  
	gStus
.
	gOK
;

136 } 
ÿtch
 (
Exû±iÚ
 
e
) {

137  
	gStus
.
	gERROR
;

147 
´iv©e
 
Docum’tStÜe
 
g‘TabË
(
SŒšg
 
bËName
) {

148 ià(
	gdocum’tStÜe
 =ğ
nuÎ
) {

149 
docum’tStÜe
 = 
cÚÃùiÚ
.
g‘StÜe
(
bËName
);

151  
	gdocum’tStÜe
;

160 
´iv©e
 
Docum’t
 
ÃwDocum’t
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

161 
Docum’t
 
	gdocum’t
 = 
driv”
.
ÃwDocum’t
();

162 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

163 
docum’t
.
£t
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toA¼ay
());

165  
	gdocum’t
;

173 
´iv©e
 
Docum’tMutiÚ
 
ÃwMutiÚ
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

174 
Docum’tMutiÚ
 
	gmutiÚ
 = 
driv”
.
ÃwMutiÚ
();

175 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

176 
mutiÚ
.
£tOrR•Ïû
(
’Œy
.
g‘Key
(),

177 
By‹Bufãr
.
w¿p
(
’Œy
.
g‘V®ue
().
toA¼ay
()));

179  
	gmutiÚ
;

188 
´iv©e
 
	gSŒšg
[] 
g‘F›ldP©hs
(
S‘
<
SŒšg
> 
f›lds
) {

189 ià(
	gf›lds
 !ğ
nuÎ
) {

190  
f›lds
.
toA¼ay
(
Ãw
 
SŒšg
[f›lds.
size
()]);

192  
Ãw
 
	gSŒšg
[0];

201 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
budRowResuÉ
(
Docum’t
 
docum’t
) {

202  
budRowResuÉ
(
docum’t
, 
nuÎ
);

212 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
budRowResuÉ
(
Docum’t
 
docum’t
,

213 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

214 ià(
	gdocum’t
 !ğ
nuÎ
) {

215 ià(
»suÉ
 =ğ
nuÎ
) {

216 
»suÉ
 = 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

218 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gV®ue
> 
	gkv
 : 
docum’t
) {

219 
»suÉ
.
put
(
kv
.
g‘Key
(), 
Ãw
 
V®ueBy‹I‹¿tÜ
(kv.
g‘V®ue
()));

222  (
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
>)
	g»suÉ
;

	@maprjsondb/src/main/java/site/ycsb/db/mapr/ValueByteIterator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gm­r
;

20 
impÜt
 
	gÜg
.
	gojai
.
	gV®ue
;

21 
impÜt
 
	gÜg
.
	gojai
.
	gut
.
	gV®ues
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

30 
public
 cÏs 
	cV®ueBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

32 
´iv©e
 
V®ue
 
	mv®ue
;

34 
public
 
	$V®ueBy‹I‹¿tÜ
(
V®ue
 
v®ue
) {

35 
this
.
v®ue
 = value;

38 @
Ov”ride


39 
public
 
boŞ—n
 
	$hasNext
() {

40  
çl£
;

41 
	}
}

43 @
Ov”ride


44 
public
 
by‹
 
	$ÃxtBy‹
() {

46 
	}
}

48 @
Ov”ride


49 
public
 
	$by‹sLeá
() {

51 
	}
}

53 @
Ov”ride


54 
public
 
SŒšg
 
	$toSŒšg
() {

55  
V®ues
.
	`asJsÚSŒšg
(
v®ue
);

56 
	}
}

	@maprjsondb/src/main/java/site/ycsb/db/mapr/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gm­r
;

	@memcached/src/main/java/site/ycsb/db/MemcachedClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

26 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

27 
impÜt
 
	gjava
.
	gio
.
	gSŒšgWr™”
;

28 
impÜt
 
	gjava
.
	gio
.
	gWr™”
;

29 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtSock‘Add»ss
;

30 
impÜt
 
	gjava
.
	g‹xt
.
	gMes§geFÜm©
;

31 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

32 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

33 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

34 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

35 
impÜt
 
	gjava
.
	gut
.
	gM­
;

36 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

37 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

39 
impÜt
 
	gÃt
.
	g¥y
.
	gmemÿched
.
	gCÚÃùiÚFaùÜyBud”
;

40 
impÜt
 
	gÃt
.
	g¥y
.
	gmemÿched
.
	gFau»Mode
;

44 
impÜt
 
	gÃt
.
	g¥y
.
	gmemÿched
.
	gš‹º®
.
	gG‘Futu»
;

45 
impÜt
 
	gÃt
.
	g¥y
.
	gmemÿched
.
	gš‹º®
.
	gO³¿tiÚFutu»
;

47 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚFaùÜy
;

48 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚG’”©Ü
;

49 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚNode
;

50 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gm­
.
	gObjeùM­³r
;

51 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gnode
.
	gObjeùNode
;

53 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

55 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
.
	gMILLISECONDS
;

60 
public
 cÏs 
	cMemÿchedCl›Á
 
ex‹nds
 
	mDB
 {

62 
´iv©e
 
fš®
 
Logg”
 
	mlogg”
 = Logg”.
g‘Logg”
(
g‘CÏss
());

64 
´Ùeùed
 
fš®
 
ObjeùM­³r
 
	mMAPPER
 = 
Ãw
 ObjectMapper();

66 
´iv©e
 
boŞ—n
 
	mcheckO³¿tiÚStus
;

67 
´iv©e
 
	mshutdownTimeoutMlis
;

68 
´iv©e
 
	mobjeùExpœ©iÚTime
;

70 
public
 
fš®
 
SŒšg
 
	mHOSTS_PROPERTY
 = "memcached.hosts";

72 
public
 
fš®
 
	mDEFAULT_PORT
 = 11211;

74 
´iv©e
 
fš®
 
SŒšg
 
	mTEMPORARY_FAILURE_MSG
 = "Temporary failure";

75 
´iv©e
 
fš®
 
SŒšg
 
	mCANCELLED_MSG
 = "cancelled";

77 
public
 
fš®
 
SŒšg
 
	mSHUTDOWN_TIMEOUT_MILLIS_PROPERTY
 =

79 
public
 
fš®
 
SŒšg
 
	mDEFAULT_SHUTDOWN_TIMEOUT_MILLIS
 = "30000";

81 
public
 
fš®
 
SŒšg
 
	mOBJECT_EXPIRATION_TIME_PROPERTY
 =

83 
public
 
fš®
 
SŒšg
 
	mDEFAULT_OBJECT_EXPIRATION_TIME
 =

84 
SŒšg
.
v®ueOf
(
IÁeg”
.
MAX_VALUE
);

86 
public
 
fš®
 
SŒšg
 
	mCHECK_OPERATION_STATUS_PROPERTY
 =

88 
public
 
fš®
 
SŒšg
 
	mCHECK_OPERATION_STATUS_DEFAULT
 = "true";

90 
public
 
fš®
 
SŒšg
 
	mREAD_BUFFER_SIZE_PROPERTY
 =

92 
public
 
fš®
 
SŒšg
 
	mDEFAULT_READ_BUFFER_SIZE
 = "3000000";

94 
public
 
fš®
 
SŒšg
 
	mOP_TIMEOUT_PROPERTY
 = "memcached.opTimeoutMillis";

95 
public
 
fš®
 
SŒšg
 
	mDEFAULT_OP_TIMEOUT
 = "60000";

97 
public
 
fš®
 
SŒšg
 
	mFAILURE_MODE_PROPERTY
 = "memcached.failureMode";

98 
public
 
fš®
 
Fau»Mode
 
	mFAILURE_MODE_PROPERTY_DEFAULT
 =

99 
Fau»Mode
.
Redi¡ribu‹
;

101 
public
 
fš®
 
SŒšg
 
	mPROTOCOL_PROPERTY
 = "memcached.protocol";

102 
public
 
fš®
 
	mCÚÃùiÚFaùÜyBud”
.
PrÙocŞ
 
	mDEFAULT_PROTOCOL
 =

103 
CÚÃùiÚFaùÜyBud”
.
PrÙocŞ
.
TEXT
;

109 
´iv©e
 
	mÃt
.
	m¥y
.
	mmemÿched
.
MemÿchedCl›Á
 
	mş›Á
;

115 
´Ùeùed
 
	mÃt
.
	m¥y
.
	mmemÿched
.
MemÿchedCl›Á
 
	$memÿchedCl›Á
() {

116  
ş›Á
;

119 @
Ov”ride


120 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

121 
Œy
 {

122 
ş›Á
 = 
	`ü—‹MemÿchedCl›Á
();

123 
checkO³¿tiÚStus
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

124 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
CHECK_OPERATION_STATUS_PROPERTY
,

125 
CHECK_OPERATION_STATUS_DEFAULT
));

126 
objeùExpœ©iÚTime
 = 
IÁeg”
.
	`·r£IÁ
(

127 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
OBJECT_EXPIRATION_TIME_PROPERTY
,

128 
DEFAULT_OBJECT_EXPIRATION_TIME
));

129 
shutdownTimeoutMlis
 = 
IÁeg”
.
	`·r£IÁ
(

130 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
SHUTDOWN_TIMEOUT_MILLIS_PROPERTY
,

131 
DEFAULT_SHUTDOWN_TIMEOUT_MILLIS
));

132 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

133 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

135 
	}
}

137 
´Ùeùed
 
	gÃt
.
	g¥y
.
	gmemÿched
.
MemÿchedCl›Á
 
	$ü—‹MemÿchedCl›Á
()

138 
throws
 
Exû±iÚ
 {

139 
CÚÃùiÚFaùÜyBud”
 
cÚÃùiÚFaùÜyBud”
 =

140 
Ãw
 
	`CÚÃùiÚFaùÜyBud”
();

142 
cÚÃùiÚFaùÜyBud”
.
	`£tR—dBufãrSize
(
IÁeg”
.
	`·r£IÁ
(

143 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
READ_BUFFER_SIZE_PROPERTY
,

144 
DEFAULT_READ_BUFFER_SIZE
)));

146 
cÚÃùiÚFaùÜyBud”
.
	`£tOpTimeout
(
IÁeg”
.
	`·r£IÁ
(

147 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
OP_TIMEOUT_PROPERTY
, 
DEFAULT_OP_TIMEOUT
)));

149 
SŒšg
 
´ÙocŞSŒšg
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
PROTOCOL_PROPERTY
);

150 
cÚÃùiÚFaùÜyBud”
.
	`£tPrÙocŞ
(

151 
´ÙocŞSŒšg
 =ğ
nuÎ
 ? 
DEFAULT_PROTOCOL


152 : 
CÚÃùiÚFaùÜyBud”
.
PrÙocŞ
.
	`v®ueOf
(
´ÙocŞSŒšg
.
	`toUµ”Ca£
()));

154 
SŒšg
 
çu»SŒšg
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
FAILURE_MODE_PROPERTY
);

155 
cÚÃùiÚFaùÜyBud”
.
	`£tFau»Mode
(

156 
çu»SŒšg
 =ğ
nuÎ
 ? 
FAILURE_MODE_PROPERTY_DEFAULT


157 : 
Fau»Mode
.
	`v®ueOf
(
çu»SŒšg
));

164 
Li¡
<
IÃtSock‘Add»ss
> 
add»s£s
 = 
Ãw
 
A¼ayLi¡
<InetSocketAddress>();

165 
SŒšg
[] 
ho¡s
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
HOSTS_PROPERTY
).
	`¥l™
(",");

166 
SŒšg
 
add»ss
 : 
ho¡s
) {

167 
cŞÚ
 = 
add»ss
.
	`šdexOf
(":");

168 
pÜt
 = 
DEFAULT_PORT
;

169 
SŒšg
 
ho¡
 = 
add»ss
;

170 ià(
cŞÚ
 != -1) {

171 
pÜt
 = 
IÁeg”
.
	`·r£IÁ
(
add»ss
.
	`sub¡ršg
(
cŞÚ
 + 1));

172 
ho¡
 = 
add»ss
.
	`sub¡ršg
(0, 
cŞÚ
);

174 
add»s£s
.
	`add
(
Ãw
 
	`IÃtSock‘Add»ss
(
ho¡
, 
pÜt
));

176  
Ãw
 
Ãt
.
¥y
.
memÿched
.
	`MemÿchedCl›Á
(

177 
cÚÃùiÚFaùÜyBud”
.
	`bud
(), 
add»s£s
);

178 
	}
}

180 @
Ov”ride


181 
public
 
Stus
 
»ad
(

182 
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

183 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

184 
	gkey
 = 
ü—‹Qu®if›dKey
(
bË
, 
key
);

185 
	gŒy
 {

186 
	gG‘Futu»
<
	gObjeù
> 
	gfutu»
 = 
memÿchedCl›Á
().
asyncG‘
(
key
);

187 
Objeù
 
	gdocum’t
 = 
futu»
.
g‘
();

188 ià(
	gdocum’t
 !ğ
nuÎ
) {

189 
äomJsÚ
((
SŒšg
è
docum’t
, 
f›lds
, 
»suÉ
);

191  
	gStus
.
	gOK
;

192 } 
ÿtch
 (
Exû±iÚ
 
e
) {

193 
	glogg”
.
”rÜ
("E¼ÜƒncouÁ”ed fÜ key: " + 
key
, 
e
);

194  
	gStus
.
	gERROR
;

198 @
Ov”ride


199 
public
 
Stus
 
sÿn
(

200 
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

201 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
){

202  
	gStus
.
	gNOT_IMPLEMENTED
;

205 @
Ov”ride


206 
public
 
Stus
 
upd©e
(

207 
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

208 
	gkey
 = 
ü—‹Qu®if›dKey
(
bË
, 
key
);

209 
	gŒy
 {

210 
	gO³¿tiÚFutu»
<
	gBoŞ—n
> 
	gfutu»
 =

211 
memÿchedCl›Á
().
»¶aû
(
key
, 
objeùExpœ©iÚTime
, 
toJsÚ
(
v®ues
));

212  
g‘R‘uºCode
(
futu»
);

213 } 
ÿtch
 (
Exû±iÚ
 
e
) {

214 
	glogg”
.
”rÜ
("E¼Ü upd©šg v®uw™h key: " + 
key
, 
e
);

215  
	gStus
.
	gERROR
;

219 @
Ov”ride


220 
public
 
Stus
 
š£¹
(

221 
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

222 
	gkey
 = 
ü—‹Qu®if›dKey
(
bË
, 
key
);

223 
	gŒy
 {

224 
	gO³¿tiÚFutu»
<
	gBoŞ—n
> 
	gfutu»
 =

225 
memÿchedCl›Á
().
add
(
key
, 
objeùExpœ©iÚTime
, 
toJsÚ
(
v®ues
));

226  
g‘R‘uºCode
(
futu»
);

227 } 
ÿtch
 (
Exû±iÚ
 
e
) {

228 
	glogg”
.
”rÜ
("E¼Ü in£¹šg v®ue", 
e
);

229  
	gStus
.
	gERROR
;

233 @
Ov”ride


234 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

235 
key
 = 
	`ü—‹Qu®if›dKey
(
bË
, key);

236 
Œy
 {

237 
O³¿tiÚFutu»
<
BoŞ—n
> 
futu»
 = 
	`memÿchedCl›Á
().
	`d–‘e
(
key
);

238  
	`g‘R‘uºCode
(
futu»
);

239 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

240 
logg”
.
	`”rÜ
("E¼Ü d–‘šg v®ue", 
e
);

241  
Stus
.
ERROR
;

243 
	}
}

245 
´Ùeùed
 
Stus
 
g‘R‘uºCode
(
O³¿tiÚFutu»
<
BoŞ—n
> 
futu»
) {

246 ià(!
	gcheckO³¿tiÚStus
) {

247  
	gStus
.
	gOK
;

249 ià(
	gfutu»
.
g‘Stus
().
isSucûss
()) {

250  
	gStus
.
	gOK
;

251 } ià(
	gTEMPORARY_FAILURE_MSG
.
equ®s
(
futu»
.
g‘Stus
().
g‘Mes§ge
())) {

252  
Ãw
 
Stus
("TEMPORARY_FAILURE", 
TEMPORARY_FAILURE_MSG
);

253 } ià(
	gCANCELLED_MSG
.
equ®s
(
futu»
.
g‘Stus
().
g‘Mes§ge
())) {

254  
Ãw
 
Stus
("CANCELLED_MSG", 
CANCELLED_MSG
);

256  
Ãw
 
Stus
("ERROR", 
futu»
.
g‘Stus
().
g‘Mes§ge
());

259 @
Ov”ride


260 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

261 ià(
ş›Á
 !ğ
nuÎ
) {

262 
	`memÿchedCl›Á
().
	`shutdown
(
shutdownTimeoutMlis
, 
MILLISECONDS
);

264 
	}
}

266 
´Ùeùed
 
SŒšg
 
	$ü—‹Qu®if›dKey
(
SŒšg
 
bË
, SŒšg 
key
) {

267  
Mes§geFÜm©
.
	`fÜm©
("{0}-{1}", 
bË
, 
key
);

268 
	}
}

270 
´Ùeùed
 
äomJsÚ
(

271 
SŒšg
 
v®ue
, 
S‘
<SŒšg> 
f›lds
,

272 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
è
throws
 
	gIOExû±iÚ
 {

273 
JsÚNode
 
	gjsÚ
 = 
MAPPER
.
»adT»e
(
v®ue
);

274 
boŞ—n
 
	gcheckF›lds
 = 
f›lds
 !ğ
nuÎ
 && !f›lds.
isEm±y
();

275 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
>> 
	gjsÚF›lds
 = 
jsÚ
.
g‘F›lds
();

276 
	gjsÚF›lds
.
hasNext
();

278 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
> 
	gjsÚF›ld
 = 
jsÚF›lds
.
Ãxt
();

279 
SŒšg
 
	gÇme
 = 
jsÚF›ld
.
g‘Key
();

280 ià(
	gcheckF›lds
 && !
	gf›lds
.
cÚšs
(
Çme
)) {

283 
JsÚNode
 
	gjsÚV®ue
 = 
jsÚF›ld
.
g‘V®ue
();

284 ià(
	gjsÚV®ue
 !ğ
nuÎ
 && !
jsÚV®ue
.
isNuÎ
()) {

285 
»suÉ
.
put
(
Çme
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
jsÚV®ue
.
asText
()));

290 
´Ùeùed
 
SŒšg
 
toJsÚ
(
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
)

291 
throws
 
	gIOExû±iÚ
 {

292 
ObjeùNode
 
	gnode
 = 
MAPPER
.
ü—‹ObjeùNode
();

293 
	gM­
<
	gSŒšg
, SŒšg> 
	g¡ršgM­
 = 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
);

294 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g·œ
 : 
¡ršgM­
.
’ŒyS‘
()) {

295 
node
.
put
(
·œ
.
g‘Key
(),…aœ.
g‘V®ue
());

297 
JsÚFaùÜy
 
	gjsÚFaùÜy
 = 
Ãw
 JsonFactory();

298 
Wr™”
 
	gwr™”
 = 
Ãw
 
SŒšgWr™”
();

299 
JsÚG’”©Ü
 
	gjsÚG’”©Ü
 = 
jsÚFaùÜy
.
ü—‹JsÚG’”©Ü
(
wr™”
);

300 
	gMAPPER
.
wr™eT»e
(
jsÚG’”©Ü
, 
node
);

301  
	gwr™”
.
toSŒšg
();

	@memcached/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@mongodb/src/main/java/site/ycsb/db/AsyncMongoDbClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbud”
.
	gQu”yBud”
.
	gwh”e
;

21 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gDu¿b™y
;

22 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gLockTy³
;

23 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gMÚgoCl›Á
;

24 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gMÚgoCl›ÁCÚfigu¿tiÚ
;

25 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gMÚgoCŞËùiÚ
;

26 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gMÚgoD©aba£
;

27 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gMÚgoDbUri
;

28 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gMÚgoFaùÜy
;

29 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gMÚgoI‹¿tÜ
;

30 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gR—dP»ã»nû
;

31 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbsÚ
.
	gDocum’t
;

32 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbsÚ
.
	gEËm’t
;

33 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbsÚ
.
	gEËm’tTy³
;

34 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbsÚ
.
	gbud”
.
	gBud”FaùÜy
;

35 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbsÚ
.
	gbud”
.
	gDocum’tBud”
;

36 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbsÚ
.
	g–em’t
.
	gBš¬yEËm’t
;

37 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbud”
.
	gB©chedWr™e
;

38 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbud”
.
	gB©chedWr™eMode
;

39 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbud”
.
	gFšd
;

40 
impÜt
 
	gcom
.
	g®Ïnbªk
.
	gmÚgodb
.
	gbud”
.
	gSÜt
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

46 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

47 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

48 
impÜt
 
	gjava
.
	gut
.
	gM­
;

49 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

50 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

51 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

52 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

66 
public
 cÏs 
	cAsyncMÚgoDbCl›Á
 
ex‹nds
 
	mDB
 {

69 
´Ùeùed
 
fš®
 
	mINCLUDE
 = 1;

72 
´iv©e
 
SŒšg
 
	md©aba£Name
;

75 
´iv©e
 
fš®
 
	mTh»adLoÿl
<
	mDocum’tBud”
> 
	mDOCUMENT_BUILDER
 =

76 
Ãw
 
Th»adLoÿl
<
Docum’tBud”
>() {

77 @
Ov”ride


78 
´Ùeùed
 
Docum’tBud”
 
š™ŸlV®ue
() {

79  
Bud”FaùÜy
.
¡¬t
();

84 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	gINIT_COUNT
 = 
Ãw
 AtomicInteger(0);

87 
´iv©e
 
MÚgoCl›Á
 
	gmÚgoCl›Á
;

90 
´iv©e
 
Du¿b™y
 
	gwr™eCÚûº
;

93 
´iv©e
 
R—dP»ã»nû
 
	g»adP»ã»nû
;

96 
´iv©e
 
MÚgoD©aba£
 
	gd©aba£
;

99 
´iv©e
 
	gb©chSize
;

102 
´iv©e
 
boŞ—n
 
	gu£Up£¹
;

105 
´iv©e
 
fš®
 
	gB©chedWr™e
.
Bud”
 
	gb©chedWr™e
 = 
B©chedWr™e
.
bud”
()

106 .
mode
(
B©chedWr™eMode
.
REORDERED
);

109 
´iv©e
 
	gb©chedWr™eCouÁ
 = 0;

115 @
Ov”ride


116 
public
 
fš®
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

117 ià(
INIT_COUNT
.
	`deüem’tAndG‘
() == 0) {

118 
Œy
 {

119 
mÚgoCl›Á
.
	`şo£
();

120 } 
	`ÿtch
 (
fš®
 
Exû±iÚ
 
e1
) {

121 
Sy¡em
.
”r
.
	`´šn
("Could‚ot close MongoDB connection…ool: "

122 + 
e1
.
	`toSŒšg
());

123 
e1
.
	`´štSckT¿û
();

125 } 
fš®ly
 {

126 
mÚgoCl›Á
 = 
nuÎ
;

127 
d©aba£
 = 
nuÎ
;

130 
	}
}

142 @
Ov”ride


143 
public
 
fš®
 
Stus
 
	$d–‘e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
) {

144 
Œy
 {

145 
fš®
 
MÚgoCŞËùiÚ
 
cŞËùiÚ
 = 
d©aba£
.
	`g‘CŞËùiÚ
(
bË
);

146 
fš®
 
Docum’t
 
q
 = 
Bud”FaùÜy
.
	`¡¬t
().
	`add
("_id", 
key
).
	`bud
();

147 
fš®
 
»s
 = 
cŞËùiÚ
.
	`d–‘e
(
q
, 
wr™eCÚûº
);

148 ià(
»s
 == 0) {

149 
Sy¡em
.
”r
.
	`´šn
("NÙhšg d–‘ed fÜ key " + 
key
);

150  
Stus
.
NOT_FOUND
;

152  
Stus
.
OK
;

153 } 
	`ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

154 
Sy¡em
.
”r
.
	`´šn
(
e
.
	`toSŒšg
());

155  
Stus
.
ERROR
;

157 
	}
}

163 @
Ov”ride


164 
public
 
fš®
 
	$š™
(è
throws
 
DBExû±iÚ
 {

165 
fš®
 
couÁ
 = 
INIT_COUNT
.
	`šüem’tAndG‘
();

167 
	`synchrÚized
 (
AsyncMÚgoDbCl›Á
.
şass
) {

168 
fš®
 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

170 ià(
mÚgoCl›Á
 !ğ
nuÎ
) {

171 
d©aba£
 = 
mÚgoCl›Á
.
	`g‘D©aba£
(
d©aba£Name
);

176 ià(
couÁ
 > 
mÚgoCl›Á
.
	`g‘CÚfig
().
	`g‘MaxCÚÃùiÚCouÁ
()) {

177 
mÚgoCl›Á
.
	`g‘CÚfig
().
	`£tLockTy³
(
LockTy³
.
MUTEX
);

184 
b©chSize
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("mongodb.batchsize", "1"));

187 
u£Up£¹
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

188 
´İs
.
	`g‘Prİ”ty
("mongodb.upsert", "false"));

193 
SŒšg
 
u¾
 =

194 
´İs


195 .
	`g‘Prİ”ty
("mongodb.url", "mongodb://localhost:27017/ycsb?w=1");

196 ià(!
u¾
.
	`¡¬tsW™h
("mongodb://")) {

197 
Sy¡em
.
”r
.
	`´šn
("ERROR: Inv®id URL: '" + 
u¾


202 
Sy¡em
.
	`ex™
(1);

205 
MÚgoDbUri
 
uri
 = 
Ãw
 
	`MÚgoDbUri
(
u¾
);

207 
Œy
 {

208 
d©aba£Name
 = 
uri
.
	`g‘D©aba£
();

209 ià((
d©aba£Name
 =ğ
nuÎ
è|| d©aba£Name.
	`isEm±y
()) {

212 
d©aba£Name
 = "ycsb";

215 
mÚgoCl›Á
 = 
MÚgoFaùÜy
.
	`ü—‹Cl›Á
(
uri
);

217 
MÚgoCl›ÁCÚfigu¿tiÚ
 
cÚfig
 = 
mÚgoCl›Á
.
	`g‘CÚfig
();

218 ià(!
u¾
.
	`toLow”Ca£
().
	`cÚšs
("locktype=")) {

219 
cÚfig
.
	`£tLockTy³
(
LockTy³
.
LOW_LATENCY_SPIN
);

222 
»adP»ã»nû
 = 
cÚfig
.
	`g‘DeçuÉR—dP»ã»nû
();

223 
wr™eCÚûº
 = 
cÚfig
.
	`g‘DeçuÉDu¿b™y
();

225 
d©aba£
 = 
mÚgoCl›Á
.
	`g‘D©aba£
(
d©aba£Name
);

227 
Sy¡em
.
out
.
	`´šn
("mÚgØcÚÃùiÚ c»©ed w™h " + 
u¾
);

228 } 
	`ÿtch
 (
fš®
 
Exû±iÚ
 
e1
) {

229 
Sy¡em
.
”r


230 .
	`´šn
("Could‚ot initialize MongoDB connection…ool for Loader: "

231 + 
e1
.
	`toSŒšg
());

232 
e1
.
	`´štSckT¿û
();

236 
	}
}

252 @
Ov”ride


253 
public
 
fš®
 
Stus
 
š£¹
(fš® 
SŒšg
 
bË
, fš® SŒšg 
key
,

254 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

255 
	gŒy
 {

256 
fš®
 
MÚgoCŞËùiÚ
 
	gcŞËùiÚ
 = 
d©aba£
.
g‘CŞËùiÚ
(
bË
);

257 
fš®
 
Docum’tBud”
 
	gtoIn£¹
 =

258 
DOCUMENT_BUILDER
.
g‘
().
»£t
().
add
("_id", 
key
);

259 
fš®
 
Docum’t
 
	gqu”y
 = 
toIn£¹
.
bud
();

260 
fš®
 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

261 
toIn£¹
.
add
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toA¼ay
());

265 ià(
	gb©chSize
 <= 1) {

266 
»suÉ
;

267 ià(
	gu£Up£¹
) {

268 
	g»suÉ
 = 
cŞËùiÚ
.
upd©e
(
qu”y
, 
toIn£¹
,

269  
çl£
, 
Œue
, 
wr™eCÚûº
);

272 
	gcŞËùiÚ
.
š£¹
(
wr™eCÚûº
, 
toIn£¹
);

273 
	g»suÉ
 = 1;

275  
	g»suÉ
 =ğ1 ? 
Stus
.
OK
 : Stus.
NOT_FOUND
;

279 
	gŒy
 {

280 ià(
	gu£Up£¹
) {

281 
	gb©chedWr™e
.
upd©e
(
qu”y
, 
toIn£¹
, 
çl£
,

282  
Œue
);

284 
	gb©chedWr™e
.
š£¹
(
toIn£¹
);

286 
	gb©chedWr™eCouÁ
 += 1;

288 ià(
	gb©chedWr™eCouÁ
 < 
	gb©chSize
) {

289  
	gStus
.
	gBATCHED_OK
;

292 
	gcouÁ
 = 
cŞËùiÚ
.
wr™e
(
b©chedWr™e
);

293 ià(
	gcouÁ
 =ğ
b©chedWr™eCouÁ
) {

294 
b©chedWr™e
.
»£t
().
mode
(
B©chedWr™eMode
.
REORDERED
);

295 
	gb©chedWr™eCouÁ
 = 0;

296  
	gStus
.
	gOK
;

299 
	gSy¡em
.
	g”r
.
´šn
("Number of inserted documents doesn't matchhe "

300 + "numb” s’t, " + 
couÁ
 + " in£¹ed, s’ˆ" + 
b©chedWr™eCouÁ
);

301 
	gb©chedWr™e
.
»£t
().
mode
(
B©chedWr™eMode
.
REORDERED
);

302 
	gb©chedWr™eCouÁ
 = 0;

303  
	gStus
.
	gERROR
;

304 } 
ÿtch
 (
Exû±iÚ
 
e
) {

305 
	gSy¡em
.
	g”r
.
´šn
("Exception whilerying bulk insert with "

306 + 
b©chedWr™eCouÁ
);

307 
	ge
.
´štSckT¿û
();

308  
	gStus
.
	gERROR
;

310 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

311 
	ge
.
´štSckT¿û
();

312  
	gStus
.
	gERROR
;

330 @
Ov”ride


331 
public
 
fš®
 
Stus
 
»ad
(fš® 
SŒšg
 
bË
, fš® SŒšg 
key
,

332 
fš®
 
S‘
<
SŒšg
> 
f›lds
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

333 
	gŒy
 {

334 
fš®
 
MÚgoCŞËùiÚ
 
	gcŞËùiÚ
 = 
d©aba£
.
g‘CŞËùiÚ
(
bË
);

335 
fš®
 
Docum’tBud”
 
	gqu”y
 =

336 
DOCUMENT_BUILDER
.
g‘
().
»£t
().
add
("_id", 
key
);

338 
Docum’t
 
	gqu”yResuÉ
 = 
nuÎ
;

339 ià(
	gf›lds
 !ğ
nuÎ
) {

340 
fš®
 
Docum’tBud”
 
f›ldsToR‘uº
 = 
Bud”FaùÜy
.
¡¬t
();

341 
fš®
 
	gI‹¿tÜ
<
	gSŒšg
> 
	g™”
 = 
f›lds
.
™”©Ü
();

342 
	g™”
.
hasNext
()) {

343 
	gf›ldsToR‘uº
.
add
(
™”
.
Ãxt
(), 1);

346 
fš®
 
	gFšd
.
Bud”
 
	gfb
 = 
Ãw
 
Fšd
.Bud”(
qu”y
);

347 
	gfb
.
´ojeùiÚ
(
f›ldsToR‘uº
);

348 
	gfb
.
£tLim™
(1);

349 
	gfb
.
£tB©chSize
(1);

350 
	gfb
.
»adP»ã»nû
(readPreference);

352 
fš®
 
	gMÚgoI‹¿tÜ
<
	gDocum’t
> 
	gci
 = 
cŞËùiÚ
.
fšd
(
fb
.
bud
());

353 ià(
	gci
.
hasNext
()) {

354 
	gqu”yResuÉ
 = 
ci
.
Ãxt
();

355 
	gci
.
şo£
();

358 
	gqu”yResuÉ
 = 
cŞËùiÚ
.
fšdOÃ
(
qu”y
);

361 ià(
	gqu”yResuÉ
 !ğ
nuÎ
) {

362 
flM­
(
»suÉ
, 
qu”yResuÉ
);

364  
	gqu”yResuÉ
 !ğ
nuÎ
 ? 
Stus
.
OK
 : Stus.
NOT_FOUND
;

365 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

366 
	gSy¡em
.
	g”r
.
´šn
(
e
.
toSŒšg
());

367  
	gStus
.
	gERROR
;

390 @
Ov”ride


391 
public
 
fš®
 
Stus
 
sÿn
(fš® 
SŒšg
 
bË
, fš® SŒšg 
¡¬tkey
,

392 
fš®
 
»cÜdcouÁ
, fš® 
S‘
<
SŒšg
> 
f›lds
,

393 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

394 
	gŒy
 {

395 
fš®
 
MÚgoCŞËùiÚ
 
	gcŞËùiÚ
 = 
d©aba£
.
g‘CŞËùiÚ
(
bË
);

397 
fš®
 
	gFšd
.
Bud”
 
	gfšd
 =

398 
Fšd
.
bud”
().
qu”y
(
wh”e
("_id").
g»©”ThªOrEqu®To
(
¡¬tkey
))

399 .
lim™
(
»cÜdcouÁ
).
b©chSize
ÔecÜdcouÁ).
sÜt
(
SÜt
.
asc
("_id"))

400 .
»adP»ã»nû
(readPreference);

402 ià(
	gf›lds
 !ğ
nuÎ
) {

403 
fš®
 
Docum’tBud”
 
f›ldsDoc
 = 
Bud”FaùÜy
.
¡¬t
();

404 
fš®
 
SŒšg
 
	gf›ld
 : 
f›lds
) {

405 
f›ldsDoc
.
add
(
f›ld
, 
INCLUDE
);

408 
	gfšd
.
´ojeùiÚ
(
f›ldsDoc
);

411 
	g»suÉ
.
’su»C­ac™y
(
»cÜdcouÁ
);

413 
fš®
 
	gMÚgoI‹¿tÜ
<
	gDocum’t
> 
	gcursÜ
 = 
cŞËùiÚ
.
fšd
(find);

414 ià(!
	gcursÜ
.
hasNext
()) {

415 
	gSy¡em
.
	g”r
.
´šn
("NÙhšg found iÀsÿÀfÜ key " + 
¡¬tkey
);

416  
	gStus
.
	gNOT_FOUND
;

418 
	gcursÜ
.
hasNext
()) {

421 
fš®
 
Docum’t
 
	gdoc
 = 
cursÜ
.
Ãxt
();

422 
fš®
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gdocAsM­
 =

423 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

425 
flM­
(
docAsM­
, 
doc
);

427 
	g»suÉ
.
add
(
docAsM­
);

430  
	gStus
.
	gOK
;

431 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

432 
	gSy¡em
.
	g”r
.
´šn
(
e
.
toSŒšg
());

433  
	gStus
.
	gERROR
;

451 @
Ov”ride


452 
public
 
fš®
 
Stus
 
upd©e
(fš® 
SŒšg
 
bË
, fš® SŒšg 
key
,

453 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

454 
	gŒy
 {

455 
fš®
 
MÚgoCŞËùiÚ
 
	gcŞËùiÚ
 = 
d©aba£
.
g‘CŞËùiÚ
(
bË
);

456 
fš®
 
Docum’tBud”
 
	gqu”y
 = 
Bud”FaùÜy
.
¡¬t
().
add
("_id", 
key
);

457 
fš®
 
Docum’tBud”
 
	gupd©e
 = 
Bud”FaùÜy
.
¡¬t
();

458 
fš®
 
Docum’tBud”
 
	gf›ldsToS‘
 = 
upd©e
.
push
("$set");

460 
fš®
 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

461 
f›ldsToS‘
.
add
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toA¼ay
());

463 
fš®
 
	g»s
 =

464 
cŞËùiÚ
.
upd©e
(
qu”y
, upd©e, 
çl£
, f®£, 
wr™eCÚûº
);

465  
	gwr™eCÚûº
 =ğ
Du¿b™y
.
NONE
 || 
»s
 =ğ1 ? 
Stus
.
OK
 : Stus.
NOT_FOUND
;

466 } 
ÿtch
 (
fš®
 
Exû±iÚ
 
e
) {

467 
	gSy¡em
.
	g”r
.
´šn
(
e
.
toSŒšg
());

468  
	gStus
.
	gERROR
;

480 
´Ùeùed
 
fš®
 
flM­
(fš® 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
,

481 
fš®
 
Docum’t
 
qu”yResuÉ
) {

482 
fš®
 
EËm’t
 
	gbe
 : 
qu”yResuÉ
) {

483 ià(
be
.
g‘Ty³
(è=ğ
EËm’tTy³
.
BINARY
) {

484 
»suÉ
.
put
(
be
.
g‘Name
(),

485 
Ãw
 
Bš¬yBy‹A¼ayI‹¿tÜ
((
Bš¬yEËm’t
è
be
));

494 
´iv©e
 
fš®
 cÏs 
	cBš¬yBy‹A¼ayI‹¿tÜ
 
ex‹nds
 
	gBy‹I‹¿tÜ
 {

497 
´iv©e
 
fš®
 
Bš¬yEËm’t
 
	gbš¬yEËm’t
;

500 
´iv©e
 
	goff£t
;

508 
public
 
Bš¬yBy‹A¼ayI‹¿tÜ
(
fš®
 
Bš¬yEËm’t
 
–em’t
) {

509 
	gthis
.
	gbš¬yEËm’t
 = 
–em’t
;

510 
	gthis
.
	goff£t
 = 0;

519 @
Ov”ride


520 
public
 
by‹sLeá
() {

521  
	gM©h
.
max
(0, 
bš¬yEËm’t
.
Ëngth
(è- 
off£t
);

531 @
Ov”ride


532 
public
 
boŞ—n
 
hasNext
() {

533  (
	goff£t
 < 
	gbš¬yEËm’t
.
Ëngth
());

542 @
Ov”ride


543 
public
 
by‹
 
ÃxtBy‹
() {

544 
fš®
 
by‹
 
	gv®ue
 = 
bš¬yEËm’t
.
g‘
(
off£t
);

545 
	goff£t
 += 1;

547  
	gv®ue
;

	@mongodb/src/main/java/site/ycsb/db/MongoDbClient.java

25 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

27 
impÜt
 
	gcom
.
	gmÚgodb
.
	gMÚgoCl›Á
;

28 
impÜt
 
	gcom
.
	gmÚgodb
.
	gMÚgoCl›ÁURI
;

29 
impÜt
 
	gcom
.
	gmÚgodb
.
	gR—dP»ã»nû
;

30 
impÜt
 
	gcom
.
	gmÚgodb
.
	gWr™eCÚûº
;

31 
impÜt
 
	gcom
.
	gmÚgodb
.
	gş›Á
.
	gFšdI‹¿bË
;

32 
impÜt
 
	gcom
.
	gmÚgodb
.
	gş›Á
.
	gMÚgoCŞËùiÚ
;

33 
impÜt
 
	gcom
.
	gmÚgodb
.
	gş›Á
.
	gMÚgoCursÜ
;

34 
impÜt
 
	gcom
.
	gmÚgodb
.
	gş›Á
.
	gMÚgoD©aba£
;

35 
impÜt
 
	gcom
.
	gmÚgodb
.
	gş›Á
.
	gmod–
.
	gIn£¹MªyO±iÚs
;

36 
impÜt
 
	gcom
.
	gmÚgodb
.
	gş›Á
.
	gmod–
.
	gUpd©eOÃMod–
;

37 
impÜt
 
	gcom
.
	gmÚgodb
.
	gş›Á
.
	gmod–
.
	gUpd©eO±iÚs
;

38 
impÜt
 
	gcom
.
	gmÚgodb
.
	gş›Á
.
	g»suÉ
.
	gD–‘eResuÉ
;

39 
impÜt
 
	gcom
.
	gmÚgodb
.
	gş›Á
.
	g»suÉ
.
	gUpd©eResuÉ
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

46 
impÜt
 
	gÜg
.
	gbsÚ
.
	gDocum’t
;

47 
impÜt
 
	gÜg
.
	gbsÚ
.
	gty³s
.
	gBš¬y
;

49 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

50 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

51 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

52 
impÜt
 
	gjava
.
	gut
.
	gM­
;

53 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

54 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

55 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

56 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

69 
public
 cÏs 
	cMÚgoDbCl›Á
 
ex‹nds
 
	mDB
 {

72 
´iv©e
 
fš®
 
IÁeg”
 
	mINCLUDE
 = IÁeg”.
v®ueOf
(1);

75 
´iv©e
 
fš®
 
In£¹MªyO±iÚs
 
	mINSERT_UNORDERED
 =

76 
Ãw
 
In£¹MªyO±iÚs
().
Üd”ed
(
çl£
);

79 
´iv©e
 
fš®
 
Upd©eO±iÚs
 
	mUPDATE_WITH_UPSERT
 = 
Ãw
 UpdateOptions()

80 .
up£¹
(
Œue
);

85 
´iv©e
 
SŒšg
 
	md©aba£Name
;

88 
´iv©e
 
MÚgoD©aba£
 
	md©aba£
;

94 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	mINIT_COUNT
 = 
Ãw
 AtomicInteger(0);

97 
´iv©e
 
MÚgoCl›Á
 
	mmÚgoCl›Á
;

100 
´iv©e
 
R—dP»ã»nû
 
	m»adP»ã»nû
;

103 
´iv©e
 
Wr™eCÚûº
 
	mwr™eCÚûº
;

106 
´iv©e
 
	mb©chSize
;

109 
´iv©e
 
boŞ—n
 
	mu£Up£¹
;

112 
´iv©e
 
fš®
 
	mLi¡
<
	mDocum’t
> 
	mbulkIn£¹s
 = 
Ãw
 
A¼ayLi¡
<
Docum’t
>();

118 @
Ov”ride


119 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

120 ià(
INIT_COUNT
.
	`deüem’tAndG‘
() == 0) {

121 
Œy
 {

122 
mÚgoCl›Á
.
	`şo£
();

123 } 
	`ÿtch
 (
Exû±iÚ
 
e1
) {

124 
Sy¡em
.
”r
.
	`´šn
("Could‚ot close MongoDB connection…ool: "

125 + 
e1
.
	`toSŒšg
());

126 
e1
.
	`´štSckT¿û
();

128 } 
fš®ly
 {

129 
d©aba£
 = 
nuÎ
;

130 
mÚgoCl›Á
 = 
nuÎ
;

145 @
Ov”ride


146 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

147 
Œy
 {

148 
MÚgoCŞËùiÚ
<
Docum’t
> 
cŞËùiÚ
 = 
d©aba£
.
	`g‘CŞËùiÚ
(
bË
);

150 
Docum’t
 
qu”y
 = 
Ãw
 
	`Docum’t
("_id", 
key
);

151 
D–‘eResuÉ
 
»suÉ
 =

152 
cŞËùiÚ
.
	`w™hWr™eCÚûº
(
wr™eCÚûº
).
	`d–‘eOÃ
(
qu”y
);

153 ià(
»suÉ
.
	`wasAcknowËdged
(è&&„esuÉ.
	`g‘D–‘edCouÁ
() == 0) {

154 
Sy¡em
.
”r
.
	`´šn
("NÙhšg d–‘ed fÜ key " + 
key
);

155  
Stus
.
NOT_FOUND
;

157  
Stus
.
OK
;

158 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

159 
Sy¡em
.
”r
.
	`´šn
(
e
.
	`toSŒšg
());

160  
Stus
.
ERROR
;

162 
	}
}

168 @
Ov”ride


169 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

170 
INIT_COUNT
.
	`šüem’tAndG‘
();

171 
	`synchrÚized
 (
INCLUDE
) {

172 ià(
mÚgoCl›Á
 !ğ
nuÎ
) {

176 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

179 
b©chSize
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("batchsize", "1"));

182 
u£Up£¹
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

183 
´İs
.
	`g‘Prİ”ty
("mongodb.upsert", "false"));

188 
SŒšg
 
u¾
 = 
´İs
.
	`g‘Prİ”ty
("mÚgodb.u¾", 
nuÎ
);

189 
boŞ—n
 
deçuÉedU¾
 = 
çl£
;

190 ià(
u¾
 =ğ
nuÎ
) {

191 
deçuÉedU¾
 = 
Œue
;

192 
u¾
 = "mongodb://localhost:27017/ycsb?w=1";

195 
u¾
 = 
O±iÚsSuµÜt
.
	`upd©eU¾
(u¾, 
´İs
);

197 ià(!
u¾
.
	`¡¬tsW™h
("mongodb://") && !url.startsWith("mongodb+srv://")) {

198 
Sy¡em
.
”r
.
	`´šn
("ERROR: Inv®id URL: '" + 
u¾


203 
Sy¡em
.
	`ex™
(1);

206 
Œy
 {

207 
MÚgoCl›ÁURI
 
uri
 = 
Ãw
 
	`MÚgoCl›ÁURI
(
u¾
);

209 
SŒšg
 
uriDb
 = 
uri
.
	`g‘D©aba£
();

210 ià(!
deçuÉedU¾
 && (
uriDb
 !ğ
nuÎ
è&& !uriDb.
	`isEm±y
()

211 && !"admš".
	`equ®s
(
uriDb
)) {

212 
d©aba£Name
 = 
uriDb
;

215 
d©aba£Name
 = "ycsb";

219 
»adP»ã»nû
 = 
uri
.
	`g‘O±iÚs
().
	`g‘R—dP»ã»nû
();

220 
wr™eCÚûº
 = 
uri
.
	`g‘O±iÚs
().
	`g‘Wr™eCÚûº
();

222 
mÚgoCl›Á
 = 
Ãw
 
	`MÚgoCl›Á
(
uri
);

223 
d©aba£
 =

224 
mÚgoCl›Á
.
	`g‘D©aba£
(
d©aba£Name
)

225 .
	`w™hR—dP»ã»nû
(
»adP»ã»nû
)

226 .
	`w™hWr™eCÚûº
(
wr™eCÚûº
);

228 
Sy¡em
.
out
.
	`´šn
("mÚgØş›Á cÚÃùiÚ c»©ed w™h " + 
u¾
);

229 } 
	`ÿtch
 (
Exû±iÚ
 
e1
) {

230 
Sy¡em
.
”r


231 .
	`´šn
("Could‚ot initialize MongoDB connection…ool for Loader: "

232 + 
e1
.
	`toSŒšg
());

233 
e1
.
	`´štSckT¿û
();

237 
	}
}

253 @
Ov”ride


254 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

255 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

256 
	gŒy
 {

257 
	gMÚgoCŞËùiÚ
<
	gDocum’t
> 
	gcŞËùiÚ
 = 
d©aba£
.
g‘CŞËùiÚ
(
bË
);

258 
Docum’t
 
	gtoIn£¹
 = 
Ãw
 Docum’t("_id", 
key
);

259 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

260 
toIn£¹
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toA¼ay
());

263 ià(
	gb©chSize
 == 1) {

264 ià(
u£Up£¹
) {

268 
cŞËùiÚ
.
»¶aûOÃ
(
Ãw
 
Docum’t
("_id", 
toIn£¹
.
g‘
("_id")),

269 
toIn£¹
, 
UPDATE_WITH_UPSERT
);

271 
	gcŞËùiÚ
.
š£¹OÃ
(
toIn£¹
);

274 
	gbulkIn£¹s
.
add
(
toIn£¹
);

275 ià(
	gbulkIn£¹s
.
size
(è=ğ
b©chSize
) {

276 ià(
u£Up£¹
) {

277 
Li¡
<
Upd©eOÃMod–
<
Docum’t
>> 
upd©es
 =

278 
Ãw
 
A¼ayLi¡
<
Upd©eOÃMod–
<
Docum’t
>>(
bulkIn£¹s
.
size
());

279 
Docum’t
 
	gdoc
 : 
bulkIn£¹s
) {

280 
upd©es
.
add
(
Ãw
 
Upd©eOÃMod–
<
Docum’t
>(

281 
Ãw
 
Docum’t
("_id", 
doc
.
g‘
("_id")),

282 
doc
, 
UPDATE_WITH_UPSERT
));

284 
	gcŞËùiÚ
.
bulkWr™e
(
upd©es
);

286 
	gcŞËùiÚ
.
š£¹Mªy
(
bulkIn£¹s
, 
INSERT_UNORDERED
);

288 
	gbulkIn£¹s
.
ş—r
();

290  
	gStus
.
	gBATCHED_OK
;

293  
	gStus
.
	gOK
;

294 } 
ÿtch
 (
Exû±iÚ
 
e
) {

295 
	gSy¡em
.
	g”r
.
´šn
("Exception whilerying bulk insert with "

296 + 
bulkIn£¹s
.
size
());

297 
	ge
.
´štSckT¿û
();

298  
	gStus
.
	gERROR
;

317 @
Ov”ride


318 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

319 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

320 
	gŒy
 {

321 
	gMÚgoCŞËùiÚ
<
	gDocum’t
> 
	gcŞËùiÚ
 = 
d©aba£
.
g‘CŞËùiÚ
(
bË
);

322 
Docum’t
 
	gqu”y
 = 
Ãw
 Docum’t("_id", 
key
);

324 
	gFšdI‹¿bË
<
	gDocum’t
> 
	gfšdI‹¿bË
 = 
cŞËùiÚ
.
fšd
(
qu”y
);

326 ià(
	gf›lds
 !ğ
nuÎ
) {

327 
Docum’t
 
´ojeùiÚ
 = 
Ãw
 Document();

328 
SŒšg
 
	gf›ld
 : 
f›lds
) {

329 
´ojeùiÚ
.
put
(
f›ld
, 
INCLUDE
);

331 
	gfšdI‹¿bË
.
´ojeùiÚ
(projection);

334 
Docum’t
 
	gqu”yResuÉ
 = 
fšdI‹¿bË
.
fœ¡
();

336 ià(
	gqu”yResuÉ
 !ğ
nuÎ
) {

337 
flM­
(
»suÉ
, 
qu”yResuÉ
);

339  
	gqu”yResuÉ
 !ğ
nuÎ
 ? 
Stus
.
OK
 : Stus.
NOT_FOUND
;

340 } 
ÿtch
 (
Exû±iÚ
 
e
) {

341 
	gSy¡em
.
	g”r
.
´šn
(
e
.
toSŒšg
());

342  
	gStus
.
	gERROR
;

364 @
Ov”ride


365 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

366 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

367 
	gMÚgoCursÜ
<
	gDocum’t
> 
	gcursÜ
 = 
nuÎ
;

368 
	gŒy
 {

369 
	gMÚgoCŞËùiÚ
<
	gDocum’t
> 
	gcŞËùiÚ
 = 
d©aba£
.
g‘CŞËùiÚ
(
bË
);

371 
Docum’t
 
	gsÿnRªge
 = 
Ãw
 Docum’t("$g‹", 
¡¬tkey
);

372 
Docum’t
 
	gqu”y
 = 
Ãw
 Docum’t("_id", 
sÿnRªge
);

373 
Docum’t
 
	gsÜt
 = 
Ãw
 Docum’t("_id", 
INCLUDE
);

375 
	gFšdI‹¿bË
<
	gDocum’t
> 
	gfšdI‹¿bË
 =

376 
cŞËùiÚ
.
fšd
(
qu”y
).
sÜt
(sÜt).
lim™
(
»cÜdcouÁ
);

378 ià(
	gf›lds
 !ğ
nuÎ
) {

379 
Docum’t
 
´ojeùiÚ
 = 
Ãw
 Document();

380 
SŒšg
 
	gf›ldName
 : 
f›lds
) {

381 
´ojeùiÚ
.
put
(
f›ldName
, 
INCLUDE
);

383 
	gfšdI‹¿bË
.
´ojeùiÚ
(projection);

386 
	gcursÜ
 = 
fšdI‹¿bË
.
™”©Ü
();

388 ià(!
	gcursÜ
.
hasNext
()) {

389 
	gSy¡em
.
	g”r
.
´šn
("NÙhšg found iÀsÿÀfÜ key " + 
¡¬tkey
);

390  
	gStus
.
	gERROR
;

393 
	g»suÉ
.
’su»C­ac™y
(
»cÜdcouÁ
);

395 
	gcursÜ
.
hasNext
()) {

396 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»suÉM­
 =

397 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

399 
Docum’t
 
	gobj
 = 
cursÜ
.
Ãxt
();

400 
flM­
(
»suÉM­
, 
obj
);

402 
	g»suÉ
.
add
(
»suÉM­
);

405  
	gStus
.
	gOK
;

406 } 
ÿtch
 (
Exû±iÚ
 
e
) {

407 
	gSy¡em
.
	g”r
.
´šn
(
e
.
toSŒšg
());

408  
	gStus
.
	gERROR
;

409 } 
	gfš®ly
 {

410 ià(
	gcursÜ
 !ğ
nuÎ
) {

411 
cursÜ
.
şo£
();

430 @
Ov”ride


431 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

432 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

433 
	gŒy
 {

434 
	gMÚgoCŞËùiÚ
<
	gDocum’t
> 
	gcŞËùiÚ
 = 
d©aba£
.
g‘CŞËùiÚ
(
bË
);

436 
Docum’t
 
	gqu”y
 = 
Ãw
 Docum’t("_id", 
key
);

437 
Docum’t
 
	gf›ldsToS‘
 = 
Ãw
 Document();

438 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

439 
f›ldsToS‘
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toA¼ay
());

441 
Docum’t
 
	gupd©e
 = 
Ãw
 Docum’t("$£t", 
f›ldsToS‘
);

443 
Upd©eResuÉ
 
	g»suÉ
 = 
cŞËùiÚ
.
upd©eOÃ
(
qu”y
, 
upd©e
);

444 ià(
	g»suÉ
.
wasAcknowËdged
(è&&„esuÉ.
g‘M©chedCouÁ
() == 0) {

445 
Sy¡em
.
”r
.
´šn
("NÙhšg upd©ed fÜ key " + 
key
);

446  
	gStus
.
	gNOT_FOUND
;

448  
	gStus
.
	gOK
;

449 } 
ÿtch
 (
Exû±iÚ
 
e
) {

450 
	gSy¡em
.
	g”r
.
´šn
(
e
.
toSŒšg
());

451  
	gStus
.
	gERROR
;

463 
´Ùeùed
 
flM­
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉM­
, 
Docum’t
 
obj
) {

464 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gObjeù
> 
	g’Œy
 : 
obj
.
’ŒyS‘
()) {

465 ià(
’Œy
.
g‘V®ue
(è
š¡ªûof
 
Bš¬y
) {

466 
»suÉM­
.
put
(
’Œy
.
g‘Key
(),

467 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(((
Bš¬y
è
’Œy
.
g‘V®ue
()).
g‘D©a
()));

	@mongodb/src/main/java/site/ycsb/db/OptionsSupport.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

26 
public
 
fš®
 cÏs 
	cO±iÚsSuµÜt
 {

29 
´iv©e
 
fš®
 
SŒšg
 
	mUNAVAILABLE
 = "n/a";

41 
public
 
SŒšg
 
	$upd©eU¾
(
SŒšg
 
u¾
, 
Prİ”t›s
 
´İs
) {

42 
SŒšg
 
»suÉ
 = 
u¾
;

45 
fš®
 
SŒšg
 
maxCÚÃùiÚs
 =

46 
´İs
.
	`g‘Prİ”ty
("mÚgodb.maxcÚÃùiÚs", 
UNAVAILABLE
).
	`toLow”Ca£
();

47 ià(!
UNAVAILABLE
.
	`equ®s
(
maxCÚÃùiÚs
)) {

48 
»suÉ
 = 
	`addU¾O±iÚ
ÔesuÉ, "maxPoŞSize", 
maxCÚÃùiÚs
);

52 
fš®
 
SŒšg
 
th»adsAÎowedToBlockFÜCÚÃùiÚMuÉl›r
 =

53 
´İs


54 .
	`g‘Prİ”ty
(

56 
UNAVAILABLE
).
	`toLow”Ca£
();

57 ià(!
UNAVAILABLE
.
	`equ®s
(
th»adsAÎowedToBlockFÜCÚÃùiÚMuÉl›r
)) {

58 
»suÉ
 =

59 
	`addU¾O±iÚ
(
»suÉ
, "waitQueueMultiple",

60 
th»adsAÎowedToBlockFÜCÚÃùiÚMuÉl›r
);

64 
SŒšg
 
wr™eCÚûºTy³
 =

65 
´İs
.
	`g‘Prİ”ty
("mÚgodb.wr™eCÚûº", 
UNAVAILABLE
).
	`toLow”Ca£
();

66 ià(!
UNAVAILABLE
.
	`equ®s
(
wr™eCÚûºTy³
)) {

67 ià("”rÜs_ignÜed".
	`equ®s
(
wr™eCÚûºTy³
)) {

68 
»suÉ
 = 
	`addU¾O±iÚ
(result, "w", "0");

69 } ià("uÇcknowËdged".
	`equ®s
(
wr™eCÚûºTy³
)) {

70 
»suÉ
 = 
	`addU¾O±iÚ
(result, "w", "0");

71 } ià("acknowËdged".
	`equ®s
(
wr™eCÚûºTy³
)) {

72 
»suÉ
 = 
	`addU¾O±iÚ
(result, "w", "1");

73 } ià("jouº®ed".
	`equ®s
(
wr™eCÚûºTy³
)) {

74 
»suÉ
 = 
	`addU¾O±iÚ
(result, "journal", "true");

77 
»suÉ
 = 
	`addU¾O±iÚ
(result, "j", "true");

80 } ià("»¶iÿ_acknowËdged".
	`equ®s
(
wr™eCÚûºTy³
)) {

81 
»suÉ
 = 
	`addU¾O±iÚ
(result, "w", "2");

82 } ià("majÜ™y".
	`equ®s
(
wr™eCÚûºTy³
)) {

83 
»suÉ
 = 
	`addU¾O±iÚ
(result, "w", "majority");

85 
Sy¡em
.
”r
.
	`´šn
("WARNING: Invalid writeConcern: '"

86 + 
wr™eCÚûºTy³
 + "' will be ignored. "

93 
SŒšg
 
»adP»ã»nûTy³
 =

94 
´İs
.
	`g‘Prİ”ty
("mÚgodb.»adP»ã»nû", 
UNAVAILABLE
).
	`toLow”Ca£
();

95 ià(!
UNAVAILABLE
.
	`equ®s
(
»adP»ã»nûTy³
)) {

96 ià("´im¬y".
	`equ®s
(
»adP»ã»nûTy³
)) {

97 
»suÉ
 = 
	`addU¾O±iÚ
(result, "readPreference", "primary");

98 } ià("´im¬y_´eã¼ed".
	`equ®s
(
»adP»ã»nûTy³
)) {

99 
»suÉ
 = 
	`addU¾O±iÚ
(result, "readPreference", "primaryPreferred");

100 } ià("£cÚd¬y".
	`equ®s
(
»adP»ã»nûTy³
)) {

101 
»suÉ
 = 
	`addU¾O±iÚ
(result, "readPreference", "secondary");

102 } ià("£cÚd¬y_´eã¼ed".
	`equ®s
(
»adP»ã»nûTy³
)) {

103 
»suÉ
 = 
	`addU¾O±iÚ
(result, "readPreference", "secondaryPreferred");

104 } ià("Ã¬e¡".
	`equ®s
(
»adP»ã»nûTy³
)) {

105 
»suÉ
 = 
	`addU¾O±iÚ
(result, "readPreference", "nearest");

107 
Sy¡em
.
”r
.
	`´šn
("WARNING: Invalid„eadPreference: '"

108 + 
»adP»ã»nûTy³
 + "' will be ignored. "

114  
»suÉ
;

128 
´iv©e
 
SŒšg
 
	$addU¾O±iÚ
(
SŒšg
 
u¾
, SŒšg 
Çme
, SŒšg 
v®ue
) {

129 
SŒšg
 
fuÎName
 = 
Çme
 + "=";

130 ià(!
u¾
.
	`cÚšs
(
fuÎName
)) {

131 ià(
u¾
.
	`cÚšs
("?")) {

132  
u¾
 + "&" + 
fuÎName
 + 
v®ue
;

134  
u¾
 + "?" + 
fuÎName
 + 
v®ue
;

136  
u¾
;

137 
	}
}

142 
´iv©e
 
	$O±iÚsSuµÜt
() {

144 
	}
}

	@mongodb/src/main/java/site/ycsb/db/package-info.java

31 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@mongodb/src/test/java/site/ycsb/db/AbstractDBTestCases.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gCÜeM©ch”s
.
	gis
;

20 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gCÜeM©ch”s
.
	gnÙ
;

21 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gCÜeM©ch”s
.
	gnÙNuÎV®ue
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹F®£
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Th©
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeNoExû±iÚ
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

32 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

33 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

35 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

36 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtAdd»ss
;

37 
impÜt
 
	gjava
.
	gÃt
.
	gSock‘
;

38 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

39 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

40 
impÜt
 
	gjava
.
	gut
.
	gM­
;

41 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

42 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

43 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

52 @
Suµ»ssW¬nšgs
("boxing")

53 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùDBTe¡Ca£s
 {

56 
´iv©e
 
fš®
 
	mMONGODB_DEFAULT_PORT
 = 27017;

62 @
BefÜeCÏss


63 
public
 
	$£tUpBefÜeCÏss
() {

65 
Sock‘
 
sock‘
 = 
nuÎ
;

66 
Œy
 {

68 
sock‘
 = 
Ãw
 
	`Sock‘
(
IÃtAdd»ss
.
	`g‘LoÿlHo¡
(), 
MONGODB_DEFAULT_PORT
);

69 
	`as£¹Th©
("Sock‘ i nÙ bound.", 
sock‘
.
	`g‘LoÿlPÜt
(), 
	`nÙ
(-1));

70 } 
	`ÿtch
 (
IOExû±iÚ
 
cÚÃùFaed
) {

71 
	`assumeNoExû±iÚ
("MongoDB is‚ot„unning. Skippingests.",

72 
cÚÃùFaed
);

73 } 
fš®ly
 {

74 ià(
sock‘
 !ğ
nuÎ
) {

75 
Œy
 {

76 
sock‘
.
	`şo£
();

77 } 
	`ÿtch
 (
IOExû±iÚ
 
ignÜe
) {

81 
sock‘
 = 
nuÎ
;

88 @
Te¡


89 
public
 
	$‹¡In£¹R—dD–‘e
() {

90 
fš®
 
DB
 
ş›Á
 = 
	`g‘DB
();

92 
fš®
 
SŒšg
 
bË
 = 
	`g‘CÏss
().
	`g‘Sim¶eName
();

93 
fš®
 
SŒšg
 
id
 = "delete";

95 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹ed
 =

96 
Ãw
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>();

97 
š£¹ed
.
	`put
("a", 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
Òew 
by‹
[] { 1, 2, 3, 4 }));

98 
Stus
 
»suÉ
 = 
ş›Á
.
	`š£¹
(
bË
, 
id
, 
š£¹ed
);

99 
	`as£¹Th©
("In£¹ did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

101 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»ad
 = 
Ãw
 HashMap<String, ByteIterator>();

102 
S‘
<
SŒšg
> 
keys
 = 
CŞËùiÚs
.
	`sšgËtÚ
("a");

103 
»suÉ
 = 
ş›Á
.
	`»ad
(
bË
, 
id
, 
keys
, 
»ad
);

104 
	`as£¹Th©
("R—d did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

105 
SŒšg
 
key
 : 
keys
) {

106 
By‹I‹¿tÜ
 
™”
 = 
»ad
.
	`g‘
(
key
);

108 
	`as£¹Th©
("Did‚Ù„—dhš£¹ed f›ld: " + 
key
, 
™”
,

109 
	`nÙNuÎV®ue
());

110 
	`as£¹True
(
™”
.
	`hasNext
());

111 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 1)));

112 
	`as£¹True
(
™”
.
	`hasNext
());

113 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 2)));

114 
	`as£¹True
(
™”
.
	`hasNext
());

115 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 3)));

116 
	`as£¹True
(
™”
.
	`hasNext
());

117 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 4)));

118 
	`as£¹F®£
(
™”
.
	`hasNext
());

121 
»suÉ
 = 
ş›Á
.
	`d–‘e
(
bË
, 
id
);

122 
	`as£¹Th©
("D–‘did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

124 
»ad
.
	`ş—r
();

125 
»suÉ
 = 
ş›Á
.
	`»ad
(
bË
, 
id
, 
nuÎ
, 
»ad
);

126 
	`as£¹Th©
("R—d,‡á” d–‘e, did‚Ù„‘uº‚Ù found (1).", 
»suÉ
,

127 
	`is
(
Stus
.
NOT_FOUND
));

128 
	`as£¹Th©
("Foundhd–‘ed f›lds.", 
»ad
.
	`size
(), 
	`is
(0));

130 
»suÉ
 = 
ş›Á
.
	`d–‘e
(
bË
, 
id
);

131 
	`as£¹Th©
("D–‘did‚Ù„‘uº‚Ù found (1).", 
»suÉ
, 
	`is
(
Stus
.
NOT_FOUND
));

132 
	}
}

137 @
Te¡


138 
public
 
	$‹¡In£¹R—dUpd©e
() {

139 
DB
 
ş›Á
 = 
	`g‘DB
();

141 
fš®
 
SŒšg
 
bË
 = 
	`g‘CÏss
().
	`g‘Sim¶eName
();

142 
fš®
 
SŒšg
 
id
 = "update";

144 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹ed
 =

145 
Ãw
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>();

146 
š£¹ed
.
	`put
("a", 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
Òew 
by‹
[] { 1, 2, 3, 4 }));

147 
Stus
 
»suÉ
 = 
ş›Á
.
	`š£¹
(
bË
, 
id
, 
š£¹ed
);

148 
	`as£¹Th©
("In£¹ did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

150 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»ad
 = 
Ãw
 HashMap<String, ByteIterator>();

151 
S‘
<
SŒšg
> 
keys
 = 
CŞËùiÚs
.
	`sšgËtÚ
("a");

152 
»suÉ
 = 
ş›Á
.
	`»ad
(
bË
, 
id
, 
keys
, 
»ad
);

153 
	`as£¹Th©
("R—d did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

154 
SŒšg
 
key
 : 
keys
) {

155 
By‹I‹¿tÜ
 
™”
 = 
»ad
.
	`g‘
(
key
);

157 
	`as£¹Th©
("Did‚Ù„—dhš£¹ed f›ld: " + 
key
, 
™”
,

158 
	`nÙNuÎV®ue
());

159 
	`as£¹True
(
™”
.
	`hasNext
());

160 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 1)));

161 
	`as£¹True
(
™”
.
	`hasNext
());

162 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 2)));

163 
	`as£¹True
(
™”
.
	`hasNext
());

164 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 3)));

165 
	`as£¹True
(
™”
.
	`hasNext
());

166 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 4)));

167 
	`as£¹F®£
(
™”
.
	`hasNext
());

170 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
upd©ed
 = 
Ãw
 HashMap<String, ByteIterator>();

171 
upd©ed
.
	`put
("a", 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
Òew 
by‹
[] { 5, 6, 7, 8 }));

172 
»suÉ
 = 
ş›Á
.
	`upd©e
(
bË
, 
id
, 
upd©ed
);

173 
	`as£¹Th©
("Upd©did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

175 
»ad
.
	`ş—r
();

176 
»suÉ
 = 
ş›Á
.
	`»ad
(
bË
, 
id
, 
nuÎ
, 
»ad
);

177 
	`as£¹Th©
("R—d,‡á” upd©e, did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

178 
SŒšg
 
key
 : 
keys
) {

179 
By‹I‹¿tÜ
 
™”
 = 
»ad
.
	`g‘
(
key
);

181 
	`as£¹Th©
("Did‚Ù„—dhš£¹ed f›ld: " + 
key
, 
™”
,

182 
	`nÙNuÎV®ue
());

183 
	`as£¹True
(
™”
.
	`hasNext
());

184 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 5)));

185 
	`as£¹True
(
™”
.
	`hasNext
());

186 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 6)));

187 
	`as£¹True
(
™”
.
	`hasNext
());

188 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 7)));

189 
	`as£¹True
(
™”
.
	`hasNext
());

190 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 8)));

191 
	`as£¹F®£
(
™”
.
	`hasNext
());

193 
	}
}

198 @
Te¡


199 
public
 
	$‹¡In£¹R—dUpd©eW™hUp£¹
() {

200 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

201 
´İs
.
	`£tPrİ”ty
("mongodb.upsert", "true");

202 
DB
 
ş›Á
 = 
	`g‘DB
(
´İs
);

204 
fš®
 
SŒšg
 
bË
 = 
	`g‘CÏss
().
	`g‘Sim¶eName
();

205 
fš®
 
SŒšg
 
id
 = "updateWithUpsert";

207 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹ed
 =

208 
Ãw
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>();

209 
š£¹ed
.
	`put
("a", 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
Òew 
by‹
[] { 1, 2, 3, 4 }));

210 
Stus
 
»suÉ
 = 
ş›Á
.
	`š£¹
(
bË
, 
id
, 
š£¹ed
);

211 
	`as£¹Th©
("In£¹ did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

213 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»ad
 = 
Ãw
 HashMap<String, ByteIterator>();

214 
S‘
<
SŒšg
> 
keys
 = 
CŞËùiÚs
.
	`sšgËtÚ
("a");

215 
»suÉ
 = 
ş›Á
.
	`»ad
(
bË
, 
id
, 
keys
, 
»ad
);

216 
	`as£¹Th©
("R—d did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

217 
SŒšg
 
key
 : 
keys
) {

218 
By‹I‹¿tÜ
 
™”
 = 
»ad
.
	`g‘
(
key
);

220 
	`as£¹Th©
("Did‚Ù„—dhš£¹ed f›ld: " + 
key
, 
™”
,

221 
	`nÙNuÎV®ue
());

222 
	`as£¹True
(
™”
.
	`hasNext
());

223 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 1)));

224 
	`as£¹True
(
™”
.
	`hasNext
());

225 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 2)));

226 
	`as£¹True
(
™”
.
	`hasNext
());

227 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 3)));

228 
	`as£¹True
(
™”
.
	`hasNext
());

229 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 4)));

230 
	`as£¹F®£
(
™”
.
	`hasNext
());

233 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
upd©ed
 = 
Ãw
 HashMap<String, ByteIterator>();

234 
upd©ed
.
	`put
("a", 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
Òew 
by‹
[] { 5, 6, 7, 8 }));

235 
»suÉ
 = 
ş›Á
.
	`upd©e
(
bË
, 
id
, 
upd©ed
);

236 
	`as£¹Th©
("Upd©did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

238 
»ad
.
	`ş—r
();

239 
»suÉ
 = 
ş›Á
.
	`»ad
(
bË
, 
id
, 
nuÎ
, 
»ad
);

240 
	`as£¹Th©
("R—d,‡á” upd©e, did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

241 
SŒšg
 
key
 : 
keys
) {

242 
By‹I‹¿tÜ
 
™”
 = 
»ad
.
	`g‘
(
key
);

244 
	`as£¹Th©
("Did‚Ù„—dhš£¹ed f›ld: " + 
key
, 
™”
,

245 
	`nÙNuÎV®ue
());

246 
	`as£¹True
(
™”
.
	`hasNext
());

247 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 5)));

248 
	`as£¹True
(
™”
.
	`hasNext
());

249 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 6)));

250 
	`as£¹True
(
™”
.
	`hasNext
());

251 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 7)));

252 
	`as£¹True
(
™”
.
	`hasNext
());

253 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
) 8)));

254 
	`as£¹F®£
(
™”
.
	`hasNext
());

256 
	}
}

261 @
Te¡


262 
public
 
	$‹¡Sÿn
() {

263 
fš®
 
DB
 
ş›Á
 = 
	`g‘DB
();

265 
fš®
 
SŒšg
 
bË
 = 
	`g‘CÏss
().
	`g‘Sim¶eName
();

268 
i
 = 0; i < 100; ++i) {

269 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹ed
 =

270 
Ãw
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>();

271 
š£¹ed
.
	`put
("a", 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
Òew 
by‹
[] {

272 (
by‹
è(
i
 & 0xFF), (byte) (i >> 8 & 0xFF), (byte) (i >> 16 & 0xFF),

273 (
by‹
è(
i
 >> 24 & 0xFF) }));

274 
Stus
 
»suÉ
 = 
ş›Á
.
	`š£¹
(
bË
, 
	`·dded
(
i
), 
š£¹ed
);

275 
	`as£¹Th©
("In£¹ did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

278 
S‘
<
SŒšg
> 
keys
 = 
CŞËùiÚs
.
	`sšgËtÚ
("a");

279 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉs
 =

280 
Ãw
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>>();

281 
Stus
 
»suÉ
 = 
ş›Á
.
	`sÿn
(
bË
, "00050", 5, 
nuÎ
, 
»suÉs
);

282 
	`as£¹Th©
("R—d did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

283 
	`as£¹Th©
(
»suÉs
.
	`size
(), 
	`is
(5));

284 
i
 = 0; i < 5; ++i) {

285 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»ad
 = 
»suÉs
.
	`g‘
(
i
);

286 
SŒšg
 
key
 : 
keys
) {

287 
By‹I‹¿tÜ
 
™”
 = 
»ad
.
	`g‘
(
key
);

289 
	`as£¹Th©
("Did‚Ù„—dhš£¹ed f›ld: " + 
key
, 
™”
,

290 
	`nÙNuÎV®ue
());

291 
	`as£¹True
(
™”
.
	`hasNext
());

292 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(), 
	`is
(
By‹
.
	`v®ueOf
((
by‹
è((
i
 + 50) & 0xFF))));

293 
	`as£¹True
(
™”
.
	`hasNext
());

294 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(),

295 
	`is
(
By‹
.
	`v®ueOf
((
by‹
è((
i
 + 50) >> 8 & 0xFF))));

296 
	`as£¹True
(
™”
.
	`hasNext
());

297 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(),

298 
	`is
(
By‹
.
	`v®ueOf
((
by‹
è((
i
 + 50) >> 16 & 0xFF))));

299 
	`as£¹True
(
™”
.
	`hasNext
());

300 
	`as£¹Th©
(
™”
.
	`ÃxtBy‹
(),

301 
	`is
(
By‹
.
	`v®ueOf
((
by‹
è((
i
 + 50) >> 24 & 0xFF))));

302 
	`as£¹F®£
(
™”
.
	`hasNext
());

305 
	}
}

312 
´Ùeùed
 
DB
 
	$g‘DB
() {

313  
	`g‘DB
(
Ãw
 
	`Prİ”t›s
());

314 
	}
}

323 
´Ùeùed
 
ab¡¿ù
 
DB
 
g‘DB
(
Prİ”t›s
 
´İs
);

332 
´iv©e
 
SŒšg
 
	$·dded
(
i
) {

333 
SŒšg
 
»suÉ
 = SŒšg.
	`v®ueOf
(
i
);

334 
»suÉ
.
	`Ëngth
() < 5) {

335 
»suÉ
 = "0" +„esult;

337  
»suÉ
;

338 
	}
}

	@mongodb/src/test/java/site/ycsb/db/AsyncMongoDbClientTest.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

24 
public
 cÏs 
	cAsyncMÚgoDbCl›ÁTe¡
 
ex‹nds
 
	mMÚgoDbCl›ÁTe¡
 {

26 @
Ov”ride


27 
´Ùeùed
 
DB
 
	$š¡ªtŸ‹Cl›Á
() {

28  
Ãw
 
	`AsyncMÚgoDbCl›Á
();

30 
	}
}

	@mongodb/src/test/java/site/ycsb/db/MongoDbClientTest.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeNoExû±iÚ
;

21 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

30 
public
 cÏs 
	cMÚgoDbCl›ÁTe¡
 
ex‹nds
 
	mAb¡¿ùDBTe¡Ca£s
 {

33 
´iv©e
 
DB
 
	mmyCl›Á
 = 
nuÎ
;

35 
´Ùeùed
 
DB
 
	$š¡ªtŸ‹Cl›Á
() {

36  
Ãw
 
	`MÚgoDbCl›Á
();

42 @
Aá”


43 
public
 
	$‹¬Down
() {

44 
Œy
 {

45 
myCl›Á
.
	`ş—nup
();

46 } 
	`ÿtch
 (
Exû±iÚ
 
”rÜ
) {

48 } 
fš®ly
 {

49 
myCl›Á
 = 
nuÎ
;

51 
	}
}

59 @
Ov”ride


60 
´Ùeùed
 
DB
 
	$g‘DB
(
Prİ”t›s
 
´İs
) {

61 ifĞ
myCl›Á
 =ğ
nuÎ
 ) {

62 
myCl›Á
 = 
	`š¡ªtŸ‹Cl›Á
();

63 
myCl›Á
.
	`£tPrİ”t›s
(
´İs
);

64 
Œy
 {

65 
myCl›Á
.
	`š™
();

66 } 
	`ÿtch
 (
Exû±iÚ
 
”rÜ
) {

67 
	`assumeNoExû±iÚ
(
”rÜ
);

70  
myCl›Á
;

71 
	}
}

	@mongodb/src/test/java/site/ycsb/db/OptionsSupportTest.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gO±iÚsSuµÜt
.
	gupd©eU¾
;

20 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gCÜeM©ch”s
.
	gis
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Th©
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

32 
public
 cÏs 
	cO±iÚsSuµÜtTe¡
 {

38 @
Te¡


39 
public
 
	$‹¡Upd©eU¾MaxCÚÃùiÚs
() {

40 
	`as£¹Th©
(

41 
	`upd©eU¾
("mongodb://locahost:27017/",

42 
	`´İs
("mongodb.maxconnections", "1234")),

43 
	`is
("mongodb://locahost:27017/?maxPoolSize=1234"));

44 
	`as£¹Th©
(

45 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

46 
	`´İs
("mongodb.maxconnections", "1234")),

47 
	`is
("mongodb://locahost:27017/?foo=bar&maxPoolSize=1234"));

48 
	`as£¹Th©
(

49 
	`upd©eU¾
("mongodb://locahost:27017/?maxPoolSize=1",

50 
	`´İs
("mongodb.maxconnections", "1234")),

51 
	`is
("mongodb://locahost:27017/?maxPoolSize=1"));

52 
	`as£¹Th©
(

53 
	`upd©eU¾
("mÚgodb://loÿho¡:27017/?foo=b¬", 
	`´İs
("foo", "1234")),

54 
	`is
("mongodb://locahost:27017/?foo=bar"));

61 @
Te¡


62 
public
 
	$‹¡Upd©eU¾Wa™QueueMuÉË
() {

63 
	`as£¹Th©
(

64 
	`upd©eU¾
(

66 
	`´İs
("mongodb.threadsAllowedToBlockForConnectionMultiplier",

68 
	`is
("mongodb://locahost:27017/?waitQueueMultiple=1234"));

69 
	`as£¹Th©
(

70 
	`upd©eU¾
(

72 
	`´İs
("mongodb.threadsAllowedToBlockForConnectionMultiplier",

74 
	`is
("mongodb://locahost:27017/?foo=bar&waitQueueMultiple=1234"));

75 
	`as£¹Th©
(

76 
	`upd©eU¾
(

78 
	`´İs
("mongodb.threadsAllowedToBlockForConnectionMultiplier",

79 "1234")), 
	`is
("mongodb://locahost:27017/?waitQueueMultiple=1"));

80 
	`as£¹Th©
(

81 
	`upd©eU¾
("mÚgodb://loÿho¡:27017/?foo=b¬", 
	`´İs
("foo", "1234")),

82 
	`is
("mongodb://locahost:27017/?foo=bar"));

83 
	}
}

89 @
Te¡


90 
public
 
	$‹¡Upd©eU¾Wr™eCÚûº
() {

91 
	`as£¹Th©
(

92 
	`upd©eU¾
("mongodb://locahost:27017/",

93 
	`´İs
("mongodb.writeConcern", "errors_ignored")),

94 
	`is
("mongodb://locahost:27017/?w=0"));

95 
	`as£¹Th©
(

96 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

97 
	`´İs
("mongodb.writeConcern", "unacknowledged")),

98 
	`is
("mongodb://locahost:27017/?foo=bar&w=0"));

99 
	`as£¹Th©
(

100 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

101 
	`´İs
("mongodb.writeConcern", "acknowledged")),

102 
	`is
("mongodb://locahost:27017/?foo=bar&w=1"));

103 
	`as£¹Th©
(

104 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

105 
	`´İs
("mongodb.writeConcern", "journaled")),

106 
	`is
("mongodb://locahost:27017/?foo=bar&journal=true&j=true"));

107 
	`as£¹Th©
(

108 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

109 
	`´İs
("mongodb.writeConcern", "replica_acknowledged")),

110 
	`is
("mongodb://locahost:27017/?foo=bar&w=2"));

111 
	`as£¹Th©
(

112 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

113 
	`´İs
("mongodb.writeConcern", "majority")),

114 
	`is
("mongodb://locahost:27017/?foo=bar&w=majority"));

117 
	`as£¹Th©
(

118 
	`upd©eU¾
("mongodb://locahost:27017/?w=1",

119 
	`´İs
("mongodb.writeConcern", "acknowledged")),

120 
	`is
("mongodb://locahost:27017/?w=1"));

123 
	`as£¹Th©
(

124 
	`upd©eU¾
("mÚgodb://loÿho¡:27017/?foo=b¬", 
	`´İs
("foo", "1234")),

125 
	`is
("mongodb://locahost:27017/?foo=bar"));

126 
	}
}

132 @
Te¡


133 
public
 
	$‹¡Upd©eU¾R—dP»ã»nû
() {

134 
	`as£¹Th©
(

135 
	`upd©eU¾
("mongodb://locahost:27017/",

136 
	`´İs
("mongodb.readPreference", "primary")),

137 
	`is
("mongodb://locahost:27017/?readPreference=primary"));

138 
	`as£¹Th©
(

139 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

140 
	`´İs
("mongodb.readPreference", "primary_preferred")),

141 
	`is
("mongodb://locahost:27017/?foo=bar&readPreference=primaryPreferred"));

142 
	`as£¹Th©
(

143 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

144 
	`´İs
("mongodb.readPreference", "secondary")),

145 
	`is
("mongodb://locahost:27017/?foo=bar&readPreference=secondary"));

146 
	`as£¹Th©
(

147 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

148 
	`´İs
("mongodb.readPreference", "secondary_preferred")),

149 
	`is
("mongodb://locahost:27017/?foo=bar&readPreference=secondaryPreferred"));

150 
	`as£¹Th©
(

151 
	`upd©eU¾
("mongodb://locahost:27017/?foo=bar",

152 
	`´İs
("mongodb.readPreference", "nearest")),

153 
	`is
("mongodb://locahost:27017/?foo=bar&readPreference=nearest"));

156 
	`as£¹Th©
(

157 
	`upd©eU¾
("mongodb://locahost:27017/?readPreference=primary",

158 
	`´İs
("mongodb.readPreference", "secondary")),

159 
	`is
("mongodb://locahost:27017/?readPreference=primary"));

162 
	`as£¹Th©
(

163 
	`upd©eU¾
("mÚgodb://loÿho¡:27017/?foo=b¬", 
	`´İs
("foo", "1234")),

164 
	`is
("mongodb://locahost:27017/?foo=bar"));

165 
	}
}

176 
´iv©e
 
Prİ”t›s
 
	$´İs
(
SŒšg
 
key
, SŒšg 
v®ue
) {

177 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

179 
´İs
.
	`£tPrİ”ty
(
key
, 
v®ue
);

181  
´İs
;

182 
	}
}

	@nosqldb/src/main/java/site/ycsb/db/NoSqlDbClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

23 
impÜt
 
	gjava
.
	gut
.
	gM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
impÜt
 
	gjava
.
	gut
.
	gSÜ‹dM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

30 
impÜt
 
	gÜaşe
.
	gkv
.
	gCÚsi¡’cy
;

31 
impÜt
 
	gÜaşe
.
	gkv
.
	gDu¿b™y
;

32 
impÜt
 
	gÜaşe
.
	gkv
.
	gFauÉExû±iÚ
;

33 
impÜt
 
	gÜaşe
.
	gkv
.
	gKVStÜe
;

34 
impÜt
 
	gÜaşe
.
	gkv
.
	gKVStÜeCÚfig
;

35 
impÜt
 
	gÜaşe
.
	gkv
.
	gKVStÜeFaùÜy
;

36 
impÜt
 
	gÜaşe
.
	gkv
.
	gKey
;

37 
impÜt
 
	gÜaşe
.
	gkv
.
	gReque¡Lim™CÚfig
;

38 
impÜt
 
	gÜaşe
.
	gkv
.
	gV®ue
;

39 
impÜt
 
	gÜaşe
.
	gkv
.
	gV®ueV”siÚ
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

45 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

50 
public
 cÏs 
	cNoSqlDbCl›Á
 
ex‹nds
 
	mDB
 {

52 
´iv©e
 
KVStÜe
 
	m¡Üe
;

54 
´iv©e
 
	$g‘Prİ”tyIÁ
(
Prİ”t›s
 
´İ”t›s
, 
SŒšg
 
key
,

55 
deçuÉV®ue
è
throws
 
DBExû±iÚ
 {

56 
SŒšg
 
p
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
key
);

57 
i
 = 
deçuÉV®ue
;

58 ià(
p
 !ğ
nuÎ
) {

59 
Œy
 {

60 
i
 = 
IÁeg”
.
	`·r£IÁ
(
p
);

61 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
e
) {

62 
throw
 
Ãw
 
	`DBExû±iÚ
("IÎeg®‚umb” fÜm© iÀ" + 
key
 + "…roperty");

65  
i
;

68 @
Ov”ride


69 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

70 
Prİ”t›s
 
´İ”t›s
 = 
	`g‘Prİ”t›s
();

73 
SŒšg
 
¡ÜeName
 = 
´İ”t›s
.
	`g‘Prİ”ty
("storeName", "kvstore");

74 
SŒšg
[] 
h–³rHo¡s
 =

75 
´İ”t›s
.
	`g‘Prİ”ty
("h–³rHo¡", "loÿlho¡:5000").
	`¥l™
(",");

77 
KVStÜeCÚfig
 
cÚfig
 = 
Ãw
 
	`KVStÜeCÚfig
(
¡ÜeName
, 
h–³rHo¡s
);

80 
SŒšg
 
p
;

82 
p
 = 
´İ”t›s
.
	`g‘Prİ”ty
("consistency");

83 ià(
p
 !ğ
nuÎ
) {

84 ià(
p
.
	`equ®sIgnÜeCa£
("ABSOLUTE")) {

85 
cÚfig
.
	`£tCÚsi¡’cy
(
CÚsi¡’cy
.
ABSOLUTE
);

86 } ià(
p
.
	`equ®sIgnÜeCa£
("NONE_REQUIRED")) {

87 
cÚfig
.
	`£tCÚsi¡’cy
(
CÚsi¡’cy
.
NONE_REQUIRED
);

89 
throw
 
Ãw
 
	`DBExû±iÚ
("Illegal value in consistency…roperty");

93 
p
 = 
´İ”t›s
.
	`g‘Prİ”ty
("durability");

94 ià(
p
 !ğ
nuÎ
) {

95 ià(
p
.
	`equ®sIgnÜeCa£
("COMMIT_NO_SYNC")) {

96 
cÚfig
.
	`£tDu¿b™y
(
Du¿b™y
.
COMMIT_NO_SYNC
);

97 } ià(
p
.
	`equ®sIgnÜeCa£
("COMMIT_SYNC")) {

98 
cÚfig
.
	`£tDu¿b™y
(
Du¿b™y
.
COMMIT_SYNC
);

99 } ià(
p
.
	`equ®sIgnÜeCa£
("COMMIT_WRITE_NO_SYNC")) {

100 
cÚfig
.
	`£tDu¿b™y
(
Du¿b™y
.
COMMIT_WRITE_NO_SYNC
);

102 
throw
 
Ãw
 
	`DBExû±iÚ
("Illegal value in durability…roperty");

106 
maxAùiveReque¡s
 =

107 
	`g‘Prİ”tyIÁ
(
´İ”t›s
, "requestLimit.maxActiveRequests",

108 
Reque¡Lim™CÚfig
.
DEFAULT_MAX_ACTIVE_REQUESTS
);

109 
»que¡Th»shŞdP”ûÁ
 =

110 
	`g‘Prİ”tyIÁ
(
´İ”t›s
, "requestLimit.requestThresholdPercent",

111 
Reque¡Lim™CÚfig
.
DEFAULT_REQUEST_THRESHOLD_PERCENT
);

112 
nodeLim™P”ûÁ
 =

113 
	`g‘Prİ”tyIÁ
(
´İ”t›s
, "requestLimit.nodeLimitPercent",

114 
Reque¡Lim™CÚfig
.
DEFAULT_NODE_LIMIT_PERCENT
);

115 
Reque¡Lim™CÚfig
 
»que¡Lim™CÚfig
;

121 
»que¡Lim™CÚfig
 = 
Ãw
 
	`Reque¡Lim™CÚfig
(
maxAùiveReque¡s
,

122 
»que¡Th»shŞdP”ûÁ
, 
nodeLim™P”ûÁ
);

126 
cÚfig
.
	`£tReque¡Lim™
(
»que¡Lim™CÚfig
);

128 
p
 = 
´İ”t›s
.
	`g‘Prİ”ty
("requestTimeout");

129 ià(
p
 !ğ
nuÎ
) {

130 
timeout
 = 1;

131 
Œy
 {

132 
timeout
 = 
LÚg
.
	`·r£LÚg
(
p
);

133 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
e
) {

134 
throw
 
Ãw
 
	`DBExû±iÚ
(

137 
Œy
 {

139 
cÚfig
.
	`£tReque¡Timeout
(
timeout
, 
TimeUn™
.
SECONDS
);

140 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

141 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

145 
Œy
 {

146 
¡Üe
 = 
KVStÜeFaùÜy
.
	`g‘StÜe
(
cÚfig
);

147 } 
	`ÿtch
 (
FauÉExû±iÚ
 
e
) {

148 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

150 
	}
}

152 @
Ov”ride


153 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

154 
¡Üe
.
	`şo£
();

155 
	}
}

163 
´iv©e
 
Key
 
	$ü—‹Key
(
SŒšg
 
bË
, SŒšg 
key
, SŒšg 
f›ld
) {

164 
Li¡
<
SŒšg
> 
majÜP©h
 = 
Ãw
 
A¼ayLi¡
<String>();

165 
majÜP©h
.
	`add
(
bË
);

166 
majÜP©h
.
	`add
(
key
);

167 ià(
f›ld
 =ğ
nuÎ
) {

168  
Key
.
	`ü—‹Key
(
majÜP©h
);

171  
Key
.
	`ü—‹Key
(
majÜP©h
, 
f›ld
);

172 
	}
}

174 
´iv©e
 
Key
 
	$ü—‹Key
(
SŒšg
 
bË
, SŒšg 
key
) {

175  
	`ü—‹Key
(
bË
, 
key
, 
nuÎ
);

176 
	}
}

178 
´iv©e
 
SŒšg
 
	$g‘F›ldFromKey
(
Key
 
key
) {

179  
key
.
	`g‘MšÜP©h
().
	`g‘
(0);

180 
	}
}

182 @
Ov”ride


183 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

184 
Key
 
	gkvKey
 = 
ü—‹Key
(
bË
, 
key
);

185 
	gSÜ‹dM­
<
	gKey
, 
	gV®ueV”siÚ
> 
	gkvResuÉ
;

186 
	gŒy
 {

187 
	gkvResuÉ
 = 
¡Üe
.
muÉiG‘
(
kvKey
, 
nuÎ
,‚ull);

188 } 
ÿtch
 (
FauÉExû±iÚ
 
e
) {

189 
	gSy¡em
.
	g”r
.
´šn
(
e
);

190  
	gStus
.
	gERROR
;

193 
	gM­
.
	gEÁry
<
	gKey
, 
	gV®ueV”siÚ
> 
	g’Œy
 : 
kvResuÉ
.
’ŒyS‘
()) {

195 
SŒšg
 
f›ld
 = 
g‘F›ldFromKey
(
’Œy
.
g‘Key
());

196 ià(
	gf›lds
 !ğ
nuÎ
 && !
f›lds
.
cÚšs
(
f›ld
)) {

199 
	g»suÉ
.
put
(
f›ld
,

200 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
’Œy
.
g‘V®ue
().getValue().getValue()));

203  
	gStus
.
	gOK
;

206 @
Ov”ride


207 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

208 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

209 
	gSy¡em
.
	g”r
.
´šn
("Oracle NoSQL Database does‚ot support Scan semantics");

210  
	gStus
.
	gERROR
;

213 @
Ov”ride


214 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

215 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

216 
Key
 
kvKey
 = 
ü—‹Key
(
bË
, 
key
, 
’Œy
.
g‘Key
());

217 
V®ue
 
	gkvV®ue
 = V®ue.
ü—‹V®ue
(
’Œy
.
g‘V®ue
().
toA¼ay
());

218 
	gŒy
 {

219 
	g¡Üe
.
put
(
kvKey
, 
kvV®ue
);

220 } 
ÿtch
 (
FauÉExû±iÚ
 
e
) {

221 
	gSy¡em
.
	g”r
.
´šn
(
e
);

222  
	gStus
.
	gERROR
;

226  
	gStus
.
	gOK
;

229 @
Ov”ride


230 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

231  
upd©e
(
bË
, 
key
, 
v®ues
);

234 @
Ov”ride


235 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

236 
Key
 
kvKey
 = 
	`ü—‹Key
(
bË
, 
key
);

237 
Œy
 {

238 
¡Üe
.
	`muÉiD–‘e
(
kvKey
, 
nuÎ
,‚ull);

239 } 
	`ÿtch
 (
FauÉExû±iÚ
 
e
) {

240 
Sy¡em
.
”r
.
	`´šn
(
e
);

241  
Stus
.
ERROR
;

244  
Stus
.
OK
;

245 
	}
}

	@nosqldb/src/main/java/site/ycsb/db/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@orientdb/src/main/java/site/ycsb/db/OrientDBClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gş›Á
.
	g»mÙe
.
	gOS”v”Admš
;

21 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	gcÚfig
.
	gOGlob®CÚfigu¿tiÚ
;

22 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	gdb
.
	gOP¬t™iÚedD©aba£PoŞ
;

23 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	gdb
.
	gdocum’t
.
	gOD©aba£Docum’tTx
;

24 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	gdiùiÚ¬y
.
	gODiùiÚ¬y
;

25 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	gexû±iÚ
.
	gOCÚcu¼’tModifiÿtiÚExû±iÚ
;

26 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	gšdex
.
	gOIndexCursÜ
;

27 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	g»cÜd
.
	gORecÜd
;

28 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	g»cÜd
.
	gim¶
.
	gODocum’t
;

29 
impÜt
 
	gs™e
.
	gycsb
.*;

30 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

31 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

33 
impÜt
 
	gjava
.
	gio
.
	gFe
;

34 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gM­
;

36 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

37 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

38 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

39 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLock
;

40 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁLock
;

45 
public
 cÏs 
	cOr›ÁDBCl›Á
 
ex‹nds
 
	mDB
 {

46 
´iv©e
 
fš®
 
SŒšg
 
	mURL_PROPERTY
 = "orientdb.url";

47 
´iv©e
 
fš®
 
SŒšg
 
	mURL_PROPERTY_DEFAULT
 =

48 "¶oÿl:." + 
Fe
.
£·¿tÜ
 + "target" + File.separator + "databases" + File.separator + "ycsb";

50 
´iv©e
 
fš®
 
SŒšg
 
	mUSER_PROPERTY
 = "orientdb.user";

51 
´iv©e
 
fš®
 
SŒšg
 
	mUSER_PROPERTY_DEFAULT
 = "admin";

53 
´iv©e
 
fš®
 
SŒšg
 
	mPASSWORD_PROPERTY
 = "orientdb.password";

54 
´iv©e
 
fš®
 
SŒšg
 
	mPASSWORD_PROPERTY_DEFAULT
 = "admin";

56 
´iv©e
 
fš®
 
SŒšg
 
	mNEWDB_PROPERTY
 = "orientdb.newdb";

57 
´iv©e
 
fš®
 
SŒšg
 
	mNEWDB_PROPERTY_DEFAULT
 = "false";

59 
´iv©e
 
fš®
 
SŒšg
 
	mSTORAGE_TYPE_PROPERTY
 = "orientdb.remote.storagetype";

61 
´iv©e
 
fš®
 
SŒšg
 
	mORIENTDB_DOCUMENT_TYPE
 = "document";

63 
´iv©e
 
fš®
 
SŒšg
 
	mCLASS
 = "usertable";

65 
´iv©e
 
fš®
 
Lock
 
	mINIT_LOCK
 = 
Ãw
 
R“Á¿ÁLock
();

66 
´iv©e
 
boŞ—n
 
	mdbChecked
 = 
çl£
;

67 
´iv©e
 vŞ©
OP¬t™iÚedD©aba£PoŞ
 
	md©aba£PoŞ
;

68 
´iv©e
 
boŞ—n
 
	mš™Ÿlized
 = 
çl£
;

69 
´iv©e
 
	mş›ÁCouÁ”
 = 0;

71 
´iv©e
 
boŞ—n
 
	misRemÙe
 = 
çl£
;

73 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = 
Logg”FaùÜy
.
g‘Logg”
(
Or›ÁDBCl›Á
.
şass
);

78 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

80 
fš®
 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

81 
SŒšg
 
u¾
 = 
´İs
.
	`g‘Prİ”ty
(
URL_PROPERTY
, 
URL_PROPERTY_DEFAULT
);

82 
SŒšg
 
u£r
 = 
´İs
.
	`g‘Prİ”ty
(
USER_PROPERTY
, 
USER_PROPERTY_DEFAULT
);

84 
SŒšg
 
·sswÜd
 = 
´İs
.
	`g‘Prİ”ty
(
PASSWORD_PROPERTY
, 
PASSWORD_PROPERTY_DEFAULT
);

85 
BoŞ—n
 
Ãwdb
 = BoŞ—n.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
(
NEWDB_PROPERTY
, 
NEWDB_PROPERTY_DEFAULT
));

86 
SŒšg
 
»mÙeStÜageTy³
 = 
´İs
.
	`g‘Prİ”ty
(
STORAGE_TYPE_PROPERTY
);

88 
INIT_LOCK
.
	`lock
();

89 
Œy
 {

90 
ş›ÁCouÁ”
++;

91 ià(!
š™Ÿlized
) {

92 
OGlob®CÚfigu¿tiÚ
.
	`dumpCÚfigu¿tiÚ
(
Sy¡em
.
out
);

94 
LOG
.
	`šfo
("Or›ÁDB†ßdšg d©aba£ u¾ = " + 
u¾
);

96 
OD©aba£Docum’tTx
 
db
 = 
Ãw
 
	`OD©aba£Docum’tTx
(
u¾
);

98 ià(
db
.
	`g‘StÜage
().
	`isRemÙe
()) {

99 
isRemÙe
 = 
Œue
;

102 ià(!
dbChecked
) {

103 ià(!
isRemÙe
) {

104 ià(
Ãwdb
) {

105 ià(
db
.
	`exi¡s
()) {

106 
db
.
	`İ’
(
u£r
, 
·sswÜd
);

107 
LOG
.
	`šfo
("OrientDB drop‡nd„ecreate fresh db");

109 
db
.
	`drİ
();

112 
db
.
	`ü—‹
();

114 ià(!
db
.
	`exi¡s
()) {

115 
LOG
.
	`šfo
("OrientDB database‚ot found, creating fresh db");

117 
db
.
	`ü—‹
();

121 
OS”v”Admš
 
£rv”
 = 
Ãw
 
	`OS”v”Admš
(
u¾
).
	`cÚÃù
(
u£r
, 
·sswÜd
);

123 ià(
»mÙeStÜageTy³
 =ğ
nuÎ
) {

124 
throw
 
Ãw
 
	`DBExû±iÚ
(

127 + 
STORAGE_TYPE_PROPERTY
);

130 ià(
Ãwdb
) {

131 ià(
£rv”
.
	`exi¡sD©aba£
()) {

132 
LOG
.
	`šfo
("OrientDB drop‡nd„ecreate fresh db");

134 
£rv”
.
	`drİD©aba£
(
»mÙeStÜageTy³
);

137 
£rv”
.
	`ü—‹D©aba£
(
db
.
	`g‘Name
(), 
ORIENTDB_DOCUMENT_TYPE
, 
»mÙeStÜageTy³
);

139 ià(!
£rv”
.
	`exi¡sD©aba£
()) {

141 
LOG
.
	`šfo
("OrientDB database‚ot found, creating fresh db");

142 
£rv”
.
	`ü—‹D©aba£
(£rv”.
	`g‘URL
(), 
ORIENTDB_DOCUMENT_TYPE
, 
»mÙeStÜageTy³
);

146 
£rv”
.
	`şo£
();

149 
dbChecked
 = 
Œue
;

152 ià(
db
.
	`isClo£d
()) {

153 
db
.
	`İ’
(
u£r
, 
·sswÜd
);

156 ià(!
db
.
	`g‘M‘ad©a
().
	`g‘Schema
().
	`exi¡sCÏss
(
CLASS
)) {

157 
db
.
	`g‘M‘ad©a
().
	`g‘Schema
().
	`ü—‹CÏss
(
CLASS
);

160 
db
.
	`şo£
();

162 ià(
d©aba£PoŞ
 =ğ
nuÎ
) {

163 
d©aba£PoŞ
 = 
Ãw
 
	`OP¬t™iÚedD©aba£PoŞ
(
u¾
, 
u£r
, 
·sswÜd
);

166 
š™Ÿlized
 = 
Œue
;

168 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

169 
LOG
.
	`”rÜ
("Could‚Ù in™ŸlizOr›ÁDB cÚÃùiÚ…oŞ fÜ Lßd”: " + 
e
.
	`toSŒšg
());

170 
e
.
	`´štSckT¿û
();

171 } 
fš®ly
 {

172 
INIT_LOCK
.
	`uÆock
();

177 
OP¬t™iÚedD©aba£PoŞ
 
	$g‘D©aba£PoŞ
() {

178  
d©aba£PoŞ
;

179 
	}
}

181 @
Ov”ride


182 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

183 
INIT_LOCK
.
	`lock
();

184 
Œy
 {

185 
ş›ÁCouÁ”
--;

186 ià(
ş›ÁCouÁ”
 == 0) {

187 
d©aba£PoŞ
.
	`şo£
();

188 
d©aba£PoŞ
 = 
nuÎ
;

189 
š™Ÿlized
 = 
çl£
;

191 } 
fš®ly
 {

192 
INIT_LOCK
.
	`uÆock
();

195 
	}
}

197 @
Ov”ride


198 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

199 
Œy
 (
OD©aba£Docum’tTx
 
db
 = 
d©aba£PoŞ
.
acquœe
()) {

200 
fš®
 
ODocum’t
 
docum’t
 = 
Ãw
 ODocum’t(
CLASS
);

202 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
).
’ŒyS‘
()) {

203 
docum’t
.
f›ld
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

206 
	gdocum’t
.
§ve
();

207 
fš®
 
	gODiùiÚ¬y
<
	gORecÜd
> 
	gdiùiÚ¬y
 = 
db
.
g‘M‘ad©a
().
g‘IndexMªag”
().
g‘DiùiÚ¬y
();

208 
	gdiùiÚ¬y
.
put
(
key
, 
docum’t
);

210  
	gStus
.
	gOK
;

211 } 
ÿtch
 (
Exû±iÚ
 
e
) {

212 
	ge
.
´štSckT¿û
();

214  
	gStus
.
	gERROR
;

217 @
Ov”ride


218 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

219 
Œue
) {

220 
	`Œy
 (
OD©aba£Docum’tTx
 
db
 = 
d©aba£PoŞ
.
	`acquœe
()) {

221 
fš®
 
ODiùiÚ¬y
<
ORecÜd
> 
diùiÚ¬y
 = 
db
.
	`g‘M‘ad©a
().
	`g‘IndexMªag”
().
	`g‘DiùiÚ¬y
();

222 
diùiÚ¬y
.
	`»move
(
key
);

223  
Stus
.
OK
;

224 } 
	`ÿtch
 (
OCÚcu¼’tModifiÿtiÚExû±iÚ
 
cme
) {

226 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

227 
e
.
	`´štSckT¿û
();

228  
Stus
.
ERROR
;

231 
	}
}

233 @
Ov”ride


234 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

235 
Œy
 (
OD©aba£Docum’tTx
 
db
 = 
d©aba£PoŞ
.
acquœe
()) {

236 
fš®
 
ODiùiÚ¬y
<
ORecÜd
> 
diùiÚ¬y
 = 
db
.
g‘M‘ad©a
().
g‘IndexMªag”
().
g‘DiùiÚ¬y
();

237 
fš®
 
ODocum’t
 
	gdocum’t
 = 
diùiÚ¬y
.
g‘
(
key
);

238 ià(
	gdocum’t
 !ğ
nuÎ
) {

239 ià(
f›lds
 !ğ
nuÎ
) {

240 
SŒšg
 
f›ld
 : 
f›lds
) {

241 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
docum’t
.field(field)));

244 
SŒšg
 
	gf›ld
 : 
docum’t
.
f›ldNames
()) {

245 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
docum’t
.field(field)));

248  
	gStus
.
	gOK
;

250 } 
ÿtch
 (
Exû±iÚ
 
e
) {

251 
	ge
.
´štSckT¿û
();

253  
	gStus
.
	gERROR
;

256 @
Ov”ride


257 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

258 
	gŒue
) {

259 
Œy
 (
OD©aba£Docum’tTx
 
db
 = 
d©aba£PoŞ
.
acquœe
()) {

260 
fš®
 
ODiùiÚ¬y
<
ORecÜd
> 
diùiÚ¬y
 = 
db
.
g‘M‘ad©a
().
g‘IndexMªag”
().
g‘DiùiÚ¬y
();

261 
fš®
 
ODocum’t
 
	gdocum’t
 = 
diùiÚ¬y
.
g‘
(
key
);

262 ià(
	gdocum’t
 !ğ
nuÎ
) {

263 
M­
.
EÁry
<
SŒšg
, SŒšg> 
’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
).
’ŒyS‘
()) {

264 
docum’t
.
f›ld
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

267 
	gdocum’t
.
§ve
();

268  
	gStus
.
	gOK
;

270 } 
ÿtch
 (
OCÚcu¼’tModifiÿtiÚExû±iÚ
 
cme
) {

272 } 
ÿtch
 (
Exû±iÚ
 
e
) {

273 
	ge
.
´štSckT¿û
();

274  
	gStus
.
	gERROR
;

279 @
Ov”ride


280 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

281 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

283 ià(
	gisRemÙe
) {

285 
	gLOG
.
w¬n
("OrientDB scan operation is‚ot implemented for„emote database connections.");

286  
	gStus
.
	gNOT_IMPLEMENTED
;

289 
Œy
 (
OD©aba£Docum’tTx
 
db
 = 
d©aba£PoŞ
.
acquœe
()) {

290 
fš®
 
ODiùiÚ¬y
<
ORecÜd
> 
diùiÚ¬y
 = 
db
.
g‘M‘ad©a
().
g‘IndexMªag”
().
g‘DiùiÚ¬y
();

291 
fš®
 
OIndexCursÜ
 
	g’Œ›s
 = 
diùiÚ¬y
.
g‘Index
().
™”©eEÁr›sMajÜ
(
¡¬tkey
, 
Œue
,rue);

293 
	gcu¼’tCouÁ
 = 0;

294 
	g’Œ›s
.
hasNext
()) {

295 
fš®
 
ODocum’t
 
	gdocum’t
 = 
’Œ›s
.
Ãxt
().
g‘RecÜd
();

297 
fš®
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gm­
 = 
Ãw
 
HashM­
<>();

298 
	g»suÉ
.
add
(
m­
);

300 ià(
	gf›lds
 !ğ
nuÎ
) {

301 
SŒšg
 
f›ld
 : 
f›lds
) {

302 
m­
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
docum’t
.field(field)));

305 
SŒšg
 
	gf›ld
 : 
docum’t
.
f›ldNames
()) {

306 
m­
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
SŒšg
è
docum’t
.field(field)));

310 
	gcu¼’tCouÁ
++;

312 ià(
	gcu¼’tCouÁ
 >ğ
»cÜdcouÁ
) {

317  
	gStus
.
	gOK
;

318 } 
ÿtch
 (
Exû±iÚ
 
e
) {

319 
	ge
.
´štSckT¿û
();

321  
	gStus
.
	gERROR
;

	@orientdb/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@orientdb/src/test/java/site/ycsb/db/OrientDBClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	gdb
.
	gOP¬t™iÚedD©aba£PoŞ
;

21 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	gdb
.
	gdocum’t
.
	gOD©aba£Docum’tTx
;

22 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	gdiùiÚ¬y
.
	gODiùiÚ¬y
;

23 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	g»cÜd
.
	gORecÜd
;

24 
impÜt
 
	gcom
.
	gÜ›ÁechnŞog›s
.
	gÜ›Á
.
	gcÜe
.
	g»cÜd
.
	gim¶
.
	gODocum’t
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

29 
impÜt
 
	gÜg
.
	gjun™
.*;

31 
impÜt
 
	gjava
.
	gut
.*;

33 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.*;

38 
public
 cÏs 
	cOr›ÁDBCl›ÁTe¡
 {

40 
´iv©e
 
fš®
 
SŒšg
 
	mCLASS
 = "usertable";

41 
´iv©e
 
fš®
 
	mFIELD_LENGTH
 = 32;

42 
´iv©e
 
fš®
 
SŒšg
 
	mFIELD_PREFIX
 = "FIELD";

43 
´iv©e
 
fš®
 
SŒšg
 
	mKEY_PREFIX
 = "user";

44 
´iv©e
 
fš®
 
	mNUM_FIELDS
 = 3;

45 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_DB_URL
 = "memory:test";

47 
´iv©e
 
Or›ÁDBCl›Á
 
	mÜ›ÁDBCl›Á
 = 
nuÎ
;

49 @
BefÜe


50 
public
 
	$£tup
(è
throws
 
DBExû±iÚ
 {

51 
Ü›ÁDBCl›Á
 = 
Ãw
 
	`Or›ÁDBCl›Á
();

53 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

55 
p
.
	`£tPrİ”ty
("Ü›Ádb.u¾", 
TEST_DB_URL
);

57 
Ü›ÁDBCl›Á
.
	`£tPrİ”t›s
(
p
);

58 
Ü›ÁDBCl›Á
.
	`š™
();

61 @
Aá”


62 
public
 
	$‹¬down
(è
throws
 
DBExû±iÚ
 {

63 ià(
Ü›ÁDBCl›Á
 !ğ
nuÎ
) {

64 
Ü›ÁDBCl›Á
.
	`ş—nup
();

66 
	}
}

72 
´iv©e
 
SŒšg
 
	$budD‘”mši¡icV®ue
(
SŒšg
 
key
, SŒšg 
f›ldkey
) {

73 
size
 = 
FIELD_LENGTH
;

74 
SŒšgBud”
 
sb
 = 
Ãw
 
	`SŒšgBud”
(
size
);

75 
sb
.
	`­³nd
(
key
);

76 
sb
.
	`­³nd
(':');

77 
sb
.
	`­³nd
(
f›ldkey
);

78 
sb
.
	`Ëngth
(è< 
size
) {

79 
sb
.
	`­³nd
(':');

80 
sb
.
	`­³nd
(sb.
	`toSŒšg
().
	`hashCode
());

82 
sb
.
	`£tL’gth
(
size
);

84  
sb
.
	`toSŒšg
();

85 
	}
}

90 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	$š£¹Row
(
SŒšg
 
š£¹Key
) {

91 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
Ãw
 HashMap<>();

92 
i
 = 0; i < 3; i++) {

93 
š£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
š£¹Key
, FIELD_PREFIX + i)));

95 
Ü›ÁDBCl›Á
.
	`š£¹
(
CLASS
, 
š£¹Key
, 
š£¹M­
);

97  
š£¹M­
;

98 
	}
}

100 @
Te¡


101 
public
 
	$š£¹Te¡
() {

102 
SŒšg
 
š£¹Key
 = "user0";

103 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
	`š£¹Row
(
š£¹Key
);

105 
OP¬t™iÚedD©aba£PoŞ
 
poŞ
 = 
Ü›ÁDBCl›Á
.
	`g‘D©aba£PoŞ
();

106 
	`Œy
(
OD©aba£Docum’tTx
 
db
 = 
poŞ
.
	`acquœe
()) {

107 
ODiùiÚ¬y
<
ORecÜd
> 
diùiÚ¬y
 = 
db
.
	`g‘DiùiÚ¬y
();

108 
ODocum’t
 
»suÉ
 = 
diùiÚ¬y
.
	`g‘
(
š£¹Key
);

110 
	`as£¹True
("As£¹‡„ow wa š£¹ed.", 
»suÉ
 !ğ
nuÎ
);

112 
i
 = 0; i < 
NUM_FIELDS
; i++) {

113 
	`as£¹Equ®s
("As£¹‡Î in£¹ed cŞumn havcÜ»ù v®ues.", 
»suÉ
.
	`f›ld
(
FIELD_PREFIX
 + 
i
),

114 
š£¹M­
.
	`g‘
(
FIELD_PREFIX
 + 
i
).
	`toSŒšg
());

117 
	}
}

119 @
Te¡


120 
public
 
	$upd©eTe¡
() {

121 
SŒšg
 
´eupd©eSŒšg
 = "preupdate";

122 
SŒšg
 
u£r0
 = "user0";

123 
SŒšg
 
u£r1
 = "user1";

124 
SŒšg
 
u£r2
 = "user2";

126 
OP¬t™iÚedD©aba£PoŞ
 
poŞ
 = 
Ü›ÁDBCl›Á
.
	`g‘D©aba£PoŞ
();

127 
	`Œy
(
OD©aba£Docum’tTx
 
db
 = 
poŞ
.
	`acquœe
()) {

129 
SŒšg
 
key
 : 
A¼ays
.
	`asLi¡
(
u£r0
, 
u£r1
, 
u£r2
)) {

130 
ODocum’t
 
doc
 = 
Ãw
 
	`ODocum’t
(
CLASS
);

131 
i
 = 0; i < 
NUM_FIELDS
; i++) {

132 
doc
.
	`f›ld
(
FIELD_PREFIX
 + 
i
, 
´eupd©eSŒšg
);

134 
doc
.
	`§ve
();

136 
ODiùiÚ¬y
<
ORecÜd
> 
diùiÚ¬y
 = 
db
.
	`g‘DiùiÚ¬y
();

137 
diùiÚ¬y
.
	`put
(
key
, 
doc
);

141 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
upd©eM­
 = 
Ãw
 HashMap<>();

142 
i
 = 0; i < 
NUM_FIELDS
; i++) {

143 
upd©eM­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
u£r1
, FIELD_PREFIX + i)));

146 
Ü›ÁDBCl›Á
.
	`upd©e
(
CLASS
, 
u£r1
, 
upd©eM­
);

148 
	`Œy
(
OD©aba£Docum’tTx
 
db
 = 
poŞ
.
	`acquœe
()) {

149 
ODiùiÚ¬y
<
ORecÜd
> 
diùiÚ¬y
 = 
db
.
	`g‘DiùiÚ¬y
();

151 
ODocum’t
 
»suÉ
 = 
diùiÚ¬y
.
	`g‘
(
u£r0
);

152 
i
 = 0; i < 
NUM_FIELDS
; i++) {

153 
	`as£¹Equ®s
("As£¹ fœ¡„ow f›ld cÚš…»upd©eSŒšg", 
»suÉ
.
	`f›ld
(
FIELD_PREFIX
 + 
i
), 
´eupd©eSŒšg
);

157 
»suÉ
 = 
diùiÚ¬y
.
	`g‘
(
u£r1
);

158 
i
 = 0; i < 
NUM_FIELDS
; i++) {

159 
	`as£¹Equ®s
("As£¹ upd©ed„ow f›ld ¬cÜ»ù", 
»suÉ
.
	`f›ld
(
FIELD_PREFIX
 + 
i
),

160 
upd©eM­
.
	`g‘
(
FIELD_PREFIX
 + 
i
).
	`toSŒšg
());

164 
»suÉ
 = 
diùiÚ¬y
.
	`g‘
(
u£r2
);

165 
i
 = 0; i < 
NUM_FIELDS
; i++) {

166 
	`as£¹Equ®s
("As£¹hœd„ow f›ld cÚš…»upd©eSŒšg", 
»suÉ
.
	`f›ld
(
FIELD_PREFIX
 + 
i
), 
´eupd©eSŒšg
);

169 
	}
}

171 @
Te¡


172 
public
 
	$»adTe¡
() {

173 
SŒšg
 
š£¹Key
 = "user0";

174 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
	`š£¹Row
(
š£¹Key
);

175 
HashS‘
<
SŒšg
> 
»adF›lds
 = 
Ãw
 HashSet<>();

176 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adResuÉM­
 = 
Ãw
 HashMap<>();

179 
»adF›lds
.
	`add
("FIELD0");

180 
Ü›ÁDBCl›Á
.
	`»ad
(
CLASS
, 
š£¹Key
, 
»adF›lds
, 
»adResuÉM­
);

181 
	`as£¹Equ®s
("As£¹h©„esuÉ ha cÜ»ù‚umb” oàf›lds", 
»adF›lds
.
	`size
(), 
»adResuÉM­
.size());

182 
SŒšg
 
f›ld
 : 
»adF›lds
) {

183 
	`as£¹Equ®s
("As£¹ " + 
f›ld
 + " wa »ad cÜ»ùly", 
š£¹M­
.
	`g‘
(f›ld).
	`toSŒšg
(), 
»adResuÉM­
.get(field).toString());

186 
»adResuÉM­
 = 
Ãw
 
HashM­
<>();

189 
»adF›lds
.
	`add
("FIELD1");

190 
»adF›lds
.
	`add
("FIELD2");

191 
Ü›ÁDBCl›Á
.
	`»ad
(
CLASS
, 
š£¹Key
, 
»adF›lds
, 
»adResuÉM­
);

192 
	`as£¹Equ®s
("As£¹h©„esuÉ ha cÜ»ù‚umb” oàf›lds", 
»adF›lds
.
	`size
(), 
»adResuÉM­
.size());

193 
SŒšg
 
f›ld
 : 
»adF›lds
) {

194 
	`as£¹Equ®s
("As£¹ " + 
f›ld
 + " wa »ad cÜ»ùly", 
š£¹M­
.
	`g‘
(f›ld).
	`toSŒšg
(), 
»adResuÉM­
.get(field).toString());

196 
	}
}

198 @
Te¡


199 
public
 
	$d–‘eTe¡
() {

200 
SŒšg
 
u£r0
 = "user0";

201 
SŒšg
 
u£r1
 = "user1";

202 
SŒšg
 
u£r2
 = "user2";

204 
	`š£¹Row
(
u£r0
);

205 
	`š£¹Row
(
u£r1
);

206 
	`š£¹Row
(
u£r2
);

208 
Ü›ÁDBCl›Á
.
	`d–‘e
(
CLASS
, 
u£r1
);

210 
OP¬t™iÚedD©aba£PoŞ
 
poŞ
 = 
Ü›ÁDBCl›Á
.
	`g‘D©aba£PoŞ
();

211 
	`Œy
(
OD©aba£Docum’tTx
 
db
 = 
poŞ
.
	`acquœe
()) {

212 
ODiùiÚ¬y
<
ORecÜd
> 
diùiÚ¬y
 = 
db
.
	`g‘DiùiÚ¬y
();

214 
	`as£¹NÙNuÎ
("As£¹ u£r0 stÈexi¡s", 
diùiÚ¬y
.
	`g‘
(
u£r0
));

215 
	`as£¹NuÎ
("As£¹ u£r1 dÛ nÙƒxi¡", 
diùiÚ¬y
.
	`g‘
(
u£r1
));

216 
	`as£¹NÙNuÎ
("As£¹ u£r2 stÈexi¡s", 
diùiÚ¬y
.
	`g‘
(
u£r2
));

218 
	}
}

220 @
Te¡


221 
public
 
	$sÿnTe¡
() {

222 
M­
<
SŒšg
, M­<SŒšg, 
By‹I‹¿tÜ
>> 
keyM­
 = 
Ãw
 
HashM­
<>();

223 
i
 = 0; i < 5; i++) {

224 
SŒšg
 
š£¹Key
 = 
KEY_PREFIX
 + 
i
;

225 
keyM­
.
	`put
(
š£¹Key
, 
	`š£¹Row
(insertKey));

228 
S‘
<
SŒšg
> 
f›ldS‘
 = 
Ãw
 
HashS‘
<>();

229 
f›ldS‘
.
	`add
("FIELD0");

230 
f›ldS‘
.
	`add
("FIELD1");

231 
¡¬tIndex
 = 0;

232 
»suÉRows
 = 3;

234 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉVeùÜ
 = 
Ãw
 Vector<>();

235 
Ü›ÁDBCl›Á
.
	`sÿn
(
CLASS
, 
KEY_PREFIX
 + 
¡¬tIndex
, 
»suÉRows
, 
f›ldS‘
, 
»suÉVeùÜ
);

238 
	`as£¹Equ®s
("As£¹hcÜ»ù‚umb” oà»suÉ row w”»tuºed", 
»suÉRows
, 
»suÉVeùÜ
.
	`size
());

240 
‹¡Index
 = 
¡¬tIndex
;

243 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 : 
»suÉVeùÜ
) {

244 
	`as£¹Equ®s
("As£¹h©hi row ha thcÜ»ù‚umb” oàf›lds", 
f›ldS‘
.
	`size
(), 
»suÉ
.size());

245 
SŒšg
 
f›ld
 : 
f›ldS‘
) {

246 
	`as£¹Equ®s
("As£¹hi f›ld i cÜ»ù iÀthi row", 
keyM­
.
	`g‘
(
KEY_PREFIX
 + 
‹¡Index
).g‘(
f›ld
).
	`toSŒšg
(),

247 
»suÉ
.
	`g‘
(
f›ld
).
	`toSŒšg
());

249 
‹¡Index
++;

251 
	}
}

	@postgrenosql/src/main/java/site/ycsb/postgrenosql/PostgreNoSQLDBClient.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gpo¡g»nosql
;

21 
impÜt
 
	gs™e
.
	gycsb
.*;

22 
impÜt
 
	gÜg
.
	gjsÚ
.
	gsim¶e
.
	gJSONObjeù
;

23 
impÜt
 
	gÜg
.
	gpo¡g»sql
.
	gDriv”
;

24 
impÜt
 
	gÜg
.
	gpo¡g»sql
.
	gut
.
	gPGobjeù
;

26 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

27 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

33 
impÜt
 
	gjava
.
	gsql
.
	gCÚÃùiÚ
;

34 
impÜt
 
	gjava
.
	gsql
.
	gP»·»dS‹m’t
;

35 
impÜt
 
	gjava
.
	gsql
.
	gResuÉS‘
;

36 
impÜt
 
	gjava
.
	gsql
.
	gSQLExû±iÚ
;

37 
impÜt
 
	gjava
.
	gut
.*;

42 
public
 cÏs 
	cPo¡g»NoSQLDBCl›Á
 
ex‹nds
 
	mDB
 {

43 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = 
Logg”FaùÜy
.
g‘Logg”
(
Po¡g»NoSQLDBCl›Á
.
şass
);

46 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	mINIT_COUNT
 = 
Ãw
 AtomicInteger(0);

49 
´iv©e
 
	mCÚcu¼’tM­
<
	mS‹m’tTy³
, 
	mP»·»dS‹m’t
> 
	mÿchedS‹m’ts
;

52 
´iv©e
 
Driv”
 
	mpo¡g»nosqlDriv”
;

55 
´iv©e
 
CÚÃùiÚ
 
	mcÚÃùiÚ
;

58 
public
 
fš®
 
SŒšg
 
	mDRIVER_CLASS
 = "db.driver";

61 
public
 
fš®
 
SŒšg
 
	mCONNECTION_URL
 = "postgrenosql.url";

64 
public
 
fš®
 
SŒšg
 
	mCONNECTION_USER
 = "postgrenosql.user";

67 
public
 
fš®
 
SŒšg
 
	mCONNECTION_PASSWD
 = "postgrenosql.passwd";

70 
public
 
fš®
 
SŒšg
 
	mJDBC_AUTO_COMMIT
 = "postgrenosql.autocommit";

73 
public
 
fš®
 
SŒšg
 
	mPRIMARY_KEY
 = "YCSB_KEY";

76 
public
 
fš®
 
SŒšg
 
	mCOLUMN_NAME
 = "YCSB_VALUE";

78 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_PROP
 = "";

81 
´iv©e
 
boŞ—n
 
	$g‘BoŞPrİ”ty
(
Prİ”t›s
 
´İs
, 
SŒšg
 
key
, 
boŞ—n
 
deçuÉV®
) {

82 
SŒšg
 
v®ueSŒ
 = 
´İs
.
	`g‘Prİ”ty
(
key
);

83 ià(
v®ueSŒ
 !ğ
nuÎ
) {

84  
BoŞ—n
.
	`·r£BoŞ—n
(
v®ueSŒ
);

86  
deçuÉV®
;

89 @
Ov”ride


90 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

91 
INIT_COUNT
.
	`šüem’tAndG‘
();

92 
	`synchrÚized
 (
Po¡g»NoSQLDBCl›Á
.
şass
) {

93 ià(
po¡g»nosqlDriv”
 !ğ
nuÎ
) {

97 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

98 
SŒšg
 
u¾s
 = 
´İs
.
	`g‘Prİ”ty
(
CONNECTION_URL
, 
DEFAULT_PROP
);

99 
SŒšg
 
u£r
 = 
´İs
.
	`g‘Prİ”ty
(
CONNECTION_USER
, 
DEFAULT_PROP
);

100 
SŒšg
 
·sswd
 = 
´İs
.
	`g‘Prİ”ty
(
CONNECTION_PASSWD
, 
DEFAULT_PROP
);

101 
boŞ—n
 
autoComm™
 = 
	`g‘BoŞPrİ”ty
(
´İs
, 
JDBC_AUTO_COMMIT
, 
Œue
);

103 
Œy
 {

104 
Prİ”t›s
 
tmpPrİs
 = 
Ãw
 
	`Prİ”t›s
();

105 
tmpPrİs
.
	`£tPrİ”ty
("u£r", 
u£r
);

106 
tmpPrİs
.
	`£tPrİ”ty
("·sswÜd", 
·sswd
);

108 
ÿchedS‹m’ts
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

110 
po¡g»nosqlDriv”
 = 
Ãw
 
	`Driv”
();

111 
cÚÃùiÚ
 = 
po¡g»nosqlDriv”
.
	`cÚÃù
(
u¾s
, 
tmpPrİs
);

112 
cÚÃùiÚ
.
	`£tAutoComm™
(
autoComm™
);

114 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

115 
LOG
.
	`”rÜ
("E¼Ü duršg in™Ÿliz©iÚ: " + 
e
);

118 
	}
}

120 @
Ov”ride


121 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

122 ià(
INIT_COUNT
.
	`deüem’tAndG‘
() == 0) {

123 
Œy
 {

124 
ÿchedS‹m’ts
.
	`ş—r
();

126 ià(!
cÚÃùiÚ
.
	`g‘AutoComm™
()){

127 
cÚÃùiÚ
.
	`comm™
();

129 
cÚÃùiÚ
.
	`şo£
();

130 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

131 
Sy¡em
.
”r
.
	`´šn
("E¼Ü iÀş—nu°executiÚ. " + 
e
);

133 
po¡g»nosqlDriv”
 = 
nuÎ
;

135 
	}
}

137 @
Ov”ride


138 
public
 
Stus
 
»ad
(
SŒšg
 
bËName
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

139 
	gŒy
 {

140 
S‹m’tTy³
 
	gty³
 = 
Ãw
 S‹m’tTy³(S‹m’tTy³.
Ty³
.
READ
, 
bËName
, 
f›lds
);

141 
P»·»dS‹m’t
 
	g»adS‹m’t
 = 
ÿchedS‹m’ts
.
g‘
(
ty³
);

142 ià(
	g»adS‹m’t
 =ğ
nuÎ
) {

143 
»adS‹m’t
 = 
ü—‹AndCacheR—dS‹m’t
(
ty³
);

145 
	g»adS‹m’t
.
£tSŒšg
(1, 
key
);

146 
ResuÉS‘
 
	g»suÉS‘
 = 
»adS‹m’t
.
execu‹Qu”y
();

147 ià(!
	g»suÉS‘
.
Ãxt
()) {

148 
	g»suÉS‘
.
şo£
();

149  
	gStus
.
	gNOT_FOUND
;

152 ià(
	g»suÉ
 !ğ
nuÎ
) {

153 ià(
f›lds
 =ğ
nuÎ
){

155 
SŒšg
 
f›ld
 = 
»suÉS‘
.
g‘SŒšg
(2);

156 
SŒšg
 
	gv®ue
 = 
»suÉS‘
.
g‘SŒšg
(3);

157 
	g»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
));

158 }
	g»suÉS‘
.
Ãxt
());

160 
SŒšg
 
	gf›ld
 : 
f›lds
) {

161 
SŒšg
 
v®ue
 = 
»suÉS‘
.
g‘SŒšg
(
f›ld
);

162 
	g»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
));

166 
	g»suÉS‘
.
şo£
();

167  
	gStus
.
	gOK
;

169 } 
ÿtch
 (
SQLExû±iÚ
 
e
) {

170 
	gLOG
.
”rÜ
("E¼Ü iÀ´oûssšg„—d oàbË " + 
bËName
 + ": " + 
e
);

171  
	gStus
.
	gERROR
;

175 @
Ov”ride


176 
public
 
Stus
 
sÿn
(
SŒšg
 
bËName
, SŒšg 
¡¬tKey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

177 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

178 
	gŒy
 {

179 
S‹m’tTy³
 
	gty³
 = 
Ãw
 S‹m’tTy³(S‹m’tTy³.
Ty³
.
SCAN
, 
bËName
, 
f›lds
);

180 
P»·»dS‹m’t
 
	gsÿnS‹m’t
 = 
ÿchedS‹m’ts
.
g‘
(
ty³
);

181 ià(
	gsÿnS‹m’t
 =ğ
nuÎ
) {

182 
sÿnS‹m’t
 = 
ü—‹AndCacheSÿnS‹m’t
(
ty³
);

184 
	gsÿnS‹m’t
.
£tSŒšg
(1, 
¡¬tKey
);

185 
	gsÿnS‹m’t
.
£tIÁ
(2, 
»cÜdcouÁ
);

186 
ResuÉS‘
 
	g»suÉS‘
 = 
sÿnS‹m’t
.
execu‹Qu”y
();

187 
	gi
 = 0; i < 
	g»cÜdcouÁ
 && 
	g»suÉS‘
.
Ãxt
(); i++) {

188 ià(
	g»suÉ
 !ğ
nuÎ
 && 
f›lds
 !=‚ull) {

189 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashM­<SŒšg, 
	gBy‹I‹¿tÜ
>();

190 
SŒšg
 
	gf›ld
 : 
f›lds
) {

191 
SŒšg
 
v®ue
 = 
»suÉS‘
.
g‘SŒšg
(
f›ld
);

192 
	gv®ues
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
));

195 
	g»suÉ
.
add
(
v®ues
);

199 
	g»suÉS‘
.
şo£
();

200  
	gStus
.
	gOK
;

201 } 
ÿtch
 (
SQLExû±iÚ
 
e
) {

202 
	gLOG
.
”rÜ
("E¼Ü iÀ´oûssšg sÿÀoàbË: " + 
bËName
 + ": " + 
e
);

203  
	gStus
.
	gERROR
;

207 @
Ov”ride


208 
public
 
Stus
 
upd©e
(
SŒšg
 
bËName
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

209 
	gŒy
{

210 
S‹m’tTy³
 
	gty³
 = 
Ãw
 S‹m’tTy³(S‹m’tTy³.
Ty³
.
UPDATE
, 
bËName
, 
nuÎ
);

211 
P»·»dS‹m’t
 
	gupd©eS‹m’t
 = 
ÿchedS‹m’ts
.
g‘
(
ty³
);

212 ià(
	gupd©eS‹m’t
 =ğ
nuÎ
) {

213 
upd©eS‹m’t
 = 
ü—‹AndCacheUpd©eS‹m’t
(
ty³
);

216 
JSONObjeù
 
	gjsÚObjeù
 = 
Ãw
 JSONObject();

217 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

218 
jsÚObjeù
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

221 
PGobjeù
 
	gobjeù
 = 
Ãw
 PGobject();

222 
	gobjeù
.
£tTy³
("jsonb");

223 
	gobjeù
.
£tV®ue
(
jsÚObjeù
.
toJSONSŒšg
());

225 
	gupd©eS‹m’t
.
£tObjeù
(1, 
objeù
);

226 
	gupd©eS‹m’t
.
£tSŒšg
(2, 
key
);

228 
	g»suÉ
 = 
upd©eS‹m’t
.
execu‹Upd©e
();

229 ià(
	g»suÉ
 == 1) {

230  
Stus
.
OK
;

232  
	gStus
.
	gUNEXPECTED_STATE
;

233 } 
ÿtch
 (
SQLExû±iÚ
 
e
) {

234 
	gLOG
.
”rÜ
("E¼Ü iÀ´oûssšg upd©tØbË: " + 
bËName
 + 
e
);

235  
	gStus
.
	gERROR
;

239 @
Ov”ride


240 
public
 
Stus
 
š£¹
(
SŒšg
 
bËName
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

241 
	gŒy
{

242 
S‹m’tTy³
 
	gty³
 = 
Ãw
 S‹m’tTy³(S‹m’tTy³.
Ty³
.
INSERT
, 
bËName
, 
nuÎ
);

243 
P»·»dS‹m’t
 
	gš£¹S‹m’t
 = 
ÿchedS‹m’ts
.
g‘
(
ty³
);

244 ià(
	gš£¹S‹m’t
 =ğ
nuÎ
) {

245 
š£¹S‹m’t
 = 
ü—‹AndCacheIn£¹S‹m’t
(
ty³
);

248 
JSONObjeù
 
	gjsÚObjeù
 = 
Ãw
 JSONObject();

249 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

250 
jsÚObjeù
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

253 
PGobjeù
 
	gobjeù
 = 
Ãw
 PGobject();

254 
	gobjeù
.
£tTy³
("jsonb");

255 
	gobjeù
.
£tV®ue
(
jsÚObjeù
.
toJSONSŒšg
());

257 
	gš£¹S‹m’t
.
£tObjeù
(2, 
objeù
);

258 
	gš£¹S‹m’t
.
£tSŒšg
(1, 
key
);

260 
	g»suÉ
 = 
š£¹S‹m’t
.
execu‹Upd©e
();

261 ià(
	g»suÉ
 == 1) {

262  
Stus
.
OK
;

265  
	gStus
.
	gUNEXPECTED_STATE
;

266 } 
ÿtch
 (
SQLExû±iÚ
 
e
) {

267 
	gLOG
.
”rÜ
("E¼Ü iÀ´oûssšg in£¹ØbË: " + 
bËName
 + ": " + 
e
);

268  
	gStus
.
	gERROR
;

272 @
Ov”ride


273 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bËName
, SŒšg 
key
) {

274 
Œy
{

275 
S‹m’tTy³
 
ty³
 = 
Ãw
 
	`S‹m’tTy³
(S‹m’tTy³.
Ty³
.
DELETE
, 
bËName
, 
nuÎ
);

276 
P»·»dS‹m’t
 
d–‘eS‹m’t
 = 
ÿchedS‹m’ts
.
	`g‘
(
ty³
);

277 ià(
d–‘eS‹m’t
 =ğ
nuÎ
) {

278 
d–‘eS‹m’t
 = 
	`ü—‹AndCacheD–‘eS‹m’t
(
ty³
);

280 
d–‘eS‹m’t
.
	`£tSŒšg
(1, 
key
);

282 
»suÉ
 = 
d–‘eS‹m’t
.
	`execu‹Upd©e
();

283 ià(
»suÉ
 == 1){

284  
Stus
.
OK
;

287  
Stus
.
UNEXPECTED_STATE
;

288 } 
	`ÿtch
 (
SQLExû±iÚ
 
e
) {

289 
LOG
.
	`”rÜ
("E¼Ü iÀ´oûssšg d–‘tØbË: " + 
bËName
 + 
e
);

290  
Stus
.
ERROR
;

292 
	}
}

294 
´iv©e
 
P»·»dS‹m’t
 
	$ü—‹AndCacheR—dS‹m’t
(
S‹m’tTy³
 
»adTy³
)

295 
throws
 
SQLExû±iÚ
{

296 
P»·»dS‹m’t
 
»adS‹m’t
 = 
cÚÃùiÚ
.
	`´•¬eS‹m’t
(
	`ü—‹R—dS‹m’t
(
»adTy³
));

297 
P»·»dS‹m’t
 
¡©em’t
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
»adTy³
, 
»adS‹m’t
);

298 ià(
¡©em’t
 =ğ
nuÎ
) {

299  
»adS‹m’t
;

301  
¡©em’t
;

302 
	}
}

304 
´iv©e
 
SŒšg
 
	$ü—‹R—dS‹m’t
(
S‹m’tTy³
 
»adTy³
){

305 
SŒšgBud”
 
»ad
 = 
Ãw
 
	`SŒšgBud”
("SELECT " + 
PRIMARY_KEY
 + " AS " + PRIMARY_KEY);

307 ià(
»adTy³
.
	`g‘F›lds
(è=ğ
nuÎ
) {

308 
»ad
.
	`­³nd
(", (jsÚb_—ch_‹xt(" + 
COLUMN_NAME
 + ")).*");

310 
SŒšg
 
f›ld
:
»adTy³
.
	`g‘F›lds
()){

311 
»ad
.
	`­³nd
(", " + 
COLUMN_NAME
 + "->>'" + 
f›ld
 + "' AS " + field);

315 
»ad
.
	`­³nd
(" FROM " + 
»adTy³
.
	`g‘TabËName
());

316 
»ad
.
	`­³nd
(" WHERE ");

317 
»ad
.
	`­³nd
(
PRIMARY_KEY
);

318 
»ad
.
	`­³nd
(" = ");

319 
»ad
.
	`­³nd
("?");

320  
»ad
.
	`toSŒšg
();

321 
	}
}

323 
´iv©e
 
P»·»dS‹m’t
 
	$ü—‹AndCacheSÿnS‹m’t
(
S‹m’tTy³
 
sÿnTy³
)

324 
throws
 
SQLExû±iÚ
{

325 
P»·»dS‹m’t
 
sÿnS‹m’t
 = 
cÚÃùiÚ
.
	`´•¬eS‹m’t
(
	`ü—‹SÿnS‹m’t
(
sÿnTy³
));

326 
P»·»dS‹m’t
 
¡©em’t
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
sÿnTy³
, 
sÿnS‹m’t
);

327 ià(
¡©em’t
 =ğ
nuÎ
) {

328  
sÿnS‹m’t
;

330  
¡©em’t
;

331 
	}
}

333 
´iv©e
 
SŒšg
 
	$ü—‹SÿnS‹m’t
(
S‹m’tTy³
 
sÿnTy³
){

334 
SŒšgBud”
 
sÿn
 = 
Ãw
 
	`SŒšgBud”
("SELECT " + 
PRIMARY_KEY
 + " AS " + PRIMARY_KEY);

335 ià(
sÿnTy³
.
	`g‘F›lds
(è!ğ
nuÎ
){

336 
SŒšg
 
f›ld
:
sÿnTy³
.
	`g‘F›lds
()){

337 
sÿn
.
	`­³nd
(", " + 
COLUMN_NAME
 + "->>'" + 
f›ld
 + "' AS " + field);

340 
sÿn
.
	`­³nd
(" FROM " + 
sÿnTy³
.
	`g‘TabËName
());

341 
sÿn
.
	`­³nd
(" WHERE ");

342 
sÿn
.
	`­³nd
(
PRIMARY_KEY
);

343 
sÿn
.
	`­³nd
(" >= ?");

344 
sÿn
.
	`­³nd
(" ORDER BY ");

345 
sÿn
.
	`­³nd
(
PRIMARY_KEY
);

346 
sÿn
.
	`­³nd
(" LIMIT ?");

348  
sÿn
.
	`toSŒšg
();

349 
	}
}

351 
public
 
P»·»dS‹m’t
 
	$ü—‹AndCacheUpd©eS‹m’t
(
S‹m’tTy³
 
upd©eTy³
)

352 
throws
 
SQLExû±iÚ
{

353 
P»·»dS‹m’t
 
upd©eS‹m’t
 = 
cÚÃùiÚ
.
	`´•¬eS‹m’t
(
	`ü—‹Upd©eS‹m’t
(
upd©eTy³
));

354 
P»·»dS‹m’t
 
¡©em’t
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
upd©eTy³
, 
upd©eS‹m’t
);

355 ià(
¡©em’t
 =ğ
nuÎ
) {

356  
upd©eS‹m’t
;

358  
¡©em’t
;

359 
	}
}

361 
´iv©e
 
SŒšg
 
	$ü—‹Upd©eS‹m’t
(
S‹m’tTy³
 
upd©eTy³
){

362 
SŒšgBud”
 
upd©e
 = 
Ãw
 
	`SŒšgBud”
("UPDATE ");

363 
upd©e
.
	`­³nd
(
upd©eTy³
.
	`g‘TabËName
());

364 
upd©e
.
	`­³nd
(" SET ");

365 
upd©e
.
	`­³nd
(
COLUMN_NAME
 + " = " + COLUMN_NAME);

366 
upd©e
.
	`­³nd
(" || ? ");

367 
upd©e
.
	`­³nd
(" WHERE ");

368 
upd©e
.
	`­³nd
(
PRIMARY_KEY
);

369 
upd©e
.
	`­³nd
(" = ?");

370  
upd©e
.
	`toSŒšg
();

371 
	}
}

373 
´iv©e
 
P»·»dS‹m’t
 
	$ü—‹AndCacheIn£¹S‹m’t
(
S‹m’tTy³
 
š£¹Ty³
)

374 
throws
 
SQLExû±iÚ
{

375 
P»·»dS‹m’t
 
š£¹S‹m’t
 = 
cÚÃùiÚ
.
	`´•¬eS‹m’t
(
	`ü—‹In£¹S‹m’t
(
š£¹Ty³
));

376 
P»·»dS‹m’t
 
¡©em’t
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
š£¹Ty³
, 
š£¹S‹m’t
);

377 ià(
¡©em’t
 =ğ
nuÎ
) {

378  
š£¹S‹m’t
;

380  
¡©em’t
;

381 
	}
}

383 
´iv©e
 
SŒšg
 
	$ü—‹In£¹S‹m’t
(
S‹m’tTy³
 
š£¹Ty³
){

384 
SŒšgBud”
 
š£¹
 = 
Ãw
 
	`SŒšgBud”
("INSERT INTO ");

385 
š£¹
.
	`­³nd
(
š£¹Ty³
.
	`g‘TabËName
());

386 
š£¹
.
	`­³nd
(" (" + 
PRIMARY_KEY
 + "," + 
COLUMN_NAME
 + ")");

387 
š£¹
.
	`­³nd
(" VALUES(?,?)");

388  
š£¹
.
	`toSŒšg
();

389 
	}
}

391 
´iv©e
 
P»·»dS‹m’t
 
	$ü—‹AndCacheD–‘eS‹m’t
(
S‹m’tTy³
 
d–‘eTy³
)

392 
throws
 
SQLExû±iÚ
{

393 
P»·»dS‹m’t
 
d–‘eS‹m’t
 = 
cÚÃùiÚ
.
	`´•¬eS‹m’t
(
	`ü—‹D–‘eS‹m’t
(
d–‘eTy³
));

394 
P»·»dS‹m’t
 
¡©em’t
 = 
ÿchedS‹m’ts
.
	`putIfAb£Á
(
d–‘eTy³
, 
d–‘eS‹m’t
);

395 ià(
¡©em’t
 =ğ
nuÎ
) {

396  
d–‘eS‹m’t
;

398  
¡©em’t
;

399 
	}
}

401 
´iv©e
 
SŒšg
 
	$ü—‹D–‘eS‹m’t
(
S‹m’tTy³
 
d–‘eTy³
){

402 
SŒšgBud”
 
d–‘e
 = 
Ãw
 
	`SŒšgBud”
("DELETE FROM ");

403 
d–‘e
.
	`­³nd
(
d–‘eTy³
.
	`g‘TabËName
());

404 
d–‘e
.
	`­³nd
(" WHERE ");

405 
d–‘e
.
	`­³nd
(
PRIMARY_KEY
);

406 
d–‘e
.
	`­³nd
(" = ?");

407  
d–‘e
.
	`toSŒšg
();

408 
	}
}

	@postgrenosql/src/main/java/site/ycsb/postgrenosql/StatementType.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gpo¡g»nosql
;

21 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
public
 cÏs 
	cS‹m’tTy³
 {

28 
	eTy³
 {

29 
INSERT
(1), 
DELETE
(2), 
READ
(3), 
UPDATE
(4), 
SCAN
(5);

31 
´iv©e
 
fš®
 
	mš‹º®Ty³
;

33 
Ty³
(
ty³
) {

34 
	mš‹º®Ty³
 = 
ty³
;

37 
g‘HashCode
() {

38 
fš®
 
	m´ime
 = 31;

39 
	m»suÉ
 = 1;

40 
	m»suÉ
 = 
´ime
 * 
»suÉ
 + 
š‹º®Ty³
;

41  
	m»suÉ
;

45 
´iv©e
 
Ty³
 
	gty³
;

46 
´iv©e
 
SŒšg
 
	gbËName
;

47 
´iv©e
 
	gS‘
<
	gSŒšg
> 
	gf›lds
;

49 
public
 
S‹m’tTy³
(
Ty³
 
ty³
, 
SŒšg
 
bËName
, 
S‘
<SŒšg> 
f›lds
) {

50 
	gthis
.
	gty³
 = 
ty³
;

51 
	gthis
.
	gbËName
 = 
bËName
;

52 
	gthis
.
	gf›lds
 = 
f›lds
;

55 
public
 
SŒšg
 
	$g‘TabËName
() {

56  
bËName
;

57 
	}
}

59 
public
 
	gS‘
<
	gSŒšg
> 
	$g‘F›lds
() {

60  
f›lds
;

61 
	}
}

63 @
Ov”ride


64 
public
 
	$hashCode
() {

65 
fš®
 
´ime
 = 31;

66 
»suÉ
 = 1;

67 
»suÉ
 = 
´ime
 *„esuÉ + ((
ty³
 =ğ
nuÎ
è? 0 :y³.
	`g‘HashCode
());

68 
»suÉ
 = 
´ime
 *„esuÉ + ((
bËName
 =ğ
nuÎ
è? 0 :abËName.
	`hashCode
());

69 
»suÉ
 = 
´ime
 *„esuÉ + ((
f›lds
 =ğ
nuÎ
è? 0 : f›lds.
	`hashCode
());

70  
»suÉ
;

71 
	}
}

73 @
Ov”ride


74 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

75 ià(
this
 =ğ
obj
) {

76  
Œue
;

78 ià(
obj
 =ğ
nuÎ
) {

79  
çl£
;

82 ià(
	`g‘CÏss
(è!ğ
obj
.getClass()) {

83  
çl£
;

86 
S‹m’tTy³
 
Ùh”
 = (S‹m’tTy³è
obj
;

87 ià(
ty³
 !ğ
Ùh”
.type) {

88  
çl£
;

91 ià(
bËName
 =ğ
nuÎ
) {

92 ià(
Ùh”
.
bËName
 !ğ
nuÎ
) {

93  
çl£
;

95 } ià(!
bËName
.
	`equ®s
(
Ùh”
.tableName)) {

96  
çl£
;

99 ià(
f›lds
 =ğ
nuÎ
) {

100 ià(
Ùh”
.
f›lds
 !ğ
nuÎ
) {

101  
çl£
;

103 }ià(!
f›lds
.
	`equ®s
(
Ùh”
.fields)) {

104  
çl£
;

106  
Œue
;

107 
	}
}

	@postgrenosql/src/main/java/site/ycsb/postgrenosql/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gpo¡g»nosql
;

	@postgrenosql/src/test/java/site/ycsb/postgrenosql/PostgreNoSQLDBClientTest.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gpo¡g»nosql
;

19 
impÜt
 
	gs™e
.
	gycsb
.*;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

23 
impÜt
 
	gÜg
.
	gpo¡g»sql
.
	gDriv”
;

25 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtAdd»ss
;

27 
impÜt
 
	gjava
.
	gÃt
.
	gSock‘
;

28 
impÜt
 
	gjava
.
	gsql
.
	gCÚÃùiÚ
;

29 
impÜt
 
	gjava
.
	gsql
.
	gP»·»dS‹m’t
;

30 
impÜt
 
	gjava
.
	gsql
.
	gSQLExû±iÚ
;

31 
impÜt
 
	gjava
.
	gut
.*;

33 
impÜt
 
	gÜg
.
	gpo¡g»sql
.
	gut
.
	gPSQLExû±iÚ
;

34 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

35 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

37 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gCÜeM©ch”s
.
	gis
;

38 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gCÜeM©ch”s
.
	gnÙ
;

39 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹A¼ayEqu®s
;

40 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Th©
;

41 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeNoExû±iÚ
;

46 
public
 cÏs 
	cPo¡g»NoSQLDBCl›ÁTe¡
 {

47 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = 
Logg”FaùÜy
.
g‘Logg”
(
Po¡g»NoSQLDBCl›ÁTe¡
.
şass
);

50 
´iv©e
 
fš®
 
	mDEFAULT_PORT
 = 5432;

51 
´iv©e
 
fš®
 
SŒšg
 
	mDATABASE_NAME
 = "test";

52 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_USER
 = "postgres";

53 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_PWD
 = "postgres";

56 
´iv©e
 
fš®
 
SŒšg
 
	mHOST_NAME
 = "localhost";

57 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_DB_URL
 = "jdbc:po¡g»sql://" + 
HOST_NAME
 + ":" + 
DEFAULT_PORT
 + "/" + 
DATABASE_NAME
;

58 
´iv©e
 
fš®
 
SŒšg
 
	mTABLE_NAME
 = "usertable";

59 
´iv©e
 
fš®
 
	mFIELD_LENGTH
 = 32;

60 
´iv©e
 
fš®
 
SŒšg
 
	mFIELD_PREFIX
 = "FIELD";

61 
´iv©e
 
fš®
 
	mNUM_FIELDS
 = 3;

63 
´iv©e
 
CÚÃùiÚ
 
	mpo¡g»SQLCÚÃùiÚ
 = 
nuÎ
;

64 
´iv©e
 
Po¡g»NoSQLDBCl›Á
 
	mpo¡g»NoSQLCl›Á
 = 
nuÎ
;

66 @
BefÜeCÏss


67 
public
 
	$£tUp
() {

69 
	`Œy
 (
Sock‘
 
sock‘
 = 
Ãw
 
	`Sock‘
(
HOST_NAME
, 
DEFAULT_PORT
)){

70 
	`as£¹Th©
("Sock‘ i nÙ bound.", 
sock‘
.
	`g‘LoÿlPÜt
(), 
	`nÙ
(-1));

71 } 
	`ÿtch
 (
IOExû±iÚ
 
cÚÃùFaed
) {

72 
	`assumeNoExû±iÚ
("Po¡g»SQL i nÙ„uÂšg. Skpšge¡s.", 
cÚÃùFaed
);

75 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

76 
´İs
.
	`£tPrİ”ty
(
Po¡g»NoSQLDBCl›Á
.
CONNECTION_URL
, 
TEST_DB_URL
);

77 
´İs
.
	`£tPrİ”ty
(
Po¡g»NoSQLDBCl›Á
.
CONNECTION_USER
, 
DEFAULT_USER
);

78 
´İs
.
	`£tPrİ”ty
(
Po¡g»NoSQLDBCl›Á
.
CONNECTION_PASSWD
, 
DEFAULT_PWD
);

79 
´İs
.
	`£tPrİ”ty
("u£r", 
DEFAULT_USER
);

80 
´İs
.
	`£tPrİ”ty
("·sswÜd", 
DEFAULT_PWD
);

81 
´İs
.
	`£tPrİ”ty
(
Po¡g»NoSQLDBCl›Á
.
JDBC_AUTO_COMMIT
, "true");

83 
Œy
{

84 
po¡g»SQLCÚÃùiÚ
 = 
Ãw
 
	`Driv”
().
	`cÚÃù
(
TEST_DB_URL
, 
´İs
);

86 
boŞ—n
 
bËExi¡s
 = 
po¡g»SQLCÚÃùiÚ
.
	`g‘M‘aD©a
().
	`g‘TabËs
(
nuÎ
,‚uÎ, 
TABLE_NAME
,‚uÎ).
	`Ãxt
();

88 
	`as£¹Th©
("TabË dÛ nÙƒxi¡.", 
bËExi¡s
, 
	`nÙ
(
çl£
));

90 
po¡g»NoSQLCl›Á
 = 
Ãw
 
	`Po¡g»NoSQLDBCl›Á
();

91 
po¡g»NoSQLCl›Á
.
	`£tPrİ”t›s
(
´İs
);

92 
po¡g»NoSQLCl›Á
.
	`š™
();

94 
	`ÿtch
 (
PSQLExû±iÚ
 
e
){

95 ià(
e
.
	`g‘SQLS‹
().
	`equ®s
("3D000")){

96 
	`assumeNoExû±iÚ
("D©aba£ dÛ nÙƒxi¡. Skpšge¡s.", 
e
);

99 
	`ÿtch
 (
SQLExû±iÚ
 | 
DBExû±iÚ
 
e
){

100 
LOG
.
	`šfo
(
e
.
	`toSŒšg
());

104 @
Aá”CÏss


105 
public
 
	$‹¬Down
(){

106 
	}
}

108 @
Te¡


109 
public
 
	$š£¹R—d
() {

110 
SŒšg
 
š£¹Key
 = "user0";

111 
Œy
{

112 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
Ãw
 HashMap<>();

113 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
cİ›dIn£¹M­
 = 
Ãw
 HashMap<>();

114 
S‘
<
SŒšg
> 
f›lds
 = 
	`ü—‹F›ldS‘
();

116 
i
 = 0; i < 
NUM_FIELDS
; i++) {

117 
by‹
[] 
v®ue
 = 
Ãw
 by‹[
FIELD_LENGTH
];

118 
j
 = 0;j < 
v®ue
.
Ëngth
;j++){

119 
v®ue
[
j
] = (
by‹
)((
i
+1)*(j+1));

122 
š£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
(
v®ue
));

123 
cİ›dIn£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
(
v®ue
));

126 
Stus
 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`š£¹
(
TABLE_NAME
, 
š£¹Key
, 
š£¹M­
);

127 
	`as£¹Th©
("In£¹ did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

129 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adResuÉs
 = 
Ãw
 HashMap<>();

130 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
f›lds
, 
»adResuÉs
);

131 
	`as£¹Th©
("R—d did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

133 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’Œy
 : 
»adResuÉs
.
	`’ŒyS‘
()) {

134 
	`as£¹A¼ayEqu®s
("R—d„esuÉ dÛ nÙ m©ch wrÙ’Œ›s.", 
’Œy
.
	`g‘V®ue
().
	`toA¼ay
(), 
cİ›dIn£¹M­
.
	`g‘
ÓÁry.
	`g‘Key
()).toArray());

136 } 
	`ÿtch
 (
Exû±iÚ
 
e
){

137 
LOG
.
	`šfo
(
e
.
	`toSŒšg
());

139 
	}
}

141 @
Te¡


142 
public
 
	$š£¹R—dD–‘e
() {

143 
SŒšg
 
š£¹Key
 = "user1";

144 
Œy
{

145 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
Ãw
 HashMap<>();

146 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
cİ›dIn£¹M­
 = 
Ãw
 HashMap<>();

147 
S‘
<
SŒšg
> 
f›lds
 = 
	`ü—‹F›ldS‘
();

149 
i
 = 0; i < 
NUM_FIELDS
; i++) {

150 
by‹
[] 
v®ue
 = 
Ãw
 by‹[
FIELD_LENGTH
];

151 
j
 = 0;j < 
v®ue
.
Ëngth
;j++){

152 
v®ue
[
j
] = (
by‹
)((
i
+1)*(j+1));

155 
š£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
(
v®ue
));

156 
cİ›dIn£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
(
v®ue
));

159 
Stus
 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`š£¹
(
TABLE_NAME
, 
š£¹Key
, 
š£¹M­
);

160 
	`as£¹Th©
("In£¹ did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

162 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adResuÉs
 = 
Ãw
 HashMap<>();

163 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
f›lds
, 
»adResuÉs
);

164 
	`as£¹Th©
("R—d did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

166 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’Œy
 : 
»adResuÉs
.
	`’ŒyS‘
()) {

167 
	`as£¹A¼ayEqu®s
("R—d„esuÉ dÛ nÙ m©ch wrÙ’Œ›s.", 
’Œy
.
	`g‘V®ue
().
	`toA¼ay
(), 
cİ›dIn£¹M­
.
	`g‘
ÓÁry.
	`g‘Key
()).toArray());

170 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`d–‘e
(
TABLE_NAME
, 
š£¹Key
);

171 
	`as£¹Th©
("D–‘did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

173 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
f›lds
, 
»adResuÉs
);

174 
	`as£¹Th©
("R—d did‚Ù„‘uº‚Ù found (0).", 
»suÉ
, 
	`is
(
Stus
.
NOT_FOUND
));

176 } 
	`ÿtch
 (
Exû±iÚ
 
e
){

177 
LOG
.
	`šfo
(
e
.
	`toSŒšg
());

179 
	}
}

181 @
Te¡


182 
public
 
	$š£¹Sÿn
() {

183 
numb”OfV®uesToIn£¹
 = 100;

184 
»cÜdcouÁ
 = 5;

185 
SŒšg
 
¡¬tKey
 = "00050";

186 
Œy
{

188 
S‘
<
SŒšg
> 
f›lds
 = 
	`ü—‹F›ldS‘
();

191 
i
 = 0;˜< 
numb”OfV®uesToIn£¹
;i++){

192 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
Ãw
 HashMap<>();

194 
j
 = 0; j < 
NUM_FIELDS
; j++) {

195 
by‹
[] 
v®ue
 = 
Ãw
 by‹[
FIELD_LENGTH
];

196 
k
 = 0; k < 
v®ue
.
Ëngth
; k++) {

197 
v®ue
[
k
] = (
by‹
è((
j
 + 1) * (k + 1));

200 
š£¹M­
.
	`put
(
FIELD_PREFIX
 + 
j
, 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
(
v®ue
));

203 
po¡g»NoSQLCl›Á
.
	`š£¹
(
TABLE_NAME
, 
	`·dded
(
i
, 5), 
š£¹M­
);

206 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉs
 = 
Ãw
 Vector<HashMap<String, ByteIterator>>();

207 
Stus
 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`sÿn
(
TABLE_NAME
, 
¡¬tKey
,
»cÜdcouÁ
, 
f›lds
, 
»suÉs
);

208 
	`as£¹Th©
("SÿÀdid‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

209 
	`as£¹Th©
("Numb” oà»suÉ dÛ nÙ m©ch.", 
»suÉs
.
	`size
(), 
	`is
(
»cÜdcouÁ
));

210 } 
	`ÿtch
 (
Exû±iÚ
 
e
){

211 
LOG
.
	`šfo
(
e
.
	`toSŒšg
());

213 
	}
}

215 @
Te¡


216 
public
 
	$š£¹Upd©e
(){

217 
SŒšg
 
š£¹Key
 = "user2";

218 
Œy
{

219 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
Ãw
 HashMap<>();

220 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
cİ›dIn£¹M­
 = 
Ãw
 HashMap<>();

221 
S‘
<
SŒšg
> 
f›lds
 = 
	`ü—‹F›ldS‘
();

223 
i
 = 0; i < 
NUM_FIELDS
; i++) {

224 
by‹
[] 
v®ue
 = 
Ãw
 by‹[
FIELD_LENGTH
];

225 
j
 = 0;j < 
v®ue
.
Ëngth
;j++){

226 
v®ue
[
j
] = (
by‹
)((
i
+1)*(j+1));

229 
š£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
(
v®ue
));

230 
cİ›dIn£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
(
v®ue
));

233 
Stus
 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`š£¹
(
TABLE_NAME
, 
š£¹Key
, 
š£¹M­
);

234 
	`as£¹Th©
("In£¹ did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

236 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
upd©eM­
 = 
Ãw
 HashMap<>();

237 
upd©eM­
.
	`put
("FIELD0", 
Ãw
 
	`By‹A¼ayBy‹I‹¿tÜ
Òew 
by‹
[]{99, 99, 99, 99}));

239 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`upd©e
(
TABLE_NAME
, 
š£¹Key
, 
upd©eM­
);

240 
	`as£¹Th©
("Upd©did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

242 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adResuÉs
 = 
Ãw
 HashMap<>();

243 
»suÉ
 = 
po¡g»NoSQLCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
f›lds
, 
»adResuÉs
);

244 
	`as£¹Th©
("R—d did‚Ù„‘uº sucûs (0).", 
»suÉ
, 
	`is
(
Stus
.
OK
));

245 
	`as£¹Th©
("V®uwa nÙ upd©ed cÜ»ùly.", 
»adResuÉs
.
	`g‘
("FIELD0").
	`toA¼ay
(), 
	`is
(
Ãw
 
by‹
[]{99, 99, 99, 99}));

247 } 
	`ÿtch
 (
Exû±iÚ
 
e
){

248 
LOG
.
	`šfo
(
e
.
	`toSŒšg
());

250 
	}
}

252 
´iv©e
 
SŒšg
 
	$·dded
(
i
, 
·ddšg
) {

253 
SŒšg
 
»suÉ
 = SŒšg.
	`v®ueOf
(
i
);

254 
»suÉ
.
	`Ëngth
(è< 
·ddšg
) {

255 
»suÉ
 = "0" +„esult;

257  
»suÉ
;

258 
	}
}

260 
´iv©e
 
	gS‘
<
	gSŒšg
> 
	$ü—‹F›ldS‘
()

262 
S‘
<
SŒšg
> 
f›lds
 = 
Ãw
 
HashS‘
<>();

263 
j
 = 0; j < 
NUM_FIELDS
; j++) {

264 
f›lds
.
	`add
(
FIELD_PREFIX
 + 
j
);

266  
f›lds
;

267 
	}
}

	@rados/src/main/java/site/ycsb/db/RadosClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gcom
.
	gûph
.
	g¿dos
.
	gRados
;

21 
impÜt
 
	gcom
.
	gûph
.
	g¿dos
.
	gIoCTX
;

22 
impÜt
 
	gcom
.
	gûph
.
	g¿dos
.
	gjÇ
.
	gRadosObjeùInfo
;

23 
impÜt
 
	gcom
.
	gûph
.
	g¿dos
.
	gR—dOp
;

24 
impÜt
 
	gcom
.
	gûph
.
	g¿dos
.
	gR—dOp
.
	gR—dResuÉ
;

25 
impÜt
 
	gcom
.
	gûph
.
	g¿dos
.
	gexû±iÚs
.
	gRadosExû±iÚ
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

33 
impÜt
 
	gjava
.
	gio
.
	gFe
;

34 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gM­
;

36 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

37 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

38 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

39 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

41 
impÜt
 
	gÜg
.
	gjsÚ
.
	gJSONObjeù
;

48 
public
 cÏs 
	cRadosCl›Á
 
ex‹nds
 
	mDB
 {

50 
´iv©e
 
Rados
 
	m¿dos
;

51 
´iv©e
 
IoCTX
 
	mioùx
;

53 
public
 
fš®
 
SŒšg
 
	mCONFIG_FILE_PROPERTY
 = "rados.configfile";

54 
public
 
fš®
 
SŒšg
 
	mCONFIG_FILE_DEFAULT
 = "/etc/ceph/ceph.conf";

55 
public
 
fš®
 
SŒšg
 
	mID_PROPERTY
 = "rados.id";

56 
public
 
fš®
 
SŒšg
 
	mID_DEFAULT
 = "admin";

57 
public
 
fš®
 
SŒšg
 
	mPOOL_PROPERTY
 = "rados.pool";

58 
public
 
fš®
 
SŒšg
 
	mPOOL_DEFAULT
 = "data";

60 
´iv©e
 
boŞ—n
 
	misIn™ed
 = 
çl£
;

62 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

63 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

65 
SŒšg
 
cÚfigfe
 = 
´İs
.
	`g‘Prİ”ty
(
CONFIG_FILE_PROPERTY
);

66 ià(
cÚfigfe
 =ğ
nuÎ
) {

67 
cÚfigfe
 = 
CONFIG_FILE_DEFAULT
;

70 
SŒšg
 
id
 = 
´İs
.
	`g‘Prİ”ty
(
ID_PROPERTY
);

71 ià(
id
 =ğ
nuÎ
) {

72 
id
 = 
ID_DEFAULT
;

75 
SŒšg
 
poŞ
 = 
´İs
.
	`g‘Prİ”ty
(
POOL_PROPERTY
);

76 ià(
poŞ
 =ğ
nuÎ
) {

77 
poŞ
 = 
POOL_DEFAULT
;

85 
¿dos
 = 
Ãw
 
	`Rados
(
id
);

86 
Œy
 {

87 
¿dos
.
	`cÚfR—dFe
(
Ãw
 
	`Fe
(
cÚfigfe
));

88 
¿dos
.
	`cÚÃù
();

89 
ioùx
 = 
¿dos
.
	`ioCtxC»©e
(
poŞ
);

90 } 
	`ÿtch
 (
RadosExû±iÚ
 
e
) {

91 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
.
	`g‘Mes§ge
(è+ ": " +ƒ.
	`g‘R‘uºV®ue
());

94 
isIn™ed
 = 
Œue
;

97 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

98 ià(
isIn™ed
) {

99 
¿dos
.
	`shutDown
();

100 
¿dos
.
	`ioCtxDe¡roy
(
ioùx
);

101 
isIn™ed
 = 
çl£
;

103 
	}
}

105 @
Ov”ride


106 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

107 
	gby‹
[] 
	gbufãr
;

109 
	gŒy
 {

110 
RadosObjeùInfo
 
	gšfo
 = 
ioùx
.
¡©
(
key
);

111 
	gbufãr
 = 
Ãw
 
by‹
[()
šfo
.
g‘Size
()];

113 
R—dOp
 
	grİ
 = 
ioùx
.
»adOpC»©e
();

114 
R—dResuÉ
 
	g»adResuÉ
 = 
rİ
.
queueR—d
(0, 
šfo
.
g‘Size
());

117 
	grİ
.
İ”©e
(
key
, 0);

119 ià(
	g»adResuÉ
.
g‘RV®
() < 0) {

120 
throw
 
Ãw
 
RadosExû±iÚ
("E¼Ü R—dOP", 
»adResuÉ
.
g‘RV®
());

122 ià(
	gšfo
.
g‘Size
(è!ğ
»adResuÉ
.
g‘By‹sR—d
()) {

123  
Ãw
 
Stus
("ERROR", "Errorhe object size„ead");

125 
	g»adResuÉ
.
g‘Bufãr
().
g‘
(
bufãr
);

126 } 
ÿtch
 (
RadosExû±iÚ
 
e
) {

127  
Ãw
 
Stus
("ERROR-" + 
e
.
g‘R‘uºV®ue
(),ƒ.
g‘Mes§ge
());

130 
JSONObjeù
 
	gjsÚ
 = 
Ãw
 JSONObjeùÒew 
SŒšg
(
bufãr
, 
java
.
nio
.
ch¬£t
.
Snd¬dCh¬£ts
.
UTF_8
));

131 
	gS‘
<
	gSŒšg
> 
	gf›ldsToR‘uº
 = (
f›lds
 =ğ
nuÎ
 ? 
jsÚ
.
keyS‘
() : fields);

133 
SŒšg
 
	gÇme
 : 
f›ldsToR‘uº
) {

134 
»suÉ
.
put
(
Çme
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
jsÚ
.
g‘SŒšg
(name)));

137  
	g»suÉ
.
isEm±y
(è? 
	gStus
.
	gERROR
 : 
Stus
.
OK
;

140 @
Ov”ride


141 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

142 
JSONObjeù
 
	gjsÚ
 = 
Ãw
 JSONObject();

143 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	ge
 : 
v®ues
.
’ŒyS‘
()) {

144 
jsÚ
.
put
(
e
.
g‘Key
(),ƒ.
g‘V®ue
().
toSŒšg
());

147 
	gŒy
 {

148 
	gioùx
.
wr™e
(
key
, 
jsÚ
.
toSŒšg
());

149 } 
ÿtch
 (
RadosExû±iÚ
 
e
) {

150  
Ãw
 
Stus
("ERROR-" + 
e
.
g‘R‘uºV®ue
(),ƒ.
g‘Mes§ge
());

152  
	gStus
.
	gOK
;

155 @
Ov”ride


156 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

157 
Œy
 {

158 
ioùx
.
	`»move
(
key
);

159 } 
	`ÿtch
 (
RadosExû±iÚ
 
e
) {

160  
Ãw
 
	`Stus
("ERROR-" + 
e
.
	`g‘R‘uºV®ue
(),ƒ.
	`g‘Mes§ge
());

162  
Stus
.
OK
;

163 
	}
}

165 @
Ov”ride


166 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

167 
Stus
 
	g¹n
 = 
d–‘e
(
bË
, 
key
);

168 ià(
	g¹n
.
equ®s
(
Stus
.
OK
)) {

169  
š£¹
(
bË
, 
key
, 
v®ues
);

171  
	g¹n
;

174 @
Ov”ride


175 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

176 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

177  
	gStus
.
	gNOT_IMPLEMENTED
;

	@rados/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@rados/src/test/java/site/ycsb/db/RadosClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeNoExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

28 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

29 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

30 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

31 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

32 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

34 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

36 
impÜt
 
	gjava
.
	gut
.
	gM­
;

37 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

38 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

39 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

48 
public
 cÏs 
	cRadosCl›ÁTe¡
 {

50 
´iv©e
 
RadosCl›Á
 
	m¿dosş›Á
;

52 
public
 
fš®
 
SŒšg
 
	mPOOL_PROPERTY
 = "rados.pool";

53 
public
 
fš®
 
SŒšg
 
	mPOOL_TEST
 = "rbd";

55 
´iv©e
 
fš®
 
SŒšg
 
	mTABLE_NAME
 = "table0";

56 
´iv©e
 
fš®
 
SŒšg
 
	mKEY0
 = "key0";

57 
´iv©e
 
fš®
 
SŒšg
 
	mKEY1
 = "key1";

58 
´iv©e
 
fš®
 
SŒšg
 
	mKEY2
 = "key2";

59 
´iv©e
 
fš®
 
	mHashM­
<
	mSŒšg
, 
	mBy‹I‹¿tÜ
> 
	mDATA
;

60 
´iv©e
 
fš®
 
	mHashM­
<
	mSŒšg
, 
	mBy‹I‹¿tÜ
> 
	mDATA_UPDATED
;

63 
	mDATA
 = 
Ãw
 
HashM­
<
SŒšg
, 
	mBy‹I‹¿tÜ
>(10);

64 
	mDATA_UPDATED
 = 
Ãw
 
HashM­
<
SŒšg
, 
	mBy‹I‹¿tÜ
>(10);

65 
	mi
 = 0; i < 10; i++) {

66 
SŒšg
 
	mkey
 = "key" + 
UUID
.
¿ndomUUID
();

67 
	mDATA
.
put
(
key
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
("d©a" + 
UUID
.
¿ndomUUID
()));

68 
	mDATA_UPDATED
.
put
(
key
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
("d©a" + 
UUID
.
¿ndomUUID
()));

72 @
BefÜeCÏss


73 
public
 
	$£tupCÏss
(è
throws
 
DBExû±iÚ
 {

74 
¿dosş›Á
 = 
Ãw
 
	`RadosCl›Á
();

76 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

77 
p
.
	`£tPrİ”ty
(
POOL_PROPERTY
, 
POOL_TEST
);

79 
Œy
 {

80 
¿dosş›Á
.
	`£tPrİ”t›s
(
p
);

81 
¿dosş›Á
.
	`š™
();

83 
	`ÿtch
 (
DBExû±iÚ
|
Un§tisf›dLškE¼Ü
 
e
) {

84 
	`assumeNoExû±iÚ
("C•h clu¡” i nÙ„uÂšg. Skpšge¡s.", 
e
);

86 
	}
}

88 @
Aá”CÏss


89 
public
 
	$‹¬downCÏss
(è
throws
 
DBExû±iÚ
 {

90 ià(
¿dosş›Á
 !ğ
nuÎ
) {

91 
¿dosş›Á
.
	`ş—nup
();

93 
	}
}

95 @
BefÜe


96 
public
 
	$£tUp
() {

97 
¿dosş›Á
.
	`š£¹
(
TABLE_NAME
, 
KEY0
, 
DATA
);

98 
	}
}

100 @
Aá”


101 
public
 
	$‹¬Down
() {

102 
¿dosş›Á
.
	`d–‘e
(
TABLE_NAME
, 
KEY0
);

103 
	}
}

105 @
Te¡


106 
public
 
	$š£¹Te¡
() {

107 
Stus
 
»suÉ
 = 
¿dosş›Á
.
	`š£¹
(
TABLE_NAME
, 
KEY1
, 
DATA
);

108 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

109 
	}
}

111 @
Te¡


112 
public
 
	$upd©eTe¡
() {

113 
¿dosş›Á
.
	`š£¹
(
TABLE_NAME
, 
KEY2
, 
DATA
);

115 
Stus
 
»suÉ
 = 
¿dosş›Á
.
	`upd©e
(
TABLE_NAME
, 
KEY2
, 
DATA_UPDATED
);

116 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

118 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»t
 = 
Ãw
 HashMap<String, ByteIterator>(10);

119 
¿dosş›Á
.
	`»ad
(
TABLE_NAME
, 
KEY2
, 
DATA
.
	`keyS‘
(), 
»t
);

120 
	`com·»M­
(
DATA_UPDATED
, 
»t
);

122 
¿dosş›Á
.
	`d–‘e
(
TABLE_NAME
, 
KEY2
);

123 
	}
}

125 @
Te¡


126 
public
 
	$»adTe¡
() {

127 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»t
 = 
Ãw
 HashMap<String, ByteIterator>(10);

128 
Stus
 
»suÉ
 = 
¿dosş›Á
.
	`»ad
(
TABLE_NAME
, 
KEY0
, 
DATA
.
	`keyS‘
(), 
»t
);

129 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

130 
	`com·»M­
(
DATA
, 
»t
);

131 
	}
}

133 
´iv©e
 
com·»M­
(
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
¤c
, HashM­<SŒšg, By‹I‹¿tÜ> 
de¡
) {

134 
as£¹Equ®s
(
¤c
.
size
(), 
de¡
.size());

136 
S‘
 
	g£tSrc
 = 
¤c
.
’ŒyS‘
();

137 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
> 
	g™Src
 = 
£tSrc
.
™”©Ü
();

138 
	gi
 = 0; i < 10; i++) {

139 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’ŒySrc
 = 
™Src
.
Ãxt
();

140 
as£¹Equ®s
(
’ŒySrc
.
g‘V®ue
().
toSŒšg
(), 
de¡
.
g‘
ÓÁrySrc.
g‘Key
()).toString());

144 @
Te¡


145 
public
 
	$d–‘eTe¡
() {

146 
Stus
 
»suÉ
 = 
¿dosş›Á
.
	`d–‘e
(
TABLE_NAME
, 
KEY0
);

147 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

148 
	}
}

	@redis/src/main/java/site/ycsb/db/RedisClient.java

25 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

32 
impÜt
 
	g»dis
.
	gş›Ás
.
	gjedis
.
	gBasicCommªds
;

33 
impÜt
 
	g»dis
.
	gş›Ás
.
	gjedis
.
	gHo¡AndPÜt
;

34 
impÜt
 
	g»dis
.
	gş›Ás
.
	gjedis
.
	gJedis
;

35 
impÜt
 
	g»dis
.
	gş›Ás
.
	gjedis
.
	gJedisClu¡”
;

36 
impÜt
 
	g»dis
.
	gş›Ás
.
	gjedis
.
	gJedisCommªds
;

37 
impÜt
 
	g»dis
.
	gş›Ás
.
	gjedis
.
	gPrÙocŞ
;

39 
impÜt
 
	gjava
.
	gio
.
	gClo£abË
;

40 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

41 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

42 
impÜt
 
	gjava
.
	gut
.
	gM­
;

43 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

44 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

45 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

46 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

47 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

48 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

55 
public
 cÏs 
	cRedisCl›Á
 
ex‹nds
 
	mDB
 {

57 
´iv©e
 
JedisCommªds
 
	mjedis
;

59 
public
 
fš®
 
SŒšg
 
	mHOST_PROPERTY
 = "redis.host";

60 
public
 
fš®
 
SŒšg
 
	mPORT_PROPERTY
 = "redis.port";

61 
public
 
fš®
 
SŒšg
 
	mPASSWORD_PROPERTY
 = "redis.password";

62 
public
 
fš®
 
SŒšg
 
	mCLUSTER_PROPERTY
 = "redis.cluster";

63 
public
 
fš®
 
SŒšg
 
	mTIMEOUT_PROPERTY
 = "redis.timeout";

65 
public
 
fš®
 
SŒšg
 
	mINDEX_KEY
 = "_indices";

67 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

68 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

69 
pÜt
;

71 
SŒšg
 
pÜtSŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
PORT_PROPERTY
);

72 ià(
pÜtSŒšg
 !ğ
nuÎ
) {

73 
pÜt
 = 
IÁeg”
.
	`·r£IÁ
(
pÜtSŒšg
);

75 
pÜt
 = 
PrÙocŞ
.
DEFAULT_PORT
;

77 
SŒšg
 
ho¡
 = 
´İs
.
	`g‘Prİ”ty
(
HOST_PROPERTY
);

79 
boŞ—n
 
şu¡”EÇbËd
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
(
CLUSTER_PROPERTY
));

80 ià(
şu¡”EÇbËd
) {

81 
S‘
<
Ho¡AndPÜt
> 
jedisClu¡”Nodes
 = 
Ãw
 
HashS‘
<>();

82 
jedisClu¡”Nodes
.
	`add
(
Ãw
 
	`Ho¡AndPÜt
(
ho¡
, 
pÜt
));

83 
jedis
 = 
Ãw
 
	`JedisClu¡”
(
jedisClu¡”Nodes
);

85 
SŒšg
 
»disTimeout
 = 
´İs
.
	`g‘Prİ”ty
(
TIMEOUT_PROPERTY
);

86 ià(
»disTimeout
 !ğ
nuÎ
){

87 
jedis
 = 
Ãw
 
	`Jedis
(
ho¡
, 
pÜt
, 
IÁeg”
.
	`·r£IÁ
(
»disTimeout
));

89 
jedis
 = 
Ãw
 
	`Jedis
(
ho¡
, 
pÜt
);

91 ((
Jedis
è
jedis
).
	`cÚÃù
();

94 
SŒšg
 
·sswÜd
 = 
´İs
.
	`g‘Prİ”ty
(
PASSWORD_PROPERTY
);

95 ià(
·sswÜd
 !ğ
nuÎ
) {

96 ((
BasicCommªds
è
jedis
).
	`auth
(
·sswÜd
);

100 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

101 
Œy
 {

102 ((
Clo£abË
è
jedis
).
	`şo£
();

103 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

104 
throw
 
Ãw
 
	`DBExû±iÚ
("Closing connection failed.");

106 
	}
}

114 
´iv©e
 
	$hash
(
SŒšg
 
key
) {

115  
key
.
	`hashCode
();

116 
	}
}

120 @
Ov”ride


121 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

122 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

123 ià(
	gf›lds
 =ğ
nuÎ
) {

124 
SŒšgBy‹I‹¿tÜ
.
putAÎAsBy‹I‹¿tÜs
(
»suÉ
, 
jedis
.
hg‘AÎ
(
key
));

126 
	gSŒšg
[] 
	gf›ldA¼ay
 =

127 (
SŒšg
[]è
f›lds
.
toA¼ay
(
Ãw
 SŒšg[f›lds.
size
()]);

128 
	gLi¡
<
	gSŒšg
> 
	gv®ues
 = 
jedis
.
hmg‘
(
key
, 
f›ldA¼ay
);

130 
	gI‹¿tÜ
<
	gSŒšg
> 
	gf›ldI‹¿tÜ
 = 
f›lds
.
™”©Ü
();

131 
	gI‹¿tÜ
<
	gSŒšg
> 
	gv®ueI‹¿tÜ
 = 
v®ues
.
™”©Ü
();

133 
	gf›ldI‹¿tÜ
.
hasNext
(è&& 
	gv®ueI‹¿tÜ
.hasNext()) {

134 
	g»suÉ
.
put
(
f›ldI‹¿tÜ
.
Ãxt
(),

135 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ueI‹¿tÜ
.
Ãxt
()));

137 
	gas£¹
 !
	gf›ldI‹¿tÜ
.
hasNext
(è&& !
	gv®ueI‹¿tÜ
.hasNext();

139  
	g»suÉ
.
isEm±y
(è? 
	gStus
.
	gERROR
 : 
Stus
.
OK
;

142 @
Ov”ride


143 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

144 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

145 ià(
	gjedis
.
hm£t
(
key
, 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
))

146 .
equ®s
("OK")) {

147 
	gjedis
.
zadd
(
INDEX_KEY
, 
hash
(
key
), key);

148  
	gStus
.
	gOK
;

150  
	gStus
.
	gERROR
;

153 @
Ov”ride


154 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

155  
jedis
.
	`d–
(
key
è=ğ0 && jedis.
	`z»m
(
INDEX_KEY
, keyè=ğ0 ? 
Stus
.
ERROR


156 : 
Stus
.
OK
;

157 
	}
}

159 @
Ov”ride


160 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

161 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

162  
	gjedis
.
hm£t
(
key
, 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
))

163 .
equ®s
("OK"è? 
	gStus
.
	gOK
 : 
Stus
.
ERROR
;

166 @
Ov”ride


167 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

168 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

169 
	gS‘
<
	gSŒšg
> 
	gkeys
 = 
jedis
.
z¿ngeByScÜe
(
INDEX_KEY
, 
hash
(
¡¬tkey
),

170 
DoubË
.
POSITIVE_INFINITY
, 0, 
»cÜdcouÁ
);

172 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gv®ues
;

173 
SŒšg
 
	gkey
 : 
keys
) {

174 
v®ues
 = 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

175 
»ad
(
bË
, 
key
, 
f›lds
, 
v®ues
);

176 
	g»suÉ
.
add
(
v®ues
);

179  
	gStus
.
	gOK
;

	@redis/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@rest/src/main/java/site/ycsb/webservice/rest/RestClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gweb£rviû
.
	g»¡
;

20 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

21 
impÜt
 
	gjava
.
	gio
.
	gBy‹A¼ayIÅutSŒ—m
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

24 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—mR—d”
;

25 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

28 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

29 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

30 
impÜt
 
	gjava
.
	gut
.
	gz
.
	gGZIPIÅutSŒ—m
;

32 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gH‰pM‘hod
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gH‰pEÁ™y
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gş›Á
.
	gCl›ÁPrÙocŞExû±iÚ
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gş›Á
.
	gcÚfig
.
	gReque¡CÚfig
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gş›Á
.
	gm‘hods
.
	gClo£abËH‰pRe¥Ú£
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gş›Á
.
	gm‘hods
.
	gH‰pD–‘e
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gş›Á
.
	gm‘hods
.
	gH‰pEÁ™yEnşosšgReque¡Ba£
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gş›Á
.
	gm‘hods
.
	gH‰pG‘
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gş›Á
.
	gm‘hods
.
	gH‰pPo¡
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gş›Á
.
	gm‘hods
.
	gH‰pPut
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	g’t™y
.
	gCÚ‹ÁTy³
;

44 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	g’t™y
.
	gIÅutSŒ—mEÁ™y
;

45 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gim¶
.
	gş›Á
.
	gClo£abËH‰pCl›Á
;

46 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gim¶
.
	gş›Á
.
	gH‰pCl›ÁBud”
;

47 
impÜt
 
	gÜg
.
	g­ache
.
	gh‰p
.
	gut
.
	gEÁ™yUts
;

49 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

50 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

51 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

52 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

53 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

61 
public
 cÏs 
	cRe¡Cl›Á
 
ex‹nds
 
	mDB
 {

63 
´iv©e
 
fš®
 
SŒšg
 
	mURL_PREFIX
 = "url.prefix";

64 
´iv©e
 
fš®
 
SŒšg
 
	mCON_TIMEOUT
 = "timeout.con";

65 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_TIMEOUT
 = "timeout.read";

66 
´iv©e
 
fš®
 
SŒšg
 
	mEXEC_TIMEOUT
 = "timeout.exec";

67 
´iv©e
 
fš®
 
SŒšg
 
	mLOG_ENABLED
 = "log.enable";

68 
´iv©e
 
fš®
 
SŒšg
 
	mHEADERS
 = "headers";

69 
´iv©e
 
fš®
 
SŒšg
 
	mCOMPRESSED_RESPONSE
 = "response.compression";

70 
´iv©e
 
boŞ—n
 
	mcom´es£dRe¥Ú£
;

71 
´iv©e
 
boŞ—n
 
	mlogEÇbËd
;

72 
´iv©e
 
SŒšg
 
	mu¾P»fix
;

73 
´iv©e
 
Prİ”t›s
 
	m´İs
;

74 
´iv©e
 
	mSŒšg
[] 
	mh—d”s
;

75 
´iv©e
 
Clo£abËH‰pCl›Á
 
	mş›Á
;

76 
´iv©e
 
	mcÚTimeout
 = 10000;

77 
´iv©e
 
	m»adTimeout
 = 10000;

78 
´iv©e
 
	mexecTimeout
 = 10000;

79 
´iv©e
 vŞ©
Cr™”Ÿ
 
	m»que¡Timedout
 = 
Ãw
 Cr™”Ÿ(
çl£
);

81 @
Ov”ride


82 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

83 
´İs
 = 
	`g‘Prİ”t›s
();

84 
u¾P»fix
 = 
´İs
.
	`g‘Prİ”ty
(
URL_PREFIX
, "http://127.0.0.1:8080");

85 
cÚTimeout
 = 
IÁeg”
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
CON_TIMEOUT
, "10")) * 1000;

86 
»adTimeout
 = 
IÁeg”
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
READ_TIMEOUT
, "10")) * 1000;

87 
execTimeout
 = 
IÁeg”
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
EXEC_TIMEOUT
, "10")) * 1000;

88 
logEÇbËd
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
LOG_ENABLED
, "çl£").
	`Œim
());

89 
com´es£dRe¥Ú£
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
COMPRESSED_RESPONSE
, "çl£").
	`Œim
());

90 
h—d”s
 = 
´İs
.
	`g‘Prİ”ty
(
HEADERS
, "Acû± */* CÚ‹Á-Ty³‡µliÿtiÚ/xmÈu£r-ag’ˆMozÏ/5.0 ").
	`Œim
()

91 .
	`¥l™
(" ");

92 
	`£tupCl›Á
();

95 
´iv©e
 
	$£tupCl›Á
() {

96 
Reque¡CÚfig
.
Bud”
 
»que¡Bud”
 = Reque¡CÚfig.
	`cu¡om
();

97 
»que¡Bud”
 =„eque¡Bud”.
	`£tCÚÃùTimeout
(
cÚTimeout
);

98 
»que¡Bud”
 =„eque¡Bud”.
	`£tCÚÃùiÚReque¡Timeout
(
»adTimeout
);

99 
»que¡Bud”
 =„eque¡Bud”.
	`£tSock‘Timeout
(
»adTimeout
);

100 
H‰pCl›ÁBud”
 
ş›ÁBud”
 = H‰pCl›ÁBud”.
	`ü—‹
().
	`£tDeçuÉReque¡CÚfig
(
»que¡Bud”
.
	`bud
());

101 
this
.
ş›Á
 = 
ş›ÁBud”
.
	`£tCÚÃùiÚMªag”Sh¬ed
(
Œue
).
	`bud
();

102 
	}
}

104 @
Ov”ride


105 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
’dpošt
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

106 
	g»¥Ú£Code
;

107 
	gŒy
 {

108 
	g»¥Ú£Code
 = 
h‰pG‘
(
u¾P»fix
 + 
’dpošt
, 
»suÉ
);

109 } 
ÿtch
 (
Exû±iÚ
 
e
) {

110 
	g»¥Ú£Code
 = 
hªdËExû±iÚs
(
e
, 
u¾P»fix
 + 
’dpošt
, 
H‰pM‘hod
.
GET
);

112 ià(
	glogEÇbËd
) {

113 
	gSy¡em
.
	g”r
.
´šn
(
Ãw
 
SŒšgBud”
("GET Reque¡: ").
­³nd
(
u¾P»fix
).­³nd(
’dpošt
)

114 .
­³nd
(" | Re¥Ú£ Code: ").­³nd(
»¥Ú£Code
).
toSŒšg
());

116  
g‘Stus
(
»¥Ú£Code
);

119 @
Ov”ride


120 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
’dpošt
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

121 
	g»¥Ú£Code
;

122 
	gŒy
 {

123 
	g»¥Ú£Code
 = 
h‰pExecu‹
(
Ãw
 
H‰pPo¡
(
u¾P»fix
 + 
’dpošt
), 
v®ues
.
g‘
("d©a").
toSŒšg
());

124 } 
ÿtch
 (
Exû±iÚ
 
e
) {

125 
	g»¥Ú£Code
 = 
hªdËExû±iÚs
(
e
, 
u¾P»fix
 + 
’dpošt
, 
H‰pM‘hod
.
POST
);

127 ià(
	glogEÇbËd
) {

128 
	gSy¡em
.
	g”r
.
´šn
(
Ãw
 
SŒšgBud”
("POST Reque¡: ").
­³nd
(
u¾P»fix
).­³nd(
’dpošt
)

129 .
­³nd
(" | Re¥Ú£ Code: ").­³nd(
»¥Ú£Code
).
toSŒšg
());

131  
g‘Stus
(
»¥Ú£Code
);

134 @
Ov”ride


135 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
’dpošt
) {

136 
»¥Ú£Code
;

137 
Œy
 {

138 
»¥Ú£Code
 = 
	`h‰pD–‘e
(
u¾P»fix
 + 
’dpošt
);

139 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

140 
»¥Ú£Code
 = 
	`hªdËExû±iÚs
(
e
, 
u¾P»fix
 + 
’dpošt
, 
H‰pM‘hod
.
DELETE
);

142 ià(
logEÇbËd
) {

143 
Sy¡em
.
”r
.
	`´šn
(
Ãw
 
	`SŒšgBud”
("DELETE Reque¡: ").
	`­³nd
(
u¾P»fix
).­³nd(
’dpošt
)

144 .
	`­³nd
(" | Re¥Ú£ Code: ").­³nd(
»¥Ú£Code
).
	`toSŒšg
());

146  
	`g‘Stus
(
»¥Ú£Code
);

147 
	}
}

149 @
Ov”ride


150 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
’dpošt
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

151 
	g»¥Ú£Code
;

152 
	gŒy
 {

153 
	g»¥Ú£Code
 = 
h‰pExecu‹
(
Ãw
 
H‰pPut
(
u¾P»fix
 + 
’dpošt
), 
v®ues
.
g‘
("d©a").
toSŒšg
());

154 } 
ÿtch
 (
Exû±iÚ
 
e
) {

155 
	g»¥Ú£Code
 = 
hªdËExû±iÚs
(
e
, 
u¾P»fix
 + 
’dpošt
, 
H‰pM‘hod
.
PUT
);

157 ià(
	glogEÇbËd
) {

158 
	gSy¡em
.
	g”r
.
´šn
(
Ãw
 
SŒšgBud”
("PUT Reque¡: ").
­³nd
(
u¾P»fix
).­³nd(
’dpošt
)

159 .
­³nd
(" | Re¥Ú£ Code: ").­³nd(
»¥Ú£Code
).
toSŒšg
());

161  
g‘Stus
(
»¥Ú£Code
);

164 @
Ov”ride


165 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

166 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

167  
	gStus
.
	gNOT_IMPLEMENTED
;

171 
´iv©e
 
Stus
 
	$g‘Stus
(
»¥Ú£Code
) {

172 
rc
 = 
»¥Ú£Code
 / 100;

173 ià(
»¥Ú£Code
 == 400) {

174  
Stus
.
BAD_REQUEST
;

175 } ià(
»¥Ú£Code
 == 403) {

176  
Stus
.
FORBIDDEN
;

177 } ià(
»¥Ú£Code
 == 404) {

178  
Stus
.
NOT_FOUND
;

179 } ià(
»¥Ú£Code
 == 501) {

180  
Stus
.
NOT_IMPLEMENTED
;

181 } ià(
»¥Ú£Code
 == 503) {

182  
Stus
.
SERVICE_UNAVAILABLE
;

183 } ià(
rc
 == 5) {

184  
Stus
.
ERROR
;

186  
Stus
.
OK
;

187 
	}
}

189 
´iv©e
 
	$hªdËExû±iÚs
(
Exû±iÚ
 
e
, 
SŒšg
 
u¾
, SŒšg 
m‘hod
) {

190 ià(
logEÇbËd
) {

191 
Sy¡em
.
”r
.
	`´šn
(
Ãw
 
	`SŒšgBud”
(
m‘hod
).
	`­³nd
(" Reque¡: ").­³nd(
u¾
).append(" | ")

192 .
	`­³nd
(
e
.
	`g‘CÏss
().
	`g‘Name
()).append(" occured | Error message: ")

193 .
	`­³nd
(
e
.
	`g‘Mes§ge
()).
	`toSŒšg
());

196 ià(
e
 
š¡ªûof
 
Cl›ÁPrÙocŞExû±iÚ
) {

200 
	}
}

203 
´iv©e
 
h‰pG‘
(
SŒšg
 
’dpošt
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
è
throws
 
	gIOExû±iÚ
 {

204 
	g»que¡Timedout
.
£tIsS©isf›d
(
çl£
);

205 
Th»ad
 
	gtim”
 = 
Ãw
 Th»adÒew 
Tim”
(
execTimeout
, 
»que¡Timedout
));

206 
	gtim”
.
¡¬t
();

207 
	g»¥Ú£Code
 = 200;

208 
H‰pG‘
 
	g»que¡
 = 
Ãw
 H‰pG‘(
’dpošt
);

209 
	gi
 = 0; i < 
	gh—d”s
.
	gËngth
; i = 
i
 + 2) {

210 
»que¡
.
£tH—d”
(
h—d”s
[
i
], headers[i + 1]);

212 
Clo£abËH‰pRe¥Ú£
 
	g»¥Ú£
 = 
ş›Á
.
execu‹
(
»que¡
);

213 
	g»¥Ú£Code
 = 
»¥Ú£
.
g‘StusLše
().
g‘StusCode
();

214 
H‰pEÁ™y
 
	g»¥Ú£EÁ™y
 = 
»¥Ú£
.
g‘EÁ™y
();

216 ià(
	g»¥Ú£EÁ™y
 !ğ
nuÎ
) {

217 
IÅutSŒ—m
 
¡»am
 = 
»¥Ú£EÁ™y
.
g‘CÚ‹Á
();

224 
Bufã»dR—d”
 
	g»ad”
 = 
Ãw
 Bufã»dR—d”Òew 
IÅutSŒ—mR—d”
(
¡»am
, "UTF-8"));

225 
SŒšgBufãr
 
	g»¥Ú£CÚ‹Á
 = 
Ãw
 StringBuffer();

226 
SŒšg
 
	glše
 = "";

227 (
	glše
 = 
»ad”
.
»adLše
()è!ğ
nuÎ
) {

228 ià(
»que¡Timedout
.
isS©isf›d
()) {

230 
»ad”
.
şo£
();

231 
	g¡»am
.
şo£
();

232 
	gEÁ™yUts
.
cÚsumeQu›y
(
»¥Ú£EÁ™y
);

233 
	g»¥Ú£
.
şo£
();

234 
	gş›Á
.
şo£
();

235 
throw
 
Ãw
 
TimeoutExû±iÚ
();

237 
	g»¥Ú£CÚ‹Á
.
­³nd
(
lše
);

239 
	gtim”
.
š‹¼u±
();

240 
	g»suÉ
.
put
("»¥Ú£", 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
»¥Ú£CÚ‹Á
.
toSŒšg
()));

242 
	g¡»am
.
şo£
();

244 
	gEÁ™yUts
.
cÚsumeQu›y
(
»¥Ú£EÁ™y
);

245 
	g»¥Ú£
.
şo£
();

246 
	gş›Á
.
şo£
();

247  
	g»¥Ú£Code
;

250 
´iv©e
 
	$h‰pExecu‹
(
H‰pEÁ™yEnşosšgReque¡Ba£
 
»que¡
, 
SŒšg
 
d©a
è
throws
 
IOExû±iÚ
 {

251 
»que¡Timedout
.
	`£tIsS©isf›d
(
çl£
);

252 
Th»ad
 
tim”
 = 
Ãw
 
	`Th»ad
Òew 
	`Tim”
(
execTimeout
, 
»que¡Timedout
));

253 
tim”
.
	`¡¬t
();

254 
»¥Ú£Code
 = 200;

255 
i
 = 0; i < 
h—d”s
.
Ëngth
; i = i + 2) {

256 
»que¡
.
	`£tH—d”
(
h—d”s
[
i
], headers[i + 1]);

258 
IÅutSŒ—mEÁ™y
 
»qEÁ™y
 = 
Ãw
 
	`IÅutSŒ—mEÁ™y
Òew 
	`By‹A¼ayIÅutSŒ—m
(
d©a
.
	`g‘By‹s
()),

259 
CÚ‹ÁTy³
.
APPLICATION_FORM_URLENCODED
);

260 
»qEÁ™y
.
	`£tChunked
(
Œue
);

261 
»que¡
.
	`£tEÁ™y
(
»qEÁ™y
);

262 
Clo£abËH‰pRe¥Ú£
 
»¥Ú£
 = 
ş›Á
.
	`execu‹
(
»que¡
);

263 
»¥Ú£Code
 = 
»¥Ú£
.
	`g‘StusLše
().
	`g‘StusCode
();

264 
H‰pEÁ™y
 
»¥Ú£EÁ™y
 = 
»¥Ú£
.
	`g‘EÁ™y
();

266 ià(
»¥Ú£EÁ™y
 !ğ
nuÎ
) {

267 
IÅutSŒ—m
 
¡»am
 = 
»¥Ú£EÁ™y
.
	`g‘CÚ‹Á
();

268 ià(
com´es£dRe¥Ú£
) {

269 
¡»am
 = 
Ãw
 
	`GZIPIÅutSŒ—m
(stream);

271 
Bufã»dR—d”
 
»ad”
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`IÅutSŒ—mR—d”
(
¡»am
, "UTF-8"));

272 
SŒšgBufãr
 
»¥Ú£CÚ‹Á
 = 
Ãw
 
	`SŒšgBufãr
();

273 
SŒšg
 
lše
 = "";

274 (
lše
 = 
»ad”
.
	`»adLše
()è!ğ
nuÎ
) {

275 ià(
»que¡Timedout
.
	`isS©isf›d
()) {

277 
»ad”
.
	`şo£
();

278 
¡»am
.
	`şo£
();

279 
EÁ™yUts
.
	`cÚsumeQu›y
(
»¥Ú£EÁ™y
);

280 
»¥Ú£
.
	`şo£
();

281 
ş›Á
.
	`şo£
();

282 
throw
 
Ãw
 
	`TimeoutExû±iÚ
();

284 
»¥Ú£CÚ‹Á
.
	`­³nd
(
lše
);

286 
tim”
.
	`š‹¼u±
();

288 
¡»am
.
	`şo£
();

290 
EÁ™yUts
.
	`cÚsumeQu›y
(
»¥Ú£EÁ™y
);

291 
»¥Ú£
.
	`şo£
();

292 
ş›Á
.
	`şo£
();

293  
»¥Ú£Code
;

294 
	}
}

296 
´iv©e
 
	$h‰pD–‘e
(
SŒšg
 
’dpošt
è
throws
 
IOExû±iÚ
 {

297 
»que¡Timedout
.
	`£tIsS©isf›d
(
çl£
);

298 
Th»ad
 
tim”
 = 
Ãw
 
	`Th»ad
Òew 
	`Tim”
(
execTimeout
, 
»que¡Timedout
));

299 
tim”
.
	`¡¬t
();

300 
»¥Ú£Code
 = 200;

301 
H‰pD–‘e
 
»que¡
 = 
Ãw
 
	`H‰pD–‘e
(
’dpošt
);

302 
i
 = 0; i < 
h—d”s
.
Ëngth
; i = i + 2) {

303 
»que¡
.
	`£tH—d”
(
h—d”s
[
i
], headers[i + 1]);

305 
Clo£abËH‰pRe¥Ú£
 
»¥Ú£
 = 
ş›Á
.
	`execu‹
(
»que¡
);

306 
»¥Ú£Code
 = 
»¥Ú£
.
	`g‘StusLše
().
	`g‘StusCode
();

307 
»¥Ú£
.
	`şo£
();

308 
ş›Á
.
	`şo£
();

309  
»¥Ú£Code
;

310 
	}
}

315 şas 
	cTim”
 
im¶em’ts
 
	gRuÂabË
 {

317 
´iv©e
 
	gtimeout
;

318 
´iv©e
 
Cr™”Ÿ
 
	gtimedout
;

320 
public
 
Tim”
(
timeout
, 
Cr™”Ÿ
 
timedout
) {

321 
	gthis
.
	gtimedout
 = 
timedout
;

322 
	gthis
.
	gtimeout
 = 
timeout
;

325 @
Ov”ride


326 
public
 
run
() {

327 
	gŒy
 {

328 
	gTh»ad
.
¦“p
(
timeout
);

329 
	gthis
.
	gtimedout
.
£tIsS©isf›d
(
Œue
);

330 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

340 şas 
	cCr™”Ÿ
 {

342 
´iv©e
 
boŞ—n
 
	gisS©isf›d
;

344 
public
 
Cr™”Ÿ
(
boŞ—n
 
isS©isf›d
) {

345 
	gthis
.
	gisS©isf›d
 = 
isS©isf›d
;

348 
public
 
boŞ—n
 
isS©isf›d
() {

349  
	gisS©isf›d
;

352 
public
 
£tIsS©isf›d
(
boŞ—n
 
§tisf›d
) {

353 
	gthis
.
	gisS©isf›d
 = 
§tisf›d
;

361 şas 
	cTimeoutExû±iÚ
 
ex‹nds
 
	gRuÁimeExû±iÚ
 {

363 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 1L;

365 
public
 
TimeoutExû±iÚ
() {

366 
su³r
("HTTP Requestƒxceededƒxecutionime†imit.");

	@rest/src/main/java/site/ycsb/webservice/rest/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gweb£rviû
.
	g»¡
;

	@rest/src/test/java/site/ycsb/webservice/rest/IntegrationTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gweb£rviû
.
	g»¡
;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

22 
impÜt
 
	gjava
.
	gio
.
	gFe
;

23 
impÜt
 
	gjava
.
	gio
.
	gFeNÙFoundExû±iÚ
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

27 
impÜt
 
	gjavax
.
	g£rvËt
.
	gS”vËtExû±iÚ
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	gÿlša
.
	gCÚ‹xt
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gÿlša
.
	gLiãcyşeExû±iÚ
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	gÿlša
.
	g¡¬tup
.
	gTomÿt
;

32 
impÜt
 
	gÜg
.
	ggÏssfish
.
	gj”£y
.
	g£rv”
.
	gResourûCÚfig
;

33 
impÜt
 
	gÜg
.
	ggÏssfish
.
	gj”£y
.
	g£rvËt
.
	gS”vËtCÚš”
;

34 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

35 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

36 
impÜt
 
	gÜg
.
	gjun™
.
	gFixM‘hodOrd”
;

37 
impÜt
 
	gÜg
.
	gjun™
.
	gRuË
;

38 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

39 
impÜt
 
	gÜg
.
	gjun™
.
	gcÚŒib
.
	gjava
.
	gÏng
.
	gsy¡em
.
	gAs£¹iÚ
;

40 
impÜt
 
	gÜg
.
	gjun™
.
	gcÚŒib
.
	gjava
.
	gÏng
.
	gsy¡em
.
	gEx³ùedSy¡emEx™
;

41 
impÜt
 
	gÜg
.
	gjun™
.
	gruÂ”s
.
	gM‘hodSÜ‹rs
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

45 
impÜt
 
	gs™e
.
	gycsb
.
	gweb£rviû
.
	g»¡
.
	gUts
;

57 @
	$FixM‘hodOrd”
(
M‘hodSÜ‹rs
.
NAME_ASCENDING
)

58 
public
 cÏs 
	cIÁeg¿tiÚTe¡
 {

60 @
RuË


61 
public
 
fš®
 
Ex³ùedSy¡emEx™
 
ex™
 = Ex³ùedSy¡emEx™.
	`nÚe
();

63 
´iv©e
 
pÜt
 = 8080;

64 
´iv©e
 
Tomÿt
 
tomÿt
;

65 
´iv©e
 
fš®
 
SŒšg
 
WORKLOAD_FILEPATH
 = 
IÁeg¿tiÚTe¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("wÜklßd_»¡").
	`g‘P©h
();

66 
´iv©e
 
fš®
 
SŒšg
 
TRACE_FILEPATH
 = 
IÁeg¿tiÚTe¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("Œaû.txt").
	`g‘P©h
();

67 
´iv©e
 
fš®
 
SŒšg
 
ERROR_TRACE_FILEPATH
 = 
IÁeg¿tiÚTe¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("”rÜ_Œaû.txt").
	`g‘P©h
();

68 
´iv©e
 
fš®
 
SŒšg
 
RESULTS_FILEPATH
 = 
IÁeg¿tiÚTe¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
(".").
	`g‘P©h
() + "results.txt";

70 @
BefÜeCÏss


71 
public
 
	$š™
(è
throws
 
S”vËtExû±iÚ
, 
LiãcyşeExû±iÚ
, 
FeNÙFoundExû±iÚ
, 
IOExû±iÚ
,

72 
DBExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

73 
SŒšg
 
web­pDœLoÿtiÚ
 = 
IÁeg¿tiÚTe¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("WebCÚ‹Á").
	`g‘P©h
();

74 !
Uts
.
	`avaabË
(
pÜt
)) {

75 
pÜt
++;

77 
tomÿt
 = 
Ãw
 
	`Tomÿt
();

78 
tomÿt
.
	`£tPÜt
(
IÁeg”
.
	`v®ueOf
(
pÜt
));

79 
CÚ‹xt
 
cÚ‹xt
 = 
tomÿt
.
	`addWeb­p
("/webS”viû", 
Ãw
 
	`Fe
(
web­pDœLoÿtiÚ
).
	`g‘AbsŞu‹P©h
());

80 
Tomÿt
.
	`addS”vËt
(
cÚ‹xt
, "j”£y-cÚš”-£rvËt", 
	`»sourûCÚfig
());

81 
cÚ‹xt
.
	`addS”vËtM­pšg
("/rest/*", "jersey-container-servlet");

82 
tomÿt
.
	`¡¬t
();

84 
Th»ad
.
	`¦“p
(1000);

87 @
Aá”CÏss


88 
public
 
	$ş—nUp
(è
throws
 
LiãcyşeExû±iÚ
 {

89 
tomÿt
.
	`¡İ
();

90 
	}
}

93 @
Te¡


94 
public
 
	$‹¡R—dOpsB’chm¬kSucûss
(è
throws
 
IÁ”ru±edExû±iÚ
 {

95 
ex™
.
	`ex³ùSy¡emEx™
();

96 
ex™
.
	`checkAs£¹iÚAá”w¬ds
(
Ãw
 
	`As£¹iÚ
() {

97 @
Ov”ride


98 
public
 
	`checkAs£¹iÚ
(è
throws
 
Exû±iÚ
 {

99 
Li¡
<
SŒšg
> 
»suÉs
 = 
Uts
.
	`»ad
(
RESULTS_FILEPATH
);

100 
	`as£¹Equ®s
(
Œue
, 
»suÉs
.
	`cÚšs
("[READ], Return=OK, 1"));

101 
Uts
.
	`d–‘e
(
RESULTS_FILEPATH
);

104 
Cl›Á
.
	`maš
(
	`g‘Args
(
TRACE_FILEPATH
, 1, 0, 0, 0));

105 
	}
}

108 @
Te¡


109 
public
 
	$‹¡R—dOpsB’chm¬kFau»
(è
throws
 
IÁ”ru±edExû±iÚ
 {

110 
ex™
.
	`ex³ùSy¡emEx™
();

111 
ex™
.
	`checkAs£¹iÚAá”w¬ds
(
Ãw
 
	`As£¹iÚ
() {

112 @
Ov”ride


113 
public
 
	`checkAs£¹iÚ
(è
throws
 
Exû±iÚ
 {

114 
Li¡
<
SŒšg
> 
»suÉs
 = 
Uts
.
	`»ad
(
RESULTS_FILEPATH
);

115 
	`as£¹Equ®s
(
Œue
, 
»suÉs
.
	`cÚšs
("[READ], Return=ERROR, 1"));

116 
Uts
.
	`d–‘e
(
RESULTS_FILEPATH
);

119 
Cl›Á
.
	`maš
(
	`g‘Args
(
ERROR_TRACE_FILEPATH
, 1, 0, 0, 0));

120 
	}
}

123 @
Te¡


124 
public
 
	$‹¡In£¹OpsB’chm¬kSucûss
(è
throws
 
IÁ”ru±edExû±iÚ
 {

125 
ex™
.
	`ex³ùSy¡emEx™
();

126 
ex™
.
	`checkAs£¹iÚAá”w¬ds
(
Ãw
 
	`As£¹iÚ
() {

127 @
Ov”ride


128 
public
 
	`checkAs£¹iÚ
(è
throws
 
Exû±iÚ
 {

129 
Li¡
<
SŒšg
> 
»suÉs
 = 
Uts
.
	`»ad
(
RESULTS_FILEPATH
);

130 
	`as£¹Equ®s
(
Œue
, 
»suÉs
.
	`cÚšs
("[INSERT], Return=OK, 1"));

131 
Uts
.
	`d–‘e
(
RESULTS_FILEPATH
);

134 
Cl›Á
.
	`maš
(
	`g‘Args
(
TRACE_FILEPATH
, 0, 1, 0, 0));

135 
	}
}

138 @
Te¡


139 
public
 
	$‹¡In£¹OpsB’chm¬kFau»
(è
throws
 
IÁ”ru±edExû±iÚ
 {

140 
ex™
.
	`ex³ùSy¡emEx™
();

141 
ex™
.
	`checkAs£¹iÚAá”w¬ds
(
Ãw
 
	`As£¹iÚ
() {

142 @
Ov”ride


143 
public
 
	`checkAs£¹iÚ
(è
throws
 
Exû±iÚ
 {

144 
Li¡
<
SŒšg
> 
»suÉs
 = 
Uts
.
	`»ad
(
RESULTS_FILEPATH
);

145 
	`as£¹Equ®s
(
Œue
, 
»suÉs
.
	`cÚšs
("[INSERT], Return=ERROR, 1"));

146 
Uts
.
	`d–‘e
(
RESULTS_FILEPATH
);

149 
Cl›Á
.
	`maš
(
	`g‘Args
(
ERROR_TRACE_FILEPATH
, 0, 1, 0, 0));

150 
	}
}

153 @
Te¡


154 
public
 
	$‹¡Upd©eOpsB’chm¬kSucûss
(è
throws
 
IÁ”ru±edExû±iÚ
 {

155 
ex™
.
	`ex³ùSy¡emEx™
();

156 
ex™
.
	`checkAs£¹iÚAá”w¬ds
(
Ãw
 
	`As£¹iÚ
() {

157 @
Ov”ride


158 
public
 
	`checkAs£¹iÚ
(è
throws
 
Exû±iÚ
 {

159 
Li¡
<
SŒšg
> 
»suÉs
 = 
Uts
.
	`»ad
(
RESULTS_FILEPATH
);

160 
	`as£¹Equ®s
(
Œue
, 
»suÉs
.
	`cÚšs
("[UPDATE], Return=OK, 1"));

161 
Uts
.
	`d–‘e
(
RESULTS_FILEPATH
);

164 
Cl›Á
.
	`maš
(
	`g‘Args
(
TRACE_FILEPATH
, 0, 0, 1, 0));

165 
	}
}

168 @
Te¡


169 
public
 
	$‹¡Upd©eOpsB’chm¬kFau»
(è
throws
 
IÁ”ru±edExû±iÚ
 {

170 
ex™
.
	`ex³ùSy¡emEx™
();

171 
ex™
.
	`checkAs£¹iÚAá”w¬ds
(
Ãw
 
	`As£¹iÚ
() {

172 @
Ov”ride


173 
public
 
	`checkAs£¹iÚ
(è
throws
 
Exû±iÚ
 {

174 
Li¡
<
SŒšg
> 
»suÉs
 = 
Uts
.
	`»ad
(
RESULTS_FILEPATH
);

175 
	`as£¹Equ®s
(
Œue
, 
»suÉs
.
	`cÚšs
("[UPDATE], Return=ERROR, 1"));

176 
Uts
.
	`d–‘e
(
RESULTS_FILEPATH
);

179 
Cl›Á
.
	`maš
(
	`g‘Args
(
ERROR_TRACE_FILEPATH
, 0, 0, 1, 0));

180 
	}
}

183 @
Te¡


184 
public
 
	$‹¡D–‘eOpsB’chm¬kSucûss
(è
throws
 
IÁ”ru±edExû±iÚ
 {

185 
ex™
.
	`ex³ùSy¡emEx™
();

186 
ex™
.
	`checkAs£¹iÚAá”w¬ds
(
Ãw
 
	`As£¹iÚ
() {

187 @
Ov”ride


188 
public
 
	`checkAs£¹iÚ
(è
throws
 
Exû±iÚ
 {

189 
Li¡
<
SŒšg
> 
»suÉs
 = 
Uts
.
	`»ad
(
RESULTS_FILEPATH
);

190 
	`as£¹Equ®s
(
Œue
, 
»suÉs
.
	`cÚšs
("[DELETE], Return=OK, 1"));

191 
Uts
.
	`d–‘e
(
RESULTS_FILEPATH
);

194 
Cl›Á
.
	`maš
(
	`g‘Args
(
TRACE_FILEPATH
, 0, 0, 0, 1));

195 
	}
}

198 @
Te¡


199 
public
 
	$‹¡D–‘eOpsB’chm¬kFau»
(è
throws
 
IÁ”ru±edExû±iÚ
 {

200 
ex™
.
	`ex³ùSy¡emEx™
();

201 
ex™
.
	`checkAs£¹iÚAá”w¬ds
(
Ãw
 
	`As£¹iÚ
() {

202 @
Ov”ride


203 
public
 
	`checkAs£¹iÚ
(è
throws
 
Exû±iÚ
 {

204 
Li¡
<
SŒšg
> 
»suÉs
 = 
Uts
.
	`»ad
(
RESULTS_FILEPATH
);

205 
	`as£¹Equ®s
(
Œue
, 
»suÉs
.
	`cÚšs
("[DELETE], Return=ERROR, 1"));

206 
Uts
.
	`d–‘e
(
RESULTS_FILEPATH
);

209 
Cl›Á
.
	`maš
(
	`g‘Args
(
ERROR_TRACE_FILEPATH
, 0, 0, 0, 1));

210 
	}
}

212 
´iv©e
 
	gSŒšg
[] 
	$g‘Args
(
SŒšg
 
ŒaûFeP©h
, 
½
, 

, 
up
, 
dp
) {

213 
SŒšg
[] 
¬gs
 = 
Ãw
 String[25];

214 
¬gs
[0] = "-target";

215 
¬gs
[1] = "1";

216 
¬gs
[2] = "-t";

217 
¬gs
[3] = "-P";

218 
¬gs
[4] = 
WORKLOAD_FILEPATH
;

219 
¬gs
[5] = "-p";

220 
¬gs
[6] = "u¾.´efix=h‰p://127.0.0.1:"+
pÜt
+"/webService/rest/resource/";

221 
¬gs
[7] = "-p";

222 
¬gs
[8] = "u¾.Œaû.»ad=" + 
ŒaûFeP©h
;

223 
¬gs
[9] = "-p";

224 
¬gs
[10] = "u¾.Œaû.š£¹=" + 
ŒaûFeP©h
;

225 
¬gs
[11] = "-p";

226 
¬gs
[12] = "u¾.Œaû.upd©e=" + 
ŒaûFeP©h
;

227 
¬gs
[13] = "-p";

228 
¬gs
[14] = "u¾.Œaû.d–‘e=" + 
ŒaûFeP©h
;

229 
¬gs
[15] = "-p";

230 
¬gs
[16] = "expÜtfe=" + 
RESULTS_FILEPATH
;

231 
¬gs
[17] = "-p";

232 
¬gs
[18] = "»ad´İÜtiÚ=" + 
½
;

233 
¬gs
[19] = "-p";

234 
¬gs
[20] = "upd©•rİÜtiÚ=" + 
up
;

235 
¬gs
[21] = "-p";

236 
¬gs
[22] = "d–‘•rİÜtiÚ=" + 
dp
;

237 
¬gs
[23] = "-p";

238 
¬gs
[24] = "š£¹´İÜtiÚ=" + 

;

239  
¬gs
;

240 
	}
}

242 
´iv©e
 
S”vËtCÚš”
 
	$»sourûCÚfig
() {

243  
Ãw
 
	`S”vËtCÚš”
Òew 
	`ResourûCÚfig
Òew 
	`ResourûLßd”
().
	`g‘CÏs£s
()));

244 
	}
}

	@rest/src/test/java/site/ycsb/webservice/rest/ResourceLoader.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gweb£rviû
.
	g»¡
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

23 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gcÜe
.
	gAµliÿtiÚ
;

29 
public
 cÏs 
	cResourûLßd”
 
ex‹nds
 
	mAµliÿtiÚ
 {

31 @
Ov”ride


32 
public
 
	mS‘
<
	mCÏss
<?>> 
	$g‘CÏs£s
() {

33 
fš®
 
S‘
<
CÏss
<?>> 
şas£s
 = 
Ãw
 
HashS‘
<Class<?>>();

34 
şas£s
.
	`add
(
Re¡Te¡Resourû
.
şass
);

35  
şas£s
;

38 
	}
}

	@rest/src/test/java/site/ycsb/webservice/rest/RestClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gweb£rviû
.
	g»¡
;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

22 
impÜt
 
	gjava
.
	gio
.
	gFe
;

23 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

28 
impÜt
 
	gjavax
.
	g£rvËt
.
	gS”vËtExû±iÚ
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gÿlša
.
	gCÚ‹xt
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	gÿlša
.
	gLiãcyşeExû±iÚ
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	gÿlša
.
	g¡¬tup
.
	gTomÿt
;

33 
impÜt
 
	gÜg
.
	ggÏssfish
.
	gj”£y
.
	g£rv”
.
	gResourûCÚfig
;

34 
impÜt
 
	gÜg
.
	ggÏssfish
.
	gj”£y
.
	g£rvËt
.
	gS”vËtCÚš”
;

35 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

36 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

37 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

54 
public
 cÏs 
	cRe¡Cl›ÁTe¡
 {

56 
´iv©e
 
IÁeg”
 
	mpÜt
 = 8080;

57 
´iv©e
 
Tomÿt
 
	mtomÿt
;

58 
´iv©e
 
Re¡Cl›Á
 
	mrc
 = 
Ãw
 RestClient();

59 
´iv©e
 
fš®
 
SŒšg
 
	mRESPONSE_TAG
 = "response";

60 
´iv©e
 
fš®
 
SŒšg
 
	mDATA_TAG
 = "data";

61 
´iv©e
 
fš®
 
SŒšg
 
	mVALID_RESOURCE
 = "resource_valid";

62 
´iv©e
 
fš®
 
SŒšg
 
	mINVALID_RESOURCE
 = "resource_invalid";

63 
´iv©e
 
fš®
 
SŒšg
 
	mABSENT_RESOURCE
 = "resource_absent";

64 
´iv©e
 
fš®
 
SŒšg
 
	mUNAUTHORIZED_RESOURCE
 = "resource_unauthorized";

65 
´iv©e
 
fš®
 
SŒšg
 
	mINPUT_DATA
 = "<field1>one</field1><field2>two</field2>";

67 @
BefÜeCÏss


68 
public
 
	$š™
(è
throws
 
IOExû±iÚ
, 
DBExû±iÚ
, 
S”vËtExû±iÚ
, 
LiãcyşeExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

69 
SŒšg
 
web­pDœLoÿtiÚ
 = 
IÁeg¿tiÚTe¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("WebCÚ‹Á").
	`g‘P©h
();

70 !
Uts
.
	`avaabË
(
pÜt
)) {

71 
pÜt
++;

73 
tomÿt
 = 
Ãw
 
	`Tomÿt
();

74 
tomÿt
.
	`£tPÜt
(
IÁeg”
.
	`v®ueOf
(
pÜt
));

75 
CÚ‹xt
 
cÚ‹xt
 = 
tomÿt
.
	`addWeb­p
("/webS”viû", 
Ãw
 
	`Fe
(
web­pDœLoÿtiÚ
).
	`g‘AbsŞu‹P©h
());

76 
Tomÿt
.
	`addS”vËt
(
cÚ‹xt
, "j”£y-cÚš”-£rvËt", 
	`»sourûCÚfig
());

77 
cÚ‹xt
.
	`addS”vËtM­pšg
("/rest/*", "jersey-container-servlet");

78 
tomÿt
.
	`¡¬t
();

80 
Th»ad
.
	`¦“p
(1000);

81 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

82 
´İs
.
	`lßd
(
Ãw
 
	`FeR—d”
(
Re¡Cl›ÁTe¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("wÜklßd_»¡").
	`g‘P©h
()));

84 
´İs
.
	`£tPrİ”ty
("u¾.´efix",…rİs.
	`g‘Prİ”ty
("u¾.´efix").
	`»¶aûAÎ
("PORT", 
pÜt
.
	`toSŒšg
()));

85 
rc
.
	`£tPrİ”t›s
(
´İs
);

86 
rc
.
	`š™
();

89 @
Aá”CÏss


90 
public
 
	$ş—nUp
(è
throws
 
DBExû±iÚ
 {

91 
rc
.
	`ş—nup
();

92 
	}
}

95 @
Te¡


96 
public
 
	$»ad_200
() {

97 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

98 
Stus
 
¡©us
 = 
rc
.
	`»ad
(
nuÎ
, 
VALID_RESOURCE
,‚uÎ, 
»suÉ
);

99 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

100 
	`as£¹Equ®s
(
»suÉ
.
	`g‘
(
RESPONSE_TAG
).
	`toSŒšg
(), "HTTP GET„e¥Ú£o: "+ 
VALID_RESOURCE
);

101 
	}
}

104 @
Te¡


105 
public
 
	$»ad_403
() {

106 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

107 
Stus
 
¡©us
 = 
rc
.
	`»ad
(
nuÎ
, 
UNAUTHORIZED_RESOURCE
,‚uÎ, 
»suÉ
);

108 
	`as£¹Equ®s
(
Stus
.
FORBIDDEN
, 
¡©us
);

109 
	}
}

112 @
Te¡


113 
public
 
	$»ad_404
() {

114 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

115 
Stus
 
¡©us
 = 
rc
.
	`»ad
(
nuÎ
, 
ABSENT_RESOURCE
,‚uÎ, 
»suÉ
);

116 
	`as£¹Equ®s
(
Stus
.
NOT_FOUND
, 
¡©us
);

117 
	}
}

120 @
Te¡


121 
public
 
	$»ad_500
() {

122 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

123 
Stus
 
¡©us
 = 
rc
.
	`»ad
(
nuÎ
, 
INVALID_RESOURCE
,‚uÎ, 
»suÉ
);

124 
	`as£¹Equ®s
(
Stus
.
ERROR
, 
¡©us
);

125 
	}
}

128 @
Te¡


129 
public
 
	$š£¹_200
() {

130 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
d©a
 = 
Ãw
 HashMap<String, ByteIterator>();

131 
d©a
.
	`put
(
DATA_TAG
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
INPUT_DATA
));

132 
Stus
 
¡©us
 = 
rc
.
	`š£¹
(
nuÎ
, 
VALID_RESOURCE
, 
d©a
);

133 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

134 
	}
}

136 @
Te¡


137 
public
 
	$š£¹_403
() {

138 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
d©a
 = 
Ãw
 HashMap<String, ByteIterator>();

139 
d©a
.
	`put
(
DATA_TAG
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
INPUT_DATA
));

140 
Stus
 
¡©us
 = 
rc
.
	`š£¹
(
nuÎ
, 
UNAUTHORIZED_RESOURCE
, 
d©a
);

141 
	`as£¹Equ®s
(
Stus
.
FORBIDDEN
, 
¡©us
);

142 
	}
}

144 @
Te¡


145 
public
 
	$š£¹_404
() {

146 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
d©a
 = 
Ãw
 HashMap<String, ByteIterator>();

147 
d©a
.
	`put
(
DATA_TAG
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
INPUT_DATA
));

148 
Stus
 
¡©us
 = 
rc
.
	`š£¹
(
nuÎ
, 
ABSENT_RESOURCE
, 
d©a
);

149 
	`as£¹Equ®s
(
Stus
.
NOT_FOUND
, 
¡©us
);

150 
	}
}

152 @
Te¡


153 
public
 
	$š£¹_500
() {

154 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
d©a
 = 
Ãw
 HashMap<String, ByteIterator>();

155 
d©a
.
	`put
(
DATA_TAG
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
INPUT_DATA
));

156 
Stus
 
¡©us
 = 
rc
.
	`š£¹
(
nuÎ
, 
INVALID_RESOURCE
, 
d©a
);

157 
	`as£¹Equ®s
(
Stus
.
ERROR
, 
¡©us
);

158 
	}
}

161 @
Te¡


162 
public
 
	$d–‘e_200
() {

163 
Stus
 
¡©us
 = 
rc
.
	`d–‘e
(
nuÎ
, 
VALID_RESOURCE
);

164 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

165 
	}
}

167 @
Te¡


168 
public
 
	$d–‘e_403
() {

169 
Stus
 
¡©us
 = 
rc
.
	`d–‘e
(
nuÎ
, 
UNAUTHORIZED_RESOURCE
);

170 
	`as£¹Equ®s
(
Stus
.
FORBIDDEN
, 
¡©us
);

171 
	}
}

173 @
Te¡


174 
public
 
	$d–‘e_404
() {

175 
Stus
 
¡©us
 = 
rc
.
	`d–‘e
(
nuÎ
, 
ABSENT_RESOURCE
);

176 
	`as£¹Equ®s
(
Stus
.
NOT_FOUND
, 
¡©us
);

177 
	}
}

179 @
Te¡


180 
public
 
	$d–‘e_500
() {

181 
Stus
 
¡©us
 = 
rc
.
	`d–‘e
(
nuÎ
, 
INVALID_RESOURCE
);

182 
	`as£¹Equ®s
(
Stus
.
ERROR
, 
¡©us
);

183 
	}
}

185 @
Te¡


186 
public
 
	$upd©e_200
() {

187 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
d©a
 = 
Ãw
 HashMap<String, ByteIterator>();

188 
d©a
.
	`put
(
DATA_TAG
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
INPUT_DATA
));

189 
Stus
 
¡©us
 = 
rc
.
	`upd©e
(
nuÎ
, 
VALID_RESOURCE
, 
d©a
);

190 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

191 
	}
}

193 @
Te¡


194 
public
 
	$upd©e_403
() {

195 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
d©a
 = 
Ãw
 HashMap<String, ByteIterator>();

196 
d©a
.
	`put
(
DATA_TAG
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
INPUT_DATA
));

197 
Stus
 
¡©us
 = 
rc
.
	`upd©e
(
nuÎ
, 
UNAUTHORIZED_RESOURCE
, 
d©a
);

198 
	`as£¹Equ®s
(
Stus
.
FORBIDDEN
, 
¡©us
);

199 
	}
}

201 @
Te¡


202 
public
 
	$upd©e_404
() {

203 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
d©a
 = 
Ãw
 HashMap<String, ByteIterator>();

204 
d©a
.
	`put
(
DATA_TAG
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
INPUT_DATA
));

205 
Stus
 
¡©us
 = 
rc
.
	`upd©e
(
nuÎ
, 
ABSENT_RESOURCE
, 
d©a
);

206 
	`as£¹Equ®s
(
Stus
.
NOT_FOUND
, 
¡©us
);

207 
	}
}

209 @
Te¡


210 
public
 
	$upd©e_500
() {

211 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
d©a
 = 
Ãw
 HashMap<String, ByteIterator>();

212 
d©a
.
	`put
(
DATA_TAG
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
INPUT_DATA
));

213 
Stus
 
¡©us
 = 
rc
.
	`upd©e
(
nuÎ
, 
INVALID_RESOURCE
, 
d©a
);

214 
	`as£¹Equ®s
(
Stus
.
ERROR
, 
¡©us
);

215 
	}
}

217 @
Te¡


218 
public
 
	$sÿn
() {

219 
	`as£¹Equ®s
(
Stus
.
NOT_IMPLEMENTED
, 
rc
.
	`sÿn
(
nuÎ
,‚ull, 0,‚ull,‚ull));

220 
	}
}

222 
´iv©e
 
S”vËtCÚš”
 
	$»sourûCÚfig
() {

223  
Ãw
 
	`S”vËtCÚš”
Òew 
	`ResourûCÚfig
Òew 
	`ResourûLßd”
().
	`g‘CÏs£s
()));

224 
	}
}

	@rest/src/test/java/site/ycsb/webservice/rest/RestTestResource.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gweb£rviû
.
	g»¡
;

20 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gDELETE
;

21 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gGET
;

22 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gH‰pM‘hod
;

23 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gPOST
;

24 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gPUT
;

25 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gP©h
;

26 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gP©hP¬am
;

27 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gProduûs
;

28 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gcÜe
.
	gMedŸTy³
;

29 
impÜt
 
	gjavax
.
	gws
.
	grs
.
	gcÜe
.
	gRe¥Ú£
;

35 @
P©h
("/resource/{id}")

36 
public
 cÏs 
	cRe¡Te¡Resourû
 {

38 @
	mGET


39 @
	$Produûs
(
MedŸTy³
.
TEXT_PLAIN
)

40 
public
 
Re¥Ú£
 
	`»¥ÚdToGET
(@
	`P©hP¬am
("id"è
SŒšg
 
id
) {

41  
	`´oûssReque¡s
(
id
, 
H‰pM‘hod
.
GET
);

44 @
POST


45 @
	$Produûs
(
MedŸTy³
.
TEXT_PLAIN
)

46 
public
 
Re¥Ú£
 
	`»¥ÚdToPOST
(@
	`P©hP¬am
("id"è
SŒšg
 
id
) {

47  
	`´oûssReque¡s
(
id
, 
H‰pM‘hod
.
POST
);

48 
	}
}

50 @
	gDELETE


51 @
	$Produûs
(
MedŸTy³
.
TEXT_PLAIN
)

52 
public
 
Re¥Ú£
 
	`»¥ÚdToDELETE
(@
	`P©hP¬am
("id"è
SŒšg
 
id
) {

53  
	`´oûssReque¡s
(
id
, 
H‰pM‘hod
.
DELETE
);

54 
	}
}

56 @
	gPUT


57 @
	$Produûs
(
MedŸTy³
.
TEXT_PLAIN
)

58 
public
 
Re¥Ú£
 
	`»¥ÚdToPUT
(@
	`P©hP¬am
("id"è
SŒšg
 
id
) {

59  
	`´oûssReque¡s
(
id
, 
H‰pM‘hod
.
PUT
);

60 
	}
}

62 
´iv©e
 
Re¥Ú£
 
	$´oûssReque¡s
(
SŒšg
 
id
, SŒšg 
m‘hod
) {

63 ià(
id
.
	`equ®s
("resource_invalid"))

64  
Re¥Ú£
.
	`£rv”E¼Ü
().
	`bud
();

65 ià(
id
.
	`equ®s
("resource_absent"))

66  
Re¥Ú£
.
	`¡©us
(Re¥Ú£.
Stus
.
NOT_FOUND
).
	`bud
();

67 ià(
id
.
	`equ®s
("resource_unauthorized"))

68  
Re¥Ú£
.
	`¡©us
(Re¥Ú£.
Stus
.
FORBIDDEN
).
	`bud
();

69  
Re¥Ú£
.
	`ok
("HTTP " + 
m‘hod
 + "„e¥Ú£o: " + 
id
).
	`bud
();

70 
	}
}

	@rest/src/test/java/site/ycsb/webservice/rest/Utils.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gweb£rviû
.
	g»¡
;

20 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

21 
impÜt
 
	gjava
.
	gio
.
	gFe
;

22 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gÃt
.
	gD©ag¿mSock‘
;

25 
impÜt
 
	gjava
.
	gÃt
.
	gS”v”Sock‘
;

26 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

27 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

32 
public
 cÏs 
	cUts
 {

40 
public
 
boŞ—n
 
	$avaabË
(
pÜt
) {

41 
S”v”Sock‘
 
ss
 = 
nuÎ
;

42 
D©ag¿mSock‘
 
ds
 = 
nuÎ
;

43 
Œy
 {

44 
ss
 = 
Ãw
 
	`S”v”Sock‘
(
pÜt
);

45 
ss
.
	`£tReu£Add»ss
(
Œue
);

46 
ds
 = 
Ãw
 
	`D©ag¿mSock‘
(
pÜt
);

47 
ds
.
	`£tReu£Add»ss
(
Œue
);

48  
Œue
;

49 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

50 } 
fš®ly
 {

51 ià(
ds
 !ğ
nuÎ
) {

52 
ds
.
	`şo£
();

54 ià(
ss
 !ğ
nuÎ
) {

55 
Œy
 {

56 
ss
.
	`şo£
();

57 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

62  
çl£
;

65 
public
 
Li¡
<
SŒšg
> 
	$»ad
(
SŒšg
 
f•©h
) {

66 
Li¡
<
SŒšg
> 
li¡
 = 
Ãw
 
A¼ayLi¡
<String>();

67 
Œy
 {

68 
Bufã»dR—d”
 
fe
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`FeR—d”
(
f•©h
));

69 
SŒšg
 
lše
 = 
nuÎ
;

70 (
lše
 = 
fe
.
	`»adLše
()è!ğ
nuÎ
) {

71 
li¡
.
	`add
(
lše
.
	`Œim
());

73 
fe
.
	`şo£
();

74 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

75 
e
.
	`´štSckT¿û
();

77  
li¡
;

78 
	}
}

80 
public
 
	$d–‘e
(
SŒšg
 
f•©h
) {

81 
Œy
 {

82 
Ãw
 
	`Fe
(
f•©h
).
	`d–‘e
();

83 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

84 
e
.
	`´štSckT¿û
();

86 
	}
}

	@riak/src/main/java/site/ycsb/db/riak/RiakKVClient.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	grŸk
;

21 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	g­i
.
	gcommªds
.
	gbuck‘s
.
	gStÜeBuck‘Prİ”t›s
;

22 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	g­i
.
	gcommªds
.
	gkv
.
	gStÜeV®ue
;

23 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	g­i
.
	gcommªds
.
	gkv
.
	gUpd©eV®ue
;

24 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	gcÜe
.
	gRŸkFutu»
;

25 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	gcÜe
.
	gqu”y
.
	gRŸkObjeù
;

26 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	gcÜe
.
	gqu”y
.
	gšdexes
.
	gLÚgIÁIndex
;

27 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	gcÜe
.
	gut
.
	gBš¬yV®ue
;

28 
impÜt
 
	gs™e
.
	gycsb
.*;

30 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

31 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

32 
impÜt
 
	gjava
.
	gut
.*;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

36 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	g­i
.
	gRŸkCl›Á
;

37 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	g­i
.
	gÿp
.
	gQuÜum
;

38 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	g­i
.
	gcommªds
.
	gšdexes
.
	gIÁIndexQu”y
;

39 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	g­i
.
	gcommªds
.
	gkv
.
	gD–‘eV®ue
;

40 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	g­i
.
	gcommªds
.
	gkv
.
	gF‘chV®ue
;

41 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	gcÜe
.
	gRŸkClu¡”
;

42 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	gcÜe
.
	gRŸkNode
;

43 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	gcÜe
.
	gqu”y
.
	gLoÿtiÚ
;

44 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	gcÜe
.
	gqu”y
.
	gName¥aû
;

46 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	grŸk
.
	gRŸkUts
.
	gü—‹ResuÉHashM­
;

47 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	grŸk
.
	gRŸkUts
.
	gg‘KeyAsLÚg
;

48 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	grŸk
.
	gRŸkUts
.
	g£rŸlizeTabË
;

54 
public
 cÏs 
	cRŸkKVCl›Á
 
ex‹nds
 
	mDB
 {

55 
´iv©e
 
fš®
 
SŒšg
 
	mHOST_PROPERTY
 = "riak.hosts";

56 
´iv©e
 
fš®
 
SŒšg
 
	mPORT_PROPERTY
 = "riak.port";

57 
´iv©e
 
fš®
 
SŒšg
 
	mBUCKET_TYPE_PROPERTY
 = "riak.bucket_type";

58 
´iv©e
 
fš®
 
SŒšg
 
	mR_VALUE_PROPERTY
 = "riak.r_val";

59 
´iv©e
 
fš®
 
SŒšg
 
	mW_VALUE_PROPERTY
 = "riak.w_val";

60 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_RETRY_COUNT_PROPERTY
 = "riak.read_retry_count";

61 
´iv©e
 
fš®
 
SŒšg
 
	mWAIT_TIME_BEFORE_RETRY_PROPERTY
 = "riak.wait_time_before_retry";

62 
´iv©e
 
fš®
 
SŒšg
 
	mTRANSACTION_TIME_LIMIT_PROPERTY
 = "riak.transaction_time_limit";

63 
´iv©e
 
fš®
 
SŒšg
 
	mSTRONG_CONSISTENCY_PROPERTY
 = "riak.strong_consistency";

64 
´iv©e
 
fš®
 
SŒšg
 
	mSTRONG_CONSISTENT_SCANS_BUCKET_TYPE_PROPERTY
 = "riak.strong_consistent_scans_bucket_type";

65 
´iv©e
 
fš®
 
SŒšg
 
	mDEBUG_PROPERTY
 = "riak.debug";

67 
´iv©e
 
fš®
 
Stus
 
	mTIME_OUT
 = 
Ãw
 Status("TIME_OUT", "Cluster didn't„espond‡fter maximum waitime.");

69 
´iv©e
 
	mSŒšg
[] 
	mho¡s
;

70 
´iv©e
 
	mpÜt
;

71 
´iv©e
 
SŒšg
 
	mbuck‘Ty³
;

72 
´iv©e
 
SŒšg
 
	mbuck‘Ty³2i
;

73 
´iv©e
 
QuÜum
 
	mrv®ue
;

74 
´iv©e
 
QuÜum
 
	mwv®ue
;

75 
´iv©e
 
	m»adR‘ryCouÁ
;

76 
´iv©e
 
	mwa™TimeBefÜeR‘ry
;

77 
´iv©e
 
	mŒª§ùiÚTimeLim™
;

78 
´iv©e
 
boŞ—n
 
	m¡rÚgCÚsi¡’cy
;

79 
´iv©e
 
SŒšg
 
	m¡rÚgCÚsi¡’tSÿnsBuck‘Ty³
;

80 
´iv©e
 
boŞ—n
 
	m³rfÜmSŒÚgCÚsi¡’tSÿns
;

81 
´iv©e
 
boŞ—n
 
	mdebug
;

83 
´iv©e
 
RŸkCl›Á
 
	mrŸkCl›Á
;

84 
´iv©e
 
RŸkClu¡”
 
	mrŸkClu¡”
;

86 
´iv©e
 
	$lßdDeçuÉPrİ”t›s
() {

87 
IÅutSŒ—m
 
´İFe
 = 
RŸkKVCl›Á
.
şass
.
	`g‘CÏssLßd”
().
	`g‘ResourûAsSŒ—m
("riak.properties");

88 
Prİ”t›s
 
´İsPF
 = 
Ãw
 
	`Prİ”t›s
(
Sy¡em
.
	`g‘Prİ”t›s
());

90 
Œy
 {

91 
´İsPF
.
	`lßd
(
´İFe
);

92 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

93 
e
.
	`´štSckT¿û
();

96 
ho¡s
 = 
´İsPF
.
	`g‘Prİ”ty
(
HOST_PROPERTY
).
	`¥l™
(",");

97 
pÜt
 = 
IÁeg”
.
	`·r£IÁ
(
´İsPF
.
	`g‘Prİ”ty
(
PORT_PROPERTY
));

98 
buck‘Ty³
 = 
´İsPF
.
	`g‘Prİ”ty
(
BUCKET_TYPE_PROPERTY
);

99 
rv®ue
 = 
Ãw
 
	`QuÜum
(
IÁeg”
.
	`·r£IÁ
(
´İsPF
.
	`g‘Prİ”ty
(
R_VALUE_PROPERTY
)));

100 
wv®ue
 = 
Ãw
 
	`QuÜum
(
IÁeg”
.
	`·r£IÁ
(
´İsPF
.
	`g‘Prİ”ty
(
W_VALUE_PROPERTY
)));

101 
»adR‘ryCouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İsPF
.
	`g‘Prİ”ty
(
READ_RETRY_COUNT_PROPERTY
));

102 
wa™TimeBefÜeR‘ry
 = 
IÁeg”
.
	`·r£IÁ
(
´İsPF
.
	`g‘Prİ”ty
(
WAIT_TIME_BEFORE_RETRY_PROPERTY
));

103 
Œª§ùiÚTimeLim™
 = 
IÁeg”
.
	`·r£IÁ
(
´İsPF
.
	`g‘Prİ”ty
(
TRANSACTION_TIME_LIMIT_PROPERTY
));

104 
¡rÚgCÚsi¡’cy
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İsPF
.
	`g‘Prİ”ty
(
STRONG_CONSISTENCY_PROPERTY
));

105 
¡rÚgCÚsi¡’tSÿnsBuck‘Ty³
 = 
´İsPF
.
	`g‘Prİ”ty
(
STRONG_CONSISTENT_SCANS_BUCKET_TYPE_PROPERTY
);

106 
debug
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İsPF
.
	`g‘Prİ”ty
(
DEBUG_PROPERTY
));

109 
´iv©e
 
	$lßdPrİ”t›s
() {

111 
	`lßdDeçuÉPrİ”t›s
();

114 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

116 
SŒšg
 
pÜtSŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
PORT_PROPERTY
);

117 ià(
pÜtSŒšg
 !ğ
nuÎ
) {

118 
pÜt
 = 
IÁeg”
.
	`·r£IÁ
(
pÜtSŒšg
);

121 
SŒšg
 
ho¡sSŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
HOST_PROPERTY
);

122 ià(
ho¡sSŒšg
 !ğ
nuÎ
) {

123 
ho¡s
 = 
ho¡sSŒšg
.
	`¥l™
(",");

126 
SŒšg
 
buck‘Ty³SŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
BUCKET_TYPE_PROPERTY
);

127 ià(
buck‘Ty³SŒšg
 !ğ
nuÎ
) {

128 
buck‘Ty³
 = 
buck‘Ty³SŒšg
;

131 
SŒšg
 
rV®ueSŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
R_VALUE_PROPERTY
);

132 ià(
rV®ueSŒšg
 !ğ
nuÎ
) {

133 
rv®ue
 = 
Ãw
 
	`QuÜum
(
IÁeg”
.
	`·r£IÁ
(
rV®ueSŒšg
));

136 
SŒšg
 
wV®ueSŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
W_VALUE_PROPERTY
);

137 ià(
wV®ueSŒšg
 !ğ
nuÎ
) {

138 
wv®ue
 = 
Ãw
 
	`QuÜum
(
IÁeg”
.
	`·r£IÁ
(
wV®ueSŒšg
));

141 
SŒšg
 
»adR‘ryCouÁSŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
READ_RETRY_COUNT_PROPERTY
);

142 ià(
»adR‘ryCouÁSŒšg
 !ğ
nuÎ
) {

143 
»adR‘ryCouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
»adR‘ryCouÁSŒšg
);

146 
SŒšg
 
wa™TimeBefÜeR‘rySŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
WAIT_TIME_BEFORE_RETRY_PROPERTY
);

147 ià(
wa™TimeBefÜeR‘rySŒšg
 !ğ
nuÎ
) {

148 
wa™TimeBefÜeR‘ry
 = 
IÁeg”
.
	`·r£IÁ
(
wa™TimeBefÜeR‘rySŒšg
);

151 
SŒšg
 
Œª§ùiÚTimeLim™SŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
TRANSACTION_TIME_LIMIT_PROPERTY
);

152 ià(
Œª§ùiÚTimeLim™SŒšg
 !ğ
nuÎ
) {

153 
Œª§ùiÚTimeLim™
 = 
IÁeg”
.
	`·r£IÁ
(
Œª§ùiÚTimeLim™SŒšg
);

156 
SŒšg
 
¡rÚgCÚsi¡’cySŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
STRONG_CONSISTENCY_PROPERTY
);

157 ià(
¡rÚgCÚsi¡’cySŒšg
 !ğ
nuÎ
) {

158 
¡rÚgCÚsi¡’cy
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
¡rÚgCÚsi¡’cySŒšg
);

161 
SŒšg
 
¡rÚgCÚsi¡’tSÿnsBuck‘Ty³SŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
STRONG_CONSISTENT_SCANS_BUCKET_TYPE_PROPERTY
);

162 ià(
¡rÚgCÚsi¡’tSÿnsBuck‘Ty³SŒšg
 !ğ
nuÎ
) {

163 
¡rÚgCÚsi¡’tSÿnsBuck‘Ty³
 = 
¡rÚgCÚsi¡’tSÿnsBuck‘Ty³SŒšg
;

166 
SŒšg
 
debugSŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
DEBUG_PROPERTY
);

167 ià(
debugSŒšg
 !ğ
nuÎ
) {

168 
debug
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
debugSŒšg
);

170 
	}
}

172 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

173 
	`lßdPrİ”t›s
();

175 
RŸkNode
.
Bud”
 
bud”
 = 
Ãw
 RŸkNode.
	`Bud”
().
	`w™hRemÙePÜt
(
pÜt
);

176 
Li¡
<
RŸkNode
> 
nodes
 = RŸkNode.
Bud”
.
	`budNodes
(
bud”
, 
A¼ays
.
	`asLi¡
(
ho¡s
));

177 
rŸkClu¡”
 = 
Ãw
 
RŸkClu¡”
.
	`Bud”
(
nodes
).
	`bud
();

179 
Œy
 {

180 
rŸkClu¡”
.
	`¡¬t
();

181 
rŸkCl›Á
 = 
Ãw
 
	`RŸkCl›Á
(
rŸkClu¡”
);

182 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

183 
Sy¡em
.
”r
.
	`´šn
("UÇbËØ´İ”ly s¹ u°thşu¡”. R—sÚ: " + 
e
.
	`toSŒšg
());

184 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

188 ià(
¡rÚgCÚsi¡’cy
 && !
¡rÚgCÚsi¡’tSÿnsBuck‘Ty³
.
	`isEm±y
()) {

192 
buck‘Ty³2i
 = 
¡rÚgCÚsi¡’tSÿnsBuck‘Ty³
;

193 
³rfÜmSŒÚgCÚsi¡’tSÿns
 = 
Œue
;

197 
buck‘Ty³2i
 = 
buck‘Ty³
;

198 
³rfÜmSŒÚgCÚsi¡’tSÿns
 = 
çl£
;

201 ià(
debug
) {

202 
Sy¡em
.
”r
.
	`´šn
("DEBUG ENABLED. Configuration…arameters:");

203 
Sy¡em
.
”r
.
	`´šn
("-----------------------------------------");

204 
Sy¡em
.
”r
.
	`´šn
("Ho¡s: " + 
A¼ays
.
	`toSŒšg
(
ho¡s
));

205 
Sy¡em
.
”r
.
	`´šn
("PÜt: " + 
pÜt
);

206 
Sy¡em
.
”r
.
	`´šn
("Buck‘ Ty³: " + 
buck‘Ty³
);

207 
Sy¡em
.
”r
.
	`´šn
("R V®: " + 
rv®ue
.
	`toSŒšg
());

208 
Sy¡em
.
”r
.
	`´šn
("W V®: " + 
wv®ue
.
	`toSŒšg
());

209 
Sy¡em
.
”r
.
	`´šn
("R—d R‘ry CouÁ: " + 
»adR‘ryCouÁ
);

210 
Sy¡em
.
”r
.
	`´šn
("Wa™ TimBefÜR‘ry: " + 
wa™TimeBefÜeR‘ry
 + " ms");

211 
Sy¡em
.
”r
.
	`´šn
("T¿n§ùiÚ TimLim™: " + 
Œª§ùiÚTimeLim™
 + " s");

212 
Sy¡em
.
”r
.
	`´šn
("CÚsi¡’cy mod–: " + (
¡rÚgCÚsi¡’cy
 ? "Strong" : "Eventual"));

214 ià(
¡rÚgCÚsi¡’cy
) {

215 
Sy¡em
.
”r
.
	`´šn
("SŒÚg CÚsi¡’ˆSÿÀT¿n§ùiÚ " + (
³rfÜmSŒÚgCÚsi¡’tSÿns
 ? "" : "NOT ") +

219 
	}
}

230 @
Ov”ride


231 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

232 
LoÿtiÚ
 
	gloÿtiÚ
 = 
Ãw
 LoÿtiÚÒew 
Name¥aû
(
buck‘Ty³
, 
bË
), 
key
);

233 
F‘chV®ue
 
	gfv
 = 
Ãw
 F‘chV®ue.
Bud”
(
loÿtiÚ
).
w™hO±iÚ
(F‘chV®ue.
O±iÚ
.
R
, 
rv®ue
).
bud
();

234 
	gF‘chV®ue
.
Re¥Ú£
 
	g»¥Ú£
;

236 
	gŒy
 {

237 
	g»¥Ú£
 = 
ãtch
(
fv
);

239 ià(
	g»¥Ú£
.
isNÙFound
()) {

240 ià(
	gdebug
) {

241 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØ»ad key " + 
key
 + ". Reason: NOT FOUND");

244  
	gStus
.
	gNOT_FOUND
;

246 } 
ÿtch
 (
TimeoutExû±iÚ
 
e
) {

247 ià(
	gdebug
) {

248 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØ»ad key " + 
key
 + ". Reason: TIME OUT");

251  
	gTIME_OUT
;

252 } 
ÿtch
 (
Exû±iÚ
 
e
) {

253 ià(
	gdebug
) {

254 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØ»ad key " + 
key
 + ". R—sÚ: " + 
e
.
toSŒšg
());

257  
	gStus
.
	gERROR
;

261 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g·¹ŸlResuÉ
 = 
Ãw
 
HashM­
<>();

262 
ü—‹ResuÉHashM­
(
f›lds
, 
»¥Ú£
, 
·¹ŸlResuÉ
);

263 
	g»suÉ
.
putAÎ
(
·¹ŸlResuÉ
);

264  
	gStus
.
	gOK
;

279 @
Ov”ride


280 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

281 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

282 ià(
	g¡rÚgCÚsi¡’cy
 && !
	g³rfÜmSŒÚgCÚsi¡’tSÿns
) {

283  
	gStus
.
	gNOT_IMPLEMENTED
;

289 
IÁIndexQu”y
 
	giiq
 = 
Ãw
 IntIndexQuery

290 .
Bud”
(
Ãw
 
Name¥aû
(
buck‘Ty³2i
, 
bË
), "key", 
g‘KeyAsLÚg
(
¡¬tkey
), 
LÚg
.
MAX_VALUE
)

291 .
w™hMaxResuÉs
(
»cÜdcouÁ
)

292 .
w™hPagš©iÚSÜt
(
Œue
)

293 .
bud
();

295 
LoÿtiÚ
 
	gloÿtiÚ
;

296 
	gRŸkFutu»
<
	gIÁIndexQu”y
.
	gRe¥Ú£
, IÁIndexQu”y> 
	gfutu»
 = 
rŸkCl›Á
.
execu‹Async
(
iiq
);

298 
	gŒy
 {

299 
	gIÁIndexQu”y
.
Re¥Ú£
 
	g»¥Ú£
 = 
futu»
.
g‘
(
Œª§ùiÚTimeLim™
, 
TimeUn™
.
SECONDS
);

300 
	gLi¡
<
	gIÁIndexQu”y
.
	gRe¥Ú£
.
	gEÁry
> 
	g’Œ›s
 = 
»¥Ú£
.
g‘EÁr›s
();

303 ià(
	g’Œ›s
.
size
() == 0) {

304 ià(
debug
) {

305 
Sy¡em
.
”r
.
´šn
("UÇbËØsÿÀªy„ecÜd s¹šg from key " + 
¡¬tkey
 + ",‡bortingransaction. " +

309  
	gStus
.
	gNOT_FOUND
;

312 
	gIÁIndexQu”y
.
	gRe¥Ú£
.
EÁry
 
	g’Œy
 : 
’Œ›s
) {

315 ià(
¡rÚgCÚsi¡’cy
) {

316 
loÿtiÚ
 = 
Ãw
 
LoÿtiÚ
Òew 
Name¥aû
(
buck‘Ty³
, 
bË
), 
’Œy
.
g‘RŸkObjeùLoÿtiÚ
().
g‘KeyAsSŒšg
());

318 
	gloÿtiÚ
 = 
’Œy
.
g‘RŸkObjeùLoÿtiÚ
();

321 
F‘chV®ue
 
	gfv
 = 
Ãw
 F‘chV®ue.
Bud”
(
loÿtiÚ
)

322 .
w™hO±iÚ
(
F‘chV®ue
.
O±iÚ
.
R
, 
rv®ue
)

323 .
bud
();

325 
	gF‘chV®ue
.
Re¥Ú£
 
	gkeyRe¥Ú£
 = 
ãtch
(
fv
);

327 ià(
	gkeyRe¥Ú£
.
isNÙFound
()) {

328 ià(
	gdebug
) {

329 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØsÿÀ®È»que¡ed„ecÜd ¡¬tšg from key " + 
¡¬tkey
 + ",‡borting " +

333  
	gStus
.
	gNOT_FOUND
;

337 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g·¹ŸlResuÉ
 = 
Ãw
 
HashM­
<>();

338 
ü—‹ResuÉHashM­
(
f›lds
, 
keyRe¥Ú£
, 
·¹ŸlResuÉ
);

339 
	g»suÉ
.
add
(
·¹ŸlResuÉ
);

341 } 
ÿtch
 (
TimeoutExû±iÚ
 
e
) {

342 ià(
	gdebug
) {

343 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØsÿÀ®È»que¡ed„ecÜd ¡¬tšg from key " + 
¡¬tkey
 + ",‡borting " +

347  
	gTIME_OUT
;

348 } 
ÿtch
 (
Exû±iÚ
 
e
) {

349 ià(
	gdebug
) {

350 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØsÿÀ®È»cÜd ¡¬tšg from key " + 
¡¬tkey
 + ",‡bortingransaction. " +

351 "R—sÚ: " + 
e
.
toSŒšg
());

354  
	gStus
.
	gERROR
;

357  
	gStus
.
	gOK
;

368 
´iv©e
 
	gF‘chV®ue
.
Re¥Ú£
 
	$ãtch
(
F‘chV®ue
 
fv
è
throws
 
TimeoutExû±iÚ
 {

369 
F‘chV®ue
.
Re¥Ú£
 
»¥Ú£
 = 
nuÎ
;

371 
i
 = 0; i < 
»adR‘ryCouÁ
; i++) {

372 
RŸkFutu»
<
F‘chV®ue
.
Re¥Ú£
, 
LoÿtiÚ
> 
futu»
 = 
rŸkCl›Á
.
	`execu‹Async
(
fv
);

374 
Œy
 {

375 
»¥Ú£
 = 
futu»
.
	`g‘
(
Œª§ùiÚTimeLim™
, 
TimeUn™
.
SECONDS
);

377 ià(!
»¥Ú£
.
	`isNÙFound
()) {

380 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

382 
throw
 
Ãw
 
	`TimeoutExû±iÚ
();

383 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

385 
Œy
 {

386 
Th»ad
.
	`¦“p
(
wa™TimeBefÜeR‘ry
);

387 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e1
) {

388 
e1
.
	`´štSckT¿û
();

393  
»¥Ú£
;

394 
	}
}

406 @
Ov”ride


407 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

408 
LoÿtiÚ
 
	gloÿtiÚ
 = 
Ãw
 LoÿtiÚÒew 
Name¥aû
(
buck‘Ty³
, 
bË
), 
key
);

409 
RŸkObjeù
 
	gobjeù
 = 
Ãw
 RiakObject();

415 ià(
	g¡rÚgCÚsi¡’cy
 && 
	g³rfÜmSŒÚgCÚsi¡’tSÿns
) {

417 
LoÿtiÚ
 
	gçkeLoÿtiÚ
 = 
Ãw
 LoÿtiÚÒew 
Name¥aû
(
¡rÚgCÚsi¡’tSÿnsBuck‘Ty³
, 
bË
), 
key
);

421 
RŸkObjeù
 
	gçkeObjeù
 = 
Ãw
 RiakObject();

422 
	gçkeObjeù
.
£tV®ue
(
Bš¬yV®ue
.
ü—‹
(
Ãw
 
by‹
[]{0x00}));

423 
	gçkeObjeù
.
g‘Indexes
().
g‘Index
(
LÚgIÁIndex
.
Çmed
("key_št")).
add
(
g‘KeyAsLÚg
(
key
));

425 
StÜeV®ue
 
	gçkeStÜe
 = 
Ãw
 StÜeV®ue.
Bud”
(
çkeObjeù
)

426 .
w™hLoÿtiÚ
(
çkeLoÿtiÚ
)

427 .
bud
();

432 
	grŸkCl›Á
.
execu‹Async
(
çkeStÜe
);

433 } ià(!
	g¡rÚgCÚsi¡’cy
) {

436 
	gobjeù
.
g‘Indexes
().
g‘Index
(
LÚgIÁIndex
.
Çmed
("key_št")).
add
(
g‘KeyAsLÚg
(
key
));

440 
	gobjeù
.
£tV®ue
(
Bš¬yV®ue
.
ü—‹
(
£rŸlizeTabË
(
v®ues
)));

442 
StÜeV®ue
 
	g¡Üe
 = 
Ãw
 StÜeV®ue.
Bud”
(
objeù
)

443 .
w™hO±iÚ
(
StÜeV®ue
.
O±iÚ
.
W
, 
wv®ue
)

444 .
w™hLoÿtiÚ
(
loÿtiÚ
)

445 .
bud
();

447 
	gRŸkFutu»
<
	gStÜeV®ue
.
	gRe¥Ú£
, 
	gLoÿtiÚ
> 
	gfutu»
 = 
rŸkCl›Á
.
execu‹Async
(
¡Üe
);

449 
	gŒy
 {

450 
	gfutu»
.
g‘
(
Œª§ùiÚTimeLim™
, 
TimeUn™
.
SECONDS
);

451 } 
ÿtch
 (
TimeoutExû±iÚ
 
e
) {

452 ià(
	gdebug
) {

453 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØš£¹ key " + 
key
 + ". Reason: TIME OUT");

456  
	gTIME_OUT
;

457 } 
ÿtch
 (
Exû±iÚ
 
e
) {

458 ià(
	gdebug
) {

459 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØš£¹ key " + 
key
 + ". R—sÚ: " + 
e
.
toSŒšg
());

462  
	gStus
.
	gERROR
;

465  
	gStus
.
	gOK
;

472 
´iv©e
 
fš®
 
şass
 
Upd©eEÁ™y
 
ex‹nds
 
	gUpd©eV®ue
.
	gUpd©e
<
	gRŸkObjeù
> {

473 
´iv©e
 
fš®
 
RŸkObjeù
 
	gobjeù
;

475 
´iv©e
 
Upd©eEÁ™y
(
RŸkObjeù
 
objeù
) {

476 
	gthis
.
	gobjeù
 = 
objeù
;

480 @
Ov”ride


481 
public
 
RŸkObjeù
 
­¶y
(RŸkObjeù 
Üigš®
) {

482  
	gobjeù
;

495 @
Ov”ride


496 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

498 ià(!
	g¡rÚgCÚsi¡’cy
) {

499  
š£¹
(
bË
, 
key
, 
v®ues
);

502 
LoÿtiÚ
 
	gloÿtiÚ
 = 
Ãw
 LoÿtiÚÒew 
Name¥aû
(
buck‘Ty³
, 
bË
), 
key
);

504 
Upd©eV®ue
 
	gupd©e
 = 
Ãw
 Upd©eV®ue.
Bud”
(
loÿtiÚ
)

505 .
w™hUpd©e
(
Ãw
 
Upd©eEÁ™y
Òew 
RŸkObjeù
().
£tV®ue
(
Bš¬yV®ue
.
ü—‹
(
£rŸlizeTabË
(
v®ues
)))))

506 .
bud
();

508 
	gRŸkFutu»
<
	gUpd©eV®ue
.
	gRe¥Ú£
, 
	gLoÿtiÚ
> 
	gfutu»
 = 
rŸkCl›Á
.
execu‹Async
(
upd©e
);

510 
	gŒy
 {

517 
	gfutu»
.
g‘
(
Œª§ùiÚTimeLim™
, 
TimeUn™
.
SECONDS
).
wasUpd©ed
();

518 } 
ÿtch
 (
TimeoutExû±iÚ
 
e
) {

519 ià(
	gdebug
) {

520 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØupd©key " + 
key
 + ". Reason: TIME OUT");

523  
	gTIME_OUT
;

524 } 
ÿtch
 (
Exû±iÚ
 
e
) {

525 ià(
	gdebug
) {

526 
	gSy¡em
.
	g”r
.
´šn
("UÇbËØupd©key " + 
key
 + ". R—sÚ: " + 
e
.
toSŒšg
());

529  
	gStus
.
	gERROR
;

532  
	gStus
.
	gOK
;

542 @
Ov”ride


543 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

544 
LoÿtiÚ
 
loÿtiÚ
 = 
Ãw
 
	`LoÿtiÚ
Òew 
	`Name¥aû
(
buck‘Ty³
, 
bË
), 
key
);

545 
D–‘eV®ue
 
dv
 = 
Ãw
 D–‘eV®ue.
	`Bud”
(
loÿtiÚ
).
	`bud
();

547 
RŸkFutu»
<
Void
, 
LoÿtiÚ
> 
futu»
 = 
rŸkCl›Á
.
	`execu‹Async
(
dv
);

549 
Œy
 {

550 
futu»
.
	`g‘
(
Œª§ùiÚTimeLim™
, 
TimeUn™
.
SECONDS
);

551 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

552 ià(
debug
) {

553 
Sy¡em
.
”r
.
	`´šn
("UÇbËØd–‘key " + 
key
 + ". Reason: TIME OUT");

556  
TIME_OUT
;

557 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

558 ià(
debug
) {

559 
Sy¡em
.
”r
.
	`´šn
("UÇbËØd–‘key " + 
key
 + ". R—sÚ: " + 
e
.
	`toSŒšg
());

562  
Stus
.
ERROR
;

565  
Stus
.
OK
;

566 
	}
}

568 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

569 
Œy
 {

570 
rŸkClu¡”
.
	`shutdown
();

571 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

572 
Sy¡em
.
”r
.
	`´šn
("UÇbËØ´İ”ly shutdowÀthşu¡”. R—sÚ: " + 
e
.
	`toSŒšg
());

573 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

575 
	}
}

585 
	$£tTe¡EnvœÚm’t
(
SŒšg
 
buck‘
è
throws
 
Exû±iÚ
 {

586 
buck‘Ty³
 = "default";

587 
buck‘Ty³2i
 = 
buck‘Ty³
;

588 
¡rÚgCÚsi¡’cy
 = 
çl£
;

590 
Name¥aû
 
ns
 = 
Ãw
 
	`Name¥aû
(
buck‘Ty³
, 
buck‘
);

591 
StÜeBuck‘Prİ”t›s
 
ÃwBuck‘Prİ”t›s
 = 
Ãw
 StÜeBuck‘Prİ”t›s.
	`Bud”
(
ns
).
	`w™hAÎowMuÉi
(
çl£
).
	`bud
();

593 
rŸkCl›Á
.
	`execu‹
(
ÃwBuck‘Prİ”t›s
);

594 
	}
}

	@riak/src/main/java/site/ycsb/db/riak/RiakUtils.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	grŸk
;

21 
impÜt
 
	gjava
.
	gio
.*;

22 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
impÜt
 
	gcom
.
	gbasho
.
	grŸk
.
	gş›Á
.
	g­i
.
	gcommªds
.
	gkv
.
	gF‘chV®ue
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

30 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gba£
.
	gP»cÚd™iÚs
.
	gcheckArgum’t
;

36 
fš®
 cÏs 
	cRŸkUts
 {

38 
´iv©e
 
	$RŸkUts
() {

39 
	`su³r
();

42 
´iv©e
 
by‹
[] 
	$toBy‹s
(
fš®
 
ªIÁeg”
) {

43 
by‹
[] 
aResuÉ
 = 
Ãw
 byte[4];

45 
aResuÉ
[0] = (
by‹
è(
ªIÁeg”
 >> 24);

46 
aResuÉ
[1] = (
by‹
è(
ªIÁeg”
 >> 16);

47 
aResuÉ
[2] = (
by‹
è(
ªIÁeg”
 >> 8);

48 
aResuÉ
[3] = (
by‹
è(
ªIÁeg”
 );

50  
aResuÉ
;

51 
	}
}

53 
´iv©e
 
	$äomBy‹s
(
fš®
 
by‹
[] 
aBy‹A¼ay
) {

54 
	`checkArgum’t
(
aBy‹A¼ay
.
Ëngth
 == 4);

56  (
aBy‹A¼ay
[0] << 24) | (aByteArray[1] & 0xFF) << 16 | (aByteArray[2] & 0xFF) << 8 | (aByteArray[3] & 0xFF);

57 
	}
}

59 
´iv©e
 
	$şo£
(
fš®
 
OuutSŒ—m
 
ªOuutSŒ—m
) {

60 
Œy
 {

61 
ªOuutSŒ—m
.
	`şo£
();

62 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

63 
e
.
	`´štSckT¿û
();

65 
	}
}

67 
´iv©e
 
	$şo£
(
fš®
 
IÅutSŒ—m
 
ªIÅutSŒ—m
) {

68 
Œy
 {

69 
ªIÅutSŒ—m
.
	`şo£
();

70 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

71 
e
.
	`´štSckT¿û
();

73 
	}
}

81 
	gby‹
[] 
£rŸlizeTabË
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
aTabË
) {

82 
fš®
 
By‹A¼ayOuutSŒ—m
 
	gªOuutSŒ—m
 = 
Ãw
 ByteArrayOutputStream();

83 
fš®
 
	gS‘
<
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
>> 
	gtheEÁr›s
 = 
aTabË
.
’ŒyS‘
();

85 
	gŒy
 {

86 
fš®
 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gªEÁry
 : 
theEÁr›s
) {

87 
fš®
 
by‹
[] 
aCŞumnName
 = 
ªEÁry
.
g‘Key
().
g‘By‹s
();

89 
	gªOuutSŒ—m
.
wr™e
(
toBy‹s
(
aCŞumnName
.
Ëngth
));

90 
	gªOuutSŒ—m
.
wr™e
(
aCŞumnName
);

92 
fš®
 
	gby‹
[] 
	gaCŞumnV®ue
 = 
ªEÁry
.
g‘V®ue
().
toA¼ay
();

94 
	gªOuutSŒ—m
.
wr™e
(
toBy‹s
(
aCŞumnV®ue
.
Ëngth
));

95 
	gªOuutSŒ—m
.
wr™e
(
aCŞumnV®ue
);

97  
	gªOuutSŒ—m
.
toBy‹A¼ay
();

98 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

99 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
e
);

100 } 
	gfš®ly
 {

101 
şo£
(
ªOuutSŒ—m
);

111 
´iv©e
 
de£rŸlizeTabË
(
fš®
 
by‹
[] 
aV®ue
, fš® 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
theResuÉ
) {

112 
fš®
 
By‹A¼ayIÅutSŒ—m
 
	gªIÅutSŒ—m
 = 
Ãw
 By‹A¼ayIÅutSŒ—m(
aV®ue
);

113 
	gby‹
[] 
	gaSizeBufãr
 = 
Ãw
 
by‹
[4];

115 
	gŒy
 {

116 
	gªIÅutSŒ—m
.
avaabË
() > 0) {

117 
	gªIÅutSŒ—m
.
»ad
(
aSizeBufãr
);

118 
fš®
 
	gaCŞumnNameL’gth
 = 
äomBy‹s
(
aSizeBufãr
);

120 
fš®
 
	gby‹
[] 
	gaCŞumnNameBufãr
 = 
Ãw
 
by‹
[
aCŞumnNameL’gth
];

121 
	gªIÅutSŒ—m
.
»ad
(
aCŞumnNameBufãr
);

123 
	gªIÅutSŒ—m
.
»ad
(
aSizeBufãr
);

124 
fš®
 
	gaCŞumnV®ueL’gth
 = 
äomBy‹s
(
aSizeBufãr
);

126 
fš®
 
	gby‹
[] 
	gaCŞumnV®ue
 = 
Ãw
 
by‹
[
aCŞumnV®ueL’gth
];

127 
	gªIÅutSŒ—m
.
»ad
(
aCŞumnV®ue
);

129 
	gtheResuÉ
.
put
(
Ãw
 
SŒšg
(
aCŞumnNameBufãr
),‚ew 
By‹A¼ayBy‹I‹¿tÜ
(
aCŞumnV®ue
));

131 } 
ÿtch
 (
Exû±iÚ
 
e
) {

132 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
e
);

133 } 
	gfš®ly
 {

134 
şo£
(
ªIÅutSŒ—m
);

144 
LÚg
 
	$g‘KeyAsLÚg
(
SŒšg
 
key
) {

145 
SŒšg
 
keySŒšg
 = 
key
.
	`»¶aûFœ¡
("[a-zA-Z]*", "");

147  
LÚg
.
	`·r£LÚg
(
keySŒšg
);

148 
	}
}

158 
ü—‹ResuÉHashM­
(
S‘
<
SŒšg
> 
f›lds
, 
F‘chV®ue
.
Re¥Ú£
 
»¥Ú£
,

159 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>
»suÉHashM­
) {

163 
	gby‹
[] 
	g»¥Ú£F›ldsAndV®ues
 = 
»¥Ú£
.
g‘V®ues
().
g‘
(0).
g‘V®ue
().getValue();

166 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gde£rŸlizedTabË
 = 
Ãw
 
HashM­
<>();

167 
de£rŸlizeTabË
(
»¥Ú£F›ldsAndV®ues
, 
de£rŸlizedTabË
);

170 ià(
	gf›lds
 !ğ
nuÎ
) {

172 
Objeù
 
f›ld
 : 
f›lds
.
toA¼ay
()) {

175 
By‹I‹¿tÜ
 
v®ue
 = 
de£rŸlizedTabË
.
g‘
(
f›ld
);

177 ià(
	gv®ue
 !ğ
nuÎ
) {

178 
»suÉHashM­
.
put
((
SŒšg
è
f›ld
, 
v®ue
);

183 
SŒšg
 
	gf›ld
 : 
de£rŸlizedTabË
.
keyS‘
()) {

184 
»suÉHashM­
.
put
(
f›ld
, 
de£rŸlizedTabË
.
g‘
(field));

	@riak/src/main/java/site/ycsb/db/riak/package-info.java

23 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	grŸk
;

	@riak/src/test/java/site/ycsb/db/riak/RiakKVClientTest.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	grŸk
;

21 
impÜt
 
	gjava
.
	gut
.*;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

27 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

28 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

29 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

31 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gCÜeM©ch”s
.
	gis
;

32 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

33 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeNoExû±iÚ
;

34 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeTh©
;

39 
public
 cÏs 
	cRŸkKVCl›ÁTe¡
 {

40 
´iv©e
 
RŸkKVCl›Á
 
	mrŸkCl›Á
;

42 
´iv©e
 
fš®
 
SŒšg
 
	mbuck‘
 = "testBucket";

43 
´iv©e
 
fš®
 
SŒšg
 
	mkeyP»fix
 = "testKey";

44 
´iv©e
 
fš®
 
	m»cÜdsToIn£¹
 = 20;

45 
´iv©e
 
fš®
 
	m»cÜdsToSÿn
 = 7;

46 
´iv©e
 
fš®
 
SŒšg
 
	mfœ¡F›ld
 = "Key‚umber";

47 
´iv©e
 
fš®
 
SŒšg
 
	m£cÚdF›ld
 = "Key‚umber doubled";

48 
´iv©e
 
fš®
 
SŒšg
 
	mthœdF›ld
 = "Key‚umber square";

50 
´iv©e
 
boŞ—n
 
	m‹¡S¹ed
 = 
çl£
;

55 @
BefÜeCÏss


56 
public
 
	$£tUpCÏss
(è
throws
 
Exû±iÚ
 {

57 
rŸkCl›Á
 = 
Ãw
 
	`RŸkKVCl›Á
();

58 
rŸkCl›Á
.
	`š™
();

61 
Œy
 {

62 
rŸkCl›Á
.
	`£tTe¡EnvœÚm’t
(
buck‘
);

63 } 
	`ÿtch
(
Exû±iÚ
 
e
) {

64 
	`assumeNoExû±iÚ
("UÇbËØcÚfigu» RŸk KV fÜe¡,‡bÜtšg.", 
e
);

68 
i
 = 0; i < 
»cÜdsToIn£¹
; i++) {

70 
	`assumeTh©
("Riak KV is NOT RUNNING,‡bortingest.",

71 
rŸkCl›Á
.
	`š£¹
(
buck‘
, 
keyP»fix
 + 
SŒšg
.
	`v®ueOf
(
i
), 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(

72 
	`ü—‹Ex³ùedHashM­
(
i
))),

73 
	`is
(
Stus
.
OK
));

77 
‹¡S¹ed
 = 
Œue
;

83 @
Aá”CÏss


84 
public
 
	$‹¬DownCÏss
(è
throws
 
Exû±iÚ
 {

86 ià(
‹¡S¹ed
) {

87 
i
 = 0; i <ğ
»cÜdsToIn£¹
; i++) {

88 
	`d–‘e
(
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
i
));

92 
rŸkCl›Á
.
	`ş—nup
();

93 
	}
}

99 @
Te¡


100 
public
 
	$‹¡R—d
() {

102 
»adKeyNumb”
 = 
Ãw
 
	`Rªdom
().
	`ÃxtIÁ
(
»cÜdsToIn£¹
);

105 
S‘
<
SŒšg
> 
f›lds
 = 
Ãw
 
HashS‘
<>();

106 
f›lds
.
	`add
(
fœ¡F›ld
);

107 
f›lds
.
	`add
(
thœdF›ld
);

110 
HashM­
<
SŒšg
, SŒšg> 
ex³ùedV®ue
 = 
Ãw
 HashMap<>();

111 
ex³ùedV®ue
.
	`put
(
fœ¡F›ld
, 
IÁeg”
.
	`toSŒšg
(
»adKeyNumb”
));

112 
ex³ùedV®ue
.
	`put
(
thœdF›ld
, 
IÁeg”
.
	`toSŒšg
(
»adKeyNumb”
 *„eadKeyNumber));

115 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adV®ue
 = 
Ãw
 HashMap<>();

119 
	`as£¹Equ®s
("Readransaction FAILED.",

120 
Stus
.
OK
,

121 
rŸkCl›Á
.
	`»ad
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
»adKeyNumb”
), 
f›lds
, 
»adV®ue
));

123 
	`as£¹Equ®s
("Readest FAILED. Actual„eadransaction value is NOT MATCHINGheƒxpected one.",

124 
ex³ùedV®ue
.
	`toSŒšg
(),

125 
»adV®ue
.
	`toSŒšg
());

126 
	}
}

133 @
Te¡


134 
public
 
	$‹¡Sÿn
() {

136 
¡¬tSÿnKeyNumb”
 = 
Ãw
 
	`Rªdom
().
	`ÃxtIÁ
(
»cÜdsToIn£¹
 - 
»cÜdsToSÿn
);

139 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
sÿÂedV®ues
 = 
Ãw
 Vector<>();

142 
	`as£¹Equ®s
("Scanransaction FAILED.",

143 
Stus
.
OK
,

144 
rŸkCl›Á
.
	`sÿn
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
¡¬tSÿnKeyNumb”
), 
»cÜdsToSÿn
, 
nuÎ
,

145 
sÿÂedV®ues
));

148 
i
 = 0; i < 
»cÜdsToSÿn
; i++) {

149 
	`as£¹Equ®s
("Scanest FAILED:he current scanned key is NOT MATCHINGheƒxpected one.",

150 
	`ü—‹Ex³ùedHashM­
(
¡¬tSÿnKeyNumb”
 + 
i
).
	`toSŒšg
(),

151 
sÿÂedV®ues
.
	`g‘
(
i
).
	`toSŒšg
());

153 
	}
}

159 @
Te¡


160 
public
 
	$‹¡Upd©e
() {

162 
upd©eKeyNumb”
 = 
Ãw
 
	`Rªdom
().
	`ÃxtIÁ
(
»cÜdsToIn£¹
);

165 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adV®ueBefÜeUpd©e
 = 
Ãw
 HashMap<>();

166 
rŸkCl›Á
.
	`»ad
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
upd©eKeyNumb”
), 
nuÎ
, 
»adV®ueBefÜeUpd©e
);

169 
HashM­
<
SŒšg
, SŒšg> 
upd©eV®ue
 = 
Ãw
 HashMap<>();

170 
upd©eV®ue
.
	`put
(
fœ¡F›ld
, "UPDATED");

171 
upd©eV®ue
.
	`put
(
£cÚdF›ld
, "UPDATED");

172 
upd©eV®ue
.
	`put
(
thœdF›ld
, "UPDATED");

175 
	`as£¹Equ®s
("Updateransaction FAILED.",

176 
Stus
.
OK
,

177 
rŸkCl›Á
.
	`upd©e
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
upd©eKeyNumb”
), 
SŒšgBy‹I‹¿tÜ


178 .
	`g‘By‹I‹¿tÜM­
(
upd©eV®ue
)));

181 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adV®ueAá”Upd©e
 = 
Ãw
 HashMap<>();

182 
	`as£¹Equ®s
("Updateest FAILED. Unableo„ead key value.",

183 
Stus
.
OK
,

184 
rŸkCl›Á
.
	`»ad
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
upd©eKeyNumb”
), 
nuÎ
, 
»adV®ueAá”Upd©e
));

187 
	`as£¹Equ®s
("Updateransaction NOT EXECUTED PROPERLY. Values DID NOT CHANGE.",

188 
upd©eV®ue
.
	`toSŒšg
(),

189 
»adV®ueAá”Upd©e
.
	`toSŒšg
());

192 
	`as£¹Equ®s
("Updateest FAILED. Unableo„estore…revious key value.",

193 
Stus
.
OK
,

194 
rŸkCl›Á
.
	`upd©e
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
upd©eKeyNumb”
), 
»adV®ueBefÜeUpd©e
));

195 
	}
}

201 @
Te¡


202 
public
 
	$‹¡In£¹
() {

204 
HashM­
<
SŒšg
, SŒšg> 
š£¹V®ue
 = 
	`ü—‹Ex³ùedHashM­
(
»cÜdsToIn£¹
);

205 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adV®ue
 = 
Ãw
 HashMap<>();

208 
	`as£¹Equ®s
("Insertransaction FAILED.",

209 
Stus
.
OK
,

210 
rŸkCl›Á
.
	`š£¹
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
»cÜdsToIn£¹
), 
SŒšgBy‹I‹¿tÜ
.

211 
	`g‘By‹I‹¿tÜM­
(
š£¹V®ue
)));

214 
	`as£¹Equ®s
("Insertest FAILED. Unableo„ead inserted value.",

215 
Stus
.
OK
,

216 
rŸkCl›Á
.
	`»ad
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
»cÜdsToIn£¹
), 
nuÎ
, 
»adV®ue
));

217 
	`as£¹Equ®s
("Insertest FAILED. Actual„eadransaction value is NOT MATCHINGhe inserted one.",

218 
š£¹V®ue
.
	`toSŒšg
(),

219 
»adV®ue
.
	`toSŒšg
());

220 
	}
}

226 @
Te¡


227 
public
 
	$‹¡D–‘e
() {

229 
d–‘eKeyNumb”
 = 
Ãw
 
	`Rªdom
().
	`ÃxtIÁ
(
»cÜdsToIn£¹
);

232 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»adV®ueBefÜeD–‘e
 = 
Ãw
 HashMap<>();

233 
rŸkCl›Á
.
	`»ad
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
d–‘eKeyNumb”
), 
nuÎ
, 
»adV®ueBefÜeD–‘e
);

236 
	`as£¹Equ®s
("Deleteransaction FAILED.",

237 
Stus
.
OK
,

238 
	`d–‘e
(
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
d–‘eKeyNumb”
)));

241 
	`as£¹Equ®s
("Deleteest FAILED. Key NOT deleted.",

242 
Stus
.
NOT_FOUND
,

243 
rŸkCl›Á
.
	`»ad
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
d–‘eKeyNumb”
), 
nuÎ
,‚ull));

246 
	`as£¹Equ®s
("Deleteest FAILED. Unableo„estore…revious key value.",

247 
Stus
.
OK
,

248 
rŸkCl›Á
.
	`š£¹
(
buck‘
, 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
d–‘eKeyNumb”
), 
»adV®ueBefÜeD–‘e
));

249 
	}
}

251 
´iv©e
 
Stus
 
	$d–‘e
(
SŒšg
 
key
) {

252  
rŸkCl›Á
.
	`d–‘e
(
buck‘
, 
key
);

253 
	}
}

255 
´iv©e
 
	gHashM­
<
	gSŒšg
, SŒšg> 
	$ü—‹Ex³ùedHashM­
(
v®ue
) {

256 
HashM­
<
SŒšg
, SŒšg> 
v®ues
 = 
Ãw
 HashMap<>();

258 
v®ues
.
	`put
(
fœ¡F›ld
, 
IÁeg”
.
	`toSŒšg
(
v®ue
));

259 
v®ues
.
	`put
(
£cÚdF›ld
, 
IÁeg”
.
	`toSŒšg
(2 * 
v®ue
));

260 
v®ues
.
	`put
(
thœdF›ld
, 
IÁeg”
.
	`toSŒšg
(
v®ue
 * value));

262  
v®ues
;

263 
	}
}

	@rocksdb/src/main/java/site/ycsb/db/rocksdb/RocksDBClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	grocksdb
;

20 
impÜt
 
	gs™e
.
	gycsb
.*;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

22 
impÜt
 
	gÃt
.
	gjc
.
	gªnÙ©iÚs
.
	gGu¬dedBy
;

23 
impÜt
 
	gÜg
.
	grocksdb
.*;

24 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

25 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

27 
impÜt
 
	gjava
.
	gio
.*;

28 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

29 
impÜt
 
	gjava
.
	gnio
.
	gfe
.*;

30 
impÜt
 
	gjava
.
	gut
.*;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLock
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁLock
;

36 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
.
	gUTF_8
;

43 
public
 cÏs 
	cRocksDBCl›Á
 
ex‹nds
 
	mDB
 {

45 
fš®
 
SŒšg
 
	mPROPERTY_ROCKSDB_DIR
 = "rocksdb.dir";

46 
fš®
 
SŒšg
 
	mPROPERTY_ROCKSDB_OPTIONS_FILE
 = "rocksdb.optionsfile";

47 
´iv©e
 
fš®
 
SŒšg
 
	mCOLUMN_FAMILY_NAMES_FILENAME
 = "CF_NAMES";

49 
´iv©e
 
fš®
 
Logg”
 
	mLOGGER
 = 
Logg”FaùÜy
.
g‘Logg”
(
RocksDBCl›Á
.
şass
);

51 @
Gu¬dedBy
("RocksDBCl›Á.şass"è
´iv©e
 
P©h
 
	mrocksDbDœ
 = 
nuÎ
;

52 @
Gu¬dedBy
("RocksDBCl›Á.şass"è
´iv©e
 
P©h
 
	mİtiÚsFe
 = 
nuÎ
;

53 @
Gu¬dedBy
("RocksDBCl›Á.şass"è
´iv©e
 
RocksObjeù
 
	mdbO±iÚs
 = 
nuÎ
;

54 @
Gu¬dedBy
("RocksDBCl›Á.şass"è
´iv©e
 
RocksDB
 
	mrocksDb
 = 
nuÎ
;

55 @
Gu¬dedBy
("RocksDBCl›Á.şass"è
´iv©e
 
	m»ã»nûs
 = 0;

57 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mSŒšg
, 
	mCŞumnFamy
> 
	mCOLUMN_FAMILIES
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

58 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mSŒšg
, 
	mLock
> 
	mCOLUMN_FAMILY_LOCKS
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

60 @
Ov”ride


61 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

62 
	`synchrÚized
(
RocksDBCl›Á
.
şass
) {

63 if(
rocksDb
 =ğ
nuÎ
) {

64 
rocksDbDœ
 = 
P©hs
.
	`g‘
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
PROPERTY_ROCKSDB_DIR
));

65 
LOGGER
.
	`šfo
("RocksDB d©¨dœ: " + 
rocksDbDœ
);

67 
SŒšg
 
İtiÚsFeSŒšg
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
PROPERTY_ROCKSDB_OPTIONS_FILE
);

68 ià(
İtiÚsFeSŒšg
 !ğ
nuÎ
) {

69 
İtiÚsFe
 = 
P©hs
.
	`g‘
(
İtiÚsFeSŒšg
);

70 
LOGGER
.
	`šfo
("RocksDB o±iÚ fe: " + 
İtiÚsFe
);

73 
Œy
 {

74 ià(
İtiÚsFe
 !ğ
nuÎ
) {

75 
rocksDb
 = 
	`š™RocksDBW™hO±iÚsFe
();

77 
rocksDb
 = 
	`š™RocksDB
();

79 } 
	`ÿtch
 (
fš®
 
IOExû±iÚ
 | 
RocksDBExû±iÚ
 
e
) {

80 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

84 
»ã»nûs
++;

95 
´iv©e
 
RocksDB
 
	$š™RocksDBW™hO±iÚsFe
(è
throws
 
IOExû±iÚ
, 
RocksDBExû±iÚ
 {

96 if(!
Fes
.
	`exi¡s
(
rocksDbDœ
)) {

97 
Fes
.
	`ü—‹DœeùÜ›s
(
rocksDbDœ
);

100 
fš®
 
DBO±iÚs
 
İtiÚs
 = 
Ãw
 
	`DBO±iÚs
();

101 
fš®
 
Li¡
<
CŞumnFamyDesütÜ
> 
cfDesütÜs
 = 
Ãw
 
A¼ayLi¡
<>();

102 
fš®
 
Li¡
<
CŞumnFamyHªdË
> 
cfHªdËs
 = 
Ãw
 
A¼ayLi¡
<>();

104 
RocksDB
.
	`lßdLib¿ry
();

105 
O±iÚsUt
.
	`lßdO±iÚsFromFe
(
İtiÚsFe
.
	`toAbsŞu‹P©h
().
	`toSŒšg
(), 
Env
.
	`g‘DeçuÉ
(), 
İtiÚs
, 
cfDesütÜs
);

106 
dbO±iÚs
 = 
İtiÚs
;

108 
fš®
 
RocksDB
 
db
 = RocksDB.
	`İ’
(
İtiÚs
, 
rocksDbDœ
.
	`toAbsŞu‹P©h
().
	`toSŒšg
(), 
cfDesütÜs
, 
cfHªdËs
);

110 
i
 = 0; i < 
cfDesütÜs
.
	`size
(); i++) {

111 
SŒšg
 
cfName
 = 
Ãw
 
	`SŒšg
(
cfDesütÜs
.
	`g‘
(
i
).
	`g‘Name
());

112 
fš®
 
CŞumnFamyHªdË
 
cfHªdË
 = 
cfHªdËs
.
	`g‘
(
i
);

113 
fš®
 
CŞumnFamyO±iÚs
 
cfO±iÚs
 = 
cfDesütÜs
.
	`g‘
(
i
).
	`g‘O±iÚs
();

115 
COLUMN_FAMILIES
.
	`put
(
cfName
, 
Ãw
 
	`CŞumnFamy
(
cfHªdË
, 
cfO±iÚs
));

118  
db
;

119 
	}
}

128 
´iv©e
 
RocksDB
 
	$š™RocksDB
(è
throws
 
IOExû±iÚ
, 
RocksDBExû±iÚ
 {

129 if(!
Fes
.
	`exi¡s
(
rocksDbDœ
)) {

130 
Fes
.
	`ü—‹DœeùÜ›s
(
rocksDbDœ
);

133 
fš®
 
Li¡
<
SŒšg
> 
cfNames
 = 
	`lßdCŞumnFamyNames
();

134 
fš®
 
Li¡
<
CŞumnFamyO±iÚs
> 
cfO±iÚss
 = 
Ãw
 
A¼ayLi¡
<>();

135 
fš®
 
Li¡
<
CŞumnFamyDesütÜ
> 
cfDesütÜs
 = 
Ãw
 
A¼ayLi¡
<>();

137 
fš®
 
SŒšg
 
cfName
 : 
cfNames
) {

138 
fš®
 
CŞumnFamyO±iÚs
 
cfO±iÚs
 = 
Ãw
 
	`CŞumnFamyO±iÚs
()

139 .
	`İtimizeLev–StyËCom·ùiÚ
();

140 
fš®
 
CŞumnFamyDesütÜ
 
cfDesütÜ
 = 
Ãw
 
	`CŞumnFamyDesütÜ
(

141 
cfName
.
	`g‘By‹s
(
UTF_8
),

142 
cfO±iÚs


144 
cfO±iÚss
.
	`add
(
cfO±iÚs
);

145 
cfDesütÜs
.
	`add
(
cfDesütÜ
);

148 
fš®
 
rocksTh»ads
 = 
RuÁime
.
	`g‘RuÁime
().
	`avaabËProûssÜs
() * 2;

150 if(
cfDesütÜs
.
	`isEm±y
()) {

151 
fš®
 
O±iÚs
 
İtiÚs
 = 
Ãw
 
	`O±iÚs
()

152 .
	`İtimizeLev–StyËCom·ùiÚ
()

153 .
	`£tC»©eIfMissšg
(
Œue
)

154 .
	`£tC»©eMissšgCŞumnFam›s
(
Œue
)

155 .
	`£tInü—£P¬®Ëlism
(
rocksTh»ads
)

156 .
	`£tMaxBackgroundCom·ùiÚs
(
rocksTh»ads
)

157 .
	`£tInfoLogLev–
(
InfoLogLev–
.
INFO_LEVEL
);

158 
dbO±iÚs
 = 
İtiÚs
;

159  
RocksDB
.
	`İ’
(
İtiÚs
, 
rocksDbDœ
.
	`toAbsŞu‹P©h
().
	`toSŒšg
());

161 
fš®
 
DBO±iÚs
 
İtiÚs
 = 
Ãw
 
	`DBO±iÚs
()

162 .
	`£tC»©eIfMissšg
(
Œue
)

163 .
	`£tC»©eMissšgCŞumnFam›s
(
Œue
)

164 .
	`£tInü—£P¬®Ëlism
(
rocksTh»ads
)

165 .
	`£tMaxBackgroundCom·ùiÚs
(
rocksTh»ads
)

166 .
	`£tInfoLogLev–
(
InfoLogLev–
.
INFO_LEVEL
);

167 
dbO±iÚs
 = 
İtiÚs
;

169 
fš®
 
Li¡
<
CŞumnFamyHªdË
> 
cfHªdËs
 = 
Ãw
 
A¼ayLi¡
<>();

170 
fš®
 
RocksDB
 
db
 = RocksDB.
	`İ’
(
İtiÚs
, 
rocksDbDœ
.
	`toAbsŞu‹P©h
().
	`toSŒšg
(), 
cfDesütÜs
, 
cfHªdËs
);

171 
i
 = 0; i < 
cfNames
.
	`size
(); i++) {

172 
COLUMN_FAMILIES
.
	`put
(
cfNames
.
	`g‘
(
i
), 
Ãw
 
	`CŞumnFamy
(
cfHªdËs
.g‘(i), 
cfO±iÚss
.get(i)));

174  
db
;

176 
	}
}

178 @
Ov”ride


179 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

180 
su³r
.
	`ş—nup
();

182 
	`synchrÚized
 (
RocksDBCl›Á
.
şass
) {

183 
Œy
 {

184 ià(
»ã»nûs
 == 1) {

185 
fš®
 
CŞumnFamy
 
cf
 : 
COLUMN_FAMILIES
.
	`v®ues
()) {

186 
cf
.
	`g‘HªdË
().
	`şo£
();

189 
rocksDb
.
	`şo£
();

190 
rocksDb
 = 
nuÎ
;

192 
dbO±iÚs
.
	`şo£
();

193 
dbO±iÚs
 = 
nuÎ
;

195 
fš®
 
CŞumnFamy
 
cf
 : 
COLUMN_FAMILIES
.
	`v®ues
()) {

196 
cf
.
	`g‘O±iÚs
().
	`şo£
();

198 
	`§veCŞumnFamyNames
();

199 
COLUMN_FAMILIES
.
	`ş—r
();

201 
rocksDbDœ
 = 
nuÎ
;

204 } 
	`ÿtch
 (
fš®
 
IOExû±iÚ
 
e
) {

205 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

206 } 
fš®ly
 {

207 
»ã»nûs
--;

210 
	}
}

212 @
Ov”ride


213 
public
 
Stus
 
»ad
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
S‘
<SŒšg> 
f›lds
,

214 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

215 
	gŒy
 {

216 ià(!
	gCOLUMN_FAMILIES
.
cÚšsKey
(
bË
)) {

217 
ü—‹CŞumnFamy
(
bË
);

220 
fš®
 
CŞumnFamyHªdË
 
	gcf
 = 
COLUMN_FAMILIES
.
g‘
(
bË
).
g‘HªdË
();

221 
fš®
 
	gby‹
[] 
	gv®ues
 = 
rocksDb
.
g‘
(
cf
, 
key
.
g‘By‹s
(
UTF_8
));

222 if(
	gv®ues
 =ğ
nuÎ
) {

223  
Stus
.
NOT_FOUND
;

225 
de£rŸlizeV®ues
(
v®ues
, 
f›lds
, 
»suÉ
);

226  
	gStus
.
	gOK
;

227 } 
ÿtch
(
fš®
 
RocksDBExû±iÚ
 
e
) {

228 
	gLOGGER
.
”rÜ
(
e
.
g‘Mes§ge
(),ƒ);

229  
	gStus
.
	gERROR
;

233 @
Ov”ride


234 
public
 
Stus
 
sÿn
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
¡¬tkey
, fš® 
»cÜdcouÁ
, fš® 
S‘
<SŒšg> 
f›lds
,

235 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

236 
	gŒy
 {

237 ià(!
	gCOLUMN_FAMILIES
.
cÚšsKey
(
bË
)) {

238 
ü—‹CŞumnFamy
(
bË
);

241 
fš®
 
CŞumnFamyHªdË
 
	gcf
 = 
COLUMN_FAMILIES
.
g‘
(
bË
).
g‘HªdË
();

242 
Œy
(
fš®
 
RocksI‹¿tÜ
 
™”©Ü
 = 
rocksDb
.
ÃwI‹¿tÜ
(
cf
)) {

243 
™”©iÚs
 = 0;

244 
	g™”©Ü
.
£ek
(
¡¬tkey
.
g‘By‹s
(
UTF_8
)); i‹¿tÜ.
isV®id
(è&& 
	g™”©iÚs
 < 
	g»cÜdcouÁ
;

245 
	g™”©Ü
.
Ãxt
()) {

246 
fš®
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gv®ues
 = 
Ãw
 
HashM­
<>();

247 
de£rŸlizeV®ues
(
™”©Ü
.
v®ue
(), 
f›lds
, 
v®ues
);

248 
	g»suÉ
.
add
(
v®ues
);

249 
	g™”©iÚs
++;

253  
	gStus
.
	gOK
;

254 } 
ÿtch
(
fš®
 
RocksDBExû±iÚ
 
e
) {

255 
	gLOGGER
.
”rÜ
(
e
.
g‘Mes§ge
(),ƒ);

256  
	gStus
.
	gERROR
;

260 @
Ov”ride


261 
public
 
Stus
 
upd©e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

264 
	gŒy
 {

265 ià(!
	gCOLUMN_FAMILIES
.
cÚšsKey
(
bË
)) {

266 
ü—‹CŞumnFamy
(
bË
);

269 
fš®
 
CŞumnFamyHªdË
 
	gcf
 = 
COLUMN_FAMILIES
.
g‘
(
bË
).
g‘HªdË
();

270 
fš®
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»suÉ
 = 
Ãw
 
HashM­
<>();

271 
fš®
 
	gby‹
[] 
	gcu¼’tV®ues
 = 
rocksDb
.
g‘
(
cf
, 
key
.
g‘By‹s
(
UTF_8
));

272 if(
	gcu¼’tV®ues
 =ğ
nuÎ
) {

273  
Stus
.
NOT_FOUND
;

275 
de£rŸlizeV®ues
(
cu¼’tV®ues
, 
nuÎ
, 
»suÉ
);

278 
	g»suÉ
.
putAÎ
(
v®ues
);

281 
	grocksDb
.
put
(
cf
, 
key
.
g‘By‹s
(
UTF_8
), 
£rŸlizeV®ues
(
»suÉ
));

283  
	gStus
.
	gOK
;

285 } 
ÿtch
(
fš®
 
RocksDBExû±iÚ
 | 
IOExû±iÚ
 
e
) {

286 
	gLOGGER
.
”rÜ
(
e
.
g‘Mes§ge
(),ƒ);

287  
	gStus
.
	gERROR
;

291 @
Ov”ride


292 
public
 
Stus
 
š£¹
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

293 
	gŒy
 {

294 ià(!
	gCOLUMN_FAMILIES
.
cÚšsKey
(
bË
)) {

295 
ü—‹CŞumnFamy
(
bË
);

298 
fš®
 
CŞumnFamyHªdË
 
	gcf
 = 
COLUMN_FAMILIES
.
g‘
(
bË
).
g‘HªdË
();

299 
	grocksDb
.
put
(
cf
, 
key
.
g‘By‹s
(
UTF_8
), 
£rŸlizeV®ues
(
v®ues
));

301  
	gStus
.
	gOK
;

302 } 
ÿtch
(
fš®
 
RocksDBExû±iÚ
 | 
IOExû±iÚ
 
e
) {

303 
	gLOGGER
.
”rÜ
(
e
.
g‘Mes§ge
(),ƒ);

304  
	gStus
.
	gERROR
;

308 @
Ov”ride


309 
public
 
Stus
 
	$d–‘e
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
) {

310 
Œy
 {

311 ià(!
COLUMN_FAMILIES
.
	`cÚšsKey
(
bË
)) {

312 
	`ü—‹CŞumnFamy
(
bË
);

315 
fš®
 
CŞumnFamyHªdË
 
cf
 = 
COLUMN_FAMILIES
.
	`g‘
(
bË
).
	`g‘HªdË
();

316 
rocksDb
.
	`d–‘e
(
cf
, 
key
.
	`g‘By‹s
(
UTF_8
));

318  
Stus
.
OK
;

319 } 
	`ÿtch
(
fš®
 
RocksDBExû±iÚ
 
e
) {

320 
LOGGER
.
	`”rÜ
(
e
.
	`g‘Mes§ge
(),ƒ);

321  
Stus
.
ERROR
;

323 
	}
}

325 
´iv©e
 
	$§veCŞumnFamyNames
(è
throws
 
IOExû±iÚ
 {

326 
fš®
 
P©h
 
fe
 = 
rocksDbDœ
.
	`»sŞve
(
COLUMN_FAMILY_NAMES_FILENAME
);

327 
	`Œy
(
fš®
 
PrštWr™”
 
wr™”
 = 
Ãw
 
	`PrštWr™”
(
Fes
.
	`ÃwBufã»dWr™”
(
fe
, 
UTF_8
))) {

328 
wr™”
.
	`´šn
(
Ãw
 
	`SŒšg
(
RocksDB
.
DEFAULT_COLUMN_FAMILY
, 
UTF_8
));

329 
fš®
 
SŒšg
 
cfName
 : 
COLUMN_FAMILIES
.
	`keyS‘
()) {

330 
wr™”
.
	`´šn
(
cfName
);

333 
	}
}

335 
´iv©e
 
	gLi¡
<
	gSŒšg
> 
	$lßdCŞumnFamyNames
(è
throws
 
IOExû±iÚ
 {

336 
fš®
 
Li¡
<
SŒšg
> 
cfNames
 = 
Ãw
 
A¼ayLi¡
<>();

337 
fš®
 
P©h
 
fe
 = 
rocksDbDœ
.
	`»sŞve
(
COLUMN_FAMILY_NAMES_FILENAME
);

338 if(
Fes
.
	`exi¡s
(
fe
)) {

339 
	`Œy
 (
fš®
 
LšeNumb”R—d”
 
»ad”
 =

340 
Ãw
 
	`LšeNumb”R—d”
(
Fes
.
	`ÃwBufã»dR—d”
(
fe
, 
UTF_8
))) {

341 
SŒšg
 
lše
 = 
nuÎ
;

342 (
lše
 = 
»ad”
.
	`»adLše
()è!ğ
nuÎ
) {

343 
cfNames
.
	`add
(
lše
);

347  
cfNames
;

348 
	}
}

350 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
de£rŸlizeV®ues
(
fš®
 
by‹
[] 
v®ues
, fš® 
S‘
<
SŒšg
> 
f›lds
,

351 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

352 
fš®
 
By‹Bufãr
 
	gbuf
 = By‹Bufãr.
®loÿ‹
(4);

354 
	goff£t
 = 0;

355 
	goff£t
 < 
	gv®ues
.
	gËngth
) {

356 
	gbuf
.
put
(
v®ues
, 
off£t
, 4);

357 
	gbuf
.
æ
();

358 
fš®
 
	gkeyL’
 = 
buf
.
g‘IÁ
();

359 
	gbuf
.
ş—r
();

360 
	goff£t
 += 4;

362 
fš®
 
SŒšg
 
	gkey
 = 
Ãw
 SŒšg(
v®ues
, 
off£t
, 
keyL’
);

363 
	goff£t
 +ğ
keyL’
;

365 
	gbuf
.
put
(
v®ues
, 
off£t
, 4);

366 
	gbuf
.
æ
();

367 
fš®
 
	gv®ueL’
 = 
buf
.
g‘IÁ
();

368 
	gbuf
.
ş—r
();

369 
	goff£t
 += 4;

371 if(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
cÚšs
(
key
)) {

372 
»suÉ
.
put
(
key
, 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
v®ues
, 
off£t
, 
v®ueL’
));

375 
	goff£t
 +ğ
v®ueL’
;

378  
	g»suÉ
;

381 
´iv©e
 
	gby‹
[] 
£rŸlizeV®ues
(
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
è
throws
 
	gIOExû±iÚ
 {

382 
Œy
(
fš®
 
By‹A¼ayOuutSŒ—m
 
baos
 = 
Ãw
 ByteArrayOutputStream()) {

383 
fš®
 
By‹Bufãr
 
buf
 = By‹Bufãr.
®loÿ‹
(4);

385 
fš®
 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gv®ue
 : 
v®ues
.
’ŒyS‘
()) {

386 
fš®
 
by‹
[] 
keyBy‹s
 = 
v®ue
.
g‘Key
().
g‘By‹s
(
UTF_8
);

387 
fš®
 
	gby‹
[] 
	gv®ueBy‹s
 = 
v®ue
.
g‘V®ue
().
toA¼ay
();

389 
	gbuf
.
putIÁ
(
keyBy‹s
.
Ëngth
);

390 
	gbaos
.
wr™e
(
buf
.
¬¿y
());

391 
	gbaos
.
wr™e
(
keyBy‹s
);

393 
	gbuf
.
ş—r
();

395 
	gbuf
.
putIÁ
(
v®ueBy‹s
.
Ëngth
);

396 
	gbaos
.
wr™e
(
buf
.
¬¿y
());

397 
	gbaos
.
wr™e
(
v®ueBy‹s
);

399 
	gbuf
.
ş—r
();

401  
	gbaos
.
toBy‹A¼ay
();

405 
´iv©e
 
CŞumnFamyO±iÚs
 
	$g‘DeçuÉCŞumnFamyO±iÚs
(
fš®
 
SŒšg
 
de¡š©iÚCfName
) {

406 
fš®
 
CŞumnFamyO±iÚs
 
cfO±iÚs
;

408 ià(
COLUMN_FAMILIES
.
	`cÚšsKey
("default")) {

409 
LOGGER
.
	`w¬n
("nØcŞumÀçmy o±iÚ fÜ \"" + 
de¡š©iÚCfName
 + "\" " +

411 
cfO±iÚs
 = 
COLUMN_FAMILIES
.
	`g‘
("deçuÉ").
	`g‘O±iÚs
();

413 
LOGGER
.
	`w¬n
("nØcŞumÀçmy o±iÚ fÜƒ™h” \"" + 
de¡š©iÚCfName
 + "\" or " +

415 
cfO±iÚs
 = 
Ãw
 
	`CŞumnFamyO±iÚs
();

417 
LOGGER
.
	`w¬n
("Add‡ CFO±iÚ £ùiÚ fÜ \"" + 
de¡š©iÚCfName
 + "\"ohe options file, " +

420  
cfO±iÚs
;

421 
	}
}

423 
´iv©e
 
	$ü—‹CŞumnFamy
(
fš®
 
SŒšg
 
Çme
è
throws
 
RocksDBExû±iÚ
 {

424 
COLUMN_FAMILY_LOCKS
.
	`putIfAb£Á
(
Çme
, 
Ãw
 
	`R“Á¿ÁLock
());

426 
fš®
 
Lock
 
l
 = 
COLUMN_FAMILY_LOCKS
.
	`g‘
(
Çme
);

427 
l
.
	`lock
();

428 
Œy
 {

429 if(!
COLUMN_FAMILIES
.
	`cÚšsKey
(
Çme
)) {

430 
fš®
 
CŞumnFamyO±iÚs
 
cfO±iÚs
;

432 ià(
İtiÚsFe
 !ğ
nuÎ
) {

435 
cfO±iÚs
 = 
	`g‘DeçuÉCŞumnFamyO±iÚs
(
Çme
);

437 
cfO±iÚs
 = 
Ãw
 
	`CŞumnFamyO±iÚs
().
	`İtimizeLev–StyËCom·ùiÚ
();

440 
fš®
 
CŞumnFamyHªdË
 
cfHªdË
 = 
rocksDb
.
	`ü—‹CŞumnFamy
(

441 
Ãw
 
	`CŞumnFamyDesütÜ
(
Çme
.
	`g‘By‹s
(
UTF_8
), 
cfO±iÚs
)

443 
COLUMN_FAMILIES
.
	`put
(
Çme
, 
Ãw
 
	`CŞumnFamy
(
cfHªdË
, 
cfO±iÚs
));

445 } 
fš®ly
 {

446 
l
.
	`uÆock
();

448 
	}
}

450 
´iv©e
 
fš®
 cÏs 
	cCŞumnFamy
 {

451 
´iv©e
 
fš®
 
CŞumnFamyHªdË
 
	ghªdË
;

452 
´iv©e
 
fš®
 
CŞumnFamyO±iÚs
 
	gİtiÚs
;

454 
´iv©e
 
CŞumnFamy
(
fš®
 
CŞumnFamyHªdË
 
hªdË
, fš® 
CŞumnFamyO±iÚs
 
İtiÚs
) {

455 
	gthis
.
	ghªdË
 = 
hªdË
;

456 
	gthis
.
	gİtiÚs
 = 
İtiÚs
;

459 
public
 
CŞumnFamyHªdË
 
g‘HªdË
() {

460  
	ghªdË
;

463 
public
 
CŞumnFamyO±iÚs
 
g‘O±iÚs
() {

464  
	gİtiÚs
;

	@rocksdb/src/main/java/site/ycsb/db/rocksdb/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	grocksdb
;

	@rocksdb/src/test/java/site/ycsb/db/rocksdb/RocksDBClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	grocksdb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

24 
impÜt
 
	gÜg
.
	gjun™
.*;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gruËs
.
	gTempÜ¬yFŞd”
;

27 
impÜt
 
	gjava
.
	gut
.*;

29 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

31 
public
 cÏs 
	cRocksDBCl›ÁTe¡
 {

33 @
RuË


34 
public
 
TempÜ¬yFŞd”
 
	mtmpFŞd”
 = 
Ãw
 TemporaryFolder();

36 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_TABLE
 = "ycsb";

37 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_KEY0
 = "0";

38 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_KEY1
 = "1";

39 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_KEY2
 = "2";

40 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_KEY3
 = "3";

41 
´iv©e
 
fš®
 
	mNUM_RECORDS
 = 10;

42 
´iv©e
 
fš®
 
SŒšg
 
	mFIELD_PREFIX
 = 
CÜeWÜklßd
.
FIELD_NAME_PREFIX_DEFAULT
;

44 
´iv©e
 
fš®
 
	mM­
<
	mSŒšg
, 
	mBy‹I‹¿tÜ
> 
	mMOCK_DATA
;

46 
	mMOCK_DATA
 = 
Ãw
 
HashM­
<>(
NUM_RECORDS
);

47 
	mi
 = 0; i < 
	mNUM_RECORDS
; i++) {

48 
	mMOCK_DATA
.
put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
("value" + i));

52 
´iv©e
 
RocksDBCl›Á
 
	gš¡ªû
;

54 @
BefÜe


55 
public
 
	$£tup
(è
throws
 
Exû±iÚ
 {

56 
š¡ªû
 = 
Ãw
 
	`RocksDBCl›Á
();

58 
fš®
 
Prİ”t›s
 
´İ”t›s
 = 
Ãw
 
	`Prİ”t›s
();

59 
´İ”t›s
.
	`£tPrİ”ty
(
RocksDBCl›Á
.
PROPERTY_ROCKSDB_DIR
, 
tmpFŞd”
.
	`g‘RoÙ
().
	`g‘AbsŞu‹P©h
());

60 
š¡ªû
.
	`£tPrİ”t›s
(
´İ”t›s
);

62 
š¡ªû
.
	`š™
();

63 
	}
}

65 @
Aá”


66 
public
 
	$‹¬Down
(è
throws
 
Exû±iÚ
 {

67 
š¡ªû
.
	`ş—nup
();

68 
	}
}

70 @
Te¡


71 
public
 
	$š£¹AndR—d
(è
throws
 
Exû±iÚ
 {

72 
fš®
 
Stus
 
š£¹ResuÉ
 = 
š¡ªû
.
	`š£¹
(
MOCK_TABLE
, 
MOCK_KEY0
, 
MOCK_DATA
);

73 
	`as£¹Equ®s
(
Stus
.
OK
, 
š£¹ResuÉ
);

75 
fš®
 
S‘
<
SŒšg
> 
f›lds
 = 
MOCK_DATA
.
	`keyS‘
();

76 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉP¬am
 = 
Ãw
 
HashM­
<>(
NUM_RECORDS
);

77 
fš®
 
Stus
 
»adResuÉ
 = 
š¡ªû
.
	`»ad
(
MOCK_TABLE
, 
MOCK_KEY0
, 
f›lds
, 
»suÉP¬am
);

78 
	`as£¹Equ®s
(
Stus
.
OK
, 
»adResuÉ
);

79 
	}
}

81 @
Te¡


82 
public
 
	$š£¹AndD–‘e
(è
throws
 
Exû±iÚ
 {

83 
fš®
 
Stus
 
š£¹ResuÉ
 = 
š¡ªû
.
	`š£¹
(
MOCK_TABLE
, 
MOCK_KEY1
, 
MOCK_DATA
);

84 
	`as£¹Equ®s
(
Stus
.
OK
, 
š£¹ResuÉ
);

86 
fš®
 
Stus
 
»suÉ
 = 
š¡ªû
.
	`d–‘e
(
MOCK_TABLE
, 
MOCK_KEY1
);

87 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

88 
	}
}

90 @
Te¡


91 
public
 
	$š£¹Upd©eAndR—d
(è
throws
 
Exû±iÚ
 {

92 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ÃwV®ues
 = 
Ãw
 
HashM­
<>(
NUM_RECORDS
);

94 
fš®
 
Stus
 
š£¹ResuÉ
 = 
š¡ªû
.
	`š£¹
(
MOCK_TABLE
, 
MOCK_KEY2
, 
MOCK_DATA
);

95 
	`as£¹Equ®s
(
Stus
.
OK
, 
š£¹ResuÉ
);

97 
i
 = 0; i < 
NUM_RECORDS
; i++) {

98 
ÃwV®ues
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
("newvalue" + i));

101 
fš®
 
Stus
 
»suÉ
 = 
š¡ªû
.
	`upd©e
(
MOCK_TABLE
, 
MOCK_KEY2
, 
ÃwV®ues
);

102 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

105 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉP¬am
 = 
Ãw
 
HashM­
<>(
NUM_RECORDS
);

106 
š¡ªû
.
	`»ad
(
MOCK_TABLE
, 
MOCK_KEY2
, 
MOCK_DATA
.
	`keyS‘
(), 
»suÉP¬am
);

108 
i
 = 0; i < 
NUM_RECORDS
; i++) {

109 
	`as£¹Equ®s
("Ãwv®ue" + 
i
, 
»suÉP¬am
.
	`g‘
(
FIELD_PREFIX
 + i).
	`toSŒšg
());

111 
	}
}

113 @
Te¡


114 
public
 
	$š£¹AndSÿn
(è
throws
 
Exû±iÚ
 {

115 
fš®
 
Stus
 
š£¹ResuÉ
 = 
š¡ªû
.
	`š£¹
(
MOCK_TABLE
, 
MOCK_KEY3
, 
MOCK_DATA
);

116 
	`as£¹Equ®s
(
Stus
.
OK
, 
š£¹ResuÉ
);

118 
fš®
 
S‘
<
SŒšg
> 
f›lds
 = 
MOCK_DATA
.
	`keyS‘
();

119 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉP¬am
 = 
Ãw
 VeùÜ<>(
NUM_RECORDS
);

120 
fš®
 
Stus
 
»suÉ
 = 
š¡ªû
.
	`sÿn
(
MOCK_TABLE
, 
MOCK_KEY3
, 
NUM_RECORDS
, 
f›lds
, 
»suÉP¬am
);

121 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

122 
	}
}

	@rocksdb/src/test/java/site/ycsb/db/rocksdb/RocksDBOptionsFileTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	grocksdb
;

20 
impÜt
 
	gÜg
.
	gjun™
.*;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gruËs
.
	gTempÜ¬yFŞd”
;

22 
impÜt
 
	gÜg
.
	grocksdb
.*;

24 
impÜt
 
	gjava
.
	gut
.*;

26 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

28 
public
 cÏs 
	cRocksDBO±iÚsFeTe¡
 {

30 @
RuË


31 
public
 
TempÜ¬yFŞd”
 
	mtmpFŞd”
 = 
Ãw
 TemporaryFolder();

33 
´iv©e
 
RocksDBCl›Á
 
	mš¡ªû
;

35 @
Te¡


36 
public
 
	$lßdO±iÚsFromFe
(è
throws
 
Exû±iÚ
 {

37 
fš®
 
SŒšg
 
İtiÚsP©h
 = 
RocksDBCl›Á
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("‹¡ÿ£.ši").
	`g‘P©h
();

38 
fš®
 
SŒšg
 
dbP©h
 = 
tmpFŞd”
.
	`g‘RoÙ
().
	`g‘AbsŞu‹P©h
();

40 
	`š™DbW™hO±iÚsFe
(
dbP©h
, 
İtiÚsP©h
);

41 
	`checkO±iÚs
(
dbP©h
);

44 
´iv©e
 
	$š™DbW™hO±iÚsFe
(
fš®
 
SŒšg
 
dbP©h
, fš® SŒšg 
İtiÚsP©h
è
throws
 
Exû±iÚ
 {

45 
š¡ªû
 = 
Ãw
 
	`RocksDBCl›Á
();

47 
fš®
 
Prİ”t›s
 
´İ”t›s
 = 
Ãw
 
	`Prİ”t›s
();

48 
´İ”t›s
.
	`£tPrİ”ty
(
RocksDBCl›Á
.
PROPERTY_ROCKSDB_DIR
, 
dbP©h
);

49 
´İ”t›s
.
	`£tPrİ”ty
(
RocksDBCl›Á
.
PROPERTY_ROCKSDB_OPTIONS_FILE
, 
İtiÚsP©h
);

50 
š¡ªû
.
	`£tPrİ”t›s
(
´İ”t›s
);

52 
š¡ªû
.
	`š™
();

53 
š¡ªû
.
	`ş—nup
();

54 
	}
}

56 
´iv©e
 
	$checkO±iÚs
(
fš®
 
SŒšg
 
dbP©h
è
throws
 
Exû±iÚ
 {

57 
fš®
 
Li¡
<
CŞumnFamyDesütÜ
> 
cfDesütÜs
 = 
Ãw
 
A¼ayLi¡
<>();

58 
fš®
 
DBO±iÚs
 
dbO±iÚs
 = 
Ãw
 
	`DBO±iÚs
();

60 
RocksDB
.
	`lßdLib¿ry
();

61 
O±iÚsUt
.
	`lßdL©e¡O±iÚs
(
dbP©h
, 
Env
.
	`g‘DeçuÉ
(), 
dbO±iÚs
, 
cfDesütÜs
);

63 
Œy
 {

64 
	`as£¹Equ®s
(
dbO±iÚs
.
	`w®SizeLim™MB
(), 42);

67 
	`as£¹Equ®s
(
cfDesütÜs
.
	`size
(), 2);

68 
	`as£¹Equ®s
(
cfDesütÜs
.
	`g‘
(0).
	`g‘O±iÚs
().
	`‰l
(), 42);

69 
	`as£¹Equ®s
(
cfDesütÜs
.
	`g‘
(1).
	`g‘O±iÚs
().
	`‰l
(), 42);

71 
fš®ly
 {

72 
dbO±iÚs
.
	`şo£
();

74 
	}
}

	@s3/src/main/java/site/ycsb/db/S3Client.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

21 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

25 
impÜt
 
	gjava
.
	gio
.
	gBy‹A¼ayIÅutSŒ—m
;

26 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

27 
impÜt
 
	gjava
.
	gut
.*;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

29 
impÜt
 
	gjava
.
	gÃt
.*;

31 
impÜt
 
	gcom
.
	gamazÚaws
.
	gut
.
	gIOUts
;

32 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

34 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

35 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

38 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gAmazÚS3Cl›Á
;

39 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.*;

40 
impÜt
 
	gcom
.
	gamazÚaws
.
	gauth
.*;

41 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gmod–
.
	gObjeùM‘ad©a
;

42 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gmod–
.
	gPutObjeùResuÉ
;

43 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gmod–
.
	gS3Objeù
;

44 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gmod–
.
	gG‘ObjeùReque¡
;

45 
impÜt
 
	gcom
.
	gamazÚaws
.
	gCl›ÁCÚfigu¿tiÚ
;

46 
impÜt
 
	gcom
.
	gamazÚaws
.
	g»giÚs
.
	gRegiÚ
;

47 
impÜt
 
	gcom
.
	gamazÚaws
.
	g»giÚs
.
	gRegiÚs
;

48 
impÜt
 
	gcom
.
	gamazÚaws
.
	gPrÙocŞ
;

49 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gmod–
.
	gD–‘eObjeùReque¡
;

50 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gmod–
.
	gObjeùLi¡šg
;

51 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gmod–
.
	gS3ObjeùSumm¬y
;

52 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gmod–
.
	gSSECu¡om”Key
;

53 
impÜt
 
	gcom
.
	gamazÚaws
.
	g£rviûs
.
	gs3
.
	gmod–
.
	gPutObjeùReque¡
;

75 
public
 cÏs 
	cS3Cl›Á
 
ex‹nds
 
	mDB
 {

77 
´iv©e
 
AmazÚS3Cl›Á
 
	ms3Cl›Á
;

78 
´iv©e
 
SŒšg
 
	ms£
;

79 
´iv©e
 
SSECu¡om”Key
 
	ms£cKey
;

80 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	mINIT_COUNT
 = 
Ãw
 AtomicInteger(0);

86 @
Ov”ride


87 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

88 ià(
INIT_COUNT
.
	`deüem’tAndG‘
() == 0) {

89 
Œy
 {

90 
s3Cl›Á
.
	`shutdown
();

91 
Sy¡em
.
out
.
	`´šn
("The client is shutdown successfully");

92 } 
	`ÿtch
 (
Exû±iÚ
 
e
){

93 
Sy¡em
.
”r
.
	`´šn
("Could‚Ù shutdowÀthS3Cl›Á: "+
e
.
	`toSŒšg
());

94 
e
.
	`´štSckT¿û
();

95 } 
fš®ly
 {

96 ià(
s3Cl›Á
 !ğ
nuÎ
){

97 
s3Cl›Á
 = 
nuÎ
;

112 @
Ov”ride


113 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
buck‘
, SŒšg 
key
) {

114 
Œy
 {

115 
s3Cl›Á
.
	`d–‘eObjeù
(
Ãw
 
	`D–‘eObjeùReque¡
(
buck‘
, 
key
));

116 } 
	`ÿtch
 (
Exû±iÚ
 
e
){

117 
Sy¡em
.
”r
.
	`´šn
("NÙ…ossibËØd–‘thkey "+
key
);

118 
e
.
	`´štSckT¿û
();

119  
Stus
.
ERROR
;

121  
Stus
.
OK
;

122 
	}
}

127 @
Ov”ride


128 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

129 
fš®
 
couÁ
 = 
INIT_COUNT
.
	`šüem’tAndG‘
();

130 
	`synchrÚized
 (
S3Cl›Á
.
şass
){

131 
Prİ”t›s
 
´İsCL
 = 
	`g‘Prİ”t›s
();

132 
»cÜdcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(

133 
´İsCL
.
	`g‘Prİ”ty
("recordcount"));

134 
İ”©iÚcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(

135 
´İsCL
.
	`g‘Prİ”ty
("operationcount"));

136 
numb”OfO³¿tiÚs
 = 0;

137 ià(
»cÜdcouÁ
 > 0){

138 ià(
»cÜdcouÁ
 > 
İ”©iÚcouÁ
){

139 
numb”OfO³¿tiÚs
 = 
»cÜdcouÁ
;

141 
numb”OfO³¿tiÚs
 = 
İ”©iÚcouÁ
;

144 
numb”OfO³¿tiÚs
 = 
İ”©iÚcouÁ
;

146 ià(
couÁ
 <ğ
numb”OfO³¿tiÚs
) {

147 
SŒšg
 
acûssKeyId
 = 
nuÎ
;

148 
SŒšg
 
£ü‘Key
 = 
nuÎ
;

149 
SŒšg
 
’dPošt
 = 
nuÎ
;

150 
SŒšg
 
»giÚ
 = 
nuÎ
;

151 
SŒšg
 
maxE¼ÜR‘ry
 = 
nuÎ
;

152 
SŒšg
 
maxCÚÃùiÚs
 = 
nuÎ
;

153 
SŒšg
 
´ÙocŞ
 = 
nuÎ
;

154 
BasicAWSC»d’tŸls
 
s3C»d’tŸls
;

155 
Cl›ÁCÚfigu¿tiÚ
 
ş›ÁCÚfig
;

156 ià(
s3Cl›Á
 !ğ
nuÎ
) {

157 
Sy¡em
.
out
.
	`´šn
("Reusinghe same client");

160 
Œy
 {

161 
IÅutSŒ—m
 
´İFe
 = 
S3Cl›Á
.
şass
.
	`g‘CÏssLßd”
()

162 .
	`g‘ResourûAsSŒ—m
("s3.properties");

163 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
(
Sy¡em
.
	`g‘Prİ”t›s
());

164 
´İs
.
	`lßd
(
´İFe
);

165 
acûssKeyId
 = 
´İs
.
	`g‘Prİ”ty
("s3.accessKeyId");

166 ià(
acûssKeyId
 =ğ
nuÎ
){

167 
acûssKeyId
 = 
´İsCL
.
	`g‘Prİ”ty
("s3.accessKeyId");

169 
Sy¡em
.
out
.
	`´šn
(
acûssKeyId
);

170 
£ü‘Key
 = 
´İs
.
	`g‘Prİ”ty
("s3.secretKey");

171 ià(
£ü‘Key
 =ğ
nuÎ
){

172 
£ü‘Key
 = 
´İsCL
.
	`g‘Prİ”ty
("s3.secretKey");

174 
Sy¡em
.
out
.
	`´šn
(
£ü‘Key
);

175 
’dPošt
 = 
´İs
.
	`g‘Prİ”ty
("s3.endPoint");

176 ià(
’dPošt
 =ğ
nuÎ
){

177 
’dPošt
 = 
´İsCL
.
	`g‘Prİ”ty
("s3.endPoint", "s3.amazonaws.com");

179 
Sy¡em
.
out
.
	`´šn
(
’dPošt
);

180 
»giÚ
 = 
´İs
.
	`g‘Prİ”ty
("s3.region");

181 ià(
»giÚ
 =ğ
nuÎ
){

182 
»giÚ
 = 
´İsCL
.
	`g‘Prİ”ty
("s3.region", "us-east-1");

184 
Sy¡em
.
out
.
	`´šn
(
»giÚ
);

185 
maxE¼ÜR‘ry
 = 
´İs
.
	`g‘Prİ”ty
("s3.maxErrorRetry");

186 ià(
maxE¼ÜR‘ry
 =ğ
nuÎ
){

187 
maxE¼ÜR‘ry
 = 
´İsCL
.
	`g‘Prİ”ty
("s3.maxErrorRetry", "15");

189 
maxCÚÃùiÚs
 = 
´İs
.
	`g‘Prİ”ty
("s3.maxConnections");

190 ià(
maxCÚÃùiÚs
 =ğ
nuÎ
){

191 
maxCÚÃùiÚs
 = 
´İsCL
.
	`g‘Prİ”ty
("s3.maxConnections");

193 
´ÙocŞ
 = 
´İs
.
	`g‘Prİ”ty
("s3.protocol");

194 ià(
´ÙocŞ
 =ğ
nuÎ
){

195 
´ÙocŞ
 = 
´İsCL
.
	`g‘Prİ”ty
("s3.protocol", "HTTPS");

197 
s£
 = 
´İs
.
	`g‘Prİ”ty
("s3.sse");

198 ià(
s£
 =ğ
nuÎ
){

199 
s£
 = 
´İsCL
.
	`g‘Prİ”ty
("s3.sse", "false");

201 
SŒšg
 
s£c
 = 
´İs
.
	`g‘Prİ”ty
("s3.ssec");

202 ià(
s£c
 =ğ
nuÎ
){

203 
s£c
 = 
´İsCL
.
	`g‘Prİ”ty
("s3.s£c", 
nuÎ
);

205 
s£cKey
 = 
Ãw
 
	`SSECu¡om”Key
(
s£c
);

207 } 
	`ÿtch
 (
Exû±iÚ
 
e
){

208 
Sy¡em
.
”r
.
	`´šn
("Thf´İ”t› dÛ¢'ˆexi¡ "+
e
.
	`toSŒšg
());

209 
e
.
	`´štSckT¿û
();

211 
Œy
 {

212 
Sy¡em
.
out
.
	`´šn
("Inizializinghe S3 connection");

213 
s3C»d’tŸls
 = 
Ãw
 
	`BasicAWSC»d’tŸls
(
acûssKeyId
, 
£ü‘Key
);

214 
ş›ÁCÚfig
 = 
Ãw
 
	`Cl›ÁCÚfigu¿tiÚ
();

215 
ş›ÁCÚfig
.
	`£tMaxE¼ÜR‘ry
(
IÁeg”
.
	`·r£IÁ
(
maxE¼ÜR‘ry
));

216 if(
´ÙocŞ
.
	`equ®s
("HTTP")) {

217 
ş›ÁCÚfig
.
	`£tPrÙocŞ
(
PrÙocŞ
.
HTTP
);

219 
ş›ÁCÚfig
.
	`£tPrÙocŞ
(
PrÙocŞ
.
HTTPS
);

221 if(
maxCÚÃùiÚs
 !ğ
nuÎ
) {

222 
ş›ÁCÚfig
.
	`£tMaxCÚÃùiÚs
(
IÁeg”
.
	`·r£IÁ
(
maxCÚÃùiÚs
));

224 
s3Cl›Á
 = 
Ãw
 
	`AmazÚS3Cl›Á
(
s3C»d’tŸls
, 
ş›ÁCÚfig
);

225 
s3Cl›Á
.
	`£tRegiÚ
(
RegiÚ
.
	`g‘RegiÚ
(
RegiÚs
.
	`äomName
(
»giÚ
)));

226 
s3Cl›Á
.
	`£tEndpošt
(
’dPošt
);

227 
Sy¡em
.
out
.
	`´šn
("Connection successfully initialized");

228 } 
	`ÿtch
 (
Exû±iÚ
 
e
){

229 
Sy¡em
.
”r
.
	`´šn
("Could‚Ù cÚÃùØS3 stÜage: "+ 
e
.
	`toSŒšg
());

230 
e
.
	`´štSckT¿û
();

231 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

234 
Sy¡em
.
”r
.
	`´šn
(

236 
throw
 
Ãw
 
	`DBExû±iÚ
Òew 
	`E¼Ü
(

240 
	}
}

259 @
Ov”ride


260 
public
 
Stus
 
š£¹
(
SŒšg
 
buck‘
, SŒšg 
key
,

261 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

262  
wr™eToStÜage
(
buck‘
, 
key
, 
v®ues
, 
Œue
, 
s£
, 
s£cKey
);

279 @
Ov”ride


280 
public
 
Stus
 
»ad
(
SŒšg
 
buck‘
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

281 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

282  
»adFromStÜage
(
buck‘
, 
key
, 
»suÉ
, 
s£cKey
);

297 @
Ov”ride


298 
public
 
Stus
 
upd©e
(
SŒšg
 
buck‘
, SŒšg 
key
,

299 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

300  
wr™eToStÜage
(
buck‘
, 
key
, 
v®ues
, 
çl£
, 
s£
, 
s£cKey
);

319 @
Ov”ride


320 
public
 
Stus
 
sÿn
(
SŒšg
 
buck‘
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

321 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

322  
sÿnFromStÜage
(
buck‘
, 
¡¬tkey
, 
»cÜdcouÁ
, 
»suÉ
, 
s£cKey
);

338 
´Ùeùed
 
Stus
 
wr™eToStÜage
(
SŒšg
 
buck‘
, SŒšg 
key
,

339 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
, 
BoŞ—n
 
upd©eM¬k”
,

340 
SŒšg
 
s£Loÿl
, 
SSECu¡om”Key
 
s£cLoÿl
) {

341 
	gtÙ®Size
 = 0;

342 
	gf›ldCouÁ
 = 
v®ues
.
size
();

344 
Objeù
 
	gkeyToS—rch
 = 
v®ues
.
keyS‘
().
toA¼ay
()[0];

346 
	gby‹
[] 
	gsourûA¼ay
 = 
v®ues
.
g‘
(
keyToS—rch
).
toA¼ay
();

347 
	gsizeA¼ay
 = 
sourûA¼ay
.
Ëngth
;

348 ià(
	gupd©eM¬k”
){

349 
	gtÙ®Size
 = 
sizeA¼ay
*
f›ldCouÁ
;

351 
	gŒy
 {

352 
S3Objeù
 
	gobjeù
 = 
g‘S3ObjeùAndM‘ad©a
(
buck‘
, 
key
, 
s£cLoÿl
);

353 
	gsizeOfFe
 = ()
objeù
.
g‘ObjeùM‘ad©a
().
g‘CÚ‹ÁL’gth
();

354 
	gf›ldCouÁ
 = 
sizeOfFe
/
sizeA¼ay
;

355 
	gtÙ®Size
 = 
sizeOfFe
;

356 
	gobjeù
.
şo£
();

357 } 
ÿtch
 (
Exû±iÚ
 
e
){

358 
	gSy¡em
.
	g”r
.
´šn
("NÙ…ossibËØg‘hobjeù :"+
key
);

359 
	ge
.
´štSckT¿û
();

360  
	gStus
.
	gERROR
;

363 
	gby‹
[] 
	gde¡š©iÚA¼ay
 = 
Ãw
 
by‹
[
tÙ®Size
];

364 
	goff£t
 = 0;

365 
	gi
 = 0; i < 
	gf›ldCouÁ
; i++) {

366 
	gSy¡em
.
¬¿ycİy
(
sourûA¼ay
, 0, 
de¡š©iÚA¼ay
, 
off£t
, 
sizeA¼ay
);

367 
	goff£t
 +ğ
sizeA¼ay
;

369 
Œy
 (
IÅutSŒ—m
 
šput
 = 
Ãw
 
By‹A¼ayIÅutSŒ—m
(
de¡š©iÚA¼ay
)) {

370 
ObjeùM‘ad©a
 
m‘ad©a
 = 
Ãw
 ObjectMetadata();

371 
	gm‘ad©a
.
£tCÚ‹ÁL’gth
(
tÙ®Size
);

372 
PutObjeùReque¡
 
	gputObjeùReque¡
 = 
nuÎ
;

373 ià(
	gs£Loÿl
.
equ®s
("true")) {

374 
	gm‘ad©a
.
£tSSEAlgÜ™hm
(
ObjeùM‘ad©a
.
AES_256_SERVER_SIDE_ENCRYPTION
);

375 
	gputObjeùReque¡
 = 
Ãw
 
PutObjeùReque¡
(
buck‘
, 
key
,

376 
šput
, 
m‘ad©a
);

377 } ià(
	gs£cLoÿl
 !ğ
nuÎ
) {

378 
putObjeùReque¡
 = 
Ãw
 
PutObjeùReque¡
(
buck‘
, 
key
,

379 
šput
, 
m‘ad©a
).
w™hSSECu¡om”Key
(
s£cLoÿl
);

381 
	gputObjeùReque¡
 = 
Ãw
 
PutObjeùReque¡
(
buck‘
, 
key
,

382 
šput
, 
m‘ad©a
);

385 
	gŒy
 {

386 
PutObjeùResuÉ
 
	g»s
 =

387 
s3Cl›Á
.
putObjeù
(
putObjeùReque¡
);

388 if(
	g»s
.
g‘ETag
(è=ğ
nuÎ
) {

389  
Stus
.
ERROR
;

391 ià(
	gs£Loÿl
.
equ®s
("true")) {

392 
	gSy¡em
.
	gout
.
´šn
("Uploaded objectƒncryption status is " +

393 
»s
.
g‘SSEAlgÜ™hm
());

394 } ià(
	gs£cLoÿl
 !ğ
nuÎ
) {

395 
Sy¡em
.
out
.
´šn
("Uploaded objectƒncryption status is " +

396 
»s
.
g‘SSEAlgÜ™hm
());

399 } 
ÿtch
 (
Exû±iÚ
 
e
) {

400 
	gSy¡em
.
	g”r
.
´šn
("NÙ…ossibËØwr™objeù :"+
key
);

401 
	ge
.
´štSckT¿û
();

402  
	gStus
.
	gERROR
;

404 } 
ÿtch
 (
Exû±iÚ
 
e
) {

405 
	gSy¡em
.
	g”r
.
´šn
("E¼Ü iÀthü—tiÚ oàth¡»am :"+
e
.
toSŒšg
());

406 
	ge
.
´štSckT¿û
();

407  
	gStus
.
	gERROR
;

410  
	gStus
.
	gOK
;

424 
´Ùeùed
 
Stus
 
»adFromStÜage
(
SŒšg
 
buck‘
, SŒšg 
key
,

425 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
, 
SSECu¡om”Key
 
s£cLoÿl
) {

426 
	gŒy
 {

427 
S3Objeù
 
	gobjeù
 = 
g‘S3ObjeùAndM‘ad©a
(
buck‘
, 
key
, 
s£cLoÿl
);

428 
IÅutSŒ—m
 
	gobjeùD©a
 = 
objeù
.
g‘ObjeùCÚ‹Á
();

430 
	g»suÉ
.
put
(
key
, 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
IOUts
.
toBy‹A¼ay
(
objeùD©a
)));

431 
	gobjeùD©a
.
şo£
();

432 
	gobjeù
.
şo£
();

433 } 
ÿtch
 (
Exû±iÚ
 
e
){

434 
	gSy¡em
.
	g”r
.
´šn
("NÙ…ossibËØg‘hobjeù "+
key
);

435 
	ge
.
´štSckT¿û
();

436  
	gStus
.
	gERROR
;

439  
	gStus
.
	gOK
;

442 
´iv©e
 
S3Objeù
 
	$g‘S3ObjeùAndM‘ad©a
(
SŒšg
 
buck‘
,

443 
SŒšg
 
key
, 
SSECu¡om”Key
 
s£cLoÿl
) {

444 
G‘ObjeùReque¡
 
g‘ObjeùReque¡
;

445 ià(
s£cLoÿl
 !ğ
nuÎ
) {

446 
g‘ObjeùReque¡
 = 
Ãw
 
	`G‘ObjeùReque¡
(
buck‘
,

447 
key
).
	`w™hSSECu¡om”Key
(
s£cLoÿl
);

449 
g‘ObjeùReque¡
 = 
Ãw
 
	`G‘ObjeùReque¡
(
buck‘
, 
key
);

452  
s3Cl›Á
.
	`g‘Objeù
(
g‘ObjeùReque¡
);

453 
	}
}

471 
´Ùeùed
 
Stus
 
sÿnFromStÜage
(
SŒšg
 
buck‘
, SŒšg 
¡¬tkey
,

472 
»cÜdcouÁ
, 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
,

473 
SSECu¡om”Key
 
s£cLoÿl
) {

475 
	gcouÁ”
 = 0;

476 
ObjeùLi¡šg
 
	gli¡šg
 = 
s3Cl›Á
.
li¡Objeùs
(
buck‘
);

477 
	gLi¡
<
	gS3ObjeùSumm¬y
> 
	gsumm¬›s
 = 
li¡šg
.
g‘ObjeùSumm¬›s
();

478 
	gLi¡
<
	gSŒšg
> 
	gkeyLi¡
 = 
Ãw
 
A¼ayLi¡
();

479 
	g¡¬tkeyNumb”
 = 0;

480 
	gnumb”OfI‹¿tiÚ
 = 0;

482 
	gli¡šg
.
isTrunÿ‹d
()) {

483 
	gli¡šg
 = 
s3Cl›Á
.
li¡NextB©chOfObjeùs
(
li¡šg
);

484 
	gsumm¬›s
.
addAÎ
(
li¡šg
.
g‘ObjeùSumm¬›s
());

486 
S3ObjeùSumm¬y
 
	gsumm¬y
 : 
summ¬›s
) {

487 
SŒšg
 
summ¬yKey
 = 
summ¬y
.
g‘Key
();

488 
	gkeyLi¡
.
add
(
summ¬yKey
);

491 
	gCŞËùiÚs
.
sÜt
(
keyLi¡
);

493 
SŒšg
 
	gkey
 : 
keyLi¡
) {

494 ià(
key
.
equ®s
(
¡¬tkey
)){

495 
¡¬tkeyNumb”
 = 
couÁ”
;

497 
	gcouÁ”
 = 
couÁ”
 + 1;

502 ià(
	g»cÜdcouÁ
 < 
	gkeyLi¡
.
size
()) {

503 
	gnumb”OfI‹¿tiÚ
 = 
»cÜdcouÁ
;

505 
	gnumb”OfI‹¿tiÚ
 = 
keyLi¡
.
size
();

509 
	gi
 = 
¡¬tkeyNumb”
; i < 
	gnumb”OfI‹¿tiÚ
; i++){

510 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»suÉTemp
 =

511 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

512 
»adFromStÜage
(
buck‘
, 
keyLi¡
.
g‘
(
i
), 
»suÉTemp
,

513 
s£cLoÿl
);

514 
	g»suÉ
.
add
(
»suÉTemp
);

516  
	gStus
.
	gOK
;

	@s3/src/main/java/site/ycsb/db/package-info.java

20 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@scylla/src/main/java/site/ycsb/db/scylla/ScyllaCQLClient.java

16 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gscyÎa
;

18 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.*;

19 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gpŞic›s
.
	gDCAw¬eRoundRobšPŞicy
;

20 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gpŞic›s
.
	gLßdB®ªcšgPŞicy
;

21 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gpŞic›s
.
	gTok’Aw¬ePŞicy
;

22 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.*;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

29 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

30 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

32 
impÜt
 
	gjava
.
	gut
.
	gM­
;

33 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

34 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

35 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

36 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

37 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

38 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

40 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

41 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

42 
impÜt
 
	gÜg
.
	g¦f4j
.
	gh–³rs
.
	gMes§geFÜm©‹r
;

47 
public
 cÏs 
	cScyÎaCQLCl›Á
 
ex‹nds
 
	mDB
 {

49 
´iv©e
 
fš®
 
Logg”
 
	mLOGGER
 = 
Logg”FaùÜy
.
g‘Logg”
(
ScyÎaCQLCl›Á
.
şass
);

51 
´iv©e
 
Clu¡”
 
	mşu¡”
 = 
nuÎ
;

52 
´iv©e
 
SessiÚ
 
	m£ssiÚ
 = 
nuÎ
;

54 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mS‘
<
	mSŒšg
>, 
	mP»·»dS‹m’t
> 
	mREAD_STMTS
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

55 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mS‘
<
	mSŒšg
>, 
	mP»·»dS‹m’t
> 
	mSCAN_STMTS
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

56 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mS‘
<
	mSŒšg
>, 
	mP»·»dS‹m’t
> 
	mINSERT_STMTS
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

57 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mS‘
<
	mSŒšg
>, 
	mP»·»dS‹m’t
> 
	mUPDATE_STMTS
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

58 
´iv©e
 
fš®
 
	mAtomicReã»nû
<
	mP»·»dS‹m’t
> 
	mREAD_ALL_STMT
 = 
Ãw
 
AtomicReã»nû
<>();

59 
´iv©e
 
fš®
 
	mAtomicReã»nû
<
	mP»·»dS‹m’t
> 
	mSCAN_ALL_STMT
 = 
Ãw
 
AtomicReã»nû
<>();

60 
´iv©e
 
fš®
 
	mAtomicReã»nû
<
	mP»·»dS‹m’t
> 
	mDELETE_STMT
 = 
Ãw
 
AtomicReã»nû
<>();

62 
´iv©e
 
CÚsi¡’cyLev–
 
	m»adCÚsi¡’cyLev–
 = CÚsi¡’cyLev–.
QUORUM
;

63 
´iv©e
 
CÚsi¡’cyLev–
 
	mwr™eCÚsi¡’cyLev–
 = CÚsi¡’cyLev–.
QUORUM
;

65 
´iv©e
 
boŞ—n
 
	mlwt
 = 
çl£
;

67 
public
 
fš®
 
SŒšg
 
	mYCSB_KEY
 = "y_id";

68 
public
 
fš®
 
SŒšg
 
	mKEYSPACE_PROPERTY
 = "scylla.keyspace";

69 
public
 
fš®
 
SŒšg
 
	mKEYSPACE_PROPERTY_DEFAULT
 = "ycsb";

70 
public
 
fš®
 
SŒšg
 
	mUSERNAME_PROPERTY
 = "scylla.username";

71 
public
 
fš®
 
SŒšg
 
	mPASSWORD_PROPERTY
 = "scylla.password";

73 
public
 
fš®
 
SŒšg
 
	mHOSTS_PROPERTY
 = "scylla.hosts";

74 
public
 
fš®
 
SŒšg
 
	mPORT_PROPERTY
 = "scylla.port";

75 
public
 
fš®
 
SŒšg
 
	mPORT_PROPERTY_DEFAULT
 = "9042";

77 
public
 
fš®
 
SŒšg
 
	mREAD_CONSISTENCY_LEVEL_PROPERTY
 = "scylla.readconsistencylevel";

78 
public
 
fš®
 
SŒšg
 
	mREAD_CONSISTENCY_LEVEL_PROPERTY_DEFAULT
 = 
»adCÚsi¡’cyLev–
.
Çme
();

79 
public
 
fš®
 
SŒšg
 
	mWRITE_CONSISTENCY_LEVEL_PROPERTY
 = "scylla.writeconsistencylevel";

80 
public
 
fš®
 
SŒšg
 
	mWRITE_CONSISTENCY_LEVEL_PROPERTY_DEFAULT
 = 
wr™eCÚsi¡’cyLev–
.
Çme
();

82 
public
 
fš®
 
SŒšg
 
	mMAX_CONNECTIONS_PROPERTY
 = "scylla.maxconnections";

83 
public
 
fš®
 
SŒšg
 
	mCORE_CONNECTIONS_PROPERTY
 = "scylla.coreconnections";

84 
public
 
fš®
 
SŒšg
 
	mCONNECT_TIMEOUT_MILLIS_PROPERTY
 = "scylla.connecttimeoutmillis";

85 
public
 
fš®
 
SŒšg
 
	mREAD_TIMEOUT_MILLIS_PROPERTY
 = "scylla.readtimeoutmillis";

87 
public
 
fš®
 
SŒšg
 
	mSCYLLA_LWT
 = "scylla.lwt";

89 
public
 
fš®
 
SŒšg
 
	mTOKEN_AWARE_LOCAL_DC
 = "scylla.local_dc";

91 
public
 
fš®
 
SŒšg
 
	mTRACING_PROPERTY
 = "scylla.tracing";

92 
public
 
fš®
 
SŒšg
 
	mTRACING_PROPERTY_DEFAULT
 = "false";

94 
public
 
fš®
 
SŒšg
 
	mUSE_SSL_CONNECTION
 = "scylla.useSSL";

95 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_USE_SSL_CONNECTION
 = "false";

101 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	mINIT_COUNT
 = 
Ãw
 AtomicInteger(0);

103 
´iv©e
 
boŞ—n
 
	mdebug
 = 
çl£
;

105 
´iv©e
 
boŞ—n
 
	mŒaû
 = 
çl£
;

111 @
Ov”ride


112 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

115 
INIT_COUNT
.
	`šüem’tAndG‘
();

119 
	`synchrÚized
 (
INIT_COUNT
) {

122 ià(
şu¡”
 !ğ
nuÎ
) {

126 
Œy
 {

128 
debug
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("debug", "false"));

129 
Œaû
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
TRACING_PROPERTY
, 
TRACING_PROPERTY_DEFAULT
));

131 
SŒšg
 
ho¡
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
HOSTS_PROPERTY
);

132 ià(
ho¡
 =ğ
nuÎ
) {

133 
throw
 
Ãw
 
	`DBExû±iÚ
(
SŒšg
.
	`fÜm©
("Requœed…rİ”ty \"%s\" missšg fÜ scyÎaCQLCl›Á", 
HOSTS_PROPERTY
));

135 
SŒšg
[] 
ho¡s
 = 
ho¡
.
	`¥l™
(",");

136 
SŒšg
 
pÜt
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
PORT_PROPERTY
, 
PORT_PROPERTY_DEFAULT
);

138 
SŒšg
 
u£ºame
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
USERNAME_PROPERTY
);

139 
SŒšg
 
·sswÜd
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
PASSWORD_PROPERTY
);

141 
SŒšg
 
key¥aû
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
KEYSPACE_PROPERTY
, 
KEYSPACE_PROPERTY_DEFAULT
);

143 
»adCÚsi¡’cyLev–
 = 
CÚsi¡’cyLev–
.
	`v®ueOf
(

144 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
READ_CONSISTENCY_LEVEL_PROPERTY
, 
READ_CONSISTENCY_LEVEL_PROPERTY_DEFAULT
));

145 
wr™eCÚsi¡’cyLev–
 = 
CÚsi¡’cyLev–
.
	`v®ueOf
(

146 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
WRITE_CONSISTENCY_LEVEL_PROPERTY
, 
WRITE_CONSISTENCY_LEVEL_PROPERTY_DEFAULT
));

148 
boŞ—n
 
u£SSL
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

149 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
USE_SSL_CONNECTION
, 
DEFAULT_USE_SSL_CONNECTION
));

151 
Clu¡”
.
Bud”
 
bud”
;

152 ià((
u£ºame
 !ğ
nuÎ
è&& !u£ºame.
	`isEm±y
()) {

153 
bud”
 = 
Clu¡”
.
	`bud”
().
	`w™hC»d’tŸls
(
u£ºame
, 
·sswÜd
)

154 .
	`addCÚùPošts
(
ho¡s
).
	`w™hPÜt
(
IÁeg”
.
	`·r£IÁ
(
pÜt
));

155 ià(
u£SSL
) {

156 
bud”
 = bud”.
	`w™hSSL
();

159 
bud”
 = 
Clu¡”
.
	`bud”
().
	`w™hPÜt
(
IÁeg”
.
	`·r£IÁ
(
pÜt
))

160 .
	`addCÚùPošts
(
ho¡s
);

163 
fš®
 
SŒšg
 
loÿlDC
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
TOKEN_AWARE_LOCAL_DC
);

164 ià(
loÿlDC
 !ğ
nuÎ
 && !loÿlDC.
	`isEm±y
()) {

165 
fš®
 
LßdB®ªcšgPŞicy
 
loÿl
 = 
DCAw¬eRoundRobšPŞicy
.
	`bud”
().
	`w™hLoÿlDc
(
loÿlDC
).
	`bud
();

166 
fš®
 
Tok’Aw¬ePŞicy
 
tok’Aw¬e
 = 
Ãw
 
	`Tok’Aw¬ePŞicy
(
loÿl
);

167 
bud”
 = bud”.
	`w™hLßdB®ªcšgPŞicy
(
tok’Aw¬e
);

169 
LOGGER
.
	`šfo
("Usšg†oÿÈd©aûÁ” w™hok’‡w¬’ess: {}\n", 
loÿlDC
);

172 ià(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
READ_CONSISTENCY_LEVEL_PROPERTY
è=ğ
nuÎ
) {

173 
»adCÚsi¡’cyLev–
 = 
CÚsi¡’cyLev–
.
LOCAL_QUORUM
;

176 ià(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
WRITE_CONSISTENCY_LEVEL_PROPERTY
è=ğ
nuÎ
) {

177 
wr™eCÚsi¡’cyLev–
 = 
CÚsi¡’cyLev–
.
LOCAL_QUORUM
;

181 
şu¡”
 = 
bud”
.
	`bud
();

183 
SŒšg
 
maxCÚÃùiÚs
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

184 
MAX_CONNECTIONS_PROPERTY
);

185 ià(
maxCÚÃùiÚs
 !ğ
nuÎ
) {

186 
şu¡”
.
	`g‘CÚfigu¿tiÚ
().
	`g‘PoŞšgO±iÚs
()

187 .
	`£tMaxCÚÃùiÚsP”Ho¡
(
Ho¡Di¡ªû
.
LOCAL
, 
IÁeg”
.
	`·r£IÁ
(
maxCÚÃùiÚs
));

190 
SŒšg
 
cÜeCÚÃùiÚs
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

191 
CORE_CONNECTIONS_PROPERTY
);

192 ià(
cÜeCÚÃùiÚs
 !ğ
nuÎ
) {

193 
şu¡”
.
	`g‘CÚfigu¿tiÚ
().
	`g‘PoŞšgO±iÚs
()

194 .
	`£tCÜeCÚÃùiÚsP”Ho¡
(
Ho¡Di¡ªû
.
LOCAL
, 
IÁeg”
.
	`·r£IÁ
(
cÜeCÚÃùiÚs
));

197 
SŒšg
 
cÚÃùTimeoutMlis
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

198 
CONNECT_TIMEOUT_MILLIS_PROPERTY
);

199 ià(
cÚÃùTimeoutMlis
 !ğ
nuÎ
) {

200 
şu¡”
.
	`g‘CÚfigu¿tiÚ
().
	`g‘Sock‘O±iÚs
()

201 .
	`£tCÚÃùTimeoutMlis
(
IÁeg”
.
	`·r£IÁ
(
cÚÃùTimeoutMlis
));

204 
SŒšg
 
»adTimeoutMlis
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

205 
READ_TIMEOUT_MILLIS_PROPERTY
);

206 ià(
»adTimeoutMlis
 !ğ
nuÎ
) {

207 
şu¡”
.
	`g‘CÚfigu¿tiÚ
().
	`g‘Sock‘O±iÚs
()

208 .
	`£tR—dTimeoutMlis
(
IÁeg”
.
	`·r£IÁ
(
»adTimeoutMlis
));

211 
M‘ad©a
 
m‘ad©a
 = 
şu¡”
.
	`g‘M‘ad©a
();

212 
LOGGER
.
	`šfo
("CÚÃùedØşu¡”: {}\n", 
m‘ad©a
.
	`g‘Clu¡”Name
());

214 
Ho¡
 
discov”edHo¡
 : 
m‘ad©a
.
	`g‘AÎHo¡s
()) {

215 
LOGGER
.
	`šfo
("Datacenter: {}; Host: {}; Rack: {}\n",

216 
discov”edHo¡
.
	`g‘D©aûÁ”
(), discov”edHo¡.
	`g‘EndPošt
().
	`»sŞve
().
	`g‘Add»ss
(),

217 
discov”edHo¡
.
	`g‘Rack
());

220 
£ssiÚ
 = 
şu¡”
.
	`cÚÃù
(
key¥aû
);

222 ià(
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
SCYLLA_LWT
, BoŞ—n.
	`toSŒšg
(
lwt
)))) {

223 
LOGGER
.
	`šfo
("Using LWT\n");

224 
lwt
 = 
Œue
;

225 
»adCÚsi¡’cyLev–
 = 
CÚsi¡’cyLev–
.
SERIAL
;

226 
wr™eCÚsi¡’cyLev–
 = 
CÚsi¡’cyLev–
.
ANY
;

228 
LOGGER
.
	`šfo
("Not using LWT\n");

231 
LOGGER
.
	`šfo
("Read consistency: {}, Write consistency: {}\n",

232 
»adCÚsi¡’cyLev–
.
	`Çme
(),

233 
wr™eCÚsi¡’cyLev–
.
	`Çme
());

234 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

235 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

244 @
Ov”ride


245 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

246 
	`synchrÚized
 (
INIT_COUNT
) {

247 
fš®
 
curIn™CouÁ
 = 
INIT_COUNT
.
	`deüem’tAndG‘
();

248 ià(
curIn™CouÁ
 <= 0) {

249 
READ_STMTS
.
	`ş—r
();

250 
SCAN_STMTS
.
	`ş—r
();

251 
INSERT_STMTS
.
	`ş—r
();

252 
UPDATE_STMTS
.
	`ş—r
();

253 
READ_ALL_STMT
.
	`£t
(
nuÎ
);

254 
SCAN_ALL_STMT
.
	`£t
(
nuÎ
);

255 
DELETE_STMT
.
	`£t
(
nuÎ
);

256 ià(
£ssiÚ
 !ğ
nuÎ
) {

257 
£ssiÚ
.
	`şo£
();

258 
£ssiÚ
 = 
nuÎ
;

260 ià(
şu¡”
 !ğ
nuÎ
) {

261 
şu¡”
.
	`şo£
();

262 
şu¡”
 = 
nuÎ
;

265 ià(
curIn™CouÁ
 < 0) {

267 
throw
 
Ãw
 
	`DBExû±iÚ
(
SŒšg
.
	`fÜm©
("š™CouÁ i Ãg©ive: %d", 
curIn™CouÁ
));

270 
	}
}

286 @
Ov”ride


287 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

288 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

289 
	gŒy
 {

290 
P»·»dS‹m’t
 
	g¡mt
 = (
f›lds
 =ğ
nuÎ
è? 
READ_ALL_STMT
.
g‘
(è: 
READ_STMTS
.get(fields);

293 ià(
	g¡mt
 =ğ
nuÎ
) {

294 
S–eù
.
Bud”
 
£ËùBud”
;

296 ià(
	gf›lds
 =ğ
nuÎ
) {

297 
£ËùBud”
 = 
Qu”yBud”
.
£Ëù
().
®l
();

299 
	g£ËùBud”
 = 
Qu”yBud”
.
£Ëù
();

300 
SŒšg
 
	gcŞ
 : 
f›lds
) {

301 ((
S–eù
.
S–eùiÚ
è
£ËùBud”
).
cŞumn
(
cŞ
);

305 
	g¡mt
 = 
£ssiÚ
.
´•¬e
(
£ËùBud”
.
äom
(
bË
)

306 .
wh”e
(
Qu”yBud”
.
eq
(
YCSB_KEY
, Qu”yBud”.
bšdM¬k”
()))

307 .
lim™
(1));

308 
	g¡mt
.
£tCÚsi¡’cyLev–
(
»adCÚsi¡’cyLev–
);

309 ià(
	gŒaû
) {

310 
	g¡mt
.
’abËT¿cšg
();

313 
P»·»dS‹m’t
 
	g´evStmt
 = (
f›lds
 =ğ
nuÎ
) ?

314 
READ_ALL_STMT
.
g‘AndS‘
(
¡mt
) :

315 
READ_STMTS
.
putIfAb£Á
(
Ãw
 
HashS‘
<>(
f›lds
), 
¡mt
);

316 ià(
	g´evStmt
 !ğ
nuÎ
) {

317 
¡mt
 = 
´evStmt
;

321 
	gLOGGER
.
debug
(
¡mt
.
g‘Qu”ySŒšg
());

322 
	gLOGGER
.
debug
("key = {}", 
key
);

324 
ResuÉS‘
 
	grs
 = 
£ssiÚ
.
execu‹
(
¡mt
.
bšd
(
key
));

326 ià(
	grs
.
isExhau¡ed
()) {

327  
	gStus
.
	gNOT_FOUND
;

331 
Row
 
	grow
 = 
rs
.
Úe
();

332 
CŞumnDefš™iÚs
 
	gcd
 = 
row
.
g‘CŞumnDefš™iÚs
();

334 
	gCŞumnDefš™iÚs
.
Defš™iÚ
 
	gdef
 : 
cd
) {

335 
By‹Bufãr
 
v®
 = 
row
.
g‘By‹sUn§ã
(
def
.
g‘Name
());

336 ià(
	gv®
 !ğ
nuÎ
) {

337 
»suÉ
.
put
(
def
.
g‘Name
(), 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
v®
.
¬¿y
()));

339 
	g»suÉ
.
put
(
def
.
g‘Name
(), 
nuÎ
);

343  
	gStus
.
	gOK
;

345 } 
ÿtch
 (
Exû±iÚ
 
e
) {

346 
	gLOGGER
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü„—dšg key: {}", 
key
).
g‘Mes§ge
(), 
e
);

347  
	gStus
.
	gERROR
;

372 @
Ov”ride


373 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

374 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

376 
	gŒy
 {

377 
P»·»dS‹m’t
 
	g¡mt
 = (
f›lds
 =ğ
nuÎ
è? 
SCAN_ALL_STMT
.
g‘
(è: 
SCAN_STMTS
.get(fields);

380 ià(
	g¡mt
 =ğ
nuÎ
) {

381 
S–eù
.
Bud”
 
£ËùBud”
;

383 ià(
	gf›lds
 =ğ
nuÎ
) {

384 
£ËùBud”
 = 
Qu”yBud”
.
£Ëù
().
®l
();

386 
	g£ËùBud”
 = 
Qu”yBud”
.
£Ëù
();

387 
SŒšg
 
	gcŞ
 : 
f›lds
) {

388 ((
S–eù
.
S–eùiÚ
è
£ËùBud”
).
cŞumn
(
cŞ
);

392 
S–eù
 
	g£ËùStmt
 = 
£ËùBud”
.
äom
(
bË
);

396 
SŒšg
 
	gš™ŸlStmt
 = 
£ËùStmt
.
toSŒšg
();

397 
SŒšg
 
	gsÿnStmt
 = 
š™ŸlStmt
.
sub¡ršg
(0, in™ŸlStmt.
Ëngth
() - 1) +

398 " WHERE " + 
	gQu”yBud”
.
tok’
(
YCSB_KEY
) +

399 " >ğtok’(" + 
	gQu”yBud”
.
bšdM¬k”
() + ")" +

400 " LIMIT " + 
	gQu”yBud”
.
bšdM¬k”
();

401 
	g¡mt
 = 
£ssiÚ
.
´•¬e
(
sÿnStmt
);

402 
	g¡mt
.
£tCÚsi¡’cyLev–
(
»adCÚsi¡’cyLev–
);

403 ià(
	gŒaû
) {

404 
	g¡mt
.
’abËT¿cšg
();

407 
P»·»dS‹m’t
 
	g´evStmt
 = (
f›lds
 =ğ
nuÎ
) ?

408 
SCAN_ALL_STMT
.
g‘AndS‘
(
¡mt
) :

409 
SCAN_STMTS
.
putIfAb£Á
(
Ãw
 
HashS‘
<>(
f›lds
), 
¡mt
);

410 ià(
	g´evStmt
 !ğ
nuÎ
) {

411 
¡mt
 = 
´evStmt
;

415 
	gLOGGER
.
debug
(
¡mt
.
g‘Qu”ySŒšg
());

416 
	gLOGGER
.
debug
("¡¬tKey = {},„ecÜdcouÁ = {}", 
¡¬tkey
, 
»cÜdcouÁ
);

418 
ResuÉS‘
 
	grs
 = 
£ssiÚ
.
execu‹
(
¡mt
.
bšd
(
¡¬tkey
, 
»cÜdcouÁ
));

420 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gtu¶e
;

421 !
	grs
.
isExhau¡ed
()) {

422 
Row
 
	grow
 = 
rs
.
Úe
();

423 
	gtu¶e
 = 
Ãw
 
HashM­
<>();

425 
CŞumnDefš™iÚs
 
	gcd
 = 
row
.
g‘CŞumnDefš™iÚs
();

427 
	gCŞumnDefš™iÚs
.
Defš™iÚ
 
	gdef
 : 
cd
) {

428 
By‹Bufãr
 
v®
 = 
row
.
g‘By‹sUn§ã
(
def
.
g‘Name
());

429 ià(
	gv®
 !ğ
nuÎ
) {

430 
tu¶e
.
put
(
def
.
g‘Name
(), 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
v®
.
¬¿y
()));

432 
	gtu¶e
.
put
(
def
.
g‘Name
(), 
nuÎ
);

436 
	g»suÉ
.
add
(
tu¶e
);

439  
	gStus
.
	gOK
;

441 } 
ÿtch
 (
Exû±iÚ
 
e
) {

442 
	gLOGGER
.
”rÜ
(

443 
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü sÿÂšg w™h s¹key: {}", 
¡¬tkey
).
g‘Mes§ge
(), 
e
);

444  
	gStus
.
	gERROR
;

462 @
Ov”ride


463 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

465 
	gŒy
 {

466 
	gS‘
<
	gSŒšg
> 
	gf›lds
 = 
v®ues
.
keyS‘
();

467 
P»·»dS‹m’t
 
	g¡mt
 = 
UPDATE_STMTS
.
g‘
(
f›lds
);

470 ià(
	g¡mt
 =ğ
nuÎ
) {

471 
Upd©e
 
upd©eStmt
 = 
Qu”yBud”
.
upd©e
(
bË
);

474 
SŒšg
 
	gf›ld
 : 
f›lds
) {

475 
upd©eStmt
.
w™h
(
Qu”yBud”
.
£t
(
f›ld
, Qu”yBud”.
bšdM¬k”
()));

479 
	gupd©eStmt
.
wh”e
(
Qu”yBud”
.
eq
(
YCSB_KEY
, Qu”yBud”.
bšdM¬k”
()));

481 ià(
	glwt
) {

482 
	gupd©eStmt
.
wh”e
().
ifExi¡s
();

485 
	g¡mt
 = 
£ssiÚ
.
´•¬e
(
upd©eStmt
);

486 
	g¡mt
.
£tCÚsi¡’cyLev–
(
wr™eCÚsi¡’cyLev–
);

487 ià(
	gŒaû
) {

488 
	g¡mt
.
’abËT¿cšg
();

491 
P»·»dS‹m’t
 
	g´evStmt
 = 
UPDATE_STMTS
.
putIfAb£Á
(
Ãw
 
HashS‘
<>(
f›lds
), 
¡mt
);

492 ià(
	g´evStmt
 !ğ
nuÎ
) {

493 
¡mt
 = 
´evStmt
;

497 ià(
	gLOGGER
.
isDebugEÇbËd
()) {

498 
	gLOGGER
.
debug
(
¡mt
.
g‘Qu”ySŒšg
());

499 
	gLOGGER
.
debug
("key = {}", 
key
);

500 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

501 
LOGGER
.
debug
("{} = {}", 
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

506 
CŞumnDefš™iÚs
 
	gv¬s
 = 
¡mt
.
g‘V¬ŸbËs
();

507 
BoundS‹m’t
 
	gboundStmt
 = 
¡mt
.
bšd
();

508 
	gi
 = 0; i < 
	gv¬s
.
size
() - 1; i++) {

509 
	gboundStmt
.
£tSŒšg
(
i
, 
v®ues
.
g‘
(
v¬s
.
g‘Name
(i)).
toSŒšg
());

513 
	gboundStmt
.
£tSŒšg
(
v¬s
.
size
(è- 1, 
key
);

515 
	g£ssiÚ
.
execu‹
(
boundStmt
);

517  
	gStus
.
	gOK
;

518 } 
ÿtch
 (
Exû±iÚ
 
e
) {

519 
	gLOGGER
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü upd©šg key: {}", 
key
).
g‘Mes§ge
(), 
e
);

522  
	gStus
.
	gERROR
;

538 @
Ov”ride


539 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

541 
	gŒy
 {

542 
	gS‘
<
	gSŒšg
> 
	gf›lds
 = 
v®ues
.
keyS‘
();

543 
P»·»dS‹m’t
 
	g¡mt
 = 
INSERT_STMTS
.
g‘
(
f›lds
);

546 ià(
	g¡mt
 =ğ
nuÎ
) {

547 
In£¹
 
š£¹Stmt
 = 
Qu”yBud”
.
š£¹IÁo
(
bË
);

550 
	gš£¹Stmt
.
v®ue
(
YCSB_KEY
, 
Qu”yBud”
.
bšdM¬k”
());

553 
SŒšg
 
	gf›ld
 : 
f›lds
) {

554 
š£¹Stmt
.
v®ue
(
f›ld
, 
Qu”yBud”
.
bšdM¬k”
());

557 ià(
	glwt
) {

558 
	gš£¹Stmt
.
ifNÙExi¡s
();

561 
	g¡mt
 = 
£ssiÚ
.
´•¬e
(
š£¹Stmt
);

562 
	g¡mt
.
£tCÚsi¡’cyLev–
(
wr™eCÚsi¡’cyLev–
);

563 ià(
	gŒaû
) {

564 
	g¡mt
.
’abËT¿cšg
();

567 
P»·»dS‹m’t
 
	g´evStmt
 = 
INSERT_STMTS
.
putIfAb£Á
(
Ãw
 
HashS‘
<>(
f›lds
), 
¡mt
);

568 ià(
	g´evStmt
 !ğ
nuÎ
) {

569 
¡mt
 = 
´evStmt
;

573 ià(
	gLOGGER
.
isDebugEÇbËd
()) {

574 
	gLOGGER
.
debug
(
¡mt
.
g‘Qu”ySŒšg
());

575 
	gLOGGER
.
debug
("key = {}", 
key
);

576 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

577 
LOGGER
.
debug
("{} = {}", 
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

582 
BoundS‹m’t
 
	gboundStmt
 = 
¡mt
.
bšd
().
£tSŒšg
(0, 
key
);

585 
CŞumnDefš™iÚs
 
	gv¬s
 = 
¡mt
.
g‘V¬ŸbËs
();

586 
	gi
 = 1; i < 
	gv¬s
.
size
(); i++) {

587 
	gboundStmt
.
£tSŒšg
(
i
, 
v®ues
.
g‘
(
v¬s
.
g‘Name
(i)).
toSŒšg
());

590 
	g£ssiÚ
.
execu‹
(
boundStmt
);

592  
	gStus
.
	gOK
;

593 } 
ÿtch
 (
Exû±iÚ
 
e
) {

594 
	gLOGGER
.
”rÜ
(
Mes§geFÜm©‹r
.
fÜm©
("E¼Ü in£¹šg key: {}", 
key
).
g‘Mes§ge
(), 
e
);

597  
	gStus
.
	gERROR
;

609 @
Ov”ride


610 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

612 
Œy
 {

613 
P»·»dS‹m’t
 
¡mt
 = 
DELETE_STMT
.
	`g‘
();

616 ià(
¡mt
 =ğ
nuÎ
) {

617 
D–‘e
 
s
 = 
Qu”yBud”
.
	`d–‘e
().
	`äom
(
bË
);

618 
s
.
	`wh”e
(
Qu”yBud”
.
	`eq
(
YCSB_KEY
, Qu”yBud”.
	`bšdM¬k”
()));

620 ià(
lwt
) {

621 
s
.
	`ifExi¡s
();

624 
¡mt
 = 
£ssiÚ
.
	`´•¬e
(
s
);

625 
¡mt
.
	`£tCÚsi¡’cyLev–
(
wr™eCÚsi¡’cyLev–
);

626 ià(
Œaû
) {

627 
¡mt
.
	`’abËT¿cšg
();

630 
P»·»dS‹m’t
 
´evStmt
 = 
DELETE_STMT
.
	`g‘AndS‘
(
¡mt
);

631 ià(
´evStmt
 !ğ
nuÎ
) {

632 
¡mt
 = 
´evStmt
;

636 
LOGGER
.
	`debug
(
¡mt
.
	`g‘Qu”ySŒšg
());

637 
LOGGER
.
	`debug
("key = {}", 
key
);

639 
£ssiÚ
.
	`execu‹
(
¡mt
.
	`bšd
(
key
));

641  
Stus
.
OK
;

642 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

643 
LOGGER
.
	`”rÜ
(
Mes§geFÜm©‹r
.
	`fÜm©
("E¼Ü d–‘šg key: {}", 
key
).
	`g‘Mes§ge
(), 
e
);

646  
Stus
.
ERROR
;

647 
	}
}

	@scylla/src/main/java/site/ycsb/db/scylla/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gscyÎa
;

	@scylla/src/test/java/site/ycsb/db/scylla/ScyllaCQLClientTest.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gscyÎa
;

19 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”As£¹
.
	gas£¹Th©
;

20 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	ghasEÁry
;

21 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	ghasSize
;

22 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	gis
;

23 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	gnÙNuÎV®ue
;

24 
impÜt
 
	gÜg
.
	ghamüe¡
.
	gM©ch”s
.
	gnuÎV®ue
;

26 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

28 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gResuÉS‘
;

29 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gRow
;

30 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gSessiÚ
;

31 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gS‹m’t
;

32 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gIn£¹
;

33 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gQu”yBud”
;

34 
impÜt
 
	gcom
.
	gd©a¡ax
.
	gdriv”
.
	gcÜe
.
	gqu”ybud”
.
	gS–eù
;

35 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

41 
impÜt
 
	gÜg
.
	gÿs§nd¿un™
.
	gCas§nd¿CQLUn™
;

42 
impÜt
 
	gÜg
.
	gÿs§nd¿un™
.
	gd©a£t
.
	gcql
.
	gCÏssP©hCQLD©aS‘
;

43 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

44 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

45 
impÜt
 
	gÜg
.
	gjun™
.
	gCÏssRuË
;

46 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

48 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

49 
impÜt
 
	gjava
.
	gut
.
	gM­
;

50 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

51 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

56 
public
 cÏs 
	cScyÎaCQLCl›ÁTe¡
 {

58 
´iv©e
 
fš®
 
	mtimeout
 = 120000L;

60 
´iv©e
 
fš®
 
SŒšg
 
	mTABLE
 = "usertable";

61 
´iv©e
 
fš®
 
SŒšg
 
	mHOST
 = "localhost";

62 
´iv©e
 
fš®
 
	mPORT
 = 9142;

63 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_ROW_KEY
 = "user1";

65 
´iv©e
 
ScyÎaCQLCl›Á
 
	mş›Á
;

66 
´iv©e
 
SessiÚ
 
	m£ssiÚ
;

68 @
CÏssRuË


69 
public
 
Cas§nd¿CQLUn™
 
	mun™
 = 
Ãw
 CassandraCQLUnit(

70 
Ãw
 
CÏssP©hCQLD©aS‘
("ycsb.cql", "ycsb"), 
nuÎ
, 
timeout
);

72 @
BefÜe


73 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

74 
£ssiÚ
 = 
un™
.
	`g‘SessiÚ
();

76 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

77 
p
.
	`£tPrİ”ty
("scyÎa.ho¡s", 
HOST
);

78 
p
.
	`£tPrİ”ty
("scyÎa.pÜt", 
IÁeg”
.
	`toSŒšg
(
PORT
));

79 
p
.
	`£tPrİ”ty
("scyÎa.bË", 
TABLE
);

81 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

83 
fš®
 
CÜeWÜklßd
 
wÜklßd
 = 
Ãw
 
	`CÜeWÜklßd
();

84 
wÜklßd
.
	`š™
(
p
);

86 
ş›Á
 = 
Ãw
 
	`ScyÎaCQLCl›Á
();

87 
ş›Á
.
	`£tPrİ”t›s
(
p
);

88 
ş›Á
.
	`š™
();

91 @
Aá”


92 
public
 
	$‹¬DownCl›Á
(è
throws
 
Exû±iÚ
 {

93 ià(
ş›Á
 !ğ
nuÎ
) {

94 
ş›Á
.
	`ş—nup
();

96 
ş›Á
 = 
nuÎ
;

97 
	}
}

99 @
Aá”


100 
public
 
	$ş—rTabË
() {

102 
fš®
 
S‹m’t
 
Œunÿ‹
 = 
Qu”yBud”
.
	`Œunÿ‹
(
TABLE
);

103 ià(
un™
 !ğ
nuÎ
) {

104 
un™
.
	`g‘SessiÚ
().
	`execu‹
(
Œunÿ‹
);

106 
	}
}

108 @
Te¡


109 
public
 
	$‹¡R—dMissšgRow
() {

110 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

111 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
TABLE
, "Missšg„ow", 
nuÎ
, 
»suÉ
);

112 
	`as£¹Th©
(
»suÉ
.
	`size
(), 
	`is
(0));

113 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
NOT_FOUND
));

114 
	}
}

116 
´iv©e
 
	$š£¹Row
() {

117 
In£¹
 
š£¹Stmt
 = 
Qu”yBud”
.
	`š£¹IÁo
(
TABLE
);

118 
š£¹Stmt
.
	`v®ue
(
ScyÎaCQLCl›Á
.
YCSB_KEY
, 
DEFAULT_ROW_KEY
);

120 
š£¹Stmt
.
	`v®ue
("field0", "value1");

121 
š£¹Stmt
.
	`v®ue
("field1", "value2");

122 
£ssiÚ
.
	`execu‹
(
š£¹Stmt
);

123 
	}
}

125 @
Te¡


126 
public
 
	$‹¡R—d
() {

127 
	`š£¹Row
();

129 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

130 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
TABLE
, 
DEFAULT_ROW_KEY
, 
nuÎ
, 
»suÉ
);

131 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

132 
	`as£¹Th©
(
»suÉ
.
	`’ŒyS‘
(), 
	`hasSize
(11));

133 
	`as£¹Th©
(
»suÉ
, 
	`hasEÁry
("f›ld2", 
nuÎ
));

135 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
¡rResuÉ
 = 
Ãw
 HashMap<>();

136 
fš®
 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
e
 : 
»suÉ
.
	`’ŒyS‘
()) {

137 ià(
e
.
	`g‘V®ue
(è!ğ
nuÎ
) {

138 
¡rResuÉ
.
	`put
(
e
.
	`g‘Key
(),ƒ.
	`g‘V®ue
().
	`toSŒšg
());

141 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
(
ScyÎaCQLCl›Á
.
YCSB_KEY
, 
DEFAULT_ROW_KEY
));

142 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field0", "value1"));

143 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field1", "value2"));

144 
	}
}

146 @
Te¡


147 
public
 
	$‹¡R—dSšgËCŞumn
() {

148 
	`š£¹Row
();

149 
fš®
 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

150 
fš®
 
S‘
<
SŒšg
> 
f›lds
 = 
S‘s
.
	`ÃwHashS‘
("field1");

151 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
TABLE
, 
DEFAULT_ROW_KEY
, 
f›lds
, 
»suÉ
);

152 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

153 
	`as£¹Th©
(
»suÉ
.
	`’ŒyS‘
(), 
	`hasSize
(1));

154 
fš®
 
M­
<
SŒšg
, SŒšg> 
¡rResuÉ
 = 
SŒšgBy‹I‹¿tÜ
.
	`g‘SŒšgM­
(
»suÉ
);

155 
	`as£¹Th©
(
¡rResuÉ
, 
	`hasEÁry
("field1", "value2"));

156 
	}
}

158 @
Te¡


159 
public
 
	$‹¡In£¹
() {

160 
fš®
 
SŒšg
 
key
 = "key";

161 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

162 
šput
.
	`put
("field0", "value1");

163 
šput
.
	`put
("field1", "value2");

165 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`š£¹
(
TABLE
, 
key
, 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

166 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

169 
fš®
 
S–eù
 
£ËùStmt
 =

170 
Qu”yBud”
.
	`£Ëù
("field0", "field1")

171 .
	`äom
(
TABLE
)

172 .
	`wh”e
(
Qu”yBud”
.
	`eq
(
ScyÎaCQLCl›Á
.
YCSB_KEY
, 
key
))

173 .
	`lim™
(1);

175 
fš®
 
ResuÉS‘
 
rs
 = 
£ssiÚ
.
	`execu‹
(
£ËùStmt
);

176 
fš®
 
Row
 
row
 = 
rs
.
	`Úe
();

177 
	`as£¹Th©
(
row
, 
	`nÙNuÎV®ue
());

178 
	`as£¹Th©
(
rs
.
	`isExhau¡ed
(), 
	`is
(
Œue
));

179 
	`as£¹Th©
(
row
.
	`g‘SŒšg
("f›ld0"), 
	`is
("value1"));

180 
	`as£¹Th©
(
row
.
	`g‘SŒšg
("f›ld1"), 
	`is
("value2"));

181 
	}
}

183 @
Te¡


184 
public
 
	$‹¡Upd©e
() {

185 
	`š£¹Row
();

186 
fš®
 
M­
<
SŒšg
, SŒšg> 
šput
 = 
Ãw
 
HashM­
<>();

187 
šput
.
	`put
("field0", "new-value1");

188 
šput
.
	`put
("field1", "new-value2");

190 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`upd©e
(
TABLE
,

191 
DEFAULT_ROW_KEY
,

192 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
šput
));

193 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

196 
fš®
 
S–eù
 
£ËùStmt
 =

197 
Qu”yBud”
.
	`£Ëù
("field0", "field1")

198 .
	`äom
(
TABLE
)

199 .
	`wh”e
(
Qu”yBud”
.
	`eq
(
ScyÎaCQLCl›Á
.
YCSB_KEY
, 
DEFAULT_ROW_KEY
))

200 .
	`lim™
(1);

202 
fš®
 
ResuÉS‘
 
rs
 = 
£ssiÚ
.
	`execu‹
(
£ËùStmt
);

203 
fš®
 
Row
 
row
 = 
rs
.
	`Úe
();

204 
	`as£¹Th©
(
row
, 
	`nÙNuÎV®ue
());

205 
	`as£¹Th©
(
rs
.
	`isExhau¡ed
(), 
	`is
(
Œue
));

206 
	`as£¹Th©
(
row
.
	`g‘SŒšg
("f›ld0"), 
	`is
("new-value1"));

207 
	`as£¹Th©
(
row
.
	`g‘SŒšg
("f›ld1"), 
	`is
("new-value2"));

208 
	}
}

210 @
Te¡


211 
public
 
	$‹¡D–‘e
() {

212 
	`š£¹Row
();

214 
fš®
 
Stus
 
¡©us
 = 
ş›Á
.
	`d–‘e
(
TABLE
, 
DEFAULT_ROW_KEY
);

215 
	`as£¹Th©
(
¡©us
, 
	`is
(
Stus
.
OK
));

218 
fš®
 
S–eù
 
£ËùStmt
 =

219 
Qu”yBud”
.
	`£Ëù
("field0", "field1")

220 .
	`äom
(
TABLE
)

221 .
	`wh”e
(
Qu”yBud”
.
	`eq
(
ScyÎaCQLCl›Á
.
YCSB_KEY
, 
DEFAULT_ROW_KEY
))

222 .
	`lim™
(1);

224 
fš®
 
ResuÉS‘
 
rs
 = 
£ssiÚ
.
	`execu‹
(
£ËùStmt
);

225 
fš®
 
Row
 
row
 = 
rs
.
	`Úe
();

226 
	`as£¹Th©
(
row
, 
	`nuÎV®ue
());

227 
	}
}

229 @
Te¡


230 
public
 
	$‹¡P»·»dS‹m’ts
() {

231 
fš®
 
LOOP_COUNT
 = 3;

232 
i
 = 0; i < 
LOOP_COUNT
; i++) {

233 
	`‹¡In£¹
();

234 
	`‹¡Upd©e
();

235 
	`‹¡R—d
();

236 
	`‹¡R—dSšgËCŞumn
();

237 
	`‹¡R—dMissšgRow
();

238 
	`‹¡D–‘e
();

240 
	}
}

	@seaweedfs/src/main/java/site/ycsb/db/seaweed/SeaweedClient.java

19 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g£aw“d
;

21 
impÜt
 
	g£aw“dfs
.
	gş›Á
.
	gF”PrÙo
;

22 
impÜt
 
	g£aw“dfs
.
	gş›Á
.
	gF”Cl›Á
;

23 
impÜt
 
	g£aw“dfs
.
	gş›Á
.
	gF”G½cCl›Á
;

24 
impÜt
 
	g£aw“dfs
.
	gş›Á
.
	gS—w“dR—d
;

25 
impÜt
 
	g£aw“dfs
.
	gş›Á
.
	gS—w“dWr™e
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

32 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

33 
impÜt
 
	gjava
.
	gio
.
	gSŒšgWr™”
;

34 
impÜt
 
	gjava
.
	gio
.
	gWr™”
;

35 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
;

36 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

37 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

38 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

39 
impÜt
 
	gjava
.
	gut
.
	gM­
;

40 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

41 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

43 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚFaùÜy
;

44 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚG’”©Ü
;

45 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚNode
;

46 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gm­
.
	gObjeùM­³r
;

47 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gnode
.
	gObjeùNode
;

48 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

49 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

62 
public
 cÏs 
	cS—w“dCl›Á
 
ex‹nds
 
	mDB
 {

64 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = 
Logg”FaùÜy
.
g‘Logg”
(
S—w“dCl›Á
.
şass
);

65 
´Ùeùed
 
fš®
 
ObjeùM­³r
 
	mMAPPER
 = 
Ãw
 ObjectMapper();

67 
´iv©e
 
F”Cl›Á
 
	mf”Cl›Á
;

68 
´iv©e
 
F”G½cCl›Á
 
	mf”G½cCl›Á
;

69 
´iv©e
 
SŒšg
 
	mf”Ho¡
;

70 
´iv©e
 
	mf”PÜt
;

71 
´iv©e
 
SŒšg
 
	mfŞd”
;

77 @
Ov”ride


78 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

89 @
Ov”ride


90 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bËName
, SŒšg 
key
) {

91 ià(!
f”Cl›Á
.
	`rm
(
this
.
fŞd”
 + "/" + 
bËName
 + "/" + 
key
, 
Œue
,rue)) {

92  
Stus
.
ERROR
;

94  
Stus
.
OK
;

95 
	}
}

101 @
Ov”ride


102 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

103 
f”Ho¡
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("seaweed.filerHost", "localhost");

104 
f”PÜt
 = 
IÁeg”
.
	`·r£IÁ
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("seaweed.filerPort", "8888"));

105 
fŞd”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
("seaweed.folder", "/ycsb");

106 
f”G½cCl›Á
 = 
Ãw
 
	`F”G½cCl›Á
(
f”Ho¡
, 
f”PÜt
+10000);

107 
f”Cl›Á
 = 
Ãw
 
	`F”Cl›Á
(
f”G½cCl›Á
);

108 
f”Cl›Á
.
	`mkdœs
(
this
.
fŞd”
, 0755);

109 
	}
}

126 @
Ov”ride


127 
public
 
Stus
 
š£¹
(
SŒšg
 
bËName
, SŒšg 
key
,

128 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

129  
wr™eToStÜage
(
bËName
, 
key
, 
v®ues
);

143 @
Ov”ride


144 
public
 
Stus
 
»ad
(
SŒšg
 
bËName
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

145 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

146  
»adFromStÜage
(
bËName
, 
key
, 
f›lds
, 
»suÉ
);

159 @
Ov”ride


160 
public
 
Stus
 
upd©e
(
SŒšg
 
bËName
, SŒšg 
key
,

161 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

162 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gexi¡šgV®ues
 = 
Ãw
 
HashM­
<>();

163 
Stus
 
	g»adStus
 = 
»adFromStÜage
(
bËName
, 
key
, 
nuÎ
, 
exi¡šgV®ues
);

164 ià(
	g»adStus
 !ğ
Stus
.
OK
) {

165  
»adStus
;

167 
	gexi¡šgV®ues
.
putAÎ
(
v®ues
);

168  
wr™eToStÜage
(
bËName
, 
key
, 
exi¡šgV®ues
);

183 @
Ov”ride


184 
public
 
Stus
 
sÿn
(
SŒšg
 
bËName
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

185 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

186  
sÿnFromStÜage
(
bËName
, 
¡¬tkey
, 
»cÜdcouÁ
, 
f›lds
, 
»suÉ
);

196 
´Ùeùed
 
Stus
 
wr™eToStÜage
(
SŒšg
 
bËName
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

197 
	gŒy
 {

198 
	gby‹
[] 
	gjsÚD©a
 = 
toJsÚ
(
v®ues
).
g‘By‹s
(
Snd¬dCh¬£ts
.
UTF_8
);

200 
	gnow
 = 
Sy¡em
.
cu¼’tTimeMlis
() / 1000L;

201 
	gF”PrÙo
.
	gEÁry
.
Bud”
 
	g’Œy
 = 
F”PrÙo
.
EÁry
.
ÃwBud”
()

202 .
£tName
(
key
)

203 .
£tIsDœeùÜy
(
çl£
)

204 .
£tA‰ribu‹s
(

205 
F”PrÙo
.
Fu£A‰ribu‹s
.
ÃwBud”
()

206 .
£tC¹ime
(
now
)

207 .
£tMtime
(
now
)

208 .
£tFeMode
(0755)

211 
	gS—w“dWr™e
.
wr™eD©a
(
’Œy
, "000", 
this
.
f”G½cCl›Á
, 0, 
jsÚD©a
, 0, jsÚD©a.
Ëngth
);

213 
	gS—w“dWr™e
.
wr™eM‘a
(
this
.
f”G½cCl›Á
,his.
fŞd”
 + "/" + 
bËName
, 
’Œy
);

215 } 
ÿtch
 (
Exû±iÚ
 
e
) {

216 
	gLOG
.
”rÜ
("NÙ…ossibËØwr™thobjeù {}", 
key
, 
e
);

217  
	gStus
.
	gERROR
;

220  
	gStus
.
	gOK
;

230 
´Ùeùed
 
Stus
 
»adFromStÜage
(
SŒšg
 
bËName
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

231 
	gŒy
 {

232 
	gF”PrÙo
.
EÁry
 
	g’Œy
 = 
this
.
f”Cl›Á
.
lookupEÁry
Ñhis.
fŞd”
 + "/" + 
bËName
, 
key
);

233 ià(
	g’Œy
!=
nuÎ
) {

234 
»adOÃEÁry
(
’Œy
, 
key
, 
f›lds
, 
»suÉ
);

236 
	gLOG
.
”rÜ
("FaØ»adhobjeù {}", 
key
);

237  
	gStus
.
	gNOT_FOUND
;

239 } 
ÿtch
 (
Exû±iÚ
 
e
) {

240 
	gLOG
.
”rÜ
("NÙ…ossibËØg‘hobjeù {}", 
key
, 
e
);

241  
	gStus
.
	gERROR
;

244  
	gStus
.
	gOK
;

247 
´Ùeùed
 
»adOÃEÁry
(

248 
F”PrÙo
.
EÁry
 
’Œy
, 
SŒšg
 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
è
throws
 
	gIOExû±iÚ
 {

249 
	gLi¡
<
	gS—w“dR—d
.
	gVisibËIÁ”v®
> 
	gvisibËIÁ”v®Li¡
 =

250 
S—w“dR—d
.
nÚOv”ÏµšgVisibËIÁ”v®s
(
f”G½cCl›Á
, 
’Œy
.
g‘ChunksLi¡
());

251 
	gËngth
 = (è
S—w“dR—d
.
tÙ®Size
(
’Œy
.
g‘ChunksLi¡
());

252 
	gby‹
[] 
	gbufãr
 = 
Ãw
 
by‹
[
Ëngth
];

253 
	gS—w“dR—d
.
»ad
(
this
.
f”G½cCl›Á
, 
visibËIÁ”v®Li¡
, 0, 
bufãr
, 0, bufãr.
Ëngth
);

254 
äomJsÚ
(
Ãw
 
SŒšg
(
bufãr
, 
Snd¬dCh¬£ts
.
UTF_8
), 
f›lds
, 
»suÉ
);

267 
´Ùeùed
 
Stus
 
sÿnFromStÜage
(
SŒšg
 
bËName
, SŒšg 
¡¬tkey
,

268 
»cÜdcouÁ
, 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

270 
	gŒy
 {

271 
	gLi¡
<
	gF”PrÙo
.
	gEÁry
> 
	g’ŒyLi¡
 = 
this
.
f”Cl›Á
.
li¡EÁr›s
(

272 
this
.
fŞd”
 + "/" + 
bËName
, "", 
¡¬tkey
, 
»cÜdcouÁ
, 
Œue
);

273 
	gF”PrÙo
.
EÁry
 
	g’Œy
 : 
’ŒyLi¡
) {

274 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»t
 = 
Ãw
 HashMap<String, ByteIterator>();

275 
»adOÃEÁry
(
’Œy
,ƒÁry.
g‘Name
(), 
f›lds
, 
»t
);

276 
	g»suÉ
.
add
(
»t
);

278 } 
ÿtch
 (
Exû±iÚ
 
e
) {

279 
	gLOG
.
”rÜ
("NÙ…ossibËØli¡hobjeù {}†im™ {}", 
¡¬tkey
, 
»cÜdcouÁ
, 
e
);

280  
	gStus
.
	gERROR
;

283  
	gStus
.
	gOK
;

286 
´Ùeùed
 
äomJsÚ
(

287 
SŒšg
 
v®ue
, 
S‘
<SŒšg> 
f›lds
,

288 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
è
throws
 
	gIOExû±iÚ
 {

289 
JsÚNode
 
	gjsÚ
 = 
MAPPER
.
»adT»e
(
v®ue
);

290 
boŞ—n
 
	gcheckF›lds
 = 
f›lds
 !ğ
nuÎ
 && !f›lds.
isEm±y
();

291 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
>> 
	gjsÚF›lds
 = 
jsÚ
.
g‘F›lds
();

292 
	gjsÚF›lds
.
hasNext
();

294 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gJsÚNode
> 
	gjsÚF›ld
 = 
jsÚF›lds
.
Ãxt
();

295 
SŒšg
 
	gÇme
 = 
jsÚF›ld
.
g‘Key
();

296 ià(
	gcheckF›lds
 && !
	gf›lds
.
cÚšs
(
Çme
)) {

299 
JsÚNode
 
	gjsÚV®ue
 = 
jsÚF›ld
.
g‘V®ue
();

300 ià(
	gjsÚV®ue
 !ğ
nuÎ
 && !
jsÚV®ue
.
isNuÎ
()) {

301 
»suÉ
.
put
(
Çme
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
jsÚV®ue
.
asText
()));

306 
´Ùeùed
 
SŒšg
 
toJsÚ
(
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
)

307 
throws
 
	gIOExû±iÚ
 {

308 
ObjeùNode
 
	gnode
 = 
MAPPER
.
ü—‹ObjeùNode
();

309 
	gM­
<
	gSŒšg
, SŒšg> 
	g¡ršgM­
 = 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
);

310 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g·œ
 : 
¡ršgM­
.
’ŒyS‘
()) {

311 
node
.
put
(
·œ
.
g‘Key
(),…aœ.
g‘V®ue
());

313 
JsÚFaùÜy
 
	gjsÚFaùÜy
 = 
Ãw
 JsonFactory();

314 
Wr™”
 
	gwr™”
 = 
Ãw
 
SŒšgWr™”
();

315 
JsÚG’”©Ü
 
	gjsÚG’”©Ü
 = 
jsÚFaùÜy
.
ü—‹JsÚG’”©Ü
(
wr™”
);

316 
	gMAPPER
.
wr™eT»e
(
jsÚG’”©Ü
, 
node
);

317  
	gwr™”
.
toSŒšg
();

	@seaweedfs/src/main/java/site/ycsb/db/seaweed/package-info.java

20 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	g£aw“d
;

	@solr7/src/main/java/site/ycsb/db/solr7/SolrClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gsŞr7
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	gSŞrQu”y
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	gim¶
.
	gCloudSŞrCl›Á
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	gim¶
.
	gH‰pCl›ÁUt
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	gim¶
.
	gH‰pSŞrCl›Á
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	gim¶
.
	gKrb5H‰pCl›ÁBud”
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	g»¥Ú£
.
	gQu”yRe¥Ú£
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	g»¥Ú£
.
	gUpd©eRe¥Ú£
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	gSŞrS”v”Exû±iÚ
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gcommÚ
.
	gSŞrDocum’t
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gcommÚ
.
	gSŞrDocum’tLi¡
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gcommÚ
.
	gSŞrIÅutDocum’t
;

38 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

39 
impÜt
 
	gjava
.
	gut
.*;

40 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

53 
public
 cÏs 
	cSŞrCl›Á
 
ex‹nds
 
	mDB
 {

55 
public
 
fš®
 
SŒšg
 
	mDEFAULT_CLOUD_MODE
 = "false";

56 
public
 
fš®
 
SŒšg
 
	mDEFAULT_BATCH_MODE
 = "false";

57 
public
 
fš®
 
SŒšg
 
	mDEFAULT_ZOOKEEPER_HOSTS
 = "localhost:2181";

58 
public
 
fš®
 
SŒšg
 
	mDEFAULT_SOLR_BASE_URL
 = "http://localhost:8983/solr";

59 
public
 
fš®
 
SŒšg
 
	mDEFAULT_COMMIT_WITHIN_TIME
 = "1000";

61 
´iv©e
 
	mÜg
.
	m­ache
.
	msŞr
.
	mş›Á
.
	msŞrj
.
SŞrCl›Á
 client;

62 
´iv©e
 
IÁeg”
 
	mcomm™Time
;

63 
´iv©e
 
BoŞ—n
 
	mb©chMode
;

69 @
Ov”ride


70 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

71 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

72 
comm™Time
 = 
IÁeg”


73 .
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("sŞr.comm™.w™hš.time", 
DEFAULT_COMMIT_WITHIN_TIME
));

74 
b©chMode
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("sŞr.b©ch.mode", 
DEFAULT_BATCH_MODE
));

76 
SŒšg
 
j¯sCÚfP©h
 = 
´İs
.
	`g‘Prİ”ty
("solr.jaas.conf.path");

77 if(
j¯sCÚfP©h
 !ğ
nuÎ
) {

78 
Sy¡em
.
	`£tPrİ”ty
("java.£cur™y.auth.logš.cÚfig", 
j¯sCÚfP©h
);

79 
H‰pCl›ÁUt
.
	`£tH‰pCl›ÁBud”
(
Ãw
 
	`Krb5H‰pCl›ÁBud”
().
	`g‘H‰pCl›ÁBud”
(
O±iÚ®
.
	`em±y
()));

83 
BoŞ—n
 
şoudMode
 = BoŞ—n.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("sŞr.şoud", 
DEFAULT_CLOUD_MODE
));

84 
Sy¡em
.
”r
.
	`´šn
("SŞ¸Cloud Modğ" + 
şoudMode
);

85 ià(
şoudMode
) {

86 
Sy¡em
.
”r
.
	`´šn
("Solr Zookeeper Remote Hosts = "

87 + 
´İs
.
	`g‘Prİ”ty
("sŞr.zook“³r.ho¡s", 
DEFAULT_ZOOKEEPER_HOSTS
));

88 
ş›Á
 = 
Ãw
 
CloudSŞrCl›Á
.
	`Bud”
().
	`w™hZkHo¡
(

89 
A¼ays
.
	`asLi¡
(
´İs
.
	`g‘Prİ”ty
("sŞr.zook“³r.ho¡s", 
DEFAULT_ZOOKEEPER_HOSTS
).
	`¥l™
(","))).
	`bud
();

91 
ş›Á
 = 
Ãw
 
H‰pSŞrCl›Á
.
	`Bud”
(
´İs
.
	`g‘Prİ”ty
("sŞr.ba£.u¾", 
DEFAULT_SOLR_BASE_URL
)).
	`bud
();

95 @
Ov”ride


96 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

97 
Œy
 {

98 
ş›Á
.
	`şo£
();

99 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

100 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
);

102 
	}
}

117 @
Ov”ride


118 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

119 
	gŒy
 {

120 
SŞrIÅutDocum’t
 
	gdoc
 = 
Ãw
 SolrInputDocument();

122 
	gdoc
.
addF›ld
("id", 
key
);

123 
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
).
’ŒyS‘
()) {

124 
doc
.
addF›ld
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

126 
Upd©eRe¥Ú£
 
	g»¥Ú£
;

127 ià(
	gb©chMode
) {

128 
	g»¥Ú£
 = 
ş›Á
.
add
(
bË
, 
doc
, 
comm™Time
);

130 
	g»¥Ú£
 = 
ş›Á
.
add
(
bË
, 
doc
);

131 
	gş›Á
.
comm™
(
bË
);

133  
checkStus
(
»¥Ú£
.
g‘Stus
());

135 } 
ÿtch
 (
IOExû±iÚ
 | 
SŞrS”v”Exû±iÚ
 
e
) {

136 
	ge
.
´štSckT¿û
();

138  
	gStus
.
	gERROR
;

151 @
Ov”ride


152 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

153 
Œy
 {

154 
Upd©eRe¥Ú£
 
»¥Ú£
;

155 ià(
b©chMode
) {

156 
»¥Ú£
 = 
ş›Á
.
	`d–‘eById
(
bË
, 
key
, 
comm™Time
);

158 
»¥Ú£
 = 
ş›Á
.
	`d–‘eById
(
bË
, 
key
);

159 
ş›Á
.
	`comm™
(
bË
);

161  
	`checkStus
(
»¥Ú£
.
	`g‘Stus
());

162 } 
	`ÿtch
 (
IOExû±iÚ
 | 
SŞrS”v”Exû±iÚ
 
e
) {

163 
e
.
	`´štSckT¿û
();

165  
Stus
.
ERROR
;

166 
	}
}

182 @
Ov”ride


183 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

184 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

185 
	gŒy
 {

186 
BoŞ—n
 
	g»tuºF›lds
 = 
çl£
;

187 
	gSŒšg
[] 
	gf›ldLi¡
 = 
nuÎ
;

188 ià(
	gf›lds
 !ğ
nuÎ
) {

189 
»tuºF›lds
 = 
Œue
;

190 
	gf›ldLi¡
 = 
f›lds
.
toA¼ay
(
Ãw
 
SŒšg
[f›lds.
size
()]);

192 
SŞrQu”y
 
	gqu”y
 = 
Ãw
 SolrQuery();

193 
	gqu”y
.
£tQu”y
("id:" + 
key
);

194 ià(
	g»tuºF›lds
) {

195 
	gqu”y
.
£tF›lds
(
f›ldLi¡
);

197 
fš®
 
Qu”yRe¥Ú£
 
	g»¥Ú£
 = 
ş›Á
.
qu”y
(
bË
, query);

198 
SŞrDocum’tLi¡
 
	g»suÉs
 = 
»¥Ú£
.
g‘ResuÉs
();

199 ià((
	g»suÉs
 !ğ
nuÎ
è&& (
»suÉs
.
g‘NumFound
() > 0)) {

200 
SŒšg
 
f›ld
 : 
»suÉs
.
g‘
(0).
g‘F›ldNames
()) {

201 
»suÉ
.
put
(
f›ld
,

202 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
SŒšg
.
v®ueOf
(
»suÉs
.
g‘
(0).
g‘Fœ¡V®ue
(
f›ld
))));

205  
checkStus
(
»¥Ú£
.
g‘Stus
());

206 } 
ÿtch
 (
IOExû±iÚ
 | 
SŞrS”v”Exû±iÚ
 
e
) {

207 
	ge
.
´štSckT¿û
();

209  
	gStus
.
	gERROR
;

226 @
Ov”ride


227 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

228 
	gŒy
 {

229 
SŞrIÅutDocum’t
 
	gupd©edDoc
 = 
Ãw
 SolrInputDocument();

230 
	gupd©edDoc
.
addF›ld
("id", 
key
);

232 
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
v®ues
).
’ŒyS‘
()) {

233 
upd©edDoc
.
addF›ld
(
’Œy
.
g‘Key
(), 
CŞËùiÚs
.
sšgËtÚM­
("£t",ƒÁry.
g‘V®ue
()));

236 
Upd©eRe¥Ú£
 
	gwr™eRe¥Ú£
;

237 ià(
	gb©chMode
) {

238 
	gwr™eRe¥Ú£
 = 
ş›Á
.
add
(
bË
, 
upd©edDoc
, 
comm™Time
);

240 
	gwr™eRe¥Ú£
 = 
ş›Á
.
add
(
bË
, 
upd©edDoc
);

241 
	gş›Á
.
comm™
(
bË
);

243  
checkStus
(
wr™eRe¥Ú£
.
g‘Stus
());

244 } 
ÿtch
 (
IOExû±iÚ
 | 
SŞrS”v”Exû±iÚ
 
e
) {

245 
	ge
.
´štSckT¿û
();

247  
	gStus
.
	gERROR
;

267 @
Ov”ride


268 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

269 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

270 
	gŒy
 {

271 
BoŞ—n
 
	g»tuºF›lds
 = 
çl£
;

272 
	gSŒšg
[] 
	gf›ldLi¡
 = 
nuÎ
;

273 ià(
	gf›lds
 !ğ
nuÎ
) {

274 
»tuºF›lds
 = 
Œue
;

275 
	gf›ldLi¡
 = 
f›lds
.
toA¼ay
(
Ãw
 
SŒšg
[f›lds.
size
()]);

277 
SŞrQu”y
 
	gqu”y
 = 
Ãw
 SolrQuery();

278 
	gqu”y
.
£tQu”y
("*:*");

279 
	gqu”y
.
£tP¬am
("fq", "id:[ " + 
¡¬tkey
 + " TO * ]");

280 ià(
	g»tuºF›lds
) {

281 
	gqu”y
.
£tF›lds
(
f›ldLi¡
);

283 
	gqu”y
.
£tRows
(
»cÜdcouÁ
);

284 
fš®
 
Qu”yRe¥Ú£
 
	g»¥Ú£
 = 
ş›Á
.
qu”y
(
bË
, query);

285 
SŞrDocum’tLi¡
 
	g»suÉs
 = 
»¥Ú£
.
g‘ResuÉs
();

287 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
;

289 
SŞrDocum’t
 
	gh™
 : 
»suÉs
) {

290 
’Œy
 = 
Ãw
 
HashM­
<>((è
»suÉs
.
g‘NumFound
());

291 
SŒšg
 
	gf›ld
 : 
h™
.
g‘F›ldNames
()) {

292 
’Œy
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
SŒšg
.
v®ueOf
(
h™
.
g‘Fœ¡V®ue
(field))));

294 
	g»suÉ
.
add
(
’Œy
);

296  
checkStus
(
»¥Ú£
.
g‘Stus
());

297 } 
ÿtch
 (
IOExû±iÚ
 | 
SŞrS”v”Exû±iÚ
 
e
) {

298 
	ge
.
´štSckT¿û
();

300  
	gStus
.
	gERROR
;

303 
´iv©e
 
Stus
 
	$checkStus
(
¡©us
) {

304 
Stus
 
»¥Ú£Stus
;

305 
¡©us
) {

307 
»¥Ú£Stus
 = 
Stus
.
OK
;

310 
»¥Ú£Stus
 = 
Stus
.
BAD_REQUEST
;

313 
»¥Ú£Stus
 = 
Stus
.
FORBIDDEN
;

316 
»¥Ú£Stus
 = 
Stus
.
NOT_FOUND
;

319 
»¥Ú£Stus
 = 
Stus
.
ERROR
;

322 
»¥Ú£Stus
 = 
Stus
.
SERVICE_UNAVAILABLE
;

325 
»¥Ú£Stus
 = 
Stus
.
UNEXPECTED_STATE
;

328  
»¥Ú£Stus
;

329 
	}
}

	@solr7/src/main/java/site/ycsb/db/solr7/package-info.java

22 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gsŞr7
;

	@solr7/src/test/java/site/ycsb/db/solr7/SolrClientBaseTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gsŞr7
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	gembedded
.
	gJ‘tyCÚfig
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	g»que¡
.
	gCŞËùiÚAdmšReque¡
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gşoud
.
	gMšiSŞrCloudClu¡”
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gcommÚ
.
	gut
.
	gNamedLi¡
;

29 
impÜt
 
	gÜg
.
	gjun™
.*;

31 
impÜt
 
	gjava
.
	gio
.
	gFe
;

32 
impÜt
 
	gjava
.
	gÃt
.
	gURL
;

33 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

34 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

35 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

36 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

37 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

38 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

39 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

41 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

42 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

44 
public
 
ab¡¿ù
 cÏs 
	cSŞrCl›ÁBa£Te¡
 {

46 
´Ùeùed
 
MšiSŞrCloudClu¡”
 
	mmšiSŞrCloudClu¡”
;

47 
´iv©e
 
DB
 
	mš¡ªû
;

48 
´iv©e
 
fš®
 
	mHashM­
<
	mSŒšg
, 
	mBy‹I‹¿tÜ
> 
	mMOCK_DATA
;

49 
´Ùeùed
 
fš®
 
SŒšg
 
	mMOCK_TABLE
 = "ycsb";

50 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_KEY0
 = "0";

51 
´iv©e
 
fš®
 
SŒšg
 
	mMOCK_KEY1
 = "1";

52 
´iv©e
 
fš®
 
	mNUM_RECORDS
 = 10;

53 
´iv©e
 
fš®
 
SŒšg
 
	mFIELD_PREFIX
 = 
CÜeWÜklßd
.
FIELD_NAME_PREFIX_DEFAULT
;

56 
	mMOCK_DATA
 = 
Ãw
 
HashM­
<>(
NUM_RECORDS
);

57 
	mi
 = 0; i < 
	mNUM_RECORDS
; i++) {

58 
	mMOCK_DATA
.
put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
("value" + i));

62 @
BefÜeCÏss


63 
public
 
	$ÚlyOnû
(è
throws
 
Exû±iÚ
 {

64 
P©h
 
mšiSŞrCloudClu¡”TempDœeùÜy
 = 
Fes
.
	`ü—‹TempDœeùÜy
("miniSolrCloudCluster");

65 
mšiSŞrCloudClu¡”TempDœeùÜy
.
	`toFe
().
	`d–‘eOnEx™
();

66 
mšiSŞrCloudClu¡”
 = 
Ãw
 
	`MšiSŞrCloudClu¡”
(1, 
mšiSŞrCloudClu¡”TempDœeùÜy
, 
J‘tyCÚfig
.
	`bud”
().
	`bud
());

69 
URL
 
cÚfigDœ
 = 
SŞrCl›ÁBa£Te¡
.
şass
.
	`g‘CÏssLßd”
().
	`g‘Resourû
("solr_config");

70 
	`as£¹NÙNuÎ
(
cÚfigDœ
);

71 
mšiSŞrCloudClu¡”
.
	`u¶ßdCÚfigS‘
(
P©hs
.
	`g‘
(
cÚfigDœ
.
	`toURI
()), 
MOCK_TABLE
);

72 
	}
}

74 @
Aá”CÏss


75 
public
 
	$de¡roy
(è
throws
 
Exû±iÚ
 {

76 if(
mšiSŞrCloudClu¡”
 !ğ
nuÎ
) {

77 
mšiSŞrCloudClu¡”
.
	`shutdown
();

79 
	}
}

81 @
BefÜe


82 
public
 
	$£tup
(è
throws
 
Exû±iÚ
 {

83 
CŞËùiÚAdmšReque¡
.
	`ü—‹CŞËùiÚ
(
MOCK_TABLE
, MOCK_TABLE, 1, 1)

84 .
	`w™hPrİ”ty
("solr.directoryFactory", "solr.StandardDirectoryFactory")

85 .
	`´oûss
(
mšiSŞrCloudClu¡”
.
	`g‘SŞrCl›Á
());

86 
mšiSŞrCloudClu¡”
.
	`wa™FÜAùiveCŞËùiÚ
(
MOCK_TABLE
, 1, 1);

87 
Th»ad
.
	`¦“p
(1000);

89 
š¡ªû
 = 
	`g‘DB
();

90 
	}
}

92 @
Aá”


93 
public
 
	$‹¬Down
(è
throws
 
Exû±iÚ
 {

94 if(
mšiSŞrCloudClu¡”
 !ğ
nuÎ
) {

95 
CŞËùiÚAdmšReque¡
.
	`d–‘eCŞËùiÚ
(
MOCK_TABLE
)

96 .
	`´oûssAndWa™
(
mšiSŞrCloudClu¡”
.
	`g‘SŞrCl›Á
(), 60);

97 
Th»ad
.
	`¦“p
(1000);

99 
	}
}

101 @
Te¡


102 
public
 
	$‹¡In£¹
(è
throws
 
Exû±iÚ
 {

103 
Stus
 
»suÉ
 = 
š¡ªû
.
	`š£¹
(
MOCK_TABLE
, 
MOCK_KEY0
, 
MOCK_DATA
);

104 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

105 
	}
}

107 @
Te¡


108 
public
 
	$‹¡D–‘e
(è
throws
 
Exû±iÚ
 {

109 
Stus
 
»suÉ
 = 
š¡ªû
.
	`d–‘e
(
MOCK_TABLE
, 
MOCK_KEY1
);

110 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

111 
	}
}

113 @
Te¡


114 
public
 
	$‹¡R—d
(è
throws
 
Exû±iÚ
 {

115 
S‘
<
SŒšg
> 
f›lds
 = 
MOCK_DATA
.
	`keyS‘
();

116 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉP¬am
 = 
Ãw
 HashM­<>(
NUM_RECORDS
);

117 
Stus
 
»suÉ
 = 
š¡ªû
.
	`»ad
(
MOCK_TABLE
, 
MOCK_KEY1
, 
f›lds
, 
»suÉP¬am
);

118 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

119 
	}
}

121 @
Te¡


122 
public
 
	$‹¡Upd©e
(è
throws
 
Exû±iÚ
 {

123 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ÃwV®ues
 = 
Ãw
 HashM­<>(
NUM_RECORDS
);

125 
i
 = 0; i < 
NUM_RECORDS
; i++) {

126 
ÃwV®ues
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
("newvalue" + i));

129 
Stus
 
»suÉ
 = 
š¡ªû
.
	`upd©e
(
MOCK_TABLE
, 
MOCK_KEY1
, 
ÃwV®ues
);

130 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

133 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉP¬am
 = 
Ãw
 HashM­<>(
NUM_RECORDS
);

134 
š¡ªû
.
	`»ad
(
MOCK_TABLE
, 
MOCK_KEY1
, 
MOCK_DATA
.
	`keyS‘
(), 
»suÉP¬am
);

136 
i
 = 0; i < 
NUM_RECORDS
; i++) {

137 
	`as£¹Equ®s
("Ãwv®ue" + 
i
, 
»suÉP¬am
.
	`g‘
(
FIELD_PREFIX
 + i).
	`toSŒšg
());

139 
	}
}

141 @
Te¡


142 
public
 
	$‹¡Sÿn
(è
throws
 
Exû±iÚ
 {

143 
S‘
<
SŒšg
> 
f›lds
 = 
MOCK_DATA
.
	`keyS‘
();

144 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉP¬am
 = 
Ãw
 VeùÜ<>(
NUM_RECORDS
);

145 
Stus
 
»suÉ
 = 
š¡ªû
.
	`sÿn
(
MOCK_TABLE
, 
MOCK_KEY1
, 
NUM_RECORDS
, 
f›lds
, 
»suÉP¬am
);

146 
	`as£¹Equ®s
(
Stus
.
OK
, 
»suÉ
);

147 
	}
}

154 
´Ùeùed
 
DB
 
	$g‘DB
() {

155  
	`g‘DB
(
Ãw
 
	`Prİ”t›s
());

156 
	}
}

165 
´Ùeùed
 
ab¡¿ù
 
DB
 
g‘DB
(
Prİ”t›s
 
´İs
);

	@solr7/src/test/java/site/ycsb/db/solr7/SolrClientCloudTest.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gsŞr7
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

22 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeNoExû±iÚ
;

26 
public
 cÏs 
	cSŞrCl›ÁCloudTe¡
 
ex‹nds
 
	mSŞrCl›ÁBa£Te¡
 {

28 
´iv©e
 
SŞrCl›Á
 
	mš¡ªû
;

30 @
Aá”


31 
public
 
	$‹¬Down
(è
throws
 
Exû±iÚ
 {

32 
Œy
 {

33 if(
š¡ªû
 !ğ
nuÎ
) {

34 
š¡ªû
.
	`ş—nup
();

36 } 
fš®ly
 {

37 
su³r
.
	`‹¬Down
();

41 @
Ov”ride


42 
´Ùeùed
 
DB
 
	$g‘DB
(
Prİ”t›s
 
´İs
) {

43 
š¡ªû
 = 
Ãw
 
	`SŞrCl›Á
();

45 
´İs
.
	`£tPrİ”ty
("solr.cloud", "true");

46 
´İs
.
	`£tPrİ”ty
("sŞr.zook“³r.ho¡s", 
mšiSŞrCloudClu¡”
.
	`g‘SŞrCl›Á
().
	`g‘ZkHo¡
());

48 
š¡ªû
.
	`£tPrİ”t›s
(
´İs
);

49 
Œy
 {

50 
š¡ªû
.
	`š™
();

51 } 
	`ÿtch
 (
Exû±iÚ
 
”rÜ
) {

52 
	`assumeNoExû±iÚ
(
”rÜ
);

54  
š¡ªû
;

55 
	}
}

	@solr7/src/test/java/site/ycsb/db/solr7/SolrClientTest.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gsŞr7
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

20 
impÜt
 
	gÜg
.
	g­ache
.
	gsŞr
.
	gş›Á
.
	gsŞrj
.
	gembedded
.
	gJ‘tySŞrRuÂ”
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeNoExû±iÚ
;

27 
public
 cÏs 
	cSŞrCl›ÁTe¡
 
ex‹nds
 
	mSŞrCl›ÁBa£Te¡
 {

29 
´iv©e
 
SŞrCl›Á
 
	mš¡ªû
;

31 @
Aá”


32 
public
 
	$‹¬Down
(è
throws
 
Exû±iÚ
 {

33 
Œy
 {

34 if(
š¡ªû
 !ğ
nuÎ
) {

35 
š¡ªû
.
	`ş—nup
();

37 } 
fš®ly
 {

38 
su³r
.
	`‹¬Down
();

42 @
Ov”ride


43 
´Ùeùed
 
DB
 
	$g‘DB
(
Prİ”t›s
 
´İs
) {

44 
š¡ªû
 = 
Ãw
 
	`SŞrCl›Á
();

48 
J‘tySŞrRuÂ”
 
j‘tySŞrRuÂ”
 = 
mšiSŞrCloudClu¡”
.
	`g‘J‘tySŞrRuÂ”s
().
	`g‘
(0);

49 
SŒšg
 
sŞrBa£U¾
 = SŒšg.
	`fÜm©
("h‰p://loÿlho¡:%s%s", 
j‘tySŞrRuÂ”
.
	`g‘LoÿlPÜt
(),

50 
j‘tySŞrRuÂ”
.
	`g‘Ba£U¾
());

52 
´İs
.
	`£tPrİ”ty
("sŞr.ba£.u¾", 
sŞrBa£U¾
);

53 
š¡ªû
.
	`£tPrİ”t›s
(
´İs
);

55 
Œy
 {

56 
š¡ªû
.
	`š™
();

57 } 
	`ÿtch
 (
Exû±iÚ
 
”rÜ
) {

58 
	`assumeNoExû±iÚ
(
”rÜ
);

60  
š¡ªû
;

61 
	}
}

	@tablestore/src/main/java/site/ycsb/db/tablestore/TableStoreClient.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gbË¡Üe
;

20 
impÜt
 
	gjava
.
	gut
.*;

21 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.*;

23 
impÜt
 
	gs™e
.
	gycsb
.*;

25 
impÜt
 
	gcom
.
	g®işoud
.
	gİ’£rviûs
.
	gbË¡Üe
.*;

26 
impÜt
 
	gcom
.
	g®işoud
.
	gİ’£rviûs
.
	gbË¡Üe
.
	gmod–
.*;

28 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

34 
public
 cÏs 
	cTabËStÜeCl›Á
 
ex‹nds
 
	mDB
 {

36 
´iv©e
 
SyncCl›Á
 
	mş›Á
;

38 
´iv©e
 
	mmaxV”siÚs
 = 1;

39 
´iv©e
 
SŒšg
 
	m´im¬yKeyName
;

41 
´iv©e
 
fš®
 
Logg”
 
	mLOGGER
 = Logg”.
g‘Logg”
(
TabËStÜeCl›Á
.
şass
);

44 
´iv©e
 
£tIÁeg”Prİ”ty
(

45 
Prİ”t›s
 
´İ”t›s
,

46 
SŒšg
 
´İ”tyName
,

47 
Cl›ÁCÚfigu¿tiÚ
 
ş›ÁCÚfigu¿tiÚ
,

48 
FunùiÚ
<
IÁeg”
, 
BoŞ—n
> 
qu®ifyFunùiÚ
,

49 
BiCÚsum”
<
Cl›ÁCÚfigu¿tiÚ
, 
IÁeg”
> 
£tFunùiÚ
è
throws
 
	mDBExû±iÚ
 {

50 
SŒšg
 
	m´İ”tySŒšg
 = 
´İ”t›s
.
g‘Prİ”ty
(
´İ”tyName
);

51 ià(
	m´İ”tySŒšg
 !ğ
nuÎ
) {

52 
IÁeg”
 
´İ”tyIÁeg”
 = 
Ãw
 IÁeg”(
´İ”tySŒšg
);

53 ià(
	mqu®ifyFunùiÚ
.
­¶y
(
´İ”tyIÁeg”
).
boŞ—nV®ue
()) {

54 
	m£tFunùiÚ
.
acû±
(
ş›ÁCÚfigu¿tiÚ
, 
´İ”tyIÁeg”
);

56 
SŒšg
 
	m”rÜMes§ge
 = "IÎeg®‡rgum’t." + 
´İ”tyName
 + ":" + 
´İ”tySŒšg
;

57 
	mLOGGER
.
”rÜ
(
”rÜMes§ge
);

58 
throw
 
Ãw
 
DBExû±iÚ
(
”rÜMes§ge
);

63 @
Ov”ride


64 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

66 
Prİ”t›s
 
´İ”t›s
 = 
	`g‘Prİ”t›s
();

67 
SŒšg
 
acûssID
 = 
´İ”t›s
.
	`g‘Prİ”ty
("alibaba.cloud.tablestore.access_id");

68 
SŒšg
 
acûssKey
 = 
´İ”t›s
.
	`g‘Prİ”ty
("alibaba.cloud.tablestore.access_key");

69 
SŒšg
 
’dPošt
 = 
´İ”t›s
.
	`g‘Prİ”ty
("alibaba.cloud.tablestore.end_point");

70 
SŒšg
 
š¡ªûName
 = 
´İ”t›s
.
	`g‘Prİ”ty
("alibaba.cloud.tablestore.instance_name");

71 
SŒšg
 
maxV”siÚ
 = 
´İ”t›s
.
	`g‘Prİ”ty
("alibaba.cloud.tablestore.max_version", "1");

73 
maxV”siÚs
 = 
IÁeg”
.
	`·r£IÁ
(
maxV”siÚ
);

74 
´im¬yKeyName
 = 
´İ”t›s
.
	`g‘Prİ”ty
("alibaba.cloud.tablestore.primary_key", "");

76 
Cl›ÁCÚfigu¿tiÚ
 
ş›ÁCÚfigu¿tiÚ
 = 
Ãw
 
	`Cl›ÁCÚfigu¿tiÚ
();

78 
	`£tIÁeg”Prİ”ty
(

79 
´İ”t›s
,

81 
ş›ÁCÚfigu¿tiÚ
,

82 (
IÁeg”
 
t
) -> > 0,

83 (
Cl›ÁCÚfigu¿tiÚ
 
c
, 
IÁeg”
 
t
è-> c.
	`£tCÚÃùiÚTimeoutInMli£cÚd
Ñ.
	`štV®ue
()));

85 
	`£tIÁeg”Prİ”ty
(

86 
´İ”t›s
,

88 
ş›ÁCÚfigu¿tiÚ
,

89 (
IÁeg”
 
t
) -> > 0,

90 (
Cl›ÁCÚfigu¿tiÚ
 
c
, 
IÁeg”
 
t
è-> c.
	`£tSock‘TimeoutInMli£cÚd
Ñ.
	`štV®ue
()));

92 
	`£tIÁeg”Prİ”ty
(

93 
´İ”t›s
,

95 
ş›ÁCÚfigu¿tiÚ
,

96 (
IÁeg”
 
t
) -> > 0,

97 (
Cl›ÁCÚfigu¿tiÚ
 
c
, 
IÁeg”
 
t
è-> c.
	`£tMaxCÚÃùiÚs
Ñ.
	`štV®ue
()));

99 
Œy
 {

100 
	`synchrÚized
 (
TabËStÜeCl›Á
.
şass
) {

101 ià(
ş›Á
 =ğ
nuÎ
) {

102 
ş›Á
 = 
Ãw
 
	`SyncCl›Á
(
’dPošt
, 
acûssID
, 
acûssKey
, 
š¡ªûName
, 
ş›ÁCÚfigu¿tiÚ
);

103 
LOGGER
.
	`šfo
("ÃwabË¡Üsynøş›Á\‹ndpošt:" + 
’dPošt
 + "\tš¡ªûName:" + 
š¡ªûName
);

106 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

107 
throw
 
Ãw
 
	`DBExû±iÚ
("IÎeg®‡rgum’ˆ·s£d in. CheckhfÜm© oàyou¸·¿m‘”s.", 
e
);

109 
	}
}

111 
´iv©e
 
£tResuÉ
(
S‘
<
SŒšg
> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
, 
Row
 
row
) {

112 ià(
	grow
 !ğ
nuÎ
) {

113 ià(
f›lds
 !ğ
nuÎ
) {

114 
SŒšg
 
f›ld
 : 
f›lds
) {

115 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
((
row
.
g‘CŞumn
(f›ld).
toSŒšg
())));

118 
CŞumn
 
	gcŞumn
 : 
row
.
g‘CŞumns
()) {

119 
»suÉ
.
put
(
cŞumn
.
g‘Name
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
(cŞumn.
g‘V®ue
().
asSŒšg
()));

125 
´iv©e
 
Stus
 
	$d—lW™hTabËStÜeExû±iÚ
(
TabËStÜeExû±iÚ
 
e
) {

126 ià(
e
.
	`g‘E¼ÜCode
().
	`cÚšs
("OTSRowOperationConflict")) {

127  
Stus
.
ERROR
;

129 
LOGGER
.
	`”rÜ
(
e
);

130  
Stus
.
ERROR
;

131 
	}
}

133 @
Ov”ride


134 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

135 
	gŒy
 {

137 
	gPrim¬yKeyCŞumn
[] 
	g´im¬yKeyCŞumns
 = 
Ãw
 
Prim¬yKeyCŞumn
[1];

138 
	g´im¬yKeyCŞumns
[0] = 
Ãw
 
Prim¬yKeyCŞumn
(
´im¬yKeyName
, 
Prim¬yKeyV®ue
.
äomSŒšg
(
key
));

139 
Prim¬yKey
 
	g´im¬yKey
 = 
Ãw
 Prim¬yKey(
´im¬yKeyCŞumns
);

141 
SšgËRowQu”yCr™”Ÿ
 
	gsšgËRowQu”yCr™”Ÿ
 = 
Ãw
 SšgËRowQu”yCr™”Ÿ(
bË
, 
´im¬yKey
);

142 
	gsšgËRowQu”yCr™”Ÿ
.
£tMaxV”siÚs
(
maxV”siÚs
);

144 ià(
	gf›lds
 !ğ
nuÎ
) {

145 
sšgËRowQu”yCr™”Ÿ
.
addCŞumnsToG‘
(
f›lds
.
toA¼ay
(
Ãw
 
SŒšg
[0]));

148 
G‘RowReque¡
 
	gg‘RowReque¡
 = 
Ãw
 GetRowRequest();

149 
	gg‘RowReque¡
.
£tRowQu”yCr™”Ÿ
(
sšgËRowQu”yCr™”Ÿ
);

151 
G‘RowRe¥Ú£
 
	gg‘RowRe¥Ú£
 = 
ş›Á
.
g‘Row
(
g‘RowReque¡
);

153 
£tResuÉ
(
f›lds
, 
»suÉ
, 
g‘RowRe¥Ú£
.
g‘Row
());

154  
	gStus
.
	gOK
;

155 } 
ÿtch
 (
TabËStÜeExû±iÚ
 
e
) {

156  
d—lW™hTabËStÜeExû±iÚ
(
e
);

157 } 
ÿtch
 (
Exû±iÚ
 
e
) {

158 
	gLOGGER
.
”rÜ
(
e
);

159  
	gStus
.
	gERROR
;

163 @
Ov”ride


164 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

165 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

166 
	gŒy
 {

168 
	gPrim¬yKeyCŞumn
[] 
	g¡¬tKey
 = 
Ãw
 
Prim¬yKeyCŞumn
[1];

169 
	g¡¬tKey
[0] = 
Ãw
 
Prim¬yKeyCŞumn
(
´im¬yKeyName
, 
Prim¬yKeyV®ue
.
äomSŒšg
(
¡¬tkey
));

171 
	gPrim¬yKeyCŞumn
[] 
	g’dKey
 = 
Ãw
 
Prim¬yKeyCŞumn
[1];

172 
	g’dKey
[0] = 
Ãw
 
Prim¬yKeyCŞumn
(
´im¬yKeyName
, 
Prim¬yKeyV®ue
.
INF_MAX
);

174 
RªgeRowQu”yCr™”Ÿ
 
	gü™”Ÿ
 = 
Ãw
 RªgeRowQu”yCr™”Ÿ(
bË
);

175 
	gü™”Ÿ
.
£tInşusiveS¹Prim¬yKey
(
Ãw
 
Prim¬yKey
(
¡¬tKey
));

176 
	gü™”Ÿ
.
£tExşusiveEndPrim¬yKey
(
Ãw
 
Prim¬yKey
(
’dKey
));

177 
	gü™”Ÿ
.
£tMaxV”siÚs
(
maxV”siÚs
);

179 ià(
	gf›lds
 !ğ
nuÎ
) {

180 
ü™”Ÿ
.
addCŞumnsToG‘
(
f›lds
.
toA¼ay
(
Ãw
 
SŒšg
[0]));

183 
	gü™”Ÿ
.
£tLim™
(
»cÜdcouÁ
);

185 
G‘RªgeReque¡
 
	gg‘RªgeReque¡
 = 
Ãw
 GetRangeRequest();

186 
	gg‘RªgeReque¡
.
£tRªgeRowQu”yCr™”Ÿ
(
ü™”Ÿ
);

187 
G‘RªgeRe¥Ú£
 
	gg‘RªgeRe¥Ú£
 = 
ş›Á
.
g‘Rªge
(
g‘RªgeReque¡
);

189 
	gLi¡
<
	gRow
> 
	grows
 = 
g‘RªgeRe¥Ú£
.
g‘Rows
();

190 
Row
 
	grow
 : 
rows
) {

191 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
> 
	gv®ues
 = 
Ãw
 HashMap<>();

192 
£tResuÉ
(
f›lds
, 
v®ues
, 
row
);

193 
	g»suÉ
.
add
(
v®ues
);

195  
	gStus
.
	gOK
;

196 } 
ÿtch
 (
TabËStÜeExû±iÚ
 
e
) {

197  
d—lW™hTabËStÜeExû±iÚ
(
e
);

198 } 
ÿtch
 (
Exû±iÚ
 
e
) {

199 
	gLOGGER
.
”rÜ
(
e
);

200  
	gStus
.
	gERROR
;

204 @
Ov”ride


205 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

206 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

207 
	gŒy
 {

208 
	gPrim¬yKeyCŞumn
[] 
	g´im¬yKeyCŞumns
 = 
Ãw
 
Prim¬yKeyCŞumn
[1];

209 
	g´im¬yKeyCŞumns
[0] = 
Ãw
 
Prim¬yKeyCŞumn
(
´im¬yKeyName
, 
Prim¬yKeyV®ue
.
äomSŒšg
(
key
));

210 
Prim¬yKey
 
	g´im¬yKey
 = 
Ãw
 Prim¬yKey(
´im¬yKeyCŞumns
);

211 
RowUpd©eChªge
 
	growUpd©eChªge
 = 
Ãw
 RowUpd©eChªge(
bË
, 
´im¬yKey
);

213 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
: 
v®ues
.
’ŒyS‘
()) {

214 
rowUpd©eChªge
.
put
(
’Œy
.
g‘Key
(), 
CŞumnV®ue
.
äomSŒšg
ÓÁry.
g‘V®ue
().
toSŒšg
()));

217 
Upd©eRowReque¡
 
	gupd©eRowReque¡
 = 
Ãw
 UpdateRowRequest();

218 
	gupd©eRowReque¡
.
£tRowChªge
(
rowUpd©eChªge
);

219 
	gş›Á
.
upd©eRow
(
upd©eRowReque¡
);

220  
	gStus
.
	gOK
;

221 } 
ÿtch
 (
TabËStÜeExû±iÚ
 
e
) {

222  
d—lW™hTabËStÜeExû±iÚ
(
e
);

223 } 
ÿtch
 (
Exû±iÚ
 
e
) {

224 
	gLOGGER
.
”rÜ
(
e
);

225  
	gStus
.
	gERROR
;

229 @
Ov”ride


230 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

231 
	gŒy
 {

233 
	gPrim¬yKeyCŞumn
[] 
	g´im¬yKeyCŞumns
 = 
Ãw
 
Prim¬yKeyCŞumn
[1];

234 
	g´im¬yKeyCŞumns
[0] = 
Ãw
 
Prim¬yKeyCŞumn
(
´im¬yKeyName
, 
Prim¬yKeyV®ue
.
äomSŒšg
(
key
));

235 
Prim¬yKey
 
	g´im¬yKey
 = 
Ãw
 Prim¬yKey(
´im¬yKeyCŞumns
);

236 
RowPutChªge
 
	growPutChªge
 = 
Ãw
 RowPutChªge(
bË
, 
´im¬yKey
);

238 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
: 
v®ues
.
’ŒyS‘
()) {

239 
rowPutChªge
.
addCŞumn
(
’Œy
.
g‘Key
(), 
CŞumnV®ue
.
äomSŒšg
ÓÁry.
g‘V®ue
().
toSŒšg
()));

242 
PutRowReque¡
 
	gputRowReque¡
 = 
Ãw
 PutRowRequest();

243 
	gputRowReque¡
.
£tRowChªge
(
rowPutChªge
);

245 
	gş›Á
.
putRow
(
putRowReque¡
);

246  
	gStus
.
	gOK
;

247 } 
ÿtch
 (
TabËStÜeExû±iÚ
 
e
) {

248  
d—lW™hTabËStÜeExû±iÚ
(
e
);

249 } 
ÿtch
 (
Exû±iÚ
 
e
) {

250 
	gLOGGER
.
”rÜ
(
e
);

251  
	gStus
.
	gERROR
;

255 @
Ov”ride


256 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

257 
Œy
 {

258 
Prim¬yKeyCŞumn
[] 
´im¬yKeyCŞumns
 = 
Ãw
 PrimaryKeyColumn[1];

259 
´im¬yKeyCŞumns
[0] = 
Ãw
 
	`Prim¬yKeyCŞumn
(
´im¬yKeyName
, 
Prim¬yKeyV®ue
.
	`äomSŒšg
(
key
));

260 
Prim¬yKey
 
´im¬yKey
 = 
Ãw
 
	`Prim¬yKey
(
´im¬yKeyCŞumns
);

262 
RowD–‘eChªge
 
rowD–‘eChªge
 = 
Ãw
 
	`RowD–‘eChªge
(
bË
, 
´im¬yKey
);

264 
D–‘eRowReque¡
 
d–‘eRowReque¡
 = 
Ãw
 
	`D–‘eRowReque¡
();

265 
d–‘eRowReque¡
.
	`£tRowChªge
(
rowD–‘eChªge
);

266 
ş›Á
.
	`d–‘eRow
(
d–‘eRowReque¡
);

267  
Stus
.
OK
;

268 } 
	`ÿtch
 (
TabËStÜeExû±iÚ
 
e
) {

269  
	`d—lW™hTabËStÜeExû±iÚ
(
e
);

270 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

271 
LOGGER
.
	`”rÜ
(
e
);

272  
Stus
.
ERROR
;

274 
	}
}

	@tablestore/src/main/java/site/ycsb/db/tablestore/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gbË¡Üe
;

	@tarantool/src/main/java/site/ycsb/db/TarantoolClient.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

19 
impÜt
 
	gs™e
.
	gycsb
.*;

20 
impÜt
 
	gÜg
.
	g¿ÁoŞ
.
	gT¬ªtoŞCÚÃùiÚ16
;

21 
impÜt
 
	gÜg
.
	g¿ÁoŞ
.
	gT¬ªtoŞCÚÃùiÚ16Im¶
;

22 
impÜt
 
	gÜg
.
	g¿ÁoŞ
.
	gT¬ªtoŞExû±iÚ
;

24 
impÜt
 
	gjava
.
	gut
.*;

25 
impÜt
 
	gjava
.
	gut
.
	gloggšg
.
	gLev–
;

26 
impÜt
 
	gjava
.
	gut
.
	gloggšg
.
	gLogg”
;

31 
public
 cÏs 
	cT¬ªtoŞCl›Á
 
ex‹nds
 
	mDB
 {

32 
´iv©e
 
fš®
 
Logg”
 
	mLOGGER
 = Logg”.
g‘Logg”
(
T¬ªtoŞCl›Á
.
şass
.
g‘Name
());

34 
´iv©e
 
fš®
 
SŒšg
 
	mHOST_PROPERTY
 = "tarantool.host";

35 
´iv©e
 
fš®
 
SŒšg
 
	mPORT_PROPERTY
 = "tarantool.port";

36 
´iv©e
 
fš®
 
SŒšg
 
	mSPACE_PROPERTY
 = "tarantool.space";

37 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_HOST
 = "localhost";

38 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_PORT
 = "3301";

39 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_SPACE
 = "1024";

41 
´iv©e
 
T¬ªtoŞCÚÃùiÚ16
 
	mcÚÃùiÚ
;

42 
´iv©e
 
	m¥aûNo
;

44 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

45 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

47 
pÜt
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
PORT_PROPERTY
, 
DEFAULT_PORT
));

48 
SŒšg
 
ho¡
 = 
´İs
.
	`g‘Prİ”ty
(
HOST_PROPERTY
, 
DEFAULT_HOST
);

49 
¥aûNo
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
SPACE_PROPERTY
, 
DEFAULT_SPACE
));

51 
Œy
 {

52 
this
.
cÚÃùiÚ
 = 
Ãw
 
	`T¬ªtoŞCÚÃùiÚ16Im¶
(
ho¡
, 
pÜt
);

53 } 
	`ÿtch
 (
Exû±iÚ
 
exc
) {

54 
throw
 
Ãw
 
	`DBExû±iÚ
("Cª'ˆš™ŸlizT¬ªtoŞ cÚÃùiÚ", 
exc
);

58 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

59 
this
.
cÚÃùiÚ
.
	`şo£
();

60 
	}
}

62 @
Ov”ride


63 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

64  
»¶aû
(
key
, 
v®ues
, "Can't insertƒlement");

67 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
tu¶eCÚv”tF‹r
(
Li¡
<
SŒšg
> 
šput
, 
S‘
<SŒšg> 
f›lds
) {

68 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»suÉ
 = 
Ãw
 
HashM­
<>();

69 ià(
	gšput
 =ğ
nuÎ
) {

70  
»suÉ
;

72 
	gi
 = 1; i < 
	gšput
.
toA¼ay
().
	gËngth
; i += 2) {

73 ià(
f›lds
 =ğ
nuÎ
 || f›lds.
cÚšs
(
šput
.
g‘
(
i
))) {

74 
»suÉ
.
put
(
šput
.
g‘
(
i
), 
Ãw
 
SŒšgBy‹I‹¿tÜ
(input.get(i + 1)));

77  
	g»suÉ
;

80 @
Ov”ride


81 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

82 
	gŒy
 {

83 
	gLi¡
<
	gSŒšg
> 
	g»¥Ú£
 = 
this
.
cÚÃùiÚ
.
£Ëù
Ñhis.
¥aûNo
, 0, 
A¼ays
.
asLi¡
(
key
), 0, 1, 0);

84 
	g»suÉ
 = 
tu¶eCÚv”tF‹r
(
»¥Ú£
, 
f›lds
);

85  
	gStus
.
	gOK
;

86 } 
ÿtch
 (
T¬ªtoŞExû±iÚ
 
exc
) {

87 
	gLOGGER
.
log
(
Lev–
.
SEVERE
, "Cª'ˆ£ËùƒËm’t", 
exc
);

88  
	gStus
.
	gERROR
;

89 } 
ÿtch
 (
NuÎPoš‹rExû±iÚ
 
exc
) {

90  
	gStus
.
	gERROR
;

94 @
Ov”ride


95 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
,

96 
»cÜdcouÁ
, 
S‘
<
SŒšg
> 
f›lds
,

97 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

98 
	gLi¡
<Li¡<
	gSŒšg
>> 
	g»¥Ú£
;

99 
	gŒy
 {

100 
	g»¥Ú£
 = 
this
.
cÚÃùiÚ
.
£Ëù
Ñhis.
¥aûNo
, 0, 
A¼ays
.
asLi¡
(
¡¬tkey
), 0, 
»cÜdcouÁ
, 6);

101 } 
ÿtch
 (
T¬ªtoŞExû±iÚ
 
exc
) {

102 
	gLOGGER
.
log
(
Lev–
.
SEVERE
, "Cª'ˆ£Ëù„ªg–em’ts", 
exc
);

103  
	gStus
.
	gERROR
;

104 } 
ÿtch
 (
NuÎPoš‹rExû±iÚ
 
exc
) {

105  
	gStus
.
	gERROR
;

107 
	gLi¡
<
	gSŒšg
> 
	gi
 : 
»¥Ú£
) {

108 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
> 
	g‹mp
 = 
tu¶eCÚv”tF‹r
(
i
, 
f›lds
);

109 ià(!
	g‹mp
.
isEm±y
()) {

110 
	g»suÉ
.
add
((
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>è
‹mp
.
şÚe
());

113  
	gStus
.
	gOK
;

116 @
Ov”ride


117 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

118 
Œy
 {

119 
this
.
cÚÃùiÚ
.
	`d–‘e
Ñhis.
¥aûNo
, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
key
));

120 } 
	`ÿtch
 (
T¬ªtoŞExû±iÚ
 
exc
) {

121 
LOGGER
.
	`log
(
Lev–
.
SEVERE
, "Cª'ˆd–‘–em’t", 
exc
);

122  
Stus
.
ERROR
;

123 } 
	`ÿtch
 (
NuÎPoš‹rExû±iÚ
 
e
) {

124  
Stus
.
ERROR
;

126  
Stus
.
OK
;

127 
	}
}

129 @
Ov”ride


130 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

131  
»¶aû
(
key
, 
v®ues
, "Can't„eplaceƒlement");

134 
´iv©e
 
Stus
 
»¶aû
(
SŒšg
 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
, SŒšg 
exû±iÚDesütiÚ
) {

135 
	gj
 = 0;

136 
	gSŒšg
[] 
	gtu¶e
 = 
Ãw
 
SŒšg
[1 + 2 * 
v®ues
.
size
()];

137 
	gtu¶e
[0] = 
key
;

138 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gi
 : 
v®ues
.
’ŒyS‘
()) {

139 
tu¶e
[
j
 + 1] = 
i
.
g‘Key
();

140 
	gtu¶e
[
j
 + 2] = 
i
.
g‘V®ue
().
toSŒšg
();

141 
	gj
 += 2;

143 
	gŒy
 {

144 
	gthis
.
	gcÚÃùiÚ
.
»¶aû
(
this
.
¥aûNo
, 
tu¶e
);

145 } 
ÿtch
 (
T¬ªtoŞExû±iÚ
 
exc
) {

146 
	gLOGGER
.
log
(
Lev–
.
SEVERE
, 
exû±iÚDesütiÚ
, 
exc
);

147  
	gStus
.
	gERROR
;

149  
	gStus
.
	gOK
;

	@tarantool/src/main/java/site/ycsb/db/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
;

	@voltdb/src/main/java/site/ycsb/db/voltdb/ConnectionHelper.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gÃt
.
	gSock‘
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

27 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

28 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

29 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›Á
;

30 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›ÁCÚfig
;

31 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›ÁFaùÜy
;

36 
public
 
fš®
 cÏs 
	cCÚÃùiÚH–³r
 {

41 
´iv©e
 
fš®
 
	mVOLTDB_DEFAULT_PORT
 = 21212;

46 
´iv©e
 
	$CÚÃùiÚH–³r
() {

67 
public
 
Cl›Á
 
	$ü—‹CÚÃùiÚ
(
SŒšg
 
£rv”s
, SŒšg 
u£r
, SŒšg 
·sswÜd
,

68 
¿‹lim™
è
throws
 
IOExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

70 
Cl›ÁCÚfig
 
cÚfig
 = 
Ãw
 
	`Cl›ÁCÚfig
(
u£r
, 
·sswÜd
);

71 
cÚfig
.
	`£tMaxT¿n§ùiÚsP”SecÚd
(
¿‹lim™
);

72 
Cl›Á
 
ş›Á
 = 
Cl›ÁFaùÜy
.
	`ü—‹Cl›Á
(
cÚfig
);

76 
	`cÚÃù
(
ş›Á
, 
£rv”s
);

78  
ş›Á
;

79 
	}
}

89 
´iv©e
 
	$cÚÃùToOÃS”v”W™hR‘ry
(
fš®
 
Cl›Á
 
ş›Á
, 
SŒšg
 
£rv”
) {

91 
Logg”
 
logg”
 = 
Logg”FaùÜy
.
	`g‘Logg”
(
CÚÃùiÚH–³r
.
şass
);

93 
¦“p
 = 1000;

94 
Œue
) {

95 
Œy
 {

96 
ş›Á
.
	`ü—‹CÚÃùiÚ
(
£rv”
);

98 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

99 
logg”
.
	`”rÜ
("CÚÃùiÚ faed -„‘ryšg iÀ%d secÚd(s).\n", 
¦“p
 / 1000);

100 
Œy
 {

101 
Th»ad
.
	`¦“p
(
¦“p
);

102 } 
	`ÿtch
 (
java
.
Ïng
.
IÁ”ru±edExû±iÚ
 
e2
) {

103 
logg”
.
	`”rÜ
(
e2
.
	`g‘Mes§ge
());

105 ià(
¦“p
 < 8000) {

106 
¦“p
 += sleep;

111 
logg”
.
	`šfo
("CÚÃùedØVŞtDB‚od©:" + 
£rv”
);

112 
	}
}

119 
public
 
boŞ—n
 
	$checkDBS”v”s
(
SŒšg
 
£rv”Çmes
) {

121 
SŒšg
[] 
£rv”NamesA¼ay
 = 
£rv”Çmes
.
	`¥l™
(",");

123 
boŞ—n
 
dbTh”e
 = 
çl£
;

125 
Sock‘
 
sock‘
 = 
nuÎ
;

126 
Œy
 {

128 
sock‘
 = 
Ãw
 
	`Sock‘
(
£rv”NamesA¼ay
[0], 
VOLTDB_DEFAULT_PORT
);

129 
dbTh”e
 = 
Œue
;

130 } 
	`ÿtch
 (
IOExû±iÚ
 
cÚÃùFaed
) {

131 
dbTh”e
 = 
çl£
;

132 } 
fš®ly
 {

133 ià(
sock‘
 !ğ
nuÎ
) {

134 
Œy
 {

135 
sock‘
.
	`şo£
();

136 } 
	`ÿtch
 (
IOExû±iÚ
 
ignÜe
) {

140 
sock‘
 = 
nuÎ
;

143  
dbTh”e
;

145 
	}
}

155 
´iv©e
 
	$cÚÃù
(
fš®
 
Cl›Á
 
ş›Á
, 
SŒšg
 
£rv”s
è
throws
 
IÁ”ru±edExû±iÚ
 {

157 
Logg”
 
logg”
 = 
Logg”FaùÜy
.
	`g‘Logg”
(
CÚÃùiÚH–³r
.
şass
);

159 
logg”
.
	`šfo
("Connectingo VoltDB...");

161 
SŒšg
[] 
£rv”A¼ay
 = 
£rv”s
.
	`¥l™
(",");

162 
fš®
 
CouÁDownL©ch
 
cÚÃùiÚs
 = 
Ãw
 
	`CouÁDownL©ch
(
£rv”A¼ay
.
Ëngth
);

165 
fš®
 
SŒšg
 
£rv”
 : 
£rv”A¼ay
) {

166 
Ãw
 
	`Th»ad
Òew 
	`RuÂabË
() {

167 @
Ov”ride


168 
public
 
	`run
() {

169 
	`cÚÃùToOÃS”v”W™hR‘ry
(
ş›Á
, 
£rv”
);

170 
cÚÃùiÚs
.
	`couÁDown
();

172 }).
	`¡¬t
();

175 
cÚÃùiÚs
.
	`awa™
();

176 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/VoltClient4.java

25 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
;

27 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

28 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gCh¬£t
;

29 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

32 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

33 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

35 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

36 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

37 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gVŞtTabË
;

38 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›Á
;

39 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›ÁRe¥Ú£
;

40 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›ÁRe¥Ú£W™hP¬t™iÚKey
;

41 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gNoCÚÃùiÚsExû±iÚ
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹A¼ayBy‹I‹¿tÜ
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

45 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

46 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

47 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

48 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	gsÜ‹dvŞ‰abË
.
	gVŞtDBTabËSÜ‹dM”geW¿ngËr
;

53 
public
 cÏs 
	cVŞtCl›Á4
 
ex‹nds
 
	mDB
 {

55 
´iv©e
 
Cl›Á
 
	mmş›Á
;

56 
´iv©e
 
	mby‹
[] 
	mmwÜkšgD©a
;

57 
´iv©e
 
By‹Bufãr
 
	mmwr™eBuf
;

58 
´iv©e
 
boŞ—n
 
	mu£SÿnAÎ
 = 
çl£
;

59 
´iv©e
 
fš®
 
Ch¬£t
 
	mUTF8
 = Ch¬£t.
fÜName
("UTF-8");

61 
´iv©e
 
Logg”
 
	mlogg”
 = 
Logg”FaùÜy
.
g‘Logg”
(
VŞtCl›Á4
.
şass
);

63 
´iv©e
 
YCSBSchemaBud”
 
	mysb
 = 
nuÎ
;

65 @
Ov”ride


66 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

67 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

68 
SŒšg
 
£rv”s
 = 
´İs
.
	`g‘Prİ”ty
("voltdb.servers", "localhost");

69 
SŒšg
 
u£r
 = 
´İs
.
	`g‘Prİ”ty
("voltdb.user", "");

70 
SŒšg
 
·sswÜd
 = 
´İs
.
	`g‘Prİ”ty
("voltdb.password", "");

71 
SŒšg
 
¡rLim™
 = 
´İs
.
	`g‘Prİ”ty
("voltdb.ratelimit");

72 
SŒšg
 
u£SÿnAÎP¬am
 = 
´İs
.
	`g‘Prİ”ty
("voltdb.scanall", "no");

74 ià(
u£SÿnAÎP¬am
.
	`equ®sIgnÜeCa£
("YES")) {

75 
u£SÿnAÎ
 = 
Œue
;

78 
¿‹lim™
 = 
¡rLim™
 !ğ
nuÎ
 ? 
IÁeg”
.
	`·r£IÁ
(¡rLim™è: IÁeg”.
MAX_VALUE
;

79 
Œy
 {

80 
mş›Á
 = 
CÚÃùiÚH–³r
.
	`ü—‹CÚÃùiÚ
(
£rv”s
, 
u£r
, 
·sswÜd
, 
¿‹lim™
);

82 
ysb
 = 
SticHŞd”
.
INSTANCE
;

83 
ysb
.
	`lßdCÏs£sAndDDLIfN“ded
(
mş›Á
);

85 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

86 
logg”
.
	`”rÜ
("E¼Ü whü—tšg cÚÃùiÚ: ", 
e
);

87 
throw
 
Ãw
 
	`DBExû±iÚ
(
e
.
	`g‘Mes§ge
());

89 
mwÜkšgD©a
 = 
Ãw
 
by‹
[1024 * 1024];

90 
mwr™eBuf
 = 
By‹Bufãr
.
	`w¿p
(
mwÜkšgD©a
);

96 
public
 
boŞ—n
 
	$hasCÚÃùiÚ
() {

98 ià(
mş›Á
 !ğ
nuÎ
 && mş›Á.
	`g‘CÚÃùedHo¡Li¡
().
	`size
() > 0) {

99  
Œue
;

102  
çl£
;

104 
	}
}

106 @
Ov”ride


107 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

110 ià(
mş›Á
 !ğ
nuÎ
 && mş›Á.
	`g‘CÚÃùedHo¡Li¡
().
	`size
() > 0) {

112 
Œy
 {

113 
mş›Á
.
	`d¿š
();

114 
mş›Á
.
	`şo£
();

115 } 
	`ÿtch
 (
NoCÚÃùiÚsExû±iÚ
 
e
) {

116 
logg”
.
	`”rÜ
(
e
.
	`g‘Mes§ge
(),ƒ);

117 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

118 
logg”
.
	`”rÜ
(
e
.
	`g‘Mes§ge
(),ƒ);

121 
mş›Á
 = 
nuÎ
;

125 
	}
}

127 @
Ov”ride


128 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
key¥aû
, SŒšg 
key
) {

129 
Œy
 {

130 
Cl›ÁRe¥Ú£
 
»¥Ú£
 = 
mş›Á
.
	`ÿÎProûdu»
("STORE.d–‘e", 
key
, 
key¥aû
.
	`g‘By‹s
(
UTF8
));

131  
»¥Ú£
.
	`g‘Stus
(è=ğ
Cl›ÁRe¥Ú£
.
SUCCESS
 ? 
Stus
.
OK
 : Stus.
ERROR
;

132 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

133 
logg”
.
	`”rÜ
("E¼Ü whd–‘šg„ow", 
e
);

134  
Stus
.
ERROR
;

136 
	}
}

138 @
Ov”ride


139 
public
 
Stus
 
š£¹
(
SŒšg
 
key¥aû
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
cŞumns
) {

140  
upd©e
(
key¥aû
, 
key
, 
cŞumns
);

143 @
Ov”ride


144 
public
 
Stus
 
»ad
(
SŒšg
 
key¥aû
, SŒšg 
key
, 
S‘
<SŒšg> 
cŞumns
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

145 
	gŒy
 {

146 
Cl›ÁRe¥Ú£
 
	g»¥Ú£
 = 
mş›Á
.
ÿÎProûdu»
("G‘", 
key¥aû
.
g‘By‹s
(
UTF8
), 
key
);

147 ià(
	g»¥Ú£
.
g‘Stus
(è!ğ
Cl›ÁRe¥Ú£
.
SUCCESS
) {

148  
Stus
.
ERROR
;

150 
VŞtTabË
 
	gbË
 = 
»¥Ú£
.
g‘ResuÉs
()[0];

151 ià(
	gbË
.
advªûRow
()) {

152 
uÅackRowD©a
(
bË
, 
cŞumns
, 
»suÉ
);

154  
	gStus
.
	gOK
;

155 } 
ÿtch
 (
Exû±iÚ
 
e
) {

156 
	glogg”
.
”rÜ
("E¼Ü whGETšg„ow", 
e
);

157  
	gStus
.
	gERROR
;

161 @
Ov”ride


162 
public
 
Stus
 
sÿn
(
SŒšg
 
key¥aû
, SŒšg 
low”Bound
, 
»cÜdCouÁ
, 
S‘
<SŒšg> 
cŞumns
,

163 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

165 
	gŒy
 {

167 ià(
	gu£SÿnAÎ
) {

169 
	gby‹
[] 
	gks
 = 
key¥aû
.
g‘By‹s
(
UTF8
);

170 
Cl›ÁRe¥Ú£
 
	g»¥Ú£
 = 
mş›Á
.
ÿÎProûdu»
("SÿnAÎ", 
ks
, 
low”Bound
.
g‘By‹s
(
UTF8
), 
»cÜdCouÁ
);

172 ià(
	g»¥Ú£
.
g‘Stus
(è!ğ
Cl›ÁRe¥Ú£
.
SUCCESS
) {

173  
Stus
.
ERROR
;

176 
	g»suÉ
.
’su»C­ac™y
(
»cÜdCouÁ
);

178 
VŞtTabË
 
	gouutTabË
 = 
»¥Ú£
.
g‘ResuÉs
()[0];

179 
	gouutTabË
.
»£tRowPos™iÚ
();

180 
	gouutTabË
.
advªûRow
()) {

181 
	g»suÉ
.
add
(
uÅackRowD©aHashM­
(
ouutTabË
, 
cŞumns
));

186 
	gby‹
[] 
	gks
 = 
key¥aû
.
g‘By‹s
(
UTF8
);

187 
	gCl›ÁRe¥Ú£W™hP¬t™iÚKey
[] 
	g»¥Ú£
 = 
mş›Á
.
ÿÎAÎP¬t™iÚProûdu»
("Sÿn", 
ks
,

188 
low”Bound
.
g‘By‹s
(
UTF8
), 
»cÜdCouÁ
);

190 
	gi
 = 0; i < 
	g»¥Ú£
.
	gËngth
; i++) {

191 ià(
	g»¥Ú£
[
i
].»¥Ú£.
g‘Stus
(è!ğ
Cl›ÁRe¥Ú£
.
SUCCESS
) {

192  
Stus
.
ERROR
;

197 
	g»suÉ
.
’su»C­ac™y
(
»cÜdCouÁ
);

199 
VŞtDBTabËSÜ‹dM”geW¿ngËr
 
	gsmw
 = 
Ãw
 VŞtDBTabËSÜ‹dM”geW¿ngËr(
»¥Ú£
);

201 
VŞtTabË
 
	gouutTabË
 = 
smw
.
g‘SÜ‹dTabË
(1, 
»cÜdCouÁ
);

202 
	gouutTabË
.
»£tRowPos™iÚ
();

203 
	gouutTabË
.
advªûRow
()) {

204 
	g»suÉ
.
add
(
uÅackRowD©aHashM­
(
ouutTabË
, 
cŞumns
));

209  
	gStus
.
	gOK
;

210 } 
ÿtch
 (
Exû±iÚ
 
e
) {

211 
	glogg”
.
”rÜ
("E¼Ü whÿÎšg SCAN", 
e
);

212  
	gStus
.
	gERROR
;

216 @
Ov”ride


217 
public
 
Stus
 
upd©e
(
SŒšg
 
key¥aû
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
cŞumns
) {

218 
	gŒy
 {

219 
Cl›ÁRe¥Ú£
 
	g»¥Ú£
 = 
mş›Á
.
ÿÎProûdu»
("Put", 
key¥aû
.
g‘By‹s
(
UTF8
), 
key
, 
·ckRowD©a
(
cŞumns
));

220  
	g»¥Ú£
.
g‘Stus
(è=ğ
Cl›ÁRe¥Ú£
.
SUCCESS
 ? 
Stus
.
OK
 : Stus.
ERROR
;

221 } 
ÿtch
 (
Exû±iÚ
 
e
) {

222 
	glogg”
.
”rÜ
("E¼Ü whÿÎšg Upd©e", 
e
);

223  
	gStus
.
	gERROR
;

227 
´iv©e
 
	gby‹
[] 
·ckRowD©a
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
cŞumns
) {

228 
	gmwr™eBuf
.
ş—r
();

229 
	gmwr™eBuf
.
putIÁ
(
cŞumns
.
size
());

230 
SŒšg
 
	gkey
 : 
cŞumns
.
keyS‘
()) {

231 
by‹
[] 
k
 = 
key
.
g‘By‹s
(
UTF8
);

232 
	gmwr™eBuf
.
putIÁ
(
k
.
Ëngth
);

233 
	gmwr™eBuf
.
put
(
k
);

235 
By‹I‹¿tÜ
 
	gv
 = 
cŞumns
.
g‘
(
key
);

236 
	gËn
 = (è
v
.
by‹sLeá
();

237 
	gmwr™eBuf
.
putIÁ
(
Ën
);

238 
	gv
.
ÃxtBuf
(
mwÜkšgD©a
, 
mwr™eBuf
.
pos™iÚ
());

239 
	gmwr™eBuf
.
pos™iÚ
(
mwr™eBuf
.pos™iÚ(è+ 
Ën
);

242 
	gby‹
[] 
	gd©a
 = 
Ãw
 
by‹
[
mwr™eBuf
.
pos™iÚ
()];

243 
	gSy¡em
.
¬¿ycİy
(
mwÜkšgD©a
, 0, 
d©a
, 0, d©a.
Ëngth
);

244  
	gd©a
;

247 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
uÅackRowD©a
(
VŞtTabË
 
d©a
, 
S‘
<
SŒšg
> 
f›lds
,

248 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

249 
	gby‹
[] 
	growD©a
 = 
d©a
.
g‘V¬bš¬y
(0);

250 
By‹Bufãr
 
	gbuf
 = By‹Bufãr.
w¿p
(
rowD©a
);

251 
	gnF›lds
 = 
buf
.
g‘IÁ
();

252  
uÅackRowD©a
(
rowD©a
, 
buf
, 
nF›lds
, 
f›lds
, 
»suÉ
);

255 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
uÅackRowD©a
(
by‹
[] 
rowD©a
, 
By‹Bufãr
 
buf
, 
nF›lds
, 
S‘
<
SŒšg
> 
f›lds
,

256 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

257 
	gi
 = 0; i < 
	gnF›lds
; i++) {

258 
	gËn
 = 
buf
.
g‘IÁ
();

259 
	goff
 = 
buf
.
pos™iÚ
();

260 
SŒšg
 
	gkey
 = 
Ãw
 SŒšg(
rowD©a
, 
off
, 
Ën
, 
UTF8
);

261 
	gbuf
.
pos™iÚ
(
off
 + 
Ën
);

262 
	gËn
 = 
buf
.
g‘IÁ
();

263 
	goff
 = 
buf
.
pos™iÚ
();

264 ià(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
cÚšs
(
key
)) {

265 
»suÉ
.
put
(
key
, 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
rowD©a
, 
off
, 
Ën
));

267 
	gbuf
.
pos™iÚ
(
off
 + 
Ën
);

269  
	g»suÉ
;

272 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
uÅackRowD©aHashM­
(
VŞtTabË
 
d©a
, 
S‘
<
SŒšg
> 
f›lds
) {

273 
	gby‹
[] 
	growD©a
 = 
d©a
.
g‘V¬bš¬y
(0);

274 
By‹Bufãr
 
	gbuf
 = By‹Bufãr.
w¿p
(
rowD©a
);

275 
	gnF›lds
 = 
buf
.
g‘IÁ
();

276 
	gsize
 = 
f›lds
 !ğ
nuÎ
 ? 
M©h
.
mš
(f›lds.
size
(), 
nF›lds
) :‚Fields;

277 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»s
 = 
Ãw
 
HashM­
<
SŒšg
, By‹I‹¿tÜ>(
	gsize
, () 1.25);

278  
uÅackRowD©aHashM­
(
rowD©a
, 
buf
, 
nF›lds
, 
f›lds
, 
»s
);

281 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
uÅackRowD©aHashM­
(
by‹
[] 
rowD©a
, 
By‹Bufãr
 
buf
, 
nF›lds
,

282 
S‘
<
SŒšg
> 
f›lds
, 
HashM­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

283 
	gi
 = 0; i < 
	gnF›lds
; i++) {

284 
	gËn
 = 
buf
.
g‘IÁ
();

285 
	goff
 = 
buf
.
pos™iÚ
();

286 
SŒšg
 
	gkey
 = 
Ãw
 SŒšg(
rowD©a
, 
off
, 
Ën
, 
UTF8
);

287 
	gbuf
.
pos™iÚ
(
off
 + 
Ën
);

288 
	gËn
 = 
buf
.
g‘IÁ
();

289 
	goff
 = 
buf
.
pos™iÚ
();

290 ià(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
cÚšs
(
key
)) {

291 
»suÉ
.
put
(
key
, 
Ãw
 
By‹A¼ayBy‹I‹¿tÜ
(
rowD©a
, 
off
, 
Ën
));

293 
	gbuf
.
pos™iÚ
(
off
 + 
Ën
);

295  
	g»suÉ
;

298 
´iv©e
 şas 
	cSticHŞd”
 {

299 
fš®
 
YCSBSchemaBud”
 
	gINSTANCE
 = 
Ãw
 YCSBSchemaBuilder();

	@voltdb/src/main/java/site/ycsb/db/voltdb/YCSBSchemaBuilder.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
;

19 
impÜt
 
	gjava
.
	gio
.
	gBufã»dIÅutSŒ—m
;

20 
impÜt
 
	gjava
.
	gio
.
	gFe
;

21 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

22 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

25 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gCh¬£t
;

26 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

27 
impÜt
 
	gjava
.
	gut
.
	gj¬
.
	gA‰ribu‹s
;

28 
impÜt
 
	gjava
.
	gut
.
	gj¬
.
	gJ¬EÁry
;

29 
impÜt
 
	gjava
.
	gut
.
	gj¬
.
	gJ¬OuutSŒ—m
;

30 
impÜt
 
	gjava
.
	gut
.
	gj¬
.
	gMªiã¡
;

32 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

33 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

34 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›Á
;

35 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›ÁRe¥Ú£
;

36 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gProcC®lExû±iÚ
;

42 
public
 
fš®
 cÏs 
	cYCSBSchemaBud”
 {

44 
´iv©e
 
fš®
 
SŒšg
 
	mPROCEDURE_GET_WAS_NOT_FOUND
 = "Procedure Get was‚ot found";

46 
´iv©e
 
fš®
 
Ch¬£t
 
	mUTF8
 = Ch¬£t.
fÜName
("UTF-8");

48 
´iv©e
 
fš®
 
SŒšg
 
	mü—‹TabËDDL
 = "CREATE TABLE Store (keyspace VARBINARY(128) NOT NULL\n"

52 
´iv©e
 
fš®
 
SŒšg
 
	m·¹™iÚTabËDDL
 = "PARTITION TABLE Store ON COLUMN key;\n";

54 
´iv©e
 
fš®
 
SŒšg
 
	mü—‹G‘DDL
 = "CREATE PROCEDURE Get PARTITION ON TABLE Store COLUMN key PARAMETER 1\n"

57 
´iv©e
 
fš®
 
SŒšg
 
	mü—‹PutDDL
 = "CREATE PROCEDURE PARTITION ON TABLE Store COLUMN key PARAMETER 1\n"

60 
´iv©e
 
fš®
 
SŒšg
 
	mü—‹SÿnDDL
 = "CREATE PROCEDURE PARTITION ON TABLE Store COLUMN key \n"

63 
´iv©e
 
fš®
 
SŒšg
 
	mü—‹SÿnAÎDDL
 = "CREATE PROCEDURE \n" + "FROM CLASS site.ycsb.db.voltdb.procs.ScanAll;";

65 
´iv©e
 
fš®
 
	mSŒšg
[] 
	mddlS‹m’ts
 = {
ü—‹TabËDDL
, 
·¹™iÚTabËDDL
 };

67 
´iv©e
 
fš®
 
	gSŒšg
[] 
	g´ocS‹m’ts
 = {
ü—‹G‘DDL
, 
ü—‹PutDDL
, 
ü—‹SÿnDDL
, 
ü—‹SÿnAÎDDL
 };

69 
´iv©e
 
fš®
 
	gSŒšg
[] 
	gj¬Fes
 = {"Put.class", "Scan.class", "ScanAll.class", "ByteWrapper.class" };

71 
´iv©e
 
fš®
 
SŒšg
 
	gj¬FeName
 = "ycsb-procs.jar";

73 
´iv©e
 
Logg”
 
	glogg”
 = 
Logg”FaùÜy
.
g‘Logg”
(
YCSBSchemaBud”
.
şass
);

81 
	$YCSBSchemaBud”
() {

82 
	`su³r
();

83 
	}
}

91 
public
 
boŞ—n
 
	$schemaExi¡s
(
Cl›Á
 
vŞtCl›Á
) {

93 
fš®
 
SŒšg
 
‹¡SŒšg
 = "Test";

94 
boŞ—n
 
schemaExi¡s
 = 
çl£
;

96 
Œy
 {

97 
Cl›ÁRe¥Ú£
 
»¥Ú£
 = 
vŞtCl›Á
.
	`ÿÎProûdu»
("G‘", 
‹¡SŒšg
.
	`g‘By‹s
(
UTF8
),estString);

99 ià(
»¥Ú£
.
	`g‘Stus
(è=ğ
Cl›ÁRe¥Ú£
.
SUCCESS
) {

101 
schemaExi¡s
 = 
Œue
;

105 
logg”
.
	`”rÜ
("E¼Ü whÿÎšg schemaExi¡s(): " + 
»¥Ú£
.
	`g‘StusSŒšg
());

106 
schemaExi¡s
 = 
çl£
;

108 } 
	`ÿtch
 (
ProcC®lExû±iÚ
 
pû
) {

109 
schemaExi¡s
 = 
çl£
;

112 ià(!
pû
.
	`g‘Mes§ge
().
	`equ®s
(
PROCEDURE_GET_WAS_NOT_FOUND
)) {

113 
logg”
.
	`”rÜ
("GÙ uÃx³ùed Exû±iÚ whÿÎšg schemaExi¡s()", 
pû
);

116 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

117 
logg”
.
	`”rÜ
("E¼Ü whü—tšg cÏs£s.", 
e
);

118 
schemaExi¡s
 = 
çl£
;

121  
schemaExi¡s
;

122 
	}
}

129 
public
 
synchrÚized
 
	$lßdCÏs£sAndDDLIfN“ded
(
Cl›Á
 
vŞtCl›Á
è
throws
 
Exû±iÚ
 {

131 ià(
	`schemaExi¡s
(
vŞtCl›Á
)) {

135 
Fe
 
‹mpDœ
 = 
Fes
.
	`ü—‹TempDœeùÜy
("vŞtdbYCSB").
	`toFe
();

137 ià(!
‹mpDœ
.
	`ÿnWr™e
()) {

138 
throw
 
Ãw
 
	`Exû±iÚ
("Temp Directory (from Files.createTempDirectory()) '"

139 + 
‹mpDœ
.
	`g‘AbsŞu‹P©h
() + "' is‚ot writable");

142 
Cl›ÁRe¥Ú£
 
ü
;

144 
i
 = 0; i < 
ddlS‹m’ts
.
Ëngth
; i++) {

145 
Œy
 {

146 
ü
 = 
vŞtCl›Á
.
	`ÿÎProûdu»
("@AdHoc", 
ddlS‹m’ts
[
i
]);

147 ià(
ü
.
	`g‘Stus
(è!ğ
Cl›ÁRe¥Ú£
.
SUCCESS
) {

148 
throw
 
Ãw
 
	`Exû±iÚ
("A‰em±Øexecu‹ '" + 
ddlS‹m’ts
[
i
] + "' faed:" + 
ü
.
	`g‘StusSŒšg
());

150 
logg”
.
	`šfo
(
ddlS‹m’ts
[
i
]);

151 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

153 ià(
e
.
	`g‘Mes§ge
().
	`šdexOf
("object‚ame‡lreadyƒxists") > -1) {

158 
	`throw
 (
e
);

162 
logg”
.
	`šfo
("C»©šg JAR fš " + 
‹mpDœ
 + 
Fe
.
£·¿tÜ
 + 
j¬FeName
);

163 
Mªiã¡
 
mªiã¡
 = 
Ãw
 
	`Mªiã¡
();

164 
mªiã¡
.
	`g‘MašA‰ribu‹s
().
	`put
(
A‰ribu‹s
.
Name
.
MANIFEST_VERSION
, "1.0");

165 
J¬OuutSŒ—m
 
ÃwJ¬Fe
 = 
Ãw
 
	`J¬OuutSŒ—m
Òew 
	`FeOuutSŒ—m
(
‹mpDœ
 + 
Fe
.
£·¿tÜ
 + 
j¬FeName
),

166 
mªiã¡
);

168 
i
 = 0; i < 
j¬Fes
.
Ëngth
; i++) {

169 
IÅutSŒ—m
 
is
 = 
	`g‘CÏss
().
	`g‘ResourûAsSŒ—m
("/s™e/ycsb/db/vŞtdb/´ocs/" + 
j¬Fes
[
i
]);

170 
	`add
("s™e/ycsb/db/vŞtdb/´ocs/" + 
j¬Fes
[
i
], 
is
, 
ÃwJ¬Fe
);

173 
ÃwJ¬Fe
.
	`şo£
();

174 
Fe
 
fe
 = 
Ãw
 
	`Fe
(
‹mpDœ
 + Fe.
£·¿tÜ
 + 
j¬FeName
);

176 
by‹
[] 
j¬FeCÚ‹Ás
 = 
Ãw
 by‹[(è
fe
.
	`Ëngth
()];

177 
FeIÅutSŒ—m
 
fis
 = 
Ãw
 
	`FeIÅutSŒ—m
(
fe
);

178 
fis
.
	`»ad
(
j¬FeCÚ‹Ás
);

179 
fis
.
	`şo£
();

180 
logg”
.
	`šfo
("Calling @UpdateClasseso†oad JAR file containing…rocedures");

182 
ü
 = 
vŞtCl›Á
.
	`ÿÎProûdu»
("@Upd©eCÏs£s", 
j¬FeCÚ‹Ás
, 
nuÎ
);

183 ià(
ü
.
	`g‘Stus
(è!ğ
Cl›ÁRe¥Ú£
.
SUCCESS
) {

184 
throw
 
Ãw
 
	`Exû±iÚ
("A‰em±Øexecu‹ Upd©eCÏs£ çed:" + 
ü
.
	`g‘StusSŒšg
());

187 
i
 = 0; i < 
´ocS‹m’ts
.
Ëngth
; i++) {

188 
logg”
.
	`šfo
(
´ocS‹m’ts
[
i
]);

189 
ü
 = 
vŞtCl›Á
.
	`ÿÎProûdu»
("@AdHoc", 
´ocS‹m’ts
[
i
]);

190 ià(
ü
.
	`g‘Stus
(è!ğ
Cl›ÁRe¥Ú£
.
SUCCESS
) {

191 
throw
 
Ãw
 
	`Exû±iÚ
("A‰em±Øexecu‹ '" + 
´ocS‹m’ts
[
i
] + "' faed:" + 
ü
.
	`g‘StusSŒšg
());

195 
	}
}

205 
´iv©e
 
	$add
(
SŒšg
 
feName
, 
IÅutSŒ—m
 
sourû
, 
J¬OuutSŒ—m
 
rg‘
è
throws
 
IOExû±iÚ
 {

206 
Bufã»dIÅutSŒ—m
 
š
 = 
nuÎ
;

207 
Œy
 {

209 
J¬EÁry
 
’Œy
 = 
Ãw
 
	`J¬EÁry
(
feName
.
	`»¶aû
("\\", "/"));

210 
’Œy
.
	`£tTime
(
Sy¡em
.
	`cu¼’tTimeMlis
());

211 
rg‘
.
	`putNextEÁry
(
’Œy
);

212 
š
 = 
Ãw
 
	`Bufã»dIÅutSŒ—m
(
sourû
);

214 
by‹
[] 
bufãr
 = 
Ãw
 byte[1024];

215 
Œue
) {

216 
couÁ
 = 
š
.
	`»ad
(
bufãr
);

217 ià(
couÁ
 == -1) {

221 
rg‘
.
	`wr™e
(
bufãr
, 0, 
couÁ
);

223 
rg‘
.
	`şo£EÁry
();

224 } 
fš®ly
 {

225 ià(
š
 !ğ
nuÎ
) {

226 
š
.
	`şo£
();

230 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
;

	@voltdb/src/main/java/site/ycsb/db/voltdb/procs/ByteWrapper.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	g´ocs
;

23 şas 
	cBy‹W¿µ”
 {

24 
´iv©e
 
	mby‹
[] 
	mm¬r
;

25 
´iv©e
 
	mmoff
;

26 
´iv©e
 
	mmËn
;

28 
	$By‹W¿µ”
(
by‹
[] 
¬r
, 
off
, 
Ën
) {

29 
m¬r
 = 
¬r
;

30 
moff
 = 
off
;

31 
mËn
 = 
Ën
;

34 @
Ov”ride


35 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

36 ià(
this
 =ğ
obj
) {

37  
Œue
;

39 ià(!(
obj
 
š¡ªûof
 
By‹W¿µ”
)) {

40  
çl£
;

42 
By‹W¿µ”
 
th©
 = (By‹W¿µ”è
obj
;

43 ià(
this
.
mËn
 !ğ
th©
.mlen) {

44  
çl£
;

46 
i
 = 0; i < 
this
.
mËn
; i++) {

47 ià(
this
.
m¬r
[this.
moff
 + 
i
] !ğ
th©
.marr[that.moff + i]) {

48  
çl£
;

51  
Œue
;

52 
	}
}

54 @
Ov”ride


55 
public
 
	$hashCode
() {

56 ià(
this
.
m¬r
 =ğ
nuÎ
) {

60 
»s
 = 1;

61 
i
 = 0; i < 
mËn
; i++) {

62 
»s
 = 31 *„e + 
m¬r
[
moff
 + 
i
];

64  
»s
;

65 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/procs/Put.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	g´ocs
;

20 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

21 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

23 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gSQLStmt
;

24 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gVŞtProûdu»
;

25 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gVŞtTabË
;

32 
public
 cÏs 
	cPut
 
ex‹nds
 
	mVŞtProûdu»
 {

33 
´iv©e
 
fš®
 
SQLStmt
 
	m£ËùStmt
 = 
Ãw
 SQLStmt("SELECT value FROM Store WHERE keyspace = ? AND key = ?");

34 
´iv©e
 
fš®
 
SQLStmt
 
	mš£¹Stmt
 = 
Ãw
 SQLStmt("INSERT INTO Store VALUES (?, ?, ?)");

35 
´iv©e
 
fš®
 
SQLStmt
 
	mupd©eStmt
 = 
Ãw
 SQLStmt("UPDATE Store SET value = ? WHERE keyspace = ? AND key = ?");

37 
public
 
	$run
(
by‹
[] 
key¥aû
, 
SŒšg
 
key
, by‹[] 
d©a
) {

38 
	`vŞtQueueSQL
(
£ËùStmt
, 
key¥aû
, 
key
);

39 
VŞtTabË
 
»s
 = 
	`vŞtExecu‹SQL
()[0];

40 ià(
»s
.
	`advªûRow
()) {

41 
	`vŞtQueueSQL
(
upd©eStmt
, 
	`m”ge
(
»s
.
	`g‘V¬bš¬y
(0), 
d©a
), 
key¥aû
, 
key
);

43 
	`vŞtQueueSQL
(
š£¹Stmt
, 
key¥aû
, 
key
, 
d©a
);

45 
	`vŞtExecu‹SQL
(
Œue
);

49 
´iv©e
 
by‹
[] 
	$m”ge
(
by‹
[] 
de¡
, by‹[] 
¤c
) {

50 
HashS‘
<
By‹W¿µ”
> 
m”geS‘
 = 
Ãw
 HashSet<ByteWrapper>();

51 
By‹Bufãr
 
buf
 = By‹Bufãr.
	`w¿p
(
¤c
);

52 
nSrc
 = 
buf
.
	`g‘IÁ
();

53 
i
 = 0; i < 
nSrc
; i++) {

54 
Ën
 = 
buf
.
	`g‘IÁ
();

55 
off
 = 
buf
.
	`pos™iÚ
();

56 
m”geS‘
.
	`add
(
Ãw
 
	`By‹W¿µ”
(
¤c
, 
off
, 
Ën
));

57 
buf
.
	`pos™iÚ
(
off
 + 
Ën
);

58 
Ën
 = 
buf
.
	`g‘IÁ
();

59 
buf
.
	`pos™iÚ
(buf.pos™iÚ(è+ 
Ën
);

62 
by‹
[] 
m”ged
 = 
Ãw
 by‹[
¤c
.
Ëngth
 + 
de¡
.length];

63 
By‹Bufãr
 
out
 = By‹Bufãr.
	`w¿p
(
m”ged
);

65 
buf
 = 
By‹Bufãr
.
	`w¿p
(
de¡
);

66 
nDe¡
 = 
buf
.
	`g‘IÁ
();

67 
nF›lds
 = 
nSrc
 + 
nDe¡
;

68 
out
.
	`putIÁ
(
nF›lds
);

70 
blockS¹
 = 4;

71 
blockEnd
 = 4;

72 
i
 = 0; i < 
nDe¡
; i++) {

73 
Ën
 = 
buf
.
	`g‘IÁ
();

74 
off
 = 
buf
.
	`pos™iÚ
();

75 
boŞ—n
 
æushBlock
 = 
m”geS‘
.
	`cÚšs
(
Ãw
 
	`By‹W¿µ”
(
de¡
, 
off
, 
Ën
));

76 
buf
.
	`pos™iÚ
(
off
 + 
Ën
);

77 
Ën
 = 
buf
.
	`g‘IÁ
();

78 
buf
.
	`pos™iÚ
(buf.pos™iÚ(è+ 
Ën
);

79 ià(
æushBlock
) {

80 ià(
blockS¹
 < 
blockEnd
) {

81 
out
.
	`put
(
de¡
, 
blockS¹
, 
blockEnd
 - blockStart);

83 
nF›lds
--;

84 
blockS¹
 = 
buf
.
	`pos™iÚ
();

86 
blockEnd
 = 
buf
.
	`pos™iÚ
();

88 ià(
blockS¹
 < 
blockEnd
) {

89 
out
.
	`put
(
de¡
, 
blockS¹
, 
blockEnd
 - blockStart);

91 
out
.
	`put
(
¤c
, 4, src.
Ëngth
 - 4);

93 
Ëngth
 = 
out
.
	`pos™iÚ
();

94 ià(
nF›lds
 !ğ
nSrc
 + 
nDe¡
) {

95 
out
.
	`pos™iÚ
(0);

96 
out
.
	`putIÁ
(
nF›lds
);

99 
by‹
[] 
»s
 = 
Ãw
 by‹[
Ëngth
];

100 
Sy¡em
.
	`¬¿ycİy
(
m”ged
, 0, 
»s
, 0, 
Ëngth
);

101  
»s
;

102 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/procs/Scan.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	g´ocs
;

20 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gSQLStmt
;

21 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gVŞtProûdu»
;

22 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gVŞtTabË
;

29 
public
 cÏs 
	cSÿn
 
ex‹nds
 
	mVŞtProûdu»
 {

31 
´iv©e
 
fš®
 
SQLStmt
 
	mg‘BddStmt
 = 
Ãw
 SQLStmt(

33 
´iv©e
 
fš®
 
SQLStmt
 
	mg‘UnbddStmt
 = 
Ãw
 SQLStmt(

36 
public
 
	mVŞtTabË
[] 
	$run
(
SŒšg
 
·¹Key
, 
by‹
[] 
key¥aû
, by‹[] 
¿ngeMš
, 
couÁ
è
throws
 
Exû±iÚ
 {

37 ià(
¿ngeMš
 !ğ
nuÎ
) {

38 
	`vŞtQueueSQL
(
g‘BddStmt
, 
key¥aû
, 
Ãw
 
	`SŒšg
(
¿ngeMš
, "UTF-8"), 
couÁ
);

40 
	`vŞtQueueSQL
(
g‘UnbddStmt
, 
key¥aû
, 
couÁ
);

42  
	`vŞtExecu‹SQL
(
Œue
);

44 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/procs/ScanAll.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	g´ocs
;

20 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gSQLStmt
;

21 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gVŞtProûdu»
;

22 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gVŞtTabË
;

28 
public
 cÏs 
	cSÿnAÎ
 
ex‹nds
 
	mVŞtProûdu»
 {

30 
´iv©e
 
fš®
 
SQLStmt
 
	mg‘BddStmt
 = 
Ãw
 SQLStmt(

33 
´iv©e
 
fš®
 
SQLStmt
 
	mg‘UnbddStmt
 = 
Ãw
 SQLStmt(

36 
public
 
	mVŞtTabË
[] 
	$run
(
by‹
[] 
key¥aû
, by‹[] 
¿ngeMš
, 
couÁ
è
throws
 
Exû±iÚ
 {

37 ià(
¿ngeMš
 !ğ
nuÎ
) {

38 
	`vŞtQueueSQL
(
g‘BddStmt
, 
key¥aû
, 
Ãw
 
	`SŒšg
(
¿ngeMš
, "UTF-8"), 
couÁ
);

40 
	`vŞtQueueSQL
(
g‘UnbddStmt
, 
key¥aû
, 
couÁ
);

42  
	`vŞtExecu‹SQL
(
Œue
);

44 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/procs/package-info.java

24 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	g´ocs
;

	@voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/ClientResponseIsBadException.java

1 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	gsÜ‹dvŞ‰abË
;

22 @
Suµ»ssW¬nšgs
("serial")

23 
public
 cÏs 
	cCl›ÁRe¥Ú£IsBadExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

25 
public
 
	$Cl›ÁRe¥Ú£IsBadExû±iÚ
(
SŒšg
 
¡ršg
) {

26 
	`su³r
(
¡ršg
);

29 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/IncomingVoltTablesNeedToBeSortedException.java

1 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	gsÜ‹dvŞ‰abË
;

22 @
Suµ»ssW¬nšgs
("serial")

23 
public
 cÏs 
	cIncomšgVŞtTabËsN“dToBeSÜ‹dExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

25 
public
 
	$IncomšgVŞtTabËsN“dToBeSÜ‹dExû±iÚ
(
SŒšg
 
¡ršg
) {

26 
	`su³r
(
¡ršg
);

29 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/NeedsToBeComparableException.java

1 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	gsÜ‹dvŞ‰abË
;

22 @
Suµ»ssW¬nšgs
("serial")

23 
public
 cÏs 
	cN“dsToBeCom·¿bËExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

28 
public
 
	$N“dsToBeCom·¿bËExû±iÚ
(
SŒšg
 
¡ršg
) {

29 
	`su³r
(
¡ršg
);

32 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/VoltDBTableSortedMergeWrangler.java

1 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	gsÜ‹dvŞ‰abË
;

20 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gVŞtTabË
;

21 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gVŞtTy³
;

22 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›ÁRe¥Ú£
;

23 
impÜt
 
	gÜg
.
	gvŞtdb
.
	gş›Á
.
	gCl›ÁRe¥Ú£W™hP¬t™iÚKey
;

35 
public
 cÏs 
	cVŞtDBTabËSÜ‹dM”geW¿ngËr
 {

37 
´iv©e
 
	mCl›ÁRe¥Ú£W™hP¬t™iÚKey
[] 
	mtheTabËs
 = 
nuÎ
;

38 @
Suµ»ssW¬nšgs
("rawtypes")

39 
´iv©e
 
Com·¿bË
 
	mwh©WeS–eùedLa¡Time
 = 
nuÎ
;

41 
public
 
	$VŞtDBTabËSÜ‹dM”geW¿ngËr
(
Cl›ÁRe¥Ú£W™hP¬t™iÚKey
[] 
»¥Ú£
) {

42 
	`su³r
();

43 
this
.
theTabËs
 = 
»¥Ú£
;

58 
public
 
VŞtTabË
 
	$g‘SÜ‹dTabË
(
cŞumnid
, 
lim™
)

59 
throws
 
N“dsToBeCom·¿bËExû±iÚ
, 
IncomšgVŞtTabËsN“dToBeSÜ‹dExû±iÚ
, 
Cl›ÁRe¥Ú£IsBadExû±iÚ
 {

61 
wh©WeS–eùedLa¡Time
 = 
nuÎ
;

64 
VŞtTabË
 
ouutTabË
 = 
Ãw
 
	`VŞtTabË
(
theTabËs
[0].
»¥Ú£
.
	`g‘ResuÉs
()[0].
	`g‘TabËSchema
());

68 
i
 = 0; i < 
theTabËs
.
Ëngth
; i++) {

69 
VŞtTabË
 
cu¼’tTabË
 = 
theTabËs
[
i
].
»¥Ú£
.
	`g‘ResuÉs
()[0];

71 ià(
theTabËs
[
i
].
»¥Ú£
.
	`g‘Stus
(è!ğ
Cl›ÁRe¥Ú£
.
SUCCESS
) {

72 
throw
 
Ãw
 
	`Cl›ÁRe¥Ú£IsBadExû±iÚ
(
i
 + " " + 
theTabËs
[i].
»¥Ú£
.
	`g‘StusSŒšg
());

75 
cu¼’tTabË
.
	`»£tRowPos™iÚ
();

76 
cu¼’tTabË
.
	`advªûRow
();

81 
lowe¡Id
 = 
	`g‘Lowe¡Id
(
cŞumnid
);

84 
lowe¡Id
 > -1 && 
ouutTabË
.
	`g‘RowCouÁ
(è< 
lim™
) {

89 
VŞtTabË
 
lowe¡TabË
 = 
theTabËs
[
lowe¡Id
].
»¥Ú£
.
	`g‘ResuÉs
()[0];

90 
ouutTabË
.
	`add
(
lowe¡TabË
.
	`şÚeRow
());

91 
lowe¡TabË
.
	`advªûRow
();

94 
lowe¡Id
 = 
	`g‘Lowe¡Id
(
cŞumnid
);

97  
ouutTabË
;

98 
	}
}

111 @
Suµ»ssW¬nšgs
({ "rawtypes", "unchecked" })

112 
´iv©e
 
	$g‘Lowe¡Id
(
cŞumnid
è
throws
 
N“dsToBeCom·¿bËExû±iÚ
, 
IncomšgVŞtTabËsN“dToBeSÜ‹dExû±iÚ
 {

114 
lowe¡Id
 = -1;

115 
Com·¿bË
 
lowe¡Ob£rvedV®ue
 = 
nuÎ
;

117 
i
 = 0; i < 
theTabËs
.
Ëngth
; i++) {

119 
VŞtTabË
 
cu¼’tTabË
 = 
theTabËs
[
i
].
»¥Ú£
.
	`g‘ResuÉs
()[0];

121 
aùiveRowIndex
 = 
cu¼’tTabË
.
	`g‘AùiveRowIndex
();

122 
rowCouÁ
 = 
cu¼’tTabË
.
	`g‘RowCouÁ
();

124 ià(
aùiveRowIndex
 > -1 &&‡ùiveRowIndex < 
rowCouÁ
) {

126 ià(
lowe¡Ob£rvedV®ue
 =ğ
nuÎ
) {

128 
lowe¡Id
 = 
i
;

129 
lowe¡Ob£rvedV®ue
 = 
	`g‘Com·¿bË
(
cu¼’tTabË
, 
cŞumnid
);

132 
Com·¿bË
 
ÃwOb£rvedV®ue
 = 
	`g‘Com·¿bË
(
cu¼’tTabË
, 
cŞumnid
);

134 ià(
ÃwOb£rvedV®ue
.
	`com·»To
(
lowe¡Ob£rvedV®ue
) <= 0) {

135 
lowe¡Id
 = 
i
;

137 
lowe¡Ob£rvedV®ue
 = 
	`g‘Com·¿bË
(
cu¼’tTabË
, 
cŞumnid
);

146 ià(
lowe¡Id
 > -1) {

147 
Com·¿bË
 
Ï‹¡I‹mWeS–eùed
 = 
	`g‘Com·¿bË
(
theTabËs
[
lowe¡Id
].
»¥Ú£
.
	`g‘ResuÉs
()[0], 
cŞumnid
);

149 ià(
wh©WeS–eùedLa¡Time
 !ğ
nuÎ
 && 
Ï‹¡I‹mWeS–eùed
.
	`com·»To
(whatWeSelectedLastTime) < 0) {

150 
throw
 
Ãw
 
	`IncomšgVŞtTabËsN“dToBeSÜ‹dExû±iÚ
(

151 "L©e¡ I‹m '" + 
Ï‹¡I‹mWeS–eùed
 + "' i befÜÏ¡ i‹m '" + 
wh©WeS–eùedLa¡Time
 + "'");

154 
wh©WeS–eùedLa¡Time
 = 
Ï‹¡I‹mWeS–eùed
;

157  
lowe¡Id
;

159 
	}
}

169 @
Suµ»ssW¬nšgs
("rawtypes")

170 
´iv©e
 
Com·¿bË
 
	$g‘Com·¿bË
(
VŞtTabË
 
theTabË
, 
cŞumnId
è
throws
 
N“dsToBeCom·¿bËExû±iÚ
 {

171 
Com·¿bË
 
c
 = 
nuÎ
;

173 
VŞtTy³
 
vt
 = 
theTabË
.
	`g‘CŞumnTy³
(
cŞumnId
);

174 
Objeù
 
theV®ue
 = 
theTabË
.
	`g‘
(
cŞumnId
, 
vt
);

176 ià(
theV®ue
 
š¡ªûof
 
Com·¿bË
) {

177 
c
 = (
Com·¿bË
è
theV®ue
;

179 
throw
 
Ãw
 
	`N“dsToBeCom·¿bËExû±iÚ
(

180 
theV®ue
 + ": Only Comparables‡re supported by VoltDBTableSortedMergeWrangler");

183  
c
;

184 
	}
}

194 
´iv©e
 
	$com·»
(
by‹
[] 
Ëá
, by‹[] 
right
) {

195 
i
 = 0, 
j
 = 0; i < 
Ëá
.
Ëngth
 && j < 
right
.length; i++, j++) {

197 
a
 = (
Ëá
[
i
] & 0xff);

198 
b
 = (
right
[
j
] & 0xff);

199 ià(
a
 !ğ
b
) {

200  
a
 - 
b
;

203  
Ëá
.
Ëngth
 - 
right
.length;

204 
	}
}

	@voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/package-info.java

28 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	gsÜ‹dvŞ‰abË
;

	@voltdb/src/test/java/site/ycsb/db/voltdb/test/VoltDBClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	g‹¡
;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.*;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gAssume
.
	gassumeNoExû±iÚ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

25 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	gCÚÃùiÚH–³r
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	gVŞtCl›Á4
;

30 
impÜt
 
	gÜg
.
	gjun™
.*;

31 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

32 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

34 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gM­
;

36 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

37 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

38 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

39 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

40 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

47 
public
 cÏs 
	cVŞtDBCl›ÁTe¡
 {

49 
´iv©e
 
fš®
 
SŒšg
 
	mTABLE_NAME
 = "USERTABLE";

50 
´iv©e
 
fš®
 
	mFIELD_LENGTH
 = 32;

51 
´iv©e
 
fš®
 
SŒšg
 
	mFIELD_PREFIX
 = "FIELD";

52 
´iv©e
 
fš®
 
	mNUM_FIELDS
 = 3;

54 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_TEST_KEY
 = "InsertReadTest";

55 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_DELETE_AND_READ_TEST_KEY
 = "InsertDeleteReadTest";

56 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_TEST_KEY
 = "UpdateTest";

57 
´iv©e
 
fš®
 
SŒšg
 
	mNON_EXISTENT_KEY
 = "NonExistTest";

59 
´iv©e
 
fš®
 
SŒšg
 
	mSCAN_KEY_PREFIX
 = "ScanKey_";

60 
´iv©e
 
fš®
 
	mSCAN_RECORD_COUNT
 = 5000;

62 
´iv©e
 
fš®
 
	mSŒšg
[] 
	mTEST_DATA_KEYS
 = { 
INSERT_TEST_KEY
, 
INSERT_DELETE_AND_READ_TEST_KEY
, 
UPDATE_TEST_KEY
 };

64 
´iv©e
 
VŞtCl›Á4
 
	gvŞtCl›Á
 = 
nuÎ
;

65 
´iv©e
 
boŞ—n
 
	ghaveDb
 = 
çl£
;

67 @
BefÜeCÏss


68 
public
 
	$£tup
() {

70 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

72 
SŒšg
 
£rv”s
 = 
p
.
	`g‘Prİ”ty
("voltdb.servers", "localhost");

73 
SŒšg
 
u£r
 = 
p
.
	`g‘Prİ”ty
("voltdb.user", "");

74 
SŒšg
 
·sswÜd
 = 
p
.
	`g‘Prİ”ty
("voltdb.password", "");

75 
SŒšg
 
¡rLim™
 = 
p
.
	`g‘Prİ”ty
("voltdb.ratelimit", "70000");

77 
p
.
	`£tPrİ”ty
("vŞtdb.£rv”s", 
£rv”s
);

78 
p
.
	`£tPrİ”ty
("vŞtdb.u£r", 
u£r
);

79 
p
.
	`£tPrİ”ty
("vŞtdb.·sswÜd", 
·sswÜd
);

80 
p
.
	`£tPrİ”ty
("vŞtdb.¿‹lim™", 
¡rLim™
);

82 
Œy
 {

83 
vŞtCl›Á
 = 
Ãw
 
	`VŞtCl›Á4
();

84 
vŞtCl›Á
.
	`£tPrİ”t›s
(
p
);

86 ià(
CÚÃùiÚH–³r
.
	`checkDBS”v”s
(
£rv”s
)) {

87 
vŞtCl›Á
.
	`š™
();

88 
haveDb
 = 
Œue
;

89 
	`»moveExi¡šgD©a
();

92 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

97 
	`assumeNoExû±iÚ
("Som‘hšg wa ruÂšg oÀVŞtDB' pÜˆbuˆ™ wa¢'ˆ¨u§bË cİy oàVŞtDB", 
e
);

100 
	}
}

102 
´iv©e
 
	$»moveExi¡šgD©a
() {

104 
Œy
 {

105 
i
 = 0; i < 
TEST_DATA_KEYS
.
Ëngth
; i++) {

106 
vŞtCl›Á
.
	`d–‘e
(
TABLE_NAME
, 
TEST_DATA_KEYS
[
i
]);

109 
i
 = 0; i < 
SCAN_RECORD_COUNT
; i++) {

110 
vŞtCl›Á
.
	`d–‘e
(
TABLE_NAME
, 
SCAN_KEY_PREFIX
 + 
i
);

113 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

114 
Logg”
 
logg”
 = 
Logg”FaùÜy
.
	`g‘Logg”
(
VŞtDBCl›ÁTe¡
.
şass
);

115 
logg”
.
	`”rÜ
("E¼Ü whÿÎšg '»moveExi¡šgD©a()'", 
e
);

116 
	`ç
("Failed„emoveExistingData");

118 
	}
}

120 @
Aá”CÏss


121 
public
 
	$‹¬down
() {

123 
Œy
 {

124 ià(
vŞtCl›Á
 !ğ
nuÎ
 && 
haveDb
) {

125 
	`»moveExi¡šgD©a
();

126 
vŞtCl›Á
.
	`ş—nup
();

128 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

129 
e
.
	`´štSckT¿û
();

132 
	}
}

134 @
BefÜe


135 
public
 
	$´•¬eTe¡
() {

136 
	}
}

138 
´iv©e
 
boŞ—n
 
com·»CÚ‹Ás
(
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
šMsg
, 
M­
<SŒšg, By‹I‹¿tÜ> 
outMsg
) {

140 ià(
	gšMsg
 =ğ
nuÎ
) {

141  
çl£
;

144 ià(
	goutMsg
 =ğ
nuÎ
) {

145  
çl£
;

148 ià(
	gšMsg
.
size
(è!ğ
outMsg
.size()) {

149  
çl£
;

152 @
Suµ»ssW¬nšgs
("rawtypes")

153 
I‹¿tÜ
 
	g™
 = 
šMsg
.
’ŒyS‘
().
™”©Ü
();

154 
	g™
.
hasNext
()) {

155 @
Suµ»ssW¬nšgs
("rawtypes")

156 
	gM­
.
EÁry
 
	g·œ
 = (
M­
.EÁryè
™
.
Ãxt
();

157 
SŒšg
 
	gkey
 = (SŒšgè
·œ
.
g‘Key
();

158 
By‹I‹¿tÜ
 
	gšPaylßd
 = 
šMsg
.
g‘
(
key
);

159 
	gšPaylßd
.
»£t
();

160 
By‹I‹¿tÜ
 
	goutPaylßd
 = 
outMsg
.
g‘
(
key
);

161 
	goutPaylßd
.
»£t
();

163 ià(
	gšPaylßd
.
by‹sLeá
(è!ğ
outPaylßd
.bytesLeft()) {

164  
çl£
;

167 
	gšPaylßd
.
hasNext
()) {

168 
by‹
 
	gšBy‹
 = 
šPaylßd
.
ÃxtBy‹
();

169 
by‹
 
	goutBy‹
 = 
outPaylßd
.
ÃxtBy‹
();

170 ià(
	gšBy‹
 !ğ
outBy‹
) {

171  
çl£
;

175 
	g™
.
»move
();

178  
	gŒue
;

182 @
Te¡


183 
public
 
	$š£¹AndR—dTe¡
() {

185 
Assume
.
	`assumeTrue
(
haveDb
);

187 
Œy
 {

190 
fš®
 
SŒšg
 
š£¹Key
 = 
INSERT_TEST_KEY
;

191 
fš®
 
S‘
<
SŒšg
> 
cŞumns
 = 
	`g‘CŞumnNameM­
();

194 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
Ãw
 HashMap<String, ByteIterator>();

195 
i
 = 0; i < 
NUM_FIELDS
; i++) {

196 
š£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
š£¹Key
, FIELD_PREFIX + i)));

198 
vŞtCl›Á
.
	`š£¹
(
TABLE_NAME
, 
š£¹Key
, 
š£¹M­
);

201 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
‹¡ResuÉ
 = 
Ãw
 
HashM­
<String, ByteIterator>();

204 
Stus
 
s
 = 
vŞtCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
cŞumns
, 
‹¡ResuÉ
);

206 ià(!
s
.
	`equ®s
(
Stus
.
OK
)) {

207 
	`ç
("Didn't get OK on„ead.");

210 ià(!
	`com·»CÚ‹Ás
(
š£¹M­
, 
‹¡ResuÉ
)) {

211 
	`ç
("Returned data‚othe same‡s inserted data");

214 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

215 
e
.
	`´štSckT¿û
();

216 
	`ç
("Failed insertTest");

218 
	}
}

220 @
Te¡


221 
public
 
	$š£¹D–‘eAndR—dTe¡
() {

223 
Assume
.
	`assumeTrue
(
haveDb
);

225 
Œy
 {

228 
fš®
 
SŒšg
 
š£¹Key
 = 
INSERT_DELETE_AND_READ_TEST_KEY
;

229 
fš®
 
S‘
<
SŒšg
> 
cŞumns
 = 
	`g‘CŞumnNameM­
();

232 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
Ãw
 HashMap<String, ByteIterator>();

233 
i
 = 0; i < 
NUM_FIELDS
; i++) {

234 
š£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
š£¹Key
, FIELD_PREFIX + i)));

236 
vŞtCl›Á
.
	`š£¹
(
TABLE_NAME
, 
š£¹Key
, 
š£¹M­
);

239 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
‹¡ResuÉ
 = 
Ãw
 
HashM­
<String, ByteIterator>();

242 
Stus
 
s
 = 
vŞtCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
cŞumns
, 
‹¡ResuÉ
);

244 ià(!
s
.
	`equ®s
(
Stus
.
OK
)) {

245 
	`ç
("Didn't get OK on„ead.");

248 ià(!
	`com·»CÚ‹Ás
(
š£¹M­
, 
‹¡ResuÉ
)) {

249 
	`ç
("Returned data‚othe same‡s inserted data");

252 
vŞtCl›Á
.
	`d–‘e
(
TABLE_NAME
, 
š£¹Key
);

255 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
‹¡ResuÉAá”D–‘e
 = 
Ãw
 
HashM­
<String, ByteIterator>();

258 
vŞtCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
cŞumns
, 
‹¡ResuÉAá”D–‘e
);

260 ià(
‹¡ResuÉAá”D–‘e
.
	`size
() > 0) {

261 
	`ç
("testResultAfterDelete has value.");

264 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

265 
e
.
	`´štSckT¿û
();

266 
	`ç
("Failed insertDeleteAndReadTest");

268 
	}
}

270 @
Te¡


271 
public
 
	$d–‘eNÚExi¡’tRecÜdTe¡
() {

273 
Assume
.
	`assumeTrue
(
haveDb
);

275 
Œy
 {

278 
fš®
 
SŒšg
 
š£¹Key
 = 
NON_EXISTENT_KEY
;

279 
fš®
 
S‘
<
SŒšg
> 
cŞumns
 = 
	`g‘CŞumnNameM­
();

282 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
‹¡ResuÉ
 = 
Ãw
 
HashM­
<String, ByteIterator>();

285 
vŞtCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
cŞumns
, 
‹¡ResuÉ
);

287 ià(
‹¡ResuÉ
.
	`size
() > 0) {

288 
	`ç
("testResult.size() > 0.");

291 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

292 
e
.
	`´štSckT¿û
();

293 
	`ç
("Failed deleteNonExistentRecordTest");

295 
	}
}

297 @
Te¡


298 
public
 
	$sÿnR—dTe¡
() {

300 
Assume
.
	`assumeTrue
(
haveDb
);

302 
Œy
 {

304 
z
 = 0; z < 
SCAN_RECORD_COUNT
; z++) {

306 
fš®
 
SŒšg
 
š£¹Key
 = 
SCAN_KEY_PREFIX
 + 
z
;

309 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹M­
 = 
Ãw
 HashMap<String, ByteIterator>();

310 
i
 = 0; i < 
NUM_FIELDS
; i++) {

311 
š£¹M­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
("D©¨fÜ " + 
SCAN_KEY_PREFIX
 + 
z
 + "ƒlement " + i));

313 
vŞtCl›Á
.
	`š£¹
(
TABLE_NAME
, 
š£¹Key
, 
š£¹M­
);

316 
fš®
 
SŒšg
 
fœ¡In£¹Key
 = 
SCAN_KEY_PREFIX
 + 0;

317 
fš®
 
SŒšg
 
Ï¡In£¹Key
 = 
SCAN_KEY_PREFIX
 + (
SCAN_RECORD_COUNT
 - 1);

318 
fš®
 
SŒšg
 
beyÚdLa¡In£¹Key
 = 
SCAN_KEY_PREFIX
 + (
SCAN_RECORD_COUNT
 + 1);

319 
fš®
 
SŒšg
 
ÚeHund»dFromEndIn£¹Key
 = 
SCAN_KEY_PREFIX
 + (
SCAN_RECORD_COUNT
 - 101);

320 
fš®
 
SŒšg
 
fiáyFromEndIn£¹Key
 = 
SCAN_KEY_PREFIX
 + (
SCAN_RECORD_COUNT
 - 101);

323 
	`sšgËSÿnR—dTe¡
(
NON_EXISTENT_KEY
, 1000, 0, NON_EXISTENT_KEY);

326 
	`sšgËSÿnR—dTe¡
(
fœ¡In£¹Key
, 1, 1, firstInsertKey);

329 
	`sšgËSÿnR—dTe¡
(
fœ¡In£¹Key
, 
SCAN_RECORD_COUNT
, SCAN_RECORD_COUNT, 
Ï¡In£¹Key
);

332 
	`sšgËSÿnR—dTe¡
(
ÚeHund»dFromEndIn£¹Key
, 1, 1, oneHundredFromEndInsertKey);

335 
	`sšgËSÿnR—dTe¡
(
fiáyFromEndIn£¹Key
, 100, 50, 
Ï¡In£¹Key
);

338 
	`sšgËSÿnR—dTe¡
(
beyÚdLa¡In£¹Key
, 100, 0, 
Ï¡In£¹Key
);

340 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

341 
e
.
	`´štSckT¿û
();

342 
	`ç
("Failed scanReadTest");

345 
	}
}

347 
´iv©e
 
	$sšgËSÿnR—dTe¡
(
SŒšg
 
¡¬tKey
, 
»que¡edCouÁ
, 
ex³ùedCouÁ
, SŒšg 
Ï¡Key
) {

349 
Assume
.
	`assumeTrue
(
haveDb
);

351 
Œy
 {

353 
fš®
 
S‘
<
SŒšg
> 
cŞumns
 = 
	`g‘CŞumnNameM­
();

356 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
‹¡ResuÉ
 = 
Ãw
 Vector<HashMap<String, ByteIterator>>();

359 
Stus
 
s
 = 
vŞtCl›Á
.
	`sÿn
(
TABLE_NAME
, 
¡¬tKey
, 
ex³ùedCouÁ
, 
cŞumns
, 
‹¡ResuÉ
);

361 ià(!
s
.
	`equ®s
(
Stus
.
OK
)) {

362 
	`ç
("Didn't get OK on„ead.");

365 ià(
‹¡ResuÉ
.
	`size
(è!ğ
ex³ùedCouÁ
) {

366 
	`ç
("Faed sšgËSÿnR—dTe¡ " + 
¡¬tKey
 + " " + 
ex³ùedCouÁ
 + " " + 
Ï¡Key
);

369 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

370 
e
.
	`´štSckT¿û
();

371 
	`ç
("Faed sšgËSÿnR—dTe¡ " + 
¡¬tKey
 + ". Asked fÜ " + 
»que¡edCouÁ
 + ",ƒx³ùed " + 
ex³ùedCouÁ


372 + "†a¡key=" + 
Ï¡Key
);

374 
	}
}

376 @
Te¡


377 
public
 
	$upd©eTe¡
() {

379 
Assume
.
	`assumeTrue
(
haveDb
);

381 
Œy
 {

384 
fš®
 
SŒšg
 
š£¹Key
 = 
UPDATE_TEST_KEY
;

388 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
š£¹Th’Upd©eM­
 = 
Ãw
 HashMap<String, ByteIterator>();

389 
i
 = 0; i < 
NUM_FIELDS
; i++) {

390 
š£¹Th’Upd©eM­
.
	`put
(
FIELD_PREFIX
 + 
i
,

391 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
š£¹Key
, 
FIELD_PREFIX
 + 
i
)));

393 
vŞtCl›Á
.
	`š£¹
(
TABLE_NAME
, 
š£¹Key
, 
š£¹Th’Upd©eM­
);

396 
i
 = 0; i < 
NUM_FIELDS
; i++) {

397 
š£¹Th’Upd©eM­
.
	`put
(
FIELD_PREFIX
 + 
i
, 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(FIELD_PREFIX + i + " has changed"));

401 
vŞtCl›Á
.
	`upd©e
(
TABLE_NAME
, 
š£¹Key
, 
š£¹Th’Upd©eM­
);

404 
fš®
 
S‘
<
SŒšg
> 
cŞumns
 = 
	`g‘CŞumnNameM­
();

405 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
‹¡ResuÉ
 = 
Ãw
 
HashM­
<String, ByteIterator>();

408 
Stus
 
s
 = 
vŞtCl›Á
.
	`»ad
(
TABLE_NAME
, 
š£¹Key
, 
cŞumns
, 
‹¡ResuÉ
);

410 ià(!
s
.
	`equ®s
(
Stus
.
OK
)) {

411 
	`ç
("Didn't get OK on„ead.");

414 ià(!
	`com·»CÚ‹Ás
(
š£¹Th’Upd©eM­
, 
‹¡ResuÉ
)) {

415 
	`ç
("Returned data‚othe same‡s inserted data");

418 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

419 
e
.
	`´štSckT¿û
();

420 
	`ç
("Failed updateTest");

422 
	}
}

427 
´iv©e
 
	gS‘
<
	gSŒšg
> 
	$g‘CŞumnNameM­
() {

428 
S‘
<
SŒšg
> 
cŞumns
 = 
Ãw
 
HashS‘
<String>();

429 
i
 = 0; i < 
NUM_FIELDS
; i++) {

430 
cŞumns
.
	`add
(
FIELD_PREFIX
 + 
i
);

432  
cŞumns
;

433 
	}
}

440 
´iv©e
 
SŒšg
 
	$budD‘”mši¡icV®ue
(
SŒšg
 
key
, SŒšg 
f›ldkey
) {

441 
size
 = 
FIELD_LENGTH
;

442 
SŒšgBud”
 
sb
 = 
Ãw
 
	`SŒšgBud”
(
size
);

443 
sb
.
	`­³nd
(
key
);

444 
sb
.
	`­³nd
(':');

445 
sb
.
	`­³nd
(
f›ldkey
);

446 
sb
.
	`Ëngth
(è< 
size
) {

447 
sb
.
	`­³nd
(':');

448 
sb
.
	`­³nd
(sb.
	`toSŒšg
().
	`hashCode
());

450 
sb
.
	`£tL’gth
(
size
);

452  
sb
.
	`toSŒšg
();

453 
	}
}

	@voltdb/src/test/java/site/ycsb/db/voltdb/test/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gvŞtdb
.
	g‹¡
;

	@zookeeper/src/main/java/site/ycsb/db/zookeeper/ZKClient.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gzook“³r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gCh¬£t
;

26 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

28 
impÜt
 
	gjava
.
	gut
.
	gM­
;

29 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

30 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

31 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gzook“³r
.
	gC»©eMode
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	gzook“³r
.
	gK“³rExû±iÚ
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	gzook“³r
.
	gW©chedEv’t
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	gzook“³r
.
	gW©ch”
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	gzook“³r
.
	gZooDefs
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	gzook“³r
.
	gZooK“³r
;

40 
impÜt
 
	gÜg
.
	gjsÚ
.
	gsim¶e
.
	gJSONObjeù
;

41 
impÜt
 
	gÜg
.
	gjsÚ
.
	gsim¶e
.
	gJSONV®ue
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

45 
impÜt
 
	gs™e
.
	gycsb
.
	gDBExû±iÚ
;

46 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

47 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

48 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

49 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

56 
public
 cÏs 
	cZKCl›Á
 
ex‹nds
 
	mDB
 {

58 
´iv©e
 
ZooK“³r
 
	mzk
;

59 
´iv©e
 
W©ch”
 
	mw©ch”
;

61 
´iv©e
 
fš®
 
SŒšg
 
	mCONNECT_STRING
 = "zookeeper.connectString";

62 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_CONNECT_STRING
 = "127.0.0.1:2181";

63 
´iv©e
 
fš®
 
SŒšg
 
	mSESSION_TIMEOUT_PROPERTY
 = "zookeeper.sessionTimeout";

64 
´iv©e
 
fš®
 
	mDEFAULT_SESSION_TIMEOUT
 = 
TimeUn™
.
SECONDS
.
toMlis
(30L);

65 
´iv©e
 
fš®
 
SŒšg
 
	mWATCH_FLAG
 = "zookeeper.watchFlag";

67 
´iv©e
 
fš®
 
Ch¬£t
 
	mUTF_8
 = Ch¬£t.
fÜName
("UTF-8");

68 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = 
Logg”FaùÜy
.
g‘Logg”
(
ZKCl›Á
.
şass
);

70 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

71 
Prİ”t›s
 
´İs
 = 
	`g‘Prİ”t›s
();

73 
SŒšg
 
cÚÃùSŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
CONNECT_STRING
);

74 ià(
cÚÃùSŒšg
 =ğ
nuÎ
 || cÚÃùSŒšg.
	`Ëngth
() == 0) {

75 
cÚÃùSŒšg
 = 
DEFAULT_CONNECT_STRING
;

78 if(
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
(
WATCH_FLAG
))) {

79 
w©ch”
 = 
Ãw
 
	`Sim¶eW©ch”
();

81 
w©ch”
 = 
nuÎ
;

84 
£ssiÚTimeout
;

85 
SŒšg
 
£ssiÚTimeoutSŒšg
 = 
´İs
.
	`g‘Prİ”ty
(
SESSION_TIMEOUT_PROPERTY
);

86 ià(
£ssiÚTimeoutSŒšg
 !ğ
nuÎ
) {

87 
£ssiÚTimeout
 = 
IÁeg”
.
	`·r£IÁ
(
£ssiÚTimeoutSŒšg
);

89 
£ssiÚTimeout
 = 
DEFAULT_SESSION_TIMEOUT
;

92 
Œy
 {

93 
zk
 = 
Ãw
 
	`ZooK“³r
(
cÚÃùSŒšg
, (è
£ssiÚTimeout
,‚ew 
	`Sim¶eW©ch”
());

94 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

95 
throw
 
Ãw
 
	`DBExû±iÚ
("Creating connection failed.");

99 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

100 
Œy
 {

101 
zk
.
	`şo£
();

102 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

103 
throw
 
Ãw
 
	`DBExû±iÚ
("Closing connection failed.");

105 
	}
}

107 @
Ov”ride


108 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

109 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

110 
SŒšg
 
	g·th
 = 
g‘P©h
(
key
);

111 
	gŒy
 {

112 
	gby‹
[] 
	gd©a
 = 
zk
.
g‘D©a
(
·th
, 
w©ch”
, 
nuÎ
);

113 ià(
	gd©a
 =ğ
nuÎ
 || 
d©a
.
Ëngth
 == 0) {

114  
Stus
.
NOT_FOUND
;

117 
de£rŸlizeV®ues
(
d©a
, 
f›lds
, 
»suÉ
);

118  
	gStus
.
	gOK
;

119 } 
ÿtch
 (
K“³rExû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
e
) {

120 
	gLOG
.
”rÜ
("E¼Ü wh’„—dšg‡…©h:{},bËName:{}", 
·th
, 
bË
, 
e
);

121  
	gStus
.
	gERROR
;

125 @
Ov”ride


126 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

127 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

128 
SŒšg
 
	g·th
 = 
g‘P©h
(
key
);

129 
SŒšg
 
	gd©a
 = 
g‘JsÚSŒFromBy‹M­
(
v®ues
);

130 
	gŒy
 {

131 
	gzk
.
ü—‹
(
·th
, 
d©a
.
g‘By‹s
(
UTF_8
), 
ZooDefs
.
Ids
.
OPEN_ACL_UNSAFE
,

132 
C»©eMode
.
PERSISTENT
);

133  
	gStus
.
	gOK
;

134 } 
ÿtch
 (
K“³rExû±iÚ
.
NodeExi¡sExû±iÚ
 
e1
) {

135  
	gStus
.
	gOK
;

136 } 
ÿtch
 (
K“³rExû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
e2
) {

137 
	gLOG
.
”rÜ
("E¼Ü wh’ in£¹šg‡…©h:{},bËName:{}", 
·th
, 
bË
, 
e2
);

138  
	gStus
.
	gERROR
;

142 @
Ov”ride


143 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

145 
SŒšg
 
·th
 = 
	`g‘P©h
(
key
);

146 
Œy
 {

147 
zk
.
	`d–‘e
(
·th
, -1);

148  
Stus
.
OK
;

149 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 | 
K“³rExû±iÚ
 
e
) {

150 
LOG
.
	`”rÜ
("E¼Ü wh’ d–‘šg‡…©h:{},bËName:{}", 
·th
, 
bË
, 
e
);

151  
Stus
.
ERROR
;

153 
	}
}

155 @
Ov”ride


156 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

157 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

158 
SŒšg
 
	g·th
 = 
g‘P©h
(
key
);

159 
	gŒy
 {

162 
	gby‹
[] 
	gd©a
 = 
zk
.
g‘D©a
(
·th
, 
w©ch”
, 
nuÎ
);

163 ià(
	gd©a
 =ğ
nuÎ
 || 
d©a
.
Ëngth
 == 0) {

164  
Stus
.
NOT_FOUND
;

166 
fš®
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»suÉ
 = 
Ãw
 
HashM­
<>();

167 
de£rŸlizeV®ues
(
d©a
, 
nuÎ
, 
»suÉ
);

168 
	g»suÉ
.
putAÎ
(
v®ues
);

170 
	gzk
.
£tD©a
(
·th
, 
g‘JsÚSŒFromBy‹M­
(
»suÉ
).
g‘By‹s
(
UTF_8
), -1);

171  
	gStus
.
	gOK
;

172 } 
ÿtch
 (
K“³rExû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
e
) {

173 
	gLOG
.
”rÜ
("E¼Ü wh’ upd©šg‡…©h:{},bËName:{}", 
·th
, 
bË
, 
e
);

174  
	gStus
.
	gERROR
;

178 @
Ov”ride


179 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

180 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

181  
	gStus
.
	gNOT_IMPLEMENTED
;

184 
´iv©e
 
SŒšg
 
	$g‘P©h
(
SŒšg
 
key
) {

185  
key
.
	`¡¬tsW™h
("/") ? key : "/" + key;

186 
	}
}

191 
´iv©e
 
SŒšg
 
g‘JsÚSŒFromBy‹M­
(
M­
<SŒšg, 
By‹I‹¿tÜ
> 
m­
) {

192 
	gM­
<
	gSŒšg
, SŒšg> 
	g¡ršgM­
 = 
SŒšgBy‹I‹¿tÜ
.
g‘SŒšgM­
(
m­
);

193  
	gJSONV®ue
.
toJSONSŒšg
(
¡ršgM­
);

196 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
de£rŸlizeV®ues
(
fš®
 
by‹
[] 
d©a
, fš® 
S‘
<
SŒšg
> 
f›lds
,

197 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

198 
JSONObjeù
 
	gjsÚObjeù
 = (JSONObjeù)
JSONV®ue
.
·r£
(
Ãw
 
SŒšg
(
d©a
, 
UTF_8
));

199 
	gI‹¿tÜ
<
	gSŒšg
> 
	g™”©Ü
 = 
jsÚObjeù
.
keyS‘
().
™”©Ü
();

200 
	g™”©Ü
.
hasNext
()) {

201 
SŒšg
 
	gf›ld
 = 
™”©Ü
.
Ãxt
();

202 
SŒšg
 
	gv®ue
 = 
jsÚObjeù
.
g‘
(
f›ld
).
toSŒšg
();

203 if(
	gf›lds
 =ğ
nuÎ
 || 
f›lds
.
cÚšs
(
f›ld
)) {

204 
»suÉ
.
put
(
f›ld
, 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
v®ue
));

207  
	g»suÉ
;

210 
´iv©e
 şas 
	cSim¶eW©ch”
 
im¶em’ts
 
	gW©ch”
 {

212 
public
 
´oûss
(
W©chedEv’t
 
e
) {

213 ià(
	ge
.
g‘Ty³
(è=ğ
Ev’t
.
Ev’tTy³
.
NÚe
) {

217 ià(
	ge
.
g‘S‹
(è=ğ
Ev’t
.
K“³rS‹
.
SyncCÚÃùed
) {

	@zookeeper/src/main/java/site/ycsb/db/zookeeper/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gzook“³r
;

	@zookeeper/src/test/java/site/ycsb/db/zookeeper/ZKClientTest.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gdb
.
	gzook“³r
;

20 
impÜt
 
	gÜg
.
	g­ache
.
	gcu¿tÜ
.
	g‹¡
.
	gTe¡šgS”v”
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gIgnÜe
;

26 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

27 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

28 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

29 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

30 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

33 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

34 
impÜt
 
	gjava
.
	gut
.
	gM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

37 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gTe¡Ca£
.
	gas£¹Equ®s
;

38 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
.
	gTABLENAME_PROPERTY_DEFAULT
;

45 
public
 cÏs 
	cZKCl›ÁTe¡
 {

47 
´iv©e
 
Te¡šgS”v”
 
	mzkTe¡S”v”
;

48 
´iv©e
 
ZKCl›Á
 
	mş›Á
;

49 
´iv©e
 
SŒšg
 
	mbËName
;

50 
´iv©e
 
fš®
 
SŒšg
 
	m·th
 = "benchmark";

51 
´iv©e
 
fš®
 
	mPORT
 = 2181;

53 @
BefÜeCÏss


54 
public
 
	$£tUpCÏss
(è
throws
 
Exû±iÚ
 {

55 
zkTe¡S”v”
 = 
Ãw
 
	`Te¡šgS”v”
(
PORT
);

56 
zkTe¡S”v”
.
	`¡¬t
();

59 @
Aá”CÏss


60 
public
 
	$‹¬DownCÏss
(è
throws
 
Exû±iÚ
 {

61 
zkTe¡S”v”
.
	`¡İ
();

62 
	}
}

64 @
BefÜe


65 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

66 
ş›Á
 = 
Ãw
 
	`ZKCl›Á
();

68 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

69 
p
.
	`£tPrİ”ty
("zook“³r.cÚÃùSŒšg", "127.0.0.1:" + 
SŒšg
.
	`v®ueOf
(
PORT
));

71 
M—su»m’ts
.
	`£tPrİ”t›s
(
p
);

72 
fš®
 
CÜeWÜklßd
 
wÜklßd
 = 
Ãw
 
	`CÜeWÜklßd
();

73 
wÜklßd
.
	`š™
(
p
);

75 
bËName
 = 
p
.
	`g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

77 
ş›Á
.
	`£tPrİ”t›s
(
p
);

78 
ş›Á
.
	`š™
();

79 
	}
}

81 @
Aá”


82 
public
 
	$‹¬Down
(è
throws
 
Exû±iÚ
 {

83 
ş›Á
.
	`ş—nup
();

84 
	}
}

86 @
Te¡


87 
public
 
	$‹¡ZKCl›Á
() {

89 
M­
<
SŒšg
, SŒšg> 
m
 = 
Ãw
 
HashM­
<>();

90 
SŒšg
 
f›ld1
 = "field_1";

91 
SŒšg
 
v®ue1
 = "value_1";

92 
m
.
	`put
(
f›ld1
, 
v®ue1
);

93 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
m
);

94 
ş›Á
.
	`š£¹
(
bËName
, 
·th
, 
»suÉ
);

97 
»suÉ
.
	`ş—r
();

98 
Stus
 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, 
·th
, 
nuÎ
, 
»suÉ
);

99 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

100 
	`as£¹Equ®s
(1, 
»suÉ
.
	`size
());

101 
	`as£¹Equ®s
(
v®ue1
, 
»suÉ
.
	`g‘
(
f›ld1
).
	`toSŒšg
());

104 
m
.
	`ş—r
();

105 
»suÉ
.
	`ş—r
();

106 
SŒšg
 
ÃwV®
 = "value_new";

107 
m
.
	`put
(
f›ld1
, 
ÃwV®
);

108 
»suÉ
 = 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
m
);

109 
ş›Á
.
	`upd©e
(
bËName
, 
·th
, 
»suÉ
);

110 
	`as£¹Equ®s
(1, 
»suÉ
.
	`size
());

113 
»suÉ
.
	`ş—r
();

114 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, 
·th
, 
nuÎ
, 
»suÉ
);

115 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

117 
	`as£¹Equ®s
(1, 
»suÉ
.
	`size
());

118 
	`as£¹Equ®s
(
ÃwV®
, 
»suÉ
.
	`g‘
(
f›ld1
).
	`toSŒšg
());

121 
m
.
	`ş—r
();

122 
»suÉ
.
	`ş—r
();

123 
SŒšg
 
f›ld2
 = "field_2";

124 
SŒšg
 
v®ue2
 = "value_2";

125 
m
.
	`put
(
f›ld2
, 
v®ue2
);

126 
»suÉ
 = 
SŒšgBy‹I‹¿tÜ
.
	`g‘By‹I‹¿tÜM­
(
m
);

127 
ş›Á
.
	`upd©e
(
bËName
, 
·th
, 
»suÉ
);

128 
	`as£¹Equ®s
(1, 
»suÉ
.
	`size
());

131 
»suÉ
.
	`ş—r
();

132 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, 
·th
, 
nuÎ
, 
»suÉ
);

133 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

135 
	`as£¹Equ®s
(2, 
»suÉ
.
	`size
());

136 
	`as£¹Equ®s
(
v®ue2
, 
»suÉ
.
	`g‘
(
f›ld2
).
	`toSŒšg
());

137 
	`as£¹Equ®s
(
ÃwV®
, 
»suÉ
.
	`g‘
(
f›ld1
).
	`toSŒšg
());

140 
¡©us
 = 
ş›Á
.
	`d–‘e
(
bËName
, 
·th
);

141 
	`as£¹Equ®s
(
Stus
.
OK
, 
¡©us
);

144 
»suÉ
.
	`ş—r
();

145 
¡©us
 = 
ş›Á
.
	`»ad
(
bËName
, 
·th
, 
nuÎ
, 
»suÉ
);

147 
	`as£¹Equ®s
(
Stus
.
ERROR
, 
¡©us
);

148 
	`as£¹Equ®s
(0, 
»suÉ
.
	`size
());

149 
	}
}

151 @
	gTe¡


152 @
IgnÜe
("Not yet implemented")

153 
public
 
	$‹¡Sÿn
() {

154 
	`ç
("Not yet implemented");

155 
	}
}

	@
1
.
1
/usr/include
231
14277
accumulo1.9/src/main/java/site/ycsb/db/accumulo/AccumuloClient.java
accumulo1.9/src/main/java/site/ycsb/db/accumulo/package-info.java
accumulo1.9/src/test/java/site/ycsb/db/accumulo/AccumuloTest.java
aerospike/src/main/java/site/ycsb/db/AerospikeClient.java
aerospike/src/main/java/site/ycsb/db/package-info.java
arangodb/src/main/java/site/ycsb/db/arangodb/ArangoDBClient.java
arangodb/src/main/java/site/ycsb/db/arangodb/package-info.java
asynchbase/src/main/java/site/ycsb/db/AsyncHBaseClient.java
asynchbase/src/main/java/site/ycsb/db/package-info.java
asynchbase/src/test/java/site/ycsb/db/AsyncHBaseTest.java
azurecosmos/src/main/java/site/ycsb/db/AzureCosmosClient.java
azurecosmos/src/main/java/site/ycsb/db/package-info.java
azuretablestorage/src/main/java/site/ycsb/db/azuretablestorage/AzureClient.java
azuretablestorage/src/main/java/site/ycsb/db/azuretablestorage/package-info.java
cassandra/src/main/java/site/ycsb/db/CassandraCQLClient.java
cassandra/src/main/java/site/ycsb/db/package-info.java
cassandra/src/test/java/site/ycsb/db/CassandraCQLClientTest.java
cloudspanner/src/main/java/site/ycsb/db/cloudspanner/CloudSpannerClient.java
cloudspanner/src/main/java/site/ycsb/db/cloudspanner/package-info.java
core/src/main/java/site/ycsb/BasicDB.java
core/src/main/java/site/ycsb/BasicTSDB.java
core/src/main/java/site/ycsb/ByteArrayByteIterator.java
core/src/main/java/site/ycsb/ByteIterator.java
core/src/main/java/site/ycsb/Client.java
core/src/main/java/site/ycsb/ClientThread.java
core/src/main/java/site/ycsb/CommandLine.java
core/src/main/java/site/ycsb/DB.java
core/src/main/java/site/ycsb/DBException.java
core/src/main/java/site/ycsb/DBFactory.java
core/src/main/java/site/ycsb/DBWrapper.java
core/src/main/java/site/ycsb/GoodBadUglyDB.java
core/src/main/java/site/ycsb/InputStreamByteIterator.java
core/src/main/java/site/ycsb/NumericByteIterator.java
core/src/main/java/site/ycsb/RandomByteIterator.java
core/src/main/java/site/ycsb/Status.java
core/src/main/java/site/ycsb/StatusThread.java
core/src/main/java/site/ycsb/StringByteIterator.java
core/src/main/java/site/ycsb/TerminatorThread.java
core/src/main/java/site/ycsb/TimeseriesDB.java
core/src/main/java/site/ycsb/UnknownDBException.java
core/src/main/java/site/ycsb/Utils.java
core/src/main/java/site/ycsb/Workload.java
core/src/main/java/site/ycsb/WorkloadException.java
core/src/main/java/site/ycsb/generator/AcknowledgedCounterGenerator.java
core/src/main/java/site/ycsb/generator/ConstantIntegerGenerator.java
core/src/main/java/site/ycsb/generator/CounterGenerator.java
core/src/main/java/site/ycsb/generator/DiscreteGenerator.java
core/src/main/java/site/ycsb/generator/ExponentialGenerator.java
core/src/main/java/site/ycsb/generator/FileGenerator.java
core/src/main/java/site/ycsb/generator/Generator.java
core/src/main/java/site/ycsb/generator/HistogramGenerator.java
core/src/main/java/site/ycsb/generator/HotspotIntegerGenerator.java
core/src/main/java/site/ycsb/generator/IncrementingPrintableStringGenerator.java
core/src/main/java/site/ycsb/generator/NumberGenerator.java
core/src/main/java/site/ycsb/generator/RandomDiscreteTimestampGenerator.java
core/src/main/java/site/ycsb/generator/ScrambledZipfianGenerator.java
core/src/main/java/site/ycsb/generator/SequentialGenerator.java
core/src/main/java/site/ycsb/generator/SkewedLatestGenerator.java
core/src/main/java/site/ycsb/generator/UniformGenerator.java
core/src/main/java/site/ycsb/generator/UniformLongGenerator.java
core/src/main/java/site/ycsb/generator/UnixEpochTimestampGenerator.java
core/src/main/java/site/ycsb/generator/ZipfianGenerator.java
core/src/main/java/site/ycsb/generator/package-info.java
core/src/main/java/site/ycsb/measurements/Measurements.java
core/src/main/java/site/ycsb/measurements/OneMeasurement.java
core/src/main/java/site/ycsb/measurements/OneMeasurementHdrHistogram.java
core/src/main/java/site/ycsb/measurements/OneMeasurementHistogram.java
core/src/main/java/site/ycsb/measurements/OneMeasurementRaw.java
core/src/main/java/site/ycsb/measurements/OneMeasurementTimeSeries.java
core/src/main/java/site/ycsb/measurements/TwoInOneMeasurement.java
core/src/main/java/site/ycsb/measurements/exporter/JSONArrayMeasurementsExporter.java
core/src/main/java/site/ycsb/measurements/exporter/JSONMeasurementsExporter.java
core/src/main/java/site/ycsb/measurements/exporter/MeasurementsExporter.java
core/src/main/java/site/ycsb/measurements/exporter/TextMeasurementsExporter.java
core/src/main/java/site/ycsb/measurements/exporter/package-info.java
core/src/main/java/site/ycsb/measurements/package-info.java
core/src/main/java/site/ycsb/package-info.java
core/src/main/java/site/ycsb/workloads/ConstantOccupancyWorkload.java
core/src/main/java/site/ycsb/workloads/CoreWorkload.java
core/src/main/java/site/ycsb/workloads/RestWorkload.java
core/src/main/java/site/ycsb/workloads/TimeSeriesWorkload.java
core/src/main/java/site/ycsb/workloads/package-info.java
core/src/test/java/site/ycsb/TestByteIterator.java
core/src/test/java/site/ycsb/TestNumericByteIterator.java
core/src/test/java/site/ycsb/TestStatus.java
core/src/test/java/site/ycsb/TestUtils.java
core/src/test/java/site/ycsb/generator/AcknowledgedCounterGeneratorTest.java
core/src/test/java/site/ycsb/generator/TestIncrementingPrintableStringGenerator.java
core/src/test/java/site/ycsb/generator/TestRandomDiscreteTimestampGenerator.java
core/src/test/java/site/ycsb/generator/TestUnixEpochTimestampGenerator.java
core/src/test/java/site/ycsb/generator/TestZipfianGenerator.java
core/src/test/java/site/ycsb/measurements/exporter/TestMeasurementsExporter.java
core/src/test/java/site/ycsb/workloads/TestCoreWorkload.java
core/src/test/java/site/ycsb/workloads/TestTimeSeriesWorkload.java
couchbase/src/main/java/site/ycsb/db/CouchbaseClient.java
couchbase/src/main/java/site/ycsb/db/package-info.java
couchbase2/src/main/java/site/ycsb/db/couchbase2/Couchbase2Client.java
couchbase2/src/main/java/site/ycsb/db/couchbase2/package-info.java
crail/src/main/java/site/ycsb/db/crail/CrailClient.java
crail/src/main/java/site/ycsb/db/crail/package-info.java
dynamodb/src/main/java/site/ycsb/db/DynamoDBClient.java
dynamodb/src/main/java/site/ycsb/db/package-info.java
elasticsearch/src/main/java/site/ycsb/db/ElasticsearchClient.java
elasticsearch/src/main/java/site/ycsb/db/package-info.java
elasticsearch/src/test/java/site/ycsb/db/ElasticsearchClientTest.java
elasticsearch5/src/main/java/site/ycsb/db/elasticsearch5/Elasticsearch5.java
elasticsearch5/src/main/java/site/ycsb/db/elasticsearch5/ElasticsearchClient.java
elasticsearch5/src/main/java/site/ycsb/db/elasticsearch5/ElasticsearchRestClient.java
elasticsearch5/src/main/java/site/ycsb/db/elasticsearch5/package-info.java
elasticsearch5/src/test/java/site/ycsb/db/elasticsearch5/ElasticsearchClientIT.java
elasticsearch5/src/test/java/site/ycsb/db/elasticsearch5/ElasticsearchIntegTestBase.java
elasticsearch5/src/test/java/site/ycsb/db/elasticsearch5/ElasticsearchRestClientIT.java
foundationdb/src/main/java/site/ycsb/db/foundationdb/FoundationDBClient.java
foundationdb/src/main/java/site/ycsb/db/foundationdb/package-info.java
geode/src/main/java/site/ycsb/db/GeodeClient.java
geode/src/main/java/site/ycsb/db/package-info.java
googlebigtable/src/main/java/site/ycsb/db/GoogleBigtableClient.java
googlebigtable/src/main/java/site/ycsb/db/package-info.java
googledatastore/src/main/java/site/ycsb/db/GoogleDatastoreClient.java
googledatastore/src/main/java/site/ycsb/db/package-info.java
griddb/src/main/java/site/ycsb/db/griddb/GridDBClient.java
griddb/src/main/java/site/ycsb/db/griddb/package-info.java
griddb/src/test/java/site/ycsb/db/griddb/GridDBClientTest.java
hbase1/src/main/java/site/ycsb/db/hbase1/HBaseClient1.java
hbase1/src/main/java/site/ycsb/db/hbase1/package-info.java
hbase1/src/test/java/site/ycsb/db/hbase1/HBaseClient1Test.java
hbase2/src/main/java/site/ycsb/db/hbase2/HBaseClient2.java
hbase2/src/main/java/site/ycsb/db/hbase2/package-info.java
hbase2/src/test/java/site/ycsb/db/hbase2/HBaseClient2Test.java
ignite/src/main/java/site/ycsb/db/ignite/IgniteAbstractClient.java
ignite/src/main/java/site/ycsb/db/ignite/IgniteClient.java
ignite/src/main/java/site/ycsb/db/ignite/IgniteSqlClient.java
ignite/src/main/java/site/ycsb/db/ignite/package-info.java
ignite/src/test/java/site/ycsb/db/ignite/IgniteClientTest.java
ignite/src/test/java/site/ycsb/db/ignite/IgniteClientTestBase.java
ignite/src/test/java/site/ycsb/db/ignite/IgniteSqlClientTest.java
infinispan/src/main/java/site/ycsb/db/InfinispanClient.java
infinispan/src/main/java/site/ycsb/db/InfinispanRemoteClient.java
infinispan/src/main/java/site/ycsb/db/RemoteCacheManagerHolder.java
infinispan/src/main/java/site/ycsb/db/package-info.java
jdbc/src/main/java/site/ycsb/db/JdbcDBCli.java
jdbc/src/main/java/site/ycsb/db/JdbcDBClient.java
jdbc/src/main/java/site/ycsb/db/JdbcDBCreateTable.java
jdbc/src/main/java/site/ycsb/db/StatementType.java
jdbc/src/main/java/site/ycsb/db/flavors/DBFlavor.java
jdbc/src/main/java/site/ycsb/db/flavors/DefaultDBFlavor.java
jdbc/src/main/java/site/ycsb/db/flavors/PhoenixDBFlavor.java
jdbc/src/main/java/site/ycsb/db/flavors/package-info.java
jdbc/src/main/java/site/ycsb/db/package-info.java
jdbc/src/test/java/site/ycsb/db/JdbcDBClientTest.java
kudu/src/main/java/site/ycsb/db/KuduYCSBClient.java
kudu/src/main/java/site/ycsb/db/package-info.java
maprdb/src/main/java/site/ycsb/db/mapr/MapRDBClient.java
maprdb/src/main/java/site/ycsb/db/mapr/package-info.java
maprjsondb/src/main/java/site/ycsb/db/mapr/MapRJSONDBClient.java
maprjsondb/src/main/java/site/ycsb/db/mapr/ValueByteIterator.java
maprjsondb/src/main/java/site/ycsb/db/mapr/package-info.java
memcached/src/main/java/site/ycsb/db/MemcachedClient.java
memcached/src/main/java/site/ycsb/db/package-info.java
mongodb/src/main/java/site/ycsb/db/AsyncMongoDbClient.java
mongodb/src/main/java/site/ycsb/db/MongoDbClient.java
mongodb/src/main/java/site/ycsb/db/OptionsSupport.java
mongodb/src/main/java/site/ycsb/db/package-info.java
mongodb/src/test/java/site/ycsb/db/AbstractDBTestCases.java
mongodb/src/test/java/site/ycsb/db/AsyncMongoDbClientTest.java
mongodb/src/test/java/site/ycsb/db/MongoDbClientTest.java
mongodb/src/test/java/site/ycsb/db/OptionsSupportTest.java
nosqldb/src/main/java/site/ycsb/db/NoSqlDbClient.java
nosqldb/src/main/java/site/ycsb/db/package-info.java
orientdb/src/main/java/site/ycsb/db/OrientDBClient.java
orientdb/src/main/java/site/ycsb/db/package-info.java
orientdb/src/test/java/site/ycsb/db/OrientDBClientTest.java
postgrenosql/src/main/java/site/ycsb/postgrenosql/PostgreNoSQLDBClient.java
postgrenosql/src/main/java/site/ycsb/postgrenosql/StatementType.java
postgrenosql/src/main/java/site/ycsb/postgrenosql/package-info.java
postgrenosql/src/test/java/site/ycsb/postgrenosql/PostgreNoSQLDBClientTest.java
rados/src/main/java/site/ycsb/db/RadosClient.java
rados/src/main/java/site/ycsb/db/package-info.java
rados/src/test/java/site/ycsb/db/RadosClientTest.java
redis/src/main/java/site/ycsb/db/RedisClient.java
redis/src/main/java/site/ycsb/db/package-info.java
rest/src/main/java/site/ycsb/webservice/rest/RestClient.java
rest/src/main/java/site/ycsb/webservice/rest/package-info.java
rest/src/test/java/site/ycsb/webservice/rest/IntegrationTest.java
rest/src/test/java/site/ycsb/webservice/rest/ResourceLoader.java
rest/src/test/java/site/ycsb/webservice/rest/RestClientTest.java
rest/src/test/java/site/ycsb/webservice/rest/RestTestResource.java
rest/src/test/java/site/ycsb/webservice/rest/Utils.java
riak/src/main/java/site/ycsb/db/riak/RiakKVClient.java
riak/src/main/java/site/ycsb/db/riak/RiakUtils.java
riak/src/main/java/site/ycsb/db/riak/package-info.java
riak/src/test/java/site/ycsb/db/riak/RiakKVClientTest.java
rocksdb/src/main/java/site/ycsb/db/rocksdb/RocksDBClient.java
rocksdb/src/main/java/site/ycsb/db/rocksdb/package-info.java
rocksdb/src/test/java/site/ycsb/db/rocksdb/RocksDBClientTest.java
rocksdb/src/test/java/site/ycsb/db/rocksdb/RocksDBOptionsFileTest.java
s3/src/main/java/site/ycsb/db/S3Client.java
s3/src/main/java/site/ycsb/db/package-info.java
scylla/src/main/java/site/ycsb/db/scylla/ScyllaCQLClient.java
scylla/src/main/java/site/ycsb/db/scylla/package-info.java
scylla/src/test/java/site/ycsb/db/scylla/ScyllaCQLClientTest.java
seaweedfs/src/main/java/site/ycsb/db/seaweed/SeaweedClient.java
seaweedfs/src/main/java/site/ycsb/db/seaweed/package-info.java
solr7/src/main/java/site/ycsb/db/solr7/SolrClient.java
solr7/src/main/java/site/ycsb/db/solr7/package-info.java
solr7/src/test/java/site/ycsb/db/solr7/SolrClientBaseTest.java
solr7/src/test/java/site/ycsb/db/solr7/SolrClientCloudTest.java
solr7/src/test/java/site/ycsb/db/solr7/SolrClientTest.java
tablestore/src/main/java/site/ycsb/db/tablestore/TableStoreClient.java
tablestore/src/main/java/site/ycsb/db/tablestore/package-info.java
tarantool/src/main/java/site/ycsb/db/TarantoolClient.java
tarantool/src/main/java/site/ycsb/db/package-info.java
voltdb/src/main/java/site/ycsb/db/voltdb/ConnectionHelper.java
voltdb/src/main/java/site/ycsb/db/voltdb/VoltClient4.java
voltdb/src/main/java/site/ycsb/db/voltdb/YCSBSchemaBuilder.java
voltdb/src/main/java/site/ycsb/db/voltdb/package-info.java
voltdb/src/main/java/site/ycsb/db/voltdb/procs/ByteWrapper.java
voltdb/src/main/java/site/ycsb/db/voltdb/procs/Put.java
voltdb/src/main/java/site/ycsb/db/voltdb/procs/Scan.java
voltdb/src/main/java/site/ycsb/db/voltdb/procs/ScanAll.java
voltdb/src/main/java/site/ycsb/db/voltdb/procs/package-info.java
voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/ClientResponseIsBadException.java
voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/IncomingVoltTablesNeedToBeSortedException.java
voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/NeedsToBeComparableException.java
voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/VoltDBTableSortedMergeWrangler.java
voltdb/src/main/java/site/ycsb/db/voltdb/sortedvolttable/package-info.java
voltdb/src/test/java/site/ycsb/db/voltdb/test/VoltDBClientTest.java
voltdb/src/test/java/site/ycsb/db/voltdb/test/package-info.java
zookeeper/src/main/java/site/ycsb/db/zookeeper/ZKClient.java
zookeeper/src/main/java/site/ycsb/db/zookeeper/package-info.java
zookeeper/src/test/java/site/ycsb/db/zookeeper/ZKClientTest.java
