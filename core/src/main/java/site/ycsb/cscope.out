cscope 15 $HOME/lee/YCSB/core/src/main/java/site/ycsb               0000469666
	@BasicDB.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.*;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

30 
public
 cÏs 
	cBasicDB
 
ex‹nds
 
	mDB
 {

31 
public
 
fš®
 
SŒšg
 
	mCOUNT
 = "basicdb.count";

32 
public
 
fš®
 
SŒšg
 
	mCOUNT_DEFAULT
 = "false";

34 
public
 
fš®
 
SŒšg
 
	mVERBOSE
 = "basicdb.verbose";

35 
public
 
fš®
 
SŒšg
 
	mVERBOSE_DEFAULT
 = "true";

37 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY
 = "basicdb.simulatedelay";

38 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY_DEFAULT
 = "0";

40 
public
 
fš®
 
SŒšg
 
	mRANDOMIZE_DELAY
 = "basicdb.randomizedelay";

41 
public
 
fš®
 
SŒšg
 
	mRANDOMIZE_DELAY_DEFAULT
 = "true";

43 
´Ùeùed
 
fš®
 
Objeù
 
	mMUTEX
 = 
Ãw
 Object();

44 
´Ùeùed
 
	mcouÁ”
 = 0;

45 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	m»ads
;

46 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	msÿns
;

47 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mupd©es
;

48 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mš£¹s
;

49 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	md–‘es
;

51 
´Ùeùed
 
boŞ—n
 
	mv”bo£
;

52 
´Ùeùed
 
boŞ—n
 
	m¿ndomized–ay
;

53 
´Ùeùed
 
	mtod–ay
;

54 
´Ùeùed
 
boŞ—n
 
	mcouÁ
;

56 
public
 
	$BasicDB
() {

57 
tod–ay
 = 0;

60 
´Ùeùed
 
	$d–ay
() {

61 ià(
tod–ay
 > 0) {

62 
d–ayNs
;

63 ià(
¿ndomized–ay
) {

64 
d–ayNs
 = 
TimeUn™
.
MILLISECONDS
.
	`toNªos
(
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
(
tod–ay
));

65 ià(
d–ayNs
 == 0) {

69 
d–ayNs
 = 
TimeUn™
.
MILLISECONDS
.
	`toNªos
(
tod–ay
);

72 
fš®
 
d—dlše
 = 
Sy¡em
.
	`ÇnoTime
(è+ 
d–ayNs
;

74 
LockSuµÜt
.
	`·rkNªos
(
d—dlše
 - 
Sy¡em
.
	`ÇnoTime
());

75 } 
Sy¡em
.
	`ÇnoTime
(è< 
d—dlše
 && !
Th»ad
.
	`š‹¼u±ed
());

77 
	}
}

83 
public
 
	$š™
() {

84 
v”bo£
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
VERBOSE
, 
VERBOSE_DEFAULT
));

85 
tod–ay
 = 
IÁeg”
.
	`·r£IÁ
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
SIMULATE_DELAY
, 
SIMULATE_DELAY_DEFAULT
));

86 
¿ndomized–ay
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
RANDOMIZE_DELAY
, 
RANDOMIZE_DELAY_DEFAULT
));

87 
couÁ
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
COUNT
, 
COUNT_DEFAULT
));

88 ià(
v”bo£
) {

89 
	`synchrÚized
 (
Sy¡em
.
out
) {

90 
Sy¡em
.
out
.
	`´šn
("*****************…roperties *****************");

91 
Prİ”t›s
 
p
 = 
	`g‘Prİ”t›s
();

92 ià(
p
 !ğ
nuÎ
) {

93 
Enum”©iÚ
 
e
 = 
p
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

94 
SŒšg
 
k
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

95 
Sy¡em
.
out
.
	`´šn
("\"" + 
k
 + "\"=\"" + 
p
.
	`g‘Prİ”ty
(k) + "\"");

98 
Sy¡em
.
out
.
	`´šn
("**********************************************");

102 
	`synchrÚized
 (
MUTEX
) {

103 ià(
couÁ”
 =ğ0 && 
couÁ
) {

104 
»ads
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

105 
sÿns
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

106 
upd©es
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

107 
š£¹s
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

108 
d–‘es
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

110 
couÁ”
++;

112 
	}
}

114 
´Ùeùed
 
fš®
 
	gTh»adLoÿl
<
	gSŒšgBud”
> 
	gTL_STRING_BUILDER
 = 
Ãw
 
Th»adLoÿl
<
SŒšgBud”
>() {

115 @
Ov”ride


116 
´Ùeùed
 
SŒšgBud”
 
š™ŸlV®ue
() {

117  
Ãw
 
SŒšgBud”
();

121 
´Ùeùed
 
SŒšgBud”
 
	$g‘SŒšgBud”
() {

122 
SŒšgBud”
 
sb
 = 
TL_STRING_BUILDER
.
	`g‘
();

123 
sb
.
	`£tL’gth
(0);

124  
sb
;

125 
	}
}

136 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

137 
d–ay
();

139 ià(
	gv”bo£
) {

140 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

141 
	gsb
.
­³nd
("READ ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

142 ià(
	gf›lds
 !ğ
nuÎ
) {

143 
SŒšg
 
f
 : 
f›lds
) {

144 
sb
.
­³nd
(
f
).append(" ");

147 
	gsb
.
­³nd
("<all fields>");

150 
	gsb
.
­³nd
("]");

151 
	gSy¡em
.
	gout
.
´šn
(
sb
);

154 ià(
	gcouÁ
) {

155 
šcCouÁ”
(
»ads
, 
hash
(
bË
, 
key
, 
f›lds
));

158  
	gStus
.
	gOK
;

172 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

173 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

174 
d–ay
();

176 ià(
	gv”bo£
) {

177 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

178 
	gsb
.
­³nd
("SCAN ").­³nd(
bË
).­³nd(" ").­³nd(
¡¬tkey
).­³nd(" ").­³nd(
»cÜdcouÁ
).append(" [ ");

179 ià(
	gf›lds
 !ğ
nuÎ
) {

180 
SŒšg
 
f
 : 
f›lds
) {

181 
sb
.
­³nd
(
f
).append(" ");

184 
	gsb
.
­³nd
("<all fields>");

187 
	gsb
.
­³nd
("]");

188 
	gSy¡em
.
	gout
.
´šn
(
sb
);

191 ià(
	gcouÁ
) {

192 
šcCouÁ”
(
sÿns
, 
hash
(
bË
, 
¡¬tkey
, 
f›lds
));

195  
	gStus
.
	gOK
;

207 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

208 
d–ay
();

210 ià(
	gv”bo£
) {

211 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

212 
	gsb
.
­³nd
("UPDATE ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

213 ià(
	gv®ues
 !ğ
nuÎ
) {

214 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’Œy
 : 
v®ues
.
’ŒyS‘
()) {

215 
sb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

218 
	gsb
.
­³nd
("]");

219 
	gSy¡em
.
	gout
.
´šn
(
sb
);

222 ià(
	gcouÁ
) {

223 
šcCouÁ”
(
upd©es
, 
hash
(
bË
, 
key
, 
v®ues
));

226  
	gStus
.
	gOK
;

238 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

239 
d–ay
();

241 ià(
	gv”bo£
) {

242 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

243 
	gsb
.
­³nd
("INSERT ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

244 ià(
	gv®ues
 !ğ
nuÎ
) {

245 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’Œy
 : 
v®ues
.
’ŒyS‘
()) {

246 
sb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

250 
	gsb
.
­³nd
("]");

251 
	gSy¡em
.
	gout
.
´šn
(
sb
);

254 ià(
	gcouÁ
) {

255 
šcCouÁ”
(
š£¹s
, 
hash
(
bË
, 
key
, 
v®ues
));

258  
	gStus
.
	gOK
;

269 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

270 
	`d–ay
();

272 ià(
v”bo£
) {

273 
SŒšgBud”
 
sb
 = 
	`g‘SŒšgBud”
();

274 
sb
.
	`­³nd
("DELETE ").­³nd(
bË
).­³nd(" ").­³nd(
key
);

275 
Sy¡em
.
out
.
	`´šn
(
sb
);

278 ià(
couÁ
) {

279 
	`šcCouÁ”
(
d–‘es
, (
bË
 + 
key
).
	`hashCode
());

282  
Stus
.
OK
;

283 
	}
}

285 @
Ov”ride


286 
public
 
	$ş—nup
() {

287 
	`synchrÚized
 (
MUTEX
) {

288 
couÁDown
 = --
couÁ”
;

289 ià(
couÁ
 && 
couÁDown
 < 1) {

292 
Sy¡em
.
out
.
	`´šn
("[READS], Uniques, " + 
»ads
.
	`size
());

293 
Sy¡em
.
out
.
	`´šn
("[SCANS], Uniques, " + 
sÿns
.
	`size
());

294 
Sy¡em
.
out
.
	`´šn
("[UPDATES], Uniques, " + 
upd©es
.
	`size
());

295 
Sy¡em
.
out
.
	`´šn
("[INSERTS], Uniques, " + 
š£¹s
.
	`size
());

296 
Sy¡em
.
out
.
	`´šn
("[DELETES], Uniques, " + 
d–‘es
.
	`size
());

299 
	}
}

306 
´Ùeùed
 
šcCouÁ”
(
fš®
 
M­
<
IÁeg”
, IÁeg”> 
m­
, fš® 
hash
) {

307 
synchrÚized
 (
m­
) {

308 
IÁeg”
 
	gùr
 = 
m­
.
g‘
(
hash
);

309 ià(
	gùr
 =ğ
nuÎ
) {

310 
m­
.
put
(
hash
, 1);

312 
	gm­
.
put
(
hash
, 
ùr
 + 1);

327 
´Ùeùed
 
hash
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
S‘
<SŒšg> 
f›lds
) {

328 ià(
	gf›lds
 =ğ
nuÎ
) {

329  (
bË
 + 
key
).
hashCode
();

331 
SŒšgBud”
 
	gbuf
 = 
g‘SŒšgBud”
().
­³nd
(
bË
).­³nd(
key
);

332 
	gLi¡
<
	gSŒšg
> 
	gsÜ‹d
 = 
Ãw
 
A¼ayLi¡
<
SŒšg
>(
f›lds
);

333 
	gCŞËùiÚs
.
sÜt
(
sÜ‹d
);

334 
fš®
 
SŒšg
 
	gf›ld
 : 
sÜ‹d
) {

335 
buf
.
­³nd
(
f›ld
);

337  
	gbuf
.
toSŒšg
().
hashCode
();

350 
´Ùeùed
 
hash
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

351 ià(
	gv®ues
 =ğ
nuÎ
) {

352  (
bË
 + 
key
).
hashCode
();

354 
fš®
 
	gT»eM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gsÜ‹d
 =

355 
Ãw
 
T»eM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>(
	gv®ues
);

357 
SŒšgBud”
 
	gbuf
 = 
g‘SŒšgBud”
().
­³nd
(
bË
).­³nd(
key
);

358 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
sÜ‹d
.
’ŒyS‘
()) {

359 
’Œy
.
g‘V®ue
().
»£t
();

360 
	gbuf
.
­³nd
(
’Œy
.
g‘Key
())

361 .
­³nd
(
’Œy
.
g‘V®ue
().
toSŒšg
());

363  
	gbuf
.
toSŒšg
().
hashCode
();

	@BasicDB.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.*;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

30 
public
 cÏs 
	cBasicDB
 
ex‹nds
 
	mDB
 {

31 
public
 
fš®
 
SŒšg
 
	mCOUNT
 = "basicdb.count";

32 
public
 
fš®
 
SŒšg
 
	mCOUNT_DEFAULT
 = "false";

34 
public
 
fš®
 
SŒšg
 
	mVERBOSE
 = "basicdb.verbose";

35 
public
 
fš®
 
SŒšg
 
	mVERBOSE_DEFAULT
 = "true";

37 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY
 = "basicdb.simulatedelay";

38 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY_DEFAULT
 = "0";

40 
public
 
fš®
 
SŒšg
 
	mRANDOMIZE_DELAY
 = "basicdb.randomizedelay";

41 
public
 
fš®
 
SŒšg
 
	mRANDOMIZE_DELAY_DEFAULT
 = "true";

43 
´Ùeùed
 
fš®
 
Objeù
 
	mMUTEX
 = 
Ãw
 Object();

44 
´Ùeùed
 
	mcouÁ”
 = 0;

45 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	m»ads
;

46 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	msÿns
;

47 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mupd©es
;

48 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mš£¹s
;

49 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	md–‘es
;

51 
´Ùeùed
 
boŞ—n
 
	mv”bo£
;

52 
´Ùeùed
 
boŞ—n
 
	m¿ndomized–ay
;

53 
´Ùeùed
 
	mtod–ay
;

54 
´Ùeùed
 
boŞ—n
 
	mcouÁ
;

56 
public
 
	$BasicDB
() {

57 
tod–ay
 = 0;

60 
´Ùeùed
 
	$d–ay
() {

61 ià(
tod–ay
 > 0) {

62 
d–ayNs
;

63 ià(
¿ndomized–ay
) {

64 
d–ayNs
 = 
TimeUn™
.
MILLISECONDS
.
	`toNªos
(
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
(
tod–ay
));

65 ià(
d–ayNs
 == 0) {

69 
d–ayNs
 = 
TimeUn™
.
MILLISECONDS
.
	`toNªos
(
tod–ay
);

72 
fš®
 
d—dlše
 = 
Sy¡em
.
	`ÇnoTime
(è+ 
d–ayNs
;

74 
LockSuµÜt
.
	`·rkNªos
(
d—dlše
 - 
Sy¡em
.
	`ÇnoTime
());

75 } 
Sy¡em
.
	`ÇnoTime
(è< 
d—dlše
 && !
Th»ad
.
	`š‹¼u±ed
());

77 
	}
}

83 
public
 
	$š™
() {

84 
v”bo£
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
VERBOSE
, 
VERBOSE_DEFAULT
));

85 
tod–ay
 = 
IÁeg”
.
	`·r£IÁ
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
SIMULATE_DELAY
, 
SIMULATE_DELAY_DEFAULT
));

86 
¿ndomized–ay
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
RANDOMIZE_DELAY
, 
RANDOMIZE_DELAY_DEFAULT
));

87 
couÁ
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
COUNT
, 
COUNT_DEFAULT
));

88 ià(
v”bo£
) {

89 
	`synchrÚized
 (
Sy¡em
.
out
) {

90 
Sy¡em
.
out
.
	`´šn
("*****************…roperties *****************");

91 
Prİ”t›s
 
p
 = 
	`g‘Prİ”t›s
();

92 ià(
p
 !ğ
nuÎ
) {

93 
Enum”©iÚ
 
e
 = 
p
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

94 
SŒšg
 
k
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

95 
Sy¡em
.
out
.
	`´šn
("\"" + 
k
 + "\"=\"" + 
p
.
	`g‘Prİ”ty
(k) + "\"");

98 
Sy¡em
.
out
.
	`´šn
("**********************************************");

102 
	`synchrÚized
 (
MUTEX
) {

103 ià(
couÁ”
 =ğ0 && 
couÁ
) {

104 
»ads
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

105 
sÿns
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

106 
upd©es
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

107 
š£¹s
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

108 
d–‘es
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

110 
couÁ”
++;

112 
	}
}

114 
´Ùeùed
 
fš®
 
	gTh»adLoÿl
<
	gSŒšgBud”
> 
	gTL_STRING_BUILDER
 = 
Ãw
 
Th»adLoÿl
<
SŒšgBud”
>() {

115 @
Ov”ride


116 
´Ùeùed
 
SŒšgBud”
 
š™ŸlV®ue
() {

117  
Ãw
 
SŒšgBud”
();

121 
´Ùeùed
 
SŒšgBud”
 
	$g‘SŒšgBud”
() {

122 
SŒšgBud”
 
sb
 = 
TL_STRING_BUILDER
.
	`g‘
();

123 
sb
.
	`£tL’gth
(0);

124  
sb
;

125 
	}
}

136 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

137 
d–ay
();

139 ià(
	gv”bo£
) {

140 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

141 
	gsb
.
­³nd
("READ ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

142 ià(
	gf›lds
 !ğ
nuÎ
) {

143 
SŒšg
 
f
 : 
f›lds
) {

144 
sb
.
­³nd
(
f
).append(" ");

147 
	gsb
.
­³nd
("<all fields>");

150 
	gsb
.
­³nd
("]");

151 
	gSy¡em
.
	gout
.
´šn
(
sb
);

154 ià(
	gcouÁ
) {

155 
šcCouÁ”
(
»ads
, 
hash
(
bË
, 
key
, 
f›lds
));

158  
	gStus
.
	gOK
;

172 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

173 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

174 
d–ay
();

176 ià(
	gv”bo£
) {

177 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

178 
	gsb
.
­³nd
("SCAN ").­³nd(
bË
).­³nd(" ").­³nd(
¡¬tkey
).­³nd(" ").­³nd(
»cÜdcouÁ
).append(" [ ");

179 ià(
	gf›lds
 !ğ
nuÎ
) {

180 
SŒšg
 
f
 : 
f›lds
) {

181 
sb
.
­³nd
(
f
).append(" ");

184 
	gsb
.
­³nd
("<all fields>");

187 
	gsb
.
­³nd
("]");

188 
	gSy¡em
.
	gout
.
´šn
(
sb
);

191 ià(
	gcouÁ
) {

192 
šcCouÁ”
(
sÿns
, 
hash
(
bË
, 
¡¬tkey
, 
f›lds
));

195  
	gStus
.
	gOK
;

207 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

208 
d–ay
();

210 ià(
	gv”bo£
) {

211 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

212 
	gsb
.
­³nd
("UPDATE ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

213 ià(
	gv®ues
 !ğ
nuÎ
) {

214 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’Œy
 : 
v®ues
.
’ŒyS‘
()) {

215 
sb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

218 
	gsb
.
­³nd
("]");

219 
	gSy¡em
.
	gout
.
´šn
(
sb
);

222 ià(
	gcouÁ
) {

223 
šcCouÁ”
(
upd©es
, 
hash
(
bË
, 
key
, 
v®ues
));

226  
	gStus
.
	gOK
;

238 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

239 
d–ay
();

241 ià(
	gv”bo£
) {

242 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

243 
	gsb
.
­³nd
("INSERT ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

244 ià(
	gv®ues
 !ğ
nuÎ
) {

245 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’Œy
 : 
v®ues
.
’ŒyS‘
()) {

246 
sb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

250 
	gsb
.
­³nd
("]");

251 
	gSy¡em
.
	gout
.
´šn
(
sb
);

254 ià(
	gcouÁ
) {

255 
šcCouÁ”
(
š£¹s
, 
hash
(
bË
, 
key
, 
v®ues
));

258  
	gStus
.
	gOK
;

269 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

270 
	`d–ay
();

272 ià(
v”bo£
) {

273 
SŒšgBud”
 
sb
 = 
	`g‘SŒšgBud”
();

274 
sb
.
	`­³nd
("DELETE ").­³nd(
bË
).­³nd(" ").­³nd(
key
);

275 
Sy¡em
.
out
.
	`´šn
(
sb
);

278 ià(
couÁ
) {

279 
	`šcCouÁ”
(
d–‘es
, (
bË
 + 
key
).
	`hashCode
());

282  
Stus
.
OK
;

283 
	}
}

285 @
Ov”ride


286 
public
 
	$ş—nup
() {

287 
	`synchrÚized
 (
MUTEX
) {

288 
couÁDown
 = --
couÁ”
;

289 ià(
couÁ
 && 
couÁDown
 < 1) {

292 
Sy¡em
.
out
.
	`´šn
("[READS], Uniques, " + 
»ads
.
	`size
());

293 
Sy¡em
.
out
.
	`´šn
("[SCANS], Uniques, " + 
sÿns
.
	`size
());

294 
Sy¡em
.
out
.
	`´šn
("[UPDATES], Uniques, " + 
upd©es
.
	`size
());

295 
Sy¡em
.
out
.
	`´šn
("[INSERTS], Uniques, " + 
š£¹s
.
	`size
());

296 
Sy¡em
.
out
.
	`´šn
("[DELETES], Uniques, " + 
d–‘es
.
	`size
());

299 
	}
}

306 
´Ùeùed
 
šcCouÁ”
(
fš®
 
M­
<
IÁeg”
, IÁeg”> 
m­
, fš® 
hash
) {

307 
synchrÚized
 (
m­
) {

308 
IÁeg”
 
	gùr
 = 
m­
.
g‘
(
hash
);

309 ià(
	gùr
 =ğ
nuÎ
) {

310 
m­
.
put
(
hash
, 1);

312 
	gm­
.
put
(
hash
, 
ùr
 + 1);

327 
´Ùeùed
 
hash
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
S‘
<SŒšg> 
f›lds
) {

328 ià(
	gf›lds
 =ğ
nuÎ
) {

329  (
bË
 + 
key
).
hashCode
();

331 
SŒšgBud”
 
	gbuf
 = 
g‘SŒšgBud”
().
­³nd
(
bË
).­³nd(
key
);

332 
	gLi¡
<
	gSŒšg
> 
	gsÜ‹d
 = 
Ãw
 
A¼ayLi¡
<
SŒšg
>(
f›lds
);

333 
	gCŞËùiÚs
.
sÜt
(
sÜ‹d
);

334 
fš®
 
SŒšg
 
	gf›ld
 : 
sÜ‹d
) {

335 
buf
.
­³nd
(
f›ld
);

337  
	gbuf
.
toSŒšg
().
hashCode
();

350 
´Ùeùed
 
hash
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

351 ià(
	gv®ues
 =ğ
nuÎ
) {

352  (
bË
 + 
key
).
hashCode
();

354 
fš®
 
	gT»eM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gsÜ‹d
 =

355 
Ãw
 
T»eM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>(
	gv®ues
);

357 
SŒšgBud”
 
	gbuf
 = 
g‘SŒšgBud”
().
­³nd
(
bË
).­³nd(
key
);

358 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
sÜ‹d
.
’ŒyS‘
()) {

359 
’Œy
.
g‘V®ue
().
»£t
();

360 
	gbuf
.
­³nd
(
’Œy
.
g‘Key
())

361 .
­³nd
(
’Œy
.
g‘V®ue
().
toSŒšg
());

363  
	gbuf
.
toSŒšg
().
hashCode
();

	@BasicTSDB.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gT»eM­
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gTimeS”›sWÜklßd
;

32 
public
 cÏs 
	cBasicTSDB
 
ex‹nds
 
	mBasicDB
 {

35 
´Ùeùed
 
	mM­
<
	mLÚg
, 
	mIÁeg”
> 
	mtime¡amps
;

36 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mæßts
;

37 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mš‹g”s
;

39 
´iv©e
 
SŒšg
 
	mtime¡ampKey
;

40 
´iv©e
 
SŒšg
 
	mv®ueKey
;

41 
´iv©e
 
SŒšg
 
	mgPaœD–im™”
;

42 
´iv©e
 
SŒšg
 
	mqu”yTimeS·nD–im™”
;

43 
´iv©e
 
	mÏ¡Time¡amp
;

45 @
Ov”ride


46 
public
 
	$š™
() {

47 
su³r
.
	`š™
();

49 
	`synchrÚized
 (
MUTEX
) {

50 ià(
time¡amps
 =ğ
nuÎ
) {

51 
time¡amps
 = 
Ãw
 
HashM­
<
LÚg
, 
IÁeg”
>();

52 
æßts
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

53 
š‹g”s
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

57 
time¡ampKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

58 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY
,

59 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
);

60 
v®ueKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

61 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY
,

62 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
);

63 
gPaœD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

64 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY
,

65 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY_DEFAULT
);

66 
qu”yTimeS·nD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

67 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY
,

68 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
);

71 
public
 
Stus
 
	`»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

72 
	`d–ay
();

74 ià(
v”bo£
) {

75 
SŒšgBud”
 
sb
 = 
	`g‘SŒšgBud”
();

76 
sb
.
	`­³nd
("READ ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

77 ià(
f›lds
 !ğ
nuÎ
) {

78 
SŒšg
 
f
 : 
f›lds
) {

79 
sb
.
	`­³nd
(
f
).append(" ");

82 
sb
.
	`­³nd
("<all fields>");

85 
sb
.
	`­³nd
("]");

86 
Sy¡em
.
out
.
	`´šn
(
sb
);

89 ià(
couÁ
) {

90 
S‘
<
SŒšg
> 
f‹»d
 = 
nuÎ
;

91 ià(
f›lds
 !ğ
nuÎ
) {

92 
f‹»d
 = 
Ãw
 
HashS‘
<
SŒšg
>();

93 
fš®
 
SŒšg
 
f›ld
 : 
f›lds
) {

94 ià(
f›ld
.
	`¡¬tsW™h
(
time¡ampKey
)) {

95 
SŒšg
[] 
·¹s
 = 
f›ld
.
	`¥l™
(
gPaœD–im™”
);

96 ià(
·¹s
[1].
	`cÚšs
(
qu”yTimeS·nD–im™”
)) {

97 
·¹s
 =…¬ts[1].
	`¥l™
(
qu”yTimeS·nD–im™”
);

98 
Ï¡Time¡amp
 = 
LÚg
.
	`·r£LÚg
(
·¹s
[0]);

100 
Ï¡Time¡amp
 = 
LÚg
.
	`·r£LÚg
(
·¹s
[1]);

102 
	`synchrÚized
(
time¡amps
) {

103 
IÁeg”
 
ùr
 = 
time¡amps
.
	`g‘
(
Ï¡Time¡amp
);

104 ià(
ùr
 =ğ
nuÎ
) {

105 
time¡amps
.
	`put
(
Ï¡Time¡amp
, 1);

107 
time¡amps
.
	`put
(
Ï¡Time¡amp
, 
ùr
 + 1);

111 
f‹»d
.
	`add
(
f›ld
);

115 
	`šcCouÁ”
(
»ads
, 
	`hash
(
bË
, 
key
, 
f‹»d
));

117  
Stus
.
OK
;

118 
	}
}

120 @
Ov”ride


121 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

122 
d–ay
();

124 
boŞ—n
 
	gisFlßt
 = 
çl£
;

126 ià(
	gv”bo£
) {

127 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

128 
	gsb
.
­³nd
("UPDATE ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

129 ià(
	gv®ues
 !ğ
nuÎ
) {

130 
fš®
 
T»eM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
Œ“
 = 
Ãw
 T»eM­<SŒšg, 
	gBy‹I‹¿tÜ
>(
	gv®ues
);

131 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
Œ“
.
’ŒyS‘
()) {

132 ià(
’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

133 
sb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

134 .
­³nd
(
Uts
.
by‹sToLÚg
(
’Œy
.
g‘V®ue
().
toA¼ay
())).append(" ");

135 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

136 
fš®
 
Num”icBy‹I‹¿tÜ
 
	g™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

137 
	gisFlßt
 = 
™
.
isFlßtšgPošt
();

138 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

139 .
­³nd
(
isFlßt
 ? 
™
.
g‘DoubË
(è: it.
g‘LÚg
()).append(" ");

141 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

145 
	gsb
.
­³nd
("]");

146 
	gSy¡em
.
	gout
.
´šn
(
sb
);

149 ià(
	gcouÁ
) {

150 ià(!
	gv”bo£
) {

151 
	gisFlßt
 = ((
Num”icBy‹I‹¿tÜ
è
v®ues
.
g‘
(
v®ueKey
)).
isFlßtšgPošt
();

153 
	ghash
 = 
hash
(
bË
, 
key
, 
v®ues
);

154 
šcCouÁ”
(
upd©es
, 
hash
);

155 
synchrÚized
(
time¡amps
) {

156 
IÁeg”
 
	gùr
 = 
time¡amps
.
g‘
(
Ï¡Time¡amp
);

157 ià(
	gùr
 =ğ
nuÎ
) {

158 
time¡amps
.
put
(
Ï¡Time¡amp
, 1);

160 
	gtime¡amps
.
put
(
Ï¡Time¡amp
, 
ùr
 + 1);

163 ià(
	gisFlßt
) {

164 
šcCouÁ”
(
æßts
, 
hash
);

166 
šcCouÁ”
(
š‹g”s
, 
hash
);

170  
	gStus
.
	gOK
;

173 @
Ov”ride


174 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

175 
d–ay
();

177 
boŞ—n
 
	gisFlßt
 = 
çl£
;

179 ià(
	gv”bo£
) {

180 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

181 
	gsb
.
­³nd
("INSERT ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

182 ià(
	gv®ues
 !ğ
nuÎ
) {

183 
fš®
 
T»eM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
Œ“
 = 
Ãw
 T»eM­<SŒšg, 
	gBy‹I‹¿tÜ
>(
	gv®ues
);

184 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
Œ“
.
’ŒyS‘
()) {

185 ià(
’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

186 
sb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

187 .
­³nd
(
Uts
.
by‹sToLÚg
(
’Œy
.
g‘V®ue
().
toA¼ay
())).append(" ");

188 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

189 
fš®
 
Num”icBy‹I‹¿tÜ
 
	g™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

190 
	gisFlßt
 = 
™
.
isFlßtšgPošt
();

191 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

192 .
­³nd
(
isFlßt
 ? 
™
.
g‘DoubË
(è: it.
g‘LÚg
()).append(" ");

194 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

198 
	gsb
.
­³nd
("]");

199 
	gSy¡em
.
	gout
.
´šn
(
sb
);

202 ià(
	gcouÁ
) {

203 ià(!
	gv”bo£
) {

204 
	gisFlßt
 = ((
Num”icBy‹I‹¿tÜ
è
v®ues
.
g‘
(
v®ueKey
)).
isFlßtšgPošt
();

206 
	ghash
 = 
hash
(
bË
, 
key
, 
v®ues
);

207 
šcCouÁ”
(
š£¹s
, 
hash
);

208 
synchrÚized
(
time¡amps
) {

209 
IÁeg”
 
	gùr
 = 
time¡amps
.
g‘
(
Ï¡Time¡amp
);

210 ià(
	gùr
 =ğ
nuÎ
) {

211 
time¡amps
.
put
(
Ï¡Time¡amp
, 1);

213 
	gtime¡amps
.
put
(
Ï¡Time¡amp
, 
ùr
 + 1);

216 ià(
	gisFlßt
) {

217 
šcCouÁ”
(
æßts
, 
hash
);

219 
šcCouÁ”
(
š‹g”s
, 
hash
);

223  
	gStus
.
	gOK
;

226 @
Ov”ride


227 
public
 
	$ş—nup
() {

228 
su³r
.
	`ş—nup
();

229 ià(
couÁ
 && 
couÁ”
 < 1) {

230 
Sy¡em
.
out
.
	`´šn
("[TIMESTAMPS], Unique, " + 
time¡amps
.
	`size
());

231 
Sy¡em
.
out
.
	`´šn
("[FLOATS], Uniqu£r›s, " + 
æßts
.
	`size
());

232 
Sy¡em
.
out
.
	`´šn
("[INTEGERS], Uniqu£r›s, " + 
š‹g”s
.
	`size
());

234 
mšTs
 = 
LÚg
.
MAX_VALUE
;

235 
maxTs
 = 
LÚg
.
MIN_VALUE
;

236 
fš®
 
ts
 : 
time¡amps
.
	`keyS‘
()) {

237 ià(
ts
 > 
maxTs
) {

238 
maxTs
 = 
ts
;

240 ià(
ts
 < 
mšTs
) {

241 
mšTs
 = 
ts
;

244 
Sy¡em
.
out
.
	`´šn
("[TIMESTAMPS], Mš, " + 
mšTs
);

245 
Sy¡em
.
out
.
	`´šn
("[TIMESTAMPS], Max, " + 
maxTs
);

247 
	}
}

249 @
Ov”ride


250 
´Ùeùed
 
hash
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

251 
fš®
 
	gT»eM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gsÜ‹d
 = 
Ãw
 
T»eM­
<
SŒšg
, ByteIterator>();

252 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

253 ià(
’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

255 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

256 
	gÏ¡Time¡amp
 = ((
Num”icBy‹I‹¿tÜ
è
’Œy
.
g‘V®ue
()).
g‘LÚg
();

257 
	g’Œy
.
g‘V®ue
().
»£t
();

260 
	gsÜ‹d
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

264 
SŒšgBud”
 
	gbuf
 = 
Ãw
 SŒšgBud”().
­³nd
(
bË
).­³nd(
key
);

265 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
sÜ‹d
.
’ŒyS‘
()) {

266 
’Œy
.
g‘V®ue
().
»£t
();

267 
	gbuf
.
­³nd
(
’Œy
.
g‘Key
())

268 .
­³nd
(
’Œy
.
g‘V®ue
().
toSŒšg
());

270  
	gbuf
.
toSŒšg
().
hashCode
();

	@BasicTSDB.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gT»eM­
;

26 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gTimeS”›sWÜklßd
;

32 
public
 cÏs 
	cBasicTSDB
 
ex‹nds
 
	mBasicDB
 {

35 
´Ùeùed
 
	mM­
<
	mLÚg
, 
	mIÁeg”
> 
	mtime¡amps
;

36 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mæßts
;

37 
´Ùeùed
 
	mM­
<
	mIÁeg”
, IÁeg”> 
	mš‹g”s
;

39 
´iv©e
 
SŒšg
 
	mtime¡ampKey
;

40 
´iv©e
 
SŒšg
 
	mv®ueKey
;

41 
´iv©e
 
SŒšg
 
	mgPaœD–im™”
;

42 
´iv©e
 
SŒšg
 
	mqu”yTimeS·nD–im™”
;

43 
´iv©e
 
	mÏ¡Time¡amp
;

45 @
Ov”ride


46 
public
 
	$š™
() {

47 
su³r
.
	`š™
();

49 
	`synchrÚized
 (
MUTEX
) {

50 ià(
time¡amps
 =ğ
nuÎ
) {

51 
time¡amps
 = 
Ãw
 
HashM­
<
LÚg
, 
IÁeg”
>();

52 
æßts
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

53 
š‹g”s
 = 
Ãw
 
HashM­
<
IÁeg”
, Integer>();

57 
time¡ampKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

58 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY
,

59 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
);

60 
v®ueKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

61 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY
,

62 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
);

63 
gPaœD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

64 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY
,

65 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY_DEFAULT
);

66 
qu”yTimeS·nD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

67 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY
,

68 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
);

71 
public
 
Stus
 
	`»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

72 
	`d–ay
();

74 ià(
v”bo£
) {

75 
SŒšgBud”
 
sb
 = 
	`g‘SŒšgBud”
();

76 
sb
.
	`­³nd
("READ ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

77 ià(
f›lds
 !ğ
nuÎ
) {

78 
SŒšg
 
f
 : 
f›lds
) {

79 
sb
.
	`­³nd
(
f
).append(" ");

82 
sb
.
	`­³nd
("<all fields>");

85 
sb
.
	`­³nd
("]");

86 
Sy¡em
.
out
.
	`´šn
(
sb
);

89 ià(
couÁ
) {

90 
S‘
<
SŒšg
> 
f‹»d
 = 
nuÎ
;

91 ià(
f›lds
 !ğ
nuÎ
) {

92 
f‹»d
 = 
Ãw
 
HashS‘
<
SŒšg
>();

93 
fš®
 
SŒšg
 
f›ld
 : 
f›lds
) {

94 ià(
f›ld
.
	`¡¬tsW™h
(
time¡ampKey
)) {

95 
SŒšg
[] 
·¹s
 = 
f›ld
.
	`¥l™
(
gPaœD–im™”
);

96 ià(
·¹s
[1].
	`cÚšs
(
qu”yTimeS·nD–im™”
)) {

97 
·¹s
 =…¬ts[1].
	`¥l™
(
qu”yTimeS·nD–im™”
);

98 
Ï¡Time¡amp
 = 
LÚg
.
	`·r£LÚg
(
·¹s
[0]);

100 
Ï¡Time¡amp
 = 
LÚg
.
	`·r£LÚg
(
·¹s
[1]);

102 
	`synchrÚized
(
time¡amps
) {

103 
IÁeg”
 
ùr
 = 
time¡amps
.
	`g‘
(
Ï¡Time¡amp
);

104 ià(
ùr
 =ğ
nuÎ
) {

105 
time¡amps
.
	`put
(
Ï¡Time¡amp
, 1);

107 
time¡amps
.
	`put
(
Ï¡Time¡amp
, 
ùr
 + 1);

111 
f‹»d
.
	`add
(
f›ld
);

115 
	`šcCouÁ”
(
»ads
, 
	`hash
(
bË
, 
key
, 
f‹»d
));

117  
Stus
.
OK
;

118 
	}
}

120 @
Ov”ride


121 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

122 
d–ay
();

124 
boŞ—n
 
	gisFlßt
 = 
çl£
;

126 ià(
	gv”bo£
) {

127 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

128 
	gsb
.
­³nd
("UPDATE ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

129 ià(
	gv®ues
 !ğ
nuÎ
) {

130 
fš®
 
T»eM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
Œ“
 = 
Ãw
 T»eM­<SŒšg, 
	gBy‹I‹¿tÜ
>(
	gv®ues
);

131 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
Œ“
.
’ŒyS‘
()) {

132 ià(
’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

133 
sb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

134 .
­³nd
(
Uts
.
by‹sToLÚg
(
’Œy
.
g‘V®ue
().
toA¼ay
())).append(" ");

135 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

136 
fš®
 
Num”icBy‹I‹¿tÜ
 
	g™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

137 
	gisFlßt
 = 
™
.
isFlßtšgPošt
();

138 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

139 .
­³nd
(
isFlßt
 ? 
™
.
g‘DoubË
(è: it.
g‘LÚg
()).append(" ");

141 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

145 
	gsb
.
­³nd
("]");

146 
	gSy¡em
.
	gout
.
´šn
(
sb
);

149 ià(
	gcouÁ
) {

150 ià(!
	gv”bo£
) {

151 
	gisFlßt
 = ((
Num”icBy‹I‹¿tÜ
è
v®ues
.
g‘
(
v®ueKey
)).
isFlßtšgPošt
();

153 
	ghash
 = 
hash
(
bË
, 
key
, 
v®ues
);

154 
šcCouÁ”
(
upd©es
, 
hash
);

155 
synchrÚized
(
time¡amps
) {

156 
IÁeg”
 
	gùr
 = 
time¡amps
.
g‘
(
Ï¡Time¡amp
);

157 ià(
	gùr
 =ğ
nuÎ
) {

158 
time¡amps
.
put
(
Ï¡Time¡amp
, 1);

160 
	gtime¡amps
.
put
(
Ï¡Time¡amp
, 
ùr
 + 1);

163 ià(
	gisFlßt
) {

164 
šcCouÁ”
(
æßts
, 
hash
);

166 
šcCouÁ”
(
š‹g”s
, 
hash
);

170  
	gStus
.
	gOK
;

173 @
Ov”ride


174 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

175 
d–ay
();

177 
boŞ—n
 
	gisFlßt
 = 
çl£
;

179 ià(
	gv”bo£
) {

180 
SŒšgBud”
 
	gsb
 = 
g‘SŒšgBud”
();

181 
	gsb
.
­³nd
("INSERT ").­³nd(
bË
).­³nd(" ").­³nd(
key
).append(" [ ");

182 ià(
	gv®ues
 !ğ
nuÎ
) {

183 
fš®
 
T»eM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
Œ“
 = 
Ãw
 T»eM­<SŒšg, 
	gBy‹I‹¿tÜ
>(
	gv®ues
);

184 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
Œ“
.
’ŒyS‘
()) {

185 ià(
’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

186 
sb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

187 .
­³nd
(
Uts
.
by‹sToLÚg
(
’Œy
.
g‘V®ue
().
toA¼ay
())).append(" ");

188 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

189 
fš®
 
Num”icBy‹I‹¿tÜ
 
	g™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

190 
	gisFlßt
 = 
™
.
isFlßtšgPošt
();

191 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).append("=")

192 .
­³nd
(
isFlßt
 ? 
™
.
g‘DoubË
(è: it.
g‘LÚg
()).append(" ");

194 
	gsb
.
­³nd
(
’Œy
.
g‘Key
()).­³nd("=").­³ndÓÁry.
g‘V®ue
()).append(" ");

198 
	gsb
.
­³nd
("]");

199 
	gSy¡em
.
	gout
.
´šn
(
sb
);

202 ià(
	gcouÁ
) {

203 ià(!
	gv”bo£
) {

204 
	gisFlßt
 = ((
Num”icBy‹I‹¿tÜ
è
v®ues
.
g‘
(
v®ueKey
)).
isFlßtšgPošt
();

206 
	ghash
 = 
hash
(
bË
, 
key
, 
v®ues
);

207 
šcCouÁ”
(
š£¹s
, 
hash
);

208 
synchrÚized
(
time¡amps
) {

209 
IÁeg”
 
	gùr
 = 
time¡amps
.
g‘
(
Ï¡Time¡amp
);

210 ià(
	gùr
 =ğ
nuÎ
) {

211 
time¡amps
.
put
(
Ï¡Time¡amp
, 1);

213 
	gtime¡amps
.
put
(
Ï¡Time¡amp
, 
ùr
 + 1);

216 ià(
	gisFlßt
) {

217 
šcCouÁ”
(
æßts
, 
hash
);

219 
šcCouÁ”
(
š‹g”s
, 
hash
);

223  
	gStus
.
	gOK
;

226 @
Ov”ride


227 
public
 
	$ş—nup
() {

228 
su³r
.
	`ş—nup
();

229 ià(
couÁ
 && 
couÁ”
 < 1) {

230 
Sy¡em
.
out
.
	`´šn
("[TIMESTAMPS], Unique, " + 
time¡amps
.
	`size
());

231 
Sy¡em
.
out
.
	`´šn
("[FLOATS], Uniqu£r›s, " + 
æßts
.
	`size
());

232 
Sy¡em
.
out
.
	`´šn
("[INTEGERS], Uniqu£r›s, " + 
š‹g”s
.
	`size
());

234 
mšTs
 = 
LÚg
.
MAX_VALUE
;

235 
maxTs
 = 
LÚg
.
MIN_VALUE
;

236 
fš®
 
ts
 : 
time¡amps
.
	`keyS‘
()) {

237 ià(
ts
 > 
maxTs
) {

238 
maxTs
 = 
ts
;

240 ià(
ts
 < 
mšTs
) {

241 
mšTs
 = 
ts
;

244 
Sy¡em
.
out
.
	`´šn
("[TIMESTAMPS], Mš, " + 
mšTs
);

245 
Sy¡em
.
out
.
	`´šn
("[TIMESTAMPS], Max, " + 
maxTs
);

247 
	}
}

249 @
Ov”ride


250 
´Ùeùed
 
hash
(
fš®
 
SŒšg
 
bË
, fš® SŒšg 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

251 
fš®
 
	gT»eM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	gsÜ‹d
 = 
Ãw
 
T»eM­
<
SŒšg
, ByteIterator>();

252 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
v®ues
.
’ŒyS‘
()) {

253 ià(
’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

255 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

256 
	gÏ¡Time¡amp
 = ((
Num”icBy‹I‹¿tÜ
è
’Œy
.
g‘V®ue
()).
g‘LÚg
();

257 
	g’Œy
.
g‘V®ue
().
»£t
();

260 
	gsÜ‹d
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

264 
SŒšgBud”
 
	gbuf
 = 
Ãw
 SŒšgBud”().
­³nd
(
bË
).­³nd(
key
);

265 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
sÜ‹d
.
’ŒyS‘
()) {

266 
’Œy
.
g‘V®ue
().
»£t
();

267 
	gbuf
.
­³nd
(
’Œy
.
g‘Key
())

268 .
­³nd
(
’Œy
.
g‘V®ue
().
toSŒšg
());

270  
	gbuf
.
toSŒšg
().
hashCode
();

	@ByteArrayByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

22 
public
 cÏs 
	cBy‹A¼ayBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

23 
´iv©e
 
fš®
 
	mÜigš®Off£t
;

24 
´iv©e
 
fš®
 
	mby‹
[] 
	m¡r
;

25 
´iv©e
 
	moff
;

26 
´iv©e
 
fš®
 
	mËn
;

28 
public
 
	$By‹A¼ayBy‹I‹¿tÜ
(
by‹
[] 
s
) {

29 
this
.
¡r
 = 
s
;

30 
this
.
off
 = 0;

31 
this
.
Ën
 = 
s
.
Ëngth
;

32 
Üigš®Off£t
 = 0;

35 
public
 
	$By‹A¼ayBy‹I‹¿tÜ
(
by‹
[] 
s
, 
off
, 
Ën
) {

36 
this
.
¡r
 = 
s
;

37 
this
.
off
 = off;

38 
this
.
Ën
 = 
off
 +†en;

39 
Üigš®Off£t
 = 
off
;

40 
	}
}

42 @
Ov”ride


43 
public
 
boŞ—n
 
	$hasNext
() {

44  
off
 < 
Ën
;

45 
	}
}

47 @
Ov”ride


48 
public
 
by‹
 
	$ÃxtBy‹
() {

49 
by‹
 
»t
 = 
¡r
[
off
];

50 
off
++;

51  
»t
;

52 
	}
}

54 @
Ov”ride


55 
public
 
	$by‹sLeá
() {

56  
Ën
 - 
off
;

57 
	}
}

59 @
Ov”ride


60 
public
 
	$»£t
() {

61 
off
 = 
Üigš®Off£t
;

62 
	}
}

64 @
Ov”ride


65 
public
 
	gby‹
[] 
	$toA¼ay
() {

66 
size
 = (è
	`by‹sLeá
();

67 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
size
];

68 
Sy¡em
.
	`¬¿ycİy
(
¡r
, 
off
, 
by‹s
, 0, 
size
);

69 
off
 = 
Ën
;

70  
by‹s
;

71 
	}
}

	@ByteArrayByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

22 
public
 cÏs 
	cBy‹A¼ayBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

23 
´iv©e
 
fš®
 
	mÜigš®Off£t
;

24 
´iv©e
 
fš®
 
	mby‹
[] 
	m¡r
;

25 
´iv©e
 
	moff
;

26 
´iv©e
 
fš®
 
	mËn
;

28 
public
 
	$By‹A¼ayBy‹I‹¿tÜ
(
by‹
[] 
s
) {

29 
this
.
¡r
 = 
s
;

30 
this
.
off
 = 0;

31 
this
.
Ën
 = 
s
.
Ëngth
;

32 
Üigš®Off£t
 = 0;

35 
public
 
	$By‹A¼ayBy‹I‹¿tÜ
(
by‹
[] 
s
, 
off
, 
Ën
) {

36 
this
.
¡r
 = 
s
;

37 
this
.
off
 = off;

38 
this
.
Ën
 = 
off
 +†en;

39 
Üigš®Off£t
 = 
off
;

40 
	}
}

42 @
Ov”ride


43 
public
 
boŞ—n
 
	$hasNext
() {

44  
off
 < 
Ën
;

45 
	}
}

47 @
Ov”ride


48 
public
 
by‹
 
	$ÃxtBy‹
() {

49 
by‹
 
»t
 = 
¡r
[
off
];

50 
off
++;

51  
»t
;

52 
	}
}

54 @
Ov”ride


55 
public
 
	$by‹sLeá
() {

56  
Ën
 - 
off
;

57 
	}
}

59 @
Ov”ride


60 
public
 
	$»£t
() {

61 
off
 = 
Üigš®Off£t
;

62 
	}
}

64 @
Ov”ride


65 
public
 
	gby‹
[] 
	$toA¼ay
() {

66 
size
 = (è
	`by‹sLeá
();

67 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
size
];

68 
Sy¡em
.
	`¬¿ycİy
(
¡r
, 
off
, 
by‹s
, 0, 
size
);

69 
off
 = 
Ën
;

70  
by‹s
;

71 
	}
}

	@ByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

20 
impÜt
 
	gjava
.
	gnio
.
	gCh¬Bufãr
;

21 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gCh¬£t
;

22 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

47 
public
 
ab¡¿ù
 
şass
 
By‹I‹¿tÜ
 
im¶em’ts
 
	gI‹¿tÜ
<
	gBy‹
> {

49 @
Ov”ride


50 
public
 
ab¡¿ù
 
boŞ—n
 
hasNext
();

52 @
Ov”ride


53 
public
 
By‹
 
Ãxt
() {

54 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

57 
public
 
ab¡¿ù
 
by‹
 
ÃxtBy‹
();

60 
public
 
ÃxtBuf
(
by‹
[] 
buf
, 
bufOff
) {

61 
	gsz
 = 
bufOff
;

62 
	gsz
 < 
	gbuf
.
	gËngth
 && 
hasNext
()) {

63 
	gbuf
[
sz
] = 
ÃxtBy‹
();

64 
	gsz
++;

66  
	gsz
;

69 
public
 
ab¡¿ù
 
by‹sLeá
();

71 @
Ov”ride


72 
public
 
»move
() {

73 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

81 
public
 
»£t
() {

82 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

86 
public
 
SŒšg
 
toSŒšg
() {

87 
Ch¬£t
 
	gc£t
 = Ch¬£t.
fÜName
("UTF-8");

88 
Ch¬Bufãr
 
	gcb
 = 
c£t
.
decode
(
By‹Bufãr
.
w¿p
(
this
.
toA¼ay
()));

89  
	gcb
.
toSŒšg
();

93 
public
 
	gby‹
[] 
toA¼ay
() {

94 
	gËá
 = 
by‹sLeá
();

95 ià(
	gËá
 !ğ(è
Ëá
) {

96 
throw
 
Ãw
 
A¼ayIndexOutOfBoundsExû±iÚ
("Too much datao fit in one‡rray!");

98 
	gby‹
[] 
	g»t
 = 
Ãw
 
by‹
[(è
Ëá
];

99 
	gi
 = 0; i < 
	g»t
.
	gËngth
; i++) {

100 
	g»t
[
i
] = 
ÃxtBy‹
();

102  
	g»t
;

	@ByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

20 
impÜt
 
	gjava
.
	gnio
.
	gCh¬Bufãr
;

21 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gCh¬£t
;

22 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

47 
public
 
ab¡¿ù
 
şass
 
By‹I‹¿tÜ
 
im¶em’ts
 
	gI‹¿tÜ
<
	gBy‹
> {

49 @
Ov”ride


50 
public
 
ab¡¿ù
 
boŞ—n
 
hasNext
();

52 @
Ov”ride


53 
public
 
By‹
 
Ãxt
() {

54 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

57 
public
 
ab¡¿ù
 
by‹
 
ÃxtBy‹
();

60 
public
 
ÃxtBuf
(
by‹
[] 
buf
, 
bufOff
) {

61 
	gsz
 = 
bufOff
;

62 
	gsz
 < 
	gbuf
.
	gËngth
 && 
hasNext
()) {

63 
	gbuf
[
sz
] = 
ÃxtBy‹
();

64 
	gsz
++;

66  
	gsz
;

69 
public
 
ab¡¿ù
 
by‹sLeá
();

71 @
Ov”ride


72 
public
 
»move
() {

73 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

81 
public
 
»£t
() {

82 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

86 
public
 
SŒšg
 
toSŒšg
() {

87 
Ch¬£t
 
	gc£t
 = Ch¬£t.
fÜName
("UTF-8");

88 
Ch¬Bufãr
 
	gcb
 = 
c£t
.
decode
(
By‹Bufãr
.
w¿p
(
this
.
toA¼ay
()));

89  
	gcb
.
toSŒšg
();

93 
public
 
	gby‹
[] 
toA¼ay
() {

94 
	gËá
 = 
by‹sLeá
();

95 ià(
	gËá
 !ğ(è
Ëá
) {

96 
throw
 
Ãw
 
A¼ayIndexOutOfBoundsExû±iÚ
("Too much datao fit in one‡rray!");

98 
	gby‹
[] 
	g»t
 = 
Ãw
 
by‹
[(è
Ëá
];

99 
	gi
 = 0; i < 
	g»t
.
	gËngth
; i++) {

100 
	g»t
[
i
] = 
ÃxtBy‹
();

102  
	g»t
;

	@Client.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gTextM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gHT¿ûCÚfigu¿tiÚ
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûScİe
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûr
;

27 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

28 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

29 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

30 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

31 
impÜt
 
	gjava
.
	gut
.*;

32 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

40 
fš®
 cÏs 
	cRemaššgFÜm©‹r
 {

41 
´iv©e
 
	$RemaššgFÜm©‹r
() {

45 
public
 
SŒšgBud”
 
	$fÜm©
(
£cÚds
) {

46 
SŒšgBud”
 
time
 = 
Ãw
 
	`SŒšgBud”
();

47 
days
 = 
TimeUn™
.
SECONDS
.
	`toDays
(
£cÚds
);

48 ià(
days
 > 0) {

49 
time
.
	`­³nd
(
days
).append(days == 1 ? " day " : " days ");

50 
£cÚds
 -ğ
TimeUn™
.
DAYS
.
	`toSecÚds
(
days
);

52 
hours
 = 
TimeUn™
.
SECONDS
.
	`toHours
(
£cÚds
);

53 ià(
hours
 > 0) {

54 
time
.
	`­³nd
(
hours
).append(hours == 1 ? " hour " : " hours ");

55 
£cÚds
 -ğ
TimeUn™
.
HOURS
.
	`toSecÚds
(
hours
);

58 ià(
days
 < 1) {

59 
mšu‹s
 = 
TimeUn™
.
SECONDS
.
	`toMšu‹s
(
£cÚds
);

60 ià(
mšu‹s
 > 0) {

61 
time
.
	`­³nd
(
mšu‹s
).append(minutes == 1 ? " minute " : " minutes ");

62 
£cÚds
 -ğ
TimeUn™
.
MINUTES
.
	`toSecÚds
(seconds);

66 ià(
time
.
	`Ëngth
() == 0) {

67 
time
.
	`­³nd
(
£cÚds
).­³ndÑime.
	`Ëngth
() == 1 ? " second " : " seconds ");

69  
time
;

70 
	}
}

76 
public
 
fš®
 cÏs 
	cCl›Á
 {

77 
´iv©e
 
	$Cl›Á
() {

81 
public
 
fš®
 
SŒšg
 
DEFAULT_RECORD_COUNT
 = "0";

86 
public
 
fš®
 
SŒšg
 
OPERATION_COUNT_PROPERTY
 = "operationcount";

91 
public
 
fš®
 
SŒšg
 
RECORD_COUNT_PROPERTY
 = "recordcount";

96 
public
 
fš®
 
SŒšg
 
WORKLOAD_PROPERTY
 = "workload";

101 
public
 
fš®
 
SŒšg
 
DB_PROPERTY
 = "db";

107 
public
 
fš®
 
SŒšg
 
EXPORTER_PROPERTY
 = "exporter";

113 
public
 
fš®
 
SŒšg
 
EXPORT_FILE_PROPERTY
 = "exportfile";

118 
public
 
fš®
 
SŒšg
 
THREAD_COUNT_PROPERTY
 = "threadcount";

125 
public
 
fš®
 
SŒšg
 
INSERT_COUNT_PROPERTY
 = "insertcount";

130 
public
 
fš®
 
SŒšg
 
TARGET_PROPERTY
 = "target";

135 
public
 
fš®
 
SŒšg
 
MAX_EXECUTION_TIME
 = "maxexecutiontime";

140 
public
 
fš®
 
SŒšg
 
DO_TRANSACTIONS_PROPERTY
 = "dotransactions";

145 
public
 
fš®
 
SŒšg
 
STATUS_PROPERTY
 = "status";

150 
public
 
fš®
 
SŒšg
 
LABEL_PROPERTY
 = "label";

155 
´iv©e
 
StusTh»ad
 
¡©u¡h»ad
 = 
nuÎ
;

162 
´iv©e
 
fš®
 
SŒšg
 
HTRACE_KEY_PREFIX
 = "htrace.";

163 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_WORKLOAD_INIT_SPAN
 = "Client#workload_init";

164 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_INIT_SPAN
 = "Client#init";

165 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_WORKLOAD_SPAN
 = "Client#workload";

166 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_CLEANUP_SPAN
 = "Client#cleanup";

167 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_EXPORT_MEASUREMENTS_SPAN
 = "Client#export_measurements";

169 
public
 
	$u§geMes§ge
() {

170 
Sy¡em
.
out
.
	`´šn
("Usage: java site.ycsb.Client [options]");

171 
Sy¡em
.
out
.
	`´šn
("Options:");

172 
Sy¡em
.
out
.
	`´šn
(" -threads‚:ƒxecute using‚hreads (default: 1) - can‡lso be specified‡she \n" +

174 
Sy¡em
.
out
.
	`´šn
(" -target‚:‡ttempto do‚ operations…er second (default: unlimited) - can‡lso\n" +

176 
Sy¡em
.
out
.
	`´šn
(" -load:„unhe†oading…hase ofhe workload");

177 
Sy¡em
.
out
.
	`´šn
(" -t:„unheransactions…hase ofhe workload (default)");

178 
Sy¡em
.
out
.
	`´šn
(" -db dbname: specifyhe‚ame ofhe DBo use (default: site.ycsb.BasicDB) - \n" +

180 
Sy¡em
.
out
.
	`´šn
(" -P…ropertyfile:†oad…roperties fromhe given file. Multiple files can");

181 
Sy¡em
.
out
.
	`´šn
(" be specified,‡nd will be…rocessed inhe order specified");

182 
Sy¡em
.
out
.
	`´šn
(" -p‚ame=value: specify‡…ropertyo be…assedohe DB‡nd workloads;");

183 
Sy¡em
.
out
.
	`´šn
(" multiple…roperties can be specified,‡nd override‡ny");

184 
Sy¡em
.
out
.
	`´šn
(" values inhe…ropertyfile");

185 
Sy¡em
.
out
.
	`´šn
(" -s: show status during„un (default:‚o status)");

186 
Sy¡em
.
out
.
	`´šn
(" -l†abel: use†abel for status (e.g.o†abel oneƒxperiment out of‡ whole batch)");

187 
Sy¡em
.
out
.
	`´šn
("");

188 
Sy¡em
.
out
.
	`´šn
("Required…roperties:");

189 
Sy¡em
.
out
.
	`´šn
(" " + 
WORKLOAD_PROPERTY
 + ":he‚ame ofhe workload classo use (e.g. " +

191 
Sy¡em
.
out
.
	`´šn
("");

192 
Sy¡em
.
out
.
	`´šn
("To„unheransaction…hase from multiple servers, start‡ separate client onƒach.");

193 
Sy¡em
.
out
.
	`´šn
("To„unhe†oad…hase from multiple servers, start‡ separate client onƒach;‡dditionally,");

194 
Sy¡em
.
out
.
	`´šn
("usehe \"insertcount\"‡nd \"insertstart\"…ropertieso divide uphe„ecords " +

196 
	}
}

198 
public
 
boŞ—n
 
	$checkRequœedPrİ”t›s
(
Prİ”t›s
 
´İs
) {

199 ià(
´İs
.
	`g‘Prİ”ty
(
WORKLOAD_PROPERTY
è=ğ
nuÎ
) {

200 
Sy¡em
.
out
.
	`´šn
("Missšg…rİ”ty: " + 
WORKLOAD_PROPERTY
);

201  
çl£
;

204  
Œue
;

205 
	}
}

214 
´iv©e
 
	$expÜtM—su»m’ts
(
Prİ”t›s
 
´İs
, 
İcouÁ
, 
ruÁime
)

215 
throws
 
IOExû±iÚ
 {

216 
M—su»m’tsExpÜ‹r
 
expÜ‹r
 = 
nuÎ
;

217 
Œy
 {

219 
OuutSŒ—m
 
out
;

220 
SŒšg
 
expÜtFe
 = 
´İs
.
	`g‘Prİ”ty
(
EXPORT_FILE_PROPERTY
);

221 ià(
expÜtFe
 =ğ
nuÎ
) {

222 
out
 = 
Sy¡em
.out;

224 
out
 = 
Ãw
 
	`FeOuutSŒ—m
(
expÜtFe
);

228 
SŒšg
 
expÜ‹rSŒ
 = 
´İs
.
	`g‘Prİ”ty
(
EXPORTER_PROPERTY
,

230 
Œy
 {

231 
expÜ‹r
 = (
M—su»m’tsExpÜ‹r
è
CÏss
.
	`fÜName
(
expÜ‹rSŒ
).
	`g‘CÚ¡ruùÜ
(
OuutSŒ—m
.
şass
)

232 .
	`ÃwIn¡ªû
(
out
);

233 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

234 
Sy¡em
.
”r
.
	`´šn
("Could‚Ù fšdƒxpÜ‹¸" + 
expÜ‹rSŒ


236 
e
.
	`´štSckT¿û
();

237 
expÜ‹r
 = 
Ãw
 
	`TextM—su»m’tsExpÜ‹r
(
out
);

240 
expÜ‹r
.
	`wr™e
("OVERALL", "RunTime(ms)", 
ruÁime
);

241 
throughput
 = 1000.0 * (
İcouÁ
è/ (
ruÁime
);

242 
expÜ‹r
.
	`wr™e
("OVERALL", "Throughput(İs/£c)", 
throughput
);

244 
fš®
 
M­
<
SŒšg
, 
LÚg
[]> 
gcs
 = 
Uts
.
	`g‘GCSt¡
();

245 
tÙ®GCCouÁ
 = 0;

246 
tÙ®GCTime
 = 0;

247 
fš®
 
EÁry
<
SŒšg
, 
LÚg
[]> 
’Œy
 : 
gcs
.
	`’ŒyS‘
()) {

248 
expÜ‹r
.
	`wr™e
("TOTAL_GCS_" + 
’Œy
.
	`g‘Key
(), "CouÁ",ƒÁry.
	`g‘V®ue
()[0]);

249 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME_" + 
’Œy
.
	`g‘Key
(), "Time(ms)",ƒÁry.
	`g‘V®ue
()[1]);

250 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME_%_" + 
’Œy
.
	`g‘Key
(), "Time(%)",

251 ((è
’Œy
.
	`g‘V®ue
()[1] / 
ruÁime
) * () 100);

252 
tÙ®GCCouÁ
 +ğ
’Œy
.
	`g‘V®ue
()[0];

253 
tÙ®GCTime
 +ğ
’Œy
.
	`g‘V®ue
()[1];

255 
expÜ‹r
.
	`wr™e
("TOTAL_GCs", "CouÁ", 
tÙ®GCCouÁ
);

257 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME", "Time(ms)", 
tÙ®GCTime
);

258 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME_%", "Time(%)", ((è
tÙ®GCTime
 / 
ruÁime
) * () 100);

259 ià(
¡©u¡h»ad
 !ğ
nuÎ
 && stu¡h»ad.
	`ŒackJVMSts
()) {

260 
expÜ‹r
.
	`wr™e
("MAX_MEM_USED", "MBs", 
¡©u¡h»ad
.
	`g‘MaxU£dMem
());

261 
expÜ‹r
.
	`wr™e
("MIN_MEM_USED", "MBs", 
¡©u¡h»ad
.
	`g‘MšU£dMem
());

262 
expÜ‹r
.
	`wr™e
("MAX_THREADS", "CouÁ", 
¡©u¡h»ad
.
	`g‘MaxTh»ads
());

263 
expÜ‹r
.
	`wr™e
("MIN_THREADS", "CouÁ", 
¡©u¡h»ad
.
	`g‘MšTh»ads
());

264 
expÜ‹r
.
	`wr™e
("MAX_SYS_LOAD_AVG", "Lßd", 
¡©u¡h»ad
.
	`g‘MaxLßdAvg
());

265 
expÜ‹r
.
	`wr™e
("MIN_SYS_LOAD_AVG", "Lßd", 
¡©u¡h»ad
.
	`g‘MšLßdAvg
());

268 
M—su»m’ts
.
	`g‘M—su»m’ts
().
	`expÜtM—su»m’ts
(
expÜ‹r
);

269 } 
fš®ly
 {

270 ià(
expÜ‹r
 !ğ
nuÎ
) {

271 
expÜ‹r
.
	`şo£
();

274 
	}
}

276 @
Suµ»ssW¬nšgs
("unchecked")

277 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

278 
Prİ”t›s
 
´İs
 = 
	`·r£Argum’ts
(
¬gs
);

280 
boŞ—n
 
¡©us
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
STATUS_PROPERTY
, 
SŒšg
.v®ueOf(
çl£
)));

281 
SŒšg
 
Ïb–
 = 
´İs
.
	`g‘Prİ”ty
(
LABEL_PROPERTY
, "");

283 
maxExecutiÚTime
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
MAX_EXECUTION_TIME
, "0"));

286 
th»adcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
THREAD_COUNT_PROPERTY
, "1"));

287 
SŒšg
 
dbÇme
 = 
´İs
.
	`g‘Prİ”ty
(
DB_PROPERTY
, "site.ycsb.BasicDB");

288 
rg‘
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
TARGET_PROPERTY
, "0"));

291 
rg‘³¹h»ad³rms
 = -1;

292 ià(
rg‘
 > 0) {

293 
rg‘³¹h»ad
 = ((è
rg‘
è/ ((è
th»adcouÁ
);

294 
rg‘³¹h»ad³rms
 = 
rg‘³¹h»ad
 / 1000.0;

297 
Th»ad
 
w¬nšgth»ad
 = 
	`£tupW¬nšgTh»ad
();

298 
w¬nšgth»ad
.
	`¡¬t
();

300 
M—su»m’ts
.
	`£tPrİ”t›s
(
´İs
);

302 
WÜklßd
 
wÜklßd
 = 
	`g‘WÜklßd
(
´İs
);

304 
fš®
 
T¿ûr
 
Œaûr
 = 
	`g‘T¿ûr
(
´İs
, 
wÜklßd
);

306 
	`š™WÜklßd
(
´İs
, 
w¬nšgth»ad
, 
wÜklßd
, 
Œaûr
);

308 
Sy¡em
.
”r
.
	`´šn
("Startingest.");

309 
fš®
 
CouÁDownL©ch
 
com¶‘eL©ch
 = 
Ãw
 
	`CouÁDownL©ch
(
th»adcouÁ
);

311 
fš®
 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
 = 
	`š™Db
(
dbÇme
, 
´İs
, 
th»adcouÁ
, 
rg‘³¹h»ad³rms
,

312 
wÜklßd
, 
Œaûr
, 
com¶‘eL©ch
);

314 ià(
¡©us
) {

315 
boŞ—n
 
¡ªd¬d¡©us
 = 
çl£
;

316 ià(
´İs
.
	`g‘Prİ”ty
(
M—su»m’ts
.
MEASUREMENT_TYPE_PROPERTY
, "").
	`com·»To
("timeseries") == 0) {

317 
¡ªd¬d¡©us
 = 
Œue
;

319 
¡©usIÁ”v®SecÚds
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("status.interval", "10"));

320 
boŞ—n
 
ŒackJVMSts
 = 
´İs
.
	`g‘Prİ”ty
(
M—su»m’ts
.
MEASUREMENT_TRACK_JVM_PROPERTY
,

321 
M—su»m’ts
.
MEASUREMENT_TRACK_JVM_PROPERTY_DEFAULT
).
	`equ®s
("true");

322 
¡©u¡h»ad
 = 
Ãw
 
	`StusTh»ad
(
com¶‘eL©ch
, 
ş›Ás
, 
Ïb–
, 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
,

323 
ŒackJVMSts
);

324 
¡©u¡h»ad
.
	`¡¬t
();

327 
Th»ad
 
‹rmš©Ü
 = 
nuÎ
;

328 
¡
;

329 
’
;

330 
İsDÚe
;

332 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_WORKLOAD_SPAN
)) {

334 
fš®
 
M­
<
Th»ad
, 
Cl›ÁTh»ad
> 
th»ads
 = 
Ãw
 
HashM­
<>(
th»adcouÁ
);

335 
Cl›ÁTh»ad
 
ş›Á
 : 
ş›Ás
) {

336 
th»ads
.
	`put
(
Ãw
 
	`Th»ad
(
Œaûr
.
	`w¿p
(
ş›Á
, "ClientThread")), client);

339 
¡
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

341 
Th»ad
 
t
 : 
th»ads
.
	`keyS‘
()) {

342 
t
.
	`¡¬t
();

345 ià(
maxExecutiÚTime
 > 0) {

346 
‹rmš©Ü
 = 
Ãw
 
	`T”mš©ÜTh»ad
(
maxExecutiÚTime
, 
th»ads
.
	`keyS‘
(), 
wÜklßd
);

347 
‹rmš©Ü
.
	`¡¬t
();

350 
İsDÚe
 = 0;

352 
M­
.
EÁry
<
Th»ad
, 
Cl›ÁTh»ad
> 
’Œy
 : 
th»ads
.
	`’ŒyS‘
()) {

353 
Œy
 {

354 
’Œy
.
	`g‘Key
().
	`još
();

355 
İsDÚe
 +ğ
’Œy
.
	`g‘V®ue
().
	`g‘OpsDÚe
();

356 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
ignÜed
) {

361 
’
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

364 
Œy
 {

365 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_CLEANUP_SPAN
)) {

367 ià(
‹rmš©Ü
 !ğ
nuÎ
 && !‹rmš©Ü.
	`isIÁ”ru±ed
()) {

368 
‹rmš©Ü
.
	`š‹¼u±
();

371 ià(
¡©us
) {

373 
¡©u¡h»ad
.
	`š‹¼u±
();

375 
Œy
 {

376 
¡©u¡h»ad
.
	`još
();

377 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
ignÜed
) {

382 
wÜklßd
.
	`ş—nup
();

384 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) {

385 
e
.
	`´štSckT¿û
();

386 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

387 
Sy¡em
.
	`ex™
(0);

390 
Œy
 {

391 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_EXPORT_MEASUREMENTS_SPAN
)) {

392 
	`expÜtM—su»m’ts
(
´İs
, 
İsDÚe
, 
’
 - 
¡
);

394 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

395 
Sy¡em
.
”r
.
	`´šn
("Could‚ÙƒxpÜˆm—su»m’ts,ƒ¼Ü: " + 
e
.
	`g‘Mes§ge
());

396 
e
.
	`´štSckT¿û
();

397 
Sy¡em
.
	`ex™
(-1);

400 
Sy¡em
.
	`ex™
(0);

401 
	}
}

403 
´iv©e
 
	gLi¡
<
	gCl›ÁTh»ad
> 
	$š™Db
(
SŒšg
 
dbÇme
, 
Prİ”t›s
 
´İs
, 
th»adcouÁ
,

404 
rg‘³¹h»ad³rms
, 
WÜklßd
 
wÜklßd
, 
T¿ûr
 
Œaûr
,

405 
CouÁDownL©ch
 
com¶‘eL©ch
) {

406 
boŞ—n
 
š™Faed
 = 
çl£
;

407 
boŞ—n
 
dÙ¿n§ùiÚs
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
DO_TRANSACTIONS_PROPERTY
, 
SŒšg
.v®ueOf(
Œue
)));

409 
fš®
 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
 = 
Ãw
 
A¼ayLi¡
<>(
th»adcouÁ
);

410 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_INIT_SPAN
)) {

411 
İcouÁ
;

412 ià(
dÙ¿n§ùiÚs
) {

413 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
OPERATION_COUNT_PROPERTY
, "0"));

415 ià(
´İs
.
	`cÚšsKey
(
INSERT_COUNT_PROPERTY
)) {

416 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
INSERT_COUNT_PROPERTY
, "0"));

418 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
RECORD_COUNT_PROPERTY
, 
DEFAULT_RECORD_COUNT
));

421 ià(
th»adcouÁ
 > 
İcouÁ
 && opcount > 0){

422 
th»adcouÁ
 = 
İcouÁ
;

423 
Sy¡em
.
out
.
	`´šn
("Warning:hehreadcount is biggerhan„ecordcount,hehreadcount will be„ecordcount!");

425 
th»adid
 = 0;h»adid < 
th»adcouÁ
;hreadid++) {

426 
DB
 
db
;

427 
Œy
 {

428 
db
 = 
DBFaùÜy
.
	`ÃwDB
(
dbÇme
, 
´İs
, 
Œaûr
);

429 } 
	`ÿtch
 (
UnknownDBExû±iÚ
 
e
) {

430 
Sy¡em
.
out
.
	`´šn
("UnknowÀDB " + 
dbÇme
);

431 
š™Faed
 = 
Œue
;

435 
th»adİcouÁ
 = 
İcouÁ
 / 
th»adcouÁ
;

438 ià(
th»adid
 < 
İcouÁ
 % 
th»adcouÁ
) {

439 ++
th»adİcouÁ
;

442 
Cl›ÁTh»ad
 
t
 = 
Ãw
 
	`Cl›ÁTh»ad
(
db
, 
dÙ¿n§ùiÚs
, 
wÜklßd
, 
´İs
, 
th»adİcouÁ
, 
rg‘³¹h»ad³rms
,

443 
com¶‘eL©ch
);

444 
t
.
	`£tTh»adId
(
th»adid
);

445 
t
.
	`£tTh»adCouÁ
(
th»adcouÁ
);

446 
ş›Ás
.
	`add
(
t
);

449 ià(
š™Faed
) {

450 
Sy¡em
.
”r
.
	`´šn
("Error initializing datastore bindings.");

451 
Sy¡em
.
	`ex™
(0);

454  
ş›Ás
;

455 
	}
}

457 
´iv©e
 
T¿ûr
 
	$g‘T¿ûr
(
Prİ”t›s
 
´İs
, 
WÜklßd
 
wÜklßd
) {

458  
Ãw
 
T¿ûr
.
	`Bud”
("YCSB " + 
wÜklßd
.
	`g‘CÏss
().
	`g‘Sim¶eName
())

459 .
	`cÚf
(
	`g‘HT¿ûCÚfigu¿tiÚ
(
´İs
))

460 .
	`bud
();

461 
	}
}

463 
´iv©e
 
	$š™WÜklßd
(
Prİ”t›s
 
´İs
, 
Th»ad
 
w¬nšgth»ad
, 
WÜklßd
 
wÜklßd
, 
T¿ûr
 
Œaûr
) {

464 
Œy
 {

465 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_WORKLOAD_INIT_SPAN
)) {

466 
wÜklßd
.
	`š™
(
´İs
);

467 
w¬nšgth»ad
.
	`š‹¼u±
();

469 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) {

470 
e
.
	`´štSckT¿û
();

471 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

472 
Sy¡em
.
	`ex™
(0);

474 
	}
}

476 
´iv©e
 
HT¿ûCÚfigu¿tiÚ
 
	$g‘HT¿ûCÚfigu¿tiÚ
(
Prİ”t›s
 
´İs
) {

477 
fš®
 
M­
<
SŒšg
, SŒšg> 
f‹»dPrİ”t›s
 = 
Ãw
 
HashM­
<>();

478 
SŒšg
 
key
 : 
´İs
.
	`¡ršgPrİ”tyNames
()) {

479 ià(
key
.
	`¡¬tsW™h
(
HTRACE_KEY_PREFIX
)) {

480 
f‹»dPrİ”t›s
.
	`put
(
key
.
	`sub¡ršg
(
HTRACE_KEY_PREFIX
.
	`Ëngth
()), 
´İs
.
	`g‘Prİ”ty
(key));

483  
HT¿ûCÚfigu¿tiÚ
.
	`äomM­
(
f‹»dPrİ”t›s
);

484 
	}
}

486 
´iv©e
 
Th»ad
 
	$£tupW¬nšgTh»ad
() {

490  
Ãw
 
	`Th»ad
() {

491 @
Ov”ride


492 
public
 
	`run
() {

493 
Œy
 {

494 
	`¦“p
(2000);

495 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

498 
Sy¡em
.
”r
.
	`´šn
(" (mightake‡ few minutes for†arge data sets)");

501 
	}
}

503 
´iv©e
 
WÜklßd
 
	$g‘WÜklßd
(
Prİ”t›s
 
´İs
) {

504 
CÏssLßd”
 
şassLßd”
 = 
Cl›Á
.
şass
.
	`g‘CÏssLßd”
();

506 
Œy
 {

507 
Prİ”t›s
 
´ojeùPrİ
 = 
Ãw
 
	`Prİ”t›s
();

508 
´ojeùPrİ
.
	`lßd
(
şassLßd”
.
	`g‘ResourûAsSŒ—m
("project.properties"));

509 
Sy¡em
.
”r
.
	`´šn
("YCSB Cl›Á " + 
´ojeùPrİ
.
	`g‘Prİ”ty
("version"));

510 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

511 
Sy¡em
.
”r
.
	`´šn
("Unableo„etrieve client version.");

514 
Sy¡em
.
”r
.
	`´šn
();

515 
Sy¡em
.
”r
.
	`´šn
("Loading workload...");

516 
Œy
 {

517 
CÏss
 
wÜklßdşass
 = 
şassLßd”
.
	`lßdCÏss
(
´İs
.
	`g‘Prİ”ty
(
WORKLOAD_PROPERTY
));

519  (
WÜklßd
è
wÜklßdşass
.
	`ÃwIn¡ªû
();

520 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

521 
e
.
	`´štSckT¿û
();

522 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

523 
Sy¡em
.
	`ex™
(0);

526  
nuÎ
;

527 
	}
}

529 
´iv©e
 
Prİ”t›s
 
	$·r£Argum’ts
(
SŒšg
[] 
¬gs
) {

530 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

531 
Sy¡em
.
”r
.
	`´št
("Command†ine:");

532 
SŒšg
 
¬g
 : 
¬gs
) {

533 
Sy¡em
.
”r
.
	`´št
(" " + 
¬g
);

535 
Sy¡em
.
”r
.
	`´šn
();

537 
Prİ”t›s
 
f•rİs
 = 
Ãw
 
	`Prİ”t›s
();

538 
¬gšdex
 = 0;

540 ià(
¬gs
.
Ëngth
 == 0) {

541 
	`u§geMes§ge
();

542 
Sy¡em
.
out
.
	`´šn
("At†east one‡rgument specifying‡ workload is„equired.");

543 
Sy¡em
.
	`ex™
(0);

546 
¬gs
[
¬gšdex
].
	`¡¬tsW™h
("-")) {

547 ià(
¬gs
[
¬gšdex
].
	`com·»To
("-threads") == 0) {

548 
¬gšdex
++;

549 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

550 
	`u§geMes§ge
();

551 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -threads.");

552 
Sy¡em
.
	`ex™
(0);

554 
tcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[
¬gšdex
]);

555 
´İs
.
	`£tPrİ”ty
(
THREAD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
tcouÁ
));

556 
¬gšdex
++;

557 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-target") == 0) {

558 
¬gšdex
++;

559 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

560 
	`u§geMes§ge
();

561 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -target.");

562 
Sy¡em
.
	`ex™
(0);

564 
‰¬g‘
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[
¬gšdex
]);

565 
´İs
.
	`£tPrİ”ty
(
TARGET_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
‰¬g‘
));

566 
¬gšdex
++;

567 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-load") == 0) {

568 
´İs
.
	`£tPrİ”ty
(
DO_TRANSACTIONS_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
çl£
));

569 
¬gšdex
++;

570 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-t") == 0) {

571 
´İs
.
	`£tPrİ”ty
(
DO_TRANSACTIONS_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
Œue
));

572 
¬gšdex
++;

573 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-s") == 0) {

574 
´İs
.
	`£tPrİ”ty
(
STATUS_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
Œue
));

575 
¬gšdex
++;

576 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-db") == 0) {

577 
¬gšdex
++;

578 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

579 
	`u§geMes§ge
();

580 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -db.");

581 
Sy¡em
.
	`ex™
(0);

583 
´İs
.
	`£tPrİ”ty
(
DB_PROPERTY
, 
¬gs
[
¬gšdex
]);

584 
¬gšdex
++;

585 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-l") == 0) {

586 
¬gšdex
++;

587 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

588 
	`u§geMes§ge
();

589 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -l.");

590 
Sy¡em
.
	`ex™
(0);

592 
´İs
.
	`£tPrİ”ty
(
LABEL_PROPERTY
, 
¬gs
[
¬gšdex
]);

593 
¬gšdex
++;

594 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-P") == 0) {

595 
¬gšdex
++;

596 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

597 
	`u§geMes§ge
();

598 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -P.");

599 
Sy¡em
.
	`ex™
(0);

601 
SŒšg
 
´İfe
 = 
¬gs
[
¬gšdex
];

602 
¬gšdex
++;

604 
Prİ”t›s
 
myf•rİs
 = 
Ãw
 
	`Prİ”t›s
();

605 
Œy
 {

606 
myf•rİs
.
	`lßd
(
Ãw
 
	`FeIÅutSŒ—m
(
´İfe
));

607 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

608 
Sy¡em
.
out
.
	`´šn
("UÇbËØİ’h´İ”t› f" + 
´İfe
);

609 
Sy¡em
.
out
.
	`´šn
(
e
.
	`g‘Mes§ge
());

610 
Sy¡em
.
	`ex™
(0);

614 
Enum”©iÚ
 
e
 = 
myf•rİs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

615 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

617 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
myf•rİs
.
	`g‘Prİ”ty
(prop));

620 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-p") == 0) {

621 
¬gšdex
++;

622 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

623 
	`u§geMes§ge
();

624 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -p");

625 
Sy¡em
.
	`ex™
(0);

627 
eq
 = 
¬gs
[
¬gšdex
].
	`šdexOf
('=');

628 ià(
eq
 < 0) {

629 
	`u§geMes§ge
();

630 
Sy¡em
.
out
.
	`´šn
("Argument '-p'ƒxpectedo be in key=value format (e.g., -p operationcount=99999)");

631 
Sy¡em
.
	`ex™
(0);

634 
SŒšg
 
Çme
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(0, 
eq
);

635 
SŒšg
 
v®ue
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(
eq
 + 1);

636 
´İs
.
	`put
(
Çme
, 
v®ue
);

637 
¬gšdex
++;

639 
	`u§geMes§ge
();

640 
Sy¡em
.
out
.
	`´šn
("UnknowÀİtiÚ " + 
¬gs
[
¬gšdex
]);

641 
Sy¡em
.
	`ex™
(0);

644 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

649 ià(
¬gšdex
 !ğ
¬gs
.
Ëngth
) {

650 
	`u§geMes§ge
();

651 ià(
¬gšdex
 < 
¬gs
.
Ëngth
) {

652 
Sy¡em
.
out
.
	`´šn
("An‡rgument value without corresponding‡rgument specifier (e.g., -p, -s) was found. "

653 + "Wex³ùed‡À¬gum’ˆ¥ecif›¸ªd in¡—d found " + 
¬gs
[
¬gšdex
]);

655 
Sy¡em
.
out
.
	`´šn
("An‡rgument specifier without corresponding value was found‡theƒnd ofhe supplied " +

658 
Sy¡em
.
	`ex™
(0);

664 
Enum”©iÚ
 
e
 = 
´İs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

665 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

667 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
´İs
.
	`g‘Prİ”ty
(prop));

670 
´İs
 = 
f•rİs
;

672 ià(!
	`checkRequœedPrİ”t›s
(
´İs
)) {

673 
Sy¡em
.
out
.
	`´šn
("Failed check„equired…roperties.");

674 
Sy¡em
.
	`ex™
(0);

677  
´İs
;

678 
	}
}

	@Client.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gTextM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gHT¿ûCÚfigu¿tiÚ
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûScİe
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûr
;

27 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

28 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

29 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

30 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

31 
impÜt
 
	gjava
.
	gut
.*;

32 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

40 
fš®
 cÏs 
	cRemaššgFÜm©‹r
 {

41 
´iv©e
 
	$RemaššgFÜm©‹r
() {

45 
public
 
SŒšgBud”
 
	$fÜm©
(
£cÚds
) {

46 
SŒšgBud”
 
time
 = 
Ãw
 
	`SŒšgBud”
();

47 
days
 = 
TimeUn™
.
SECONDS
.
	`toDays
(
£cÚds
);

48 ià(
days
 > 0) {

49 
time
.
	`­³nd
(
days
).append(days == 1 ? " day " : " days ");

50 
£cÚds
 -ğ
TimeUn™
.
DAYS
.
	`toSecÚds
(
days
);

52 
hours
 = 
TimeUn™
.
SECONDS
.
	`toHours
(
£cÚds
);

53 ià(
hours
 > 0) {

54 
time
.
	`­³nd
(
hours
).append(hours == 1 ? " hour " : " hours ");

55 
£cÚds
 -ğ
TimeUn™
.
HOURS
.
	`toSecÚds
(
hours
);

58 ià(
days
 < 1) {

59 
mšu‹s
 = 
TimeUn™
.
SECONDS
.
	`toMšu‹s
(
£cÚds
);

60 ià(
mšu‹s
 > 0) {

61 
time
.
	`­³nd
(
mšu‹s
).append(minutes == 1 ? " minute " : " minutes ");

62 
£cÚds
 -ğ
TimeUn™
.
MINUTES
.
	`toSecÚds
(seconds);

66 ià(
time
.
	`Ëngth
() == 0) {

67 
time
.
	`­³nd
(
£cÚds
).­³ndÑime.
	`Ëngth
() == 1 ? " second " : " seconds ");

69  
time
;

70 
	}
}

76 
public
 
fš®
 cÏs 
	cCl›Á
 {

77 
´iv©e
 
	$Cl›Á
() {

81 
public
 
fš®
 
SŒšg
 
DEFAULT_RECORD_COUNT
 = "0";

86 
public
 
fš®
 
SŒšg
 
OPERATION_COUNT_PROPERTY
 = "operationcount";

91 
public
 
fš®
 
SŒšg
 
RECORD_COUNT_PROPERTY
 = "recordcount";

96 
public
 
fš®
 
SŒšg
 
WORKLOAD_PROPERTY
 = "workload";

101 
public
 
fš®
 
SŒšg
 
DB_PROPERTY
 = "db";

107 
public
 
fš®
 
SŒšg
 
EXPORTER_PROPERTY
 = "exporter";

113 
public
 
fš®
 
SŒšg
 
EXPORT_FILE_PROPERTY
 = "exportfile";

118 
public
 
fš®
 
SŒšg
 
THREAD_COUNT_PROPERTY
 = "threadcount";

125 
public
 
fš®
 
SŒšg
 
INSERT_COUNT_PROPERTY
 = "insertcount";

130 
public
 
fš®
 
SŒšg
 
TARGET_PROPERTY
 = "target";

135 
public
 
fš®
 
SŒšg
 
MAX_EXECUTION_TIME
 = "maxexecutiontime";

140 
public
 
fš®
 
SŒšg
 
DO_TRANSACTIONS_PROPERTY
 = "dotransactions";

145 
public
 
fš®
 
SŒšg
 
STATUS_PROPERTY
 = "status";

150 
public
 
fš®
 
SŒšg
 
LABEL_PROPERTY
 = "label";

155 
´iv©e
 
StusTh»ad
 
¡©u¡h»ad
 = 
nuÎ
;

162 
´iv©e
 
fš®
 
SŒšg
 
HTRACE_KEY_PREFIX
 = "htrace.";

163 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_WORKLOAD_INIT_SPAN
 = "Client#workload_init";

164 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_INIT_SPAN
 = "Client#init";

165 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_WORKLOAD_SPAN
 = "Client#workload";

166 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_CLEANUP_SPAN
 = "Client#cleanup";

167 
´iv©e
 
fš®
 
SŒšg
 
CLIENT_EXPORT_MEASUREMENTS_SPAN
 = "Client#export_measurements";

169 
public
 
	$u§geMes§ge
() {

170 
Sy¡em
.
out
.
	`´šn
("Usage: java site.ycsb.Client [options]");

171 
Sy¡em
.
out
.
	`´šn
("Options:");

172 
Sy¡em
.
out
.
	`´šn
(" -threads‚:ƒxecute using‚hreads (default: 1) - can‡lso be specified‡she \n" +

174 
Sy¡em
.
out
.
	`´šn
(" -target‚:‡ttempto do‚ operations…er second (default: unlimited) - can‡lso\n" +

176 
Sy¡em
.
out
.
	`´šn
(" -load:„unhe†oading…hase ofhe workload");

177 
Sy¡em
.
out
.
	`´šn
(" -t:„unheransactions…hase ofhe workload (default)");

178 
Sy¡em
.
out
.
	`´šn
(" -db dbname: specifyhe‚ame ofhe DBo use (default: site.ycsb.BasicDB) - \n" +

180 
Sy¡em
.
out
.
	`´šn
(" -P…ropertyfile:†oad…roperties fromhe given file. Multiple files can");

181 
Sy¡em
.
out
.
	`´šn
(" be specified,‡nd will be…rocessed inhe order specified");

182 
Sy¡em
.
out
.
	`´šn
(" -p‚ame=value: specify‡…ropertyo be…assedohe DB‡nd workloads;");

183 
Sy¡em
.
out
.
	`´šn
(" multiple…roperties can be specified,‡nd override‡ny");

184 
Sy¡em
.
out
.
	`´šn
(" values inhe…ropertyfile");

185 
Sy¡em
.
out
.
	`´šn
(" -s: show status during„un (default:‚o status)");

186 
Sy¡em
.
out
.
	`´šn
(" -l†abel: use†abel for status (e.g.o†abel oneƒxperiment out of‡ whole batch)");

187 
Sy¡em
.
out
.
	`´šn
("");

188 
Sy¡em
.
out
.
	`´šn
("Required…roperties:");

189 
Sy¡em
.
out
.
	`´šn
(" " + 
WORKLOAD_PROPERTY
 + ":he‚ame ofhe workload classo use (e.g. " +

191 
Sy¡em
.
out
.
	`´šn
("");

192 
Sy¡em
.
out
.
	`´šn
("To„unheransaction…hase from multiple servers, start‡ separate client onƒach.");

193 
Sy¡em
.
out
.
	`´šn
("To„unhe†oad…hase from multiple servers, start‡ separate client onƒach;‡dditionally,");

194 
Sy¡em
.
out
.
	`´šn
("usehe \"insertcount\"‡nd \"insertstart\"…ropertieso divide uphe„ecords " +

196 
	}
}

198 
public
 
boŞ—n
 
	$checkRequœedPrİ”t›s
(
Prİ”t›s
 
´İs
) {

199 ià(
´İs
.
	`g‘Prİ”ty
(
WORKLOAD_PROPERTY
è=ğ
nuÎ
) {

200 
Sy¡em
.
out
.
	`´šn
("Missšg…rİ”ty: " + 
WORKLOAD_PROPERTY
);

201  
çl£
;

204  
Œue
;

205 
	}
}

214 
´iv©e
 
	$expÜtM—su»m’ts
(
Prİ”t›s
 
´İs
, 
İcouÁ
, 
ruÁime
)

215 
throws
 
IOExû±iÚ
 {

216 
M—su»m’tsExpÜ‹r
 
expÜ‹r
 = 
nuÎ
;

217 
Œy
 {

219 
OuutSŒ—m
 
out
;

220 
SŒšg
 
expÜtFe
 = 
´İs
.
	`g‘Prİ”ty
(
EXPORT_FILE_PROPERTY
);

221 ià(
expÜtFe
 =ğ
nuÎ
) {

222 
out
 = 
Sy¡em
.out;

224 
out
 = 
Ãw
 
	`FeOuutSŒ—m
(
expÜtFe
);

228 
SŒšg
 
expÜ‹rSŒ
 = 
´İs
.
	`g‘Prİ”ty
(
EXPORTER_PROPERTY
,

230 
Œy
 {

231 
expÜ‹r
 = (
M—su»m’tsExpÜ‹r
è
CÏss
.
	`fÜName
(
expÜ‹rSŒ
).
	`g‘CÚ¡ruùÜ
(
OuutSŒ—m
.
şass
)

232 .
	`ÃwIn¡ªû
(
out
);

233 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

234 
Sy¡em
.
”r
.
	`´šn
("Could‚Ù fšdƒxpÜ‹¸" + 
expÜ‹rSŒ


236 
e
.
	`´štSckT¿û
();

237 
expÜ‹r
 = 
Ãw
 
	`TextM—su»m’tsExpÜ‹r
(
out
);

240 
expÜ‹r
.
	`wr™e
("OVERALL", "RunTime(ms)", 
ruÁime
);

241 
throughput
 = 1000.0 * (
İcouÁ
è/ (
ruÁime
);

242 
expÜ‹r
.
	`wr™e
("OVERALL", "Throughput(İs/£c)", 
throughput
);

244 
fš®
 
M­
<
SŒšg
, 
LÚg
[]> 
gcs
 = 
Uts
.
	`g‘GCSt¡
();

245 
tÙ®GCCouÁ
 = 0;

246 
tÙ®GCTime
 = 0;

247 
fš®
 
EÁry
<
SŒšg
, 
LÚg
[]> 
’Œy
 : 
gcs
.
	`’ŒyS‘
()) {

248 
expÜ‹r
.
	`wr™e
("TOTAL_GCS_" + 
’Œy
.
	`g‘Key
(), "CouÁ",ƒÁry.
	`g‘V®ue
()[0]);

249 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME_" + 
’Œy
.
	`g‘Key
(), "Time(ms)",ƒÁry.
	`g‘V®ue
()[1]);

250 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME_%_" + 
’Œy
.
	`g‘Key
(), "Time(%)",

251 ((è
’Œy
.
	`g‘V®ue
()[1] / 
ruÁime
) * () 100);

252 
tÙ®GCCouÁ
 +ğ
’Œy
.
	`g‘V®ue
()[0];

253 
tÙ®GCTime
 +ğ
’Œy
.
	`g‘V®ue
()[1];

255 
expÜ‹r
.
	`wr™e
("TOTAL_GCs", "CouÁ", 
tÙ®GCCouÁ
);

257 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME", "Time(ms)", 
tÙ®GCTime
);

258 
expÜ‹r
.
	`wr™e
("TOTAL_GC_TIME_%", "Time(%)", ((è
tÙ®GCTime
 / 
ruÁime
) * () 100);

259 ià(
¡©u¡h»ad
 !ğ
nuÎ
 && stu¡h»ad.
	`ŒackJVMSts
()) {

260 
expÜ‹r
.
	`wr™e
("MAX_MEM_USED", "MBs", 
¡©u¡h»ad
.
	`g‘MaxU£dMem
());

261 
expÜ‹r
.
	`wr™e
("MIN_MEM_USED", "MBs", 
¡©u¡h»ad
.
	`g‘MšU£dMem
());

262 
expÜ‹r
.
	`wr™e
("MAX_THREADS", "CouÁ", 
¡©u¡h»ad
.
	`g‘MaxTh»ads
());

263 
expÜ‹r
.
	`wr™e
("MIN_THREADS", "CouÁ", 
¡©u¡h»ad
.
	`g‘MšTh»ads
());

264 
expÜ‹r
.
	`wr™e
("MAX_SYS_LOAD_AVG", "Lßd", 
¡©u¡h»ad
.
	`g‘MaxLßdAvg
());

265 
expÜ‹r
.
	`wr™e
("MIN_SYS_LOAD_AVG", "Lßd", 
¡©u¡h»ad
.
	`g‘MšLßdAvg
());

268 
M—su»m’ts
.
	`g‘M—su»m’ts
().
	`expÜtM—su»m’ts
(
expÜ‹r
);

269 } 
fš®ly
 {

270 ià(
expÜ‹r
 !ğ
nuÎ
) {

271 
expÜ‹r
.
	`şo£
();

274 
	}
}

276 @
Suµ»ssW¬nšgs
("unchecked")

277 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

278 
Prİ”t›s
 
´İs
 = 
	`·r£Argum’ts
(
¬gs
);

280 
boŞ—n
 
¡©us
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
STATUS_PROPERTY
, 
SŒšg
.v®ueOf(
çl£
)));

281 
SŒšg
 
Ïb–
 = 
´İs
.
	`g‘Prİ”ty
(
LABEL_PROPERTY
, "");

283 
maxExecutiÚTime
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
MAX_EXECUTION_TIME
, "0"));

286 
th»adcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
THREAD_COUNT_PROPERTY
, "1"));

287 
SŒšg
 
dbÇme
 = 
´İs
.
	`g‘Prİ”ty
(
DB_PROPERTY
, "site.ycsb.BasicDB");

288 
rg‘
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
TARGET_PROPERTY
, "0"));

291 
rg‘³¹h»ad³rms
 = -1;

292 ià(
rg‘
 > 0) {

293 
rg‘³¹h»ad
 = ((è
rg‘
è/ ((è
th»adcouÁ
);

294 
rg‘³¹h»ad³rms
 = 
rg‘³¹h»ad
 / 1000.0;

297 
Th»ad
 
w¬nšgth»ad
 = 
	`£tupW¬nšgTh»ad
();

298 
w¬nšgth»ad
.
	`¡¬t
();

300 
M—su»m’ts
.
	`£tPrİ”t›s
(
´İs
);

302 
WÜklßd
 
wÜklßd
 = 
	`g‘WÜklßd
(
´İs
);

304 
fš®
 
T¿ûr
 
Œaûr
 = 
	`g‘T¿ûr
(
´İs
, 
wÜklßd
);

306 
	`š™WÜklßd
(
´İs
, 
w¬nšgth»ad
, 
wÜklßd
, 
Œaûr
);

308 
Sy¡em
.
”r
.
	`´šn
("Startingest.");

309 
fš®
 
CouÁDownL©ch
 
com¶‘eL©ch
 = 
Ãw
 
	`CouÁDownL©ch
(
th»adcouÁ
);

311 
fš®
 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
 = 
	`š™Db
(
dbÇme
, 
´İs
, 
th»adcouÁ
, 
rg‘³¹h»ad³rms
,

312 
wÜklßd
, 
Œaûr
, 
com¶‘eL©ch
);

314 ià(
¡©us
) {

315 
boŞ—n
 
¡ªd¬d¡©us
 = 
çl£
;

316 ià(
´İs
.
	`g‘Prİ”ty
(
M—su»m’ts
.
MEASUREMENT_TYPE_PROPERTY
, "").
	`com·»To
("timeseries") == 0) {

317 
¡ªd¬d¡©us
 = 
Œue
;

319 
¡©usIÁ”v®SecÚds
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("status.interval", "10"));

320 
boŞ—n
 
ŒackJVMSts
 = 
´İs
.
	`g‘Prİ”ty
(
M—su»m’ts
.
MEASUREMENT_TRACK_JVM_PROPERTY
,

321 
M—su»m’ts
.
MEASUREMENT_TRACK_JVM_PROPERTY_DEFAULT
).
	`equ®s
("true");

322 
¡©u¡h»ad
 = 
Ãw
 
	`StusTh»ad
(
com¶‘eL©ch
, 
ş›Ás
, 
Ïb–
, 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
,

323 
ŒackJVMSts
);

324 
¡©u¡h»ad
.
	`¡¬t
();

327 
Th»ad
 
‹rmš©Ü
 = 
nuÎ
;

328 
¡
;

329 
’
;

330 
İsDÚe
;

332 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_WORKLOAD_SPAN
)) {

334 
fš®
 
M­
<
Th»ad
, 
Cl›ÁTh»ad
> 
th»ads
 = 
Ãw
 
HashM­
<>(
th»adcouÁ
);

335 
Cl›ÁTh»ad
 
ş›Á
 : 
ş›Ás
) {

336 
th»ads
.
	`put
(
Ãw
 
	`Th»ad
(
Œaûr
.
	`w¿p
(
ş›Á
, "ClientThread")), client);

339 
¡
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

341 
Th»ad
 
t
 : 
th»ads
.
	`keyS‘
()) {

342 
t
.
	`¡¬t
();

345 ià(
maxExecutiÚTime
 > 0) {

346 
‹rmš©Ü
 = 
Ãw
 
	`T”mš©ÜTh»ad
(
maxExecutiÚTime
, 
th»ads
.
	`keyS‘
(), 
wÜklßd
);

347 
‹rmš©Ü
.
	`¡¬t
();

350 
İsDÚe
 = 0;

352 
M­
.
EÁry
<
Th»ad
, 
Cl›ÁTh»ad
> 
’Œy
 : 
th»ads
.
	`’ŒyS‘
()) {

353 
Œy
 {

354 
’Œy
.
	`g‘Key
().
	`još
();

355 
İsDÚe
 +ğ
’Œy
.
	`g‘V®ue
().
	`g‘OpsDÚe
();

356 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
ignÜed
) {

361 
’
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

364 
Œy
 {

365 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_CLEANUP_SPAN
)) {

367 ià(
‹rmš©Ü
 !ğ
nuÎ
 && !‹rmš©Ü.
	`isIÁ”ru±ed
()) {

368 
‹rmš©Ü
.
	`š‹¼u±
();

371 ià(
¡©us
) {

373 
¡©u¡h»ad
.
	`š‹¼u±
();

375 
Œy
 {

376 
¡©u¡h»ad
.
	`još
();

377 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
ignÜed
) {

382 
wÜklßd
.
	`ş—nup
();

384 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) {

385 
e
.
	`´štSckT¿û
();

386 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

387 
Sy¡em
.
	`ex™
(0);

390 
Œy
 {

391 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_EXPORT_MEASUREMENTS_SPAN
)) {

392 
	`expÜtM—su»m’ts
(
´İs
, 
İsDÚe
, 
’
 - 
¡
);

394 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

395 
Sy¡em
.
”r
.
	`´šn
("Could‚ÙƒxpÜˆm—su»m’ts,ƒ¼Ü: " + 
e
.
	`g‘Mes§ge
());

396 
e
.
	`´štSckT¿û
();

397 
Sy¡em
.
	`ex™
(-1);

400 
Sy¡em
.
	`ex™
(0);

401 
	}
}

403 
´iv©e
 
	gLi¡
<
	gCl›ÁTh»ad
> 
	$š™Db
(
SŒšg
 
dbÇme
, 
Prİ”t›s
 
´İs
, 
th»adcouÁ
,

404 
rg‘³¹h»ad³rms
, 
WÜklßd
 
wÜklßd
, 
T¿ûr
 
Œaûr
,

405 
CouÁDownL©ch
 
com¶‘eL©ch
) {

406 
boŞ—n
 
š™Faed
 = 
çl£
;

407 
boŞ—n
 
dÙ¿n§ùiÚs
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
DO_TRANSACTIONS_PROPERTY
, 
SŒšg
.v®ueOf(
Œue
)));

409 
fš®
 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
 = 
Ãw
 
A¼ayLi¡
<>(
th»adcouÁ
);

410 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_INIT_SPAN
)) {

411 
İcouÁ
;

412 ià(
dÙ¿n§ùiÚs
) {

413 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
OPERATION_COUNT_PROPERTY
, "0"));

415 ià(
´İs
.
	`cÚšsKey
(
INSERT_COUNT_PROPERTY
)) {

416 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
INSERT_COUNT_PROPERTY
, "0"));

418 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
RECORD_COUNT_PROPERTY
, 
DEFAULT_RECORD_COUNT
));

421 ià(
th»adcouÁ
 > 
İcouÁ
 && opcount > 0){

422 
th»adcouÁ
 = 
İcouÁ
;

423 
Sy¡em
.
out
.
	`´šn
("Warning:hehreadcount is biggerhan„ecordcount,hehreadcount will be„ecordcount!");

425 
th»adid
 = 0;h»adid < 
th»adcouÁ
;hreadid++) {

426 
DB
 
db
;

427 
Œy
 {

428 
db
 = 
DBFaùÜy
.
	`ÃwDB
(
dbÇme
, 
´İs
, 
Œaûr
);

429 } 
	`ÿtch
 (
UnknownDBExû±iÚ
 
e
) {

430 
Sy¡em
.
out
.
	`´šn
("UnknowÀDB " + 
dbÇme
);

431 
š™Faed
 = 
Œue
;

435 
th»adİcouÁ
 = 
İcouÁ
 / 
th»adcouÁ
;

438 ià(
th»adid
 < 
İcouÁ
 % 
th»adcouÁ
) {

439 ++
th»adİcouÁ
;

442 
Cl›ÁTh»ad
 
t
 = 
Ãw
 
	`Cl›ÁTh»ad
(
db
, 
dÙ¿n§ùiÚs
, 
wÜklßd
, 
´İs
, 
th»adİcouÁ
, 
rg‘³¹h»ad³rms
,

443 
com¶‘eL©ch
);

444 
t
.
	`£tTh»adId
(
th»adid
);

445 
t
.
	`£tTh»adCouÁ
(
th»adcouÁ
);

446 
ş›Ás
.
	`add
(
t
);

449 ià(
š™Faed
) {

450 
Sy¡em
.
”r
.
	`´šn
("Error initializing datastore bindings.");

451 
Sy¡em
.
	`ex™
(0);

454  
ş›Ás
;

455 
	}
}

457 
´iv©e
 
T¿ûr
 
	$g‘T¿ûr
(
Prİ”t›s
 
´İs
, 
WÜklßd
 
wÜklßd
) {

458  
Ãw
 
T¿ûr
.
	`Bud”
("YCSB " + 
wÜklßd
.
	`g‘CÏss
().
	`g‘Sim¶eName
())

459 .
	`cÚf
(
	`g‘HT¿ûCÚfigu¿tiÚ
(
´İs
))

460 .
	`bud
();

461 
	}
}

463 
´iv©e
 
	$š™WÜklßd
(
Prİ”t›s
 
´İs
, 
Th»ad
 
w¬nšgth»ad
, 
WÜklßd
 
wÜklßd
, 
T¿ûr
 
Œaûr
) {

464 
Œy
 {

465 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
CLIENT_WORKLOAD_INIT_SPAN
)) {

466 
wÜklßd
.
	`š™
(
´İs
);

467 
w¬nšgth»ad
.
	`š‹¼u±
();

469 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) {

470 
e
.
	`´štSckT¿û
();

471 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

472 
Sy¡em
.
	`ex™
(0);

474 
	}
}

476 
´iv©e
 
HT¿ûCÚfigu¿tiÚ
 
	$g‘HT¿ûCÚfigu¿tiÚ
(
Prİ”t›s
 
´İs
) {

477 
fš®
 
M­
<
SŒšg
, SŒšg> 
f‹»dPrİ”t›s
 = 
Ãw
 
HashM­
<>();

478 
SŒšg
 
key
 : 
´İs
.
	`¡ršgPrİ”tyNames
()) {

479 ià(
key
.
	`¡¬tsW™h
(
HTRACE_KEY_PREFIX
)) {

480 
f‹»dPrİ”t›s
.
	`put
(
key
.
	`sub¡ršg
(
HTRACE_KEY_PREFIX
.
	`Ëngth
()), 
´İs
.
	`g‘Prİ”ty
(key));

483  
HT¿ûCÚfigu¿tiÚ
.
	`äomM­
(
f‹»dPrİ”t›s
);

484 
	}
}

486 
´iv©e
 
Th»ad
 
	$£tupW¬nšgTh»ad
() {

490  
Ãw
 
	`Th»ad
() {

491 @
Ov”ride


492 
public
 
	`run
() {

493 
Œy
 {

494 
	`¦“p
(2000);

495 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

498 
Sy¡em
.
”r
.
	`´šn
(" (mightake‡ few minutes for†arge data sets)");

501 
	}
}

503 
´iv©e
 
WÜklßd
 
	$g‘WÜklßd
(
Prİ”t›s
 
´İs
) {

504 
CÏssLßd”
 
şassLßd”
 = 
Cl›Á
.
şass
.
	`g‘CÏssLßd”
();

506 
Œy
 {

507 
Prİ”t›s
 
´ojeùPrİ
 = 
Ãw
 
	`Prİ”t›s
();

508 
´ojeùPrİ
.
	`lßd
(
şassLßd”
.
	`g‘ResourûAsSŒ—m
("project.properties"));

509 
Sy¡em
.
”r
.
	`´šn
("YCSB Cl›Á " + 
´ojeùPrİ
.
	`g‘Prİ”ty
("version"));

510 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

511 
Sy¡em
.
”r
.
	`´šn
("Unableo„etrieve client version.");

514 
Sy¡em
.
”r
.
	`´šn
();

515 
Sy¡em
.
”r
.
	`´šn
("Loading workload...");

516 
Œy
 {

517 
CÏss
 
wÜklßdşass
 = 
şassLßd”
.
	`lßdCÏss
(
´İs
.
	`g‘Prİ”ty
(
WORKLOAD_PROPERTY
));

519  (
WÜklßd
è
wÜklßdşass
.
	`ÃwIn¡ªû
();

520 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

521 
e
.
	`´štSckT¿û
();

522 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

523 
Sy¡em
.
	`ex™
(0);

526  
nuÎ
;

527 
	}
}

529 
´iv©e
 
Prİ”t›s
 
	$·r£Argum’ts
(
SŒšg
[] 
¬gs
) {

530 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

531 
Sy¡em
.
”r
.
	`´št
("Command†ine:");

532 
SŒšg
 
¬g
 : 
¬gs
) {

533 
Sy¡em
.
”r
.
	`´št
(" " + 
¬g
);

535 
Sy¡em
.
”r
.
	`´šn
();

537 
Prİ”t›s
 
f•rİs
 = 
Ãw
 
	`Prİ”t›s
();

538 
¬gšdex
 = 0;

540 ià(
¬gs
.
Ëngth
 == 0) {

541 
	`u§geMes§ge
();

542 
Sy¡em
.
out
.
	`´šn
("At†east one‡rgument specifying‡ workload is„equired.");

543 
Sy¡em
.
	`ex™
(0);

546 
¬gs
[
¬gšdex
].
	`¡¬tsW™h
("-")) {

547 ià(
¬gs
[
¬gšdex
].
	`com·»To
("-threads") == 0) {

548 
¬gšdex
++;

549 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

550 
	`u§geMes§ge
();

551 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -threads.");

552 
Sy¡em
.
	`ex™
(0);

554 
tcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[
¬gšdex
]);

555 
´İs
.
	`£tPrİ”ty
(
THREAD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
tcouÁ
));

556 
¬gšdex
++;

557 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-target") == 0) {

558 
¬gšdex
++;

559 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

560 
	`u§geMes§ge
();

561 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -target.");

562 
Sy¡em
.
	`ex™
(0);

564 
‰¬g‘
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[
¬gšdex
]);

565 
´İs
.
	`£tPrİ”ty
(
TARGET_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
‰¬g‘
));

566 
¬gšdex
++;

567 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-load") == 0) {

568 
´İs
.
	`£tPrİ”ty
(
DO_TRANSACTIONS_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
çl£
));

569 
¬gšdex
++;

570 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-t") == 0) {

571 
´İs
.
	`£tPrİ”ty
(
DO_TRANSACTIONS_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
Œue
));

572 
¬gšdex
++;

573 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-s") == 0) {

574 
´İs
.
	`£tPrİ”ty
(
STATUS_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
Œue
));

575 
¬gšdex
++;

576 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-db") == 0) {

577 
¬gšdex
++;

578 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

579 
	`u§geMes§ge
();

580 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -db.");

581 
Sy¡em
.
	`ex™
(0);

583 
´İs
.
	`£tPrİ”ty
(
DB_PROPERTY
, 
¬gs
[
¬gšdex
]);

584 
¬gšdex
++;

585 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-l") == 0) {

586 
¬gšdex
++;

587 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

588 
	`u§geMes§ge
();

589 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -l.");

590 
Sy¡em
.
	`ex™
(0);

592 
´İs
.
	`£tPrİ”ty
(
LABEL_PROPERTY
, 
¬gs
[
¬gšdex
]);

593 
¬gšdex
++;

594 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-P") == 0) {

595 
¬gšdex
++;

596 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

597 
	`u§geMes§ge
();

598 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -P.");

599 
Sy¡em
.
	`ex™
(0);

601 
SŒšg
 
´İfe
 = 
¬gs
[
¬gšdex
];

602 
¬gšdex
++;

604 
Prİ”t›s
 
myf•rİs
 = 
Ãw
 
	`Prİ”t›s
();

605 
Œy
 {

606 
myf•rİs
.
	`lßd
(
Ãw
 
	`FeIÅutSŒ—m
(
´İfe
));

607 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

608 
Sy¡em
.
out
.
	`´šn
("UÇbËØİ’h´İ”t› f" + 
´İfe
);

609 
Sy¡em
.
out
.
	`´šn
(
e
.
	`g‘Mes§ge
());

610 
Sy¡em
.
	`ex™
(0);

614 
Enum”©iÚ
 
e
 = 
myf•rİs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

615 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

617 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
myf•rİs
.
	`g‘Prİ”ty
(prop));

620 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-p") == 0) {

621 
¬gšdex
++;

622 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

623 
	`u§geMes§ge
();

624 
Sy¡em
.
out
.
	`´šn
("Missing‡rgument value for -p");

625 
Sy¡em
.
	`ex™
(0);

627 
eq
 = 
¬gs
[
¬gšdex
].
	`šdexOf
('=');

628 ià(
eq
 < 0) {

629 
	`u§geMes§ge
();

630 
Sy¡em
.
out
.
	`´šn
("Argument '-p'ƒxpectedo be in key=value format (e.g., -p operationcount=99999)");

631 
Sy¡em
.
	`ex™
(0);

634 
SŒšg
 
Çme
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(0, 
eq
);

635 
SŒšg
 
v®ue
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(
eq
 + 1);

636 
´İs
.
	`put
(
Çme
, 
v®ue
);

637 
¬gšdex
++;

639 
	`u§geMes§ge
();

640 
Sy¡em
.
out
.
	`´šn
("UnknowÀİtiÚ " + 
¬gs
[
¬gšdex
]);

641 
Sy¡em
.
	`ex™
(0);

644 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

649 ià(
¬gšdex
 !ğ
¬gs
.
Ëngth
) {

650 
	`u§geMes§ge
();

651 ià(
¬gšdex
 < 
¬gs
.
Ëngth
) {

652 
Sy¡em
.
out
.
	`´šn
("An‡rgument value without corresponding‡rgument specifier (e.g., -p, -s) was found. "

653 + "Wex³ùed‡À¬gum’ˆ¥ecif›¸ªd in¡—d found " + 
¬gs
[
¬gšdex
]);

655 
Sy¡em
.
out
.
	`´šn
("An‡rgument specifier without corresponding value was found‡theƒnd ofhe supplied " +

658 
Sy¡em
.
	`ex™
(0);

664 
Enum”©iÚ
 
e
 = 
´İs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

665 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

667 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
´İs
.
	`g‘Prİ”ty
(prop));

670 
´İs
 = 
f•rİs
;

672 ià(!
	`checkRequœedPrİ”t›s
(
´İs
)) {

673 
Sy¡em
.
out
.
	`´šn
("Failed check„equired…roperties.");

674 
Sy¡em
.
	`ex™
(0);

677  
´İs
;

678 
	}
}

	@ClientThread.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

29 
public
 cÏs 
	cCl›ÁTh»ad
 
im¶em’ts
 
	mRuÂabË
 {

31 
´iv©e
 
fš®
 
CouÁDownL©ch
 
	mcom¶‘eL©ch
;

33 
´iv©e
 
boŞ—n
 
	m¥šSË•
;

34 
´iv©e
 
DB
 
	mdb
;

35 
´iv©e
 
boŞ—n
 
	mdÙ¿n§ùiÚs
;

36 
´iv©e
 
WÜklßd
 
	mwÜklßd
;

37 
´iv©e
 
	mİcouÁ
;

38 
´iv©e
 
	mrg‘OpsP”Ms
;

40 
´iv©e
 
	mİsdÚe
;

41 
´iv©e
 
	mth»adid
;

42 
´iv©e
 
	mth»adcouÁ
;

43 
´iv©e
 
Objeù
 
	mwÜklßd¡©e
;

44 
´iv©e
 
Prİ”t›s
 
	m´İs
;

45 
´iv©e
 
	mrg‘OpsTickNs
;

46 
´iv©e
 
fš®
 
M—su»m’ts
 
	mm—su»m’ts
;

59 
public
 
	$Cl›ÁTh»ad
(
DB
 
db
, 
boŞ—n
 
dÙ¿n§ùiÚs
, 
WÜklßd
 
wÜklßd
, 
Prİ”t›s
 
´İs
, 
İcouÁ
,

60 
rg‘³¹h»ad³rms
, 
CouÁDownL©ch
 
com¶‘eL©ch
) {

61 
this
.
db
 = db;

62 
this
.
dÙ¿n§ùiÚs
 = dotransactions;

63 
this
.
wÜklßd
 = workload;

64 
this
.
İcouÁ
 = opcount;

65 
İsdÚe
 = 0;

66 ià(
rg‘³¹h»ad³rms
 > 0) {

67 
rg‘OpsP”Ms
 = 
rg‘³¹h»ad³rms
;

68 
rg‘OpsTickNs
 = (è(1000000 / 
rg‘OpsP”Ms
);

70 
this
.
´İs
 =…rops;

71 
m—su»m’ts
 = 
M—su»m’ts
.
	`g‘M—su»m’ts
();

72 
¥šSË•
 = 
BoŞ—n
.
	`v®ueOf
(
this
.
´İs
.
	`g‘Prİ”ty
("spin.sleep", "false"));

73 
this
.
com¶‘eL©ch
 = completeLatch;

76 
public
 
	$£tTh»adId
(
fš®
 
th»adId
) {

77 
th»adid
 = 
th»adId
;

78 
	}
}

80 
public
 
	$£tTh»adCouÁ
(
fš®
 
th»adCouÁ
) {

81 
th»adcouÁ
 = 
th»adCouÁ
;

82 
	}
}

84 
public
 
	$g‘OpsDÚe
() {

85  
İsdÚe
;

86 
	}
}

88 @
Ov”ride


89 
public
 
	$run
() {

90 
Œy
 {

91 
db
.
	`š™
();

92 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

93 
e
.
	`´štSckT¿û
();

94 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

98 
Œy
 {

99 
wÜklßd¡©e
 = 
wÜklßd
.
	`š™Th»ad
(
´İs
, 
th»adid
, 
th»adcouÁ
);

100 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) {

101 
e
.
	`´štSckT¿û
();

102 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

112 ià((
rg‘OpsP”Ms
 > 0) && (targetOpsPerMs <= 1.0)) {

113 
¿ndomMšÜD–ay
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
((è
rg‘OpsTickNs
);

114 
	`¦“pUÁ
(
Sy¡em
.
	`ÇnoTime
(è+ 
¿ndomMšÜD–ay
);

116 
Œy
 {

117 ià(
dÙ¿n§ùiÚs
) {

118 
¡¬tTimeNªos
 = 
Sy¡em
.
	`ÇnoTime
();

120 ((
İcouÁ
 =ğ0è|| (
İsdÚe
 < opcouÁ)è&& !
wÜklßd
.
	`isStİReque¡ed
()) {

122 ià(!
wÜklßd
.
	`doT¿n§ùiÚ
(
db
, 
wÜklßd¡©e
)) {

126 
İsdÚe
++;

128 
	`thrÙeNªos
(
¡¬tTimeNªos
);

131 
¡¬tTimeNªos
 = 
Sy¡em
.
	`ÇnoTime
();

133 ((
İcouÁ
 =ğ0è|| (
İsdÚe
 < opcouÁ)è&& !
wÜklßd
.
	`isStİReque¡ed
()) {

135 ià(!
wÜklßd
.
	`doIn£¹
(
db
, 
wÜklßd¡©e
)) {

139 
İsdÚe
++;

141 
	`thrÙeNªos
(
¡¬tTimeNªos
);

144 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

145 
e
.
	`´štSckT¿û
();

146 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

147 
Sy¡em
.
	`ex™
(0);

150 
Œy
 {

151 
m—su»m’ts
.
	`£tIÁ’dedS¹TimeNs
(0);

152 
db
.
	`ş—nup
();

153 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

154 
e
.
	`´štSckT¿û
();

155 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

156 } 
fš®ly
 {

157 
com¶‘eL©ch
.
	`couÁDown
();

159 
	}
}

161 
´iv©e
 
	$¦“pUÁ
(
d—dlše
) {

162 
Sy¡em
.
	`ÇnoTime
(è< 
d—dlše
) {

163 ià(!
¥šSË•
) {

164 
LockSuµÜt
.
	`·rkNªos
(
d—dlše
 - 
Sy¡em
.
	`ÇnoTime
());

167 
	}
}

169 
´iv©e
 
	$thrÙeNªos
(
¡¬tTimeNªos
) {

171 ià(
rg‘OpsP”Ms
 > 0) {

173 
d—dlše
 = 
¡¬tTimeNªos
 + 
İsdÚe
 * 
rg‘OpsTickNs
;

174 
	`¦“pUÁ
(
d—dlše
);

175 
m—su»m’ts
.
	`£tIÁ’dedS¹TimeNs
(
d—dlše
);

177 
	}
}

182 
	$g‘OpsTodo
() {

183 
todo
 = 
İcouÁ
 - 
İsdÚe
;

184  
todo
 < 0 ? 0 :odo;

185 
	}
}

	@ClientThread.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

29 
public
 cÏs 
	cCl›ÁTh»ad
 
im¶em’ts
 
	mRuÂabË
 {

31 
´iv©e
 
fš®
 
CouÁDownL©ch
 
	mcom¶‘eL©ch
;

33 
´iv©e
 
boŞ—n
 
	m¥šSË•
;

34 
´iv©e
 
DB
 
	mdb
;

35 
´iv©e
 
boŞ—n
 
	mdÙ¿n§ùiÚs
;

36 
´iv©e
 
WÜklßd
 
	mwÜklßd
;

37 
´iv©e
 
	mİcouÁ
;

38 
´iv©e
 
	mrg‘OpsP”Ms
;

40 
´iv©e
 
	mİsdÚe
;

41 
´iv©e
 
	mth»adid
;

42 
´iv©e
 
	mth»adcouÁ
;

43 
´iv©e
 
Objeù
 
	mwÜklßd¡©e
;

44 
´iv©e
 
Prİ”t›s
 
	m´İs
;

45 
´iv©e
 
	mrg‘OpsTickNs
;

46 
´iv©e
 
fš®
 
M—su»m’ts
 
	mm—su»m’ts
;

59 
public
 
	$Cl›ÁTh»ad
(
DB
 
db
, 
boŞ—n
 
dÙ¿n§ùiÚs
, 
WÜklßd
 
wÜklßd
, 
Prİ”t›s
 
´İs
, 
İcouÁ
,

60 
rg‘³¹h»ad³rms
, 
CouÁDownL©ch
 
com¶‘eL©ch
) {

61 
this
.
db
 = db;

62 
this
.
dÙ¿n§ùiÚs
 = dotransactions;

63 
this
.
wÜklßd
 = workload;

64 
this
.
İcouÁ
 = opcount;

65 
İsdÚe
 = 0;

66 ià(
rg‘³¹h»ad³rms
 > 0) {

67 
rg‘OpsP”Ms
 = 
rg‘³¹h»ad³rms
;

68 
rg‘OpsTickNs
 = (è(1000000 / 
rg‘OpsP”Ms
);

70 
this
.
´İs
 =…rops;

71 
m—su»m’ts
 = 
M—su»m’ts
.
	`g‘M—su»m’ts
();

72 
¥šSË•
 = 
BoŞ—n
.
	`v®ueOf
(
this
.
´İs
.
	`g‘Prİ”ty
("spin.sleep", "false"));

73 
this
.
com¶‘eL©ch
 = completeLatch;

76 
public
 
	$£tTh»adId
(
fš®
 
th»adId
) {

77 
th»adid
 = 
th»adId
;

78 
	}
}

80 
public
 
	$£tTh»adCouÁ
(
fš®
 
th»adCouÁ
) {

81 
th»adcouÁ
 = 
th»adCouÁ
;

82 
	}
}

84 
public
 
	$g‘OpsDÚe
() {

85  
İsdÚe
;

86 
	}
}

88 @
Ov”ride


89 
public
 
	$run
() {

90 
Œy
 {

91 
db
.
	`š™
();

92 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

93 
e
.
	`´štSckT¿û
();

94 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

98 
Œy
 {

99 
wÜklßd¡©e
 = 
wÜklßd
.
	`š™Th»ad
(
´İs
, 
th»adid
, 
th»adcouÁ
);

100 } 
	`ÿtch
 (
WÜklßdExû±iÚ
 
e
) {

101 
e
.
	`´štSckT¿û
();

102 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

112 ià((
rg‘OpsP”Ms
 > 0) && (targetOpsPerMs <= 1.0)) {

113 
¿ndomMšÜD–ay
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
((è
rg‘OpsTickNs
);

114 
	`¦“pUÁ
(
Sy¡em
.
	`ÇnoTime
(è+ 
¿ndomMšÜD–ay
);

116 
Œy
 {

117 ià(
dÙ¿n§ùiÚs
) {

118 
¡¬tTimeNªos
 = 
Sy¡em
.
	`ÇnoTime
();

120 ((
İcouÁ
 =ğ0è|| (
İsdÚe
 < opcouÁ)è&& !
wÜklßd
.
	`isStİReque¡ed
()) {

122 ià(!
wÜklßd
.
	`doT¿n§ùiÚ
(
db
, 
wÜklßd¡©e
)) {

126 
İsdÚe
++;

128 
	`thrÙeNªos
(
¡¬tTimeNªos
);

131 
¡¬tTimeNªos
 = 
Sy¡em
.
	`ÇnoTime
();

133 ((
İcouÁ
 =ğ0è|| (
İsdÚe
 < opcouÁ)è&& !
wÜklßd
.
	`isStİReque¡ed
()) {

135 ià(!
wÜklßd
.
	`doIn£¹
(
db
, 
wÜklßd¡©e
)) {

139 
İsdÚe
++;

141 
	`thrÙeNªos
(
¡¬tTimeNªos
);

144 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

145 
e
.
	`´štSckT¿û
();

146 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

147 
Sy¡em
.
	`ex™
(0);

150 
Œy
 {

151 
m—su»m’ts
.
	`£tIÁ’dedS¹TimeNs
(0);

152 
db
.
	`ş—nup
();

153 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

154 
e
.
	`´štSckT¿û
();

155 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

156 } 
fš®ly
 {

157 
com¶‘eL©ch
.
	`couÁDown
();

159 
	}
}

161 
´iv©e
 
	$¦“pUÁ
(
d—dlše
) {

162 
Sy¡em
.
	`ÇnoTime
(è< 
d—dlše
) {

163 ià(!
¥šSË•
) {

164 
LockSuµÜt
.
	`·rkNªos
(
d—dlše
 - 
Sy¡em
.
	`ÇnoTime
());

167 
	}
}

169 
´iv©e
 
	$thrÙeNªos
(
¡¬tTimeNªos
) {

171 ià(
rg‘OpsP”Ms
 > 0) {

173 
d—dlše
 = 
¡¬tTimeNªos
 + 
İsdÚe
 * 
rg‘OpsTickNs
;

174 
	`¦“pUÁ
(
d—dlše
);

175 
m—su»m’ts
.
	`£tIÁ’dedS¹TimeNs
(
d—dlše
);

177 
	}
}

182 
	$g‘OpsTodo
() {

183 
todo
 = 
İcouÁ
 - 
İsdÚe
;

184  
todo
 < 0 ? 0 :odo;

185 
	}
}

	@CommandLine.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

22 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

23 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—mR—d”
;

26 
impÜt
 
	gjava
.
	gut
.*;

31 
public
 
fš®
 cÏs 
	cCommªdLše
 {

32 
´iv©e
 
	$CommªdLše
() {

36 
public
 
fš®
 
SŒšg
 
DEFAULT_DB
 = "site.ycsb.BasicDB";

38 
public
 
	$u§geMes§ge
() {

39 
Sy¡em
.
out
.
	`´šn
("YCSB Command Line Client");

40 
Sy¡em
.
out
.
	`´šn
("Usage: java site.ycsb.CommandLine [options]");

41 
Sy¡em
.
out
.
	`´šn
("Options:");

42 
Sy¡em
.
out
.
	`´šn
(" -P filename: Specify‡…roperty file");

43 
Sy¡em
.
out
.
	`´šn
(" -p‚ame=value: Specify‡…roperty value");

44 
Sy¡em
.
out
.
	`´šn
(" -db classname: Use‡ specified DB class (can‡lso sethe \"db\"…roperty)");

45 
Sy¡em
.
out
.
	`´šn
(" -tableablename: Useheable‚ame instead ofhe default \"" +

46 
CÜeWÜklßd
.
TABLENAME_PROPERTY_DEFAULT
 + "\"");

47 
Sy¡em
.
out
.
	`´šn
();

48 
	}
}

50 
public
 
	$h–p
() {

51 
Sy¡em
.
out
.
	`´šn
("Commands:");

52 
Sy¡em
.
out
.
	`´šn
("„ead key [field1 field2 ...] - Read‡„ecord");

53 
Sy¡em
.
out
.
	`´šn
(" scan key„ecordcount [field1 field2 ...] - Scan starting‡t key");

54 
Sy¡em
.
out
.
	`´šn
(" insert key‚ame1=value1 [name2=value2 ...] - Insert‡‚ew„ecord");

55 
Sy¡em
.
out
.
	`´šn
(" update key‚ame1=value1 [name2=value2 ...] - Update‡„ecord");

56 
Sy¡em
.
out
.
	`´šn
(" delete key - Delete‡„ecord");

57 
Sy¡em
.
out
.
	`´šn
("able [tablename] - Get or [set]he‚ame ofheable");

58 
Sy¡em
.
out
.
	`´šn
(" quit - Quit");

59 
	}
}

61 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

63 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

64 
Prİ”t›s
 
f•rİs
 = 
Ãw
 
	`Prİ”t›s
();

66 
	`·r£Argum’ts
(
¬gs
, 
´İs
, 
f•rİs
);

68 
Enum”©iÚ
 
e
 = 
´İs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

69 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

71 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
´İs
.
	`g‘Prİ”ty
(prop));

74 
´İs
 = 
f•rİs
;

76 
Sy¡em
.
out
.
	`´šn
("YCSB Command Line client");

77 
Sy¡em
.
out
.
	`´šn
("Type \"help\" for command†ine help");

78 
Sy¡em
.
out
.
	`´šn
("Start with \"-help\" for usage info");

80 
SŒšg
 
bË
 = 
´İs
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, CÜeWÜklßd.
TABLENAME_PROPERTY_DEFAULT
);

83 
SŒšg
 
dbÇme
 = 
´İs
.
	`g‘Prİ”ty
(
Cl›Á
.
DB_PROPERTY
, 
DEFAULT_DB
);

85 
CÏssLßd”
 
şassLßd”
 = 
CommªdLše
.
şass
.
	`g‘CÏssLßd”
();

87 
DB
 
db
 = 
nuÎ
;

89 
Œy
 {

90 
CÏss
 
dbşass
 = 
şassLßd”
.
	`lßdCÏss
(
dbÇme
);

91 
db
 = (
DB
è
dbşass
.
	`ÃwIn¡ªû
();

92 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

93 
e
.
	`´štSckT¿û
();

94 
Sy¡em
.
	`ex™
(0);

97 
db
.
	`£tPrİ”t›s
(
´İs
);

98 
Œy
 {

99 
db
.
	`š™
();

100 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

101 
e
.
	`´štSckT¿û
();

102 
Sy¡em
.
	`ex™
(0);

105 
Sy¡em
.
out
.
	`´šn
("Connected.");

108 
Bufã»dR—d”
 
br
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`IÅutSŒ—mR—d”
(
Sy¡em
.
š
));

112 
Sy¡em
.
out
.
	`´št
("> ");

114 
SŒšg
 
šput
 = 
nuÎ
;

116 
Œy
 {

117 
šput
 = 
br
.
	`»adLše
();

118 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

119 
e
.
	`´štSckT¿û
();

120 
Sy¡em
.
	`ex™
(1);

123 ià(
šput
.
	`com·»To
("") == 0) {

127 ià(
šput
.
	`com·»To
("help") == 0) {

128 
	`h–p
();

132 ià(
šput
.
	`com·»To
("quit") == 0) {

136 
SŒšg
[] 
tok’s
 = 
šput
.
	`¥l™
(" ");

138 
¡
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

140 ià(
tok’s
[0].
	`com·»To
("table") == 0) {

141 
	`hªdËTabË
(
tok’s
, 
bË
);

142 } ià(
tok’s
[0].
	`com·»To
("read") == 0) {

143 
	`hªdËR—d
(
tok’s
, 
bË
, 
db
);

144 } ià(
tok’s
[0].
	`com·»To
("scan") == 0) {

145 
	`hªdËSÿn
(
tok’s
, 
bË
, 
db
);

146 } ià(
tok’s
[0].
	`com·»To
("update") == 0) {

147 
	`hªdËUpd©e
(
tok’s
, 
bË
, 
db
);

148 } ià(
tok’s
[0].
	`com·»To
("insert") == 0) {

149 
	`hªdËIn£¹
(
tok’s
, 
bË
, 
db
);

150 } ià(
tok’s
[0].
	`com·»To
("delete") == 0) {

151 
	`hªdËD–‘e
(
tok’s
, 
bË
, 
db
);

153 
Sy¡em
.
out
.
	`´šn
("E¼Ü: unknowÀcommªd \"" + 
tok’s
[0] + "\"");

156 
Sy¡em
.
out
.
	`´šn
((Sy¡em.
	`cu¼’tTimeMlis
(è- 
¡
) + " ms");

158 
	}
}

160 
´iv©e
 
	$·r£Argum’ts
(
SŒšg
[] 
¬gs
, 
Prİ”t›s
 
´İs
, Prİ”t› 
f•rİs
) {

161 
¬gšdex
 = 0;

162 (
¬gšdex
 < 
¬gs
.
Ëngth
è&& (¬gs[¬gšdex].
	`¡¬tsW™h
("-"))) {

163 ià((
¬gs
[
¬gšdex
].
	`com·»To
("-help") == 0) ||

164 (
¬gs
[
¬gšdex
].
	`com·»To
("--help") == 0) ||

165 (
¬gs
[
¬gšdex
].
	`com·»To
("-?") == 0) ||

166 (
¬gs
[
¬gšdex
].
	`com·»To
("--?") == 0)) {

167 
	`u§geMes§ge
();

168 
Sy¡em
.
	`ex™
(0);

171 ià(
¬gs
[
¬gšdex
].
	`com·»To
("-db") == 0) {

172 
¬gšdex
++;

173 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

174 
	`u§geMes§ge
();

175 
Sy¡em
.
	`ex™
(0);

177 
´İs
.
	`£tPrİ”ty
(
Cl›Á
.
DB_PROPERTY
, 
¬gs
[
¬gšdex
]);

178 
¬gšdex
++;

179 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-P") == 0) {

180 
¬gšdex
++;

181 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

182 
	`u§geMes§ge
();

183 
Sy¡em
.
	`ex™
(0);

185 
SŒšg
 
´İfe
 = 
¬gs
[
¬gšdex
];

186 
¬gšdex
++;

188 
Prİ”t›s
 
myf•rİs
 = 
Ãw
 
	`Prİ”t›s
();

189 
Œy
 {

190 
myf•rİs
.
	`lßd
(
Ãw
 
	`FeIÅutSŒ—m
(
´İfe
));

191 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

192 
Sy¡em
.
out
.
	`´šn
(
e
.
	`g‘Mes§ge
());

193 
Sy¡em
.
	`ex™
(0);

196 
Enum”©iÚ
 
e
 = 
myf•rİs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

197 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

199 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
myf•rİs
.
	`g‘Prİ”ty
(prop));

202 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-p") == 0) {

203 
¬gšdex
++;

204 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

205 
	`u§geMes§ge
();

206 
Sy¡em
.
	`ex™
(0);

208 
eq
 = 
¬gs
[
¬gšdex
].
	`šdexOf
('=');

209 ià(
eq
 < 0) {

210 
	`u§geMes§ge
();

211 
Sy¡em
.
	`ex™
(0);

214 
SŒšg
 
Çme
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(0, 
eq
);

215 
SŒšg
 
v®ue
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(
eq
 + 1);

216 
´İs
.
	`put
(
Çme
, 
v®ue
);

217 
¬gšdex
++;

218 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-table") == 0) {

219 
¬gšdex
++;

220 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

221 
	`u§geMes§ge
();

222 
Sy¡em
.
	`ex™
(0);

224 
´İs
.
	`put
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, 
¬gs
[
¬gšdex
]);

226 
¬gšdex
++;

228 
Sy¡em
.
out
.
	`´šn
("UnknowÀİtiÚ " + 
¬gs
[
¬gšdex
]);

229 
	`u§geMes§ge
();

230 
Sy¡em
.
	`ex™
(0);

233 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

238 ià(
¬gšdex
 !ğ
¬gs
.
Ëngth
) {

239 
	`u§geMes§ge
();

240 
Sy¡em
.
	`ex™
(0);

242 
	}
}

244 
´iv©e
 
	$hªdËD–‘e
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

245 ià(
tok’s
.
Ëngth
 != 2) {

246 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"delete keyname\"");

248 
Stus
 
»t
 = 
db
.
	`d–‘e
(
bË
, 
tok’s
[1]);

249 
Sy¡em
.
out
.
	`´šn
("R‘uº„esuÉ: " + 
»t
.
	`g‘Name
());

251 
	}
}

253 
´iv©e
 
	$hªdËIn£¹
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

254 ià(
tok’s
.
Ëngth
 < 3) {

255 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"insert keyname‚ame1=value1 [name2=value2 ...]\"");

257 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<>();

259 
i
 = 2; i < 
tok’s
.
Ëngth
; i++) {

260 
SŒšg
[] 
nv
 = 
tok’s
[
i
].
	`¥l™
("=");

261 
v®ues
.
	`put
(
nv
[0], 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(nv[1]));

264 
Stus
 
»t
 = 
db
.
	`š£¹
(
bË
, 
tok’s
[1], 
v®ues
);

265 
Sy¡em
.
out
.
	`´šn
("ResuÉ: " + 
»t
.
	`g‘Name
());

267 
	}
}

269 
´iv©e
 
	$hªdËUpd©e
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

270 ià(
tok’s
.
Ëngth
 < 3) {

271 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"update keyname‚ame1=value1 [name2=value2 ...]\"");

273 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<>();

275 
i
 = 2; i < 
tok’s
.
Ëngth
; i++) {

276 
SŒšg
[] 
nv
 = 
tok’s
[
i
].
	`¥l™
("=");

277 
v®ues
.
	`put
(
nv
[0], 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(nv[1]));

280 
Stus
 
»t
 = 
db
.
	`upd©e
(
bË
, 
tok’s
[1], 
v®ues
);

281 
Sy¡em
.
out
.
	`´šn
("ResuÉ: " + 
»t
.
	`g‘Name
());

283 
	}
}

285 
´iv©e
 
	$hªdËSÿn
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

286 ià(
tok’s
.
Ëngth
 < 3) {

287 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"scan keyname scanlength [field1 field2 ...]\"");

289 
S‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

291 ià(
tok’s
.
Ëngth
 > 3) {

292 
f›lds
 = 
Ãw
 
HashS‘
<>();

294 
f›lds
.
	`addAÎ
(
A¼ays
.
	`asLi¡
(
tok’s
).
	`subLi¡
(3,ok’s.
Ëngth
));

297 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉs
 = 
Ãw
 Vector<>();

298 
Stus
 
»t
 = 
db
.
	`sÿn
(
bË
, 
tok’s
[1], 
IÁeg”
.
	`·r£IÁ
Ñok’s[2]), 
f›lds
, 
»suÉs
);

299 
Sy¡em
.
out
.
	`´šn
("ResuÉ: " + 
»t
.
	`g‘Name
());

300 
»cÜd
 = 0;

301 ià(
»suÉs
.
	`isEm±y
()) {

302 
Sy¡em
.
out
.
	`´šn
("0„ecords");

304 
Sy¡em
.
out
.
	`´šn
("--------------------------------");

306 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 : 
»suÉs
) {

307 
Sy¡em
.
out
.
	`´šn
("RecÜd " + (
»cÜd
++));

308 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’t
 : 
»suÉ
.
	`’ŒyS‘
()) {

309 
Sy¡em
.
out
.
	`´šn
(
’t
.
	`g‘Key
(è+ "=" +ƒÁ.
	`g‘V®ue
());

311 
Sy¡em
.
out
.
	`´šn
("--------------------------------");

314 
	}
}

316 
´iv©e
 
	$hªdËR—d
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

317 ià(
tok’s
.
Ëngth
 == 1) {

318 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"read keyname [field1 field2 ...]\"");

320 
S‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

322 ià(
tok’s
.
Ëngth
 > 2) {

323 
f›lds
 = 
Ãw
 
HashS‘
<>();

325 
f›lds
.
	`addAÎ
(
A¼ays
.
	`asLi¡
(
tok’s
).
	`subLi¡
(2,ok’s.
Ëngth
));

328 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

329 
Stus
 
»t
 = 
db
.
	`»ad
(
bË
, 
tok’s
[1], 
f›lds
, 
»suÉ
);

330 
Sy¡em
.
out
.
	`´šn
("R‘uº code: " + 
»t
.
	`g‘Name
());

331 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’t
 : 
»suÉ
.
	`’ŒyS‘
()) {

332 
Sy¡em
.
out
.
	`´šn
(
’t
.
	`g‘Key
(è+ "=" +ƒÁ.
	`g‘V®ue
());

335 
	}
}

337 
´iv©e
 
	$hªdËTabË
(
SŒšg
[] 
tok’s
, SŒšg 
bË
) {

338 ià(
tok’s
.
Ëngth
 == 1) {

339 
Sy¡em
.
out
.
	`´šn
("UsšgabË \"" + 
bË
 + "\"");

340 } ià(
tok’s
.
Ëngth
 == 2) {

341 
bË
 = 
tok’s
[1];

342 
Sy¡em
.
out
.
	`´šn
("UsšgabË \"" + 
bË
 + "\"");

344 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"tableablename\"");

346 
	}
}

	@CommandLine.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gCÜeWÜklßd
;

22 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

23 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—mR—d”
;

26 
impÜt
 
	gjava
.
	gut
.*;

31 
public
 
fš®
 cÏs 
	cCommªdLše
 {

32 
´iv©e
 
	$CommªdLše
() {

36 
public
 
fš®
 
SŒšg
 
DEFAULT_DB
 = "site.ycsb.BasicDB";

38 
public
 
	$u§geMes§ge
() {

39 
Sy¡em
.
out
.
	`´šn
("YCSB Command Line Client");

40 
Sy¡em
.
out
.
	`´šn
("Usage: java site.ycsb.CommandLine [options]");

41 
Sy¡em
.
out
.
	`´šn
("Options:");

42 
Sy¡em
.
out
.
	`´šn
(" -P filename: Specify‡…roperty file");

43 
Sy¡em
.
out
.
	`´šn
(" -p‚ame=value: Specify‡…roperty value");

44 
Sy¡em
.
out
.
	`´šn
(" -db classname: Use‡ specified DB class (can‡lso sethe \"db\"…roperty)");

45 
Sy¡em
.
out
.
	`´šn
(" -tableablename: Useheable‚ame instead ofhe default \"" +

46 
CÜeWÜklßd
.
TABLENAME_PROPERTY_DEFAULT
 + "\"");

47 
Sy¡em
.
out
.
	`´šn
();

48 
	}
}

50 
public
 
	$h–p
() {

51 
Sy¡em
.
out
.
	`´šn
("Commands:");

52 
Sy¡em
.
out
.
	`´šn
("„ead key [field1 field2 ...] - Read‡„ecord");

53 
Sy¡em
.
out
.
	`´šn
(" scan key„ecordcount [field1 field2 ...] - Scan starting‡t key");

54 
Sy¡em
.
out
.
	`´šn
(" insert key‚ame1=value1 [name2=value2 ...] - Insert‡‚ew„ecord");

55 
Sy¡em
.
out
.
	`´šn
(" update key‚ame1=value1 [name2=value2 ...] - Update‡„ecord");

56 
Sy¡em
.
out
.
	`´šn
(" delete key - Delete‡„ecord");

57 
Sy¡em
.
out
.
	`´šn
("able [tablename] - Get or [set]he‚ame ofheable");

58 
Sy¡em
.
out
.
	`´šn
(" quit - Quit");

59 
	}
}

61 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

63 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

64 
Prİ”t›s
 
f•rİs
 = 
Ãw
 
	`Prİ”t›s
();

66 
	`·r£Argum’ts
(
¬gs
, 
´İs
, 
f•rİs
);

68 
Enum”©iÚ
 
e
 = 
´İs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

69 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

71 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
´İs
.
	`g‘Prİ”ty
(prop));

74 
´İs
 = 
f•rİs
;

76 
Sy¡em
.
out
.
	`´šn
("YCSB Command Line client");

77 
Sy¡em
.
out
.
	`´šn
("Type \"help\" for command†ine help");

78 
Sy¡em
.
out
.
	`´šn
("Start with \"-help\" for usage info");

80 
SŒšg
 
bË
 = 
´İs
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, CÜeWÜklßd.
TABLENAME_PROPERTY_DEFAULT
);

83 
SŒšg
 
dbÇme
 = 
´İs
.
	`g‘Prİ”ty
(
Cl›Á
.
DB_PROPERTY
, 
DEFAULT_DB
);

85 
CÏssLßd”
 
şassLßd”
 = 
CommªdLše
.
şass
.
	`g‘CÏssLßd”
();

87 
DB
 
db
 = 
nuÎ
;

89 
Œy
 {

90 
CÏss
 
dbşass
 = 
şassLßd”
.
	`lßdCÏss
(
dbÇme
);

91 
db
 = (
DB
è
dbşass
.
	`ÃwIn¡ªû
();

92 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

93 
e
.
	`´štSckT¿û
();

94 
Sy¡em
.
	`ex™
(0);

97 
db
.
	`£tPrİ”t›s
(
´İs
);

98 
Œy
 {

99 
db
.
	`š™
();

100 } 
	`ÿtch
 (
DBExû±iÚ
 
e
) {

101 
e
.
	`´štSckT¿û
();

102 
Sy¡em
.
	`ex™
(0);

105 
Sy¡em
.
out
.
	`´šn
("Connected.");

108 
Bufã»dR—d”
 
br
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`IÅutSŒ—mR—d”
(
Sy¡em
.
š
));

112 
Sy¡em
.
out
.
	`´št
("> ");

114 
SŒšg
 
šput
 = 
nuÎ
;

116 
Œy
 {

117 
šput
 = 
br
.
	`»adLše
();

118 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

119 
e
.
	`´štSckT¿û
();

120 
Sy¡em
.
	`ex™
(1);

123 ià(
šput
.
	`com·»To
("") == 0) {

127 ià(
šput
.
	`com·»To
("help") == 0) {

128 
	`h–p
();

132 ià(
šput
.
	`com·»To
("quit") == 0) {

136 
SŒšg
[] 
tok’s
 = 
šput
.
	`¥l™
(" ");

138 
¡
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

140 ià(
tok’s
[0].
	`com·»To
("table") == 0) {

141 
	`hªdËTabË
(
tok’s
, 
bË
);

142 } ià(
tok’s
[0].
	`com·»To
("read") == 0) {

143 
	`hªdËR—d
(
tok’s
, 
bË
, 
db
);

144 } ià(
tok’s
[0].
	`com·»To
("scan") == 0) {

145 
	`hªdËSÿn
(
tok’s
, 
bË
, 
db
);

146 } ià(
tok’s
[0].
	`com·»To
("update") == 0) {

147 
	`hªdËUpd©e
(
tok’s
, 
bË
, 
db
);

148 } ià(
tok’s
[0].
	`com·»To
("insert") == 0) {

149 
	`hªdËIn£¹
(
tok’s
, 
bË
, 
db
);

150 } ià(
tok’s
[0].
	`com·»To
("delete") == 0) {

151 
	`hªdËD–‘e
(
tok’s
, 
bË
, 
db
);

153 
Sy¡em
.
out
.
	`´šn
("E¼Ü: unknowÀcommªd \"" + 
tok’s
[0] + "\"");

156 
Sy¡em
.
out
.
	`´šn
((Sy¡em.
	`cu¼’tTimeMlis
(è- 
¡
) + " ms");

158 
	}
}

160 
´iv©e
 
	$·r£Argum’ts
(
SŒšg
[] 
¬gs
, 
Prİ”t›s
 
´İs
, Prİ”t› 
f•rİs
) {

161 
¬gšdex
 = 0;

162 (
¬gšdex
 < 
¬gs
.
Ëngth
è&& (¬gs[¬gšdex].
	`¡¬tsW™h
("-"))) {

163 ià((
¬gs
[
¬gšdex
].
	`com·»To
("-help") == 0) ||

164 (
¬gs
[
¬gšdex
].
	`com·»To
("--help") == 0) ||

165 (
¬gs
[
¬gšdex
].
	`com·»To
("-?") == 0) ||

166 (
¬gs
[
¬gšdex
].
	`com·»To
("--?") == 0)) {

167 
	`u§geMes§ge
();

168 
Sy¡em
.
	`ex™
(0);

171 ià(
¬gs
[
¬gšdex
].
	`com·»To
("-db") == 0) {

172 
¬gšdex
++;

173 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

174 
	`u§geMes§ge
();

175 
Sy¡em
.
	`ex™
(0);

177 
´İs
.
	`£tPrİ”ty
(
Cl›Á
.
DB_PROPERTY
, 
¬gs
[
¬gšdex
]);

178 
¬gšdex
++;

179 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-P") == 0) {

180 
¬gšdex
++;

181 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

182 
	`u§geMes§ge
();

183 
Sy¡em
.
	`ex™
(0);

185 
SŒšg
 
´İfe
 = 
¬gs
[
¬gšdex
];

186 
¬gšdex
++;

188 
Prİ”t›s
 
myf•rİs
 = 
Ãw
 
	`Prİ”t›s
();

189 
Œy
 {

190 
myf•rİs
.
	`lßd
(
Ãw
 
	`FeIÅutSŒ—m
(
´İfe
));

191 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

192 
Sy¡em
.
out
.
	`´šn
(
e
.
	`g‘Mes§ge
());

193 
Sy¡em
.
	`ex™
(0);

196 
Enum”©iÚ
 
e
 = 
myf•rİs
.
	`´İ”tyNames
();ƒ.
	`hasMÜeEËm’ts
();) {

197 
SŒšg
 
´İ
 = (SŒšgè
e
.
	`ÃxtEËm’t
();

199 
f•rİs
.
	`£tPrİ”ty
(
´İ
, 
myf•rİs
.
	`g‘Prİ”ty
(prop));

202 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-p") == 0) {

203 
¬gšdex
++;

204 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

205 
	`u§geMes§ge
();

206 
Sy¡em
.
	`ex™
(0);

208 
eq
 = 
¬gs
[
¬gšdex
].
	`šdexOf
('=');

209 ià(
eq
 < 0) {

210 
	`u§geMes§ge
();

211 
Sy¡em
.
	`ex™
(0);

214 
SŒšg
 
Çme
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(0, 
eq
);

215 
SŒšg
 
v®ue
 = 
¬gs
[
¬gšdex
].
	`sub¡ršg
(
eq
 + 1);

216 
´İs
.
	`put
(
Çme
, 
v®ue
);

217 
¬gšdex
++;

218 } ià(
¬gs
[
¬gšdex
].
	`com·»To
("-table") == 0) {

219 
¬gšdex
++;

220 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

221 
	`u§geMes§ge
();

222 
Sy¡em
.
	`ex™
(0);

224 
´İs
.
	`put
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, 
¬gs
[
¬gšdex
]);

226 
¬gšdex
++;

228 
Sy¡em
.
out
.
	`´šn
("UnknowÀİtiÚ " + 
¬gs
[
¬gšdex
]);

229 
	`u§geMes§ge
();

230 
Sy¡em
.
	`ex™
(0);

233 ià(
¬gšdex
 >ğ
¬gs
.
Ëngth
) {

238 ià(
¬gšdex
 !ğ
¬gs
.
Ëngth
) {

239 
	`u§geMes§ge
();

240 
Sy¡em
.
	`ex™
(0);

242 
	}
}

244 
´iv©e
 
	$hªdËD–‘e
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

245 ià(
tok’s
.
Ëngth
 != 2) {

246 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"delete keyname\"");

248 
Stus
 
»t
 = 
db
.
	`d–‘e
(
bË
, 
tok’s
[1]);

249 
Sy¡em
.
out
.
	`´šn
("R‘uº„esuÉ: " + 
»t
.
	`g‘Name
());

251 
	}
}

253 
´iv©e
 
	$hªdËIn£¹
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

254 ià(
tok’s
.
Ëngth
 < 3) {

255 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"insert keyname‚ame1=value1 [name2=value2 ...]\"");

257 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<>();

259 
i
 = 2; i < 
tok’s
.
Ëngth
; i++) {

260 
SŒšg
[] 
nv
 = 
tok’s
[
i
].
	`¥l™
("=");

261 
v®ues
.
	`put
(
nv
[0], 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(nv[1]));

264 
Stus
 
»t
 = 
db
.
	`š£¹
(
bË
, 
tok’s
[1], 
v®ues
);

265 
Sy¡em
.
out
.
	`´šn
("ResuÉ: " + 
»t
.
	`g‘Name
());

267 
	}
}

269 
´iv©e
 
	$hªdËUpd©e
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

270 ià(
tok’s
.
Ëngth
 < 3) {

271 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"update keyname‚ame1=value1 [name2=value2 ...]\"");

273 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<>();

275 
i
 = 2; i < 
tok’s
.
Ëngth
; i++) {

276 
SŒšg
[] 
nv
 = 
tok’s
[
i
].
	`¥l™
("=");

277 
v®ues
.
	`put
(
nv
[0], 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(nv[1]));

280 
Stus
 
»t
 = 
db
.
	`upd©e
(
bË
, 
tok’s
[1], 
v®ues
);

281 
Sy¡em
.
out
.
	`´šn
("ResuÉ: " + 
»t
.
	`g‘Name
());

283 
	}
}

285 
´iv©e
 
	$hªdËSÿn
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

286 ià(
tok’s
.
Ëngth
 < 3) {

287 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"scan keyname scanlength [field1 field2 ...]\"");

289 
S‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

291 ià(
tok’s
.
Ëngth
 > 3) {

292 
f›lds
 = 
Ãw
 
HashS‘
<>();

294 
f›lds
.
	`addAÎ
(
A¼ays
.
	`asLi¡
(
tok’s
).
	`subLi¡
(3,ok’s.
Ëngth
));

297 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉs
 = 
Ãw
 Vector<>();

298 
Stus
 
»t
 = 
db
.
	`sÿn
(
bË
, 
tok’s
[1], 
IÁeg”
.
	`·r£IÁ
Ñok’s[2]), 
f›lds
, 
»suÉs
);

299 
Sy¡em
.
out
.
	`´šn
("ResuÉ: " + 
»t
.
	`g‘Name
());

300 
»cÜd
 = 0;

301 ià(
»suÉs
.
	`isEm±y
()) {

302 
Sy¡em
.
out
.
	`´šn
("0„ecords");

304 
Sy¡em
.
out
.
	`´šn
("--------------------------------");

306 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 : 
»suÉs
) {

307 
Sy¡em
.
out
.
	`´šn
("RecÜd " + (
»cÜd
++));

308 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’t
 : 
»suÉ
.
	`’ŒyS‘
()) {

309 
Sy¡em
.
out
.
	`´šn
(
’t
.
	`g‘Key
(è+ "=" +ƒÁ.
	`g‘V®ue
());

311 
Sy¡em
.
out
.
	`´šn
("--------------------------------");

314 
	}
}

316 
´iv©e
 
	$hªdËR—d
(
SŒšg
[] 
tok’s
, SŒšg 
bË
, 
DB
 
db
) {

317 ià(
tok’s
.
Ëngth
 == 1) {

318 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"read keyname [field1 field2 ...]\"");

320 
S‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

322 ià(
tok’s
.
Ëngth
 > 2) {

323 
f›lds
 = 
Ãw
 
HashS‘
<>();

325 
f›lds
.
	`addAÎ
(
A¼ays
.
	`asLi¡
(
tok’s
).
	`subLi¡
(2,ok’s.
Ëngth
));

328 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<>();

329 
Stus
 
»t
 = 
db
.
	`»ad
(
bË
, 
tok’s
[1], 
f›lds
, 
»suÉ
);

330 
Sy¡em
.
out
.
	`´šn
("R‘uº code: " + 
»t
.
	`g‘Name
());

331 
M­
.
EÁry
<
SŒšg
, 
By‹I‹¿tÜ
> 
’t
 : 
»suÉ
.
	`’ŒyS‘
()) {

332 
Sy¡em
.
out
.
	`´šn
(
’t
.
	`g‘Key
(è+ "=" +ƒÁ.
	`g‘V®ue
());

335 
	}
}

337 
´iv©e
 
	$hªdËTabË
(
SŒšg
[] 
tok’s
, SŒšg 
bË
) {

338 ià(
tok’s
.
Ëngth
 == 1) {

339 
Sy¡em
.
out
.
	`´šn
("UsšgabË \"" + 
bË
 + "\"");

340 } ià(
tok’s
.
Ëngth
 == 2) {

341 
bË
 = 
tok’s
[1];

342 
Sy¡em
.
out
.
	`´šn
("UsšgabË \"" + 
bË
 + "\"");

344 
Sy¡em
.
out
.
	`´šn
("Error: syntax is \"tableablename\"");

346 
	}
}

	@DB.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

45 
public
 
ab¡¿ù
 cÏs 
	cDB
 {

49 
´iv©e
 
Prİ”t›s
 
	m´İ”t›s
 = 
Ãw
 Properties();

54 
public
 
	$£tPrİ”t›s
(
Prİ”t›s
 
p
) {

55 
´İ”t›s
 = 
p
;

62 
public
 
Prİ”t›s
 
	$g‘Prİ”t›s
() {

63  
´İ”t›s
;

64 
	}
}

70 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

71 
	}
}

77 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

78 
	}
}

89 
public
 
ab¡¿ù
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
);

102 
public
 
ab¡¿ù
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

103 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
);

114 
public
 
ab¡¿ù
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
);

125 
public
 
ab¡¿ù
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
);

134 
public
 
ab¡¿ù
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
);

	@DB.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

45 
public
 
ab¡¿ù
 cÏs 
	cDB
 {

49 
´iv©e
 
Prİ”t›s
 
	m´İ”t›s
 = 
Ãw
 Properties();

54 
public
 
	$£tPrİ”t›s
(
Prİ”t›s
 
p
) {

55 
´İ”t›s
 = 
p
;

62 
public
 
Prİ”t›s
 
	$g‘Prİ”t›s
() {

63  
´İ”t›s
;

64 
	}
}

70 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

71 
	}
}

77 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

78 
	}
}

89 
public
 
ab¡¿ù
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
);

102 
public
 
ab¡¿ù
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

103 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
);

114 
public
 
ab¡¿ù
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
);

125 
public
 
ab¡¿ù
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
);

134 
public
 
ab¡¿ù
 
Stus
 
d–‘e
(
SŒšg
 
bË
, SŒšg 
key
);

	@DBException.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cDBExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

27 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 6646883591588721475L;

29 
public
 
	$DBExû±iÚ
(
SŒšg
 
mes§ge
) {

30 
	`su³r
(
mes§ge
);

33 
public
 
	$DBExû±iÚ
() {

34 
	`su³r
();

35 
	}
}

37 
public
 
	$DBExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

38 
	`su³r
(
mes§ge
, 
ÿu£
);

39 
	}
}

41 
public
 
	$DBExû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@DBException.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cDBExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

27 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 6646883591588721475L;

29 
public
 
	$DBExû±iÚ
(
SŒšg
 
mes§ge
) {

30 
	`su³r
(
mes§ge
);

33 
public
 
	$DBExû±iÚ
() {

34 
	`su³r
();

35 
	}
}

37 
public
 
	$DBExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

38 
	`su³r
(
mes§ge
, 
ÿu£
);

39 
	}
}

41 
public
 
	$DBExû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@DBFactory.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûr
;

22 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

27 
public
 
fš®
 cÏs 
	cDBFaùÜy
 {

28 
´iv©e
 
	$DBFaùÜy
() {

32 
public
 
DB
 
	$ÃwDB
(
SŒšg
 
dbÇme
, 
Prİ”t›s
 
´İ”t›s
, 
fš®
 
T¿ûr
 
Œaûr
è
throws
 
UnknownDBExû±iÚ
 {

33 
CÏssLßd”
 
şassLßd”
 = 
DBFaùÜy
.
şass
.
	`g‘CÏssLßd”
();

35 
DB
 
»t
;

37 
Œy
 {

38 
CÏss
 
dbşass
 = 
şassLßd”
.
	`lßdCÏss
(
dbÇme
);

40 
»t
 = (
DB
è
dbşass
.
	`ÃwIn¡ªû
();

41 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

42 
e
.
	`´štSckT¿û
();

43  
nuÎ
;

46 
»t
.
	`£tPrİ”t›s
(
´İ”t›s
);

48  
Ãw
 
	`DBW¿µ”
(
»t
, 
Œaûr
);

49 
	}
}

	@DBFactory.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûr
;

22 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

27 
public
 
fš®
 cÏs 
	cDBFaùÜy
 {

28 
´iv©e
 
	$DBFaùÜy
() {

32 
public
 
DB
 
	$ÃwDB
(
SŒšg
 
dbÇme
, 
Prİ”t›s
 
´İ”t›s
, 
fš®
 
T¿ûr
 
Œaûr
è
throws
 
UnknownDBExû±iÚ
 {

33 
CÏssLßd”
 
şassLßd”
 = 
DBFaùÜy
.
şass
.
	`g‘CÏssLßd”
();

35 
DB
 
»t
;

37 
Œy
 {

38 
CÏss
 
dbşass
 = 
şassLßd”
.
	`lßdCÏss
(
dbÇme
);

40 
»t
 = (
DB
è
dbşass
.
	`ÃwIn¡ªû
();

41 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

42 
e
.
	`´štSckT¿û
();

43  
nuÎ
;

46 
»t
.
	`£tPrİ”t›s
(
´İ”t›s
);

48  
Ãw
 
	`DBW¿µ”
(
»t
, 
Œaûr
);

49 
	}
}

	@DBWrapper.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûScİe
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûr
;

26 
impÜt
 
	gjava
.
	gut
.*;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

33 
public
 cÏs 
	cDBW¿µ”
 
ex‹nds
 
	mDB
 {

34 
´iv©e
 
fš®
 
DB
 
	mdb
;

35 
´iv©e
 
fš®
 
M—su»m’ts
 
	mm—su»m’ts
;

36 
´iv©e
 
fš®
 
T¿ûr
 
	mŒaûr
;

38 
´iv©e
 
boŞ—n
 
	m»pÜtL©’cyFÜEachE¼Ü
 = 
çl£
;

39 
´iv©e
 
	mS‘
<
	mSŒšg
> 
	mÏ‹ncyT¿ckedE¼Üs
 = 
Ãw
 
HashS‘
<
SŒšg
>();

41 
´iv©e
 
fš®
 
SŒšg
 
	mREPORT_LATENCY_FOR_EACH_ERROR_PROPERTY
 = "reportlatencyforeacherror";

42 
´iv©e
 
fš®
 
SŒšg
 
	mREPORT_LATENCY_FOR_EACH_ERROR_PROPERTY_DEFAULT
 = "false";

44 
´iv©e
 
fš®
 
SŒšg
 
	mLATENCY_TRACKED_ERRORS_PROPERTY
 = "latencytrackederrors";

46 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	mLOG_REPORT_CONFIG
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

48 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgCËªup
;

49 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgD–‘e
;

50 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgIn™
;

51 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgIn£¹
;

52 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgR—d
;

53 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgSÿn
;

54 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgUpd©e
;

56 
public
 
	$DBW¿µ”
(
fš®
 
DB
 
db
, fš® 
T¿ûr
 
Œaûr
) {

57 
this
.
db
 = db;

58 
m—su»m’ts
 = 
M—su»m’ts
.
	`g‘M—su»m’ts
();

59 
this
.
Œaûr
 =racer;

60 
fš®
 
SŒšg
 
sim¶e
 = 
db
.
	`g‘CÏss
().
	`g‘Sim¶eName
();

61 
scİeSŒšgCËªup
 = 
sim¶e
 + "#cleanup";

62 
scİeSŒšgD–‘e
 = 
sim¶e
 + "#delete";

63 
scİeSŒšgIn™
 = 
sim¶e
 + "#init";

64 
scİeSŒšgIn£¹
 = 
sim¶e
 + "#insert";

65 
scİeSŒšgR—d
 = 
sim¶e
 + "#read";

66 
scİeSŒšgSÿn
 = 
sim¶e
 + "#scan";

67 
scİeSŒšgUpd©e
 = 
sim¶e
 + "#update";

73 
public
 
	$£tPrİ”t›s
(
Prİ”t›s
 
p
) {

74 
db
.
	`£tPrİ”t›s
(
p
);

75 
	}
}

80 
public
 
Prİ”t›s
 
	$g‘Prİ”t›s
() {

81  
db
.
	`g‘Prİ”t›s
();

82 
	}
}

88 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

89 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
scİeSŒšgIn™
)) {

90 
db
.
	`š™
();

92 
this
.
»pÜtL©’cyFÜEachE¼Ü
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().

93 
	`g‘Prİ”ty
(
REPORT_LATENCY_FOR_EACH_ERROR_PROPERTY
,

94 
REPORT_LATENCY_FOR_EACH_ERROR_PROPERTY_DEFAULT
));

96 ià(!
»pÜtL©’cyFÜEachE¼Ü
) {

97 
SŒšg
 
Ï‹ncyT¿ckedE¼ÜsPrİ”ty
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
LATENCY_TRACKED_ERRORS_PROPERTY
, 
nuÎ
);

98 ià(
Ï‹ncyT¿ckedE¼ÜsPrİ”ty
 !ğ
nuÎ
) {

99 
this
.
Ï‹ncyT¿ckedE¼Üs
 = 
Ãw
 
HashS‘
<
SŒšg
>(
A¼ays
.
	`asLi¡
(

100 
Ï‹ncyT¿ckedE¼ÜsPrİ”ty
.
	`¥l™
(",")));

104 ià(
LOG_REPORT_CONFIG
.
	`com·»AndS‘
(
çl£
, 
Œue
)) {

105 
Sy¡em
.
”r
.
	`´šn
("DBWrapper:„eport†atency forƒachƒrror is " +

106 
this
.
»pÜtL©’cyFÜEachE¼Ü
 + "‡nd specificƒrror codesorack" +

107 " fÜ†©’cy‡»: " + 
this
.
Ï‹ncyT¿ckedE¼Üs
.
	`toSŒšg
());

110 
	}
}

116 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

117 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
scİeSŒšgCËªup
)) {

118 
i¡
 = 
m—su»m’ts
.
	`g‘IÁ’dedS¹TimeNs
();

119 
¡
 = 
Sy¡em
.
	`ÇnoTime
();

120 
db
.
	`ş—nup
();

121 
’
 = 
Sy¡em
.
	`ÇnoTime
();

122 
	`m—su»
("CLEANUP", 
Stus
.
OK
, 
i¡
, 
¡
, 
’
);

124 
	}
}

136 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

137 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

138 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgR—d
)) {

139 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

140 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

141 
Stus
 
	g»s
 = 
db
.
»ad
(
bË
, 
key
, 
f›lds
, 
»suÉ
);

142 
	g’
 = 
Sy¡em
.
ÇnoTime
();

143 
m—su»
("READ", 
»s
, 
i¡
, 
¡
, 
’
);

144 
	gm—su»m’ts
.
»pÜtStus
("READ", 
»s
);

145  
	g»s
;

160 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

161 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

162 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgSÿn
)) {

163 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

164 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

165 
Stus
 
	g»s
 = 
db
.
sÿn
(
bË
, 
¡¬tkey
, 
»cÜdcouÁ
, 
f›lds
, 
»suÉ
);

166 
	g’
 = 
Sy¡em
.
ÇnoTime
();

167 
m—su»
("SCAN", 
»s
, 
i¡
, 
¡
, 
’
);

168 
	gm—su»m’ts
.
»pÜtStus
("SCAN", 
»s
);

169  
	g»s
;

173 
´iv©e
 
	$m—su»
(
SŒšg
 
İ
, 
Stus
 
»suÉ
, 
š‹ndedS¹TimeNªos
,

174 
¡¬tTimeNªos
, 
’dTimeNªos
) {

175 
SŒšg
 
m—su»m’tName
 = 
İ
;

176 ià(
»suÉ
 =ğ
nuÎ
 || !»suÉ.
	`isOk
()) {

177 ià(
this
.
»pÜtL©’cyFÜEachE¼Ü
 ||

178 
this
.
Ï‹ncyT¿ckedE¼Üs
.
	`cÚšs
(
»suÉ
.
	`g‘Name
())) {

179 
m—su»m’tName
 = 
İ
 + "-" + 
»suÉ
.
	`g‘Name
();

181 
m—su»m’tName
 = 
İ
 + "-FAILED";

184 
m—su»m’ts
.
	`m—su»
(
m—su»m’tName
,

185 (è((
’dTimeNªos
 - 
¡¬tTimeNªos
) / 1000));

186 
m—su»m’ts
.
	`m—su»IÁ’ded
(
m—su»m’tName
,

187 (è((
’dTimeNªos
 - 
š‹ndedS¹TimeNªos
) / 1000));

188 
	}
}

199 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

200 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

201 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgUpd©e
)) {

202 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

203 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

204 
Stus
 
	g»s
 = 
db
.
upd©e
(
bË
, 
key
, 
v®ues
);

205 
	g’
 = 
Sy¡em
.
ÇnoTime
();

206 
m—su»
("UPDATE", 
»s
, 
i¡
, 
¡
, 
’
);

207 
	gm—su»m’ts
.
»pÜtStus
("UPDATE", 
»s
);

208  
	g»s
;

222 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

223 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

224 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgIn£¹
)) {

225 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

226 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

227 
Stus
 
	g»s
 = 
db
.
š£¹
(
bË
, 
key
, 
v®ues
);

228 
	g’
 = 
Sy¡em
.
ÇnoTime
();

229 
m—su»
("INSERT", 
»s
, 
i¡
, 
¡
, 
’
);

230 
	gm—su»m’ts
.
»pÜtStus
("INSERT", 
»s
);

231  
	g»s
;

242 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

243 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
scİeSŒšgD–‘e
)) {

244 
i¡
 = 
m—su»m’ts
.
	`g‘IÁ’dedS¹TimeNs
();

245 
¡
 = 
Sy¡em
.
	`ÇnoTime
();

246 
Stus
 
»s
 = 
db
.
	`d–‘e
(
bË
, 
key
);

247 
’
 = 
Sy¡em
.
	`ÇnoTime
();

248 
	`m—su»
("DELETE", 
»s
, 
i¡
, 
¡
, 
’
);

249 
m—su»m’ts
.
	`»pÜtStus
("DELETE", 
»s
);

250  
»s
;

252 
	}
}

	@DBWrapper.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûScİe
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghŒaû
.
	gcÜe
.
	gT¿ûr
;

26 
impÜt
 
	gjava
.
	gut
.*;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

33 
public
 cÏs 
	cDBW¿µ”
 
ex‹nds
 
	mDB
 {

34 
´iv©e
 
fš®
 
DB
 
	mdb
;

35 
´iv©e
 
fš®
 
M—su»m’ts
 
	mm—su»m’ts
;

36 
´iv©e
 
fš®
 
T¿ûr
 
	mŒaûr
;

38 
´iv©e
 
boŞ—n
 
	m»pÜtL©’cyFÜEachE¼Ü
 = 
çl£
;

39 
´iv©e
 
	mS‘
<
	mSŒšg
> 
	mÏ‹ncyT¿ckedE¼Üs
 = 
Ãw
 
HashS‘
<
SŒšg
>();

41 
´iv©e
 
fš®
 
SŒšg
 
	mREPORT_LATENCY_FOR_EACH_ERROR_PROPERTY
 = "reportlatencyforeacherror";

42 
´iv©e
 
fš®
 
SŒšg
 
	mREPORT_LATENCY_FOR_EACH_ERROR_PROPERTY_DEFAULT
 = "false";

44 
´iv©e
 
fš®
 
SŒšg
 
	mLATENCY_TRACKED_ERRORS_PROPERTY
 = "latencytrackederrors";

46 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	mLOG_REPORT_CONFIG
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

48 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgCËªup
;

49 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgD–‘e
;

50 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgIn™
;

51 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgIn£¹
;

52 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgR—d
;

53 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgSÿn
;

54 
´iv©e
 
fš®
 
SŒšg
 
	mscİeSŒšgUpd©e
;

56 
public
 
	$DBW¿µ”
(
fš®
 
DB
 
db
, fš® 
T¿ûr
 
Œaûr
) {

57 
this
.
db
 = db;

58 
m—su»m’ts
 = 
M—su»m’ts
.
	`g‘M—su»m’ts
();

59 
this
.
Œaûr
 =racer;

60 
fš®
 
SŒšg
 
sim¶e
 = 
db
.
	`g‘CÏss
().
	`g‘Sim¶eName
();

61 
scİeSŒšgCËªup
 = 
sim¶e
 + "#cleanup";

62 
scİeSŒšgD–‘e
 = 
sim¶e
 + "#delete";

63 
scİeSŒšgIn™
 = 
sim¶e
 + "#init";

64 
scİeSŒšgIn£¹
 = 
sim¶e
 + "#insert";

65 
scİeSŒšgR—d
 = 
sim¶e
 + "#read";

66 
scİeSŒšgSÿn
 = 
sim¶e
 + "#scan";

67 
scİeSŒšgUpd©e
 = 
sim¶e
 + "#update";

73 
public
 
	$£tPrİ”t›s
(
Prİ”t›s
 
p
) {

74 
db
.
	`£tPrİ”t›s
(
p
);

75 
	}
}

80 
public
 
Prİ”t›s
 
	$g‘Prİ”t›s
() {

81  
db
.
	`g‘Prİ”t›s
();

82 
	}
}

88 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

89 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
scİeSŒšgIn™
)) {

90 
db
.
	`š™
();

92 
this
.
»pÜtL©’cyFÜEachE¼Ü
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().

93 
	`g‘Prİ”ty
(
REPORT_LATENCY_FOR_EACH_ERROR_PROPERTY
,

94 
REPORT_LATENCY_FOR_EACH_ERROR_PROPERTY_DEFAULT
));

96 ià(!
»pÜtL©’cyFÜEachE¼Ü
) {

97 
SŒšg
 
Ï‹ncyT¿ckedE¼ÜsPrİ”ty
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
LATENCY_TRACKED_ERRORS_PROPERTY
, 
nuÎ
);

98 ià(
Ï‹ncyT¿ckedE¼ÜsPrİ”ty
 !ğ
nuÎ
) {

99 
this
.
Ï‹ncyT¿ckedE¼Üs
 = 
Ãw
 
HashS‘
<
SŒšg
>(
A¼ays
.
	`asLi¡
(

100 
Ï‹ncyT¿ckedE¼ÜsPrİ”ty
.
	`¥l™
(",")));

104 ià(
LOG_REPORT_CONFIG
.
	`com·»AndS‘
(
çl£
, 
Œue
)) {

105 
Sy¡em
.
”r
.
	`´šn
("DBWrapper:„eport†atency forƒachƒrror is " +

106 
this
.
»pÜtL©’cyFÜEachE¼Ü
 + "‡nd specificƒrror codesorack" +

107 " fÜ†©’cy‡»: " + 
this
.
Ï‹ncyT¿ckedE¼Üs
.
	`toSŒšg
());

110 
	}
}

116 
public
 
	$ş—nup
(è
throws
 
DBExû±iÚ
 {

117 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
scİeSŒšgCËªup
)) {

118 
i¡
 = 
m—su»m’ts
.
	`g‘IÁ’dedS¹TimeNs
();

119 
¡
 = 
Sy¡em
.
	`ÇnoTime
();

120 
db
.
	`ş—nup
();

121 
’
 = 
Sy¡em
.
	`ÇnoTime
();

122 
	`m—su»
("CLEANUP", 
Stus
.
OK
, 
i¡
, 
¡
, 
’
);

124 
	}
}

136 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
,

137 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
) {

138 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgR—d
)) {

139 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

140 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

141 
Stus
 
	g»s
 = 
db
.
»ad
(
bË
, 
key
, 
f›lds
, 
»suÉ
);

142 
	g’
 = 
Sy¡em
.
ÇnoTime
();

143 
m—su»
("READ", 
»s
, 
i¡
, 
¡
, 
’
);

144 
	gm—su»m’ts
.
»pÜtStus
("READ", 
»s
);

145  
	g»s
;

160 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
,

161 
S‘
<
SŒšg
> 
f›lds
, 
VeùÜ
<
HashM­
<SŒšg, 
By‹I‹¿tÜ
>> 
»suÉ
) {

162 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgSÿn
)) {

163 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

164 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

165 
Stus
 
	g»s
 = 
db
.
sÿn
(
bË
, 
¡¬tkey
, 
»cÜdcouÁ
, 
f›lds
, 
»suÉ
);

166 
	g’
 = 
Sy¡em
.
ÇnoTime
();

167 
m—su»
("SCAN", 
»s
, 
i¡
, 
¡
, 
’
);

168 
	gm—su»m’ts
.
»pÜtStus
("SCAN", 
»s
);

169  
	g»s
;

173 
´iv©e
 
	$m—su»
(
SŒšg
 
İ
, 
Stus
 
»suÉ
, 
š‹ndedS¹TimeNªos
,

174 
¡¬tTimeNªos
, 
’dTimeNªos
) {

175 
SŒšg
 
m—su»m’tName
 = 
İ
;

176 ià(
»suÉ
 =ğ
nuÎ
 || !»suÉ.
	`isOk
()) {

177 ià(
this
.
»pÜtL©’cyFÜEachE¼Ü
 ||

178 
this
.
Ï‹ncyT¿ckedE¼Üs
.
	`cÚšs
(
»suÉ
.
	`g‘Name
())) {

179 
m—su»m’tName
 = 
İ
 + "-" + 
»suÉ
.
	`g‘Name
();

181 
m—su»m’tName
 = 
İ
 + "-FAILED";

184 
m—su»m’ts
.
	`m—su»
(
m—su»m’tName
,

185 (è((
’dTimeNªos
 - 
¡¬tTimeNªos
) / 1000));

186 
m—su»m’ts
.
	`m—su»IÁ’ded
(
m—su»m’tName
,

187 (è((
’dTimeNªos
 - 
š‹ndedS¹TimeNªos
) / 1000));

188 
	}
}

199 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
,

200 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

201 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgUpd©e
)) {

202 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

203 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

204 
Stus
 
	g»s
 = 
db
.
upd©e
(
bË
, 
key
, 
v®ues
);

205 
	g’
 = 
Sy¡em
.
ÇnoTime
();

206 
m—su»
("UPDATE", 
»s
, 
i¡
, 
¡
, 
’
);

207 
	gm—su»m’ts
.
»pÜtStus
("UPDATE", 
»s
);

208  
	g»s
;

222 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
,

223 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
) {

224 
Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
ÃwScİe
(
scİeSŒšgIn£¹
)) {

225 
i¡
 = 
m—su»m’ts
.
g‘IÁ’dedS¹TimeNs
();

226 
	g¡
 = 
Sy¡em
.
ÇnoTime
();

227 
Stus
 
	g»s
 = 
db
.
š£¹
(
bË
, 
key
, 
v®ues
);

228 
	g’
 = 
Sy¡em
.
ÇnoTime
();

229 
m—su»
("INSERT", 
»s
, 
i¡
, 
¡
, 
’
);

230 
	gm—su»m’ts
.
»pÜtStus
("INSERT", 
»s
);

231  
	g»s
;

242 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

243 
	`Œy
 (
fš®
 
T¿ûScİe
 
¥ª
 = 
Œaûr
.
	`ÃwScİe
(
scİeSŒšgD–‘e
)) {

244 
i¡
 = 
m—su»m’ts
.
	`g‘IÁ’dedS¹TimeNs
();

245 
¡
 = 
Sy¡em
.
	`ÇnoTime
();

246 
Stus
 
»s
 = 
db
.
	`d–‘e
(
bË
, 
key
);

247 
’
 = 
Sy¡em
.
	`ÇnoTime
();

248 
	`m—su»
("DELETE", 
»s
, 
i¡
, 
¡
, 
’
);

249 
m—su»m’ts
.
	`»pÜtStus
("DELETE", 
»s
);

250  
»s
;

252 
	}
}

	@GoodBadUglyDB.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLock
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR—dWr™eLock
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁR—dWr™eLock
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
.
	gMICROSECONDS
;

36 
public
 cÏs 
	cGoodBadUglyDB
 
ex‹nds
 
	mDB
 {

37 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY
 = "gbudb.delays";

38 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY_DEFAULT
 = "200,1000,10000,50000,100000";

39 
´iv©e
 
fš®
 
R—dWr™eLock
 
	mDB_ACCESS
 = 
Ãw
 
R“Á¿ÁR—dWr™eLock
();

40 
´iv©e
 [] 
	md–ays
;

42 
public
 
	$GoodBadUglyDB
() {

43 
d–ays
 = 
Ãw
 []{200, 1000, 10000, 50000, 200000};

46 
´iv©e
 
	$d–ay
() {

47 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

48 
p
 = 
¿ndom
.
	`ÃxtDoubË
();

49 
mod
;

50 ià(
p
 < 0.9) {

51 
mod
 = 0;

52 } ià(
p
 < 0.99) {

53 
mod
 = 1;

54 } ià(
p
 < 0.9999) {

55 
mod
 = 2;

57 
mod
 = 3;

60 
Lock
 
lock
 = 
mod
 =ğ3 ? 
DB_ACCESS
.
	`wr™eLock
(è: DB_ACCESS.
	`»adLock
();

61 ià(
mod
 == 3) {

62 
Sy¡em
.
out
.
	`´šn
("OUCH");

64 
lock
.
	`lock
();

65 
Œy
 {

66 
fš®
 
ba£D–ayNs
 = 
MICROSECONDS
.
	`toNªos
(
d–ays
[
mod
]);

67 
fš®
 
d–ayRªgeNs
 = (è(
MICROSECONDS
.
	`toNªos
(
d–ays
[
mod
 + 1]è- 
ba£D–ayNs
);

68 
fš®
 
d–ayNs
 = 
ba£D–ayNs
 + 
¿ndom
.
	`ÃxtIÁ
(
d–ayRªgeNs
);

69 
fš®
 
d—dlše
 = 
Sy¡em
.
	`ÇnoTime
(è+ 
d–ayNs
;

71 
LockSuµÜt
.
	`·rkNªos
(
d—dlše
 - 
Sy¡em
.
	`ÇnoTime
());

72 } 
Sy¡em
.
	`ÇnoTime
(è< 
d—dlše
 && !
Th»ad
.
	`š‹¼u±ed
());

73 } 
fš®ly
 {

74 
lock
.
	`uÆock
();

77 
	}
}

82 
public
 
	$š™
() {

83 
i
 = 0;

84 
SŒšg
 
d–ay
 : 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
SIMULATE_DELAY
, 
SIMULATE_DELAY_DEFAULT
).
	`¥l™
(",")) {

85 
d–ays
[
i
++] = 
LÚg
.
	`·r£LÚg
(
d–ay
);

87 
	}
}

98 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

99 
d–ay
();

100  
	gStus
.
	gOK
;

114 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

115 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

116 
d–ay
();

118  
	gStus
.
	gOK
;

130 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

131 
d–ay
();

133  
	gStus
.
	gOK
;

145 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

146 
d–ay
();

147  
	gStus
.
	gOK
;

157 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

158 
	`d–ay
();

159  
Stus
.
OK
;

160 
	}
}

	@GoodBadUglyDB.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLock
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLockSuµÜt
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR—dWr™eLock
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁR—dWr™eLock
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
.
	gMICROSECONDS
;

36 
public
 cÏs 
	cGoodBadUglyDB
 
ex‹nds
 
	mDB
 {

37 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY
 = "gbudb.delays";

38 
public
 
fš®
 
SŒšg
 
	mSIMULATE_DELAY_DEFAULT
 = "200,1000,10000,50000,100000";

39 
´iv©e
 
fš®
 
R—dWr™eLock
 
	mDB_ACCESS
 = 
Ãw
 
R“Á¿ÁR—dWr™eLock
();

40 
´iv©e
 [] 
	md–ays
;

42 
public
 
	$GoodBadUglyDB
() {

43 
d–ays
 = 
Ãw
 []{200, 1000, 10000, 50000, 200000};

46 
´iv©e
 
	$d–ay
() {

47 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

48 
p
 = 
¿ndom
.
	`ÃxtDoubË
();

49 
mod
;

50 ià(
p
 < 0.9) {

51 
mod
 = 0;

52 } ià(
p
 < 0.99) {

53 
mod
 = 1;

54 } ià(
p
 < 0.9999) {

55 
mod
 = 2;

57 
mod
 = 3;

60 
Lock
 
lock
 = 
mod
 =ğ3 ? 
DB_ACCESS
.
	`wr™eLock
(è: DB_ACCESS.
	`»adLock
();

61 ià(
mod
 == 3) {

62 
Sy¡em
.
out
.
	`´šn
("OUCH");

64 
lock
.
	`lock
();

65 
Œy
 {

66 
fš®
 
ba£D–ayNs
 = 
MICROSECONDS
.
	`toNªos
(
d–ays
[
mod
]);

67 
fš®
 
d–ayRªgeNs
 = (è(
MICROSECONDS
.
	`toNªos
(
d–ays
[
mod
 + 1]è- 
ba£D–ayNs
);

68 
fš®
 
d–ayNs
 = 
ba£D–ayNs
 + 
¿ndom
.
	`ÃxtIÁ
(
d–ayRªgeNs
);

69 
fš®
 
d—dlše
 = 
Sy¡em
.
	`ÇnoTime
(è+ 
d–ayNs
;

71 
LockSuµÜt
.
	`·rkNªos
(
d—dlše
 - 
Sy¡em
.
	`ÇnoTime
());

72 } 
Sy¡em
.
	`ÇnoTime
(è< 
d—dlše
 && !
Th»ad
.
	`š‹¼u±ed
());

73 } 
fš®ly
 {

74 
lock
.
	`uÆock
();

77 
	}
}

82 
public
 
	$š™
() {

83 
i
 = 0;

84 
SŒšg
 
d–ay
 : 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
SIMULATE_DELAY
, 
SIMULATE_DELAY_DEFAULT
).
	`¥l™
(",")) {

85 
d–ays
[
i
++] = 
LÚg
.
	`·r£LÚg
(
d–ay
);

87 
	}
}

98 
public
 
Stus
 
»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

99 
d–ay
();

100  
	gStus
.
	gOK
;

114 
public
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

115 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

116 
d–ay
();

118  
	gStus
.
	gOK
;

130 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

131 
d–ay
();

133  
	gStus
.
	gOK
;

145 
public
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

146 
d–ay
();

147  
	gStus
.
	gOK
;

157 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

158 
	`d–ay
();

159  
Stus
.
OK
;

160 
	}
}

	@InputStreamByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

20 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

25 
public
 cÏs 
	cIÅutSŒ—mBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

26 
´iv©e
 
fš®
 
	mËn
;

27 
´iv©e
 
fš®
 
IÅutSŒ—m
 
	mšs
;

28 
´iv©e
 
	moff
;

29 
´iv©e
 
fš®
 
boŞ—n
 
	m»£bË
;

31 
public
 
	$IÅutSŒ—mBy‹I‹¿tÜ
(
IÅutSŒ—m
 
šs
, 
Ën
) {

32 
this
.
Ën
 =†en;

33 
this
.
šs
 = ins;

34 
off
 = 0;

35 
»£bË
 = 
šs
.
	`m¬kSuµÜ‹d
();

36 ià(
»£bË
) {

37 
šs
.
	`m¬k
((è
Ën
);

41 @
Ov”ride


42 
public
 
boŞ—n
 
	$hasNext
() {

43  
off
 < 
Ën
;

44 
	}
}

46 @
Ov”ride


47 
public
 
by‹
 
	$ÃxtBy‹
() {

48 
»t
;

49 
Œy
 {

50 
»t
 = 
šs
.
	`»ad
();

51 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

52 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
e
);

54 ià(
»t
 == -1) {

55 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Past EOF!");

57 
off
++;

58  (
by‹
è
»t
;

59 
	}
}

61 @
Ov”ride


62 
public
 
	$by‹sLeá
() {

63  
Ën
 - 
off
;

64 
	}
}

66 @
Ov”ride


67 
public
 
	gby‹
[] 
	$toA¼ay
() {

68 
size
 = (è
	`by‹sLeá
();

69 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
size
];

70 
Œy
 {

71 ià(
šs
.
	`»ad
(
by‹s
è< 
size
) {

72 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Past EOF!");

74 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

75 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
e
);

77 
off
 = 
Ën
;

78  
by‹s
;

79 
	}
}

81 @
Ov”ride


82 
public
 
	$»£t
() {

83 ià(
»£bË
) {

84 
Œy
 {

85 
šs
.
	`»£t
();

86 
šs
.
	`m¬k
((è
Ën
);

87 
off
 = 0;

88 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

89 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("FaedØ»£ˆthšpuˆ¡»am", 
e
);

92 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
();

94 
	}
}

	@InputStreamByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

20 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

25 
public
 cÏs 
	cIÅutSŒ—mBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

26 
´iv©e
 
fš®
 
	mËn
;

27 
´iv©e
 
fš®
 
IÅutSŒ—m
 
	mšs
;

28 
´iv©e
 
	moff
;

29 
´iv©e
 
fš®
 
boŞ—n
 
	m»£bË
;

31 
public
 
	$IÅutSŒ—mBy‹I‹¿tÜ
(
IÅutSŒ—m
 
šs
, 
Ën
) {

32 
this
.
Ën
 =†en;

33 
this
.
šs
 = ins;

34 
off
 = 0;

35 
»£bË
 = 
šs
.
	`m¬kSuµÜ‹d
();

36 ià(
»£bË
) {

37 
šs
.
	`m¬k
((è
Ën
);

41 @
Ov”ride


42 
public
 
boŞ—n
 
	$hasNext
() {

43  
off
 < 
Ën
;

44 
	}
}

46 @
Ov”ride


47 
public
 
by‹
 
	$ÃxtBy‹
() {

48 
»t
;

49 
Œy
 {

50 
»t
 = 
šs
.
	`»ad
();

51 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

52 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
e
);

54 ià(
»t
 == -1) {

55 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Past EOF!");

57 
off
++;

58  (
by‹
è
»t
;

59 
	}
}

61 @
Ov”ride


62 
public
 
	$by‹sLeá
() {

63  
Ën
 - 
off
;

64 
	}
}

66 @
Ov”ride


67 
public
 
	gby‹
[] 
	$toA¼ay
() {

68 
size
 = (è
	`by‹sLeá
();

69 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
size
];

70 
Œy
 {

71 ià(
šs
.
	`»ad
(
by‹s
è< 
size
) {

72 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Past EOF!");

74 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

75 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
e
);

77 
off
 = 
Ën
;

78  
by‹s
;

79 
	}
}

81 @
Ov”ride


82 
public
 
	$»£t
() {

83 ià(
»£bË
) {

84 
Œy
 {

85 
šs
.
	`»£t
();

86 
šs
.
	`m¬k
((è
Ën
);

87 
off
 = 0;

88 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

89 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("FaedØ»£ˆthšpuˆ¡»am", 
e
);

92 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
();

94 
	}
}

	@NumericByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

24 
public
 cÏs 
	cNum”icBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

25 
´iv©e
 
fš®
 
	mby‹
[] 
	m·ylßd
;

26 
´iv©e
 
fš®
 
boŞ—n
 
	mæßtšgPošt
;

27 
´iv©e
 
	moff
;

29 
public
 
	$Num”icBy‹I‹¿tÜ
(
fš®
 
v®ue
) {

30 
æßtšgPošt
 = 
çl£
;

31 
·ylßd
 = 
Uts
.
	`lÚgToBy‹s
(
v®ue
);

32 
off
 = 0;

35 
public
 
	$Num”icBy‹I‹¿tÜ
(
fš®
 
v®ue
) {

36 
æßtšgPošt
 = 
Œue
;

37 
·ylßd
 = 
Uts
.
	`doubËToBy‹s
(
v®ue
);

38 
off
 = 0;

39 
	}
}

41 @
Ov”ride


42 
public
 
boŞ—n
 
	$hasNext
() {

43  
off
 < 
·ylßd
.
Ëngth
;

44 
	}
}

46 @
Ov”ride


47 
public
 
by‹
 
	$ÃxtBy‹
() {

48  
·ylßd
[
off
++];

49 
	}
}

51 @
Ov”ride


52 
public
 
	$by‹sLeá
() {

53  
·ylßd
.
Ëngth
 - 
off
;

54 
	}
}

56 @
Ov”ride


57 
public
 
	$»£t
() {

58 
off
 = 0;

59 
	}
}

61 
public
 
	$g‘LÚg
() {

62 ià(
æßtšgPošt
) {

63 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Byte iterator is ofheype double");

65  
Uts
.
	`by‹sToLÚg
(
·ylßd
);

66 
	}
}

68 
public
 
	$g‘DoubË
() {

69 ià(!
æßtšgPošt
) {

70 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Byte iterator is ofheype†ong");

72  
Uts
.
	`by‹sToDoubË
(
·ylßd
);

73 
	}
}

75 
public
 
boŞ—n
 
	$isFlßtšgPošt
() {

76  
æßtšgPošt
;

77 
	}
}

	@NumericByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

24 
public
 cÏs 
	cNum”icBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

25 
´iv©e
 
fš®
 
	mby‹
[] 
	m·ylßd
;

26 
´iv©e
 
fš®
 
boŞ—n
 
	mæßtšgPošt
;

27 
´iv©e
 
	moff
;

29 
public
 
	$Num”icBy‹I‹¿tÜ
(
fš®
 
v®ue
) {

30 
æßtšgPošt
 = 
çl£
;

31 
·ylßd
 = 
Uts
.
	`lÚgToBy‹s
(
v®ue
);

32 
off
 = 0;

35 
public
 
	$Num”icBy‹I‹¿tÜ
(
fš®
 
v®ue
) {

36 
æßtšgPošt
 = 
Œue
;

37 
·ylßd
 = 
Uts
.
	`doubËToBy‹s
(
v®ue
);

38 
off
 = 0;

39 
	}
}

41 @
Ov”ride


42 
public
 
boŞ—n
 
	$hasNext
() {

43  
off
 < 
·ylßd
.
Ëngth
;

44 
	}
}

46 @
Ov”ride


47 
public
 
by‹
 
	$ÃxtBy‹
() {

48  
·ylßd
[
off
++];

49 
	}
}

51 @
Ov”ride


52 
public
 
	$by‹sLeá
() {

53  
·ylßd
.
Ëngth
 - 
off
;

54 
	}
}

56 @
Ov”ride


57 
public
 
	$»£t
() {

58 
off
 = 0;

59 
	}
}

61 
public
 
	$g‘LÚg
() {

62 ià(
æßtšgPošt
) {

63 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Byte iterator is ofheype double");

65  
Uts
.
	`by‹sToLÚg
(
·ylßd
);

66 
	}
}

68 
public
 
	$g‘DoubË
() {

69 ià(!
æßtšgPošt
) {

70 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Byte iterator is ofheype†ong");

72  
Uts
.
	`by‹sToDoubË
(
·ylßd
);

73 
	}
}

75 
public
 
boŞ—n
 
	$isFlßtšgPošt
() {

76  
æßtšgPošt
;

77 
	}
}

	@RandomByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
public
 cÏs 
	cRªdomBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

25 
´iv©e
 
fš®
 
	mËn
;

26 
´iv©e
 
	moff
;

27 
´iv©e
 
	mbufOff
;

28 
´iv©e
 
fš®
 
	mby‹
[] 
	mbuf
;

30 @
Ov”ride


31 
public
 
boŞ—n
 
	$hasNext
() {

32  (
off
 + 
bufOff
è< 
Ën
;

35 
´iv©e
 
	$flBy‹sIm¶
(
by‹
[] 
bufãr
, 
ba£
) {

36 
by‹s
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
();

38 
bufãr
.
Ëngth
 - 
ba£
) {

40 
bufãr
[
ba£
 + 5] = (
by‹
è(((
by‹s
 >> 25) & 95) + ' ');

42 
bufãr
[
ba£
 + 4] = (
by‹
è(((
by‹s
 >> 20) & 63) + ' ');

44 
bufãr
[
ba£
 + 3] = (
by‹
è(((
by‹s
 >> 15) & 31) + ' ');

46 
bufãr
[
ba£
 + 2] = (
by‹
è(((
by‹s
 >> 10) & 95) + ' ');

48 
bufãr
[
ba£
 + 1] = (
by‹
è(((
by‹s
 >> 5) & 63) + ' ');

50 
bufãr
[
ba£
 + 0] = (
by‹
è(((
by‹s
) & 31) + ' ');

54 
	}
}

56 
´iv©e
 
	$flBy‹s
() {

57 ià(
bufOff
 =ğ
buf
.
Ëngth
) {

58 
	`flBy‹sIm¶
(
buf
, 0);

59 
bufOff
 = 0;

60 
off
 +ğ
buf
.
Ëngth
;

62 
	}
}

64 
public
 
	$RªdomBy‹I‹¿tÜ
(
Ën
) {

65 
this
.
Ën
 =†en;

66 
this
.
buf
 = 
Ãw
 
by‹
[6];

67 
this
.
bufOff
 = 
buf
.
Ëngth
;

68 
	`flBy‹s
();

69 
this
.
off
 = 0;

70 
	}
}

72 
public
 
by‹
 
	$ÃxtBy‹
() {

73 
	`flBy‹s
();

74 
bufOff
++;

75  
buf
[
bufOff
 - 1];

76 
	}
}

78 @
Ov”ride


79 
public
 
	$ÃxtBuf
(
by‹
[] 
bufãr
, 
bufOff£t
) {

80 
»t
;

81 ià(
Ën
 - 
off
 < 
bufãr
.
Ëngth
 - 
bufOff£t
) {

82 
»t
 = (è(
Ën
 - 
off
);

84 
»t
 = 
bufãr
.
Ëngth
 - 
bufOff£t
;

86 
i
;

87 
i
 = 0; i < 
»t
; i += 6) {

88 
	`flBy‹sIm¶
(
bufãr
, 
i
 + 
bufOff£t
);

90 
off
 +ğ
»t
;

91  
»t
 + 
bufOff£t
;

92 
	}
}

94 @
Ov”ride


95 
public
 
	$by‹sLeá
() {

96  
Ën
 - 
off
 - 
bufOff
;

97 
	}
}

99 @
Ov”ride


100 
public
 
	$»£t
() {

101 
off
 = 0;

102 
	}
}

105 
public
 
	gby‹
[] 
	$toA¼ay
() {

106 
Ëá
 = 
	`by‹sLeá
();

107 ià(
Ëá
 != ()†eft) {

108 
throw
 
Ãw
 
	`A¼ayIndexOutOfBoundsExû±iÚ
("Too much datao fit in one‡rray!");

110 
by‹
[] 
»t
 = 
Ãw
 by‹[(è
Ëá
];

111 
bufOff£t
 = 0;

112 
bufOff£t
 < 
»t
.
Ëngth
) {

113 
bufOff£t
 = 
	`ÃxtBuf
(
»t
, bufOffset);

115  
»t
;

116 
	}
}

	@RandomByteIterator.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
public
 cÏs 
	cRªdomBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

25 
´iv©e
 
fš®
 
	mËn
;

26 
´iv©e
 
	moff
;

27 
´iv©e
 
	mbufOff
;

28 
´iv©e
 
fš®
 
	mby‹
[] 
	mbuf
;

30 @
Ov”ride


31 
public
 
boŞ—n
 
	$hasNext
() {

32  (
off
 + 
bufOff
è< 
Ën
;

35 
´iv©e
 
	$flBy‹sIm¶
(
by‹
[] 
bufãr
, 
ba£
) {

36 
by‹s
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
();

38 
bufãr
.
Ëngth
 - 
ba£
) {

40 
bufãr
[
ba£
 + 5] = (
by‹
è(((
by‹s
 >> 25) & 95) + ' ');

42 
bufãr
[
ba£
 + 4] = (
by‹
è(((
by‹s
 >> 20) & 63) + ' ');

44 
bufãr
[
ba£
 + 3] = (
by‹
è(((
by‹s
 >> 15) & 31) + ' ');

46 
bufãr
[
ba£
 + 2] = (
by‹
è(((
by‹s
 >> 10) & 95) + ' ');

48 
bufãr
[
ba£
 + 1] = (
by‹
è(((
by‹s
 >> 5) & 63) + ' ');

50 
bufãr
[
ba£
 + 0] = (
by‹
è(((
by‹s
) & 31) + ' ');

54 
	}
}

56 
´iv©e
 
	$flBy‹s
() {

57 ià(
bufOff
 =ğ
buf
.
Ëngth
) {

58 
	`flBy‹sIm¶
(
buf
, 0);

59 
bufOff
 = 0;

60 
off
 +ğ
buf
.
Ëngth
;

62 
	}
}

64 
public
 
	$RªdomBy‹I‹¿tÜ
(
Ën
) {

65 
this
.
Ën
 =†en;

66 
this
.
buf
 = 
Ãw
 
by‹
[6];

67 
this
.
bufOff
 = 
buf
.
Ëngth
;

68 
	`flBy‹s
();

69 
this
.
off
 = 0;

70 
	}
}

72 
public
 
by‹
 
	$ÃxtBy‹
() {

73 
	`flBy‹s
();

74 
bufOff
++;

75  
buf
[
bufOff
 - 1];

76 
	}
}

78 @
Ov”ride


79 
public
 
	$ÃxtBuf
(
by‹
[] 
bufãr
, 
bufOff£t
) {

80 
»t
;

81 ià(
Ën
 - 
off
 < 
bufãr
.
Ëngth
 - 
bufOff£t
) {

82 
»t
 = (è(
Ën
 - 
off
);

84 
»t
 = 
bufãr
.
Ëngth
 - 
bufOff£t
;

86 
i
;

87 
i
 = 0; i < 
»t
; i += 6) {

88 
	`flBy‹sIm¶
(
bufãr
, 
i
 + 
bufOff£t
);

90 
off
 +ğ
»t
;

91  
»t
 + 
bufOff£t
;

92 
	}
}

94 @
Ov”ride


95 
public
 
	$by‹sLeá
() {

96  
Ën
 - 
off
 - 
bufOff
;

97 
	}
}

99 @
Ov”ride


100 
public
 
	$»£t
() {

101 
off
 = 0;

102 
	}
}

105 
public
 
	gby‹
[] 
	$toA¼ay
() {

106 
Ëá
 = 
	`by‹sLeá
();

107 ià(
Ëá
 != ()†eft) {

108 
throw
 
Ãw
 
	`A¼ayIndexOutOfBoundsExû±iÚ
("Too much datao fit in one‡rray!");

110 
by‹
[] 
»t
 = 
Ãw
 by‹[(è
Ëá
];

111 
bufOff£t
 = 0;

112 
bufOff£t
 < 
»t
.
Ëngth
) {

113 
bufOff£t
 = 
	`ÃxtBuf
(
»t
, bufOffset);

115  
»t
;

116 
	}
}

	@Status.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cStus
 {

24 
´iv©e
 
fš®
 
SŒšg
 
	mÇme
;

25 
´iv©e
 
fš®
 
SŒšg
 
	mdesütiÚ
;

31 
public
 
	$Stus
(
SŒšg
 
Çme
, SŒšg 
desütiÚ
) {

32 
	`su³r
();

33 
this
.
Çme
 =‚ame;

34 
this
.
desütiÚ
 = description;

37 
public
 
SŒšg
 
	$g‘Name
() {

38  
Çme
;

39 
	}
}

41 
public
 
SŒšg
 
	$g‘DesütiÚ
() {

42  
desütiÚ
;

43 
	}
}

45 @
Ov”ride


46 
public
 
SŒšg
 
	$toSŒšg
() {

47  "Stu [Çme=" + 
Çme
 + ", desütiÚ=" + 
desütiÚ
 + "]";

48 
	}
}

50 @
Ov”ride


51 
public
 
	$hashCode
() {

52 
fš®
 
´ime
 = 31;

53 
»suÉ
 = 1;

54 
»suÉ
 = 
´ime
 *„esuÉ + ((
desütiÚ
 =ğ
nuÎ
è? 0 : desütiÚ.
	`hashCode
());

55 
»suÉ
 = 
´ime
 *„esuÉ + ((
Çme
 =ğ
nuÎ
è? 0 :‚ame.
	`hashCode
());

56  
»suÉ
;

57 
	}
}

59 @
Ov”ride


60 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

61 ià(
this
 =ğ
obj
) {

62  
Œue
;

64 ià(
obj
 =ğ
nuÎ
) {

65  
çl£
;

67 ià(
	`g‘CÏss
(è!ğ
obj
.getClass()) {

68  
çl£
;

70 
Stus
 
Ùh”
 = (Stusè
obj
;

71 ià(
desütiÚ
 =ğ
nuÎ
) {

72 ià(
Ùh”
.
desütiÚ
 !ğ
nuÎ
) {

73  
çl£
;

75 } ià(!
desütiÚ
.
	`equ®s
(
Ùh”
.description)) {

76  
çl£
;

78 ià(
Çme
 =ğ
nuÎ
) {

79 ià(
Ùh”
.
Çme
 !ğ
nuÎ
) {

80  
çl£
;

82 } ià(!
Çme
.
	`equ®s
(
Ùh”
.name)) {

83  
çl£
;

85  
Œue
;

86 
	}
}

92 
public
 
boŞ—n
 
	$isOk
() {

93  
this
 =ğ
OK
 ||hi =ğ
BATCHED_OK
;

94 
	}
}

96 
public
 
fš®
 
Stus
 
	gOK
 = 
Ãw
 Status("OK", "The operation completed successfully.");

97 
public
 
fš®
 
Stus
 
	gERROR
 = 
Ãw
 Status("ERROR", "The operation failed.");

98 
public
 
fš®
 
Stus
 
	gNOT_FOUND
 = 
Ãw
 Status("NOT_FOUND", "The„equested„ecord was‚ot found.");

99 
public
 
fš®
 
Stus
 
	gNOT_IMPLEMENTED
 = 
Ãw
 Status("NOT_IMPLEMENTED", "The operation is‚ot " +

101 
public
 
fš®
 
Stus
 
	gUNEXPECTED_STATE
 = 
Ãw
 Status("UNEXPECTED_STATE", "The operation„eported" +

103 
public
 
fš®
 
Stus
 
	gBAD_REQUEST
 = 
Ãw
 Status("BAD_REQUEST", "The„equest was‚ot valid.");

104 
public
 
fš®
 
Stus
 
	gFORBIDDEN
 = 
Ãw
 Status("FORBIDDEN", "The operation is forbidden.");

105 
public
 
fš®
 
Stus
 
	gSERVICE_UNAVAILABLE
 = 
Ãw
 Status("SERVICE_UNAVAILABLE", "Dependant " +

107 
public
 
fš®
 
Stus
 
	gBATCHED_OK
 = 
Ãw
 Status("BATCHED_OK", "The operation has been batched by " +

	@Status.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cStus
 {

24 
´iv©e
 
fš®
 
SŒšg
 
	mÇme
;

25 
´iv©e
 
fš®
 
SŒšg
 
	mdesütiÚ
;

31 
public
 
	$Stus
(
SŒšg
 
Çme
, SŒšg 
desütiÚ
) {

32 
	`su³r
();

33 
this
.
Çme
 =‚ame;

34 
this
.
desütiÚ
 = description;

37 
public
 
SŒšg
 
	$g‘Name
() {

38  
Çme
;

39 
	}
}

41 
public
 
SŒšg
 
	$g‘DesütiÚ
() {

42  
desütiÚ
;

43 
	}
}

45 @
Ov”ride


46 
public
 
SŒšg
 
	$toSŒšg
() {

47  "Stu [Çme=" + 
Çme
 + ", desütiÚ=" + 
desütiÚ
 + "]";

48 
	}
}

50 @
Ov”ride


51 
public
 
	$hashCode
() {

52 
fš®
 
´ime
 = 31;

53 
»suÉ
 = 1;

54 
»suÉ
 = 
´ime
 *„esuÉ + ((
desütiÚ
 =ğ
nuÎ
è? 0 : desütiÚ.
	`hashCode
());

55 
»suÉ
 = 
´ime
 *„esuÉ + ((
Çme
 =ğ
nuÎ
è? 0 :‚ame.
	`hashCode
());

56  
»suÉ
;

57 
	}
}

59 @
Ov”ride


60 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

61 ià(
this
 =ğ
obj
) {

62  
Œue
;

64 ià(
obj
 =ğ
nuÎ
) {

65  
çl£
;

67 ià(
	`g‘CÏss
(è!ğ
obj
.getClass()) {

68  
çl£
;

70 
Stus
 
Ùh”
 = (Stusè
obj
;

71 ià(
desütiÚ
 =ğ
nuÎ
) {

72 ià(
Ùh”
.
desütiÚ
 !ğ
nuÎ
) {

73  
çl£
;

75 } ià(!
desütiÚ
.
	`equ®s
(
Ùh”
.description)) {

76  
çl£
;

78 ià(
Çme
 =ğ
nuÎ
) {

79 ià(
Ùh”
.
Çme
 !ğ
nuÎ
) {

80  
çl£
;

82 } ià(!
Çme
.
	`equ®s
(
Ùh”
.name)) {

83  
çl£
;

85  
Œue
;

86 
	}
}

92 
public
 
boŞ—n
 
	$isOk
() {

93  
this
 =ğ
OK
 ||hi =ğ
BATCHED_OK
;

94 
	}
}

96 
public
 
fš®
 
Stus
 
	gOK
 = 
Ãw
 Status("OK", "The operation completed successfully.");

97 
public
 
fš®
 
Stus
 
	gERROR
 = 
Ãw
 Status("ERROR", "The operation failed.");

98 
public
 
fš®
 
Stus
 
	gNOT_FOUND
 = 
Ãw
 Status("NOT_FOUND", "The„equested„ecord was‚ot found.");

99 
public
 
fš®
 
Stus
 
	gNOT_IMPLEMENTED
 = 
Ãw
 Status("NOT_IMPLEMENTED", "The operation is‚ot " +

101 
public
 
fš®
 
Stus
 
	gUNEXPECTED_STATE
 = 
Ãw
 Status("UNEXPECTED_STATE", "The operation„eported" +

103 
public
 
fš®
 
Stus
 
	gBAD_REQUEST
 = 
Ãw
 Status("BAD_REQUEST", "The„equest was‚ot valid.");

104 
public
 
fš®
 
Stus
 
	gFORBIDDEN
 = 
Ãw
 Status("FORBIDDEN", "The operation is forbidden.");

105 
public
 
fš®
 
Stus
 
	gSERVICE_UNAVAILABLE
 = 
Ãw
 Status("SERVICE_UNAVAILABLE", "Dependant " +

107 
public
 
fš®
 
Stus
 
	gBATCHED_OK
 = 
Ãw
 Status("BATCHED_OK", "The operation has been batched by " +

	@StatusThread.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

22 
impÜt
 
	gjava
.
	g‹xt
.
	gSim¶eD©eFÜm©
;

23 
impÜt
 
	gjava
.
	gut
.
	gD©e
;

24 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

31 
public
 cÏs 
	cStusTh»ad
 
ex‹nds
 
	mTh»ad
 {

33 
´iv©e
 
fš®
 
CouÁDownL©ch
 
	mcom¶‘eL©ch
;

36 
´iv©e
 
fš®
 
M—su»m’ts
 
	mm—su»m’ts
;

39 
´iv©e
 
fš®
 
boŞ—n
 
	mŒackJVMSts
;

42 
´iv©e
 
fš®
 
	mLi¡
<
	mCl›ÁTh»ad
> 
	mş›Ás
;

44 
´iv©e
 
fš®
 
SŒšg
 
	mÏb–
;

45 
´iv©e
 
fš®
 
boŞ—n
 
	m¡ªd¬d¡©us
;

48 
´iv©e
 
	m¦“±imeNs
;

51 
´iv©e
 
	mmaxTh»ads
;

52 
´iv©e
 
	mmšTh»ads
 = 
IÁeg”
.
MAX_VALUE
;

53 
´iv©e
 
	mmaxU£dMem
;

54 
´iv©e
 
	mmšU£dMem
 = 
LÚg
.
MAX_VALUE
;

55 
´iv©e
 
	mmaxLßdAvg
;

56 
´iv©e
 
	mmšLßdAvg
 = 
DoubË
.
MAX_VALUE
;

57 
´iv©e
 
	mÏ¡GCCouÁ
 = 0;

58 
´iv©e
 
	mÏ¡GCTime
 = 0;

70 
public
 
StusTh»ad
(
CouÁDownL©ch
 
com¶‘eL©ch
, 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
,

71 
SŒšg
 
Ïb–
, 
boŞ—n
 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
) {

72 
this
(
com¶‘eL©ch
, 
ş›Ás
, 
Ïb–
, 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
, 
çl£
);

86 
public
 
StusTh»ad
(
CouÁDownL©ch
 
com¶‘eL©ch
, 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
,

87 
SŒšg
 
Ïb–
, 
boŞ—n
 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
,

88 
boŞ—n
 
ŒackJVMSts
) {

89 
	gthis
.
	gcom¶‘eL©ch
 = 
com¶‘eL©ch
;

90 
	gthis
.
	gş›Ás
 = 
ş›Ás
;

91 
	gthis
.
	gÏb–
 = 
Ïb–
;

92 
	gthis
.
	g¡ªd¬d¡©us
 = 
¡ªd¬d¡©us
;

93 
	g¦“±imeNs
 = 
TimeUn™
.
SECONDS
.
toNªos
(
¡©usIÁ”v®SecÚds
);

94 
	gm—su»m’ts
 = 
M—su»m’ts
.
g‘M—su»m’ts
();

95 
	gthis
.
	gŒackJVMSts
 = 
ŒackJVMSts
;

101 @
Ov”ride


102 
public
 
	$run
() {

103 
fš®
 
¡¬tTimeMs
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

104 
fš®
 
¡¬tTimeNªos
 = 
Sy¡em
.
	`ÇnoTime
();

105 
d—dlše
 = 
¡¬tTimeNªos
 + 
¦“±imeNs
;

106 
¡¬tIÁ”v®Ms
 = 
¡¬tTimeMs
;

107 
Ï¡TÙ®Ops
 = 0;

109 
boŞ—n
 
®ldÚe
;

112 
nowMs
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

114 
Ï¡TÙ®Ops
 = 
	`compu‹Sts
(
¡¬tTimeMs
, 
¡¬tIÁ”v®Ms
, 
nowMs
,†astTotalOps);

116 ià(
ŒackJVMSts
) {

117 
	`m—su»JVM
();

120 
®ldÚe
 = 
	`wa™FÜCl›ÁsUÁ
(
d—dlše
);

122 
¡¬tIÁ”v®Ms
 = 
nowMs
;

123 
d—dlše
 +ğ
¦“±imeNs
;

125 !
®ldÚe
);

127 ià(
ŒackJVMSts
) {

128 
	`m—su»JVM
();

131 
	`compu‹Sts
(
¡¬tTimeMs
, 
¡¬tIÁ”v®Ms
, 
Sy¡em
.
	`cu¼’tTimeMlis
(), 
Ï¡TÙ®Ops
);

132 
	}
}

143 
´iv©e
 
	$compu‹Sts
(
fš®
 
¡¬tTimeMs
, 
¡¬tIÁ”v®Ms
, 
’dIÁ”v®Ms
,

144 
Ï¡TÙ®Ops
) {

145 
Sim¶eD©eFÜm©
 
fÜm©
 = 
Ãw
 
	`Sim¶eD©eFÜm©
("yyyy-MM-dd HH:mm:ss:SSS");

147 
tÙ®İs
 = 0;

148 
todoİs
 = 0;

151 
Cl›ÁTh»ad
 
t
 : 
ş›Ás
) {

152 
tÙ®İs
 +ğ
t
.
	`g‘OpsDÚe
();

153 
todoİs
 +ğ
t
.
	`g‘OpsTodo
();

157 
š‹rv®
 = 
’dIÁ”v®Ms
 - 
¡¬tTimeMs
;

158 
throughput
 = 1000.0 * (((è
tÙ®İs
è/ (è
š‹rv®
);

159 
cu¹hroughput
 = 1000.0 * (((è(
tÙ®İs
 - 
Ï¡TÙ®Ops
)) /

160 ((è(
’dIÁ”v®Ms
 - 
¡¬tIÁ”v®Ms
)));

161 
e¡»maššg
 = (è
M©h
.
	`û
(
todoİs
 / 
throughput
);

164 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

165 
SŒšg
 
Ïb–SŒšg
 = 
this
.
Ïb–
 + 
fÜm©
.
	`fÜm©
(
Ãw
 
	`D©e
());

167 
SŒšgBud”
 
msg
 = 
Ãw
 
	`SŒšgBud”
(
Ïb–SŒšg
).
	`­³nd
(" ").­³nd(
š‹rv®
 / 1000).append(" sec: ");

168 
msg
.
	`­³nd
(
tÙ®İs
).append(" operations; ");

170 ià(
tÙ®İs
 != 0) {

171 
msg
.
	`­³nd
(
d
.
	`fÜm©
(
cu¹hroughput
)).append(" current ops/sec; ");

173 ià(
todoİs
 != 0) {

174 
msg
.
	`­³nd
("e¡ com¶‘iÚ iÀ").­³nd(
RemaššgFÜm©‹r
.
	`fÜm©
(
e¡»maššg
));

177 
msg
.
	`­³nd
(
M—su»m’ts
.
	`g‘M—su»m’ts
().
	`g‘Summ¬y
());

179 
Sy¡em
.
”r
.
	`´šn
(
msg
);

181 ià(
¡ªd¬d¡©us
) {

182 
Sy¡em
.
out
.
	`´šn
(
msg
);

184  
tÙ®İs
;

185 
	}
}

193 
´iv©e
 
boŞ—n
 
	$wa™FÜCl›ÁsUÁ
(
d—dlše
) {

194 
boŞ—n
 
®ldÚe
 = 
çl£
;

195 
now
 = 
Sy¡em
.
	`ÇnoTime
();

197 !
®ldÚe
 && 
now
 < 
d—dlše
) {

198 
Œy
 {

199 
®ldÚe
 = 
com¶‘eL©ch
.
	`awa™
(
d—dlše
 - 
now
, 
TimeUn™
.
NANOSECONDS
);

200 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

204 
Th»ad
.
	`cu¼’tTh»ad
().
	`š‹¼u±
();

205 
®ldÚe
 = 
Œue
;

207 
now
 = 
Sy¡em
.
	`ÇnoTime
();

210  
®ldÚe
;

211 
	}
}

216 
´iv©e
 
	$m—su»JVM
() {

217 
fš®
 
th»ads
 = 
Uts
.
	`g‘AùiveTh»adCouÁ
();

218 ià(
th»ads
 < 
mšTh»ads
) {

219 
mšTh»ads
 = 
th»ads
;

221 ià(
th»ads
 > 
maxTh»ads
) {

222 
maxTh»ads
 = 
th»ads
;

224 
m—su»m’ts
.
	`m—su»
("THREAD_COUNT", 
th»ads
);

229 
fš®
 
u£dMem
 = 
Uts
.
	`g‘U£dMemÜyMegaBy‹s
();

230 ià(
u£dMem
 < 
mšU£dMem
) {

231 
mšU£dMem
 = 
u£dMem
;

233 ià(
u£dMem
 > 
maxU£dMem
) {

234 
maxU£dMem
 = 
u£dMem
;

236 
m—su»m’ts
.
	`m—su»
("USED_MEM_MB", 
u£dMem
);

240 
fš®
 
sy¡emLßd
 = 
Uts
.
	`g‘Sy¡emLßdAv”age
();

241 ià(
sy¡emLßd
 >= 0) {

243 
m—su»m’ts
.
	`m—su»
("SYS_LOAD_AVG", (è
sy¡emLßd
);

244 ià(
sy¡emLßd
 > 
maxLßdAvg
) {

245 
maxLßdAvg
 = 
sy¡emLßd
;

247 ià(
sy¡emLßd
 < 
mšLßdAvg
) {

248 
mšLßdAvg
 = 
sy¡emLßd
;

252 
fš®
 
gcs
 = 
Uts
.
	`g‘GCTÙ®CŞËùiÚCouÁ
();

253 
m—su»m’ts
.
	`m—su»
("GCS", (è(
gcs
 - 
Ï¡GCCouÁ
));

254 
fš®
 
gcTime
 = 
Uts
.
	`g‘GCTÙ®Time
();

255 
m—su»m’ts
.
	`m—su»
("GCS_TIME", (è(
gcTime
 - 
Ï¡GCTime
));

256 
Ï¡GCCouÁ
 = 
gcs
;

257 
Ï¡GCTime
 = 
gcTime
;

258 
	}
}

263 
public
 
	$g‘MaxTh»ads
() {

264  
maxTh»ads
;

265 
	}
}

270 
public
 
	$g‘MšTh»ads
() {

271  
mšTh»ads
;

272 
	}
}

277 
public
 
	$g‘MaxU£dMem
() {

278  
maxU£dMem
;

279 
	}
}

284 
public
 
	$g‘MšU£dMem
() {

285  
mšU£dMem
;

286 
	}
}

291 
public
 
	$g‘MaxLßdAvg
() {

292  
maxLßdAvg
;

293 
	}
}

298 
public
 
	$g‘MšLßdAvg
() {

299  
mšLßdAvg
;

300 
	}
}

305 
public
 
boŞ—n
 
	$ŒackJVMSts
() {

306  
ŒackJVMSts
;

307 
	}
}

	@StatusThread.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

21 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

22 
impÜt
 
	gjava
.
	g‹xt
.
	gSim¶eD©eFÜm©
;

23 
impÜt
 
	gjava
.
	gut
.
	gD©e
;

24 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

31 
public
 cÏs 
	cStusTh»ad
 
ex‹nds
 
	mTh»ad
 {

33 
´iv©e
 
fš®
 
CouÁDownL©ch
 
	mcom¶‘eL©ch
;

36 
´iv©e
 
fš®
 
M—su»m’ts
 
	mm—su»m’ts
;

39 
´iv©e
 
fš®
 
boŞ—n
 
	mŒackJVMSts
;

42 
´iv©e
 
fš®
 
	mLi¡
<
	mCl›ÁTh»ad
> 
	mş›Ás
;

44 
´iv©e
 
fš®
 
SŒšg
 
	mÏb–
;

45 
´iv©e
 
fš®
 
boŞ—n
 
	m¡ªd¬d¡©us
;

48 
´iv©e
 
	m¦“±imeNs
;

51 
´iv©e
 
	mmaxTh»ads
;

52 
´iv©e
 
	mmšTh»ads
 = 
IÁeg”
.
MAX_VALUE
;

53 
´iv©e
 
	mmaxU£dMem
;

54 
´iv©e
 
	mmšU£dMem
 = 
LÚg
.
MAX_VALUE
;

55 
´iv©e
 
	mmaxLßdAvg
;

56 
´iv©e
 
	mmšLßdAvg
 = 
DoubË
.
MAX_VALUE
;

57 
´iv©e
 
	mÏ¡GCCouÁ
 = 0;

58 
´iv©e
 
	mÏ¡GCTime
 = 0;

70 
public
 
StusTh»ad
(
CouÁDownL©ch
 
com¶‘eL©ch
, 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
,

71 
SŒšg
 
Ïb–
, 
boŞ—n
 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
) {

72 
this
(
com¶‘eL©ch
, 
ş›Ás
, 
Ïb–
, 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
, 
çl£
);

86 
public
 
StusTh»ad
(
CouÁDownL©ch
 
com¶‘eL©ch
, 
Li¡
<
Cl›ÁTh»ad
> 
ş›Ás
,

87 
SŒšg
 
Ïb–
, 
boŞ—n
 
¡ªd¬d¡©us
, 
¡©usIÁ”v®SecÚds
,

88 
boŞ—n
 
ŒackJVMSts
) {

89 
	gthis
.
	gcom¶‘eL©ch
 = 
com¶‘eL©ch
;

90 
	gthis
.
	gş›Ás
 = 
ş›Ás
;

91 
	gthis
.
	gÏb–
 = 
Ïb–
;

92 
	gthis
.
	g¡ªd¬d¡©us
 = 
¡ªd¬d¡©us
;

93 
	g¦“±imeNs
 = 
TimeUn™
.
SECONDS
.
toNªos
(
¡©usIÁ”v®SecÚds
);

94 
	gm—su»m’ts
 = 
M—su»m’ts
.
g‘M—su»m’ts
();

95 
	gthis
.
	gŒackJVMSts
 = 
ŒackJVMSts
;

101 @
Ov”ride


102 
public
 
	$run
() {

103 
fš®
 
¡¬tTimeMs
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

104 
fš®
 
¡¬tTimeNªos
 = 
Sy¡em
.
	`ÇnoTime
();

105 
d—dlše
 = 
¡¬tTimeNªos
 + 
¦“±imeNs
;

106 
¡¬tIÁ”v®Ms
 = 
¡¬tTimeMs
;

107 
Ï¡TÙ®Ops
 = 0;

109 
boŞ—n
 
®ldÚe
;

112 
nowMs
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

114 
Ï¡TÙ®Ops
 = 
	`compu‹Sts
(
¡¬tTimeMs
, 
¡¬tIÁ”v®Ms
, 
nowMs
,†astTotalOps);

116 ià(
ŒackJVMSts
) {

117 
	`m—su»JVM
();

120 
®ldÚe
 = 
	`wa™FÜCl›ÁsUÁ
(
d—dlše
);

122 
¡¬tIÁ”v®Ms
 = 
nowMs
;

123 
d—dlše
 +ğ
¦“±imeNs
;

125 !
®ldÚe
);

127 ià(
ŒackJVMSts
) {

128 
	`m—su»JVM
();

131 
	`compu‹Sts
(
¡¬tTimeMs
, 
¡¬tIÁ”v®Ms
, 
Sy¡em
.
	`cu¼’tTimeMlis
(), 
Ï¡TÙ®Ops
);

132 
	}
}

143 
´iv©e
 
	$compu‹Sts
(
fš®
 
¡¬tTimeMs
, 
¡¬tIÁ”v®Ms
, 
’dIÁ”v®Ms
,

144 
Ï¡TÙ®Ops
) {

145 
Sim¶eD©eFÜm©
 
fÜm©
 = 
Ãw
 
	`Sim¶eD©eFÜm©
("yyyy-MM-dd HH:mm:ss:SSS");

147 
tÙ®İs
 = 0;

148 
todoİs
 = 0;

151 
Cl›ÁTh»ad
 
t
 : 
ş›Ás
) {

152 
tÙ®İs
 +ğ
t
.
	`g‘OpsDÚe
();

153 
todoİs
 +ğ
t
.
	`g‘OpsTodo
();

157 
š‹rv®
 = 
’dIÁ”v®Ms
 - 
¡¬tTimeMs
;

158 
throughput
 = 1000.0 * (((è
tÙ®İs
è/ (è
š‹rv®
);

159 
cu¹hroughput
 = 1000.0 * (((è(
tÙ®İs
 - 
Ï¡TÙ®Ops
)) /

160 ((è(
’dIÁ”v®Ms
 - 
¡¬tIÁ”v®Ms
)));

161 
e¡»maššg
 = (è
M©h
.
	`û
(
todoİs
 / 
throughput
);

164 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

165 
SŒšg
 
Ïb–SŒšg
 = 
this
.
Ïb–
 + 
fÜm©
.
	`fÜm©
(
Ãw
 
	`D©e
());

167 
SŒšgBud”
 
msg
 = 
Ãw
 
	`SŒšgBud”
(
Ïb–SŒšg
).
	`­³nd
(" ").­³nd(
š‹rv®
 / 1000).append(" sec: ");

168 
msg
.
	`­³nd
(
tÙ®İs
).append(" operations; ");

170 ià(
tÙ®İs
 != 0) {

171 
msg
.
	`­³nd
(
d
.
	`fÜm©
(
cu¹hroughput
)).append(" current ops/sec; ");

173 ià(
todoİs
 != 0) {

174 
msg
.
	`­³nd
("e¡ com¶‘iÚ iÀ").­³nd(
RemaššgFÜm©‹r
.
	`fÜm©
(
e¡»maššg
));

177 
msg
.
	`­³nd
(
M—su»m’ts
.
	`g‘M—su»m’ts
().
	`g‘Summ¬y
());

179 
Sy¡em
.
”r
.
	`´šn
(
msg
);

181 ià(
¡ªd¬d¡©us
) {

182 
Sy¡em
.
out
.
	`´šn
(
msg
);

184  
tÙ®İs
;

185 
	}
}

193 
´iv©e
 
boŞ—n
 
	$wa™FÜCl›ÁsUÁ
(
d—dlše
) {

194 
boŞ—n
 
®ldÚe
 = 
çl£
;

195 
now
 = 
Sy¡em
.
	`ÇnoTime
();

197 !
®ldÚe
 && 
now
 < 
d—dlše
) {

198 
Œy
 {

199 
®ldÚe
 = 
com¶‘eL©ch
.
	`awa™
(
d—dlše
 - 
now
, 
TimeUn™
.
NANOSECONDS
);

200 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

204 
Th»ad
.
	`cu¼’tTh»ad
().
	`š‹¼u±
();

205 
®ldÚe
 = 
Œue
;

207 
now
 = 
Sy¡em
.
	`ÇnoTime
();

210  
®ldÚe
;

211 
	}
}

216 
´iv©e
 
	$m—su»JVM
() {

217 
fš®
 
th»ads
 = 
Uts
.
	`g‘AùiveTh»adCouÁ
();

218 ià(
th»ads
 < 
mšTh»ads
) {

219 
mšTh»ads
 = 
th»ads
;

221 ià(
th»ads
 > 
maxTh»ads
) {

222 
maxTh»ads
 = 
th»ads
;

224 
m—su»m’ts
.
	`m—su»
("THREAD_COUNT", 
th»ads
);

229 
fš®
 
u£dMem
 = 
Uts
.
	`g‘U£dMemÜyMegaBy‹s
();

230 ià(
u£dMem
 < 
mšU£dMem
) {

231 
mšU£dMem
 = 
u£dMem
;

233 ià(
u£dMem
 > 
maxU£dMem
) {

234 
maxU£dMem
 = 
u£dMem
;

236 
m—su»m’ts
.
	`m—su»
("USED_MEM_MB", 
u£dMem
);

240 
fš®
 
sy¡emLßd
 = 
Uts
.
	`g‘Sy¡emLßdAv”age
();

241 ià(
sy¡emLßd
 >= 0) {

243 
m—su»m’ts
.
	`m—su»
("SYS_LOAD_AVG", (è
sy¡emLßd
);

244 ià(
sy¡emLßd
 > 
maxLßdAvg
) {

245 
maxLßdAvg
 = 
sy¡emLßd
;

247 ià(
sy¡emLßd
 < 
mšLßdAvg
) {

248 
mšLßdAvg
 = 
sy¡emLßd
;

252 
fš®
 
gcs
 = 
Uts
.
	`g‘GCTÙ®CŞËùiÚCouÁ
();

253 
m—su»m’ts
.
	`m—su»
("GCS", (è(
gcs
 - 
Ï¡GCCouÁ
));

254 
fš®
 
gcTime
 = 
Uts
.
	`g‘GCTÙ®Time
();

255 
m—su»m’ts
.
	`m—su»
("GCS_TIME", (è(
gcTime
 - 
Ï¡GCTime
));

256 
Ï¡GCCouÁ
 = 
gcs
;

257 
Ï¡GCTime
 = 
gcTime
;

258 
	}
}

263 
public
 
	$g‘MaxTh»ads
() {

264  
maxTh»ads
;

265 
	}
}

270 
public
 
	$g‘MšTh»ads
() {

271  
mšTh»ads
;

272 
	}
}

277 
public
 
	$g‘MaxU£dMem
() {

278  
maxU£dMem
;

279 
	}
}

284 
public
 
	$g‘MšU£dMem
() {

285  
mšU£dMem
;

286 
	}
}

291 
public
 
	$g‘MaxLßdAvg
() {

292  
maxLßdAvg
;

293 
	}
}

298 
public
 
	$g‘MšLßdAvg
() {

299  
mšLßdAvg
;

300 
	}
}

305 
public
 
boŞ—n
 
	$ŒackJVMSts
() {

306  
ŒackJVMSts
;

307 
	}
}

	@StringByteIterator.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

26 
public
 cÏs 
	cSŒšgBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

27 
´iv©e
 
SŒšg
 
	m¡r
;

28 
´iv©e
 
	moff
;

34 
public
 
putAÎAsBy‹I‹¿tÜs
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
out
, M­<SŒšg, SŒšg> 
š
) {

35 
	mM­
.
	mEÁry
<
	mSŒšg
, SŒšg> 
	m’Œy
 : 
š
.
’ŒyS‘
()) {

36 
out
.
put
(
’Œy
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
ÓÁry.
g‘V®ue
()));

44 
public
 
putAÎAsSŒšgs
(
M­
<
SŒšg
, SŒšg> 
out
, M­<SŒšg, 
By‹I‹¿tÜ
> 
š
) {

45 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
š
.
’ŒyS‘
()) {

46 
out
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

54 
public
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
g‘By‹I‹¿tÜM­
(
M­
<
SŒšg
, SŒšg> 
m
) {

55 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»t
 =

56 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

58 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
m
.
’ŒyS‘
()) {

59 
»t
.
put
(
’Œy
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
ÓÁry.
g‘V®ue
()));

61  
	g»t
;

68 
public
 
	gM­
<
	gSŒšg
, SŒšg> 
g‘SŒšgM­
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
m
) {

69 
	gHashM­
<
	gSŒšg
, SŒšg> 
	g»t
 = 
Ãw
 
HashM­
<
SŒšg
, String>();

71 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
m
.
’ŒyS‘
()) {

72 
»t
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

74  
	g»t
;

77 
public
 
	$SŒšgBy‹I‹¿tÜ
(
SŒšg
 
s
) {

78 
this
.
¡r
 = 
s
;

79 
this
.
off
 = 0;

80 
	}
}

82 @
Ov”ride


83 
public
 
boŞ—n
 
	$hasNext
() {

84  
off
 < 
¡r
.
	`Ëngth
();

85 
	}
}

87 @
Ov”ride


88 
public
 
by‹
 
	$ÃxtBy‹
() {

89 
by‹
 
»t
 = (by‹è
¡r
.
	`ch¬At
(
off
);

90 
off
++;

91  
»t
;

92 
	}
}

94 @
Ov”ride


95 
public
 
	$by‹sLeá
() {

96  
¡r
.
	`Ëngth
(è- 
off
;

97 
	}
}

99 @
Ov”ride


100 
public
 
	$»£t
() {

101 
off
 = 0;

102 
	}
}

104 @
Ov”ride


105 
public
 
	gby‹
[] 
	$toA¼ay
() {

106 
by‹
[] 
by‹s
 = 
Ãw
 by‹[(è
	`by‹sLeá
()];

107 
i
 = 0; i < 
by‹s
.
Ëngth
; i++) {

108 
by‹s
[
i
] = (
by‹
è
¡r
.
	`ch¬At
(
off
 + i);

110 
off
 = 
¡r
.
	`Ëngth
();

111  
by‹s
;

112 
	}
}

123 @
Ov”ride


124 
public
 
SŒšg
 
	$toSŒšg
() {

125 ià(
off
 > 0) {

126  
su³r
.
	`toSŒšg
();

128  
¡r
;

130 
	}
}

	@StringByteIterator.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

26 
public
 cÏs 
	cSŒšgBy‹I‹¿tÜ
 
ex‹nds
 
	mBy‹I‹¿tÜ
 {

27 
´iv©e
 
SŒšg
 
	m¡r
;

28 
´iv©e
 
	moff
;

34 
public
 
putAÎAsBy‹I‹¿tÜs
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
out
, M­<SŒšg, SŒšg> 
š
) {

35 
	mM­
.
	mEÁry
<
	mSŒšg
, SŒšg> 
	m’Œy
 : 
š
.
’ŒyS‘
()) {

36 
out
.
put
(
’Œy
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
ÓÁry.
g‘V®ue
()));

44 
public
 
putAÎAsSŒšgs
(
M­
<
SŒšg
, SŒšg> 
out
, M­<SŒšg, 
By‹I‹¿tÜ
> 
š
) {

45 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
š
.
’ŒyS‘
()) {

46 
out
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

54 
public
 
	gM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
g‘By‹I‹¿tÜM­
(
M­
<
SŒšg
, SŒšg> 
m
) {

55 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g»t
 =

56 
Ãw
 
HashM­
<
SŒšg
, 
	gBy‹I‹¿tÜ
>();

58 
	gM­
.
	gEÁry
<
	gSŒšg
, SŒšg> 
	g’Œy
 : 
m
.
’ŒyS‘
()) {

59 
»t
.
put
(
’Œy
.
g‘Key
(), 
Ãw
 
SŒšgBy‹I‹¿tÜ
ÓÁry.
g‘V®ue
()));

61  
	g»t
;

68 
public
 
	gM­
<
	gSŒšg
, SŒšg> 
g‘SŒšgM­
(
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
m
) {

69 
	gHashM­
<
	gSŒšg
, SŒšg> 
	g»t
 = 
Ãw
 
HashM­
<
SŒšg
, String>();

71 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
m
.
’ŒyS‘
()) {

72 
»t
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

74  
	g»t
;

77 
public
 
	$SŒšgBy‹I‹¿tÜ
(
SŒšg
 
s
) {

78 
this
.
¡r
 = 
s
;

79 
this
.
off
 = 0;

80 
	}
}

82 @
Ov”ride


83 
public
 
boŞ—n
 
	$hasNext
() {

84  
off
 < 
¡r
.
	`Ëngth
();

85 
	}
}

87 @
Ov”ride


88 
public
 
by‹
 
	$ÃxtBy‹
() {

89 
by‹
 
»t
 = (by‹è
¡r
.
	`ch¬At
(
off
);

90 
off
++;

91  
»t
;

92 
	}
}

94 @
Ov”ride


95 
public
 
	$by‹sLeá
() {

96  
¡r
.
	`Ëngth
(è- 
off
;

97 
	}
}

99 @
Ov”ride


100 
public
 
	$»£t
() {

101 
off
 = 0;

102 
	}
}

104 @
Ov”ride


105 
public
 
	gby‹
[] 
	$toA¼ay
() {

106 
by‹
[] 
by‹s
 = 
Ãw
 by‹[(è
	`by‹sLeá
()];

107 
i
 = 0; i < 
by‹s
.
Ëngth
; i++) {

108 
by‹s
[
i
] = (
by‹
è
¡r
.
	`ch¬At
(
off
 + i);

110 
off
 = 
¡r
.
	`Ëngth
();

111  
by‹s
;

112 
	}
}

123 @
Ov”ride


124 
public
 
SŒšg
 
	$toSŒšg
() {

125 ià(
off
 > 0) {

126  
su³r
.
	`toSŒšg
();

128  
¡r
;

130 
	}
}

	@TerminatorThread.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

28 
public
 cÏs 
	cT”mš©ÜTh»ad
 
ex‹nds
 
	mTh»ad
 {

30 
´iv©e
 
fš®
 
	mCŞËùiÚ
<? 
ex‹nds
 
	mTh»ad
> 
	mth»ads
;

31 
´iv©e
 
	mmaxExecutiÚTime
;

32 
´iv©e
 
WÜklßd
 
	mwÜklßd
;

33 
´iv©e
 
	mwa™TimeOutInMS
;

35 
public
 
T”mš©ÜTh»ad
(
maxExecutiÚTime
, 
CŞËùiÚ
<? 
ex‹nds
 
Th»ad
> 
th»ads
,

36 
WÜklßd
 
wÜklßd
) {

37 
	mthis
.
	mmaxExecutiÚTime
 = 
maxExecutiÚTime
;

38 
	mthis
.
	mth»ads
 = 
th»ads
;

39 
	mthis
.
	mwÜklßd
 = 
wÜklßd
;

40 
	mwa™TimeOutInMS
 = 2000;

41 
	mSy¡em
.
	m”r
.
´šn
("MaximumƒxecutiÚim¥ecif›d‡s: " + 
maxExecutiÚTime
 + " secs");

44 
public
 
	$run
() {

45 
Œy
 {

46 
Th»ad
.
	`¦“p
(
maxExecutiÚTime
 * 1000);

47 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

48 
Sy¡em
.
”r
.
	`´šn
("Could‚ot wait until max specifiedime, TerminatorThread interrupted.");

51 
Sy¡em
.
”r
.
	`´šn
("Maximumimeƒlapsed. Requesting stop forhe workload.");

52 
wÜklßd
.
	`»que¡Stİ
();

53 
Sy¡em
.
”r
.
	`´šn
("Stop„equested for workload. Now Joining!");

54 
Th»ad
 
t
 : 
th»ads
) {

55 
t
.
	`isAlive
()) {

56 
Œy
 {

57 
t
.
	`još
(
wa™TimeOutInMS
);

58 ià(
t
.
	`isAlive
()) {

59 
Sy¡em
.
out
.
	`´šn
("StÈwa™šg fÜh»ad " + 
t
.
	`g‘Name
() + "o complete. " +

60 "WÜklßd stus: " + 
wÜklßd
.
	`isStİReque¡ed
());

62 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

67 
	}
}

	@TerminatorThread.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

28 
public
 cÏs 
	cT”mš©ÜTh»ad
 
ex‹nds
 
	mTh»ad
 {

30 
´iv©e
 
fš®
 
	mCŞËùiÚ
<? 
ex‹nds
 
	mTh»ad
> 
	mth»ads
;

31 
´iv©e
 
	mmaxExecutiÚTime
;

32 
´iv©e
 
WÜklßd
 
	mwÜklßd
;

33 
´iv©e
 
	mwa™TimeOutInMS
;

35 
public
 
T”mš©ÜTh»ad
(
maxExecutiÚTime
, 
CŞËùiÚ
<? 
ex‹nds
 
Th»ad
> 
th»ads
,

36 
WÜklßd
 
wÜklßd
) {

37 
	mthis
.
	mmaxExecutiÚTime
 = 
maxExecutiÚTime
;

38 
	mthis
.
	mth»ads
 = 
th»ads
;

39 
	mthis
.
	mwÜklßd
 = 
wÜklßd
;

40 
	mwa™TimeOutInMS
 = 2000;

41 
	mSy¡em
.
	m”r
.
´šn
("MaximumƒxecutiÚim¥ecif›d‡s: " + 
maxExecutiÚTime
 + " secs");

44 
public
 
	$run
() {

45 
Œy
 {

46 
Th»ad
.
	`¦“p
(
maxExecutiÚTime
 * 1000);

47 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

48 
Sy¡em
.
”r
.
	`´šn
("Could‚ot wait until max specifiedime, TerminatorThread interrupted.");

51 
Sy¡em
.
”r
.
	`´šn
("Maximumimeƒlapsed. Requesting stop forhe workload.");

52 
wÜklßd
.
	`»que¡Stİ
();

53 
Sy¡em
.
”r
.
	`´šn
("Stop„equested for workload. Now Joining!");

54 
Th»ad
 
t
 : 
th»ads
) {

55 
t
.
	`isAlive
()) {

56 
Œy
 {

57 
t
.
	`još
(
wa™TimeOutInMS
);

58 ià(
t
.
	`isAlive
()) {

59 
Sy¡em
.
out
.
	`´šn
("StÈwa™šg fÜh»ad " + 
t
.
	`g‘Name
() + "o complete. " +

60 "WÜklßd stus: " + 
wÜklßd
.
	`isStİReque¡ed
());

62 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

67 
	}
}

	@TimeseriesDB.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gG’”©Ü
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gInüem’tšgPršbËSŒšgG’”©Ü
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gTimeS”›sWÜklßd
;

23 
impÜt
 
	gjava
.
	gut
.*;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

39 
public
 
ab¡¿ù
 cÏs 
	cTime£r›sDB
 
ex‹nds
 
	mDB
 {

42 
´iv©e
 
fš®
 
SŒšg
 
	mDOWNSAMPLING_FUNCTION_PROPERTY_DEFAULT
 = "NONE";

43 
´iv©e
 
fš®
 
SŒšg
 
	mDOWNSAMPLING_INTERVAL_PROPERTY_DEFAULT
 = "0";

46 
´iv©e
 
fš®
 
SŒšg
 
	mDEBUG_PROPERTY
 = "debug";

47 
´iv©e
 
fš®
 
SŒšg
 
	mDEBUG_PROPERTY_DEFAULT
 = "false";

50 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_PROPERTY
 = "test";

51 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_PROPERTY_DEFAULT
 = "false";

54 
´Ùeùed
 
SŒšg
 
	mtime¡ampKey
;

55 
´Ùeùed
 
SŒšg
 
	mv®ueKey
;

56 
´Ùeùed
 
SŒšg
 
	mgPaœD–im™”
;

57 
´Ùeùed
 
SŒšg
 
	mqu”yTimeS·nD–im™”
;

58 
´Ùeùed
 
SŒšg
 
	md–‘eD–im™”
;

59 
´Ùeùed
 
TimeUn™
 
	mtime¡ampUn™
;

60 
´Ùeùed
 
SŒšg
 
	mgroupByKey
;

61 
´Ùeùed
 
SŒšg
 
	mdown§m¶šgKey
;

62 
´Ùeùed
 
IÁeg”
 
	mdown§m¶šgIÁ”v®
;

63 
´Ùeùed
 
Agg»g©iÚO³¿tiÚ
 
	mdown§m¶šgFunùiÚ
;

66 
´Ùeùed
 
boŞ—n
 
	mdebug
;

67 
´Ùeùed
 
boŞ—n
 
	m‹¡
;

73 @
Ov”ride


74 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

76 
time¡ampKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

77 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY
,

78 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
);

79 
v®ueKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

80 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY
,

81 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
);

82 
gPaœD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

83 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY
,

84 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY_DEFAULT
);

85 
qu”yTimeS·nD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

86 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY
,

87 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
);

88 
d–‘eD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

89 
TimeS”›sWÜklßd
.
DELETE_DELIMITER_PROPERTY
,

90 
TimeS”›sWÜklßd
.
DELETE_DELIMITER_PROPERTY_DEFAULT
);

91 
time¡ampUn™
 = 
TimeUn™
.
	`v®ueOf
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

92 
TimeS”›sWÜklßd
.
TIMESTAMP_UNITS_PROPERTY
,

93 
TimeS”›sWÜklßd
.
TIMESTAMP_UNITS_PROPERTY_DEFAULT
));

94 
groupByKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

95 
TimeS”›sWÜklßd
.
GROUPBY_KEY_PROPERTY
,

96 
TimeS”›sWÜklßd
.
GROUPBY_KEY_PROPERTY_DEFAULT
);

97 
down§m¶šgKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

98 
TimeS”›sWÜklßd
.
DOWNSAMPLING_KEY_PROPERTY
,

99 
TimeS”›sWÜklßd
.
DOWNSAMPLING_KEY_PROPERTY_DEFAULT
);

100 
down§m¶šgFunùiÚ
 = 
Time£r›sDB
.
Agg»g©iÚO³¿tiÚ
.
	`v®ueOf
(
	`g‘Prİ”t›s
()

101 .
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_FUNCTION_PROPERTY
, 
DOWNSAMPLING_FUNCTION_PROPERTY_DEFAULT
));

102 
down§m¶šgIÁ”v®
 = 
IÁeg”
.
	`v®ueOf
(
	`g‘Prİ”t›s
()

103 .
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_INTERVAL_PROPERTY
, 
DOWNSAMPLING_INTERVAL_PROPERTY_DEFAULT
));

105 
‹¡
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
TEST_PROPERTY
, 
TEST_PROPERTY_DEFAULT
));

106 
debug
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
DEBUG_PROPERTY
, 
DEBUG_PROPERTY_DEFAULT
));

109 @
Ov”ride


110 
public
 
fš®
 
Stus
 
	`»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

111 
M­
<
SŒšg
, 
Li¡
<SŒšg>> 
gQu”›s
 = 
Ãw
 
HashM­
<>();

112 
LÚg
 
time¡amp
 = 
nuÎ
;

113 
SŒšg
 
f›ld
 : 
f›lds
) {

114 ià(
f›ld
.
	`¡¬tsW™h
(
time¡ampKey
)) {

115 
SŒšg
[] 
time¡ampP¬ts
 = 
f›ld
.
	`¥l™
(
gPaœD–im™”
);

116 ià(
time¡ampP¬ts
[1].
	`cÚšs
(
qu”yTimeS·nD–im™”
)) {

119  
Stus
.
BAD_REQUEST
;

121 
time¡amp
 = 
LÚg
.
	`v®ueOf
(
time¡ampP¬ts
[1]);

123 
SŒšg
[] 
qu”yP¬ts
 = 
f›ld
.
	`¥l™
(
gPaœD–im™”
);

124 
gQu”›s
.
	`compu‹IfAb£Á
(
qu”yP¬ts
[0], 
k
 -> 
Ãw
 
A¼ayLi¡
<>()).
	`add
(queryParts[1]);

127 ià(
time¡amp
 =ğ
nuÎ
) {

128  
Stus
.
BAD_REQUEST
;

131  
	`»ad
(
bË
, 
time¡amp
, 
gQu”›s
);

132 
	}
}

142 
´Ùeùed
 
ab¡¿ù
 
Stus
 
»ad
(
SŒšg
 
m‘ric
, 
time¡amp
, 
M­
<SŒšg, 
Li¡
<SŒšg>> 
gs
);

149 @
Ov”ride


150 
public
 
fš®
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

151 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

152 
	gM­
<
	gSŒšg
, 
	gLi¡
<SŒšg>> 
	ggQu”›s
 = 
Ãw
 
HashM­
<>();

153 
	gTime£r›sDB
.
Agg»g©iÚO³¿tiÚ
 
	gagg»g©iÚO³¿tiÚ
 = 
Time£r›sDB
.Agg»g©iÚO³¿tiÚ.
NONE
;

154 
	gS‘
<
	gSŒšg
> 
	ggroupByF›lds
 = 
Ãw
 
HashS‘
<>();

156 
boŞ—n
 
	g¿ngeS‘
 = 
çl£
;

157 
	g¡¬t
 = 0;

158 
	g’d
 = 0;

159 
SŒšg
 
	gf›ld
 : 
f›lds
) {

160 ià(
f›ld
.
¡¬tsW™h
(
time¡ampKey
)) {

161 
SŒšg
[] 
time¡ampP¬ts
 = 
f›ld
.
¥l™
(
gPaœD–im™”
);

162 ià(!
	gtime¡ampP¬ts
[1].
cÚšs
(
qu”yTimeS·nD–im™”
)) {

166  
	gStus
.
	gNOT_IMPLEMENTED
;

168 
	gSŒšg
[] 
	g¿ngeP¬ts
 = 
time¡ampP¬ts
[1].
¥l™
(
qu”yTimeS·nD–im™”
);

169 
	g¿ngeS‘
 = 
Œue
;

170 
	g¡¬t
 = 
LÚg
.
v®ueOf
(
¿ngeP¬ts
[0]);

171 
	g’d
 = 
LÚg
.
v®ueOf
(
¿ngeP¬ts
[1]);

172 } ià(
	gf›ld
.
¡¬tsW™h
(
groupByKey
)) {

173 
SŒšg
 
	ggroupByS³cif›r
 = 
f›ld
.
¥l™
(
gPaœD–im™”
)[1];

174 
	gagg»g©iÚO³¿tiÚ
 = 
Time£r›sDB
.
Agg»g©iÚO³¿tiÚ
.
v®ueOf
(
groupByS³cif›r
);

175 } ià(
	gf›ld
.
¡¬tsW™h
(
down§m¶šgKey
)) {

176 
SŒšg
 
	gdown§m¶šgS³c
 = 
f›ld
.
¥l™
(
gPaœD–im™”
)[1];

178 ià(!
	gdown§m¶šgS³c
.
equ®s
(
down§m¶šgFunùiÚ
.
toSŒšg
(è+ 
down§m¶šgIÁ”v®
.toString())) {

179 
	gSy¡em
.
	g”r
.
´št
("Downsampling specification for Scan did‚ot match configured downsampling");

180  
	gStus
.
	gBAD_REQUEST
;

183 
	gSŒšg
[] 
	gqu”yP¬ts
 = 
f›ld
.
¥l™
(
gPaœD–im™”
);

184 ià(
	gqu”yP¬ts
.
	gËngth
 == 1) {

186 
Sy¡em
.
”r
.
´šn
("Grouping by‡rbitrary series is currently‚ot supported");

187 
	ggroupByF›lds
.
add
(
f›ld
);

189 
	ggQu”›s
.
compu‹IfAb£Á
(
qu”yP¬ts
[0], 
k
 -> 
Ãw
 
A¼ayLi¡
<>()).
add
(queryParts[1]);

193 ià(!
	g¿ngeS‘
) {

194  
	gStus
.
	gBAD_REQUEST
;

196  
sÿn
(
bË
, 
¡¬t
, 
’d
, 
gQu”›s
, 
down§m¶šgFunùiÚ
, 
down§m¶šgIÁ”v®
, 
time¡ampUn™
);

212 
´Ùeùed
 
ab¡¿ù
 
Stus
 
sÿn
(
SŒšg
 
m‘ric
, 
¡¬tTs
, 
’dTs
, 
M­
<SŒšg, 
Li¡
<SŒšg>> 
gs
,

213 
Agg»g©iÚO³¿tiÚ
 
agg»g
, 
timeV®ue
, 
TimeUn™
 
timeUn™
);

215 @
Ov”ride


216 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

217  
	gStus
.
	gNOT_IMPLEMENTED
;

222 @
Ov”ride


223 
public
 
fš®
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

224 
Num”icBy‹I‹¿tÜ
 
	gtsCÚš”
 = (Num”icBy‹I‹¿tÜè
v®ues
.
»move
(
time¡ampKey
);

225 
Num”icBy‹I‹¿tÜ
 
	gv®ueCÚš”
 = (Num”icBy‹I‹¿tÜè
v®ues
.
»move
(
v®ueKey
);

226 ià(
	gv®ueCÚš”
.
isFlßtšgPošt
()) {

227  
š£¹
(
bË
, 
tsCÚš”
.
g‘LÚg
(), 
v®ueCÚš”
.
g‘DoubË
(), 
v®ues
);

229  
š£¹
(
bË
, 
tsCÚš”
.
g‘LÚg
(), 
v®ueCÚš”
.g‘LÚg(), 
v®ues
);

243 
´Ùeùed
 
ab¡¿ù
 
Stus
 
š£¹
(
SŒšg
 
m‘ric
, 
time¡amp
, 
v®ue
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
gs
);

255 
´Ùeùed
 
ab¡¿ù
 
Stus
 
š£¹
(
SŒšg
 
m‘ric
, 
time¡amp
, 
v®ue
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
gs
);

264 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

265  
Stus
.
NOT_IMPLEMENTED
;

266 
	}
}

282 
´Ùeùed
 
	gSŒšg
[] 
	$g‘PossibËTagKeys
(
Prİ”t›s
 
´İ”t›s
) {

283 
fš®
 
gCouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
TAG_COUNT_PROPERTY
,

284 
TimeS”›sWÜklßd
.
TAG_COUNT_PROPERTY_DEFAULT
));

285 
fš®
 
gKeyËngth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
TAG_KEY_LENGTH_PROPERTY
,

286 
TimeS”›sWÜklßd
.
TAG_KEY_LENGTH_PROPERTY_DEFAULT
));

288 
G’”©Ü
<
SŒšg
> 
gKeyG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
gKeyËngth
);

289 
SŒšg
[] 
gNames
 = 
Ãw
 SŒšg[
gCouÁ
];

290 
i
 = 0; i < 
gCouÁ
; i++) {

291 
gNames
[
i
] = 
gKeyG’”©Ü
.
	`ÃxtV®ue
();

293  
gNames
;

294 
	}
}

305 
public
 
	eAgg»g©iÚO³¿tiÚ
 {

309 
	gNONE
,

314 
	gSUM
,

319 
	gAVERAGE
,

324 
	gCOUNT
,

329 
	gMAX
,

334 
	gMIN
;

	@TimeseriesDB.java

17 
·ckage
 
	gs™e
.
	gycsb
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gG’”©Ü
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gInüem’tšgPršbËSŒšgG’”©Ü
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gwÜklßds
.
	gTimeS”›sWÜklßd
;

23 
impÜt
 
	gjava
.
	gut
.*;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

39 
public
 
ab¡¿ù
 cÏs 
	cTime£r›sDB
 
ex‹nds
 
	mDB
 {

42 
´iv©e
 
fš®
 
SŒšg
 
	mDOWNSAMPLING_FUNCTION_PROPERTY_DEFAULT
 = "NONE";

43 
´iv©e
 
fš®
 
SŒšg
 
	mDOWNSAMPLING_INTERVAL_PROPERTY_DEFAULT
 = "0";

46 
´iv©e
 
fš®
 
SŒšg
 
	mDEBUG_PROPERTY
 = "debug";

47 
´iv©e
 
fš®
 
SŒšg
 
	mDEBUG_PROPERTY_DEFAULT
 = "false";

50 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_PROPERTY
 = "test";

51 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_PROPERTY_DEFAULT
 = "false";

54 
´Ùeùed
 
SŒšg
 
	mtime¡ampKey
;

55 
´Ùeùed
 
SŒšg
 
	mv®ueKey
;

56 
´Ùeùed
 
SŒšg
 
	mgPaœD–im™”
;

57 
´Ùeùed
 
SŒšg
 
	mqu”yTimeS·nD–im™”
;

58 
´Ùeùed
 
SŒšg
 
	md–‘eD–im™”
;

59 
´Ùeùed
 
TimeUn™
 
	mtime¡ampUn™
;

60 
´Ùeùed
 
SŒšg
 
	mgroupByKey
;

61 
´Ùeùed
 
SŒšg
 
	mdown§m¶šgKey
;

62 
´Ùeùed
 
IÁeg”
 
	mdown§m¶šgIÁ”v®
;

63 
´Ùeùed
 
Agg»g©iÚO³¿tiÚ
 
	mdown§m¶šgFunùiÚ
;

66 
´Ùeùed
 
boŞ—n
 
	mdebug
;

67 
´Ùeùed
 
boŞ—n
 
	m‹¡
;

73 @
Ov”ride


74 
public
 
	$š™
(è
throws
 
DBExû±iÚ
 {

76 
time¡ampKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

77 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY
,

78 
TimeS”›sWÜklßd
.
TIMESTAMP_KEY_PROPERTY_DEFAULT
);

79 
v®ueKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

80 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY
,

81 
TimeS”›sWÜklßd
.
VALUE_KEY_PROPERTY_DEFAULT
);

82 
gPaœD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

83 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY
,

84 
TimeS”›sWÜklßd
.
PAIR_DELIMITER_PROPERTY_DEFAULT
);

85 
qu”yTimeS·nD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

86 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY
,

87 
TimeS”›sWÜklßd
.
QUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
);

88 
d–‘eD–im™”
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

89 
TimeS”›sWÜklßd
.
DELETE_DELIMITER_PROPERTY
,

90 
TimeS”›sWÜklßd
.
DELETE_DELIMITER_PROPERTY_DEFAULT
);

91 
time¡ampUn™
 = 
TimeUn™
.
	`v®ueOf
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

92 
TimeS”›sWÜklßd
.
TIMESTAMP_UNITS_PROPERTY
,

93 
TimeS”›sWÜklßd
.
TIMESTAMP_UNITS_PROPERTY_DEFAULT
));

94 
groupByKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

95 
TimeS”›sWÜklßd
.
GROUPBY_KEY_PROPERTY
,

96 
TimeS”›sWÜklßd
.
GROUPBY_KEY_PROPERTY_DEFAULT
);

97 
down§m¶šgKey
 = 
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(

98 
TimeS”›sWÜklßd
.
DOWNSAMPLING_KEY_PROPERTY
,

99 
TimeS”›sWÜklßd
.
DOWNSAMPLING_KEY_PROPERTY_DEFAULT
);

100 
down§m¶šgFunùiÚ
 = 
Time£r›sDB
.
Agg»g©iÚO³¿tiÚ
.
	`v®ueOf
(
	`g‘Prİ”t›s
()

101 .
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_FUNCTION_PROPERTY
, 
DOWNSAMPLING_FUNCTION_PROPERTY_DEFAULT
));

102 
down§m¶šgIÁ”v®
 = 
IÁeg”
.
	`v®ueOf
(
	`g‘Prİ”t›s
()

103 .
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
DOWNSAMPLING_INTERVAL_PROPERTY
, 
DOWNSAMPLING_INTERVAL_PROPERTY_DEFAULT
));

105 
‹¡
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
TEST_PROPERTY
, 
TEST_PROPERTY_DEFAULT
));

106 
debug
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
DEBUG_PROPERTY
, 
DEBUG_PROPERTY_DEFAULT
));

109 @
Ov”ride


110 
public
 
fš®
 
Stus
 
	`»ad
(
SŒšg
 
bË
, SŒšg 
key
, 
S‘
<SŒšg> 
f›lds
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
»suÉ
) {

111 
M­
<
SŒšg
, 
Li¡
<SŒšg>> 
gQu”›s
 = 
Ãw
 
HashM­
<>();

112 
LÚg
 
time¡amp
 = 
nuÎ
;

113 
SŒšg
 
f›ld
 : 
f›lds
) {

114 ià(
f›ld
.
	`¡¬tsW™h
(
time¡ampKey
)) {

115 
SŒšg
[] 
time¡ampP¬ts
 = 
f›ld
.
	`¥l™
(
gPaœD–im™”
);

116 ià(
time¡ampP¬ts
[1].
	`cÚšs
(
qu”yTimeS·nD–im™”
)) {

119  
Stus
.
BAD_REQUEST
;

121 
time¡amp
 = 
LÚg
.
	`v®ueOf
(
time¡ampP¬ts
[1]);

123 
SŒšg
[] 
qu”yP¬ts
 = 
f›ld
.
	`¥l™
(
gPaœD–im™”
);

124 
gQu”›s
.
	`compu‹IfAb£Á
(
qu”yP¬ts
[0], 
k
 -> 
Ãw
 
A¼ayLi¡
<>()).
	`add
(queryParts[1]);

127 ià(
time¡amp
 =ğ
nuÎ
) {

128  
Stus
.
BAD_REQUEST
;

131  
	`»ad
(
bË
, 
time¡amp
, 
gQu”›s
);

132 
	}
}

142 
´Ùeùed
 
ab¡¿ù
 
Stus
 
»ad
(
SŒšg
 
m‘ric
, 
time¡amp
, 
M­
<SŒšg, 
Li¡
<SŒšg>> 
gs
);

149 @
Ov”ride


150 
public
 
fš®
 
Stus
 
sÿn
(
SŒšg
 
bË
, SŒšg 
¡¬tkey
, 
»cÜdcouÁ
, 
S‘
<SŒšg> 
f›lds
,

151 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉ
) {

152 
	gM­
<
	gSŒšg
, 
	gLi¡
<SŒšg>> 
	ggQu”›s
 = 
Ãw
 
HashM­
<>();

153 
	gTime£r›sDB
.
Agg»g©iÚO³¿tiÚ
 
	gagg»g©iÚO³¿tiÚ
 = 
Time£r›sDB
.Agg»g©iÚO³¿tiÚ.
NONE
;

154 
	gS‘
<
	gSŒšg
> 
	ggroupByF›lds
 = 
Ãw
 
HashS‘
<>();

156 
boŞ—n
 
	g¿ngeS‘
 = 
çl£
;

157 
	g¡¬t
 = 0;

158 
	g’d
 = 0;

159 
SŒšg
 
	gf›ld
 : 
f›lds
) {

160 ià(
f›ld
.
¡¬tsW™h
(
time¡ampKey
)) {

161 
SŒšg
[] 
time¡ampP¬ts
 = 
f›ld
.
¥l™
(
gPaœD–im™”
);

162 ià(!
	gtime¡ampP¬ts
[1].
cÚšs
(
qu”yTimeS·nD–im™”
)) {

166  
	gStus
.
	gNOT_IMPLEMENTED
;

168 
	gSŒšg
[] 
	g¿ngeP¬ts
 = 
time¡ampP¬ts
[1].
¥l™
(
qu”yTimeS·nD–im™”
);

169 
	g¿ngeS‘
 = 
Œue
;

170 
	g¡¬t
 = 
LÚg
.
v®ueOf
(
¿ngeP¬ts
[0]);

171 
	g’d
 = 
LÚg
.
v®ueOf
(
¿ngeP¬ts
[1]);

172 } ià(
	gf›ld
.
¡¬tsW™h
(
groupByKey
)) {

173 
SŒšg
 
	ggroupByS³cif›r
 = 
f›ld
.
¥l™
(
gPaœD–im™”
)[1];

174 
	gagg»g©iÚO³¿tiÚ
 = 
Time£r›sDB
.
Agg»g©iÚO³¿tiÚ
.
v®ueOf
(
groupByS³cif›r
);

175 } ià(
	gf›ld
.
¡¬tsW™h
(
down§m¶šgKey
)) {

176 
SŒšg
 
	gdown§m¶šgS³c
 = 
f›ld
.
¥l™
(
gPaœD–im™”
)[1];

178 ià(!
	gdown§m¶šgS³c
.
equ®s
(
down§m¶šgFunùiÚ
.
toSŒšg
(è+ 
down§m¶šgIÁ”v®
.toString())) {

179 
	gSy¡em
.
	g”r
.
´št
("Downsampling specification for Scan did‚ot match configured downsampling");

180  
	gStus
.
	gBAD_REQUEST
;

183 
	gSŒšg
[] 
	gqu”yP¬ts
 = 
f›ld
.
¥l™
(
gPaœD–im™”
);

184 ià(
	gqu”yP¬ts
.
	gËngth
 == 1) {

186 
Sy¡em
.
”r
.
´šn
("Grouping by‡rbitrary series is currently‚ot supported");

187 
	ggroupByF›lds
.
add
(
f›ld
);

189 
	ggQu”›s
.
compu‹IfAb£Á
(
qu”yP¬ts
[0], 
k
 -> 
Ãw
 
A¼ayLi¡
<>()).
add
(queryParts[1]);

193 ià(!
	g¿ngeS‘
) {

194  
	gStus
.
	gBAD_REQUEST
;

196  
sÿn
(
bË
, 
¡¬t
, 
’d
, 
gQu”›s
, 
down§m¶šgFunùiÚ
, 
down§m¶šgIÁ”v®
, 
time¡ampUn™
);

212 
´Ùeùed
 
ab¡¿ù
 
Stus
 
sÿn
(
SŒšg
 
m‘ric
, 
¡¬tTs
, 
’dTs
, 
M­
<SŒšg, 
Li¡
<SŒšg>> 
gs
,

213 
Agg»g©iÚO³¿tiÚ
 
agg»g
, 
timeV®ue
, 
TimeUn™
 
timeUn™
);

215 @
Ov”ride


216 
public
 
Stus
 
upd©e
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

217  
	gStus
.
	gNOT_IMPLEMENTED
;

222 @
Ov”ride


223 
public
 
fš®
 
Stus
 
š£¹
(
SŒšg
 
bË
, SŒšg 
key
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
v®ues
) {

224 
Num”icBy‹I‹¿tÜ
 
	gtsCÚš”
 = (Num”icBy‹I‹¿tÜè
v®ues
.
»move
(
time¡ampKey
);

225 
Num”icBy‹I‹¿tÜ
 
	gv®ueCÚš”
 = (Num”icBy‹I‹¿tÜè
v®ues
.
»move
(
v®ueKey
);

226 ià(
	gv®ueCÚš”
.
isFlßtšgPošt
()) {

227  
š£¹
(
bË
, 
tsCÚš”
.
g‘LÚg
(), 
v®ueCÚš”
.
g‘DoubË
(), 
v®ues
);

229  
š£¹
(
bË
, 
tsCÚš”
.
g‘LÚg
(), 
v®ueCÚš”
.g‘LÚg(), 
v®ues
);

243 
´Ùeùed
 
ab¡¿ù
 
Stus
 
š£¹
(
SŒšg
 
m‘ric
, 
time¡amp
, 
v®ue
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
gs
);

255 
´Ùeùed
 
ab¡¿ù
 
Stus
 
š£¹
(
SŒšg
 
m‘ric
, 
time¡amp
, 
v®ue
, 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
gs
);

264 
public
 
Stus
 
	$d–‘e
(
SŒšg
 
bË
, SŒšg 
key
) {

265  
Stus
.
NOT_IMPLEMENTED
;

266 
	}
}

282 
´Ùeùed
 
	gSŒšg
[] 
	$g‘PossibËTagKeys
(
Prİ”t›s
 
´İ”t›s
) {

283 
fš®
 
gCouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
TAG_COUNT_PROPERTY
,

284 
TimeS”›sWÜklßd
.
TAG_COUNT_PROPERTY_DEFAULT
));

285 
fš®
 
gKeyËngth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
TimeS”›sWÜklßd
.
TAG_KEY_LENGTH_PROPERTY
,

286 
TimeS”›sWÜklßd
.
TAG_KEY_LENGTH_PROPERTY_DEFAULT
));

288 
G’”©Ü
<
SŒšg
> 
gKeyG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
gKeyËngth
);

289 
SŒšg
[] 
gNames
 = 
Ãw
 SŒšg[
gCouÁ
];

290 
i
 = 0; i < 
gCouÁ
; i++) {

291 
gNames
[
i
] = 
gKeyG’”©Ü
.
	`ÃxtV®ue
();

293  
gNames
;

294 
	}
}

305 
public
 
	eAgg»g©iÚO³¿tiÚ
 {

309 
	gNONE
,

314 
	gSUM
,

319 
	gAVERAGE
,

324 
	gCOUNT
,

329 
	gMAX
,

334 
	gMIN
;

	@UnknownDBException.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cUnknownDBExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

27 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 459099842269616836L;

29 
public
 
	$UnknownDBExû±iÚ
(
SŒšg
 
mes§ge
) {

30 
	`su³r
(
mes§ge
);

33 
public
 
	$UnknownDBExû±iÚ
() {

34 
	`su³r
();

35 
	}
}

37 
public
 
	$UnknownDBExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

38 
	`su³r
(
mes§ge
, 
ÿu£
);

39 
	}
}

41 
public
 
	$UnknownDBExû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@UnknownDBException.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cUnknownDBExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

27 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 459099842269616836L;

29 
public
 
	$UnknownDBExû±iÚ
(
SŒšg
 
mes§ge
) {

30 
	`su³r
(
mes§ge
);

33 
public
 
	$UnknownDBExû±iÚ
() {

34 
	`su³r
();

35 
	}
}

37 
public
 
	$UnknownDBExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

38 
	`su³r
(
mes§ge
, 
ÿu£
);

39 
	}
}

41 
public
 
	$UnknownDBExû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@Utils.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gG¬bageCŞËùÜMXB—n
;

21 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gMªagem’tFaùÜy
;

22 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gO³¿tšgSy¡emMXB—n
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

31 
public
 
fš®
 cÏs 
	cUts
 {

32 
´iv©e
 
	$Uts
() {

39 
public
 
	$hash
(
v®
) {

40  
	`âvhash64
(
v®
);

41 
	}
}

43 
public
 
fš®
 
	gFNV_OFFSET_BASIS_64
 = 0xCBF29CE484222325L;

44 
public
 
fš®
 
	gFNV_PRIME_64
 = 1099511628211L;

52 
public
 
	$âvhash64
(
v®
) {

54 
hashv®
 = 
FNV_OFFSET_BASIS_64
;

56 
i
 = 0; i < 8; i++) {

57 
où‘
 = 
v®
 & 0x00ff;

58 
v®
 = val >> 8;

60 
hashv®
 = hashv® ^ 
où‘
;

61 
hashv®
 = hashv® * 
FNV_PRIME_64
;

64  
M©h
.
	`abs
(
hashv®
);

65 
	}
}

74 
public
 
	$by‹sToLÚg
(
fš®
 
by‹
[] 
by‹s
) {

75  (
by‹s
[0] & 0xFFL) << 56

76 | (
by‹s
[1] & 0xFFL) << 48

77 | (
by‹s
[2] & 0xFFL) << 40

78 | (
by‹s
[3] & 0xFFL) << 32

79 | (
by‹s
[4] & 0xFFL) << 24

80 | (
by‹s
[5] & 0xFFL) << 16

81 | (
by‹s
[6] & 0xFFL) << 8

82 | (
by‹s
[7] & 0xFFL) << 0;

83 
	}
}

90 
public
 
	gby‹
[] 
	$lÚgToBy‹s
(
fš®
 
v®
) {

91 
fš®
 
by‹
[] 
by‹s
 = 
Ãw
 byte[8];

92 
by‹s
[0] = (
by‹
è(
v®
 >>> 56);

93 
by‹s
[1] = (
by‹
è(
v®
 >>> 48);

94 
by‹s
[2] = (
by‹
è(
v®
 >>> 40);

95 
by‹s
[3] = (
by‹
è(
v®
 >>> 32);

96 
by‹s
[4] = (
by‹
è(
v®
 >>> 24);

97 
by‹s
[5] = (
by‹
è(
v®
 >>> 16);

98 
by‹s
[6] = (
by‹
è(
v®
 >>> 8);

99 
by‹s
[7] = (
by‹
è(
v®
 >>> 0);

100  
by‹s
;

101 
	}
}

112 
public
 
	$by‹sToDoubË
(
fš®
 
by‹
[] 
by‹s
) {

113 ià(
by‹s
.
Ëngth
 < 8) {

114 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Byte‡rray must be 8 bytes wide.");

116  
DoubË
.
	`lÚgB™sToDoubË
(
	`by‹sToLÚg
(
by‹s
));

117 
	}
}

124 
public
 
	gby‹
[] 
	$doubËToBy‹s
(
fš®
 
v®
) {

125  
	`lÚgToBy‹s
(
DoubË
.
	`doubËToRawLÚgB™s
(
v®
));

126 
	}
}

138 
public
 
	$g‘AùiveTh»adCouÁ
() {

139  
Th»ad
.
	`aùiveCouÁ
();

140 
	}
}

143 
public
 
	$g‘U£dMemÜyBy‹s
() {

144 
fš®
 
RuÁime
 
ruÁime
 = RuÁime.
	`g‘RuÁime
();

145  
ruÁime
.
	`tÙ®MemÜy
(è-„uÁime.
	`ä“MemÜy
();

146 
	}
}

149 
public
 
	$g‘U£dMemÜyMegaBy‹s
() {

150  (è(
	`g‘U£dMemÜyBy‹s
() / 1024 / 1024);

151 
	}
}

155 
public
 
	$g‘Sy¡emLßdAv”age
() {

156 
fš®
 
O³¿tšgSy¡emMXB—n
 
osB—n
 =

157 
Mªagem’tFaùÜy
.
	`g‘O³¿tšgSy¡emMXB—n
();

158  
osB—n
.
	`g‘Sy¡emLßdAv”age
();

159 
	}
}

163 
public
 
	$g‘GCTÙ®CŞËùiÚCouÁ
() {

164 
fš®
 
Li¡
<
G¬bageCŞËùÜMXB—n
> 
gcB—ns
 =

165 
Mªagem’tFaùÜy
.
	`g‘G¬bageCŞËùÜMXB—ns
();

166 
couÁ
 = 0;

167 
fš®
 
G¬bageCŞËùÜMXB—n
 
b—n
 : 
gcB—ns
) {

168 ià(
b—n
.
	`g‘CŞËùiÚCouÁ
() < 0) {

171 
couÁ
 +ğ
b—n
.
	`g‘CŞËùiÚCouÁ
();

173  
couÁ
;

174 
	}
}

177 
public
 
	$g‘GCTÙ®Time
() {

178 
fš®
 
Li¡
<
G¬bageCŞËùÜMXB—n
> 
gcB—ns
 =

179 
Mªagem’tFaùÜy
.
	`g‘G¬bageCŞËùÜMXB—ns
();

180 
time
 = 0;

181 
fš®
 
G¬bageCŞËùÜMXB—n
 
b—n
 : 
gcB—ns
) {

182 ià(
b—n
.
	`g‘CŞËùiÚTime
() < 0) {

185 
time
 +ğ
b—n
.
	`g‘CŞËùiÚTime
();

187  
time
;

188 
	}
}

199 
public
 
	gM­
<
	gSŒšg
, 
	gLÚg
[]> 
	$g‘GCSt¡
() {

200 
fš®
 
Li¡
<
G¬bageCŞËùÜMXB—n
> 
gcB—ns
 =

201 
Mªagem’tFaùÜy
.
	`g‘G¬bageCŞËùÜMXB—ns
();

202 
fš®
 
M­
<
SŒšg
, 
LÚg
[]> 
m­
 = 
Ãw
 
HashM­
<SŒšg, LÚg[]>(
gcB—ns
.
	`size
());

203 
fš®
 
G¬bageCŞËùÜMXB—n
 
b—n
 : 
gcB—ns
) {

204 ià(!
b—n
.
	`isV®id
(è|| b—n.
	`g‘CŞËùiÚCouÁ
() < 0 ||

205 
b—n
.
	`g‘CŞËùiÚTime
() < 0) {

209 
fš®
 
LÚg
[] 
m—su»m’ts
 = 
Ãw
 Long[]{

210 
b—n
.
	`g‘CŞËùiÚCouÁ
(),

211 
b—n
.
	`g‘CŞËùiÚTime
()

213 
m­
.
	`put
(
b—n
.
	`g‘Name
().
	`»¶aû
(" ", "_"), 
m—su»m’ts
);

215  
m­
;

216 
	}
}

223 
public
 <
	gT
> T [] 
	$shufæeA¼ay
(
fš®
 
T
[] 
¬¿y
) {

224 
i
 = 
¬¿y
.
Ëngth
 -1; i > 0; i--) {

225 
fš®
 
idx
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
(
i
 + 1);

226 
fš®
 
T
 
‹mp
 = 
¬¿y
[
idx
];

227 
¬¿y
[
idx
] =‡¼ay[
i
];

228 
¬¿y
[
i
] = 
‹mp
;

230  
¬¿y
;

231 
	}
}

	@Utils.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gG¬bageCŞËùÜMXB—n
;

21 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gMªagem’tFaùÜy
;

22 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gO³¿tšgSy¡emMXB—n
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

31 
public
 
fš®
 cÏs 
	cUts
 {

32 
´iv©e
 
	$Uts
() {

39 
public
 
	$hash
(
v®
) {

40  
	`âvhash64
(
v®
);

41 
	}
}

43 
public
 
fš®
 
	gFNV_OFFSET_BASIS_64
 = 0xCBF29CE484222325L;

44 
public
 
fš®
 
	gFNV_PRIME_64
 = 1099511628211L;

52 
public
 
	$âvhash64
(
v®
) {

54 
hashv®
 = 
FNV_OFFSET_BASIS_64
;

56 
i
 = 0; i < 8; i++) {

57 
où‘
 = 
v®
 & 0x00ff;

58 
v®
 = val >> 8;

60 
hashv®
 = hashv® ^ 
où‘
;

61 
hashv®
 = hashv® * 
FNV_PRIME_64
;

64  
M©h
.
	`abs
(
hashv®
);

65 
	}
}

74 
public
 
	$by‹sToLÚg
(
fš®
 
by‹
[] 
by‹s
) {

75  (
by‹s
[0] & 0xFFL) << 56

76 | (
by‹s
[1] & 0xFFL) << 48

77 | (
by‹s
[2] & 0xFFL) << 40

78 | (
by‹s
[3] & 0xFFL) << 32

79 | (
by‹s
[4] & 0xFFL) << 24

80 | (
by‹s
[5] & 0xFFL) << 16

81 | (
by‹s
[6] & 0xFFL) << 8

82 | (
by‹s
[7] & 0xFFL) << 0;

83 
	}
}

90 
public
 
	gby‹
[] 
	$lÚgToBy‹s
(
fš®
 
v®
) {

91 
fš®
 
by‹
[] 
by‹s
 = 
Ãw
 byte[8];

92 
by‹s
[0] = (
by‹
è(
v®
 >>> 56);

93 
by‹s
[1] = (
by‹
è(
v®
 >>> 48);

94 
by‹s
[2] = (
by‹
è(
v®
 >>> 40);

95 
by‹s
[3] = (
by‹
è(
v®
 >>> 32);

96 
by‹s
[4] = (
by‹
è(
v®
 >>> 24);

97 
by‹s
[5] = (
by‹
è(
v®
 >>> 16);

98 
by‹s
[6] = (
by‹
è(
v®
 >>> 8);

99 
by‹s
[7] = (
by‹
è(
v®
 >>> 0);

100  
by‹s
;

101 
	}
}

112 
public
 
	$by‹sToDoubË
(
fš®
 
by‹
[] 
by‹s
) {

113 ià(
by‹s
.
Ëngth
 < 8) {

114 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Byte‡rray must be 8 bytes wide.");

116  
DoubË
.
	`lÚgB™sToDoubË
(
	`by‹sToLÚg
(
by‹s
));

117 
	}
}

124 
public
 
	gby‹
[] 
	$doubËToBy‹s
(
fš®
 
v®
) {

125  
	`lÚgToBy‹s
(
DoubË
.
	`doubËToRawLÚgB™s
(
v®
));

126 
	}
}

138 
public
 
	$g‘AùiveTh»adCouÁ
() {

139  
Th»ad
.
	`aùiveCouÁ
();

140 
	}
}

143 
public
 
	$g‘U£dMemÜyBy‹s
() {

144 
fš®
 
RuÁime
 
ruÁime
 = RuÁime.
	`g‘RuÁime
();

145  
ruÁime
.
	`tÙ®MemÜy
(è-„uÁime.
	`ä“MemÜy
();

146 
	}
}

149 
public
 
	$g‘U£dMemÜyMegaBy‹s
() {

150  (è(
	`g‘U£dMemÜyBy‹s
() / 1024 / 1024);

151 
	}
}

155 
public
 
	$g‘Sy¡emLßdAv”age
() {

156 
fš®
 
O³¿tšgSy¡emMXB—n
 
osB—n
 =

157 
Mªagem’tFaùÜy
.
	`g‘O³¿tšgSy¡emMXB—n
();

158  
osB—n
.
	`g‘Sy¡emLßdAv”age
();

159 
	}
}

163 
public
 
	$g‘GCTÙ®CŞËùiÚCouÁ
() {

164 
fš®
 
Li¡
<
G¬bageCŞËùÜMXB—n
> 
gcB—ns
 =

165 
Mªagem’tFaùÜy
.
	`g‘G¬bageCŞËùÜMXB—ns
();

166 
couÁ
 = 0;

167 
fš®
 
G¬bageCŞËùÜMXB—n
 
b—n
 : 
gcB—ns
) {

168 ià(
b—n
.
	`g‘CŞËùiÚCouÁ
() < 0) {

171 
couÁ
 +ğ
b—n
.
	`g‘CŞËùiÚCouÁ
();

173  
couÁ
;

174 
	}
}

177 
public
 
	$g‘GCTÙ®Time
() {

178 
fš®
 
Li¡
<
G¬bageCŞËùÜMXB—n
> 
gcB—ns
 =

179 
Mªagem’tFaùÜy
.
	`g‘G¬bageCŞËùÜMXB—ns
();

180 
time
 = 0;

181 
fš®
 
G¬bageCŞËùÜMXB—n
 
b—n
 : 
gcB—ns
) {

182 ià(
b—n
.
	`g‘CŞËùiÚTime
() < 0) {

185 
time
 +ğ
b—n
.
	`g‘CŞËùiÚTime
();

187  
time
;

188 
	}
}

199 
public
 
	gM­
<
	gSŒšg
, 
	gLÚg
[]> 
	$g‘GCSt¡
() {

200 
fš®
 
Li¡
<
G¬bageCŞËùÜMXB—n
> 
gcB—ns
 =

201 
Mªagem’tFaùÜy
.
	`g‘G¬bageCŞËùÜMXB—ns
();

202 
fš®
 
M­
<
SŒšg
, 
LÚg
[]> 
m­
 = 
Ãw
 
HashM­
<SŒšg, LÚg[]>(
gcB—ns
.
	`size
());

203 
fš®
 
G¬bageCŞËùÜMXB—n
 
b—n
 : 
gcB—ns
) {

204 ià(!
b—n
.
	`isV®id
(è|| b—n.
	`g‘CŞËùiÚCouÁ
() < 0 ||

205 
b—n
.
	`g‘CŞËùiÚTime
() < 0) {

209 
fš®
 
LÚg
[] 
m—su»m’ts
 = 
Ãw
 Long[]{

210 
b—n
.
	`g‘CŞËùiÚCouÁ
(),

211 
b—n
.
	`g‘CŞËùiÚTime
()

213 
m­
.
	`put
(
b—n
.
	`g‘Name
().
	`»¶aû
(" ", "_"), 
m—su»m’ts
);

215  
m­
;

216 
	}
}

223 
public
 <
	gT
> T [] 
	$shufæeA¼ay
(
fš®
 
T
[] 
¬¿y
) {

224 
i
 = 
¬¿y
.
Ëngth
 -1; i > 0; i--) {

225 
fš®
 
idx
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
(
i
 + 1);

226 
fš®
 
T
 
‹mp
 = 
¬¿y
[
idx
];

227 
¬¿y
[
idx
] =‡¼ay[
i
];

228 
¬¿y
[
i
] = 
‹mp
;

230  
¬¿y
;

231 
	}
}

	@Workload.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

21 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

38 
public
 
ab¡¿ù
 cÏs 
	cWÜklßd
 {

39 
public
 
fš®
 
SŒšg
 
	mINSERT_START_PROPERTY
 = "insertstart";

40 
public
 
fš®
 
SŒšg
 
	mINSERT_COUNT_PROPERTY
 = "insertcount";

42 
public
 
fš®
 
SŒšg
 
	mINSERT_START_PROPERTY_DEFAULT
 = "0";

44 
´iv©e
 vŞ©
AtomicBoŞ—n
 
	m¡İReque¡ed
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

47 
public
 
	eO³¿tiÚ
 {

48 
	mREAD
,

49 
	mUPDATE
,

50 
	mINSERT
,

51 
	mSCAN
,

52 
	mDELETE


59 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

60 
	}
}

76 
public
 
Objeù
 
	$š™Th»ad
(
Prİ”t›s
 
p
, 
myth»adid
, 
th»adcouÁ
è
throws
 
WÜklßdExû±iÚ
 {

77  
nuÎ
;

78 
	}
}

83 
public
 
	$ş—nup
(è
throws
 
WÜklßdExû±iÚ
 {

84 
	}
}

93 
public
 
ab¡¿ù
 
boŞ—n
 
doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
);

106 
public
 
ab¡¿ù
 
boŞ—n
 
doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
);

111 
public
 
	$»que¡Stİ
() {

112 
¡İReque¡ed
.
	`£t
(
Œue
);

113 
	}
}

119 
public
 
boŞ—n
 
	$isStİReque¡ed
() {

120  
¡İReque¡ed
.
	`g‘
();

121 
	}
}

	@Workload.java

18 
·ckage
 
	gs™e
.
	gycsb
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

21 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

38 
public
 
ab¡¿ù
 cÏs 
	cWÜklßd
 {

39 
public
 
fš®
 
SŒšg
 
	mINSERT_START_PROPERTY
 = "insertstart";

40 
public
 
fš®
 
SŒšg
 
	mINSERT_COUNT_PROPERTY
 = "insertcount";

42 
public
 
fš®
 
SŒšg
 
	mINSERT_START_PROPERTY_DEFAULT
 = "0";

44 
´iv©e
 vŞ©
AtomicBoŞ—n
 
	m¡İReque¡ed
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

47 
public
 
	eO³¿tiÚ
 {

48 
	mREAD
,

49 
	mUPDATE
,

50 
	mINSERT
,

51 
	mSCAN
,

52 
	mDELETE


59 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

60 
	}
}

76 
public
 
Objeù
 
	$š™Th»ad
(
Prİ”t›s
 
p
, 
myth»adid
, 
th»adcouÁ
è
throws
 
WÜklßdExû±iÚ
 {

77  
nuÎ
;

78 
	}
}

83 
public
 
	$ş—nup
(è
throws
 
WÜklßdExû±iÚ
 {

84 
	}
}

93 
public
 
ab¡¿ù
 
boŞ—n
 
doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
);

106 
public
 
ab¡¿ù
 
boŞ—n
 
doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
);

111 
public
 
	$»que¡Stİ
() {

112 
¡İReque¡ed
.
	`£t
(
Œue
);

113 
	}
}

119 
public
 
boŞ—n
 
	$isStİReque¡ed
() {

120  
¡İReque¡ed
.
	`g‘
();

121 
	}
}

	@WorkloadException.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cWÜklßdExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

27 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 8844396756042772132L;

29 
public
 
	$WÜklßdExû±iÚ
(
SŒšg
 
mes§ge
) {

30 
	`su³r
(
mes§ge
);

33 
public
 
	$WÜklßdExû±iÚ
() {

34 
	`su³r
();

35 
	}
}

37 
public
 
	$WÜklßdExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

38 
	`su³r
(
mes§ge
, 
ÿu£
);

39 
	}
}

41 
public
 
	$WÜklßdExû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@WorkloadException.java

18 
·ckage
 
	gs™e
.
	gycsb
;

23 
public
 cÏs 
	cWÜklßdExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

27 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 8844396756042772132L;

29 
public
 
	$WÜklßdExû±iÚ
(
SŒšg
 
mes§ge
) {

30 
	`su³r
(
mes§ge
);

33 
public
 
	$WÜklßdExû±iÚ
() {

34 
	`su³r
();

35 
	}
}

37 
public
 
	$WÜklßdExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

38 
	`su³r
(
mes§ge
, 
ÿu£
);

39 
	}
}

41 
public
 
	$WÜklßdExû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@cscope.file

2 ./
	g·ckage
-
	gšfo
.
	gjava


3 ./
	gBy‹A¼ayBy‹I‹¿tÜ
.
	gjava


4 ./
	gSŒšgBy‹I‹¿tÜ
.
	gjava


5 ./
	gUts
.
	gjava


6 ./
	gcscİe
.
	gfe


7 ./
	gTime£r›sDB
.
	gjava


8 ./
	gCl›Á
.
	gjava


9 ./
	gWÜklßdExû±iÚ
.
	gjava


10 ./
	gWÜklßd
.
	gjava


11 ./
	gCommªdLše
.
	gjava


12 ./
	gCl›ÁTh»ad
.
	gjava


13 ./
	gBasicDB
.
	gjava


14 ./
	gDBFaùÜy
.
	gjava


15 ./
	gm—su»m’ts


16 ./
	gm—su»m’ts
/
	g·ckage
-
	gšfo
.
	gjava


17 ./
	gm—su»m’ts
/
	gOÃM—su»m’tHi¡og¿m
.
	gjava


18 ./
	gm—su»m’ts
/
	gOÃM—su»m’t
.
	gjava


19 ./
	gm—su»m’ts
/
	gTwoInOÃM—su»m’t
.
	gjava


20 ./
	gm—su»m’ts
/
	gOÃM—su»m’tHdrHi¡og¿m
.
	gjava


21 ./
	gm—su»m’ts
/
	gOÃM—su»m’tTimeS”›s
.
	gjava


22 ./
	gm—su»m’ts
/
	gexpÜ‹r


23 ./
	gm—su»m’ts
/
	gexpÜ‹r
/
	g·ckage
-
	gšfo
.
	gjava


24 ./
	gm—su»m’ts
/
	gexpÜ‹r
/
	gJSONA¼ayM—su»m’tsExpÜ‹r
.
	gjava


25 ./
	gm—su»m’ts
/
	gexpÜ‹r
/
	gJSONM—su»m’tsExpÜ‹r
.
	gjava


26 ./
	gm—su»m’ts
/
	gexpÜ‹r
/
	gM—su»m’tsExpÜ‹r
.
	gjava


27 ./
	gm—su»m’ts
/
	gexpÜ‹r
/
	gTextM—su»m’tsExpÜ‹r
.
	gjava


28 ./
	gm—su»m’ts
/.
	gOÃM—su»m’tHi¡og¿m
.
	gjava
.
	gswp


29 ./
	gm—su»m’ts
/
	gM—su»m’ts
.
	gjava


30 ./
	gm—su»m’ts
/
	gOÃM—su»m’tRaw
.
	gjava


31 ./
	gUnknownDBExû±iÚ
.
	gjava


32 ./
	gT”mš©ÜTh»ad
.
	gjava


33 ./
	gDBExû±iÚ
.
	gjava


34 ./
	gwÜklßds


35 ./
	gwÜklßds
/
	g·ckage
-
	gšfo
.
	gjava


36 ./
	gwÜklßds
/
	gCÚ¡ªtOccu·ncyWÜklßd
.
	gjava


37 ./
	gwÜklßds
/
	gCÜeWÜklßd
.
	gjava


38 ./
	gwÜklßds
/
	gTimeS”›sWÜklßd
.
	gjava


39 ./
	gwÜklßds
/
	gRe¡WÜklßd
.
	gjava


40 ./
	gDBW¿µ”
.
	gjava


41 ./
	gBy‹I‹¿tÜ
.
	gjava


42 ./
	gRªdomBy‹I‹¿tÜ
.
	gjava


43 ./
	gNum”icBy‹I‹¿tÜ
.
	gjava


44 ./
	gBasicTSDB
.
	gjava


45 ./
	gGoodBadUglyDB
.
	gjava


46 ./
	gDB
.
	gjava


47 ./
	gIÅutSŒ—mBy‹I‹¿tÜ
.
	gjava


48 ./
	gStus
.
	gjava


49 ./
	gStusTh»ad
.
	gjava


50 ./
	gg’”©Ü


51 ./
	gg’”©Ü
/
	g·ckage
-
	gšfo
.
	gjava


52 ./
	gg’”©Ü
/
	gNumb”G’”©Ü
.
	gjava


53 ./
	gg’”©Ü
/
	gSkewedL©e¡G’”©Ü
.
	gjava


54 ./
	gg’”©Ü
/
	gDisü‘eG’”©Ü
.
	gjava


55 ./
	gg’”©Ü
/
	gHi¡og¿mG’”©Ü
.
	gjava


56 ./
	gg’”©Ü
/
	gInüem’tšgPršbËSŒšgG’”©Ü
.
	gjava


57 ./
	gg’”©Ü
/
	gG’”©Ü
.
	gjava


58 ./
	gg’”©Ü
/
	gUnifÜmG’”©Ü
.
	gjava


59 ./
	gg’”©Ü
/
	gSüambËdZfŸnG’”©Ü
.
	gjava


60 ./
	gg’”©Ü
/
	gCÚ¡ªtIÁeg”G’”©Ü
.
	gjava


61 ./
	gg’”©Ü
/
	gExpÚ’tŸlG’”©Ü
.
	gjava


62 ./
	gg’”©Ü
/
	gAcknowËdgedCouÁ”G’”©Ü
.
	gjava


63 ./
	gg’”©Ü
/
	gRªdomDisü‘eTime¡ampG’”©Ü
.
	gjava


64 ./
	gg’”©Ü
/
	gSequ’tŸlG’”©Ü
.
	gjava


65 ./
	gg’”©Ü
/
	gUnixEpochTime¡ampG’”©Ü
.
	gjava


66 ./
	gg’”©Ü
/
	gUnifÜmLÚgG’”©Ü
.
	gjava


67 ./
	gg’”©Ü
/
	gCouÁ”G’”©Ü
.
	gjava


68 ./
	gg’”©Ü
/
	gFeG’”©Ü
.
	gjava


69 ./
	gg’”©Ü
/
	gHÙ¥ÙIÁeg”G’”©Ü
.
	gjava


70 ./
	gg’”©Ü
/
	gZfŸnG’”©Ü
.
java


71 
	gBasicDB
.
java


72 
	gBasicTSDB
.
java


73 
	gBy‹A¼ayBy‹I‹¿tÜ
.
java


74 
	gBy‹I‹¿tÜ
.
java


75 
	gCl›Á
.
java


76 
	gCl›ÁTh»ad
.
java


77 
	gCommªdLše
.
java


78 
	gDB
.
java


79 
	gDBExû±iÚ
.
java


80 
	gDBFaùÜy
.
java


81 
	gDBW¿µ”
.
java


82 
	gGoodBadUglyDB
.
java


83 
	gIÅutSŒ—mBy‹I‹¿tÜ
.
java


84 
	gNum”icBy‹I‹¿tÜ
.
java


85 
	gRªdomBy‹I‹¿tÜ
.
java


86 
	gStus
.
java


87 
	gStusTh»ad
.
java


88 
	gSŒšgBy‹I‹¿tÜ
.
java


89 
	gT”mš©ÜTh»ad
.
java


90 
	gTime£r›sDB
.
java


91 
	gUnknownDBExû±iÚ
.
java


92 
	gUts
.
java


93 
	gWÜklßd
.
java


94 
	gWÜklßdExû±iÚ
.
java


95 
g’”©Ü


96 
	gg’”©Ü
/
	g·ckage
-
	gšfo
.
java


97 
	gg’”©Ü
/
	gNumb”G’”©Ü
.
java


98 
	gg’”©Ü
/
	gSkewedL©e¡G’”©Ü
.
java


99 
	gg’”©Ü
/
	gDisü‘eG’”©Ü
.
java


100 
	gg’”©Ü
/
	gHi¡og¿mG’”©Ü
.
java


101 
	gg’”©Ü
/
	gInüem’tšgPršbËSŒšgG’”©Ü
.
java


102 
	gg’”©Ü
/
	gG’”©Ü
.
java


103 
	gg’”©Ü
/
	gUnifÜmG’”©Ü
.
java


104 
	gg’”©Ü
/
	gSüambËdZfŸnG’”©Ü
.
java


105 
	gg’”©Ü
/
	gCÚ¡ªtIÁeg”G’”©Ü
.
java


106 
	gg’”©Ü
/
	gExpÚ’tŸlG’”©Ü
.
java


107 
	gg’”©Ü
/
	gAcknowËdgedCouÁ”G’”©Ü
.
java


108 
	gg’”©Ü
/
	gRªdomDisü‘eTime¡ampG’”©Ü
.
java


109 
	gg’”©Ü
/
	gSequ’tŸlG’”©Ü
.
java


110 
	gg’”©Ü
/
	gUnixEpochTime¡ampG’”©Ü
.
java


111 
	gg’”©Ü
/
	gUnifÜmLÚgG’”©Ü
.
java


112 
	gg’”©Ü
/
	gCouÁ”G’”©Ü
.
java


113 
	gg’”©Ü
/
	gFeG’”©Ü
.
java


114 
	gg’”©Ü
/
	gHÙ¥ÙIÁeg”G’”©Ü
.
java


115 
	gg’”©Ü
/
	gZfŸnG’”©Ü
.
java


116 
m—su»m’ts


117 
	gm—su»m’ts
/
	g·ckage
-
	gšfo
.
java


118 
	gm—su»m’ts
/
	gOÃM—su»m’tHi¡og¿m
.
java


119 
	gm—su»m’ts
/
	gOÃM—su»m’t
.
java


120 
	gm—su»m’ts
/
	gTwoInOÃM—su»m’t
.
java


121 
	gm—su»m’ts
/
	gOÃM—su»m’tHdrHi¡og¿m
.
java


122 
	gm—su»m’ts
/
	gOÃM—su»m’tTimeS”›s
.
java


123 
	gm—su»m’ts
/
expÜ‹r


124 
	gm—su»m’ts
/
	gexpÜ‹r
/
	g·ckage
-
	gšfo
.
java


125 
	gm—su»m’ts
/
	gexpÜ‹r
/
	gJSONA¼ayM—su»m’tsExpÜ‹r
.
java


126 
	gm—su»m’ts
/
	gexpÜ‹r
/
	gJSONM—su»m’tsExpÜ‹r
.
java


127 
	gm—su»m’ts
/
	gexpÜ‹r
/
	gM—su»m’tsExpÜ‹r
.
java


128 
	gm—su»m’ts
/
	gexpÜ‹r
/
	gTextM—su»m’tsExpÜ‹r
.
java


129 
	gm—su»m’ts
/.
	gOÃM—su»m’tHi¡og¿m
.
	gjava
.
swp


130 
	gm—su»m’ts
/
	gM—su»m’ts
.
java


131 
	gm—su»m’ts
/
	gOÃM—su»m’tRaw
.
java


132 
	g·ckage
-
	gšfo
.
java


133 
wÜklßds


134 
	gwÜklßds
/
	g·ckage
-
	gšfo
.
java


135 
	gwÜklßds
/
	gCÚ¡ªtOccu·ncyWÜklßd
.
java


136 
	gwÜklßds
/
	gCÜeWÜklßd
.
java


137 
	gwÜklßds
/
	gTimeS”›sWÜklßd
.
java


138 
	gwÜklßds
/
	gRe¡WÜklßd
.
	gjava


	@generator/AcknowledgedCounterGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁLock
;

25 
public
 cÏs 
	cAcknowËdgedCouÁ”G’”©Ü
 
ex‹nds
 
	mCouÁ”G’”©Ü
 {

27 
fš®
 
	mWINDOW_SIZE
 = 
IÁeg”
.
rÙ©eLeá
(1, 20);

30 
´iv©e
 
fš®
 
	mWINDOW_MASK
 = 
WINDOW_SIZE
 - 1;

32 
´iv©e
 
fš®
 
R“Á¿ÁLock
 
	mlock
;

33 
´iv©e
 
fš®
 
	mboŞ—n
[] 
	mwšdow
;

34 
´iv©e
 vŞ©
	mlim™
;

39 
public
 
	$AcknowËdgedCouÁ”G’”©Ü
(
couÁ¡¬t
) {

40 
	`su³r
(
couÁ¡¬t
);

41 
lock
 = 
Ãw
 
	`R“Á¿ÁLock
();

42 
wšdow
 = 
Ãw
 
boŞ—n
[
WINDOW_SIZE
];

43 
lim™
 = 
couÁ¡¬t
 - 1;

50 @
Ov”ride


51 
public
 
LÚg
 
	$Ï¡V®ue
() {

52  
lim™
;

53 
	}
}

58 
public
 
	$acknowËdge
(
v®ue
) {

59 
fš®
 
cu¼’tSlÙ
 = ()(
v®ue
 & 
WINDOW_MASK
);

60 ià(
wšdow
[
cu¼’tSlÙ
]) {

61 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Too many unacknowledged insertion keys.");

64 
wšdow
[
cu¼’tSlÙ
] = 
Œue
;

66 ià(
lock
.
	`ŒyLock
()) {

69 
Œy
 {

71 
befÜeFœ¡SlÙ
 = (
lim™
 & 
WINDOW_MASK
);

72 
šdex
;

73 
šdex
 = 
lim™
 + 1; index !ğ
befÜeFœ¡SlÙ
; ++index) {

74 
¦Ù
 = ()(
šdex
 & 
WINDOW_MASK
);

75 ià(!
wšdow
[
¦Ù
]) {

79 
wšdow
[
¦Ù
] = 
çl£
;

82 
lim™
 = 
šdex
 - 1;

83 } 
fš®ly
 {

84 
lock
.
	`uÆock
();

87 
	}
}

	@generator/AcknowledgedCounterGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁLock
;

25 
public
 cÏs 
	cAcknowËdgedCouÁ”G’”©Ü
 
ex‹nds
 
	mCouÁ”G’”©Ü
 {

27 
fš®
 
	mWINDOW_SIZE
 = 
IÁeg”
.
rÙ©eLeá
(1, 20);

30 
´iv©e
 
fš®
 
	mWINDOW_MASK
 = 
WINDOW_SIZE
 - 1;

32 
´iv©e
 
fš®
 
R“Á¿ÁLock
 
	mlock
;

33 
´iv©e
 
fš®
 
	mboŞ—n
[] 
	mwšdow
;

34 
´iv©e
 vŞ©
	mlim™
;

39 
public
 
	$AcknowËdgedCouÁ”G’”©Ü
(
couÁ¡¬t
) {

40 
	`su³r
(
couÁ¡¬t
);

41 
lock
 = 
Ãw
 
	`R“Á¿ÁLock
();

42 
wšdow
 = 
Ãw
 
boŞ—n
[
WINDOW_SIZE
];

43 
lim™
 = 
couÁ¡¬t
 - 1;

50 @
Ov”ride


51 
public
 
LÚg
 
	$Ï¡V®ue
() {

52  
lim™
;

53 
	}
}

58 
public
 
	$acknowËdge
(
v®ue
) {

59 
fš®
 
cu¼’tSlÙ
 = ()(
v®ue
 & 
WINDOW_MASK
);

60 ià(
wšdow
[
cu¼’tSlÙ
]) {

61 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Too many unacknowledged insertion keys.");

64 
wšdow
[
cu¼’tSlÙ
] = 
Œue
;

66 ià(
lock
.
	`ŒyLock
()) {

69 
Œy
 {

71 
befÜeFœ¡SlÙ
 = (
lim™
 & 
WINDOW_MASK
);

72 
šdex
;

73 
šdex
 = 
lim™
 + 1; index !ğ
befÜeFœ¡SlÙ
; ++index) {

74 
¦Ù
 = ()(
šdex
 & 
WINDOW_MASK
);

75 ià(!
wšdow
[
¦Ù
]) {

79 
wšdow
[
¦Ù
] = 
çl£
;

82 
lim™
 = 
šdex
 - 1;

83 } 
fš®ly
 {

84 
lock
.
	`uÆock
();

87 
	}
}

	@generator/ConstantIntegerGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

23 
public
 cÏs 
	cCÚ¡ªtIÁeg”G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

24 
´iv©e
 
fš®
 
	mi
;

29 
public
 
	$CÚ¡ªtIÁeg”G’”©Ü
(
i
) {

30 
this
.
i
 = i;

33 @
Ov”ride


34 
public
 
IÁeg”
 
	$ÃxtV®ue
() {

35  
i
;

36 
	}
}

38 @
Ov”ride


39 
public
 
	$m—n
() {

40  
i
;

41 
	}
}

	@generator/ConstantIntegerGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

23 
public
 cÏs 
	cCÚ¡ªtIÁeg”G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

24 
´iv©e
 
fš®
 
	mi
;

29 
public
 
	$CÚ¡ªtIÁeg”G’”©Ü
(
i
) {

30 
this
.
i
 = i;

33 @
Ov”ride


34 
public
 
IÁeg”
 
	$ÃxtV®ue
() {

35  
i
;

36 
	}
}

38 @
Ov”ride


39 
public
 
	$m—n
() {

40  
i
;

41 
	}
}

	@generator/CounterGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

26 
public
 cÏs 
	cCouÁ”G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

27 
´iv©e
 
fš®
 
AtomicLÚg
 
	mcouÁ”
;

32 
public
 
	$CouÁ”G’”©Ü
(
couÁ¡¬t
) {

33 
couÁ”
=
Ãw
 
	`AtomicLÚg
(
couÁ¡¬t
);

36 @
Ov”ride


37 
public
 
LÚg
 
	$ÃxtV®ue
() {

38  
couÁ”
.
	`g‘AndInüem’t
();

39 
	}
}

41 @
Ov”ride


42 
public
 
LÚg
 
	$Ï¡V®ue
() {

43  
couÁ”
.
	`g‘
() - 1;

44 
	}
}

46 @
Ov”ride


47 
public
 
	$m—n
() {

48 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't compute mean of‚on-stationary distribution!");

49 
	}
}

	@generator/CounterGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

26 
public
 cÏs 
	cCouÁ”G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

27 
´iv©e
 
fš®
 
AtomicLÚg
 
	mcouÁ”
;

32 
public
 
	$CouÁ”G’”©Ü
(
couÁ¡¬t
) {

33 
couÁ”
=
Ãw
 
	`AtomicLÚg
(
couÁ¡¬t
);

36 @
Ov”ride


37 
public
 
LÚg
 
	$ÃxtV®ue
() {

38  
couÁ”
.
	`g‘AndInüem’t
();

39 
	}
}

41 @
Ov”ride


42 
public
 
LÚg
 
	$Ï¡V®ue
() {

43  
couÁ”
.
	`g‘
() - 1;

44 
	}
}

46 @
Ov”ride


47 
public
 
	$m—n
() {

48 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't compute mean of‚on-stationary distribution!");

49 
	}
}

	@generator/DiscreteGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
.
	g»quœeNÚNuÎ
;

29 
public
 
şass
 
Disü‘eG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

30 
´iv©e
 şas 
	cPaœ
 {

31 
´iv©e
 
	gweight
;

32 
´iv©e
 
SŒšg
 
	gv®ue
;

34 
Paœ
(
weight
, 
SŒšg
 
v®ue
) {

35 
	gthis
.
	gweight
 = 
weight
;

36 
	gthis
.
	gv®ue
 = 
»quœeNÚNuÎ
(
v®ue
);

40 
´iv©e
 
fš®
 
	gCŞËùiÚ
<
	gPaœ
> 
	gv®ues
 = 
Ãw
 
A¼ayLi¡
<>();

41 
´iv©e
 
SŒšg
 
	gÏ¡v®ue
;

43 
public
 
	$Disü‘eG’”©Ü
() {

44 
Ï¡v®ue
 = 
nuÎ
;

45 
	}
}

50 @
Ov”ride


51 
public
 
SŒšg
 
	$ÃxtV®ue
() {

52 
sum
 = 0;

54 
Paœ
 
p
 : 
v®ues
) {

55 
sum
 +ğ
p
.
weight
;

58 
v®
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtDoubË
();

60 
Paœ
 
p
 : 
v®ues
) {

61 
pw
 = 
p
.
weight
 / 
sum
;

62 ià(
v®
 < 
pw
) {

63  
p
.
v®ue
;

66 
v®
 -ğ
pw
;

69 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("oops. should‚ot get here.");

71 
	}
}

78 @
Ov”ride


79 
public
 
SŒšg
 
	$Ï¡V®ue
() {

80 ià(
Ï¡v®ue
 =ğ
nuÎ
) {

81 
Ï¡v®ue
 = 
	`ÃxtV®ue
();

83  
Ï¡v®ue
;

84 
	}
}

86 
public
 
	$addV®ue
(
weight
, 
SŒšg
 
v®ue
) {

87 
v®ues
.
	`add
(
Ãw
 
	`Paœ
(
weight
, 
v®ue
));

88 
	}
}

	@generator/DiscreteGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

24 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
.
	g»quœeNÚNuÎ
;

29 
public
 
şass
 
Disü‘eG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

30 
´iv©e
 şas 
	cPaœ
 {

31 
´iv©e
 
	gweight
;

32 
´iv©e
 
SŒšg
 
	gv®ue
;

34 
Paœ
(
weight
, 
SŒšg
 
v®ue
) {

35 
	gthis
.
	gweight
 = 
weight
;

36 
	gthis
.
	gv®ue
 = 
»quœeNÚNuÎ
(
v®ue
);

40 
´iv©e
 
fš®
 
	gCŞËùiÚ
<
	gPaœ
> 
	gv®ues
 = 
Ãw
 
A¼ayLi¡
<>();

41 
´iv©e
 
SŒšg
 
	gÏ¡v®ue
;

43 
public
 
	$Disü‘eG’”©Ü
() {

44 
Ï¡v®ue
 = 
nuÎ
;

45 
	}
}

50 @
Ov”ride


51 
public
 
SŒšg
 
	$ÃxtV®ue
() {

52 
sum
 = 0;

54 
Paœ
 
p
 : 
v®ues
) {

55 
sum
 +ğ
p
.
weight
;

58 
v®
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtDoubË
();

60 
Paœ
 
p
 : 
v®ues
) {

61 
pw
 = 
p
.
weight
 / 
sum
;

62 ià(
v®
 < 
pw
) {

63  
p
.
v®ue
;

66 
v®
 -ğ
pw
;

69 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("oops. should‚ot get here.");

71 
	}
}

78 @
Ov”ride


79 
public
 
SŒšg
 
	$Ï¡V®ue
() {

80 ià(
Ï¡v®ue
 =ğ
nuÎ
) {

81 
Ï¡v®ue
 = 
	`ÃxtV®ue
();

83  
Ï¡v®ue
;

84 
	}
}

86 
public
 
	$addV®ue
(
weight
, 
SŒšg
 
v®ue
) {

87 
v®ues
.
	`add
(
Ãw
 
	`Paœ
(
weight
, 
v®ue
));

88 
	}
}

	@generator/ExponentialGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

31 
public
 cÏs 
	cExpÚ’tŸlG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

33 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_PERCENTILE_PROPERTY
 = "exponential.percentile";

34 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_PERCENTILE_DEFAULT
 = "95";

37 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_FRAC_PROPERTY
 = "exponential.frac";

38 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_FRAC_DEFAULT
 = "0.8571428571";

43 
´iv©e
 
	mgamma
;

51 
public
 
	$ExpÚ’tŸlG’”©Ü
(
m—n
) {

52 
gamma
 = 1.0 / 
m—n
;

55 
public
 
	$ExpÚ’tŸlG’”©Ü
(
³rûÁe
, 
¿nge
) {

56 
gamma
 = -
M©h
.
	`log
(1.0 - 
³rûÁe
 / 100.0è/ 
¿nge
;

57 
	}
}

67 @
Ov”ride


68 
public
 
DoubË
 
	$ÃxtV®ue
() {

69  -
M©h
.
	`log
(
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtDoubË
()è/ 
gamma
;

70 
	}
}

72 @
Ov”ride


73 
public
 
	$m—n
() {

74  1.0 / 
gamma
;

75 
	}
}

77 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

78 
ExpÚ’tŸlG’”©Ü
 
e
 = 
Ãw
 
	`ExpÚ’tŸlG’”©Ü
(90, 100);

79 
j
 = 0;

80 
i
 = 0; i < 1000; i++) {

81 ià(
e
.
	`ÃxtV®ue
() < 100) {

82 
j
++;

85 
Sy¡em
.
out
.
	`´šn
("GÙ " + 
j
 + " hits. Expect 900");

86 
	}
}

	@generator/ExponentialGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

31 
public
 cÏs 
	cExpÚ’tŸlG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

33 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_PERCENTILE_PROPERTY
 = "exponential.percentile";

34 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_PERCENTILE_DEFAULT
 = "95";

37 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_FRAC_PROPERTY
 = "exponential.frac";

38 
public
 
fš®
 
SŒšg
 
	mEXPONENTIAL_FRAC_DEFAULT
 = "0.8571428571";

43 
´iv©e
 
	mgamma
;

51 
public
 
	$ExpÚ’tŸlG’”©Ü
(
m—n
) {

52 
gamma
 = 1.0 / 
m—n
;

55 
public
 
	$ExpÚ’tŸlG’”©Ü
(
³rûÁe
, 
¿nge
) {

56 
gamma
 = -
M©h
.
	`log
(1.0 - 
³rûÁe
 / 100.0è/ 
¿nge
;

57 
	}
}

67 @
Ov”ride


68 
public
 
DoubË
 
	$ÃxtV®ue
() {

69  -
M©h
.
	`log
(
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtDoubË
()è/ 
gamma
;

70 
	}
}

72 @
Ov”ride


73 
public
 
	$m—n
() {

74  1.0 / 
gamma
;

75 
	}
}

77 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

78 
ExpÚ’tŸlG’”©Ü
 
e
 = 
Ãw
 
	`ExpÚ’tŸlG’”©Ü
(90, 100);

79 
j
 = 0;

80 
i
 = 0; i < 1000; i++) {

81 ià(
e
.
	`ÃxtV®ue
() < 100) {

82 
j
++;

85 
Sy¡em
.
out
.
	`´šn
("GÙ " + 
j
 + " hits. Expect 900");

86 
	}
}

	@generator/FileGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

21 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gio
.
	gR—d”
;

28 
public
 
şass
 
FeG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

29 
´iv©e
 
fš®
 
SŒšg
 
	gf’ame
;

30 
´iv©e
 
SŒšg
 
	gcu¼’t
;

31 
´iv©e
 
Bufã»dR—d”
 
	g»ad”
;

37 
public
 
FeG’”©Ü
(
SŒšg
 
f’ame
) {

38 
	gthis
.
	gf’ame
 = 
f’ame
;

39 
»lßdFe
();

45 @
Ov”ride


46 
public
 
synchrÚized
 
SŒšg
 
ÃxtV®ue
() {

47 
	gŒy
 {

48 
	gcu¼’t
 = 
»ad”
.
»adLše
();

49  
	gcu¼’t
;

50 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

51 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

58 @
Ov”ride


59 
public
 
SŒšg
 
Ï¡V®ue
() {

60  
	gcu¼’t
;

66 
public
 
synchrÚized
 
»lßdFe
() {

67 
Œy
 (
R—d”
 
r
 = 
»ad”
) {

68 
Sy¡em
.
”r
.
´šn
("R–ßd " + 
f’ame
);

69 
	g»ad”
 = 
Ãw
 
Bufã»dR—d”
Òew 
FeR—d”
(
f’ame
));

70 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

71 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

	@generator/FileGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

21 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gio
.
	gR—d”
;

28 
public
 
şass
 
FeG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

29 
´iv©e
 
fš®
 
SŒšg
 
	gf’ame
;

30 
´iv©e
 
SŒšg
 
	gcu¼’t
;

31 
´iv©e
 
Bufã»dR—d”
 
	g»ad”
;

37 
public
 
FeG’”©Ü
(
SŒšg
 
f’ame
) {

38 
	gthis
.
	gf’ame
 = 
f’ame
;

39 
»lßdFe
();

45 @
Ov”ride


46 
public
 
synchrÚized
 
SŒšg
 
ÃxtV®ue
() {

47 
	gŒy
 {

48 
	gcu¼’t
 = 
»ad”
.
»adLše
();

49  
	gcu¼’t
;

50 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

51 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

58 @
Ov”ride


59 
public
 
SŒšg
 
Ï¡V®ue
() {

60  
	gcu¼’t
;

66 
public
 
synchrÚized
 
»lßdFe
() {

67 
Œy
 (
R—d”
 
r
 = 
»ad”
) {

68 
Sy¡em
.
”r
.
´šn
("R–ßd " + 
f’ame
);

69 
	g»ad”
 = 
Ãw
 
Bufã»dR—d”
Òew 
FeR—d”
(
f’ame
));

70 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

71 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

	@generator/Generator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

23 
public
 
ab¡¿ù
 
şass
 
	gG’”©Ü
<
	gV
> {

27 
public
 
ab¡¿ù
 
V
 
ÃxtV®ue
();

35 
public
 
ab¡¿ù
 
V
 
Ï¡V®ue
();

37 
public
 
fš®
 
SŒšg
 
ÃxtSŒšg
() {

38 
V
 
	g»t
 = 
ÃxtV®ue
();

39  
	g»t
 =ğ
nuÎ
 ?‚uÎ : 
»t
.
toSŒšg
();

42 
public
 
fš®
 
SŒšg
 
Ï¡SŒšg
() {

43 
V
 
	g»t
 = 
Ï¡V®ue
();

44  
	g»t
 =ğ
nuÎ
 ?‚uÎ : 
»t
.
toSŒšg
();

	@generator/Generator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

23 
public
 
ab¡¿ù
 
şass
 
	gG’”©Ü
<
	gV
> {

27 
public
 
ab¡¿ù
 
V
 
ÃxtV®ue
();

35 
public
 
ab¡¿ù
 
V
 
Ï¡V®ue
();

37 
public
 
fš®
 
SŒšg
 
ÃxtSŒšg
() {

38 
V
 
	g»t
 = 
ÃxtV®ue
();

39  
	g»t
 =ğ
nuÎ
 ?‚uÎ : 
»t
.
toSŒšg
();

42 
public
 
fš®
 
SŒšg
 
Ï¡SŒšg
() {

43 
V
 
	g»t
 = 
Ï¡V®ue
();

44  
	g»t
 =ğ
nuÎ
 ?‚uÎ : 
»t
.
toSŒšg
();

	@generator/HistogramGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

20 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

21 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

35 
public
 cÏs 
	cHi¡og¿mG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

37 
´iv©e
 
fš®
 
	mblockSize
;

38 
´iv©e
 
fš®
 [] 
	mbuck‘s
;

39 
´iv©e
 
	m¬—
;

40 
´iv©e
 
	mweigh‹dA»a
 = 0;

41 
´iv©e
 
	mm—nSize
 = 0;

43 
public
 
	$Hi¡og¿mG’”©Ü
(
SŒšg
 
hi¡og¿mfe
è
throws
 
IOExû±iÚ
 {

44 
	`Œy
 (
Bufã»dR—d”
 
š
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`FeR—d”
(
hi¡og¿mfe
))) {

45 
SŒšg
 
¡r
;

46 
SŒšg
[] 
lše
;

48 
A¼ayLi¡
<
IÁeg”
> 
a
 = 
Ãw
 ArrayList<>();

50 
¡r
 = 
š
.
	`»adLše
();

51 ià(
¡r
 =ğ
nuÎ
) {

52 
throw
 
Ãw
 
	`IOExû±iÚ
("Empty input file!\n");

54 
lše
 = 
¡r
.
	`¥l™
("\t");

55 ià(
lše
[0].
	`com·»To
("BlockSize") != 0) {

56 
throw
 
Ãw
 
	`IOExû±iÚ
("First†ine of histogram is‚othe BlockSize!\n");

58 
blockSize
 = 
IÁeg”
.
	`·r£IÁ
(
lše
[1]);

60 (
¡r
 = 
š
.
	`»adLše
()è!ğ
nuÎ
) {

62 
lše
 = 
¡r
.
	`¥l™
("\t");

64 
a
.
	`add
(
IÁeg”
.
	`·r£IÁ
(
lše
[0]), Integer.parseInt(line[1]));

66 
buck‘s
 = 
Ãw
 [
a
.
	`size
()];

67 
i
 = 0; i < 
a
.
	`size
(); i++) {

68 
buck‘s
[
i
] = 
a
.
	`g‘
(i);

71 
	`š™
();

74 
public
 
	$Hi¡og¿mG’”©Ü
([] 
buck‘s
, 
blockSize
) {

75 
this
.
blockSize
 = blockSize;

76 
this
.
buck‘s
 = buckets;

77 
	`š™
();

78 
	}
}

80 
´iv©e
 
	$š™
() {

81 
i
 = 0; i < 
buck‘s
.
Ëngth
; i++) {

82 
¬—
 +ğ
buck‘s
[
i
];

83 
weigh‹dA»a
 +ğ
i
 * 
buck‘s
[i];

86 
m—nSize
 = ((è
blockSize
è* ((è
weigh‹dA»a
è/ (
¬—
);

87 
	}
}

89 @
Ov”ride


90 
public
 
LÚg
 
	$ÃxtV®ue
() {

91 
numb”
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
((è
¬—
);

92 
i
;

94 
i
 = 0; i < (
buck‘s
.
Ëngth
 - 1); i++) {

95 
numb”
 -ğ
buck‘s
[
i
];

96 ià(
numb”
 <= 0) {

97  (
i
 + 1è* 
blockSize
;

101  
i
 * 
blockSize
;

102 
	}
}

104 @
Ov”ride


105 
public
 
	$m—n
() {

106  
m—nSize
;

107 
	}
}

	@generator/HistogramGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

20 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

21 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

35 
public
 cÏs 
	cHi¡og¿mG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

37 
´iv©e
 
fš®
 
	mblockSize
;

38 
´iv©e
 
fš®
 [] 
	mbuck‘s
;

39 
´iv©e
 
	m¬—
;

40 
´iv©e
 
	mweigh‹dA»a
 = 0;

41 
´iv©e
 
	mm—nSize
 = 0;

43 
public
 
	$Hi¡og¿mG’”©Ü
(
SŒšg
 
hi¡og¿mfe
è
throws
 
IOExû±iÚ
 {

44 
	`Œy
 (
Bufã»dR—d”
 
š
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`FeR—d”
(
hi¡og¿mfe
))) {

45 
SŒšg
 
¡r
;

46 
SŒšg
[] 
lše
;

48 
A¼ayLi¡
<
IÁeg”
> 
a
 = 
Ãw
 ArrayList<>();

50 
¡r
 = 
š
.
	`»adLše
();

51 ià(
¡r
 =ğ
nuÎ
) {

52 
throw
 
Ãw
 
	`IOExû±iÚ
("Empty input file!\n");

54 
lše
 = 
¡r
.
	`¥l™
("\t");

55 ià(
lše
[0].
	`com·»To
("BlockSize") != 0) {

56 
throw
 
Ãw
 
	`IOExû±iÚ
("First†ine of histogram is‚othe BlockSize!\n");

58 
blockSize
 = 
IÁeg”
.
	`·r£IÁ
(
lše
[1]);

60 (
¡r
 = 
š
.
	`»adLše
()è!ğ
nuÎ
) {

62 
lše
 = 
¡r
.
	`¥l™
("\t");

64 
a
.
	`add
(
IÁeg”
.
	`·r£IÁ
(
lše
[0]), Integer.parseInt(line[1]));

66 
buck‘s
 = 
Ãw
 [
a
.
	`size
()];

67 
i
 = 0; i < 
a
.
	`size
(); i++) {

68 
buck‘s
[
i
] = 
a
.
	`g‘
(i);

71 
	`š™
();

74 
public
 
	$Hi¡og¿mG’”©Ü
([] 
buck‘s
, 
blockSize
) {

75 
this
.
blockSize
 = blockSize;

76 
this
.
buck‘s
 = buckets;

77 
	`š™
();

78 
	}
}

80 
´iv©e
 
	$š™
() {

81 
i
 = 0; i < 
buck‘s
.
Ëngth
; i++) {

82 
¬—
 +ğ
buck‘s
[
i
];

83 
weigh‹dA»a
 +ğ
i
 * 
buck‘s
[i];

86 
m—nSize
 = ((è
blockSize
è* ((è
weigh‹dA»a
è/ (
¬—
);

87 
	}
}

89 @
Ov”ride


90 
public
 
LÚg
 
	$ÃxtV®ue
() {

91 
numb”
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtIÁ
((è
¬—
);

92 
i
;

94 
i
 = 0; i < (
buck‘s
.
Ëngth
 - 1); i++) {

95 
numb”
 -ğ
buck‘s
[
i
];

96 ià(
numb”
 <= 0) {

97  (
i
 + 1è* 
blockSize
;

101  
i
 * 
blockSize
;

102 
	}
}

104 @
Ov”ride


105 
public
 
	$m—n
() {

106  
m—nSize
;

107 
	}
}

	@generator/HotspotIntegerGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

31 
public
 cÏs 
	cHÙ¥ÙIÁeg”G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

33 
´iv©e
 
fš®
 
	mlow”Bound
;

34 
´iv©e
 
fš®
 
	muµ”Bound
;

35 
´iv©e
 
fš®
 
	mhÙIÁ”v®
;

36 
´iv©e
 
fš®
 
	mcŞdIÁ”v®
;

37 
´iv©e
 
fš®
 
	mhÙ£tF¿ùiÚ
;

38 
´iv©e
 
fš®
 
	mhÙO²F¿ùiÚ
;

48 
public
 
	$HÙ¥ÙIÁeg”G’”©Ü
(
low”Bound
, 
uµ”Bound
,

49 
hÙ£tF¿ùiÚ
, 
hÙO²F¿ùiÚ
) {

50 ià(
hÙ£tF¿ùiÚ
 < 0.0 || hotsetFraction > 1.0) {

51 
Sy¡em
.
”r
.
	`´šn
("Hotset fraction out of„ange. Settingo 0.0");

52 
hÙ£tF¿ùiÚ
 = 0.0;

54 ià(
hÙO²F¿ùiÚ
 < 0.0 || hotOpnFraction > 1.0) {

55 
Sy¡em
.
”r
.
	`´šn
("Hot operation fraction out of„ange. Settingo 0.0");

56 
hÙO²F¿ùiÚ
 = 0.0;

58 ià(
low”Bound
 > 
uµ”Bound
) {

59 
Sy¡em
.
”r
.
	`´šn
("Upper bound of Hotspot generator smallerhanhe†ower bound. " +

61 
‹mp
 = 
low”Bound
;

62 
low”Bound
 = 
uµ”Bound
;

63 
uµ”Bound
 = 
‹mp
;

65 
this
.
low”Bound
 =†owerBound;

66 
this
.
uµ”Bound
 = upperBound;

67 
this
.
hÙ£tF¿ùiÚ
 = hotsetFraction;

68 
š‹rv®
 = 
uµ”Bound
 - 
low”Bound
 + 1;

69 
this
.
hÙIÁ”v®
 = (è(
š‹rv®
 * 
hÙ£tF¿ùiÚ
);

70 
this
.
cŞdIÁ”v®
 = 
š‹rv®
 - 
hÙIÁ”v®
;

71 
this
.
hÙO²F¿ùiÚ
 = hotOpnFraction;

74 @
Ov”ride


75 
public
 
LÚg
 
	$ÃxtV®ue
() {

76 
v®ue
 = 0;

77 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

78 ià(
¿ndom
.
	`ÃxtDoubË
(è< 
hÙO²F¿ùiÚ
) {

80 
v®ue
 = 
low”Bound
 + 
M©h
.
	`abs
(
¿ndom
.
	`ÃxtLÚg
()è% 
hÙIÁ”v®
;

83 
v®ue
 = 
low”Bound
 + 
hÙIÁ”v®
 + 
M©h
.
	`abs
(
¿ndom
.
	`ÃxtLÚg
()è% 
cŞdIÁ”v®
;

85 
	`£tLa¡V®ue
(
v®ue
);

86  
v®ue
;

87 
	}
}

92 
public
 
	$g‘Low”Bound
() {

93  
low”Bound
;

94 
	}
}

99 
public
 
	$g‘Uµ”Bound
() {

100  
uµ”Bound
;

101 
	}
}

106 
public
 
	$g‘HÙ£tF¿ùiÚ
() {

107  
hÙ£tF¿ùiÚ
;

108 
	}
}

113 
public
 
	$g‘HÙO²F¿ùiÚ
() {

114  
hÙO²F¿ùiÚ
;

115 
	}
}

117 @
Ov”ride


118 
public
 
	$m—n
() {

119  
hÙO²F¿ùiÚ
 * (
low”Bound
 + 
hÙIÁ”v®
 / 2.0)

120 + (1 - 
hÙO²F¿ùiÚ
è* (
low”Bound
 + 
hÙIÁ”v®
 + 
cŞdIÁ”v®
 / 2.0);

121 
	}
}

	@generator/HotspotIntegerGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

31 
public
 cÏs 
	cHÙ¥ÙIÁeg”G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

33 
´iv©e
 
fš®
 
	mlow”Bound
;

34 
´iv©e
 
fš®
 
	muµ”Bound
;

35 
´iv©e
 
fš®
 
	mhÙIÁ”v®
;

36 
´iv©e
 
fš®
 
	mcŞdIÁ”v®
;

37 
´iv©e
 
fš®
 
	mhÙ£tF¿ùiÚ
;

38 
´iv©e
 
fš®
 
	mhÙO²F¿ùiÚ
;

48 
public
 
	$HÙ¥ÙIÁeg”G’”©Ü
(
low”Bound
, 
uµ”Bound
,

49 
hÙ£tF¿ùiÚ
, 
hÙO²F¿ùiÚ
) {

50 ià(
hÙ£tF¿ùiÚ
 < 0.0 || hotsetFraction > 1.0) {

51 
Sy¡em
.
”r
.
	`´šn
("Hotset fraction out of„ange. Settingo 0.0");

52 
hÙ£tF¿ùiÚ
 = 0.0;

54 ià(
hÙO²F¿ùiÚ
 < 0.0 || hotOpnFraction > 1.0) {

55 
Sy¡em
.
”r
.
	`´šn
("Hot operation fraction out of„ange. Settingo 0.0");

56 
hÙO²F¿ùiÚ
 = 0.0;

58 ià(
low”Bound
 > 
uµ”Bound
) {

59 
Sy¡em
.
”r
.
	`´šn
("Upper bound of Hotspot generator smallerhanhe†ower bound. " +

61 
‹mp
 = 
low”Bound
;

62 
low”Bound
 = 
uµ”Bound
;

63 
uµ”Bound
 = 
‹mp
;

65 
this
.
low”Bound
 =†owerBound;

66 
this
.
uµ”Bound
 = upperBound;

67 
this
.
hÙ£tF¿ùiÚ
 = hotsetFraction;

68 
š‹rv®
 = 
uµ”Bound
 - 
low”Bound
 + 1;

69 
this
.
hÙIÁ”v®
 = (è(
š‹rv®
 * 
hÙ£tF¿ùiÚ
);

70 
this
.
cŞdIÁ”v®
 = 
š‹rv®
 - 
hÙIÁ”v®
;

71 
this
.
hÙO²F¿ùiÚ
 = hotOpnFraction;

74 @
Ov”ride


75 
public
 
LÚg
 
	$ÃxtV®ue
() {

76 
v®ue
 = 0;

77 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

78 ià(
¿ndom
.
	`ÃxtDoubË
(è< 
hÙO²F¿ùiÚ
) {

80 
v®ue
 = 
low”Bound
 + 
M©h
.
	`abs
(
¿ndom
.
	`ÃxtLÚg
()è% 
hÙIÁ”v®
;

83 
v®ue
 = 
low”Bound
 + 
hÙIÁ”v®
 + 
M©h
.
	`abs
(
¿ndom
.
	`ÃxtLÚg
()è% 
cŞdIÁ”v®
;

85 
	`£tLa¡V®ue
(
v®ue
);

86  
v®ue
;

87 
	}
}

92 
public
 
	$g‘Low”Bound
() {

93  
low”Bound
;

94 
	}
}

99 
public
 
	$g‘Uµ”Bound
() {

100  
uµ”Bound
;

101 
	}
}

106 
public
 
	$g‘HÙ£tF¿ùiÚ
() {

107  
hÙ£tF¿ùiÚ
;

108 
	}
}

113 
public
 
	$g‘HÙO²F¿ùiÚ
() {

114  
hÙO²F¿ùiÚ
;

115 
	}
}

117 @
Ov”ride


118 
public
 
	$m—n
() {

119  
hÙO²F¿ùiÚ
 * (
low”Bound
 + 
hÙIÁ”v®
 / 2.0)

120 + (1 - 
hÙO²F¿ùiÚ
è* (
low”Bound
 + 
hÙIÁ”v®
 + 
cŞdIÁ”v®
 / 2.0);

121 
	}
}

	@generator/IncrementingPrintableStringGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.*;

41 
public
 
şass
 
Inüem’tšgPršbËSŒšgG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

44 
public
 
fš®
 
	gDEFAULTSTRINGLENGTH
 = 8;

50 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPES_ALL_BUT_CONTROL
;

53 
	gCHAR_TYPES_ALL_BUT_CONTROL
 = 
Ãw
 
HashS‘
<
IÁeg”
>(24);

55 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
DECIMAL_DIGIT_NUMBER
);

56 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
LETTER_NUMBER
);

57 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_NUMBER
);

60 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

61 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

62 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
TITLECASE_LETTER
);

63 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_LETTER
);

66 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
COMBINING_SPACING_MARK
);

67 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
NON_SPACING_MARK
);

68 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
ENCLOSING_MARK
);

71 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
CONNECTOR_PUNCTUATION
);

72 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
DASH_PUNCTUATION
);

73 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
START_PUNCTUATION
);

74 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
END_PUNCTUATION
);

75 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
INITIAL_QUOTE_PUNCTUATION
);

76 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
FINAL_QUOTE_PUNCTUATION
);

77 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_PUNCTUATION
);

80 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
MATH_SYMBOL
);

81 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
CURRENCY_SYMBOL
);

82 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
MODIFIER_SYMBOL
);

83 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_SYMBOL
);

86 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
SPACE_SEPARATOR
);

87 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
LINE_SEPARATOR
);

88 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
PARAGRAPH_SEPARATOR
);

94 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPES_BASIC_ALPHA
;

97 
	gCHAR_TYPES_BASIC_ALPHA
 = 
Ãw
 
HashS‘
<
IÁeg”
>(2);

98 
	gCHAR_TYPES_BASIC_ALPHA
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

99 
	gCHAR_TYPES_BASIC_ALPHA
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

105 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
;

108 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
 = 
Ãw
 
HashS‘
<
IÁeg”
>(3);

109 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
DECIMAL_DIGIT_NUMBER
);

110 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

111 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

119 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
;

122 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
 = 
Ãw
 
HashS‘
<
IÁeg”
>(8);

123 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
DECIMAL_DIGIT_NUMBER
);

124 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
LETTER_NUMBER
);

125 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
OTHER_NUMBER
);

126 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

127 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

128 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
TITLECASE_LETTER
);

129 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
MODIFIER_LETTER
);

130 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
OTHER_LETTER
);

134 
´iv©e
 
fš®
 [] 
	gch¬aù”S‘
;

137 
´iv©e
 [] 
	gšdiûs
;

140 
´iv©e
 
fš®
 
	gËngth
;

144 
´iv©e
 
SŒšg
 
	gÏ¡V®ue
;

147 
´iv©e
 
boŞ—n
 
	gthrowExû±iÚOnRŞlov”
;

150 
´iv©e
 
boŞ—n
 
	ghasRŞËdOv”
;

156 
public
 
Inüem’tšgPršbËSŒšgG’”©Ü
() {

157 
this
(
DEFAULTSTRINGLENGTH
, 
´šbËBasicAÍhaASCIIS‘
());

166 
public
 
Inüem’tšgPršbËSŒšgG’”©Ü
(
fš®
 
Ëngth
) {

167 
this
(
Ëngth
, 
´šbËBasicAÍhaASCIIS‘
());

179 
public
 
Inüem’tšgPršbËSŒšgG’”©Ü
(
fš®
 
Ëngth
, fš® [] 
ch¬aù”S‘
) {

180 ià(
	gËngth
 < 1) {

181 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Length must be greaterhan orƒqualo 1");

183 ià(
	gch¬aù”S‘
 =ğ
nuÎ
 || 
ch¬aù”S‘
.
Ëngth
 < 1) {

184 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Character set must have‡t†east one character");

186 
	gthis
.
	gËngth
 = 
Ëngth
;

187 
	gthis
.
	gch¬aù”S‘
 = 
ch¬aù”S‘
;

188 
	gšdiûs
 = 
Ãw
 [
Ëngth
];

191 @
Ov”ride


192 
public
 
SŒšg
 
ÃxtV®ue
() {

193 ià(
	ghasRŞËdOv”
 && 
	gthrowExû±iÚOnRŞlov”
) {

194 
throw
 
Ãw
 
NoSuchEËm’tExû±iÚ
("The generator has„olled overohe beginning");

197 
fš®
 
SŒšgBud”
 
	gbufãr
 = 
Ãw
 SŒšgBud”(
Ëngth
);

198 
	gi
 = 0; i < 
	gËngth
; i++) {

199 
	gbufãr
.
­³nd
(
Ch¬aù”
.
toCh¬s
(
ch¬aù”S‘
[
šdiûs
[
i
]]));

203 
	gi
 = 
Ëngth
 - 1; i >= 0; --i) {

204 ià(
	gšdiûs
[
i
] >ğ
ch¬aù”S‘
.
Ëngth
 - 1) {

205 
šdiûs
[
i
] = 0;

206 ià(
	gi
 =ğ0 || 
ch¬aù”S‘
.
Ëngth
 =ğ1 && 
Ï¡V®ue
 !ğ
nuÎ
) {

207 
hasRŞËdOv”
 = 
Œue
;

210 ++
	gšdiûs
[
i
];

215 
	gÏ¡V®ue
 = 
bufãr
.
toSŒšg
();

216  
	gÏ¡V®ue
;

219 @
Ov”ride


220 
public
 
SŒšg
 
Ï¡V®ue
() {

221  
	gÏ¡V®ue
;

225 
public
 
£tThrowExû±iÚOnRŞlov”
(
fš®
 
boŞ—n
 
exû±iÚOnRŞlov”
) {

226 
	gthis
.
	gthrowExû±iÚOnRŞlov”
 = 
exû±iÚOnRŞlov”
;

230 
public
 
boŞ—n
 
g‘ThrowExû±iÚOnRŞlov”
() {

231  
	gthrowExû±iÚOnRŞlov”
;

239 
public
 [] 
´šbËBasicAÍhaASCIIS‘
() {

240 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

241 
g’”©ePršbËCh¬aù”S‘
(0, 127, 
nuÎ
, 
çl£
, 
CHAR_TYPES_BASIC_ALPHA
);

242 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

243 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

244 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

246  
	gch¬aù”S‘
;

255 
public
 [] 
´šbËBasicAÍhaNum”icASCIIS‘
() {

256 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

257 
g’”©ePršbËCh¬aù”S‘
(0, 127, 
nuÎ
, 
çl£
, 
CHAR_TYPES_BASIC_ALPHANUMERICS
);

258 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

259 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

260 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

262  
	gch¬aù”S‘
;

270 
public
 [] 
fuÎPršbËBasicASCIIS‘
() {

271 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

272 
g’”©ePršbËCh¬aù”S‘
(32, 127, 
nuÎ
, 
çl£
,‚ull);

273 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

274 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

275 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

277  
	gch¬aù”S‘
;

285 
public
 [] 
fuÎPršbËBasicASCIIS‘W™hNewlšes
() {

286 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 = 
Ãw
 
A¼ayLi¡
<
IÁeg”
>();

287 
	gv®idCh¬aù”s
.
add
(10);

288 
	gv®idCh¬aù”s
.
addAÎ
(
g’”©ePršbËCh¬aù”S‘
(32, 127, 
nuÎ
, 
çl£
,‚ull));

289 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

290 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

291 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

293  
	gch¬aù”S‘
;

301 
public
 [] 
´šbËAÍhaNum”icPÏÃZ”oS‘
() {

302 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

303 
g’”©ePršbËCh¬aù”S‘
(0, 65535, 
nuÎ
, 
çl£
, 
CHAR_TYPES_BASIC_ALPHANUMERICS
);

304 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

305 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

306 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

308  
	gch¬aù”S‘
;

316 
public
 [] 
fuÎPršbËPÏÃZ”oS‘
() {

317 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

318 
g’”©ePršbËCh¬aù”S‘
(0, 65535, 
nuÎ
, 
çl£
, 
CHAR_TYPES_ALL_BUT_CONTROL
);

319 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

320 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

321 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

323  
	gch¬aù”S‘
;

347 
public
 
	gLi¡
<
	gIÁeg”
> 
g’”©ePršbËCh¬aù”S‘
(

348 
fš®
 
¡¬tCodePošt
,

349 
fš®
 
Ï¡CodePošt
,

350 
fš®
 
S‘
<
IÁeg”
> 
ch¬aù”Ty³sF‹r
,

351 
fš®
 
boŞ—n
 
isF‹rAÎowabËLi¡
,

352 
fš®
 
S‘
<
IÁeg”
> 
®lowabËTy³s
) {

356 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 = 
Ãw
 
A¼ayLi¡
<
IÁeg”
>(
Ï¡CodePošt
);

358 
	gcodePošt
 = 
¡¬tCodePošt
; codePošˆ<ğ
Ï¡CodePošt
; ++codePoint) {

359 ià(
	g®lowabËTy³s
 !ğ
nuÎ
 &&

360 !
®lowabËTy³s
.
cÚšs
(
Ch¬aù”
.
g‘Ty³
(
codePošt
))) {

364 
fš®
 
	gty³
 = 
Ch¬aù”
.
g‘Ty³
(
codePošt
);

365 ià(
	gty³
 =ğ
Ch¬aù”
.
CONTROL
 ||

366 
ty³
 =ğ
Ch¬aù”
.
SURROGATE
 ||

367 
ty³
 =ğ
Ch¬aù”
.
FORMAT
 ||

368 
ty³
 =ğ
Ch¬aù”
.
PRIVATE_USE
 ||

369 
ty³
 =ğ
Ch¬aù”
.
UNASSIGNED
) {

374 ià(
	gch¬aù”Ty³sF‹r
 !ğ
nuÎ
) {

378 ià((
isF‹rAÎowabËLi¡
 && !
ch¬aù”Ty³sF‹r
.
cÚšs
(
codePošt
)) ||

379 (
ch¬aù”Ty³sF‹r
.
cÚšs
(
codePošt
))) {

384 
	gv®idCh¬aù”s
.
add
(
codePošt
);

386  
	gv®idCh¬aù”s
;

	@generator/IncrementingPrintableStringGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.*;

41 
public
 
şass
 
Inüem’tšgPršbËSŒšgG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

44 
public
 
fš®
 
	gDEFAULTSTRINGLENGTH
 = 8;

50 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPES_ALL_BUT_CONTROL
;

53 
	gCHAR_TYPES_ALL_BUT_CONTROL
 = 
Ãw
 
HashS‘
<
IÁeg”
>(24);

55 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
DECIMAL_DIGIT_NUMBER
);

56 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
LETTER_NUMBER
);

57 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_NUMBER
);

60 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

61 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

62 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
TITLECASE_LETTER
);

63 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_LETTER
);

66 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
COMBINING_SPACING_MARK
);

67 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
NON_SPACING_MARK
);

68 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
ENCLOSING_MARK
);

71 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
CONNECTOR_PUNCTUATION
);

72 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
DASH_PUNCTUATION
);

73 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
START_PUNCTUATION
);

74 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
END_PUNCTUATION
);

75 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
INITIAL_QUOTE_PUNCTUATION
);

76 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
FINAL_QUOTE_PUNCTUATION
);

77 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_PUNCTUATION
);

80 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
MATH_SYMBOL
);

81 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
CURRENCY_SYMBOL
);

82 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
MODIFIER_SYMBOL
);

83 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
OTHER_SYMBOL
);

86 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
SPACE_SEPARATOR
);

87 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
LINE_SEPARATOR
);

88 
	gCHAR_TYPES_ALL_BUT_CONTROL
.
add
((è
Ch¬aù”
.
PARAGRAPH_SEPARATOR
);

94 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPES_BASIC_ALPHA
;

97 
	gCHAR_TYPES_BASIC_ALPHA
 = 
Ãw
 
HashS‘
<
IÁeg”
>(2);

98 
	gCHAR_TYPES_BASIC_ALPHA
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

99 
	gCHAR_TYPES_BASIC_ALPHA
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

105 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
;

108 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
 = 
Ãw
 
HashS‘
<
IÁeg”
>(3);

109 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
DECIMAL_DIGIT_NUMBER
);

110 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

111 
	gCHAR_TYPES_BASIC_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

119 
public
 
fš®
 
	gS‘
<
	gIÁeg”
> 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
;

122 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
 = 
Ãw
 
HashS‘
<
IÁeg”
>(8);

123 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
DECIMAL_DIGIT_NUMBER
);

124 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
LETTER_NUMBER
);

125 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
OTHER_NUMBER
);

126 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
UPPERCASE_LETTER
);

127 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
LOWERCASE_LETTER
);

128 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
TITLECASE_LETTER
);

129 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
MODIFIER_LETTER
);

130 
	gCHAR_TYPE_EXTENDED_ALPHANUMERICS
.
add
((è
Ch¬aù”
.
OTHER_LETTER
);

134 
´iv©e
 
fš®
 [] 
	gch¬aù”S‘
;

137 
´iv©e
 [] 
	gšdiûs
;

140 
´iv©e
 
fš®
 
	gËngth
;

144 
´iv©e
 
SŒšg
 
	gÏ¡V®ue
;

147 
´iv©e
 
boŞ—n
 
	gthrowExû±iÚOnRŞlov”
;

150 
´iv©e
 
boŞ—n
 
	ghasRŞËdOv”
;

156 
public
 
Inüem’tšgPršbËSŒšgG’”©Ü
() {

157 
this
(
DEFAULTSTRINGLENGTH
, 
´šbËBasicAÍhaASCIIS‘
());

166 
public
 
Inüem’tšgPršbËSŒšgG’”©Ü
(
fš®
 
Ëngth
) {

167 
this
(
Ëngth
, 
´šbËBasicAÍhaASCIIS‘
());

179 
public
 
Inüem’tšgPršbËSŒšgG’”©Ü
(
fš®
 
Ëngth
, fš® [] 
ch¬aù”S‘
) {

180 ià(
	gËngth
 < 1) {

181 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Length must be greaterhan orƒqualo 1");

183 ià(
	gch¬aù”S‘
 =ğ
nuÎ
 || 
ch¬aù”S‘
.
Ëngth
 < 1) {

184 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Character set must have‡t†east one character");

186 
	gthis
.
	gËngth
 = 
Ëngth
;

187 
	gthis
.
	gch¬aù”S‘
 = 
ch¬aù”S‘
;

188 
	gšdiûs
 = 
Ãw
 [
Ëngth
];

191 @
Ov”ride


192 
public
 
SŒšg
 
ÃxtV®ue
() {

193 ià(
	ghasRŞËdOv”
 && 
	gthrowExû±iÚOnRŞlov”
) {

194 
throw
 
Ãw
 
NoSuchEËm’tExû±iÚ
("The generator has„olled overohe beginning");

197 
fš®
 
SŒšgBud”
 
	gbufãr
 = 
Ãw
 SŒšgBud”(
Ëngth
);

198 
	gi
 = 0; i < 
	gËngth
; i++) {

199 
	gbufãr
.
­³nd
(
Ch¬aù”
.
toCh¬s
(
ch¬aù”S‘
[
šdiûs
[
i
]]));

203 
	gi
 = 
Ëngth
 - 1; i >= 0; --i) {

204 ià(
	gšdiûs
[
i
] >ğ
ch¬aù”S‘
.
Ëngth
 - 1) {

205 
šdiûs
[
i
] = 0;

206 ià(
	gi
 =ğ0 || 
ch¬aù”S‘
.
Ëngth
 =ğ1 && 
Ï¡V®ue
 !ğ
nuÎ
) {

207 
hasRŞËdOv”
 = 
Œue
;

210 ++
	gšdiûs
[
i
];

215 
	gÏ¡V®ue
 = 
bufãr
.
toSŒšg
();

216  
	gÏ¡V®ue
;

219 @
Ov”ride


220 
public
 
SŒšg
 
Ï¡V®ue
() {

221  
	gÏ¡V®ue
;

225 
public
 
£tThrowExû±iÚOnRŞlov”
(
fš®
 
boŞ—n
 
exû±iÚOnRŞlov”
) {

226 
	gthis
.
	gthrowExû±iÚOnRŞlov”
 = 
exû±iÚOnRŞlov”
;

230 
public
 
boŞ—n
 
g‘ThrowExû±iÚOnRŞlov”
() {

231  
	gthrowExû±iÚOnRŞlov”
;

239 
public
 [] 
´šbËBasicAÍhaASCIIS‘
() {

240 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

241 
g’”©ePršbËCh¬aù”S‘
(0, 127, 
nuÎ
, 
çl£
, 
CHAR_TYPES_BASIC_ALPHA
);

242 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

243 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

244 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

246  
	gch¬aù”S‘
;

255 
public
 [] 
´šbËBasicAÍhaNum”icASCIIS‘
() {

256 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

257 
g’”©ePršbËCh¬aù”S‘
(0, 127, 
nuÎ
, 
çl£
, 
CHAR_TYPES_BASIC_ALPHANUMERICS
);

258 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

259 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

260 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

262  
	gch¬aù”S‘
;

270 
public
 [] 
fuÎPršbËBasicASCIIS‘
() {

271 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

272 
g’”©ePršbËCh¬aù”S‘
(32, 127, 
nuÎ
, 
çl£
,‚ull);

273 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

274 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

275 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

277  
	gch¬aù”S‘
;

285 
public
 [] 
fuÎPršbËBasicASCIIS‘W™hNewlšes
() {

286 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 = 
Ãw
 
A¼ayLi¡
<
IÁeg”
>();

287 
	gv®idCh¬aù”s
.
add
(10);

288 
	gv®idCh¬aù”s
.
addAÎ
(
g’”©ePršbËCh¬aù”S‘
(32, 127, 
nuÎ
, 
çl£
,‚ull));

289 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

290 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

291 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

293  
	gch¬aù”S‘
;

301 
public
 [] 
´šbËAÍhaNum”icPÏÃZ”oS‘
() {

302 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

303 
g’”©ePršbËCh¬aù”S‘
(0, 65535, 
nuÎ
, 
çl£
, 
CHAR_TYPES_BASIC_ALPHANUMERICS
);

304 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

305 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

306 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

308  
	gch¬aù”S‘
;

316 
public
 [] 
fuÎPršbËPÏÃZ”oS‘
() {

317 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 =

318 
g’”©ePršbËCh¬aù”S‘
(0, 65535, 
nuÎ
, 
çl£
, 
CHAR_TYPES_ALL_BUT_CONTROL
);

319 
fš®
 [] 
	gch¬aù”S‘
 = 
Ãw
 [
v®idCh¬aù”s
.
size
()];

320 
	gi
 = 0; i < 
	gv®idCh¬aù”s
.
size
(); i++) {

321 
	gch¬aù”S‘
[
i
] = 
v®idCh¬aù”s
.
g‘
(i);

323  
	gch¬aù”S‘
;

347 
public
 
	gLi¡
<
	gIÁeg”
> 
g’”©ePršbËCh¬aù”S‘
(

348 
fš®
 
¡¬tCodePošt
,

349 
fš®
 
Ï¡CodePošt
,

350 
fš®
 
S‘
<
IÁeg”
> 
ch¬aù”Ty³sF‹r
,

351 
fš®
 
boŞ—n
 
isF‹rAÎowabËLi¡
,

352 
fš®
 
S‘
<
IÁeg”
> 
®lowabËTy³s
) {

356 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	gv®idCh¬aù”s
 = 
Ãw
 
A¼ayLi¡
<
IÁeg”
>(
Ï¡CodePošt
);

358 
	gcodePošt
 = 
¡¬tCodePošt
; codePošˆ<ğ
Ï¡CodePošt
; ++codePoint) {

359 ià(
	g®lowabËTy³s
 !ğ
nuÎ
 &&

360 !
®lowabËTy³s
.
cÚšs
(
Ch¬aù”
.
g‘Ty³
(
codePošt
))) {

364 
fš®
 
	gty³
 = 
Ch¬aù”
.
g‘Ty³
(
codePošt
);

365 ià(
	gty³
 =ğ
Ch¬aù”
.
CONTROL
 ||

366 
ty³
 =ğ
Ch¬aù”
.
SURROGATE
 ||

367 
ty³
 =ğ
Ch¬aù”
.
FORMAT
 ||

368 
ty³
 =ğ
Ch¬aù”
.
PRIVATE_USE
 ||

369 
ty³
 =ğ
Ch¬aù”
.
UNASSIGNED
) {

374 ià(
	gch¬aù”Ty³sF‹r
 !ğ
nuÎ
) {

378 ià((
isF‹rAÎowabËLi¡
 && !
ch¬aù”Ty³sF‹r
.
cÚšs
(
codePošt
)) ||

379 (
ch¬aù”Ty³sF‹r
.
cÚšs
(
codePošt
))) {

384 
	gv®idCh¬aù”s
.
add
(
codePošt
);

386  
	gv®idCh¬aù”s
;

	@generator/NumberGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

24 
public
 
ab¡¿ù
 
şass
 
Numb”G’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gNumb”
> {

25 
´iv©e
 
Numb”
 
	gÏ¡V®
;

31 
´Ùeùed
 
£tLa¡V®ue
(
Numb”
 
Ï¡
) {

32 
	gÏ¡V®
 = 
Ï¡
;

36 @
Ov”ride


37 
public
 
Numb”
 
Ï¡V®ue
() {

38  
	gÏ¡V®
;

44 
public
 
ab¡¿ù
 
m—n
();

	@generator/NumberGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

24 
public
 
ab¡¿ù
 
şass
 
Numb”G’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gNumb”
> {

25 
´iv©e
 
Numb”
 
	gÏ¡V®
;

31 
´Ùeùed
 
£tLa¡V®ue
(
Numb”
 
Ï¡
) {

32 
	gÏ¡V®
 = 
Ï¡
;

36 @
Ov”ride


37 
public
 
Numb”
 
Ï¡V®ue
() {

38  
	gÏ¡V®
;

44 
public
 
ab¡¿ù
 
m—n
();

	@generator/RandomDiscreteTimestampGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

42 
public
 cÏs 
	cRªdomDisü‘eTime¡ampG’”©Ü
 
ex‹nds
 
	mUnixEpochTime¡ampG’”©Ü
 {

45 
public
 
fš®
 
	mMAX_INTERVALS
 = 16777216;

48 
´iv©e
 
fš®
 
	mš‹rv®s
;

52 
´iv©e
 
fš®
 
	mIÁeg”
[] 
	moff£ts
;

55 
´iv©e
 
	moff£tIndex
;

65 
public
 
	$RªdomDisü‘eTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
,

66 
fš®
 
š‹rv®s
) {

67 
	`su³r
(
š‹rv®
, 
timeUn™s
);

68 
this
.
š‹rv®s
 = intervals;

69 
off£ts
 = 
Ãw
 
IÁeg”
[
š‹rv®s
];

70 
	`£tup
();

86 
public
 
	$RªdomDisü‘eTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
,

87 
fš®
 
¡¬tTime¡amp
, fš® 
š‹rv®s
) {

88 
	`su³r
(
š‹rv®
, 
timeUn™s
, 
¡¬tTime¡amp
);

89 
this
.
š‹rv®s
 = intervals;

90 
off£ts
 = 
Ãw
 
IÁeg”
[
š‹rv®s
];

91 
	`£tup
();

92 
	}
}

97 
´iv©e
 
	$£tup
() {

98 ià(
š‹rv®s
 > 
MAX_INTERVALS
) {

99 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Too many intervals forhe in-memory "

100 + "¬¿y. Thlim™ i " + 
MAX_INTERVALS
 + ".");

102 
off£tIndex
 = 0;

103 
i
 = 0; i < 
š‹rv®s
; i++) {

104 
off£ts
[
i
] = i;

106 
Uts
.
	`shufæeA¼ay
(
off£ts
);

107 
	}
}

109 @
Ov”ride


110 
public
 
LÚg
 
	$ÃxtV®ue
() {

111 ià(
off£tIndex
 >ğ
off£ts
.
Ëngth
) {

112 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Reachedheƒnd ofhe„andomimestamp "

113 + "š‹rv®s: " + 
off£tIndex
);

115 
Ï¡Time¡amp
 = 
cu¼’tTime¡amp
;

116 
cu¼’tTime¡amp
 = 
¡¬tTime¡amp
 + (
off£ts
[
off£tIndex
++] * 
	`g‘Off£t
(1));

117  
cu¼’tTime¡amp
;

118 
	}
}

	@generator/RandomDiscreteTimestampGenerator.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

42 
public
 cÏs 
	cRªdomDisü‘eTime¡ampG’”©Ü
 
ex‹nds
 
	mUnixEpochTime¡ampG’”©Ü
 {

45 
public
 
fš®
 
	mMAX_INTERVALS
 = 16777216;

48 
´iv©e
 
fš®
 
	mš‹rv®s
;

52 
´iv©e
 
fš®
 
	mIÁeg”
[] 
	moff£ts
;

55 
´iv©e
 
	moff£tIndex
;

65 
public
 
	$RªdomDisü‘eTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
,

66 
fš®
 
š‹rv®s
) {

67 
	`su³r
(
š‹rv®
, 
timeUn™s
);

68 
this
.
š‹rv®s
 = intervals;

69 
off£ts
 = 
Ãw
 
IÁeg”
[
š‹rv®s
];

70 
	`£tup
();

86 
public
 
	$RªdomDisü‘eTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
,

87 
fš®
 
¡¬tTime¡amp
, fš® 
š‹rv®s
) {

88 
	`su³r
(
š‹rv®
, 
timeUn™s
, 
¡¬tTime¡amp
);

89 
this
.
š‹rv®s
 = intervals;

90 
off£ts
 = 
Ãw
 
IÁeg”
[
š‹rv®s
];

91 
	`£tup
();

92 
	}
}

97 
´iv©e
 
	$£tup
() {

98 ià(
š‹rv®s
 > 
MAX_INTERVALS
) {

99 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Too many intervals forhe in-memory "

100 + "¬¿y. Thlim™ i " + 
MAX_INTERVALS
 + ".");

102 
off£tIndex
 = 0;

103 
i
 = 0; i < 
š‹rv®s
; i++) {

104 
off£ts
[
i
] = i;

106 
Uts
.
	`shufæeA¼ay
(
off£ts
);

107 
	}
}

109 @
Ov”ride


110 
public
 
LÚg
 
	$ÃxtV®ue
() {

111 ià(
off£tIndex
 >ğ
off£ts
.
Ëngth
) {

112 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Reachedheƒnd ofhe„andomimestamp "

113 + "š‹rv®s: " + 
off£tIndex
);

115 
Ï¡Time¡amp
 = 
cu¼’tTime¡amp
;

116 
cu¼’tTime¡amp
 = 
¡¬tTime¡amp
 + (
off£ts
[
off£tIndex
++] * 
	`g‘Off£t
(1));

117  
cu¼’tTime¡amp
;

118 
	}
}

	@generator/ScrambledZipfianGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

32 
public
 cÏs 
	cSüambËdZfŸnG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

33 
public
 
fš®
 
	mZETAN
 = 26.46902820178302;

34 
public
 
fš®
 
	mUSED_ZIPFIAN_CONSTANT
 = 0.99;

35 
public
 
fš®
 
	mITEM_COUNT
 = 10000000000L;

37 
´iv©e
 
ZfŸnG’”©Ü
 
	mg’
;

38 
´iv©e
 
fš®
 
	mmš
, 
	mmax
, 
	m™emcouÁ
;

47 
public
 
	$SüambËdZfŸnG’”©Ü
(
™ems
) {

48 
	`this
(0, 
™ems
 - 1);

57 
public
 
	$SüambËdZfŸnG’”©Ü
(
mš
, 
max
) {

58 
	`this
(
mš
, 
max
, 
ZfŸnG’”©Ü
.
ZIPFIAN_CONSTANT
);

59 
	}
}

84 
public
 
	$SüambËdZfŸnG’”©Ü
(
mš
, 
max
, 
zfŸncÚ¡ªt
) {

85 
this
.
mš
 = min;

86 
this
.
max
 = max;

87 
™emcouÁ
 = 
this
.
max
 -his.
mš
 + 1;

88 ià(
zfŸncÚ¡ªt
 =ğ
USED_ZIPFIAN_CONSTANT
) {

89 
g’
 = 
Ãw
 
	`ZfŸnG’”©Ü
(0, 
ITEM_COUNT
, 
zfŸncÚ¡ªt
, 
ZETAN
);

91 
g’
 = 
Ãw
 
	`ZfŸnG’”©Ü
(0, 
ITEM_COUNT
, 
zfŸncÚ¡ªt
);

93 
	}
}

100 @
Ov”ride


101 
public
 
LÚg
 
	$ÃxtV®ue
() {

102 
»t
 = 
g’
.
	`ÃxtV®ue
();

103 
»t
 = 
mš
 + 
Uts
.
	`âvhash64
Ô‘è% 
™emcouÁ
;

104 
	`£tLa¡V®ue
(
»t
);

105  
»t
;

106 
	}
}

108 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

109 
Ãwz‘ª
 = 
ZfŸnG’”©Ü
.
	`z‘a¡©ic
(
ITEM_COUNT
, ZfŸnG’”©Ü.
ZIPFIAN_CONSTANT
);

110 
Sy¡em
.
out
.
	`´šn
("z‘ª: " + 
Ãwz‘ª
);

111 
Sy¡em
.
	`ex™
(0);

113 
SüambËdZfŸnG’”©Ü
 
g’
 = 
Ãw
 
	`SüambËdZfŸnG’”©Ü
(10000);

115 
i
 = 0; i < 1000000; i++) {

116 
Sy¡em
.
out
.
	`´šn
("" + 
g’
.
	`ÃxtV®ue
());

118 
	}
}

123 @
Ov”ride


124 
public
 
	$m—n
() {

125  ((
mš
è+ 
max
) / 2.0;

126 
	}
}

	@generator/ScrambledZipfianGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

32 
public
 cÏs 
	cSüambËdZfŸnG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

33 
public
 
fš®
 
	mZETAN
 = 26.46902820178302;

34 
public
 
fš®
 
	mUSED_ZIPFIAN_CONSTANT
 = 0.99;

35 
public
 
fš®
 
	mITEM_COUNT
 = 10000000000L;

37 
´iv©e
 
ZfŸnG’”©Ü
 
	mg’
;

38 
´iv©e
 
fš®
 
	mmš
, 
	mmax
, 
	m™emcouÁ
;

47 
public
 
	$SüambËdZfŸnG’”©Ü
(
™ems
) {

48 
	`this
(0, 
™ems
 - 1);

57 
public
 
	$SüambËdZfŸnG’”©Ü
(
mš
, 
max
) {

58 
	`this
(
mš
, 
max
, 
ZfŸnG’”©Ü
.
ZIPFIAN_CONSTANT
);

59 
	}
}

84 
public
 
	$SüambËdZfŸnG’”©Ü
(
mš
, 
max
, 
zfŸncÚ¡ªt
) {

85 
this
.
mš
 = min;

86 
this
.
max
 = max;

87 
™emcouÁ
 = 
this
.
max
 -his.
mš
 + 1;

88 ià(
zfŸncÚ¡ªt
 =ğ
USED_ZIPFIAN_CONSTANT
) {

89 
g’
 = 
Ãw
 
	`ZfŸnG’”©Ü
(0, 
ITEM_COUNT
, 
zfŸncÚ¡ªt
, 
ZETAN
);

91 
g’
 = 
Ãw
 
	`ZfŸnG’”©Ü
(0, 
ITEM_COUNT
, 
zfŸncÚ¡ªt
);

93 
	}
}

100 @
Ov”ride


101 
public
 
LÚg
 
	$ÃxtV®ue
() {

102 
»t
 = 
g’
.
	`ÃxtV®ue
();

103 
»t
 = 
mš
 + 
Uts
.
	`âvhash64
Ô‘è% 
™emcouÁ
;

104 
	`£tLa¡V®ue
(
»t
);

105  
»t
;

106 
	}
}

108 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

109 
Ãwz‘ª
 = 
ZfŸnG’”©Ü
.
	`z‘a¡©ic
(
ITEM_COUNT
, ZfŸnG’”©Ü.
ZIPFIAN_CONSTANT
);

110 
Sy¡em
.
out
.
	`´šn
("z‘ª: " + 
Ãwz‘ª
);

111 
Sy¡em
.
	`ex™
(0);

113 
SüambËdZfŸnG’”©Ü
 
g’
 = 
Ãw
 
	`SüambËdZfŸnG’”©Ü
(10000);

115 
i
 = 0; i < 1000000; i++) {

116 
Sy¡em
.
out
.
	`´šn
("" + 
g’
.
	`ÃxtV®ue
());

118 
	}
}

123 @
Ov”ride


124 
public
 
	$m—n
() {

125  ((
mš
è+ 
max
) / 2.0;

126 
	}
}

	@generator/SequentialGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

25 
public
 cÏs 
	cSequ’tŸlG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

26 
´iv©e
 
fš®
 
AtomicLÚg
 
	mcouÁ”
;

27 
´iv©e
 
	mš‹rv®
;

28 
´iv©e
 
	mcouÁ¡¬t
;

33 
public
 
	$Sequ’tŸlG’”©Ü
(
couÁ¡¬t
, 
couÁ’d
) {

34 
couÁ”
 = 
Ãw
 
	`AtomicLÚg
();

35 
	`£tLa¡V®ue
(
couÁ”
.
	`g‘
());

36 
this
.
couÁ¡¬t
 = countstart;

37 
š‹rv®
 = 
couÁ’d
 - 
couÁ¡¬t
 + 1;

44 
public
 
	$ÃxtLÚg
() {

45 
»t
 = 
couÁ¡¬t
 + 
couÁ”
.
	`g‘AndInüem’t
(è% 
š‹rv®
;

46 
	`£tLa¡V®ue
(
»t
);

47  
»t
;

48 
	}
}

50 @
Ov”ride


51 
public
 
Numb”
 
	$ÃxtV®ue
() {

52 
»t
 = 
couÁ¡¬t
 + 
couÁ”
.
	`g‘AndInüem’t
(è% 
š‹rv®
;

53 
	`£tLa¡V®ue
(
»t
);

54  
»t
;

55 
	}
}

57 @
Ov”ride


58 
public
 
Numb”
 
	$Ï¡V®ue
() {

59  
couÁ”
.
	`g‘
() + 1;

60 
	}
}

62 @
Ov”ride


63 
public
 
	$m—n
() {

64 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't compute mean of‚on-stationary distribution!");

65 
	}
}

	@generator/SequentialGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

25 
public
 cÏs 
	cSequ’tŸlG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

26 
´iv©e
 
fš®
 
AtomicLÚg
 
	mcouÁ”
;

27 
´iv©e
 
	mš‹rv®
;

28 
´iv©e
 
	mcouÁ¡¬t
;

33 
public
 
	$Sequ’tŸlG’”©Ü
(
couÁ¡¬t
, 
couÁ’d
) {

34 
couÁ”
 = 
Ãw
 
	`AtomicLÚg
();

35 
	`£tLa¡V®ue
(
couÁ”
.
	`g‘
());

36 
this
.
couÁ¡¬t
 = countstart;

37 
š‹rv®
 = 
couÁ’d
 - 
couÁ¡¬t
 + 1;

44 
public
 
	$ÃxtLÚg
() {

45 
»t
 = 
couÁ¡¬t
 + 
couÁ”
.
	`g‘AndInüem’t
(è% 
š‹rv®
;

46 
	`£tLa¡V®ue
(
»t
);

47  
»t
;

48 
	}
}

50 @
Ov”ride


51 
public
 
Numb”
 
	$ÃxtV®ue
() {

52 
»t
 = 
couÁ¡¬t
 + 
couÁ”
.
	`g‘AndInüem’t
(è% 
š‹rv®
;

53 
	`£tLa¡V®ue
(
»t
);

54  
»t
;

55 
	}
}

57 @
Ov”ride


58 
public
 
Numb”
 
	$Ï¡V®ue
() {

59  
couÁ”
.
	`g‘
() + 1;

60 
	}
}

62 @
Ov”ride


63 
public
 
	$m—n
() {

64 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't compute mean of‚on-stationary distribution!");

65 
	}
}

	@generator/SkewedLatestGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

23 
public
 cÏs 
	cSkewedL©e¡G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

24 
´iv©e
 
CouÁ”G’”©Ü
 
	mbasis
;

25 
´iv©e
 
fš®
 
ZfŸnG’”©Ü
 
	mzfŸn
;

27 
public
 
	$SkewedL©e¡G’”©Ü
(
CouÁ”G’”©Ü
 
basis
) {

28 
this
.
basis
 = basis;

29 
zfŸn
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
this
.
basis
.
	`Ï¡V®ue
());

30 
	`ÃxtV®ue
();

37 @
Ov”ride


38 
public
 
LÚg
 
	$ÃxtV®ue
() {

39 
max
 = 
basis
.
	`Ï¡V®ue
();

40 
Ãxt
 = 
max
 - 
zfŸn
.
	`ÃxtLÚg
(max);

41 
	`£tLa¡V®ue
(
Ãxt
);

42  
Ãxt
;

43 
	}
}

45 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

46 
SkewedL©e¡G’”©Ü
 
g’
 = 
Ãw
 
	`SkewedL©e¡G’”©Ü
Òew 
	`CouÁ”G’”©Ü
(1000));

47 
i
 = 0; i < 
IÁeg”
.
	`·r£IÁ
(
¬gs
[0]); i++) {

48 
Sy¡em
.
out
.
	`´šn
(
g’
.
	`ÃxtSŒšg
());

50 
	}
}

52 @
Ov”ride


53 
public
 
	$m—n
() {

54 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't compute mean of‚on-stationary distribution!");

55 
	}
}

	@generator/SkewedLatestGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

23 
public
 cÏs 
	cSkewedL©e¡G’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

24 
´iv©e
 
CouÁ”G’”©Ü
 
	mbasis
;

25 
´iv©e
 
fš®
 
ZfŸnG’”©Ü
 
	mzfŸn
;

27 
public
 
	$SkewedL©e¡G’”©Ü
(
CouÁ”G’”©Ü
 
basis
) {

28 
this
.
basis
 = basis;

29 
zfŸn
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
this
.
basis
.
	`Ï¡V®ue
());

30 
	`ÃxtV®ue
();

37 @
Ov”ride


38 
public
 
LÚg
 
	$ÃxtV®ue
() {

39 
max
 = 
basis
.
	`Ï¡V®ue
();

40 
Ãxt
 = 
max
 - 
zfŸn
.
	`ÃxtLÚg
(max);

41 
	`£tLa¡V®ue
(
Ãxt
);

42  
Ãxt
;

43 
	}
}

45 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

46 
SkewedL©e¡G’”©Ü
 
g’
 = 
Ãw
 
	`SkewedL©e¡G’”©Ü
Òew 
	`CouÁ”G’”©Ü
(1000));

47 
i
 = 0; i < 
IÁeg”
.
	`·r£IÁ
(
¬gs
[0]); i++) {

48 
Sy¡em
.
out
.
	`´šn
(
g’
.
	`ÃxtSŒšg
());

50 
	}
}

52 @
Ov”ride


53 
public
 
	$m—n
() {

54 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't compute mean of‚on-stationary distribution!");

55 
	}
}

	@generator/UniformGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

27 
public
 
şass
 
UnifÜmG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

28 
´iv©e
 
fš®
 
	gLi¡
<
	gSŒšg
> 
	gv®ues
;

29 
´iv©e
 
SŒšg
 
	gÏ¡¡ršg
;

30 
´iv©e
 
fš®
 
UnifÜmLÚgG’”©Ü
 
	gg’
;

35 
public
 
UnifÜmG’”©Ü
(
CŞËùiÚ
<
SŒšg
> 
v®ues
) {

36 
	gthis
.
	gv®ues
 = 
Ãw
 
A¼ayLi¡
<>(
v®ues
);

37 
	gÏ¡¡ršg
 = 
nuÎ
;

38 
	gg’
 = 
Ãw
 
UnifÜmLÚgG’”©Ü
(0, 
v®ues
.
size
() - 1);

44 @
Ov”ride


45 
public
 
SŒšg
 
ÃxtV®ue
() {

46 
	gÏ¡¡ršg
 = 
v®ues
.
g‘
(
g’
.
ÃxtV®ue
().
štV®ue
());

47  
	gÏ¡¡ršg
;

55 @
Ov”ride


56 
public
 
SŒšg
 
Ï¡V®ue
() {

57 ià(
	gÏ¡¡ršg
 =ğ
nuÎ
) {

58 
ÃxtV®ue
();

60  
	gÏ¡¡ršg
;

	@generator/UniformGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

27 
public
 
şass
 
UnifÜmG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gSŒšg
> {

28 
´iv©e
 
fš®
 
	gLi¡
<
	gSŒšg
> 
	gv®ues
;

29 
´iv©e
 
SŒšg
 
	gÏ¡¡ršg
;

30 
´iv©e
 
fš®
 
UnifÜmLÚgG’”©Ü
 
	gg’
;

35 
public
 
UnifÜmG’”©Ü
(
CŞËùiÚ
<
SŒšg
> 
v®ues
) {

36 
	gthis
.
	gv®ues
 = 
Ãw
 
A¼ayLi¡
<>(
v®ues
);

37 
	gÏ¡¡ršg
 = 
nuÎ
;

38 
	gg’
 = 
Ãw
 
UnifÜmLÚgG’”©Ü
(0, 
v®ues
.
size
() - 1);

44 @
Ov”ride


45 
public
 
SŒšg
 
ÃxtV®ue
() {

46 
	gÏ¡¡ršg
 = 
v®ues
.
g‘
(
g’
.
ÃxtV®ue
().
štV®ue
());

47  
	gÏ¡¡ršg
;

55 @
Ov”ride


56 
public
 
SŒšg
 
Ï¡V®ue
() {

57 ià(
	gÏ¡¡ršg
 =ğ
nuÎ
) {

58 
ÃxtV®ue
();

60  
	gÏ¡¡ršg
;

	@generator/UniformLongGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

25 
public
 cÏs 
	cUnifÜmLÚgG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

26 
´iv©e
 
fš®
 
	mlb
, 
	mub
, 
	mš‹rv®
;

36 
public
 
	$UnifÜmLÚgG’”©Ü
(
lb
, 
ub
) {

37 
this
.
lb
 =†b;

38 
this
.
ub
 = ub;

39 
š‹rv®
 = 
this
.
ub
 -his.
lb
 + 1;

42 @
Ov”ride


43 
public
 
LÚg
 
	$ÃxtV®ue
() {

44 
»t
 = 
M©h
.
	`abs
(
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtLÚg
()è% 
š‹rv®
 + 
lb
;

45 
	`£tLa¡V®ue
(
»t
);

47  
»t
;

48 
	}
}

50 @
Ov”ride


51 
public
 
	$m—n
() {

52  ((
lb
 + (è
ub
)) / 2.0;

53 
	}
}

	@generator/UniformLongGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

25 
public
 cÏs 
	cUnifÜmLÚgG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

26 
´iv©e
 
fš®
 
	mlb
, 
	mub
, 
	mš‹rv®
;

36 
public
 
	$UnifÜmLÚgG’”©Ü
(
lb
, 
ub
) {

37 
this
.
lb
 =†b;

38 
this
.
ub
 = ub;

39 
š‹rv®
 = 
this
.
ub
 -his.
lb
 + 1;

42 @
Ov”ride


43 
public
 
LÚg
 
	$ÃxtV®ue
() {

44 
»t
 = 
M©h
.
	`abs
(
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtLÚg
()è% 
š‹rv®
 + 
lb
;

45 
	`£tLa¡V®ue
(
»t
);

47  
»t
;

48 
	}
}

50 @
Ov”ride


51 
public
 
	$m—n
() {

52  ((
lb
 + (è
ub
)) / 2.0;

53 
	}
}

	@generator/UnixEpochTimestampGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

44 
public
 
şass
 
UnixEpochTime¡ampG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gLÚg
> {

47 
´Ùeùed
 
	g¡¬tTime¡amp
;

50 
´Ùeùed
 
	gcu¼’tTime¡amp
;

53 
´Ùeùed
 
	gÏ¡Time¡amp
;

56 
´Ùeùed
 
	gš‹rv®
;

59 
´Ùeùed
 
TimeUn™
 
	gtimeUn™s
;

64 
public
 
UnixEpochTime¡ampG’”©Ü
() {

65 
this
(60, 
TimeUn™
.
SECONDS
);

73 
public
 
UnixEpochTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
) {

74 
	gthis
.
	gš‹rv®
 = 
š‹rv®
;

75 
	gthis
.
	gtimeUn™s
 = 
timeUn™s
;

78 
š™®izeTime¡amp
(-1);

79 
	gcu¼’tTime¡amp
 -ğ
g‘Off£t
(1);

80 
	gÏ¡Time¡amp
 = 
cu¼’tTime¡amp
;

94 
public
 
UnixEpochTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
,

95 
fš®
 
¡¬tTime¡amp
) {

96 
	gthis
.
	gš‹rv®
 = 
š‹rv®
;

97 
	gthis
.
	gtimeUn™s
 = 
timeUn™s
;

100 
	gcu¼’tTime¡amp
 = 
¡¬tTime¡amp
 - 
g‘Off£t
(1);

101 
	gthis
.
	g¡¬tTime¡amp
 = 
cu¼’tTime¡amp
;

102 
	gÏ¡Time¡amp
 = 
cu¼’tTime¡amp
 - 
g‘Off£t
(1);

110 
public
 
š™®izeTime¡amp
(
fš®
 
š‹rv®Off£t
) {

111 
	gtimeUn™s
) {

112 
	gNANOSECONDS
:

113 
cu¼’tTime¡amp
 = 
Sy¡em
.
ÇnoTime
(è+ 
g‘Off£t
(
š‹rv®Off£t
);

115 
	gMICROSECONDS
:

116 
cu¼’tTime¡amp
 = (
Sy¡em
.
ÇnoTime
(è/ 1000è+ 
g‘Off£t
(
š‹rv®Off£t
);

118 
	gMILLISECONDS
:

119 
cu¼’tTime¡amp
 = 
Sy¡em
.
cu¼’tTimeMlis
(è+ 
g‘Off£t
(
š‹rv®Off£t
);

121 
	gSECONDS
:

122 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

123 
g‘Off£t
(
š‹rv®Off£t
);

125 
	gMINUTES
:

126 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

127 
g‘Off£t
(
š‹rv®Off£t
);

129 
	gHOURS
:

130 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

131 
g‘Off£t
(
š‹rv®Off£t
);

133 
	gDAYS
:

134 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

135 
g‘Off£t
(
š‹rv®Off£t
);

138 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("UnhªdËdimun™y³: " + 
timeUn™s
);

140 
	g¡¬tTime¡amp
 = 
cu¼’tTime¡amp
;

143 @
Ov”ride


144 
public
 
LÚg
 
ÃxtV®ue
() {

145 
	gÏ¡Time¡amp
 = 
cu¼’tTime¡amp
;

146 
	gcu¼’tTime¡amp
 +ğ
g‘Off£t
(1);

147  
	gcu¼’tTime¡amp
;

155 
public
 
g‘Off£t
(
fš®
 
š‹rv®Off£t
) {

156 
	gtimeUn™s
) {

157 
	gNANOSECONDS
:

158 
MICROSECONDS
:

159 
MILLISECONDS
:

160 
SECONDS
:

161  
š‹rv®Off£t
 * 
š‹rv®
;

162 
	gMINUTES
:

163  
š‹rv®Off£t
 * 
š‹rv®
 * () 60;

164 
	gHOURS
:

165  
š‹rv®Off£t
 * 
š‹rv®
 * () (60 * 60);

166 
	gDAYS
:

167  
š‹rv®Off£t
 * 
š‹rv®
 * () (60 * 60 * 24);

169 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("UnhªdËdimun™y³: " + 
timeUn™s
);

173 @
Ov”ride


174 
public
 
LÚg
 
Ï¡V®ue
() {

175  
	gÏ¡Time¡amp
;

179 
public
 
cu¼’tV®ue
() {

180  
	gcu¼’tTime¡amp
;

	@generator/UnixEpochTimestampGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

44 
public
 
şass
 
UnixEpochTime¡ampG’”©Ü
 
ex‹nds
 
	gG’”©Ü
<
	gLÚg
> {

47 
´Ùeùed
 
	g¡¬tTime¡amp
;

50 
´Ùeùed
 
	gcu¼’tTime¡amp
;

53 
´Ùeùed
 
	gÏ¡Time¡amp
;

56 
´Ùeùed
 
	gš‹rv®
;

59 
´Ùeùed
 
TimeUn™
 
	gtimeUn™s
;

64 
public
 
UnixEpochTime¡ampG’”©Ü
() {

65 
this
(60, 
TimeUn™
.
SECONDS
);

73 
public
 
UnixEpochTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
) {

74 
	gthis
.
	gš‹rv®
 = 
š‹rv®
;

75 
	gthis
.
	gtimeUn™s
 = 
timeUn™s
;

78 
š™®izeTime¡amp
(-1);

79 
	gcu¼’tTime¡amp
 -ğ
g‘Off£t
(1);

80 
	gÏ¡Time¡amp
 = 
cu¼’tTime¡amp
;

94 
public
 
UnixEpochTime¡ampG’”©Ü
(
fš®
 
š‹rv®
, fš® 
TimeUn™
 
timeUn™s
,

95 
fš®
 
¡¬tTime¡amp
) {

96 
	gthis
.
	gš‹rv®
 = 
š‹rv®
;

97 
	gthis
.
	gtimeUn™s
 = 
timeUn™s
;

100 
	gcu¼’tTime¡amp
 = 
¡¬tTime¡amp
 - 
g‘Off£t
(1);

101 
	gthis
.
	g¡¬tTime¡amp
 = 
cu¼’tTime¡amp
;

102 
	gÏ¡Time¡amp
 = 
cu¼’tTime¡amp
 - 
g‘Off£t
(1);

110 
public
 
š™®izeTime¡amp
(
fš®
 
š‹rv®Off£t
) {

111 
	gtimeUn™s
) {

112 
	gNANOSECONDS
:

113 
cu¼’tTime¡amp
 = 
Sy¡em
.
ÇnoTime
(è+ 
g‘Off£t
(
š‹rv®Off£t
);

115 
	gMICROSECONDS
:

116 
cu¼’tTime¡amp
 = (
Sy¡em
.
ÇnoTime
(è/ 1000è+ 
g‘Off£t
(
š‹rv®Off£t
);

118 
	gMILLISECONDS
:

119 
cu¼’tTime¡amp
 = 
Sy¡em
.
cu¼’tTimeMlis
(è+ 
g‘Off£t
(
š‹rv®Off£t
);

121 
	gSECONDS
:

122 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

123 
g‘Off£t
(
š‹rv®Off£t
);

125 
	gMINUTES
:

126 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

127 
g‘Off£t
(
š‹rv®Off£t
);

129 
	gHOURS
:

130 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

131 
g‘Off£t
(
š‹rv®Off£t
);

133 
	gDAYS
:

134 
cu¼’tTime¡amp
 = (
Sy¡em
.
cu¼’tTimeMlis
() / 1000) +

135 
g‘Off£t
(
š‹rv®Off£t
);

138 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("UnhªdËdimun™y³: " + 
timeUn™s
);

140 
	g¡¬tTime¡amp
 = 
cu¼’tTime¡amp
;

143 @
Ov”ride


144 
public
 
LÚg
 
ÃxtV®ue
() {

145 
	gÏ¡Time¡amp
 = 
cu¼’tTime¡amp
;

146 
	gcu¼’tTime¡amp
 +ğ
g‘Off£t
(1);

147  
	gcu¼’tTime¡amp
;

155 
public
 
g‘Off£t
(
fš®
 
š‹rv®Off£t
) {

156 
	gtimeUn™s
) {

157 
	gNANOSECONDS
:

158 
MICROSECONDS
:

159 
MILLISECONDS
:

160 
SECONDS
:

161  
š‹rv®Off£t
 * 
š‹rv®
;

162 
	gMINUTES
:

163  
š‹rv®Off£t
 * 
š‹rv®
 * () 60;

164 
	gHOURS
:

165  
š‹rv®Off£t
 * 
š‹rv®
 * () (60 * 60);

166 
	gDAYS
:

167  
š‹rv®Off£t
 * 
š‹rv®
 * () (60 * 60 * 24);

169 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("UnhªdËdimun™y³: " + 
timeUn™s
);

173 @
Ov”ride


174 
public
 
LÚg
 
Ï¡V®ue
() {

175  
	gÏ¡Time¡amp
;

179 
public
 
cu¼’tV®ue
() {

180  
	gcu¼’tTime¡amp
;

	@generator/ZipfianGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

42 
public
 cÏs 
	cZfŸnG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

43 
public
 
fš®
 
	mZIPFIAN_CONSTANT
 = 0.99;

48 
´iv©e
 
fš®
 
	m™ems
;

53 
´iv©e
 
fš®
 
	mba£
;

58 
´iv©e
 
fš®
 
	mzfŸncÚ¡ªt
;

63 
´iv©e
 
	m®pha
, 
	mz‘ª
, 
	m‘a
, 
	mth‘a
, 
	mz‘a2th‘a
;

68 
´iv©e
 
	mcouÁfÜz‘a
;

82 
´iv©e
 
boŞ—n
 
	m®low™emcouÁdeü—£
 = 
çl£
;

90 
public
 
	$ZfŸnG’”©Ü
(
™ems
) {

91 
	`this
(0, 
™ems
 - 1);

99 
public
 
	$ZfŸnG’”©Ü
(
mš
, 
max
) {

100 
	`this
(
mš
, 
max
, 
ZIPFIAN_CONSTANT
);

101 
	}
}

109 
public
 
	$ZfŸnG’”©Ü
(
™ems
, 
zfŸncÚ¡ªt
) {

110 
	`this
(0, 
™ems
 - 1, 
zfŸncÚ¡ªt
);

111 
	}
}

119 
public
 
	$ZfŸnG’”©Ü
(
mš
, 
max
, 
zfŸncÚ¡ªt
) {

120 
	`this
(
mš
, 
max
, 
zfŸncÚ¡ªt
, 
	`z‘a¡©ic
(max - min + 1, zipfianconstant));

121 
	}
}

132 
public
 
	$ZfŸnG’”©Ü
(
mš
, 
max
, 
zfŸncÚ¡ªt
, 
z‘ª
) {

134 
™ems
 = 
max
 - 
mš
 + 1;

135 
ba£
 = 
mš
;

136 
this
.
zfŸncÚ¡ªt
 = zipfianconstant;

138 
th‘a
 = 
this
.
zfŸncÚ¡ªt
;

140 
z‘a2th‘a
 = 
	`z‘a
(2, 
th‘a
);

142 
®pha
 = 1.0 / (1.0 - 
th‘a
);

143 
this
.
z‘ª
 = zetan;

144 
couÁfÜz‘a
 = 
™ems
;

145 
‘a
 = (1 - 
M©h
.
	`pow
(2.0 / 
™ems
, 1 - 
th‘a
)è/ (1 - 
z‘a2th‘a
 / 
this
.
z‘ª
);

147 
	`ÃxtV®ue
();

148 
	}
}

159 
	$z‘a
(
n
, 
th‘aV®
) {

160 
couÁfÜz‘a
 = 
n
;

161  
	`z‘a¡©ic
(
n
, 
th‘aV®
);

162 
	}
}

170 
	$z‘a¡©ic
(
n
, 
th‘a
) {

171  
	`z‘a¡©ic
(0, 
n
, 
th‘a
, 0);

172 
	}
}

184 
	$z‘a
(
¡
, 
n
, 
th‘aV®
, 
š™Ÿlsum
) {

185 
couÁfÜz‘a
 = 
n
;

186  
	`z‘a¡©ic
(
¡
, 
n
, 
th‘aV®
, 
š™Ÿlsum
);

187 
	}
}

198 
	$z‘a¡©ic
(
¡
, 
n
, 
th‘a
, 
š™Ÿlsum
) {

199 
sum
 = 
š™Ÿlsum
;

200 
i
 = 
¡
; i < 
n
; i++) {

202 
sum
 +ğ1 / (
M©h
.
	`pow
(
i
 + 1, 
th‘a
));

207  
sum
;

208 
	}
}

219 
	$ÃxtLÚg
(
™emcouÁ
) {

222 ià(
™emcouÁ
 !ğ
couÁfÜz‘a
) {

225 
	`synchrÚized
 (
this
) {

226 ià(
™emcouÁ
 > 
couÁfÜz‘a
) {

231 
z‘ª
 = 
	`z‘a
(
couÁfÜz‘a
, 
™emcouÁ
, 
th‘a
, zetan);

232 
‘a
 = (1 - 
M©h
.
	`pow
(2.0 / 
™ems
, 1 - 
th‘a
)è/ (1 - 
z‘a2th‘a
 / 
z‘ª
);

233 } ià((
™emcouÁ
 < 
couÁfÜz‘a
è&& (
®low™emcouÁdeü—£
)) {

241 
Sy¡em
.
”r
.
	`´šn
("WARNING: Recomputing Zipfian distribtion. This is slow‡nd should be‡voided. " +

242 "(™emcouÁ=" + 
™emcouÁ
 + " couÁfÜz‘a=" + 
couÁfÜz‘a
 + ")");

244 
z‘ª
 = 
	`z‘a
(
™emcouÁ
, 
th‘a
);

245 
‘a
 = (1 - 
M©h
.
	`pow
(2.0 / 
™ems
, 1 - 
th‘a
)è/ (1 - 
z‘a2th‘a
 / 
z‘ª
);

250 
u
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtDoubË
();

251 
uz
 = 
u
 * 
z‘ª
;

253 ià(
uz
 < 1.0) {

254  
ba£
;

257 ià(
uz
 < 1.0 + 
M©h
.
	`pow
(0.5, 
th‘a
)) {

258  
ba£
 + 1;

261 
»t
 = 
ba£
 + (è((
™emcouÁ
è* 
M©h
.
	`pow
(
‘a
 * 
u
 -ƒ + 1, 
®pha
));

262 
	`£tLa¡V®ue
(
»t
);

263  
»t
;

264 
	}
}

272 @
Ov”ride


273 
public
 
LÚg
 
	$ÃxtV®ue
() {

274  
	`ÃxtLÚg
(
™ems
);

275 
	}
}

277 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

278 
Ãw
 
	`ZfŸnG’”©Ü
(
SüambËdZfŸnG’”©Ü
.
ITEM_COUNT
);

279 
	}
}

284 @
Ov”ride


285 
public
 
	$m—n
() {

286 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("@todo implement ZipfianGenerator.mean()");

287 
	}
}

	@generator/ZipfianGenerator.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

42 
public
 cÏs 
	cZfŸnG’”©Ü
 
ex‹nds
 
	mNumb”G’”©Ü
 {

43 
public
 
fš®
 
	mZIPFIAN_CONSTANT
 = 0.99;

48 
´iv©e
 
fš®
 
	m™ems
;

53 
´iv©e
 
fš®
 
	mba£
;

58 
´iv©e
 
fš®
 
	mzfŸncÚ¡ªt
;

63 
´iv©e
 
	m®pha
, 
	mz‘ª
, 
	m‘a
, 
	mth‘a
, 
	mz‘a2th‘a
;

68 
´iv©e
 
	mcouÁfÜz‘a
;

82 
´iv©e
 
boŞ—n
 
	m®low™emcouÁdeü—£
 = 
çl£
;

90 
public
 
	$ZfŸnG’”©Ü
(
™ems
) {

91 
	`this
(0, 
™ems
 - 1);

99 
public
 
	$ZfŸnG’”©Ü
(
mš
, 
max
) {

100 
	`this
(
mš
, 
max
, 
ZIPFIAN_CONSTANT
);

101 
	}
}

109 
public
 
	$ZfŸnG’”©Ü
(
™ems
, 
zfŸncÚ¡ªt
) {

110 
	`this
(0, 
™ems
 - 1, 
zfŸncÚ¡ªt
);

111 
	}
}

119 
public
 
	$ZfŸnG’”©Ü
(
mš
, 
max
, 
zfŸncÚ¡ªt
) {

120 
	`this
(
mš
, 
max
, 
zfŸncÚ¡ªt
, 
	`z‘a¡©ic
(max - min + 1, zipfianconstant));

121 
	}
}

132 
public
 
	$ZfŸnG’”©Ü
(
mš
, 
max
, 
zfŸncÚ¡ªt
, 
z‘ª
) {

134 
™ems
 = 
max
 - 
mš
 + 1;

135 
ba£
 = 
mš
;

136 
this
.
zfŸncÚ¡ªt
 = zipfianconstant;

138 
th‘a
 = 
this
.
zfŸncÚ¡ªt
;

140 
z‘a2th‘a
 = 
	`z‘a
(2, 
th‘a
);

142 
®pha
 = 1.0 / (1.0 - 
th‘a
);

143 
this
.
z‘ª
 = zetan;

144 
couÁfÜz‘a
 = 
™ems
;

145 
‘a
 = (1 - 
M©h
.
	`pow
(2.0 / 
™ems
, 1 - 
th‘a
)è/ (1 - 
z‘a2th‘a
 / 
this
.
z‘ª
);

147 
	`ÃxtV®ue
();

148 
	}
}

159 
	$z‘a
(
n
, 
th‘aV®
) {

160 
couÁfÜz‘a
 = 
n
;

161  
	`z‘a¡©ic
(
n
, 
th‘aV®
);

162 
	}
}

170 
	$z‘a¡©ic
(
n
, 
th‘a
) {

171  
	`z‘a¡©ic
(0, 
n
, 
th‘a
, 0);

172 
	}
}

184 
	$z‘a
(
¡
, 
n
, 
th‘aV®
, 
š™Ÿlsum
) {

185 
couÁfÜz‘a
 = 
n
;

186  
	`z‘a¡©ic
(
¡
, 
n
, 
th‘aV®
, 
š™Ÿlsum
);

187 
	}
}

198 
	$z‘a¡©ic
(
¡
, 
n
, 
th‘a
, 
š™Ÿlsum
) {

199 
sum
 = 
š™Ÿlsum
;

200 
i
 = 
¡
; i < 
n
; i++) {

202 
sum
 +ğ1 / (
M©h
.
	`pow
(
i
 + 1, 
th‘a
));

207  
sum
;

208 
	}
}

219 
	$ÃxtLÚg
(
™emcouÁ
) {

222 ià(
™emcouÁ
 !ğ
couÁfÜz‘a
) {

225 
	`synchrÚized
 (
this
) {

226 ià(
™emcouÁ
 > 
couÁfÜz‘a
) {

231 
z‘ª
 = 
	`z‘a
(
couÁfÜz‘a
, 
™emcouÁ
, 
th‘a
, zetan);

232 
‘a
 = (1 - 
M©h
.
	`pow
(2.0 / 
™ems
, 1 - 
th‘a
)è/ (1 - 
z‘a2th‘a
 / 
z‘ª
);

233 } ià((
™emcouÁ
 < 
couÁfÜz‘a
è&& (
®low™emcouÁdeü—£
)) {

241 
Sy¡em
.
”r
.
	`´šn
("WARNING: Recomputing Zipfian distribtion. This is slow‡nd should be‡voided. " +

242 "(™emcouÁ=" + 
™emcouÁ
 + " couÁfÜz‘a=" + 
couÁfÜz‘a
 + ")");

244 
z‘ª
 = 
	`z‘a
(
™emcouÁ
, 
th‘a
);

245 
‘a
 = (1 - 
M©h
.
	`pow
(2.0 / 
™ems
, 1 - 
th‘a
)è/ (1 - 
z‘a2th‘a
 / 
z‘ª
);

250 
u
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
().
	`ÃxtDoubË
();

251 
uz
 = 
u
 * 
z‘ª
;

253 ià(
uz
 < 1.0) {

254  
ba£
;

257 ià(
uz
 < 1.0 + 
M©h
.
	`pow
(0.5, 
th‘a
)) {

258  
ba£
 + 1;

261 
»t
 = 
ba£
 + (è((
™emcouÁ
è* 
M©h
.
	`pow
(
‘a
 * 
u
 -ƒ + 1, 
®pha
));

262 
	`£tLa¡V®ue
(
»t
);

263  
»t
;

264 
	}
}

272 @
Ov”ride


273 
public
 
LÚg
 
	$ÃxtV®ue
() {

274  
	`ÃxtLÚg
(
™ems
);

275 
	}
}

277 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

278 
Ãw
 
	`ZfŸnG’”©Ü
(
SüambËdZfŸnG’”©Ü
.
ITEM_COUNT
);

279 
	}
}

284 @
Ov”ride


285 
public
 
	$m—n
() {

286 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("@todo implement ZipfianGenerator.mean()");

287 
	}
}

	@generator/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

	@generator/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gg’”©Ü
;

	@measurements/.OneMeasurementHistogram.java.swp

1 
	gb0VIM
 8.1      –û  ì                                     -B460MAORUSPRO                     ~juwÚ/Ëe/YCSB/cÜe/¤c/maš/java/s™e/ycsb/m—su»m’ts/OÃM—su»m’tHi¡og¿m.java                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -8 U3210    #"!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             {                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        &   .     {       ü  ¨  ¡      ï  è  º  ³    '  ä  ¤          +  *  í  ì  Ğ  °  “  ’    7  4  0  ò  ¶    .  -  '   è

8   

9   

13   û   ú   ô   Æ   À   ¥   ¤      `         &   %     Ø  ¬  ”          .  (      Å  ¤    €            ¹  ^  ;      ö  Ù  ¿  £  •  ‡  ƒ  ‚    ?  9    Ë  ¦  ‹  ~  [      &  â  Ê  §  ¦  ~        :  %          ¹    .  -                                        v¬Ÿnû =Ù®squ¬edÏ‹ncy / ((èİ”©iÚsè- (m—À* m—n); m—ÀğtÙ®Ï‹ncy / ((èİ”©iÚs);  expÜtM—su»m’ts(M—su»m’tsExpÜ‹¸expÜ‹rèthrow IOExû±iÚ { @Ov”ride  } }  =†©’cy;  ((max < 0è|| (Ï‹ncy > max)è{  }  =†©’cy;  ((mš < 0è|| (Ï‹ncy < mš)è{   +ğÏ‹ncy; ++;  +ğ((èÏ‹ncyè* ((èÏ‹ncy);  +ğÏ‹ncy; ++; } [Ï‹ncy / 1000]++; } { ++;  (Ï‹ncy / 1000 >ğbuck‘sè{ 

16   
_


19   û   ¡      9   1   í  £  ”  Œ  †  …        %  ß  ×  Ğ    ‡  ƒ  ‚      6  %    î                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         }}} }  "[" + g‘Name(è+ " Av”ageL©’cy(us)=" + d.fÜm©Ô•Ütè+ "]";  = 0;  = 0; »pÜˆğ((èwšdowtÙ®Ï‹ncyè/ ((èwšdowİ”©iÚs);  d =‚ew Decim®FÜm©("#.##"); }  "";  (wšdowİ”©iÚ =ğ0è{  SŒšg g‘Summ¬y(è{ @Ov”ride  } } .wr™e(g‘Name(), ">" + buck‘s, hi¡og¿mov”æow);  } .wr™e(g‘Name(), IÁeg”.toSŒšg(i), hi¡og¿m[i]); ˜ğ0; i < buck‘s; i++è{  (v”bo£è{  ÓxpÜ‹r);  } } ; .wr™e(g‘Name(), "99thP”ûÁeL©’cy(us)", i * 1000);  (((èİcouÁ”è/ ((èİ”©iÚsè>ğ0.9999è{ } 99dÙ95th =rue; .wr™e(g‘Name(), "95thP”ûÁeL©’cy(us)", i * 1000);  ((!dÚe99dÙ95thè&& (((èİcouÁ”è/ ((èİ”©iÚsè>ğ0.9995)è{ } 99dÙ9th =rue; .wr™e(g‘Name(), "MaxL©’cy(us)", i * 1000); 

	@measurements/.OneMeasurementHistogram.java.swp

1 
	gb0VIM
 8.1      –û  ì                                     -B460MAORUSPRO                     ~juwÚ/Ëe/YCSB/cÜe/¤c/maš/java/s™e/ycsb/m—su»m’ts/OÃM—su»m’tHi¡og¿m.java                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -8 U3210    #"!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             {                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        &   .     {       ü  ¨  ¡      ï  è  º  ³    '  ä  ¤          +  *  í  ì  Ğ  °  “  ’    7  4  0  ò  ¶    .  -  '   è

8   

9   

13   û   ú   ô   Æ   À   ¥   ¤      `         &   %     Ø  ¬  ”          .  (      Å  ¤    €            ¹  ^  ;      ö  Ù  ¿  £  •  ‡  ƒ  ‚    ?  9    Ë  ¦  ‹  ~  [      &  â  Ê  §  ¦  ~        :  %          ¹    .  -                                        v¬Ÿnû =Ù®squ¬edÏ‹ncy / ((èİ”©iÚsè- (m—À* m—n); m—ÀğtÙ®Ï‹ncy / ((èİ”©iÚs);  expÜtM—su»m’ts(M—su»m’tsExpÜ‹¸expÜ‹rèthrow IOExû±iÚ { @Ov”ride  } }  =†©’cy;  ((max < 0è|| (Ï‹ncy > max)è{  }  =†©’cy;  ((mš < 0è|| (Ï‹ncy < mš)è{   +ğÏ‹ncy; ++;  +ğ((èÏ‹ncyè* ((èÏ‹ncy);  +ğÏ‹ncy; ++; } [Ï‹ncy / 1000]++; } { ++;  (Ï‹ncy / 1000 >ğbuck‘sè{ 

16   
_


19   û   ¡      9   1   í  £  ”  Œ  †  …        %  ß  ×  Ğ    ‡  ƒ  ‚      6  %    î                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         }}} }  "[" + g‘Name(è+ " Av”ageL©’cy(us)=" + d.fÜm©Ô•Ütè+ "]";  = 0;  = 0; »pÜˆğ((èwšdowtÙ®Ï‹ncyè/ ((èwšdowİ”©iÚs);  d =‚ew Decim®FÜm©("#.##"); }  "";  (wšdowİ”©iÚ =ğ0è{  SŒšg g‘Summ¬y(è{ @Ov”ride  } } .wr™e(g‘Name(), ">" + buck‘s, hi¡og¿mov”æow);  } .wr™e(g‘Name(), IÁeg”.toSŒšg(i), hi¡og¿m[i]); ˜ğ0; i < buck‘s; i++è{  (v”bo£è{  ÓxpÜ‹r);  } } ; .wr™e(g‘Name(), "99thP”ûÁeL©’cy(us)", i * 1000);  (((èİcouÁ”è/ ((èİ”©iÚsè>ğ0.9999è{ } 99dÙ95th =rue; .wr™e(g‘Name(), "95thP”ûÁeL©’cy(us)", i * 1000);  ((!dÚe99dÙ95thè&& (((èİcouÁ”è/ ((èİ”©iÚsè>ğ0.9995)è{ } 99dÙ9th =rue; .wr™e(g‘Name(), "MaxL©’cy(us)", i * 1000); 

	@measurements/Measurements.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

30 
public
 cÏs 
	cM—su»m’ts
 {

34 
public
 
	eM—su»m’tTy³
 {

35 
	mHISTOGRAM
,

36 
	mHDRHISTOGRAM
,

37 
	mHDRHISTOGRAM_AND_HISTOGRAM
,

38 
	mHDRHISTOGRAM_AND_RAW
,

39 
	mTIMESERIES
,

40 
	mRAW


43 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_TYPE_PROPERTY
 = "measurementtype";

44 
´iv©e
 
fš®
 
SŒšg
 
	gMEASUREMENT_TYPE_PROPERTY_DEFAULT
 = "hdrhistogram";

46 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_INTERVAL
 = "measurement.interval";

47 
´iv©e
 
fš®
 
SŒšg
 
	gMEASUREMENT_INTERVAL_DEFAULT
 = "op";

49 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_TRACK_JVM_PROPERTY
 = "measurement.trackjvm";

50 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_TRACK_JVM_PROPERTY_DEFAULT
 = "false";

52 
´iv©e
 
M—su»m’ts
 
	gsšgËtÚ
 = 
nuÎ
;

53 
´iv©e
 
Prİ”t›s
 
	gm—su»m’rİ”t›s
 = 
nuÎ
;

55 
public
 
	$£tPrİ”t›s
(
Prİ”t›s
 
´İs
) {

56 
m—su»m’rİ”t›s
 = 
´İs
;

57 
	}
}

62 
public
 
synchrÚized
 
M—su»m’ts
 
	$g‘M—su»m’ts
() {

63 ià(
sšgËtÚ
 =ğ
nuÎ
) {

64 
sšgËtÚ
 = 
Ãw
 
	`M—su»m’ts
(
m—su»m’rİ”t›s
);

66  
sšgËtÚ
;

67 
	}
}

69 
´iv©e
 
fš®
 
	gCÚcu¼’tHashM­
<
	gSŒšg
, 
	gOÃM—su»m’t
> 
	gİToMesu»m’tM­
;

70 
´iv©e
 
fš®
 
	gCÚcu¼’tHashM­
<
	gSŒšg
, 
	gOÃM—su»m’t
> 
	gİToIÁ’dedMesu»m’tM­
;

71 
´iv©e
 
fš®
 
M—su»m’tTy³
 
	gm—su»m’tTy³
;

72 
´iv©e
 
fš®
 
	gm—su»m’tIÁ”v®
;

73 
´iv©e
 
fš®
 
Prİ”t›s
 
	g´İs
;

78 
public
 
	$M—su»m’ts
(
Prİ”t›s
 
´İs
) {

79 
İToMesu»m’tM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

80 
İToIÁ’dedMesu»m’tM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

82 
this
.
´İs
 =…rops;

84 
SŒšg
 
mTy³SŒšg
 = 
this
.
´İs
.
	`g‘Prİ”ty
(
MEASUREMENT_TYPE_PROPERTY
, 
MEASUREMENT_TYPE_PROPERTY_DEFAULT
);

85 
mTy³SŒšg
) {

87 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HISTOGRAM
;

90 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HDRHISTOGRAM
;

93 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HDRHISTOGRAM_AND_HISTOGRAM
;

96 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HDRHISTOGRAM_AND_RAW
;

99 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
TIMESERIES
;

102 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
RAW
;

105 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("unknowÀ" + 
MEASUREMENT_TYPE_PROPERTY
 + "=" + 
mTy³SŒšg
);

108 
SŒšg
 
mIÁ”v®SŒšg
 = 
this
.
´İs
.
	`g‘Prİ”ty
(
MEASUREMENT_INTERVAL
, 
MEASUREMENT_INTERVAL_DEFAULT
);

109 
mIÁ”v®SŒšg
) {

111 
m—su»m’tIÁ”v®
 = 0;

114 
m—su»m’tIÁ”v®
 = 1;

117 
m—su»m’tIÁ”v®
 = 2;

120 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("unknowÀ" + 
MEASUREMENT_INTERVAL
 + "=" + 
mIÁ”v®SŒšg
);

122 
	}
}

124 
´iv©e
 
OÃM—su»m’t
 
	$cÚ¡ruùOÃM—su»m’t
(
SŒšg
 
Çme
) {

125 
m—su»m’tTy³
) {

126 
HISTOGRAM
:

127  
Ãw
 
	`OÃM—su»m’tHi¡og¿m
(
Çme
, 
´İs
);

128 
HDRHISTOGRAM
:

129  
Ãw
 
	`OÃM—su»m’tHdrHi¡og¿m
(
Çme
, 
´İs
);

130 
HDRHISTOGRAM_AND_HISTOGRAM
:

131  
Ãw
 
	`TwoInOÃM—su»m’t
(
Çme
,

132 
Ãw
 
	`OÃM—su»m’tHdrHi¡og¿m
("Hdr" + 
Çme
, 
´İs
),

133 
Ãw
 
	`OÃM—su»m’tHi¡og¿m
("Buck‘" + 
Çme
, 
´İs
));

134 
HDRHISTOGRAM_AND_RAW
:

135  
Ãw
 
	`TwoInOÃM—su»m’t
(
Çme
,

136 
Ãw
 
	`OÃM—su»m’tHdrHi¡og¿m
("Hdr" + 
Çme
, 
´İs
),

137 
Ãw
 
	`OÃM—su»m’tRaw
("Raw" + 
Çme
, 
´İs
));

138 
TIMESERIES
:

139  
Ãw
 
	`OÃM—su»m’tTimeS”›s
(
Çme
, 
´İs
);

140 
RAW
:

141  
Ãw
 
	`OÃM—su»m’tRaw
(
Çme
, 
´İs
);

143 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("Impossibleo be here. Dead code„eached. Bugs?");

145 
	}
}

147 şas 
	cS¹TimeHŞd”
 {

148 
´Ùeùed
 
	gtime
;

150 
¡¬tTime
() {

151 ià(
	gtime
 == 0) {

152  
Sy¡em
.
ÇnoTime
();

154  
	gtime
;

159 
´iv©e
 
fš®
 
	gTh»adLoÿl
<
	gS¹TimeHŞd”
> 
	gIÁ’dedS¹Time
 = 
Ãw
 
Th»adLoÿl
<
M—su»m’ts
.
S¹TimeHŞd”
>() {

160 
´Ùeùed
 
S¹TimeHŞd”
 
š™ŸlV®ue
() {

161  
Ãw
 
S¹TimeHŞd”
();

165 
public
 
	$£tIÁ’dedS¹TimeNs
(
time
) {

166 ià(
m—su»m’tIÁ”v®
 == 0) {

169 
IÁ’dedS¹Time
.
	`g‘
().
time
 =ime;

170 
	}
}

172 
public
 
	$g‘IÁ’dedS¹TimeNs
() {

173 ià(
m—su»m’tIÁ”v®
 == 0) {

176  
IÁ’dedS¹Time
.
	`g‘
().
	`¡¬tTime
();

177 
	}
}

183 
public
 
	$m—su»
(
SŒšg
 
İ”©iÚ
, 
Ï‹ncy
) {

184 ià(
m—su»m’tIÁ”v®
 == 1) {

187 
Œy
 {

188 
OÃM—su»m’t
 
m
 = 
	`g‘OpM—su»m’t
(
İ”©iÚ
);

189 
m
.
	`m—su»
(
Ï‹ncy
);

190 } 
	`ÿtch
 (
java
.
Ïng
.
A¼ayIndexOutOfBoundsExû±iÚ
 
e
) {

192 
Sy¡em
.
out
.
	`´šn
("ERROR: java.lang.ArrayIndexOutOfBoundsException - ignoring‡nd continuing");

193 
e
.
	`´štSckT¿û
();

194 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

196 
	}
}

202 
public
 
	$m—su»IÁ’ded
(
SŒšg
 
İ”©iÚ
, 
Ï‹ncy
) {

203 ià(
m—su»m’tIÁ”v®
 == 0) {

206 
Œy
 {

207 
OÃM—su»m’t
 
m
 = 
	`g‘OpIÁ’dedM—su»m’t
(
İ”©iÚ
);

208 
m
.
	`m—su»
(
Ï‹ncy
);

209 } 
	`ÿtch
 (
java
.
Ïng
.
A¼ayIndexOutOfBoundsExû±iÚ
 
e
) {

211 
Sy¡em
.
out
.
	`´šn
("ERROR: java.lang.ArrayIndexOutOfBoundsException - ignoring‡nd continuing");

212 
e
.
	`´štSckT¿û
();

213 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

215 
	}
}

217 
´iv©e
 
OÃM—su»m’t
 
	$g‘OpM—su»m’t
(
SŒšg
 
İ”©iÚ
) {

218 
OÃM—su»m’t
 
m
 = 
İToMesu»m’tM­
.
	`g‘
(
İ”©iÚ
);

219 ià(
m
 =ğ
nuÎ
) {

220 
m
 = 
	`cÚ¡ruùOÃM—su»m’t
(
İ”©iÚ
);

221 
OÃM—su»m’t
 
ŞdM
 = 
İToMesu»m’tM­
.
	`putIfAb£Á
(
İ”©iÚ
, 
m
);

222 ià(
ŞdM
 !ğ
nuÎ
) {

223 
m
 = 
ŞdM
;

226  
m
;

227 
	}
}

229 
´iv©e
 
OÃM—su»m’t
 
	$g‘OpIÁ’dedM—su»m’t
(
SŒšg
 
İ”©iÚ
) {

230 
OÃM—su»m’t
 
m
 = 
İToIÁ’dedMesu»m’tM­
.
	`g‘
(
İ”©iÚ
);

231 ià(
m
 =ğ
nuÎ
) {

232 
fš®
 
SŒšg
 
Çme
 = 
m—su»m’tIÁ”v®
 =ğ1 ? 
İ”©iÚ
 : "Intended-" + operation;

233 
m
 = 
	`cÚ¡ruùOÃM—su»m’t
(
Çme
);

234 
OÃM—su»m’t
 
ŞdM
 = 
İToIÁ’dedMesu»m’tM­
.
	`putIfAb£Á
(
İ”©iÚ
, 
m
);

235 ià(
ŞdM
 !ğ
nuÎ
) {

236 
m
 = 
ŞdM
;

239  
m
;

240 
	}
}

245 
public
 
	$»pÜtStus
(
fš®
 
SŒšg
 
İ”©iÚ
, fš® 
Stus
 
¡©us
) {

246 
OÃM—su»m’t
 
m
 = 
m—su»m’tIÁ”v®
 == 1 ?

247 
	`g‘OpIÁ’dedM—su»m’t
(
İ”©iÚ
) :

248 
	`g‘OpM—su»m’t
(
İ”©iÚ
);

249 
m
.
	`»pÜtStus
(
¡©us
);

250 
	}
}

258 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

259 
OÃM—su»m’t
 
m—su»m’t
 : 
İToMesu»m’tM­
.
	`v®ues
()) {

260 
m—su»m’t
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

262 
OÃM—su»m’t
 
m—su»m’t
 : 
İToIÁ’dedMesu»m’tM­
.
	`v®ues
()) {

263 
m—su»m’t
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

265 
	}
}

270 
public
 
synchrÚized
 
SŒšg
 
	$g‘Summ¬y
() {

271 
SŒšg
 
»t
 = "";

272 
OÃM—su»m’t
 
m
 : 
İToMesu»m’tM­
.
	`v®ues
()) {

273 
»t
 +ğ
m
.
	`g‘Summ¬y
() + " ";

275 
OÃM—su»m’t
 
m
 : 
İToIÁ’dedMesu»m’tM­
.
	`v®ues
()) {

276 
»t
 +ğ
m
.
	`g‘Summ¬y
() + " ";

278  
»t
;

279 
	}
}

	@measurements/Measurements.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

30 
public
 cÏs 
	cM—su»m’ts
 {

34 
public
 
	eM—su»m’tTy³
 {

35 
	mHISTOGRAM
,

36 
	mHDRHISTOGRAM
,

37 
	mHDRHISTOGRAM_AND_HISTOGRAM
,

38 
	mHDRHISTOGRAM_AND_RAW
,

39 
	mTIMESERIES
,

40 
	mRAW


43 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_TYPE_PROPERTY
 = "measurementtype";

44 
´iv©e
 
fš®
 
SŒšg
 
	gMEASUREMENT_TYPE_PROPERTY_DEFAULT
 = "hdrhistogram";

46 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_INTERVAL
 = "measurement.interval";

47 
´iv©e
 
fš®
 
SŒšg
 
	gMEASUREMENT_INTERVAL_DEFAULT
 = "op";

49 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_TRACK_JVM_PROPERTY
 = "measurement.trackjvm";

50 
public
 
fš®
 
SŒšg
 
	gMEASUREMENT_TRACK_JVM_PROPERTY_DEFAULT
 = "false";

52 
´iv©e
 
M—su»m’ts
 
	gsšgËtÚ
 = 
nuÎ
;

53 
´iv©e
 
Prİ”t›s
 
	gm—su»m’rİ”t›s
 = 
nuÎ
;

55 
public
 
	$£tPrİ”t›s
(
Prİ”t›s
 
´İs
) {

56 
m—su»m’rİ”t›s
 = 
´İs
;

57 
	}
}

62 
public
 
synchrÚized
 
M—su»m’ts
 
	$g‘M—su»m’ts
() {

63 ià(
sšgËtÚ
 =ğ
nuÎ
) {

64 
sšgËtÚ
 = 
Ãw
 
	`M—su»m’ts
(
m—su»m’rİ”t›s
);

66  
sšgËtÚ
;

67 
	}
}

69 
´iv©e
 
fš®
 
	gCÚcu¼’tHashM­
<
	gSŒšg
, 
	gOÃM—su»m’t
> 
	gİToMesu»m’tM­
;

70 
´iv©e
 
fš®
 
	gCÚcu¼’tHashM­
<
	gSŒšg
, 
	gOÃM—su»m’t
> 
	gİToIÁ’dedMesu»m’tM­
;

71 
´iv©e
 
fš®
 
M—su»m’tTy³
 
	gm—su»m’tTy³
;

72 
´iv©e
 
fš®
 
	gm—su»m’tIÁ”v®
;

73 
´iv©e
 
fš®
 
Prİ”t›s
 
	g´İs
;

78 
public
 
	$M—su»m’ts
(
Prİ”t›s
 
´İs
) {

79 
İToMesu»m’tM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

80 
İToIÁ’dedMesu»m’tM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

82 
this
.
´İs
 =…rops;

84 
SŒšg
 
mTy³SŒšg
 = 
this
.
´İs
.
	`g‘Prİ”ty
(
MEASUREMENT_TYPE_PROPERTY
, 
MEASUREMENT_TYPE_PROPERTY_DEFAULT
);

85 
mTy³SŒšg
) {

87 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HISTOGRAM
;

90 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HDRHISTOGRAM
;

93 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HDRHISTOGRAM_AND_HISTOGRAM
;

96 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
HDRHISTOGRAM_AND_RAW
;

99 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
TIMESERIES
;

102 
m—su»m’tTy³
 = 
M—su»m’tTy³
.
RAW
;

105 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("unknowÀ" + 
MEASUREMENT_TYPE_PROPERTY
 + "=" + 
mTy³SŒšg
);

108 
SŒšg
 
mIÁ”v®SŒšg
 = 
this
.
´İs
.
	`g‘Prİ”ty
(
MEASUREMENT_INTERVAL
, 
MEASUREMENT_INTERVAL_DEFAULT
);

109 
mIÁ”v®SŒšg
) {

111 
m—su»m’tIÁ”v®
 = 0;

114 
m—su»m’tIÁ”v®
 = 1;

117 
m—su»m’tIÁ”v®
 = 2;

120 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("unknowÀ" + 
MEASUREMENT_INTERVAL
 + "=" + 
mIÁ”v®SŒšg
);

122 
	}
}

124 
´iv©e
 
OÃM—su»m’t
 
	$cÚ¡ruùOÃM—su»m’t
(
SŒšg
 
Çme
) {

125 
m—su»m’tTy³
) {

126 
HISTOGRAM
:

127  
Ãw
 
	`OÃM—su»m’tHi¡og¿m
(
Çme
, 
´İs
);

128 
HDRHISTOGRAM
:

129  
Ãw
 
	`OÃM—su»m’tHdrHi¡og¿m
(
Çme
, 
´İs
);

130 
HDRHISTOGRAM_AND_HISTOGRAM
:

131  
Ãw
 
	`TwoInOÃM—su»m’t
(
Çme
,

132 
Ãw
 
	`OÃM—su»m’tHdrHi¡og¿m
("Hdr" + 
Çme
, 
´İs
),

133 
Ãw
 
	`OÃM—su»m’tHi¡og¿m
("Buck‘" + 
Çme
, 
´İs
));

134 
HDRHISTOGRAM_AND_RAW
:

135  
Ãw
 
	`TwoInOÃM—su»m’t
(
Çme
,

136 
Ãw
 
	`OÃM—su»m’tHdrHi¡og¿m
("Hdr" + 
Çme
, 
´İs
),

137 
Ãw
 
	`OÃM—su»m’tRaw
("Raw" + 
Çme
, 
´İs
));

138 
TIMESERIES
:

139  
Ãw
 
	`OÃM—su»m’tTimeS”›s
(
Çme
, 
´İs
);

140 
RAW
:

141  
Ãw
 
	`OÃM—su»m’tRaw
(
Çme
, 
´İs
);

143 
throw
 
Ãw
 
	`As£¹iÚE¼Ü
("Impossibleo be here. Dead code„eached. Bugs?");

145 
	}
}

147 şas 
	cS¹TimeHŞd”
 {

148 
´Ùeùed
 
	gtime
;

150 
¡¬tTime
() {

151 ià(
	gtime
 == 0) {

152  
Sy¡em
.
ÇnoTime
();

154  
	gtime
;

159 
´iv©e
 
fš®
 
	gTh»adLoÿl
<
	gS¹TimeHŞd”
> 
	gIÁ’dedS¹Time
 = 
Ãw
 
Th»adLoÿl
<
M—su»m’ts
.
S¹TimeHŞd”
>() {

160 
´Ùeùed
 
S¹TimeHŞd”
 
š™ŸlV®ue
() {

161  
Ãw
 
S¹TimeHŞd”
();

165 
public
 
	$£tIÁ’dedS¹TimeNs
(
time
) {

166 ià(
m—su»m’tIÁ”v®
 == 0) {

169 
IÁ’dedS¹Time
.
	`g‘
().
time
 =ime;

170 
	}
}

172 
public
 
	$g‘IÁ’dedS¹TimeNs
() {

173 ià(
m—su»m’tIÁ”v®
 == 0) {

176  
IÁ’dedS¹Time
.
	`g‘
().
	`¡¬tTime
();

177 
	}
}

183 
public
 
	$m—su»
(
SŒšg
 
İ”©iÚ
, 
Ï‹ncy
) {

184 ià(
m—su»m’tIÁ”v®
 == 1) {

187 
Œy
 {

188 
OÃM—su»m’t
 
m
 = 
	`g‘OpM—su»m’t
(
İ”©iÚ
);

189 
m
.
	`m—su»
(
Ï‹ncy
);

190 } 
	`ÿtch
 (
java
.
Ïng
.
A¼ayIndexOutOfBoundsExû±iÚ
 
e
) {

192 
Sy¡em
.
out
.
	`´šn
("ERROR: java.lang.ArrayIndexOutOfBoundsException - ignoring‡nd continuing");

193 
e
.
	`´štSckT¿û
();

194 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

196 
	}
}

202 
public
 
	$m—su»IÁ’ded
(
SŒšg
 
İ”©iÚ
, 
Ï‹ncy
) {

203 ià(
m—su»m’tIÁ”v®
 == 0) {

206 
Œy
 {

207 
OÃM—su»m’t
 
m
 = 
	`g‘OpIÁ’dedM—su»m’t
(
İ”©iÚ
);

208 
m
.
	`m—su»
(
Ï‹ncy
);

209 } 
	`ÿtch
 (
java
.
Ïng
.
A¼ayIndexOutOfBoundsExû±iÚ
 
e
) {

211 
Sy¡em
.
out
.
	`´šn
("ERROR: java.lang.ArrayIndexOutOfBoundsException - ignoring‡nd continuing");

212 
e
.
	`´štSckT¿û
();

213 
e
.
	`´štSckT¿û
(
Sy¡em
.
out
);

215 
	}
}

217 
´iv©e
 
OÃM—su»m’t
 
	$g‘OpM—su»m’t
(
SŒšg
 
İ”©iÚ
) {

218 
OÃM—su»m’t
 
m
 = 
İToMesu»m’tM­
.
	`g‘
(
İ”©iÚ
);

219 ià(
m
 =ğ
nuÎ
) {

220 
m
 = 
	`cÚ¡ruùOÃM—su»m’t
(
İ”©iÚ
);

221 
OÃM—su»m’t
 
ŞdM
 = 
İToMesu»m’tM­
.
	`putIfAb£Á
(
İ”©iÚ
, 
m
);

222 ià(
ŞdM
 !ğ
nuÎ
) {

223 
m
 = 
ŞdM
;

226  
m
;

227 
	}
}

229 
´iv©e
 
OÃM—su»m’t
 
	$g‘OpIÁ’dedM—su»m’t
(
SŒšg
 
İ”©iÚ
) {

230 
OÃM—su»m’t
 
m
 = 
İToIÁ’dedMesu»m’tM­
.
	`g‘
(
İ”©iÚ
);

231 ià(
m
 =ğ
nuÎ
) {

232 
fš®
 
SŒšg
 
Çme
 = 
m—su»m’tIÁ”v®
 =ğ1 ? 
İ”©iÚ
 : "Intended-" + operation;

233 
m
 = 
	`cÚ¡ruùOÃM—su»m’t
(
Çme
);

234 
OÃM—su»m’t
 
ŞdM
 = 
İToIÁ’dedMesu»m’tM­
.
	`putIfAb£Á
(
İ”©iÚ
, 
m
);

235 ià(
ŞdM
 !ğ
nuÎ
) {

236 
m
 = 
ŞdM
;

239  
m
;

240 
	}
}

245 
public
 
	$»pÜtStus
(
fš®
 
SŒšg
 
İ”©iÚ
, fš® 
Stus
 
¡©us
) {

246 
OÃM—su»m’t
 
m
 = 
m—su»m’tIÁ”v®
 == 1 ?

247 
	`g‘OpIÁ’dedM—su»m’t
(
İ”©iÚ
) :

248 
	`g‘OpM—su»m’t
(
İ”©iÚ
);

249 
m
.
	`»pÜtStus
(
¡©us
);

250 
	}
}

258 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

259 
OÃM—su»m’t
 
m—su»m’t
 : 
İToMesu»m’tM­
.
	`v®ues
()) {

260 
m—su»m’t
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

262 
OÃM—su»m’t
 
m—su»m’t
 : 
İToIÁ’dedMesu»m’tM­
.
	`v®ues
()) {

263 
m—su»m’t
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

265 
	}
}

270 
public
 
synchrÚized
 
SŒšg
 
	$g‘Summ¬y
() {

271 
SŒšg
 
»t
 = "";

272 
OÃM—su»m’t
 
m
 : 
İToMesu»m’tM­
.
	`v®ues
()) {

273 
»t
 +ğ
m
.
	`g‘Summ¬y
() + " ";

275 
OÃM—su»m’t
 
m
 : 
İToIÁ’dedMesu»m’tM­
.
	`v®ues
()) {

276 
»t
 +ğ
m
.
	`g‘Summ¬y
() + " ";

278  
»t
;

279 
	}
}

	@measurements/OneMeasurement.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

31 
public
 
ab¡¿ù
 cÏs 
	cOÃM—su»m’t
 {

33 
´iv©e
 
fš®
 
SŒšg
 
	mÇme
;

34 
´iv©e
 
fš®
 
	mCÚcu¼’tHashM­
<
	mStus
, 
	mAtomicIÁeg”
> 
	m»tuºcodes
;

36 
public
 
SŒšg
 
	$g‘Name
() {

37  
Çme
;

43 
public
 
	$OÃM—su»m’t
(
SŒšg
 
Çme
) {

44 
this
.
Çme
 =‚ame;

45 
this
.
»tuºcodes
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

46 
	}
}

48 
public
 
ab¡¿ù
 
m—su»
(
Ï‹ncy
);

50 
public
 
ab¡¿ù
 
SŒšg
 
g‘Summ¬y
();

55 
public
 
	$»pÜtStus
(
Stus
 
¡©us
) {

56 
AtomicIÁeg”
 
couÁ”
 = 
»tuºcodes
.
	`g‘
(
¡©us
);

58 ià(
couÁ”
 =ğ
nuÎ
) {

59 
couÁ”
 = 
Ãw
 
	`AtomicIÁeg”
();

60 
AtomicIÁeg”
 
Ùh”
 = 
»tuºcodes
.
	`putIfAb£Á
(
¡©us
, 
couÁ”
);

61 ià(
Ùh”
 !ğ
nuÎ
) {

62 
couÁ”
 = 
Ùh”
;

66 
couÁ”
.
	`šüem’tAndG‘
();

67 
	}
}

75 
public
 
ab¡¿ù
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
;

77 
´Ùeùed
 
fš®
 
	$expÜtStusCouÁs
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

78 
M­
.
EÁry
<
Stus
, 
AtomicIÁeg”
> 
’Œy
 : 
»tuºcodes
.
	`’ŒyS‘
()) {

79 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "R‘uº=" + 
’Œy
.
	`g‘Key
().g‘Name(),ƒÁry.
	`g‘V®ue
().
	`g‘
());

81 
	}
}

	@measurements/OneMeasurement.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

31 
public
 
ab¡¿ù
 cÏs 
	cOÃM—su»m’t
 {

33 
´iv©e
 
fš®
 
SŒšg
 
	mÇme
;

34 
´iv©e
 
fš®
 
	mCÚcu¼’tHashM­
<
	mStus
, 
	mAtomicIÁeg”
> 
	m»tuºcodes
;

36 
public
 
SŒšg
 
	$g‘Name
() {

37  
Çme
;

43 
public
 
	$OÃM—su»m’t
(
SŒšg
 
Çme
) {

44 
this
.
Çme
 =‚ame;

45 
this
.
»tuºcodes
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

46 
	}
}

48 
public
 
ab¡¿ù
 
m—su»
(
Ï‹ncy
);

50 
public
 
ab¡¿ù
 
SŒšg
 
g‘Summ¬y
();

55 
public
 
	$»pÜtStus
(
Stus
 
¡©us
) {

56 
AtomicIÁeg”
 
couÁ”
 = 
»tuºcodes
.
	`g‘
(
¡©us
);

58 ià(
couÁ”
 =ğ
nuÎ
) {

59 
couÁ”
 = 
Ãw
 
	`AtomicIÁeg”
();

60 
AtomicIÁeg”
 
Ùh”
 = 
»tuºcodes
.
	`putIfAb£Á
(
¡©us
, 
couÁ”
);

61 ià(
Ùh”
 !ğ
nuÎ
) {

62 
couÁ”
 = 
Ùh”
;

66 
couÁ”
.
	`šüem’tAndG‘
();

67 
	}
}

75 
public
 
ab¡¿ù
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
;

77 
´Ùeùed
 
fš®
 
	$expÜtStusCouÁs
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

78 
M­
.
EÁry
<
Stus
, 
AtomicIÁeg”
> 
’Œy
 : 
»tuºcodes
.
	`’ŒyS‘
()) {

79 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "R‘uº=" + 
’Œy
.
	`g‘Key
().g‘Name(),ƒÁry.
	`g‘V®ue
().
	`g‘
());

81 
	}
}

	@measurements/OneMeasurementHdrHistogram.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

21 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gHi¡og¿m
;

22 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gHi¡og¿mI‹¿tiÚV®ue
;

23 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gHi¡og¿mLogWr™”
;

24 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gRecÜd”
;

26 
impÜt
 
	gjava
.
	gio
.
	gFeNÙFoundExû±iÚ
;

27 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

28 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

29 
impÜt
 
	gjava
.
	gio
.
	gPrštSŒ—m
;

30 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

31 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

32 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

33 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

39 
public
 cÏs 
	cOÃM—su»m’tHdrHi¡og¿m
 
ex‹nds
 
	mOÃM—su»m’t
 {

42 
´iv©e
 
fš®
 
PrštSŒ—m
 
	mlog
;

43 
´iv©e
 
fš®
 
Hi¡og¿mLogWr™”
 
	mhi¡og¿mLogWr™”
;

45 
´iv©e
 
fš®
 
RecÜd”
 
	mhi¡og¿m
;

46 
´iv©e
 
Hi¡og¿m
 
	mtÙ®Hi¡og¿m
;

51 
public
 
fš®
 
SŒšg
 
	mPERCENTILES_PROPERTY
 = "hdrhistogram.percentiles";

56 
public
 
fš®
 
SŒšg
 
	mPERCENTILES_PROPERTY_DEFAULT
 = "95,99";

61 
public
 
fš®
 
SŒšg
 
	mVERBOSE_PROPERTY
 = "measurement.histogram.verbose";

66 
´iv©e
 
fš®
 
boŞ—n
 
	mv”bo£
;

68 
´iv©e
 
fš®
 
	mLi¡
<
	mDoubË
> 
	m³rûÁes
;

70 
public
 
	$OÃM—su»m’tHdrHi¡og¿m
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

71 
	`su³r
(
Çme
);

72 
³rûÁes
 = 
	`g‘P”ûÁeV®ues
(
´İs
.
	`g‘Prİ”ty
(
PERCENTILES_PROPERTY
, 
PERCENTILES_PROPERTY_DEFAULT
));

73 
v”bo£
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
VERBOSE_PROPERTY
, 
SŒšg
.v®ueOf(
çl£
)));

74 
boŞ—n
 
shouldLog
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("hdrhistogram.fileoutput", "false"));

75 ià(!
shouldLog
) {

76 
log
 = 
nuÎ
;

77 
hi¡og¿mLogWr™”
 = 
nuÎ
;

79 
Œy
 {

80 
fš®
 
SŒšg
 
hdrOuutF’ame
 = 
´İs
.
	`g‘Prİ”ty
("hdrhi¡og¿m.ouut.·th", ""è+ 
Çme
 + ".hdr";

81 
log
 = 
Ãw
 
	`PrštSŒ—m
Òew 
	`FeOuutSŒ—m
(
hdrOuutF’ame
), 
çl£
);

82 } 
	`ÿtch
 (
FeNÙFoundExû±iÚ
 
e
) {

83 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("FaedØİ’ hd¸hi¡og¿m ouuˆfe", 
e
);

85 
hi¡og¿mLogWr™”
 = 
Ãw
 
	`Hi¡og¿mLogWr™”
(
log
);

86 
hi¡og¿mLogWr™”
.
	`ouutComm’t
("[Loggšg fÜ: " + 
Çme
 + "]");

87 
hi¡og¿mLogWr™”
.
	`ouutLogFÜm©V”siÚ
();

88 
now
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

89 
hi¡og¿mLogWr™”
.
	`ouutS¹Time
(
now
);

90 
hi¡og¿mLogWr™”
.
	`£tBa£Time
(
now
);

91 
hi¡og¿mLogWr™”
.
	`ouutLeg’d
();

93 
hi¡og¿m
 = 
Ãw
 
	`RecÜd”
(3);

100 
public
 
	$m—su»
(
Ï‹ncyInMiüos
) {

101 
hi¡og¿m
.
	`»cÜdV®ue
(
Ï‹ncyInMiüos
);

102 
	}
}

107 @
Ov”ride


108 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

110 
Hi¡og¿m
 
š‹rv®Hi¡og¿m
 = 
	`g‘IÁ”v®Hi¡og¿mAndAccumuÏ‹
();

111 ià(
hi¡og¿mLogWr™”
 !ğ
nuÎ
) {

112 
hi¡og¿mLogWr™”
.
	`ouutIÁ”v®Hi¡og¿m
(
š‹rv®Hi¡og¿m
);

114 
log
.
	`şo£
();

116 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "O³¿tiÚs", 
tÙ®Hi¡og¿m
.
	`g‘TÙ®CouÁ
());

117 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Av”ageL©’cy(us)", 
tÙ®Hi¡og¿m
.
	`g‘M—n
());

118 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MšL©’cy(us)", 
tÙ®Hi¡og¿m
.
	`g‘MšV®ue
());

119 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MaxL©’cy(us)", 
tÙ®Hi¡og¿m
.
	`g‘MaxV®ue
());

121 
DoubË
 
³rûÁe
 : 
³rûÁes
) {

122 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
	`Üdš®
(
³rûÁe
) + "PercentileLatency(us)",

123 
tÙ®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(
³rûÁe
));

126 
	`expÜtStusCouÁs
(
expÜ‹r
);

129 ià(
v”bo£
) {

130 
Hi¡og¿mI‹¿tiÚV®ue
 
v
 : 
tÙ®Hi¡og¿m
.
	`»cÜdedV®ues
()) {

131 
v®ue
;

132 ià(
v
.
	`g‘V®ueI‹¿‹dTo
(è> ()
IÁeg”
.
MAX_VALUE
) {

133 
v®ue
 = 
IÁeg”
.
MAX_VALUE
;

135 
v®ue
 = ()
v
.
	`g‘V®ueI‹¿‹dTo
();

138 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
IÁeg”
.
	`toSŒšg
(
v®ue
), ()
v
.
	`g‘CouÁAtV®ueI‹¿‹dTo
());

141 
	}
}

150 @
Ov”ride


151 
public
 
SŒšg
 
	$g‘Summ¬y
() {

152 
Hi¡og¿m
 
š‹rv®Hi¡og¿m
 = 
	`g‘IÁ”v®Hi¡og¿mAndAccumuÏ‹
();

154 ià(
hi¡og¿mLogWr™”
 !ğ
nuÎ
) {

155 
hi¡og¿mLogWr™”
.
	`ouutIÁ”v®Hi¡og¿m
(
š‹rv®Hi¡og¿m
);

158 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

159  "[" + 
	`g‘Name
(è+ ": CouÁ=" + 
š‹rv®Hi¡og¿m
.
	`g‘TÙ®CouÁ
() + ", Max="

160 + 
š‹rv®Hi¡og¿m
.
	`g‘MaxV®ue
(è+ ", Mš=" + iÁ”v®Hi¡og¿m.
	`g‘MšV®ue
() + ", Avg="

161 + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘M—n
()è+ ", 90=" + d.fÜm©(š‹rv®Hi¡og¿m.
	`g‘V®ueAtP”ûÁe
(90))

162 + ", 99=" + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(99)) + ", 99.9="

163 + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(99.9)) + ", 99.99="

164 + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(99.99)) + "]";

165 
	}
}

167 
´iv©e
 
Hi¡og¿m
 
	$g‘IÁ”v®Hi¡og¿mAndAccumuÏ‹
() {

168 
Hi¡og¿m
 
š‹rv®Hi¡og¿m
 = 
hi¡og¿m
.
	`g‘IÁ”v®Hi¡og¿m
();

170 ià(
tÙ®Hi¡og¿m
 =ğ
nuÎ
) {

171 
tÙ®Hi¡og¿m
 = 
š‹rv®Hi¡og¿m
;

173 
tÙ®Hi¡og¿m
.
	`add
(
š‹rv®Hi¡og¿m
);

175  
š‹rv®Hi¡og¿m
;

176 
	}
}

184 
´iv©e
 
	gLi¡
<
	gDoubË
> 
	$g‘P”ûÁeV®ues
(
SŒšg
 
³rûÁeSŒšg
) {

185 
Li¡
<
DoubË
> 
³rûÁeV®ues
 = 
Ãw
 
A¼ayLi¡
<>();

187 
Œy
 {

188 
SŒšg
 
¿wP”ûÁe
 : 
³rûÁeSŒšg
.
	`¥l™
(",")) {

189 
³rûÁeV®ues
.
	`add
(
DoubË
.
	`·r£DoubË
(
¿wP”ûÁe
));

191 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

194 
Sy¡em
.
”r
.
	`´šn
("[WARN] Couldn'ˆ»ad " + 
PERCENTILES_PROPERTY
 + " v®ue: '" + 
³rûÁeSŒšg
 +

195 "',hdeçuÉ oà'" + 
PERCENTILES_PROPERTY_DEFAULT
 + "' will be used.");

196 
e
.
	`´štSckT¿û
();

197  
	`g‘P”ûÁeV®ues
(
PERCENTILES_PROPERTY_DEFAULT
);

200  
³rûÁeV®ues
;

201 
	}
}

208 
´iv©e
 
SŒšg
 
	$Üdš®
(
DoubË
 
i
) {

209 
SŒšg
[] 
suffixes
 = 
Ãw
 String[]{"th", "st", "nd", "rd", "th", "th", "th", "th", "th", "th"};

210 
IÁeg”
 
j
 = 
i
.
	`štV®ue
();

211 ià(
i
 % 1 == 0) {

212 
j
 % 100) {

216  
j
 + "th";

218  
j
 + 
suffixes
[j % 10];

221  
i
.
	`toSŒšg
();

223 
	}
}

	@measurements/OneMeasurementHdrHistogram.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

21 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gHi¡og¿m
;

22 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gHi¡og¿mI‹¿tiÚV®ue
;

23 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gHi¡og¿mLogWr™”
;

24 
impÜt
 
	gÜg
.
	gHdrHi¡og¿m
.
	gRecÜd”
;

26 
impÜt
 
	gjava
.
	gio
.
	gFeNÙFoundExû±iÚ
;

27 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

28 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

29 
impÜt
 
	gjava
.
	gio
.
	gPrštSŒ—m
;

30 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

31 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

32 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

33 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

39 
public
 cÏs 
	cOÃM—su»m’tHdrHi¡og¿m
 
ex‹nds
 
	mOÃM—su»m’t
 {

42 
´iv©e
 
fš®
 
PrštSŒ—m
 
	mlog
;

43 
´iv©e
 
fš®
 
Hi¡og¿mLogWr™”
 
	mhi¡og¿mLogWr™”
;

45 
´iv©e
 
fš®
 
RecÜd”
 
	mhi¡og¿m
;

46 
´iv©e
 
Hi¡og¿m
 
	mtÙ®Hi¡og¿m
;

51 
public
 
fš®
 
SŒšg
 
	mPERCENTILES_PROPERTY
 = "hdrhistogram.percentiles";

56 
public
 
fš®
 
SŒšg
 
	mPERCENTILES_PROPERTY_DEFAULT
 = "95,99";

61 
public
 
fš®
 
SŒšg
 
	mVERBOSE_PROPERTY
 = "measurement.histogram.verbose";

66 
´iv©e
 
fš®
 
boŞ—n
 
	mv”bo£
;

68 
´iv©e
 
fš®
 
	mLi¡
<
	mDoubË
> 
	m³rûÁes
;

70 
public
 
	$OÃM—su»m’tHdrHi¡og¿m
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

71 
	`su³r
(
Çme
);

72 
³rûÁes
 = 
	`g‘P”ûÁeV®ues
(
´İs
.
	`g‘Prİ”ty
(
PERCENTILES_PROPERTY
, 
PERCENTILES_PROPERTY_DEFAULT
));

73 
v”bo£
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
VERBOSE_PROPERTY
, 
SŒšg
.v®ueOf(
çl£
)));

74 
boŞ—n
 
shouldLog
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("hdrhistogram.fileoutput", "false"));

75 ià(!
shouldLog
) {

76 
log
 = 
nuÎ
;

77 
hi¡og¿mLogWr™”
 = 
nuÎ
;

79 
Œy
 {

80 
fš®
 
SŒšg
 
hdrOuutF’ame
 = 
´İs
.
	`g‘Prİ”ty
("hdrhi¡og¿m.ouut.·th", ""è+ 
Çme
 + ".hdr";

81 
log
 = 
Ãw
 
	`PrštSŒ—m
Òew 
	`FeOuutSŒ—m
(
hdrOuutF’ame
), 
çl£
);

82 } 
	`ÿtch
 (
FeNÙFoundExû±iÚ
 
e
) {

83 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("FaedØİ’ hd¸hi¡og¿m ouuˆfe", 
e
);

85 
hi¡og¿mLogWr™”
 = 
Ãw
 
	`Hi¡og¿mLogWr™”
(
log
);

86 
hi¡og¿mLogWr™”
.
	`ouutComm’t
("[Loggšg fÜ: " + 
Çme
 + "]");

87 
hi¡og¿mLogWr™”
.
	`ouutLogFÜm©V”siÚ
();

88 
now
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

89 
hi¡og¿mLogWr™”
.
	`ouutS¹Time
(
now
);

90 
hi¡og¿mLogWr™”
.
	`£tBa£Time
(
now
);

91 
hi¡og¿mLogWr™”
.
	`ouutLeg’d
();

93 
hi¡og¿m
 = 
Ãw
 
	`RecÜd”
(3);

100 
public
 
	$m—su»
(
Ï‹ncyInMiüos
) {

101 
hi¡og¿m
.
	`»cÜdV®ue
(
Ï‹ncyInMiüos
);

102 
	}
}

107 @
Ov”ride


108 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

110 
Hi¡og¿m
 
š‹rv®Hi¡og¿m
 = 
	`g‘IÁ”v®Hi¡og¿mAndAccumuÏ‹
();

111 ià(
hi¡og¿mLogWr™”
 !ğ
nuÎ
) {

112 
hi¡og¿mLogWr™”
.
	`ouutIÁ”v®Hi¡og¿m
(
š‹rv®Hi¡og¿m
);

114 
log
.
	`şo£
();

116 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "O³¿tiÚs", 
tÙ®Hi¡og¿m
.
	`g‘TÙ®CouÁ
());

117 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Av”ageL©’cy(us)", 
tÙ®Hi¡og¿m
.
	`g‘M—n
());

118 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MšL©’cy(us)", 
tÙ®Hi¡og¿m
.
	`g‘MšV®ue
());

119 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MaxL©’cy(us)", 
tÙ®Hi¡og¿m
.
	`g‘MaxV®ue
());

121 
DoubË
 
³rûÁe
 : 
³rûÁes
) {

122 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
	`Üdš®
(
³rûÁe
) + "PercentileLatency(us)",

123 
tÙ®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(
³rûÁe
));

126 
	`expÜtStusCouÁs
(
expÜ‹r
);

129 ià(
v”bo£
) {

130 
Hi¡og¿mI‹¿tiÚV®ue
 
v
 : 
tÙ®Hi¡og¿m
.
	`»cÜdedV®ues
()) {

131 
v®ue
;

132 ià(
v
.
	`g‘V®ueI‹¿‹dTo
(è> ()
IÁeg”
.
MAX_VALUE
) {

133 
v®ue
 = 
IÁeg”
.
MAX_VALUE
;

135 
v®ue
 = ()
v
.
	`g‘V®ueI‹¿‹dTo
();

138 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
IÁeg”
.
	`toSŒšg
(
v®ue
), ()
v
.
	`g‘CouÁAtV®ueI‹¿‹dTo
());

141 
	}
}

150 @
Ov”ride


151 
public
 
SŒšg
 
	$g‘Summ¬y
() {

152 
Hi¡og¿m
 
š‹rv®Hi¡og¿m
 = 
	`g‘IÁ”v®Hi¡og¿mAndAccumuÏ‹
();

154 ià(
hi¡og¿mLogWr™”
 !ğ
nuÎ
) {

155 
hi¡og¿mLogWr™”
.
	`ouutIÁ”v®Hi¡og¿m
(
š‹rv®Hi¡og¿m
);

158 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

159  "[" + 
	`g‘Name
(è+ ": CouÁ=" + 
š‹rv®Hi¡og¿m
.
	`g‘TÙ®CouÁ
() + ", Max="

160 + 
š‹rv®Hi¡og¿m
.
	`g‘MaxV®ue
(è+ ", Mš=" + iÁ”v®Hi¡og¿m.
	`g‘MšV®ue
() + ", Avg="

161 + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘M—n
()è+ ", 90=" + d.fÜm©(š‹rv®Hi¡og¿m.
	`g‘V®ueAtP”ûÁe
(90))

162 + ", 99=" + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(99)) + ", 99.9="

163 + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(99.9)) + ", 99.99="

164 + 
d
.
	`fÜm©
(
š‹rv®Hi¡og¿m
.
	`g‘V®ueAtP”ûÁe
(99.99)) + "]";

165 
	}
}

167 
´iv©e
 
Hi¡og¿m
 
	$g‘IÁ”v®Hi¡og¿mAndAccumuÏ‹
() {

168 
Hi¡og¿m
 
š‹rv®Hi¡og¿m
 = 
hi¡og¿m
.
	`g‘IÁ”v®Hi¡og¿m
();

170 ià(
tÙ®Hi¡og¿m
 =ğ
nuÎ
) {

171 
tÙ®Hi¡og¿m
 = 
š‹rv®Hi¡og¿m
;

173 
tÙ®Hi¡og¿m
.
	`add
(
š‹rv®Hi¡og¿m
);

175  
š‹rv®Hi¡og¿m
;

176 
	}
}

184 
´iv©e
 
	gLi¡
<
	gDoubË
> 
	$g‘P”ûÁeV®ues
(
SŒšg
 
³rûÁeSŒšg
) {

185 
Li¡
<
DoubË
> 
³rûÁeV®ues
 = 
Ãw
 
A¼ayLi¡
<>();

187 
Œy
 {

188 
SŒšg
 
¿wP”ûÁe
 : 
³rûÁeSŒšg
.
	`¥l™
(",")) {

189 
³rûÁeV®ues
.
	`add
(
DoubË
.
	`·r£DoubË
(
¿wP”ûÁe
));

191 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

194 
Sy¡em
.
”r
.
	`´šn
("[WARN] Couldn'ˆ»ad " + 
PERCENTILES_PROPERTY
 + " v®ue: '" + 
³rûÁeSŒšg
 +

195 "',hdeçuÉ oà'" + 
PERCENTILES_PROPERTY_DEFAULT
 + "' will be used.");

196 
e
.
	`´štSckT¿û
();

197  
	`g‘P”ûÁeV®ues
(
PERCENTILES_PROPERTY_DEFAULT
);

200  
³rûÁeV®ues
;

201 
	}
}

208 
´iv©e
 
SŒšg
 
	$Üdš®
(
DoubË
 
i
) {

209 
SŒšg
[] 
suffixes
 = 
Ãw
 String[]{"th", "st", "nd", "rd", "th", "th", "th", "th", "th", "th"};

210 
IÁeg”
 
j
 = 
i
.
	`štV®ue
();

211 ià(
i
 % 1 == 0) {

212 
j
 % 100) {

216  
j
 + "th";

218  
j
 + 
suffixes
[j % 10];

221  
i
.
	`toSŒšg
();

223 
	}
}

	@measurements/OneMeasurementHistogram.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

30 
public
 cÏs 
	cOÃM—su»m’tHi¡og¿m
 
ex‹nds
 
	mOÃM—su»m’t
 {

31 
public
 
fš®
 
SŒšg
 
	mBUCKETS
 = "histogram.buckets";

32 
public
 
fš®
 
SŒšg
 
	mBUCKETS_DEFAULT
 = "1000";

33 
public
 
fš®
 
SŒšg
 
	mVERBOSE_PROPERTY
 = "measurement.histogram.verbose";

38 
´iv©e
 
fš®
 
	mbuck‘s
;

43 
´iv©e
 [] 
	mhi¡og¿m
;

48 
´iv©e
 
	mhi¡og¿mov”æow
;

53 
´iv©e
 
	mİ”©iÚs
;

59 
´iv©e
 
	mtÙ®Ï‹ncy
;

66 
´iv©e
 
	mtÙ®squ¬edÏ‹ncy
;

71 
´iv©e
 
fš®
 
boŞ—n
 
	mv”bo£
;

74 
´iv©e
 
	mwšdowİ”©iÚs
;

75 
´iv©e
 
	mwšdowtÙ®Ï‹ncy
;

77 
´iv©e
 
	mmš
;

78 
´iv©e
 
	mmax
;

80 
public
 
	$OÃM—su»m’tHi¡og¿m
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

81 
	`su³r
(
Çme
);

82 
buck‘s
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
BUCKETS
, 
BUCKETS_DEFAULT
));

83 
v”bo£
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
VERBOSE_PROPERTY
, 
SŒšg
.v®ueOf(
çl£
)));

84 
hi¡og¿m
 = 
Ãw
 [
buck‘s
];

85 
hi¡og¿mov”æow
 = 0;

86 
İ”©iÚs
 = 0;

87 
tÙ®Ï‹ncy
 = 0;

88 
tÙ®squ¬edÏ‹ncy
 = 0;

89 
wšdowİ”©iÚs
 = 0;

90 
wšdowtÙ®Ï‹ncy
 = 0;

91 
mš
 = -1;

92 
max
 = -1;

98 
public
 
synchrÚized
 
	$m—su»
(
Ï‹ncy
) {

100 ià(
Ï‹ncy
 / 1000 >ğ
buck‘s
) {

101 
hi¡og¿mov”æow
++;

103 
hi¡og¿m
[
Ï‹ncy
 / 1000]++;

105 
İ”©iÚs
++;

106 
tÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

107 
tÙ®squ¬edÏ‹ncy
 +ğ((è
Ï‹ncy
) * (()†atency);

108 
wšdowİ”©iÚs
++;

109 
wšdowtÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

111 ià((
mš
 < 0è|| (
Ï‹ncy
 < min)) {

112 
mš
 = 
Ï‹ncy
;

115 ià((
max
 < 0è|| (
Ï‹ncy
 > max)) {

116 
max
 = 
Ï‹ncy
;

118 
	}
}

120 @
Ov”ride


121 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

122 
m—n
 = 
tÙ®Ï‹ncy
 / ((è
İ”©iÚs
);

123 
v¬Ÿnû
 = 
tÙ®squ¬edÏ‹ncy
 / ((è
İ”©iÚs
è- (
m—n
 * mean);

124 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "O³¿tiÚs", 
İ”©iÚs
);

125 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Av”ageL©’cy(us)", 
m—n
);

126 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "L©’cyV¬Ÿnû(us)", 
v¬Ÿnû
);

127 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MšL©’cy(us)", 
mš
);

130 
İcouÁ”
=0;

131 
boŞ—n
 
dÚe95th
 = 
çl£
;

132 
boŞ—n
 
dÚe99th
 = 
çl£
;

133 
boŞ—n
 
dÚe99dÙ9th
 = 
çl£
;

134 
boŞ—n
 
dÚe99dÙ95th
 = 
çl£
;

135 
i
 = 0; i < 
buck‘s
; i++) {

136 
İcouÁ”
 +ğ
hi¡og¿m
[
i
];

153 ià((!
dÚe99dÙ9th
è&& (((è
İcouÁ”
è/ ((è
İ”©iÚs
) >= 0.999)) {

155 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MaxL©’cy(us)", 
i
 * 1000);

156 
dÚe99dÙ9th
 = 
Œue
;

158 ià((!
dÚe99dÙ95th
è&& (((è
İcouÁ”
è/ ((è
İ”©iÚs
) >= 0.9995)) {

159 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "95thP”ûÁeL©’cy(us)", 
i
 * 1000);

160 
dÚe99dÙ95th
 = 
Œue
;

162 ià(((è
İcouÁ”
è/ ((è
İ”©iÚs
) >= 0.9999) {

163 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "99thP”ûÁeL©’cy(us)", 
i
 * 1000);

168 
	`expÜtStusCouÁs
(
expÜ‹r
);

170 ià(
v”bo£
) {

171 
i
 = 0; i < 
buck‘s
; i++) {

172 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
IÁeg”
.
	`toSŒšg
(
i
), 
hi¡og¿m
[i]);

175 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), ">" + 
buck‘s
, 
hi¡og¿mov”æow
);

177 
	}
}

179 @
Ov”ride


180 
public
 
SŒšg
 
	$g‘Summ¬y
() {

181 ià(
wšdowİ”©iÚs
 == 0) {

184 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

185 
»pÜt
 = ((è
wšdowtÙ®Ï‹ncy
è/ ((è
wšdowİ”©iÚs
);

186 
wšdowtÙ®Ï‹ncy
 = 0;

187 
wšdowİ”©iÚs
 = 0;

188  "[" + 
	`g‘Name
(è+ " Av”ageL©’cy(us)=" + 
d
.
	`fÜm©
(
»pÜt
) + "]";

189 
	}
}

	@measurements/OneMeasurementHistogram.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

30 
public
 cÏs 
	cOÃM—su»m’tHi¡og¿m
 
ex‹nds
 
	mOÃM—su»m’t
 {

31 
public
 
fš®
 
SŒšg
 
	mBUCKETS
 = "histogram.buckets";

32 
public
 
fš®
 
SŒšg
 
	mBUCKETS_DEFAULT
 = "1000";

33 
public
 
fš®
 
SŒšg
 
	mVERBOSE_PROPERTY
 = "measurement.histogram.verbose";

38 
´iv©e
 
fš®
 
	mbuck‘s
;

43 
´iv©e
 [] 
	mhi¡og¿m
;

48 
´iv©e
 
	mhi¡og¿mov”æow
;

53 
´iv©e
 
	mİ”©iÚs
;

59 
´iv©e
 
	mtÙ®Ï‹ncy
;

66 
´iv©e
 
	mtÙ®squ¬edÏ‹ncy
;

71 
´iv©e
 
fš®
 
boŞ—n
 
	mv”bo£
;

74 
´iv©e
 
	mwšdowİ”©iÚs
;

75 
´iv©e
 
	mwšdowtÙ®Ï‹ncy
;

77 
´iv©e
 
	mmš
;

78 
´iv©e
 
	mmax
;

80 
public
 
	$OÃM—su»m’tHi¡og¿m
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

81 
	`su³r
(
Çme
);

82 
buck‘s
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
BUCKETS
, 
BUCKETS_DEFAULT
));

83 
v”bo£
 = 
BoŞ—n
.
	`v®ueOf
(
´İs
.
	`g‘Prİ”ty
(
VERBOSE_PROPERTY
, 
SŒšg
.v®ueOf(
çl£
)));

84 
hi¡og¿m
 = 
Ãw
 [
buck‘s
];

85 
hi¡og¿mov”æow
 = 0;

86 
İ”©iÚs
 = 0;

87 
tÙ®Ï‹ncy
 = 0;

88 
tÙ®squ¬edÏ‹ncy
 = 0;

89 
wšdowİ”©iÚs
 = 0;

90 
wšdowtÙ®Ï‹ncy
 = 0;

91 
mš
 = -1;

92 
max
 = -1;

98 
public
 
synchrÚized
 
	$m—su»
(
Ï‹ncy
) {

100 ià(
Ï‹ncy
 / 1000 >ğ
buck‘s
) {

101 
hi¡og¿mov”æow
++;

103 
hi¡og¿m
[
Ï‹ncy
 / 1000]++;

105 
İ”©iÚs
++;

106 
tÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

107 
tÙ®squ¬edÏ‹ncy
 +ğ((è
Ï‹ncy
) * (()†atency);

108 
wšdowİ”©iÚs
++;

109 
wšdowtÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

111 ià((
mš
 < 0è|| (
Ï‹ncy
 < min)) {

112 
mš
 = 
Ï‹ncy
;

115 ià((
max
 < 0è|| (
Ï‹ncy
 > max)) {

116 
max
 = 
Ï‹ncy
;

118 
	}
}

120 @
Ov”ride


121 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

122 
m—n
 = 
tÙ®Ï‹ncy
 / ((è
İ”©iÚs
);

123 
v¬Ÿnû
 = 
tÙ®squ¬edÏ‹ncy
 / ((è
İ”©iÚs
è- (
m—n
 * mean);

124 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "O³¿tiÚs", 
İ”©iÚs
);

125 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Av”ageL©’cy(us)", 
m—n
);

126 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "L©’cyV¬Ÿnû(us)", 
v¬Ÿnû
);

127 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MšL©’cy(us)", 
mš
);

130 
İcouÁ”
=0;

131 
boŞ—n
 
dÚe95th
 = 
çl£
;

132 
boŞ—n
 
dÚe99th
 = 
çl£
;

133 
boŞ—n
 
dÚe99dÙ9th
 = 
çl£
;

134 
boŞ—n
 
dÚe99dÙ95th
 = 
çl£
;

135 
i
 = 0; i < 
buck‘s
; i++) {

136 
İcouÁ”
 +ğ
hi¡og¿m
[
i
];

153 ià((!
dÚe99dÙ9th
è&& (((è
İcouÁ”
è/ ((è
İ”©iÚs
) >= 0.999)) {

155 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MaxL©’cy(us)", 
i
 * 1000);

156 
dÚe99dÙ9th
 = 
Œue
;

158 ià((!
dÚe99dÙ95th
è&& (((è
İcouÁ”
è/ ((è
İ”©iÚs
) >= 0.9995)) {

159 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "95thP”ûÁeL©’cy(us)", 
i
 * 1000);

160 
dÚe99dÙ95th
 = 
Œue
;

162 ià(((è
İcouÁ”
è/ ((è
İ”©iÚs
) >= 0.9999) {

163 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "99thP”ûÁeL©’cy(us)", 
i
 * 1000);

168 
	`expÜtStusCouÁs
(
expÜ‹r
);

170 ià(
v”bo£
) {

171 
i
 = 0; i < 
buck‘s
; i++) {

172 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
IÁeg”
.
	`toSŒšg
(
i
), 
hi¡og¿m
[i]);

175 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), ">" + 
buck‘s
, 
hi¡og¿mov”æow
);

177 
	}
}

179 @
Ov”ride


180 
public
 
SŒšg
 
	$g‘Summ¬y
() {

181 ià(
wšdowİ”©iÚs
 == 0) {

184 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

185 
»pÜt
 = ((è
wšdowtÙ®Ï‹ncy
è/ ((è
wšdowİ”©iÚs
);

186 
wšdowtÙ®Ï‹ncy
 = 0;

187 
wšdowİ”©iÚs
 = 0;

188  "[" + 
	`g‘Name
(è+ " Av”ageL©’cy(us)=" + 
d
.
	`fÜm©
(
»pÜt
) + "]";

189 
	}
}

	@measurements/OneMeasurementRaw.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gjava
.
	gio
.
	gFeNÙFoundExû±iÚ
;

23 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gPrštSŒ—m
;

26 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

27 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

28 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

29 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

36 
public
 cÏs 
	cOÃM—su»m’tRaw
 
ex‹nds
 
	mOÃM—su»m’t
 {

41 şas 
	cRawD©aPošt
 {

42 
´iv©e
 
fš®
 
	mtime¡amp
;

43 
´iv©e
 
fš®
 
	mv®ue
;

45 
public
 
RawD©aPošt
(
v®ue
) {

46 
	mthis
.
	mtime¡amp
 = 
Sy¡em
.
cu¼’tTimeMlis
();

47 
	mthis
.
	mv®ue
 = 
v®ue
;

50 
public
 
timeSmp
() {

51  
	mtime¡amp
;

54 
public
 
v®ue
() {

55  
	mv®ue
;

59 
şass
 
RawD©aPoštCom·¿tÜ
 
im¶em’ts
 
	gCom·¿tÜ
<
	gRawD©aPošt
> {

60 @
Ov”ride


61 
public
 
com·»
(
RawD©aPošt
 
p1
, RawD©aPošˆ
p2
) {

62 ià(
	gp1
.
v®ue
(è< 
	gp2
.value()) {

64 } ià(
	gp1
.
v®ue
(è=ğ
p2
.value()) {

77 
public
 
fš®
 
SŒšg
 
	gOUTPUT_FILE_PATH
 = "measurement.raw.output_file";

78 
public
 
fš®
 
SŒšg
 
	gOUTPUT_FILE_PATH_DEFAULT
 = "";

88 
public
 
fš®
 
SŒšg
 
	gNO_SUMMARY_STATS
 = "measurement.raw.no_summary";

89 
public
 
fš®
 
SŒšg
 
	gNO_SUMMARY_STATS_DEFAULT
 = "false";

91 
´iv©e
 
fš®
 
PrštSŒ—m
 
	gouutSŒ—m
;

93 
´iv©e
 
boŞ—n
 
	gnoSumm¬ySts
 = 
çl£
;

95 
´iv©e
 
	gLškedLi¡
<
	gRawD©aPošt
> 
	gm—su»m’ts
;

96 
´iv©e
 
	gtÙ®L©’cy
 = 0;

101 
´iv©e
 
	gwšdowO³¿tiÚs
 = 0;

102 
´iv©e
 
	gwšdowTÙ®L©’cy
 = 0;

104 
public
 
	$OÃM—su»m’tRaw
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

105 
	`su³r
(
Çme
);

107 
SŒšg
 
ouutFeP©h
 = 
´İs
.
	`g‘Prİ”ty
(
OUTPUT_FILE_PATH
, 
OUTPUT_FILE_PATH_DEFAULT
);

108 ià(!
ouutFeP©h
.
	`isEm±y
()) {

109 
Sy¡em
.
out
.
	`´šn
("Raw data measurement: will outputo„esult file: " +

110 
ouutFeP©h
);

112 
Œy
 {

113 
ouutSŒ—m
 = 
Ãw
 
	`PrštSŒ—m
(

114 
Ãw
 
	`FeOuutSŒ—m
(
ouutFeP©h
, 
Œue
),

115 
Œue
);

116 } 
	`ÿtch
 (
FeNÙFoundExû±iÚ
 
e
) {

117 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("FaedØİ’„aw d©¨ouuˆfe", 
e
);

121 
Sy¡em
.
out
.
	`´šn
("Raw data measurement: will outputo stdout.");

122 
ouutSŒ—m
 = 
Sy¡em
.
out
;

126 
noSumm¬ySts
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
(
NO_SUMMARY_STATS
,

127 
NO_SUMMARY_STATS_DEFAULT
));

129 
m—su»m’ts
 = 
Ãw
 
LškedLi¡
<>();

130 
	}
}

132 @
Ov”ride


133 
public
 
synchrÚized
 
	$m—su»
(
Ï‹ncy
) {

134 
tÙ®L©’cy
 +ğ
Ï‹ncy
;

135 
wšdowTÙ®L©’cy
 +ğ
Ï‹ncy
;

136 
wšdowO³¿tiÚs
++;

138 
m—su»m’ts
.
	`add
(
Ãw
 
	`RawD©aPošt
(
Ï‹ncy
));

139 
	}
}

141 @
Ov”ride


142 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
)

143 
throws
 
IOExû±iÚ
 {

147 
ouutSŒ—m
.
	`´šn
(
	`g‘Name
() +

149 
RawD©aPošt
 
pošt
 : 
m—su»m’ts
) {

150 
ouutSŒ—m
.
	`´šn
(

151 
SŒšg
.
	`fÜm©
("%s,%d,%d", 
	`g‘Name
(), 
pošt
.
	`timeSmp
(),

152 
pošt
.
	`v®ue
()));

154 ià(
ouutSŒ—m
 !ğ
Sy¡em
.
out
) {

155 
ouutSŒ—m
.
	`şo£
();

158 
tÙ®Ops
 = 
m—su»m’ts
.
	`size
();

159 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "TÙ® O³¿tiÚs", 
tÙ®Ops
);

160 ià(
tÙ®Ops
 > 0 && !
noSumm¬ySts
) {

161 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(),

163 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Average",

164 (è
tÙ®L©’cy
 / (è
tÙ®Ops
);

166 
CŞËùiÚs
.
	`sÜt
(
m—su»m’ts
, 
Ãw
 
	`RawD©aPoštCom·¿tÜ
());

168 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Mš", 
m—su»m’ts
.
	`g‘
(0).
	`v®ue
());

169 
expÜ‹r
.
	`wr™e
(

170 
	`g‘Name
(), "Max", 
m—su»m’ts
.
	`g‘
(
tÙ®Ops
 - 1).
	`v®ue
());

171 
expÜ‹r
.
	`wr™e
(

172 
	`g‘Name
(), "p1", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.01)).
	`v®ue
());

173 
expÜ‹r
.
	`wr™e
(

174 
	`g‘Name
(), "p5", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.05)).
	`v®ue
());

175 
expÜ‹r
.
	`wr™e
(

176 
	`g‘Name
(), "p50", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.5)).
	`v®ue
());

177 
expÜ‹r
.
	`wr™e
(

178 
	`g‘Name
(), "p90", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.9)).
	`v®ue
());

179 
expÜ‹r
.
	`wr™e
(

180 
	`g‘Name
(), "p95", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.95)).
	`v®ue
());

181 
expÜ‹r
.
	`wr™e
(

182 
	`g‘Name
(), "p99", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.99)).
	`v®ue
());

183 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "p99.9",

184 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.999)).
	`v®ue
());

185 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "p99.99",

186 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.9999)).
	`v®ue
());

189 
	`expÜtStusCouÁs
(
expÜ‹r
);

190 
	}
}

192 @
Ov”ride


193 
public
 
synchrÚized
 
SŒšg
 
	$g‘Summ¬y
() {

194 ià(
wšdowO³¿tiÚs
 == 0) {

198 
SŒšg
 
toR‘uº
 = SŒšg.
	`fÜm©
("%s count: %d,‡verage†atency(us): %.2f",

199 
	`g‘Name
(), 
wšdowO³¿tiÚs
,

200 (è
wšdowTÙ®L©’cy
 / (è
wšdowO³¿tiÚs
);

202 
wšdowTÙ®L©’cy
 = 0;

203 
wšdowO³¿tiÚs
 = 0;

205  
toR‘uº
;

206 
	}
}

	@measurements/OneMeasurementRaw.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gjava
.
	gio
.
	gFeNÙFoundExû±iÚ
;

23 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gPrštSŒ—m
;

26 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

27 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

28 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

29 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

36 
public
 cÏs 
	cOÃM—su»m’tRaw
 
ex‹nds
 
	mOÃM—su»m’t
 {

41 şas 
	cRawD©aPošt
 {

42 
´iv©e
 
fš®
 
	mtime¡amp
;

43 
´iv©e
 
fš®
 
	mv®ue
;

45 
public
 
RawD©aPošt
(
v®ue
) {

46 
	mthis
.
	mtime¡amp
 = 
Sy¡em
.
cu¼’tTimeMlis
();

47 
	mthis
.
	mv®ue
 = 
v®ue
;

50 
public
 
timeSmp
() {

51  
	mtime¡amp
;

54 
public
 
v®ue
() {

55  
	mv®ue
;

59 
şass
 
RawD©aPoštCom·¿tÜ
 
im¶em’ts
 
	gCom·¿tÜ
<
	gRawD©aPošt
> {

60 @
Ov”ride


61 
public
 
com·»
(
RawD©aPošt
 
p1
, RawD©aPošˆ
p2
) {

62 ià(
	gp1
.
v®ue
(è< 
	gp2
.value()) {

64 } ià(
	gp1
.
v®ue
(è=ğ
p2
.value()) {

77 
public
 
fš®
 
SŒšg
 
	gOUTPUT_FILE_PATH
 = "measurement.raw.output_file";

78 
public
 
fš®
 
SŒšg
 
	gOUTPUT_FILE_PATH_DEFAULT
 = "";

88 
public
 
fš®
 
SŒšg
 
	gNO_SUMMARY_STATS
 = "measurement.raw.no_summary";

89 
public
 
fš®
 
SŒšg
 
	gNO_SUMMARY_STATS_DEFAULT
 = "false";

91 
´iv©e
 
fš®
 
PrštSŒ—m
 
	gouutSŒ—m
;

93 
´iv©e
 
boŞ—n
 
	gnoSumm¬ySts
 = 
çl£
;

95 
´iv©e
 
	gLškedLi¡
<
	gRawD©aPošt
> 
	gm—su»m’ts
;

96 
´iv©e
 
	gtÙ®L©’cy
 = 0;

101 
´iv©e
 
	gwšdowO³¿tiÚs
 = 0;

102 
´iv©e
 
	gwšdowTÙ®L©’cy
 = 0;

104 
public
 
	$OÃM—su»m’tRaw
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

105 
	`su³r
(
Çme
);

107 
SŒšg
 
ouutFeP©h
 = 
´İs
.
	`g‘Prİ”ty
(
OUTPUT_FILE_PATH
, 
OUTPUT_FILE_PATH_DEFAULT
);

108 ià(!
ouutFeP©h
.
	`isEm±y
()) {

109 
Sy¡em
.
out
.
	`´šn
("Raw data measurement: will outputo„esult file: " +

110 
ouutFeP©h
);

112 
Œy
 {

113 
ouutSŒ—m
 = 
Ãw
 
	`PrštSŒ—m
(

114 
Ãw
 
	`FeOuutSŒ—m
(
ouutFeP©h
, 
Œue
),

115 
Œue
);

116 } 
	`ÿtch
 (
FeNÙFoundExû±iÚ
 
e
) {

117 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("FaedØİ’„aw d©¨ouuˆfe", 
e
);

121 
Sy¡em
.
out
.
	`´šn
("Raw data measurement: will outputo stdout.");

122 
ouutSŒ—m
 = 
Sy¡em
.
out
;

126 
noSumm¬ySts
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
(
NO_SUMMARY_STATS
,

127 
NO_SUMMARY_STATS_DEFAULT
));

129 
m—su»m’ts
 = 
Ãw
 
LškedLi¡
<>();

130 
	}
}

132 @
Ov”ride


133 
public
 
synchrÚized
 
	$m—su»
(
Ï‹ncy
) {

134 
tÙ®L©’cy
 +ğ
Ï‹ncy
;

135 
wšdowTÙ®L©’cy
 +ğ
Ï‹ncy
;

136 
wšdowO³¿tiÚs
++;

138 
m—su»m’ts
.
	`add
(
Ãw
 
	`RawD©aPošt
(
Ï‹ncy
));

139 
	}
}

141 @
Ov”ride


142 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
)

143 
throws
 
IOExû±iÚ
 {

147 
ouutSŒ—m
.
	`´šn
(
	`g‘Name
() +

149 
RawD©aPošt
 
pošt
 : 
m—su»m’ts
) {

150 
ouutSŒ—m
.
	`´šn
(

151 
SŒšg
.
	`fÜm©
("%s,%d,%d", 
	`g‘Name
(), 
pošt
.
	`timeSmp
(),

152 
pošt
.
	`v®ue
()));

154 ià(
ouutSŒ—m
 !ğ
Sy¡em
.
out
) {

155 
ouutSŒ—m
.
	`şo£
();

158 
tÙ®Ops
 = 
m—su»m’ts
.
	`size
();

159 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "TÙ® O³¿tiÚs", 
tÙ®Ops
);

160 ià(
tÙ®Ops
 > 0 && !
noSumm¬ySts
) {

161 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(),

163 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Average",

164 (è
tÙ®L©’cy
 / (è
tÙ®Ops
);

166 
CŞËùiÚs
.
	`sÜt
(
m—su»m’ts
, 
Ãw
 
	`RawD©aPoštCom·¿tÜ
());

168 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Mš", 
m—su»m’ts
.
	`g‘
(0).
	`v®ue
());

169 
expÜ‹r
.
	`wr™e
(

170 
	`g‘Name
(), "Max", 
m—su»m’ts
.
	`g‘
(
tÙ®Ops
 - 1).
	`v®ue
());

171 
expÜ‹r
.
	`wr™e
(

172 
	`g‘Name
(), "p1", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.01)).
	`v®ue
());

173 
expÜ‹r
.
	`wr™e
(

174 
	`g‘Name
(), "p5", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.05)).
	`v®ue
());

175 
expÜ‹r
.
	`wr™e
(

176 
	`g‘Name
(), "p50", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.5)).
	`v®ue
());

177 
expÜ‹r
.
	`wr™e
(

178 
	`g‘Name
(), "p90", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.9)).
	`v®ue
());

179 
expÜ‹r
.
	`wr™e
(

180 
	`g‘Name
(), "p95", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.95)).
	`v®ue
());

181 
expÜ‹r
.
	`wr™e
(

182 
	`g‘Name
(), "p99", 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.99)).
	`v®ue
());

183 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "p99.9",

184 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.999)).
	`v®ue
());

185 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "p99.99",

186 
m—su»m’ts
.
	`g‘
((è(
tÙ®Ops
 * 0.9999)).
	`v®ue
());

189 
	`expÜtStusCouÁs
(
expÜ‹r
);

190 
	}
}

192 @
Ov”ride


193 
public
 
synchrÚized
 
SŒšg
 
	$g‘Summ¬y
() {

194 ià(
wšdowO³¿tiÚs
 == 0) {

198 
SŒšg
 
toR‘uº
 = SŒšg.
	`fÜm©
("%s count: %d,‡verage†atency(us): %.2f",

199 
	`g‘Name
(), 
wšdowO³¿tiÚs
,

200 (è
wšdowTÙ®L©’cy
 / (è
wšdowO³¿tiÚs
);

202 
wšdowTÙ®L©’cy
 = 0;

203 
wšdowO³¿tiÚs
 = 0;

205  
toR‘uº
;

206 
	}
}

	@measurements/OneMeasurementTimeSeries.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

27 şas 
	cS”›sUn™
 {

32 
public
 
	$S”›sUn™
(
time
, 
av”age
) {

33 
this
.
time
 =ime;

34 
this
.
av”age
 =‡verage;

37 
´Ùeùed
 
fš®
 
time
;

38 
´Ùeùed
 
fš®
 
av”age
;

39 
	}
}

44 
public
 cÏs 
	cOÃM—su»m’tTimeS”›s
 
ex‹nds
 
	mOÃM—su»m’t
 {

49 
public
 
fš®
 
SŒšg
 
	mGRANULARITY
 = "timeseries.granularity";

50 
public
 
fš®
 
SŒšg
 
	mGRANULARITY_DEFAULT
 = "1000";

52 
´iv©e
 
fš®
 
	mg¿nuÏr™y
;

53 
´iv©e
 
fš®
 
	mVeùÜ
<
	mS”›sUn™
> 
	mm—su»m’ts
;

55 
´iv©e
 
	m¡¬t
 = -1;

56 
´iv©e
 
	mcu¼’tun™
 = -1;

57 
´iv©e
 
	mcouÁ
 = 0;

58 
´iv©e
 
	msum
 = 0;

59 
´iv©e
 
	mİ”©iÚs
 = 0;

60 
´iv©e
 
	mtÙ®Ï‹ncy
 = 0;

63 
´iv©e
 
	mwšdowİ”©iÚs
 = 0;

64 
´iv©e
 
	mwšdowtÙ®Ï‹ncy
 = 0;

66 
´iv©e
 
	mmš
 = -1;

67 
´iv©e
 
	mmax
 = -1;

69 
public
 
	$OÃM—su»m’tTimeS”›s
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

70 
	`su³r
(
Çme
);

71 
g¿nuÏr™y
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
GRANULARITY
, 
GRANULARITY_DEFAULT
));

72 
m—su»m’ts
 = 
Ãw
 
VeùÜ
<>();

75 
´iv©e
 
synchrÚized
 
	$checkEndOfUn™
(
boŞ—n
 
fÜû’d
) {

76 
now
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

78 ià(
¡¬t
 < 0) {

79 
cu¼’tun™
 = 0;

80 
¡¬t
 = 
now
;

83 
un™
 = ((
now
 - 
¡¬t
è/ 
g¿nuÏr™y
) * granularity;

85 ià((
un™
 > 
cu¼’tun™
è|| (
fÜû’d
)) {

86 
avg
 = ((è
sum
è/ ((è
couÁ
);

87 
m—su»m’ts
.
	`add
(
Ãw
 
	`S”›sUn™
(
cu¼’tun™
, 
avg
));

89 
cu¼’tun™
 = 
un™
;

91 
couÁ
 = 0;

92 
sum
 = 0;

94 
	}
}

96 @
Ov”ride


97 
public
 
	$m—su»
(
Ï‹ncy
) {

98 
	`checkEndOfUn™
(
çl£
);

100 
couÁ
++;

101 
sum
 +ğ
Ï‹ncy
;

102 
tÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

103 
İ”©iÚs
++;

104 
wšdowİ”©iÚs
++;

105 
wšdowtÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

107 ià(
Ï‹ncy
 > 
max
) {

108 
max
 = 
Ï‹ncy
;

111 ià((
Ï‹ncy
 < 
mš
) || (min < 0)) {

112 
mš
 = 
Ï‹ncy
;

114 
	}
}

117 @
Ov”ride


118 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

119 
	`checkEndOfUn™
(
Œue
);

121 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "O³¿tiÚs", 
İ”©iÚs
);

122 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Av”ageL©’cy(us)", (((è
tÙ®Ï‹ncy
è/ ((è
İ”©iÚs
)));

123 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MšL©’cy(us)", 
mš
);

124 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MaxL©’cy(us)", 
max
);

128 
	`expÜtStusCouÁs
(
expÜ‹r
);

129 
S”›sUn™
 
un™
 : 
m—su»m’ts
) {

130 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
LÚg
.
	`toSŒšg
(
un™
.
time
), un™.
av”age
);

132 
	}
}

134 @
Ov”ride


135 
public
 
SŒšg
 
	$g‘Summ¬y
() {

136 ià(
wšdowİ”©iÚs
 == 0) {

139 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

140 
»pÜt
 = ((è
wšdowtÙ®Ï‹ncy
è/ ((è
wšdowİ”©iÚs
);

141 
wšdowtÙ®Ï‹ncy
 = 0;

142 
wšdowİ”©iÚs
 = 0;

143  "[" + 
	`g‘Name
(è+ " Av”ageL©’cy(us)=" + 
d
.
	`fÜm©
(
»pÜt
) + "]";

144 
	}
}

	@measurements/OneMeasurementTimeSeries.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

24 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

27 şas 
	cS”›sUn™
 {

32 
public
 
	$S”›sUn™
(
time
, 
av”age
) {

33 
this
.
time
 =ime;

34 
this
.
av”age
 =‡verage;

37 
´Ùeùed
 
fš®
 
time
;

38 
´Ùeùed
 
fš®
 
av”age
;

39 
	}
}

44 
public
 cÏs 
	cOÃM—su»m’tTimeS”›s
 
ex‹nds
 
	mOÃM—su»m’t
 {

49 
public
 
fš®
 
SŒšg
 
	mGRANULARITY
 = "timeseries.granularity";

50 
public
 
fš®
 
SŒšg
 
	mGRANULARITY_DEFAULT
 = "1000";

52 
´iv©e
 
fš®
 
	mg¿nuÏr™y
;

53 
´iv©e
 
fš®
 
	mVeùÜ
<
	mS”›sUn™
> 
	mm—su»m’ts
;

55 
´iv©e
 
	m¡¬t
 = -1;

56 
´iv©e
 
	mcu¼’tun™
 = -1;

57 
´iv©e
 
	mcouÁ
 = 0;

58 
´iv©e
 
	msum
 = 0;

59 
´iv©e
 
	mİ”©iÚs
 = 0;

60 
´iv©e
 
	mtÙ®Ï‹ncy
 = 0;

63 
´iv©e
 
	mwšdowİ”©iÚs
 = 0;

64 
´iv©e
 
	mwšdowtÙ®Ï‹ncy
 = 0;

66 
´iv©e
 
	mmš
 = -1;

67 
´iv©e
 
	mmax
 = -1;

69 
public
 
	$OÃM—su»m’tTimeS”›s
(
SŒšg
 
Çme
, 
Prİ”t›s
 
´İs
) {

70 
	`su³r
(
Çme
);

71 
g¿nuÏr™y
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
(
GRANULARITY
, 
GRANULARITY_DEFAULT
));

72 
m—su»m’ts
 = 
Ãw
 
VeùÜ
<>();

75 
´iv©e
 
synchrÚized
 
	$checkEndOfUn™
(
boŞ—n
 
fÜû’d
) {

76 
now
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

78 ià(
¡¬t
 < 0) {

79 
cu¼’tun™
 = 0;

80 
¡¬t
 = 
now
;

83 
un™
 = ((
now
 - 
¡¬t
è/ 
g¿nuÏr™y
) * granularity;

85 ià((
un™
 > 
cu¼’tun™
è|| (
fÜû’d
)) {

86 
avg
 = ((è
sum
è/ ((è
couÁ
);

87 
m—su»m’ts
.
	`add
(
Ãw
 
	`S”›sUn™
(
cu¼’tun™
, 
avg
));

89 
cu¼’tun™
 = 
un™
;

91 
couÁ
 = 0;

92 
sum
 = 0;

94 
	}
}

96 @
Ov”ride


97 
public
 
	$m—su»
(
Ï‹ncy
) {

98 
	`checkEndOfUn™
(
çl£
);

100 
couÁ
++;

101 
sum
 +ğ
Ï‹ncy
;

102 
tÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

103 
İ”©iÚs
++;

104 
wšdowİ”©iÚs
++;

105 
wšdowtÙ®Ï‹ncy
 +ğ
Ï‹ncy
;

107 ià(
Ï‹ncy
 > 
max
) {

108 
max
 = 
Ï‹ncy
;

111 ià((
Ï‹ncy
 < 
mš
) || (min < 0)) {

112 
mš
 = 
Ï‹ncy
;

114 
	}
}

117 @
Ov”ride


118 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

119 
	`checkEndOfUn™
(
Œue
);

121 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "O³¿tiÚs", 
İ”©iÚs
);

122 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "Av”ageL©’cy(us)", (((è
tÙ®Ï‹ncy
è/ ((è
İ”©iÚs
)));

123 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MšL©’cy(us)", 
mš
);

124 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), "MaxL©’cy(us)", 
max
);

128 
	`expÜtStusCouÁs
(
expÜ‹r
);

129 
S”›sUn™
 
un™
 : 
m—su»m’ts
) {

130 
expÜ‹r
.
	`wr™e
(
	`g‘Name
(), 
LÚg
.
	`toSŒšg
(
un™
.
time
), un™.
av”age
);

132 
	}
}

134 @
Ov”ride


135 
public
 
SŒšg
 
	$g‘Summ¬y
() {

136 ià(
wšdowİ”©iÚs
 == 0) {

139 
Decim®FÜm©
 
d
 = 
Ãw
 
	`Decim®FÜm©
("#.##");

140 
»pÜt
 = ((è
wšdowtÙ®Ï‹ncy
è/ ((è
wšdowİ”©iÚs
);

141 
wšdowtÙ®Ï‹ncy
 = 0;

142 
wšdowİ”©iÚs
 = 0;

143  "[" + 
	`g‘Name
(è+ " Av”ageL©’cy(us)=" + 
d
.
	`fÜm©
(
»pÜt
) + "]";

144 
	}
}

	@measurements/TwoInOneMeasurement.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

28 
public
 cÏs 
	cTwoInOÃM—su»m’t
 
ex‹nds
 
	mOÃM—su»m’t
 {

30 
´iv©e
 
fš®
 
OÃM—su»m’t
 
	mthšg1
, 
	mthšg2
;

32 
public
 
	$TwoInOÃM—su»m’t
(
SŒšg
 
Çme
, 
OÃM—su»m’t
 
thšg1
, OÃM—su»m’ˆ
thšg2
) {

33 
	`su³r
(
Çme
);

34 
this
.
thšg1
 =hing1;

35 
this
.
thšg2
 =hing2;

41 @
Ov”ride


42 
public
 
	$»pÜtStus
(
fš®
 
Stus
 
¡©us
) {

43 
thšg1
.
	`»pÜtStus
(
¡©us
);

44 
	}
}

50 @
Ov”ride


51 
public
 
	$m—su»
(
Ï‹ncyInMiüos
) {

52 
thšg1
.
	`m—su»
(
Ï‹ncyInMiüos
);

53 
thšg2
.
	`m—su»
(
Ï‹ncyInMiüos
);

54 
	}
}

59 @
Ov”ride


60 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

61 
thšg1
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

62 
thšg2
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

63 
	}
}

71 @
Ov”ride


72 
public
 
SŒšg
 
	$g‘Summ¬y
() {

73  
thšg1
.
	`g‘Summ¬y
(è+ "\n" + 
thšg2
.getSummary();

74 
	}
}

	@measurements/TwoInOneMeasurement.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
.
	gM—su»m’tsExpÜ‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

28 
public
 cÏs 
	cTwoInOÃM—su»m’t
 
ex‹nds
 
	mOÃM—su»m’t
 {

30 
´iv©e
 
fš®
 
OÃM—su»m’t
 
	mthšg1
, 
	mthšg2
;

32 
public
 
	$TwoInOÃM—su»m’t
(
SŒšg
 
Çme
, 
OÃM—su»m’t
 
thšg1
, OÃM—su»m’ˆ
thšg2
) {

33 
	`su³r
(
Çme
);

34 
this
.
thšg1
 =hing1;

35 
this
.
thšg2
 =hing2;

41 @
Ov”ride


42 
public
 
	$»pÜtStus
(
fš®
 
Stus
 
¡©us
) {

43 
thšg1
.
	`»pÜtStus
(
¡©us
);

44 
	}
}

50 @
Ov”ride


51 
public
 
	$m—su»
(
Ï‹ncyInMiüos
) {

52 
thšg1
.
	`m—su»
(
Ï‹ncyInMiüos
);

53 
thšg2
.
	`m—su»
(
Ï‹ncyInMiüos
);

54 
	}
}

59 @
Ov”ride


60 
public
 
	$expÜtM—su»m’ts
(
M—su»m’tsExpÜ‹r
 
expÜ‹r
è
throws
 
IOExû±iÚ
 {

61 
thšg1
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

62 
thšg2
.
	`expÜtM—su»m’ts
(
expÜ‹r
);

63 
	}
}

71 @
Ov”ride


72 
public
 
SŒšg
 
	$g‘Summ¬y
() {

73  
thšg1
.
	`g‘Summ¬y
(è+ "\n" + 
thšg2
.getSummary();

74 
	}
}

	@measurements/exporter/JSONArrayMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚFaùÜy
;

20 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚG’”©Ü
;

21 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gut
.
	gDeçuÉP»‰yPrš‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

26 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

31 
public
 cÏs 
	cJSONA¼ayM—su»m’tsExpÜ‹r
 
im¶em’ts
 
	mM—su»m’tsExpÜ‹r
 {

32 
´iv©e
 
fš®
 
JsÚFaùÜy
 
	mçùÜy
 = 
Ãw
 JsonFactory();

33 
´iv©e
 
JsÚG’”©Ü
 
	mg
;

35 
public
 
	$JSONA¼ayM—su»m’tsExpÜ‹r
(
OuutSŒ—m
 
os
è
throws
 
IOExû±iÚ
 {

36 
Bufã»dWr™”
 
bw
 = 
Ãw
 
	`Bufã»dWr™”
Òew 
	`OuutSŒ—mWr™”
(
os
));

37 
g
 = 
çùÜy
.
	`ü—‹JsÚG’”©Ü
(
bw
);

38 
g
.
	`£tP»‰yPrš‹r
(
Ãw
 
	`DeçuÉP»‰yPrš‹r
());

39 
g
.
	`wr™eS¹A¼ay
();

42 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

43 
g
.
	`wr™eS¹Objeù
();

44 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

45 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

46 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

47 
g
.
	`wr™eEndObjeù
();

48 
	}
}

50 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

51 
g
.
	`wr™eS¹Objeù
();

52 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

53 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

54 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

55 
g
.
	`wr™eEndObjeù
();

56 
	}
}

58 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
IOExû±iÚ
 {

59 
g
.
	`wr™eS¹Objeù
();

60 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

61 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

62 
g
.
	`wr™eNumb”F›ld
("v®ue", 
d
);

63 
g
.
	`wr™eEndObjeù
();

64 
	}
}

66 
public
 
	$şo£
(è
throws
 
IOExû±iÚ
 {

67 ià(
g
 !ğ
nuÎ
) {

68 
g
.
	`wr™eEndA¼ay
();

69 
g
.
	`şo£
();

71 
	}
}

	@measurements/exporter/JSONArrayMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚFaùÜy
;

20 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚG’”©Ü
;

21 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gut
.
	gDeçuÉP»‰yPrš‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

26 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

31 
public
 cÏs 
	cJSONA¼ayM—su»m’tsExpÜ‹r
 
im¶em’ts
 
	mM—su»m’tsExpÜ‹r
 {

32 
´iv©e
 
fš®
 
JsÚFaùÜy
 
	mçùÜy
 = 
Ãw
 JsonFactory();

33 
´iv©e
 
JsÚG’”©Ü
 
	mg
;

35 
public
 
	$JSONA¼ayM—su»m’tsExpÜ‹r
(
OuutSŒ—m
 
os
è
throws
 
IOExû±iÚ
 {

36 
Bufã»dWr™”
 
bw
 = 
Ãw
 
	`Bufã»dWr™”
Òew 
	`OuutSŒ—mWr™”
(
os
));

37 
g
 = 
çùÜy
.
	`ü—‹JsÚG’”©Ü
(
bw
);

38 
g
.
	`£tP»‰yPrš‹r
(
Ãw
 
	`DeçuÉP»‰yPrš‹r
());

39 
g
.
	`wr™eS¹A¼ay
();

42 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

43 
g
.
	`wr™eS¹Objeù
();

44 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

45 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

46 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

47 
g
.
	`wr™eEndObjeù
();

48 
	}
}

50 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

51 
g
.
	`wr™eS¹Objeù
();

52 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

53 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

54 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

55 
g
.
	`wr™eEndObjeù
();

56 
	}
}

58 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
IOExû±iÚ
 {

59 
g
.
	`wr™eS¹Objeù
();

60 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

61 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

62 
g
.
	`wr™eNumb”F›ld
("v®ue", 
d
);

63 
g
.
	`wr™eEndObjeù
();

64 
	}
}

66 
public
 
	$şo£
(è
throws
 
IOExû±iÚ
 {

67 ià(
g
 !ğ
nuÎ
) {

68 
g
.
	`wr™eEndA¼ay
();

69 
g
.
	`şo£
();

71 
	}
}

	@measurements/exporter/JSONMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚFaùÜy
;

20 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚG’”©Ü
;

21 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gut
.
	gDeçuÉP»‰yPrš‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

26 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

31 
public
 cÏs 
	cJSONM—su»m’tsExpÜ‹r
 
im¶em’ts
 
	mM—su»m’tsExpÜ‹r
 {

33 
´iv©e
 
fš®
 
JsÚFaùÜy
 
	mçùÜy
 = 
Ãw
 JsonFactory();

34 
´iv©e
 
JsÚG’”©Ü
 
	mg
;

36 
public
 
	$JSONM—su»m’tsExpÜ‹r
(
OuutSŒ—m
 
os
è
throws
 
IOExû±iÚ
 {

38 
Bufã»dWr™”
 
bw
 = 
Ãw
 
	`Bufã»dWr™”
Òew 
	`OuutSŒ—mWr™”
(
os
));

39 
g
 = 
çùÜy
.
	`ü—‹JsÚG’”©Ü
(
bw
);

40 
g
.
	`£tP»‰yPrš‹r
(
Ãw
 
	`DeçuÉP»‰yPrš‹r
());

43 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

44 
g
.
	`wr™eS¹Objeù
();

45 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

46 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

47 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

48 
g
.
	`wr™eEndObjeù
();

49 
	}
}

51 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

52 
g
.
	`wr™eS¹Objeù
();

53 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

54 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

55 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

56 
g
.
	`wr™eEndObjeù
();

57 
	}
}

59 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
IOExû±iÚ
 {

60 
g
.
	`wr™eS¹Objeù
();

61 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

62 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

63 
g
.
	`wr™eNumb”F›ld
("v®ue", 
d
);

64 
g
.
	`wr™eEndObjeù
();

65 
	}
}

67 
public
 
	$şo£
(è
throws
 
IOExû±iÚ
 {

68 ià(
g
 !ğ
nuÎ
) {

69 
g
.
	`şo£
();

71 
	}
}

	@measurements/exporter/JSONMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚFaùÜy
;

20 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gJsÚG’”©Ü
;

21 
impÜt
 
	gÜg
.
	gcodehaus
.
	gjacksÚ
.
	gut
.
	gDeçuÉP»‰yPrš‹r
;

23 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

25 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

26 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

31 
public
 cÏs 
	cJSONM—su»m’tsExpÜ‹r
 
im¶em’ts
 
	mM—su»m’tsExpÜ‹r
 {

33 
´iv©e
 
fš®
 
JsÚFaùÜy
 
	mçùÜy
 = 
Ãw
 JsonFactory();

34 
´iv©e
 
JsÚG’”©Ü
 
	mg
;

36 
public
 
	$JSONM—su»m’tsExpÜ‹r
(
OuutSŒ—m
 
os
è
throws
 
IOExû±iÚ
 {

38 
Bufã»dWr™”
 
bw
 = 
Ãw
 
	`Bufã»dWr™”
Òew 
	`OuutSŒ—mWr™”
(
os
));

39 
g
 = 
çùÜy
.
	`ü—‹JsÚG’”©Ü
(
bw
);

40 
g
.
	`£tP»‰yPrš‹r
(
Ãw
 
	`DeçuÉP»‰yPrš‹r
());

43 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

44 
g
.
	`wr™eS¹Objeù
();

45 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

46 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

47 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

48 
g
.
	`wr™eEndObjeù
();

49 
	}
}

51 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

52 
g
.
	`wr™eS¹Objeù
();

53 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

54 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

55 
g
.
	`wr™eNumb”F›ld
("v®ue", 
i
);

56 
g
.
	`wr™eEndObjeù
();

57 
	}
}

59 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
IOExû±iÚ
 {

60 
g
.
	`wr™eS¹Objeù
();

61 
g
.
	`wr™eSŒšgF›ld
("m‘ric", 
m‘ric
);

62 
g
.
	`wr™eSŒšgF›ld
("m—su»m’t", 
m—su»m’t
);

63 
g
.
	`wr™eNumb”F›ld
("v®ue", 
d
);

64 
g
.
	`wr™eEndObjeù
();

65 
	}
}

67 
public
 
	$şo£
(è
throws
 
IOExû±iÚ
 {

68 ià(
g
 !ğ
nuÎ
) {

69 
g
.
	`şo£
();

71 
	}
}

	@measurements/exporter/MeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gjava
.
	gio
.
	gClo£abË
;

20 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
public
 
š‹rçû
 
M—su»m’tsExpÜ‹r
 
ex‹nds
 
	gClo£abË
 {

35 
wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
	gIOExû±iÚ
;

45 
wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
	gIOExû±iÚ
;

55 
wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
	gIOExû±iÚ
;

	@measurements/exporter/MeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gjava
.
	gio
.
	gClo£abË
;

20 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
public
 
š‹rçû
 
M—su»m’tsExpÜ‹r
 
ex‹nds
 
	gClo£abË
 {

35 
wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
	gIOExû±iÚ
;

45 
wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
	gIOExû±iÚ
;

55 
wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
	gIOExû±iÚ
;

	@measurements/exporter/TextMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

20 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

21 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

22 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

27 
public
 cÏs 
	cTextM—su»m’tsExpÜ‹r
 
im¶em’ts
 
	mM—su»m’tsExpÜ‹r
 {

28 
´iv©e
 
fš®
 
Bufã»dWr™”
 
	mbw
;

30 
public
 
	$TextM—su»m’tsExpÜ‹r
(
OuutSŒ—m
 
os
) {

31 
this
.
bw
 = 
Ãw
 
	`Bufã»dWr™”
Òew 
	`OuutSŒ—mWr™”
(
os
));

34 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

35 
bw
.
	`wr™e
("[" + 
m‘ric
 + "], " + 
m—su»m’t
 + ", " + 
i
);

36 
bw
.
	`ÃwLše
();

37 
	}
}

39 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

40 
bw
.
	`wr™e
("[" + 
m‘ric
 + "], " + 
m—su»m’t
 + ", " + 
i
);

41 
bw
.
	`ÃwLše
();

42 
	}
}

44 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
IOExû±iÚ
 {

45 
bw
.
	`wr™e
("[" + 
m‘ric
 + "], " + 
m—su»m’t
 + ", " + 
d
);

46 
bw
.
	`ÃwLše
();

47 
	}
}

49 
public
 
	$şo£
(è
throws
 
IOExû±iÚ
 {

50 
this
.
bw
.
	`şo£
();

51 
	}
}

	@measurements/exporter/TextMeasurementsExporter.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

19 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

20 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

21 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

22 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

27 
public
 cÏs 
	cTextM—su»m’tsExpÜ‹r
 
im¶em’ts
 
	mM—su»m’tsExpÜ‹r
 {

28 
´iv©e
 
fš®
 
Bufã»dWr™”
 
	mbw
;

30 
public
 
	$TextM—su»m’tsExpÜ‹r
(
OuutSŒ—m
 
os
) {

31 
this
.
bw
 = 
Ãw
 
	`Bufã»dWr™”
Òew 
	`OuutSŒ—mWr™”
(
os
));

34 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

35 
bw
.
	`wr™e
("[" + 
m‘ric
 + "], " + 
m—su»m’t
 + ", " + 
i
);

36 
bw
.
	`ÃwLše
();

37 
	}
}

39 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
i
è
throws
 
IOExû±iÚ
 {

40 
bw
.
	`wr™e
("[" + 
m‘ric
 + "], " + 
m—su»m’t
 + ", " + 
i
);

41 
bw
.
	`ÃwLše
();

42 
	}
}

44 
public
 
	$wr™e
(
SŒšg
 
m‘ric
, SŒšg 
m—su»m’t
, 
d
è
throws
 
IOExû±iÚ
 {

45 
bw
.
	`wr™e
("[" + 
m‘ric
 + "], " + 
m—su»m’t
 + ", " + 
d
);

46 
bw
.
	`ÃwLše
();

47 
	}
}

49 
public
 
	$şo£
(è
throws
 
IOExû±iÚ
 {

50 
this
.
bw
.
	`şo£
();

51 
	}
}

	@measurements/exporter/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

	@measurements/exporter/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gexpÜ‹r
;

	@measurements/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

	@measurements/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
;

	@package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
;

	@package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
;

	@workloads/ConstantOccupancyWorkload.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gNumb”G’”©Ü
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

45 
public
 cÏs 
	cCÚ¡ªtOccu·ncyWÜklßd
 
ex‹nds
 
	mCÜeWÜklßd
 {

46 
´iv©e
 
	mdisksize
;

47 
´iv©e
 
	m¡Üag—ges
;

48 
´iv©e
 
	moccu·ncy
;

50 
´iv©e
 
	mobjeùCouÁ
;

52 
public
 
fš®
 
SŒšg
 
	mSTORAGE_AGE_PROPERTY
 = "storageages";

53 
public
 
fš®
 
	mSTORAGE_AGE_PROPERTY_DEFAULT
 = 10;

55 
public
 
fš®
 
SŒšg
 
	mDISK_SIZE_PROPERTY
 = "disksize";

56 
public
 
fš®
 
	mDISK_SIZE_PROPERTY_DEFAULT
 = 100 * 1000 * 1000;

58 
public
 
fš®
 
SŒšg
 
	mOCCUPANCY_PROPERTY
 = "occupancy";

59 
public
 
fš®
 
	mOCCUPANCY_PROPERTY_DEFAULT
 = 0.9;

61 @
Ov”ride


62 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

63 
disksize
 = 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
DISK_SIZE_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
DISK_SIZE_PROPERTY_DEFAULT
)));

64 
¡Üag—ges
 = 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
STORAGE_AGE_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
STORAGE_AGE_PROPERTY_DEFAULT
)));

65 
occu·ncy
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
OCCUPANCY_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
OCCUPANCY_PROPERTY_DEFAULT
)));

67 ià(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
è!ğ
nuÎ
 ||

68 
p
.
	`g‘Prİ”ty
(
Cl›Á
.
INSERT_COUNT_PROPERTY
è!ğ
nuÎ
 ||

69 
p
.
	`g‘Prİ”ty
(
Cl›Á
.
OPERATION_COUNT_PROPERTY
è!ğ
nuÎ
) {

70 
Sy¡em
.
”r
.
	`´šn
("Warning:„ecord, insert or operation count was set…rioro initting " +

73 
Numb”G’”©Ü
 
g
 = 
CÜeWÜklßd
.
	`g‘F›ldL’gthG’”©Ü
(
p
);

74 
f›ldsize
 = 
g
.
	`m—n
();

75 
f›ldcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
FIELD_COUNT_PROPERTY
, 
FIELD_COUNT_PROPERTY_DEFAULT
));

77 
objeùCouÁ
 = (è(
occu·ncy
 * (
disksize
 / (
f›ldsize
 * 
f›ldcouÁ
)));

78 ià(
objeùCouÁ
 == 0) {

79 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Object count was zero. Perhaps disksize isoo†ow?");

81 
p
.
	`£tPrİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
objeùCouÁ
));

82 
p
.
	`£tPrİ”ty
(
Cl›Á
.
OPERATION_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
¡Üag—ges
 * 
objeùCouÁ
));

83 
p
.
	`£tPrİ”ty
(
Cl›Á
.
INSERT_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
objeùCouÁ
));

85 
su³r
.
	`š™
(
p
);

88 
	}
}

	@workloads/ConstantOccupancyWorkload.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

19 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gNumb”G’”©Ü
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

45 
public
 cÏs 
	cCÚ¡ªtOccu·ncyWÜklßd
 
ex‹nds
 
	mCÜeWÜklßd
 {

46 
´iv©e
 
	mdisksize
;

47 
´iv©e
 
	m¡Üag—ges
;

48 
´iv©e
 
	moccu·ncy
;

50 
´iv©e
 
	mobjeùCouÁ
;

52 
public
 
fš®
 
SŒšg
 
	mSTORAGE_AGE_PROPERTY
 = "storageages";

53 
public
 
fš®
 
	mSTORAGE_AGE_PROPERTY_DEFAULT
 = 10;

55 
public
 
fš®
 
SŒšg
 
	mDISK_SIZE_PROPERTY
 = "disksize";

56 
public
 
fš®
 
	mDISK_SIZE_PROPERTY_DEFAULT
 = 100 * 1000 * 1000;

58 
public
 
fš®
 
SŒšg
 
	mOCCUPANCY_PROPERTY
 = "occupancy";

59 
public
 
fš®
 
	mOCCUPANCY_PROPERTY_DEFAULT
 = 0.9;

61 @
Ov”ride


62 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

63 
disksize
 = 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
DISK_SIZE_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
DISK_SIZE_PROPERTY_DEFAULT
)));

64 
¡Üag—ges
 = 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
STORAGE_AGE_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
STORAGE_AGE_PROPERTY_DEFAULT
)));

65 
occu·ncy
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
OCCUPANCY_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
OCCUPANCY_PROPERTY_DEFAULT
)));

67 ià(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
è!ğ
nuÎ
 ||

68 
p
.
	`g‘Prİ”ty
(
Cl›Á
.
INSERT_COUNT_PROPERTY
è!ğ
nuÎ
 ||

69 
p
.
	`g‘Prİ”ty
(
Cl›Á
.
OPERATION_COUNT_PROPERTY
è!ğ
nuÎ
) {

70 
Sy¡em
.
”r
.
	`´šn
("Warning:„ecord, insert or operation count was set…rioro initting " +

73 
Numb”G’”©Ü
 
g
 = 
CÜeWÜklßd
.
	`g‘F›ldL’gthG’”©Ü
(
p
);

74 
f›ldsize
 = 
g
.
	`m—n
();

75 
f›ldcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
FIELD_COUNT_PROPERTY
, 
FIELD_COUNT_PROPERTY_DEFAULT
));

77 
objeùCouÁ
 = (è(
occu·ncy
 * (
disksize
 / (
f›ldsize
 * 
f›ldcouÁ
)));

78 ià(
objeùCouÁ
 == 0) {

79 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Object count was zero. Perhaps disksize isoo†ow?");

81 
p
.
	`£tPrİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
objeùCouÁ
));

82 
p
.
	`£tPrİ”ty
(
Cl›Á
.
OPERATION_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
¡Üag—ges
 * 
objeùCouÁ
));

83 
p
.
	`£tPrİ”ty
(
Cl›Á
.
INSERT_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
objeùCouÁ
));

85 
su³r
.
	`š™
(
p
);

88 
	}
}

	@workloads/CoreWorkload.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

20 
impÜt
 
	gs™e
.
	gycsb
.*;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.*;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnifÜmLÚgG’”©Ü
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

25 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gjava
.
	gut
.*;

68 
public
 cÏs 
	cCÜeWÜklßd
 
ex‹nds
 
	mWÜklßd
 {

72 
public
 
fš®
 
SŒšg
 
	mTABLENAME_PROPERTY
 = "table";

77 
public
 
fš®
 
SŒšg
 
	mTABLENAME_PROPERTY_DEFAULT
 = "usertable";

79 
´Ùeùed
 
SŒšg
 
	mbË
;

84 
public
 
fš®
 
SŒšg
 
	mFIELD_COUNT_PROPERTY
 = "fieldcount";

89 
public
 
fš®
 
SŒšg
 
	mFIELD_COUNT_PROPERTY_DEFAULT
 = "10";

91 
´iv©e
 
	mLi¡
<
	mSŒšg
> 
	mf›ldÇmes
;

101 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_PROPERTY
 = "fieldlengthdistribution";

106 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
 = "constant";

111 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_PROPERTY
 = "fieldlength";

116 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_PROPERTY_DEFAULT
 = "100";

121 
public
 
fš®
 
SŒšg
 
	mMIN_FIELD_LENGTH_PROPERTY
 = "minfieldlength";

126 
public
 
fš®
 
SŒšg
 
	mMIN_FIELD_LENGTH_PROPERTY_DEFAULT
 = "1";

132 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_HISTOGRAM_FILE_PROPERTY
 = "fieldlengthhistogram";

137 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_HISTOGRAM_FILE_PROPERTY_DEFAULT
 = "hist.txt";

143 
´Ùeùed
 
Numb”G’”©Ü
 
	mf›ldËngthg’”©Ü
;

149 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_PROPERTY
 = "readallfields";

154 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_PROPERTY_DEFAULT
 = "true";

156 
´Ùeùed
 
boŞ—n
 
	m»ad®lf›lds
;

164 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_BY_NAME_PROPERTY
 = "readallfieldsbyname";

169 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_BY_NAME_PROPERTY_DEFAULT
 = "false";

171 
´Ùeùed
 
boŞ—n
 
	m»ad®lf›ldsbyÇme
;

177 
public
 
fš®
 
SŒšg
 
	mWRITE_ALL_FIELDS_PROPERTY
 = "writeallfields";

182 
public
 
fš®
 
SŒšg
 
	mWRITE_ALL_FIELDS_PROPERTY_DEFAULT
 = "false";

184 
´Ùeùed
 
boŞ—n
 
	mwr™—Îf›lds
;

190 
public
 
fš®
 
SŒšg
 
	mDATA_INTEGRITY_PROPERTY
 = "dataintegrity";

195 
public
 
fš®
 
SŒšg
 
	mDATA_INTEGRITY_PROPERTY_DEFAULT
 = "false";

201 
´iv©e
 
boŞ—n
 
	md©aš‹gr™y
;

206 
public
 
fš®
 
SŒšg
 
	mREAD_PROPORTION_PROPERTY
 = "readproportion";

211 
public
 
fš®
 
SŒšg
 
	mREAD_PROPORTION_PROPERTY_DEFAULT
 = "0.95";

216 
public
 
fš®
 
SŒšg
 
	mUPDATE_PROPORTION_PROPERTY
 = "updateproportion";

221 
public
 
fš®
 
SŒšg
 
	mUPDATE_PROPORTION_PROPERTY_DEFAULT
 = "0.05";

226 
public
 
fš®
 
SŒšg
 
	mINSERT_PROPORTION_PROPERTY
 = "insertproportion";

231 
public
 
fš®
 
SŒšg
 
	mINSERT_PROPORTION_PROPERTY_DEFAULT
 = "0.0";

236 
public
 
fš®
 
SŒšg
 
	mSCAN_PROPORTION_PROPERTY
 = "scanproportion";

241 
public
 
fš®
 
SŒšg
 
	mSCAN_PROPORTION_PROPERTY_DEFAULT
 = "0.0";

246 
public
 
fš®
 
SŒšg
 
	mREADMODIFYWRITE_PROPORTION_PROPERTY
 = "readmodifywriteproportion";

251 
public
 
fš®
 
SŒšg
 
	mREADMODIFYWRITE_PROPORTION_PROPERTY_DEFAULT
 = "0.0";

257 
public
 
fš®
 
SŒšg
 
	mREQUEST_DISTRIBUTION_PROPERTY
 = "requestdistribution";

262 
public
 
fš®
 
SŒšg
 
	mREQUEST_DISTRIBUTION_PROPERTY_DEFAULT
 = "uniform";

268 
public
 
fš®
 
SŒšg
 
	mZERO_PADDING_PROPERTY
 = "zeropadding";

273 
public
 
fš®
 
SŒšg
 
	mZERO_PADDING_PROPERTY_DEFAULT
 = "1";

279 
public
 
fš®
 
SŒšg
 
	mMIN_SCAN_LENGTH_PROPERTY
 = "minscanlength";

284 
public
 
fš®
 
SŒšg
 
	mMIN_SCAN_LENGTH_PROPERTY_DEFAULT
 = "1";

289 
public
 
fš®
 
SŒšg
 
	mMAX_SCAN_LENGTH_PROPERTY
 = "maxscanlength";

294 
public
 
fš®
 
SŒšg
 
	mMAX_SCAN_LENGTH_PROPERTY_DEFAULT
 = "1000";

300 
public
 
fš®
 
SŒšg
 
	mSCAN_LENGTH_DISTRIBUTION_PROPERTY
 = "scanlengthdistribution";

305 
public
 
fš®
 
SŒšg
 
	mSCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
 = "uniform";

310 
public
 
fš®
 
SŒšg
 
	mINSERT_ORDER_PROPERTY
 = "insertorder";

315 
public
 
fš®
 
SŒšg
 
	mINSERT_ORDER_PROPERTY_DEFAULT
 = "hashed";

320 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_DATA_FRACTION
 = "hotspotdatafraction";

325 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_DATA_FRACTION_DEFAULT
 = "0.2";

330 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_OPN_FRACTION
 = "hotspotopnfraction";

335 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_OPN_FRACTION_DEFAULT
 = "0.8";

340 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_LIMIT
 = "core_workload_insertion_retry_limit";

341 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_LIMIT_DEFAULT
 = "0";

346 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_INTERVAL
 = "core_workload_insertion_retry_interval";

347 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_INTERVAL_DEFAULT
 = "3";

352 
public
 
fš®
 
SŒšg
 
	mFIELD_NAME_PREFIX
 = "fieldnameprefix";

357 
public
 
fš®
 
SŒšg
 
	mFIELD_NAME_PREFIX_DEFAULT
 = "field";

359 
´Ùeùed
 
Numb”G’”©Ü
 
	mkey£qu’û
;

360 
´Ùeùed
 
Disü‘eG’”©Ü
 
	mİ”©iÚchoo£r
;

361 
´Ùeùed
 
Numb”G’”©Ü
 
	mkeychoo£r
;

362 
´Ùeùed
 
Numb”G’”©Ü
 
	mf›ldchoo£r
;

363 
´Ùeùed
 
AcknowËdgedCouÁ”G’”©Ü
 
	mŒª§ùiÚš£¹key£qu’û
;

364 
´Ùeùed
 
Numb”G’”©Ü
 
	msÿÆ’gth
;

365 
´Ùeùed
 
boŞ—n
 
	mÜd”edš£¹s
;

366 
´Ùeùed
 
	mf›ldcouÁ
;

367 
´Ùeùed
 
	m»cÜdcouÁ
;

368 
´Ùeùed
 
	mz”İaddšg
;

369 
´Ùeùed
 
	mš£¹iÚR‘ryLim™
;

370 
´Ùeùed
 
	mš£¹iÚR‘ryIÁ”v®
;

372 
´iv©e
 
M—su»m’ts
 
	mm—su»m’ts
 = M—su»m’ts.
g‘M—su»m’ts
();

374 
public
 
SŒšg
 
	$budKeyName
(
keynum
, 
z”İaddšg
, 
boŞ—n
 
Üd”edš£¹s
) {

375 ià(!
Üd”edš£¹s
) {

376 
keynum
 = 
Uts
.
	`hash
(keynum);

378 
SŒšg
 
v®ue
 = 
LÚg
.
	`toSŒšg
(
keynum
);

379 
fl
 = 
z”İaddšg
 - 
v®ue
.
	`Ëngth
();

380 
SŒšg
 
´ekey
 = "user";

381 
i
 = 0; i < 
fl
; i++) {

382 
´ekey
 += '0';

384  
´ekey
 + 
v®ue
;

387 
´Ùeùed
 
Numb”G’”©Ü
 
	$g‘F›ldL’gthG’”©Ü
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

388 
Numb”G’”©Ü
 
f›ldËngthg’”©Ü
;

389 
SŒšg
 
f›ldËngthdi¡ributiÚ
 = 
p
.
	`g‘Prİ”ty
(

390 
FIELD_LENGTH_DISTRIBUTION_PROPERTY
, 
FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

391 
f›ldËngth
 =

392 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
FIELD_LENGTH_PROPERTY
, 
FIELD_LENGTH_PROPERTY_DEFAULT
));

393 
mšf›ldËngth
 =

394 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
MIN_FIELD_LENGTH_PROPERTY
, 
MIN_FIELD_LENGTH_PROPERTY_DEFAULT
));

395 
SŒšg
 
f›ldËngthhi¡og¿m
 = 
p
.
	`g‘Prİ”ty
(

396 
FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY
, 
FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY_DEFAULT
);

397 ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("constant") == 0) {

398 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`CÚ¡ªtIÁeg”G’”©Ü
(
f›ldËngth
);

399 } ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("uniform") == 0) {

400 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(
mšf›ldËngth
, 
f›ldËngth
);

401 } ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("zipfian") == 0) {

402 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
mšf›ldËngth
, 
f›ldËngth
);

403 } ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("histogram") == 0) {

404 
Œy
 {

405 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`Hi¡og¿mG’”©Ü
(
f›ldËngthhi¡og¿m
);

406 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

407 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

408 "Couldn'ˆ»ad f›ld†’gth hi¡og¿m fe: " + 
f›ldËngthhi¡og¿m
, 
e
);

411 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

412 "UnknowÀf›ld†’gth di¡ributiÚ \"" + 
f›ldËngthdi¡ributiÚ
 + "\"");

414  
f›ldËngthg’”©Ü
;

415 
	}
}

421 @
Ov”ride


422 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

423 
bË
 = 
p
.
	`g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

425 
f›ldcouÁ
 =

426 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
FIELD_COUNT_PROPERTY
, 
FIELD_COUNT_PROPERTY_DEFAULT
));

427 
fš®
 
SŒšg
 
f›ldÇm•»fix
 = 
p
.
	`g‘Prİ”ty
(
FIELD_NAME_PREFIX
, 
FIELD_NAME_PREFIX_DEFAULT
);

428 
f›ldÇmes
 = 
Ãw
 
A¼ayLi¡
<>();

429 
i
 = 0; i < 
f›ldcouÁ
; i++) {

430 
f›ldÇmes
.
	`add
(
f›ldÇm•»fix
 + 
i
);

432 
f›ldËngthg’”©Ü
 = 
CÜeWÜklßd
.
	`g‘F›ldL’gthG’”©Ü
(
p
);

434 
»cÜdcouÁ
 =

435 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
, Cl›Á.
DEFAULT_RECORD_COUNT
));

436 ià(
»cÜdcouÁ
 == 0) {

437 
»cÜdcouÁ
 = 
IÁeg”
.
MAX_VALUE
;

439 
SŒšg
 
»que¡di¡rib
 =

440 
p
.
	`g‘Prİ”ty
(
REQUEST_DISTRIBUTION_PROPERTY
, 
REQUEST_DISTRIBUTION_PROPERTY_DEFAULT
);

441 
mšsÿÆ’gth
 =

442 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
MIN_SCAN_LENGTH_PROPERTY
, 
MIN_SCAN_LENGTH_PROPERTY_DEFAULT
));

443 
maxsÿÆ’gth
 =

444 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
MAX_SCAN_LENGTH_PROPERTY
, 
MAX_SCAN_LENGTH_PROPERTY_DEFAULT
));

445 
SŒšg
 
sÿÆ’gthdi¡rib
 =

446 
p
.
	`g‘Prİ”ty
(
SCAN_LENGTH_DISTRIBUTION_PROPERTY
, 
SCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

448 
š£¹¡¬t
 =

449 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
INSERT_START_PROPERTY
, 
INSERT_START_PROPERTY_DEFAULT
));

450 
š£¹couÁ
=

451 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
INSERT_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
»cÜdcouÁ
 - 
š£¹¡¬t
)));

453 ià(
»cÜdcouÁ
 < (
š£¹¡¬t
 + 
š£¹couÁ
)) {

454 
Sy¡em
.
”r
.
	`´šn
("Invalid combination of insertstart, insertcount‡nd„ecordcount.");

455 
Sy¡em
.
”r
.
	`´šn
("recordcount must be biggerhan insertstart + insertcount.");

456 
Sy¡em
.
	`ex™
(-1);

458 
z”İaddšg
 =

459 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
ZERO_PADDING_PROPERTY
, 
ZERO_PADDING_PROPERTY_DEFAULT
));

461 
»ad®lf›lds
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

462 
p
.
	`g‘Prİ”ty
(
READ_ALL_FIELDS_PROPERTY
, 
READ_ALL_FIELDS_PROPERTY_DEFAULT
));

463 
»ad®lf›ldsbyÇme
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

464 
p
.
	`g‘Prİ”ty
(
READ_ALL_FIELDS_BY_NAME_PROPERTY
, 
READ_ALL_FIELDS_BY_NAME_PROPERTY_DEFAULT
));

465 
wr™—Îf›lds
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

466 
p
.
	`g‘Prİ”ty
(
WRITE_ALL_FIELDS_PROPERTY
, 
WRITE_ALL_FIELDS_PROPERTY_DEFAULT
));

468 
d©aš‹gr™y
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

469 
p
.
	`g‘Prİ”ty
(
DATA_INTEGRITY_PROPERTY
, 
DATA_INTEGRITY_PROPERTY_DEFAULT
));

472 ià(
d©aš‹gr™y
 && !(
p
.
	`g‘Prİ”ty
(

473 
FIELD_LENGTH_DISTRIBUTION_PROPERTY
,

474 
FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
)).
	`equ®s
("constant")) {

475 
Sy¡em
.
”r
.
	`´šn
("Must have constant field sizeo check data integrity.");

476 
Sy¡em
.
	`ex™
(-1);

478 ià(
d©aš‹gr™y
) {

479 
Sy¡em
.
out
.
	`´šn
("Data integrity isƒnabled.");

482 ià(
p
.
	`g‘Prİ”ty
(
INSERT_ORDER_PROPERTY
, 
INSERT_ORDER_PROPERTY_DEFAULT
).
	`com·»To
("hashed") == 0) {

483 
Üd”edš£¹s
 = 
çl£
;

485 
Üd”edš£¹s
 = 
Œue
;

488 
key£qu’û
 = 
Ãw
 
	`CouÁ”G’”©Ü
(
š£¹¡¬t
);

489 
İ”©iÚchoo£r
 = 
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

491 
Œª§ùiÚš£¹key£qu’û
 = 
Ãw
 
	`AcknowËdgedCouÁ”G’”©Ü
(
»cÜdcouÁ
);

492 ià(
»que¡di¡rib
.
	`com·»To
("uniform") == 0) {

493 
keychoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 - 1);

494 } ià(
»que¡di¡rib
.
	`com·»To
("exponential") == 0) {

495 
³rûÁe
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(

496 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_PROPERTY
,

497 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_DEFAULT
));

498 
äac
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(

499 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_PROPERTY
,

500 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_DEFAULT
));

501 
keychoo£r
 = 
Ãw
 
	`ExpÚ’tŸlG’”©Ü
(
³rûÁe
, 
»cÜdcouÁ
 * 
äac
);

502 } ià(
»que¡di¡rib
.
	`com·»To
("sequential") == 0) {

503 
keychoo£r
 = 
Ãw
 
	`Sequ’tŸlG’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 - 1);

504 } ià(
»que¡di¡rib
.
	`com·»To
("zipfian") == 0) {

514 
fš®
 
š£¹´İÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

515 
p
.
	`g‘Prİ”ty
(
INSERT_PROPORTION_PROPERTY
, 
INSERT_PROPORTION_PROPERTY_DEFAULT
));

516 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
OPERATION_COUNT_PROPERTY
));

517 
ex³ùedÃwkeys
 = (è((
İcouÁ
è* 
š£¹´İÜtiÚ
 * 2.0);

519 
keychoo£r
 = 
Ãw
 
	`SüambËdZfŸnG’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 + 
ex³ùedÃwkeys
);

520 } ià(
»que¡di¡rib
.
	`com·»To
("latest") == 0) {

521 
keychoo£r
 = 
Ãw
 
	`SkewedL©e¡G’”©Ü
(
Œª§ùiÚš£¹key£qu’û
);

522 } ià(
»que¡di¡rib
.
	`equ®s
("hotspot")) {

523 
hÙ£täaùiÚ
 =

524 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_DATA_FRACTION
, 
HOTSPOT_DATA_FRACTION_DEFAULT
));

525 
hÙİnäaùiÚ
 =

526 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_OPN_FRACTION
, 
HOTSPOT_OPN_FRACTION_DEFAULT
));

527 
keychoo£r
 = 
Ãw
 
	`HÙ¥ÙIÁeg”G’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 - 1,

528 
hÙ£täaùiÚ
, 
hÙİnäaùiÚ
);

530 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀ»que¡ di¡ributiÚ \"" + 
»que¡di¡rib
 + "\"");

533 
f›ldchoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(0, 
f›ldcouÁ
 - 1);

535 ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("uniform") == 0) {

536 
sÿÆ’gth
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(
mšsÿÆ’gth
, 
maxsÿÆ’gth
);

537 } ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("zipfian") == 0) {

538 
sÿÆ’gth
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
mšsÿÆ’gth
, 
maxsÿÆ’gth
);

540 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

541 "Di¡ributiÚ \"" + 
sÿÆ’gthdi¡rib
 + "\"‚ot‡llowed for scan†ength");

544 
š£¹iÚR‘ryLim™
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(

545 
INSERTION_RETRY_LIMIT
, 
INSERTION_RETRY_LIMIT_DEFAULT
));

546 
š£¹iÚR‘ryIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(

547 
INSERTION_RETRY_INTERVAL
, 
INSERTION_RETRY_INTERVAL_DEFAULT
));

548 
	}
}

553 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	$budSšgËV®ue
(
SŒšg
 
key
) {

554 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ue
 = 
Ãw
 HashMap<>();

556 
SŒšg
 
f›ldkey
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

557 
By‹I‹¿tÜ
 
d©a
;

558 ià(
d©aš‹gr™y
) {

559 
d©a
 = 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
key
, 
f›ldkey
));

562 
d©a
 = 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
());

564 
v®ue
.
	`put
(
f›ldkey
, 
d©a
);

566  
v®ue
;

567 
	}
}

572 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	$budV®ues
(
SŒšg
 
key
) {

573 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<>();

575 
SŒšg
 
f›ldkey
 : 
f›ldÇmes
) {

576 
By‹I‹¿tÜ
 
d©a
;

577 ià(
d©aš‹gr™y
) {

578 
d©a
 = 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
key
, 
f›ldkey
));

581 
d©a
 = 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
());

583 
v®ues
.
	`put
(
f›ldkey
, 
d©a
);

585  
v®ues
;

586 
	}
}

591 
´iv©e
 
SŒšg
 
	$budD‘”mši¡icV®ue
(
SŒšg
 
key
, SŒšg 
f›ldkey
) {

592 
size
 = 
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`štV®ue
();

593 
SŒšgBud”
 
sb
 = 
Ãw
 
	`SŒšgBud”
(
size
);

594 
sb
.
	`­³nd
(
key
);

595 
sb
.
	`­³nd
(':');

596 
sb
.
	`­³nd
(
f›ldkey
);

597 
sb
.
	`Ëngth
(è< 
size
) {

598 
sb
.
	`­³nd
(':');

599 
sb
.
	`­³nd
(sb.
	`toSŒšg
().
	`hashCode
());

601 
sb
.
	`£tL’gth
(
size
);

603  
sb
.
	`toSŒšg
();

604 
	}
}

612 @
Ov”ride


613 
public
 
boŞ—n
 
	$doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

614 
keynum
 = 
key£qu’û
.
	`ÃxtV®ue
().
	`štV®ue
();

615 
SŒšg
 
dbkey
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

616 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
	`budV®ues
(
dbkey
);

618 
Stus
 
¡©us
;

619 
numOfR‘r›s
 = 0;

621 
¡©us
 = 
db
.
	`š£¹
(
bË
, 
dbkey
, 
v®ues
);

622 ià(
nuÎ
 !ğ
¡©us
 && stus.
	`isOk
()) {

628 ià(++
numOfR‘r›s
 <ğ
š£¹iÚR‘ryLim™
) {

629 
Sy¡em
.
”r
.
	`´šn
("R‘ryšg in£¹iÚ,„‘ry couÁ: " + 
numOfR‘r›s
);

630 
Œy
 {

632 
¦“pTime
 = (è(1000 * 
š£¹iÚR‘ryIÁ”v®
 * (0.8 + 0.4 * 
M©h
.
	`¿ndom
()));

633 
Th»ad
.
	`¦“p
(
¦“pTime
);

634 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

639 
Sy¡em
.
”r
.
	`´šn
("E¼Ü in£¹šg,‚Ù„‘ryšg‡ny mÜe.‚umb” oà©‹m±s: " + 
numOfR‘r›s
 +

640 "In£¹iÚ R‘ry Lim™: " + 
š£¹iÚR‘ryLim™
);

644 } 
Œue
);

646  
nuÎ
 !ğ
¡©us
 && stus.
	`isOk
();

647 
	}
}

655 @
Ov”ride


656 
public
 
boŞ—n
 
	$doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

657 
SŒšg
 
İ”©iÚ
 = 
İ”©iÚchoo£r
.
	`ÃxtSŒšg
();

658 if(
İ”©iÚ
 =ğ
nuÎ
) {

659  
çl£
;

662 
İ”©iÚ
) {

664 
	`doT¿n§ùiÚR—d
(
db
);

667 
	`doT¿n§ùiÚUpd©e
(
db
);

670 
	`doT¿n§ùiÚIn£¹
(
db
);

673 
	`doT¿n§ùiÚSÿn
(
db
);

676 
	`doT¿n§ùiÚR—dModifyWr™e
(
db
);

679  
Œue
;

680 
	}
}

689 
´Ùeùed
 
v”ifyRow
(
SŒšg
 
key
, 
HashM­
<SŒšg, 
By‹I‹¿tÜ
> 
ûÎs
) {

690 
Stus
 
	gv”ifyStus
 = Stus.
OK
;

691 
	g¡¬tTime
 = 
Sy¡em
.
ÇnoTime
();

692 ià(!
	gûÎs
.
isEm±y
()) {

693 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
ûÎs
.
’ŒyS‘
()) {

694 ià(!
’Œy
.
g‘V®ue
().
toSŒšg
().
equ®s
(
budD‘”mši¡icV®ue
(
key
,ƒÁry.
g‘Key
()))) {

695 
	gv”ifyStus
 = 
Stus
.
UNEXPECTED_STATE
;

701 
	gv”ifyStus
 = 
Stus
.
ERROR
;

703 
	g’dTime
 = 
Sy¡em
.
ÇnoTime
();

704 
	gm—su»m’ts
.
m—su»
("VERIFY", (è(
’dTime
 - 
¡¬tTime
) / 1000);

705 
	gm—su»m’ts
.
»pÜtStus
("VERIFY", 
v”ifyStus
);

708 
	$ÃxtKeynum
() {

709 
keynum
;

710 ià(
keychoo£r
 
š¡ªûof
 
ExpÚ’tŸlG’”©Ü
) {

712 
keynum
 = 
Œª§ùiÚš£¹key£qu’û
.
	`Ï¡V®ue
(è- 
keychoo£r
.
	`ÃxtV®ue
().
	`štV®ue
();

713 } 
keynum
 < 0);

716 
keynum
 = 
keychoo£r
.
	`ÃxtV®ue
().
	`štV®ue
();

717 } 
keynum
 > 
Œª§ùiÚš£¹key£qu’û
.
	`Ï¡V®ue
());

719  
keynum
;

720 
	}
}

722 
public
 
	$doT¿n§ùiÚR—d
(
DB
 
db
) {

724 
keynum
 = 
	`ÃxtKeynum
();

726 
SŒšg
 
keyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

728 
HashS‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

730 ià(!
»ad®lf›lds
) {

732 
SŒšg
 
f›ldÇme
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

734 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>();

735 
f›lds
.
	`add
(
f›ldÇme
);

736 } ià(
d©aš‹gr™y
 || 
»ad®lf›ldsbyÇme
) {

738 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>(
f›ldÇmes
);

741 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 HashMap<String, ByteIterator>();

742 
db
.
	`»ad
(
bË
, 
keyÇme
, 
f›lds
, 
ûÎs
);

744 ià(
d©aš‹gr™y
) {

745 
	`v”ifyRow
(
keyÇme
, 
ûÎs
);

747 
	}
}

749 
public
 
	$doT¿n§ùiÚR—dModifyWr™e
(
DB
 
db
) {

751 
keynum
 = 
	`ÃxtKeynum
();

753 
SŒšg
 
keyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

755 
HashS‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

757 ià(!
»ad®lf›lds
) {

759 
SŒšg
 
f›ldÇme
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

761 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>();

762 
f›lds
.
	`add
(
f›ldÇme
);

765 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
;

767 ià(
wr™—Îf›lds
) {

769 
v®ues
 = 
	`budV®ues
(
keyÇme
);

772 
v®ues
 = 
	`budSšgËV®ue
(
keyÇme
);

777 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 HashMap<String, ByteIterator>();

780 
i¡
 = 
m—su»m’ts
.
	`g‘IÁ’dedS¹TimeNs
();

781 
¡
 = 
Sy¡em
.
	`ÇnoTime
();

782 
db
.
	`»ad
(
bË
, 
keyÇme
, 
f›lds
, 
ûÎs
);

784 
db
.
	`upd©e
(
bË
, 
keyÇme
, 
v®ues
);

786 
’
 = 
Sy¡em
.
	`ÇnoTime
();

788 ià(
d©aš‹gr™y
) {

789 
	`v”ifyRow
(
keyÇme
, 
ûÎs
);

792 
m—su»m’ts
.
	`m—su»
("READ-MODIFY-WRITE", (è((
’
 - 
¡
) / 1000));

793 
m—su»m’ts
.
	`m—su»IÁ’ded
("READ-MODIFY-WRITE", (è((
’
 - 
i¡
) / 1000));

794 
	}
}

796 
public
 
	$doT¿n§ùiÚSÿn
(
DB
 
db
) {

798 
keynum
 = 
	`ÃxtKeynum
();

800 
SŒšg
 
¡¬tkeyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

803 
Ën
 = 
sÿÆ’gth
.
	`ÃxtV®ue
().
	`štV®ue
();

805 
HashS‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

807 ià(!
»ad®lf›lds
) {

809 
SŒšg
 
f›ldÇme
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

811 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>();

812 
f›lds
.
	`add
(
f›ldÇme
);

815 
db
.
	`sÿn
(
bË
, 
¡¬tkeyÇme
, 
Ën
, 
f›lds
, 
Ãw
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>>());

816 
	}
}

818 
public
 
	$doT¿n§ùiÚUpd©e
(
DB
 
db
) {

820 
keynum
 = 
	`ÃxtKeynum
();

822 
SŒšg
 
keyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

824 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
;

826 ià(
wr™—Îf›lds
) {

828 
v®ues
 = 
	`budV®ues
(
keyÇme
);

831 
v®ues
 = 
	`budSšgËV®ue
(
keyÇme
);

834 
db
.
	`upd©e
(
bË
, 
keyÇme
, 
v®ues
);

835 
	}
}

837 
public
 
	$doT¿n§ùiÚIn£¹
(
DB
 
db
) {

839 
keynum
 = 
Œª§ùiÚš£¹key£qu’û
.
	`ÃxtV®ue
();

841 
Œy
 {

842 
SŒšg
 
dbkey
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

844 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
	`budV®ues
(
dbkey
);

845 
db
.
	`š£¹
(
bË
, 
dbkey
, 
v®ues
);

846 } 
fš®ly
 {

847 
Œª§ùiÚš£¹key£qu’û
.
	`acknowËdge
(
keynum
);

849 
	}
}

861 
´Ùeùed
 
Disü‘eG’”©Ü
 
	$ü—‹O³¿tiÚG’”©Ü
(
fš®
 
Prİ”t›s
 
p
) {

862 ià(
p
 =ğ
nuÎ
) {

863 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Properties object cannot be‚ull");

865 
fš®
 
»ad´İÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

866 
p
.
	`g‘Prİ”ty
(
READ_PROPORTION_PROPERTY
, 
READ_PROPORTION_PROPERTY_DEFAULT
));

867 
fš®
 
upd©•rİÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

868 
p
.
	`g‘Prİ”ty
(
UPDATE_PROPORTION_PROPERTY
, 
UPDATE_PROPORTION_PROPERTY_DEFAULT
));

869 
fš®
 
š£¹´İÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

870 
p
.
	`g‘Prİ”ty
(
INSERT_PROPORTION_PROPERTY
, 
INSERT_PROPORTION_PROPERTY_DEFAULT
));

871 
fš®
 
sÿÅrİÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

872 
p
.
	`g‘Prİ”ty
(
SCAN_PROPORTION_PROPERTY
, 
SCAN_PROPORTION_PROPERTY_DEFAULT
));

873 
fš®
 
»admodifywr™•rİÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(

874 
READMODIFYWRITE_PROPORTION_PROPERTY
, 
READMODIFYWRITE_PROPORTION_PROPERTY_DEFAULT
));

876 
fš®
 
Disü‘eG’”©Ü
 
İ”©iÚchoo£r
 = 
Ãw
 
	`Disü‘eG’”©Ü
();

877 ià(
»ad´İÜtiÚ
 > 0) {

878 
İ”©iÚchoo£r
.
	`addV®ue
(
»ad´İÜtiÚ
, "READ");

881 ià(
upd©•rİÜtiÚ
 > 0) {

882 
İ”©iÚchoo£r
.
	`addV®ue
(
upd©•rİÜtiÚ
, "UPDATE");

885 ià(
š£¹´İÜtiÚ
 > 0) {

886 
İ”©iÚchoo£r
.
	`addV®ue
(
š£¹´İÜtiÚ
, "INSERT");

889 ià(
sÿÅrİÜtiÚ
 > 0) {

890 
İ”©iÚchoo£r
.
	`addV®ue
(
sÿÅrİÜtiÚ
, "SCAN");

893 ià(
»admodifywr™•rİÜtiÚ
 > 0) {

894 
İ”©iÚchoo£r
.
	`addV®ue
(
»admodifywr™•rİÜtiÚ
, "READMODIFYWRITE");

896  
İ”©iÚchoo£r
;

897 
	}
}

	@workloads/CoreWorkload.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

20 
impÜt
 
	gs™e
.
	gycsb
.*;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.*;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnifÜmLÚgG’”©Ü
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

25 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gjava
.
	gut
.*;

68 
public
 cÏs 
	cCÜeWÜklßd
 
ex‹nds
 
	mWÜklßd
 {

72 
public
 
fš®
 
SŒšg
 
	mTABLENAME_PROPERTY
 = "table";

77 
public
 
fš®
 
SŒšg
 
	mTABLENAME_PROPERTY_DEFAULT
 = "usertable";

79 
´Ùeùed
 
SŒšg
 
	mbË
;

84 
public
 
fš®
 
SŒšg
 
	mFIELD_COUNT_PROPERTY
 = "fieldcount";

89 
public
 
fš®
 
SŒšg
 
	mFIELD_COUNT_PROPERTY_DEFAULT
 = "10";

91 
´iv©e
 
	mLi¡
<
	mSŒšg
> 
	mf›ldÇmes
;

101 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_PROPERTY
 = "fieldlengthdistribution";

106 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
 = "constant";

111 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_PROPERTY
 = "fieldlength";

116 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_PROPERTY_DEFAULT
 = "100";

121 
public
 
fš®
 
SŒšg
 
	mMIN_FIELD_LENGTH_PROPERTY
 = "minfieldlength";

126 
public
 
fš®
 
SŒšg
 
	mMIN_FIELD_LENGTH_PROPERTY_DEFAULT
 = "1";

132 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_HISTOGRAM_FILE_PROPERTY
 = "fieldlengthhistogram";

137 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_HISTOGRAM_FILE_PROPERTY_DEFAULT
 = "hist.txt";

143 
´Ùeùed
 
Numb”G’”©Ü
 
	mf›ldËngthg’”©Ü
;

149 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_PROPERTY
 = "readallfields";

154 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_PROPERTY_DEFAULT
 = "true";

156 
´Ùeùed
 
boŞ—n
 
	m»ad®lf›lds
;

164 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_BY_NAME_PROPERTY
 = "readallfieldsbyname";

169 
public
 
fš®
 
SŒšg
 
	mREAD_ALL_FIELDS_BY_NAME_PROPERTY_DEFAULT
 = "false";

171 
´Ùeùed
 
boŞ—n
 
	m»ad®lf›ldsbyÇme
;

177 
public
 
fš®
 
SŒšg
 
	mWRITE_ALL_FIELDS_PROPERTY
 = "writeallfields";

182 
public
 
fš®
 
SŒšg
 
	mWRITE_ALL_FIELDS_PROPERTY_DEFAULT
 = "false";

184 
´Ùeùed
 
boŞ—n
 
	mwr™—Îf›lds
;

190 
public
 
fš®
 
SŒšg
 
	mDATA_INTEGRITY_PROPERTY
 = "dataintegrity";

195 
public
 
fš®
 
SŒšg
 
	mDATA_INTEGRITY_PROPERTY_DEFAULT
 = "false";

201 
´iv©e
 
boŞ—n
 
	md©aš‹gr™y
;

206 
public
 
fš®
 
SŒšg
 
	mREAD_PROPORTION_PROPERTY
 = "readproportion";

211 
public
 
fš®
 
SŒšg
 
	mREAD_PROPORTION_PROPERTY_DEFAULT
 = "0.95";

216 
public
 
fš®
 
SŒšg
 
	mUPDATE_PROPORTION_PROPERTY
 = "updateproportion";

221 
public
 
fš®
 
SŒšg
 
	mUPDATE_PROPORTION_PROPERTY_DEFAULT
 = "0.05";

226 
public
 
fš®
 
SŒšg
 
	mINSERT_PROPORTION_PROPERTY
 = "insertproportion";

231 
public
 
fš®
 
SŒšg
 
	mINSERT_PROPORTION_PROPERTY_DEFAULT
 = "0.0";

236 
public
 
fš®
 
SŒšg
 
	mSCAN_PROPORTION_PROPERTY
 = "scanproportion";

241 
public
 
fš®
 
SŒšg
 
	mSCAN_PROPORTION_PROPERTY_DEFAULT
 = "0.0";

246 
public
 
fš®
 
SŒšg
 
	mREADMODIFYWRITE_PROPORTION_PROPERTY
 = "readmodifywriteproportion";

251 
public
 
fš®
 
SŒšg
 
	mREADMODIFYWRITE_PROPORTION_PROPERTY_DEFAULT
 = "0.0";

257 
public
 
fš®
 
SŒšg
 
	mREQUEST_DISTRIBUTION_PROPERTY
 = "requestdistribution";

262 
public
 
fš®
 
SŒšg
 
	mREQUEST_DISTRIBUTION_PROPERTY_DEFAULT
 = "uniform";

268 
public
 
fš®
 
SŒšg
 
	mZERO_PADDING_PROPERTY
 = "zeropadding";

273 
public
 
fš®
 
SŒšg
 
	mZERO_PADDING_PROPERTY_DEFAULT
 = "1";

279 
public
 
fš®
 
SŒšg
 
	mMIN_SCAN_LENGTH_PROPERTY
 = "minscanlength";

284 
public
 
fš®
 
SŒšg
 
	mMIN_SCAN_LENGTH_PROPERTY_DEFAULT
 = "1";

289 
public
 
fš®
 
SŒšg
 
	mMAX_SCAN_LENGTH_PROPERTY
 = "maxscanlength";

294 
public
 
fš®
 
SŒšg
 
	mMAX_SCAN_LENGTH_PROPERTY_DEFAULT
 = "1000";

300 
public
 
fš®
 
SŒšg
 
	mSCAN_LENGTH_DISTRIBUTION_PROPERTY
 = "scanlengthdistribution";

305 
public
 
fš®
 
SŒšg
 
	mSCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
 = "uniform";

310 
public
 
fš®
 
SŒšg
 
	mINSERT_ORDER_PROPERTY
 = "insertorder";

315 
public
 
fš®
 
SŒšg
 
	mINSERT_ORDER_PROPERTY_DEFAULT
 = "hashed";

320 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_DATA_FRACTION
 = "hotspotdatafraction";

325 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_DATA_FRACTION_DEFAULT
 = "0.2";

330 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_OPN_FRACTION
 = "hotspotopnfraction";

335 
public
 
fš®
 
SŒšg
 
	mHOTSPOT_OPN_FRACTION_DEFAULT
 = "0.8";

340 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_LIMIT
 = "core_workload_insertion_retry_limit";

341 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_LIMIT_DEFAULT
 = "0";

346 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_INTERVAL
 = "core_workload_insertion_retry_interval";

347 
public
 
fš®
 
SŒšg
 
	mINSERTION_RETRY_INTERVAL_DEFAULT
 = "3";

352 
public
 
fš®
 
SŒšg
 
	mFIELD_NAME_PREFIX
 = "fieldnameprefix";

357 
public
 
fš®
 
SŒšg
 
	mFIELD_NAME_PREFIX_DEFAULT
 = "field";

359 
´Ùeùed
 
Numb”G’”©Ü
 
	mkey£qu’û
;

360 
´Ùeùed
 
Disü‘eG’”©Ü
 
	mİ”©iÚchoo£r
;

361 
´Ùeùed
 
Numb”G’”©Ü
 
	mkeychoo£r
;

362 
´Ùeùed
 
Numb”G’”©Ü
 
	mf›ldchoo£r
;

363 
´Ùeùed
 
AcknowËdgedCouÁ”G’”©Ü
 
	mŒª§ùiÚš£¹key£qu’û
;

364 
´Ùeùed
 
Numb”G’”©Ü
 
	msÿÆ’gth
;

365 
´Ùeùed
 
boŞ—n
 
	mÜd”edš£¹s
;

366 
´Ùeùed
 
	mf›ldcouÁ
;

367 
´Ùeùed
 
	m»cÜdcouÁ
;

368 
´Ùeùed
 
	mz”İaddšg
;

369 
´Ùeùed
 
	mš£¹iÚR‘ryLim™
;

370 
´Ùeùed
 
	mš£¹iÚR‘ryIÁ”v®
;

372 
´iv©e
 
M—su»m’ts
 
	mm—su»m’ts
 = M—su»m’ts.
g‘M—su»m’ts
();

374 
public
 
SŒšg
 
	$budKeyName
(
keynum
, 
z”İaddšg
, 
boŞ—n
 
Üd”edš£¹s
) {

375 ià(!
Üd”edš£¹s
) {

376 
keynum
 = 
Uts
.
	`hash
(keynum);

378 
SŒšg
 
v®ue
 = 
LÚg
.
	`toSŒšg
(
keynum
);

379 
fl
 = 
z”İaddšg
 - 
v®ue
.
	`Ëngth
();

380 
SŒšg
 
´ekey
 = "user";

381 
i
 = 0; i < 
fl
; i++) {

382 
´ekey
 += '0';

384  
´ekey
 + 
v®ue
;

387 
´Ùeùed
 
Numb”G’”©Ü
 
	$g‘F›ldL’gthG’”©Ü
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

388 
Numb”G’”©Ü
 
f›ldËngthg’”©Ü
;

389 
SŒšg
 
f›ldËngthdi¡ributiÚ
 = 
p
.
	`g‘Prİ”ty
(

390 
FIELD_LENGTH_DISTRIBUTION_PROPERTY
, 
FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

391 
f›ldËngth
 =

392 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
FIELD_LENGTH_PROPERTY
, 
FIELD_LENGTH_PROPERTY_DEFAULT
));

393 
mšf›ldËngth
 =

394 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
MIN_FIELD_LENGTH_PROPERTY
, 
MIN_FIELD_LENGTH_PROPERTY_DEFAULT
));

395 
SŒšg
 
f›ldËngthhi¡og¿m
 = 
p
.
	`g‘Prİ”ty
(

396 
FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY
, 
FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY_DEFAULT
);

397 ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("constant") == 0) {

398 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`CÚ¡ªtIÁeg”G’”©Ü
(
f›ldËngth
);

399 } ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("uniform") == 0) {

400 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(
mšf›ldËngth
, 
f›ldËngth
);

401 } ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("zipfian") == 0) {

402 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
mšf›ldËngth
, 
f›ldËngth
);

403 } ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("histogram") == 0) {

404 
Œy
 {

405 
f›ldËngthg’”©Ü
 = 
Ãw
 
	`Hi¡og¿mG’”©Ü
(
f›ldËngthhi¡og¿m
);

406 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

407 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

408 "Couldn'ˆ»ad f›ld†’gth hi¡og¿m fe: " + 
f›ldËngthhi¡og¿m
, 
e
);

411 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

412 "UnknowÀf›ld†’gth di¡ributiÚ \"" + 
f›ldËngthdi¡ributiÚ
 + "\"");

414  
f›ldËngthg’”©Ü
;

415 
	}
}

421 @
Ov”ride


422 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

423 
bË
 = 
p
.
	`g‘Prİ”ty
(
TABLENAME_PROPERTY
, 
TABLENAME_PROPERTY_DEFAULT
);

425 
f›ldcouÁ
 =

426 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
FIELD_COUNT_PROPERTY
, 
FIELD_COUNT_PROPERTY_DEFAULT
));

427 
fš®
 
SŒšg
 
f›ldÇm•»fix
 = 
p
.
	`g‘Prİ”ty
(
FIELD_NAME_PREFIX
, 
FIELD_NAME_PREFIX_DEFAULT
);

428 
f›ldÇmes
 = 
Ãw
 
A¼ayLi¡
<>();

429 
i
 = 0; i < 
f›ldcouÁ
; i++) {

430 
f›ldÇmes
.
	`add
(
f›ldÇm•»fix
 + 
i
);

432 
f›ldËngthg’”©Ü
 = 
CÜeWÜklßd
.
	`g‘F›ldL’gthG’”©Ü
(
p
);

434 
»cÜdcouÁ
 =

435 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
, Cl›Á.
DEFAULT_RECORD_COUNT
));

436 ià(
»cÜdcouÁ
 == 0) {

437 
»cÜdcouÁ
 = 
IÁeg”
.
MAX_VALUE
;

439 
SŒšg
 
»que¡di¡rib
 =

440 
p
.
	`g‘Prİ”ty
(
REQUEST_DISTRIBUTION_PROPERTY
, 
REQUEST_DISTRIBUTION_PROPERTY_DEFAULT
);

441 
mšsÿÆ’gth
 =

442 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
MIN_SCAN_LENGTH_PROPERTY
, 
MIN_SCAN_LENGTH_PROPERTY_DEFAULT
));

443 
maxsÿÆ’gth
 =

444 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
MAX_SCAN_LENGTH_PROPERTY
, 
MAX_SCAN_LENGTH_PROPERTY_DEFAULT
));

445 
SŒšg
 
sÿÆ’gthdi¡rib
 =

446 
p
.
	`g‘Prİ”ty
(
SCAN_LENGTH_DISTRIBUTION_PROPERTY
, 
SCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

448 
š£¹¡¬t
 =

449 
LÚg
.
	`·r£LÚg
(
p
.
	`g‘Prİ”ty
(
INSERT_START_PROPERTY
, 
INSERT_START_PROPERTY_DEFAULT
));

450 
š£¹couÁ
=

451 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
INSERT_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
»cÜdcouÁ
 - 
š£¹¡¬t
)));

453 ià(
»cÜdcouÁ
 < (
š£¹¡¬t
 + 
š£¹couÁ
)) {

454 
Sy¡em
.
”r
.
	`´šn
("Invalid combination of insertstart, insertcount‡nd„ecordcount.");

455 
Sy¡em
.
”r
.
	`´šn
("recordcount must be biggerhan insertstart + insertcount.");

456 
Sy¡em
.
	`ex™
(-1);

458 
z”İaddšg
 =

459 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
ZERO_PADDING_PROPERTY
, 
ZERO_PADDING_PROPERTY_DEFAULT
));

461 
»ad®lf›lds
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

462 
p
.
	`g‘Prİ”ty
(
READ_ALL_FIELDS_PROPERTY
, 
READ_ALL_FIELDS_PROPERTY_DEFAULT
));

463 
»ad®lf›ldsbyÇme
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

464 
p
.
	`g‘Prİ”ty
(
READ_ALL_FIELDS_BY_NAME_PROPERTY
, 
READ_ALL_FIELDS_BY_NAME_PROPERTY_DEFAULT
));

465 
wr™—Îf›lds
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

466 
p
.
	`g‘Prİ”ty
(
WRITE_ALL_FIELDS_PROPERTY
, 
WRITE_ALL_FIELDS_PROPERTY_DEFAULT
));

468 
d©aš‹gr™y
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

469 
p
.
	`g‘Prİ”ty
(
DATA_INTEGRITY_PROPERTY
, 
DATA_INTEGRITY_PROPERTY_DEFAULT
));

472 ià(
d©aš‹gr™y
 && !(
p
.
	`g‘Prİ”ty
(

473 
FIELD_LENGTH_DISTRIBUTION_PROPERTY
,

474 
FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
)).
	`equ®s
("constant")) {

475 
Sy¡em
.
”r
.
	`´šn
("Must have constant field sizeo check data integrity.");

476 
Sy¡em
.
	`ex™
(-1);

478 ià(
d©aš‹gr™y
) {

479 
Sy¡em
.
out
.
	`´šn
("Data integrity isƒnabled.");

482 ià(
p
.
	`g‘Prİ”ty
(
INSERT_ORDER_PROPERTY
, 
INSERT_ORDER_PROPERTY_DEFAULT
).
	`com·»To
("hashed") == 0) {

483 
Üd”edš£¹s
 = 
çl£
;

485 
Üd”edš£¹s
 = 
Œue
;

488 
key£qu’û
 = 
Ãw
 
	`CouÁ”G’”©Ü
(
š£¹¡¬t
);

489 
İ”©iÚchoo£r
 = 
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

491 
Œª§ùiÚš£¹key£qu’û
 = 
Ãw
 
	`AcknowËdgedCouÁ”G’”©Ü
(
»cÜdcouÁ
);

492 ià(
»que¡di¡rib
.
	`com·»To
("uniform") == 0) {

493 
keychoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 - 1);

494 } ià(
»que¡di¡rib
.
	`com·»To
("exponential") == 0) {

495 
³rûÁe
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(

496 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_PROPERTY
,

497 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_DEFAULT
));

498 
äac
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(

499 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_PROPERTY
,

500 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_DEFAULT
));

501 
keychoo£r
 = 
Ãw
 
	`ExpÚ’tŸlG’”©Ü
(
³rûÁe
, 
»cÜdcouÁ
 * 
äac
);

502 } ià(
»que¡di¡rib
.
	`com·»To
("sequential") == 0) {

503 
keychoo£r
 = 
Ãw
 
	`Sequ’tŸlG’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 - 1);

504 } ià(
»que¡di¡rib
.
	`com·»To
("zipfian") == 0) {

514 
fš®
 
š£¹´İÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

515 
p
.
	`g‘Prİ”ty
(
INSERT_PROPORTION_PROPERTY
, 
INSERT_PROPORTION_PROPERTY_DEFAULT
));

516 
İcouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
OPERATION_COUNT_PROPERTY
));

517 
ex³ùedÃwkeys
 = (è((
İcouÁ
è* 
š£¹´İÜtiÚ
 * 2.0);

519 
keychoo£r
 = 
Ãw
 
	`SüambËdZfŸnG’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 + 
ex³ùedÃwkeys
);

520 } ià(
»que¡di¡rib
.
	`com·»To
("latest") == 0) {

521 
keychoo£r
 = 
Ãw
 
	`SkewedL©e¡G’”©Ü
(
Œª§ùiÚš£¹key£qu’û
);

522 } ià(
»que¡di¡rib
.
	`equ®s
("hotspot")) {

523 
hÙ£täaùiÚ
 =

524 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_DATA_FRACTION
, 
HOTSPOT_DATA_FRACTION_DEFAULT
));

525 
hÙİnäaùiÚ
 =

526 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_OPN_FRACTION
, 
HOTSPOT_OPN_FRACTION_DEFAULT
));

527 
keychoo£r
 = 
Ãw
 
	`HÙ¥ÙIÁeg”G’”©Ü
(
š£¹¡¬t
, in£¹¡¬ˆ+ 
š£¹couÁ
 - 1,

528 
hÙ£täaùiÚ
, 
hÙİnäaùiÚ
);

530 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀ»que¡ di¡ributiÚ \"" + 
»que¡di¡rib
 + "\"");

533 
f›ldchoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(0, 
f›ldcouÁ
 - 1);

535 ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("uniform") == 0) {

536 
sÿÆ’gth
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(
mšsÿÆ’gth
, 
maxsÿÆ’gth
);

537 } ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("zipfian") == 0) {

538 
sÿÆ’gth
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
mšsÿÆ’gth
, 
maxsÿÆ’gth
);

540 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

541 "Di¡ributiÚ \"" + 
sÿÆ’gthdi¡rib
 + "\"‚ot‡llowed for scan†ength");

544 
š£¹iÚR‘ryLim™
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(

545 
INSERTION_RETRY_LIMIT
, 
INSERTION_RETRY_LIMIT_DEFAULT
));

546 
š£¹iÚR‘ryIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(

547 
INSERTION_RETRY_INTERVAL
, 
INSERTION_RETRY_INTERVAL_DEFAULT
));

548 
	}
}

553 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	$budSšgËV®ue
(
SŒšg
 
key
) {

554 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ue
 = 
Ãw
 HashMap<>();

556 
SŒšg
 
f›ldkey
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

557 
By‹I‹¿tÜ
 
d©a
;

558 ià(
d©aš‹gr™y
) {

559 
d©a
 = 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
key
, 
f›ldkey
));

562 
d©a
 = 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
());

564 
v®ue
.
	`put
(
f›ldkey
, 
d©a
);

566  
v®ue
;

567 
	}
}

572 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	$budV®ues
(
SŒšg
 
key
) {

573 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
Ãw
 HashMap<>();

575 
SŒšg
 
f›ldkey
 : 
f›ldÇmes
) {

576 
By‹I‹¿tÜ
 
d©a
;

577 ià(
d©aš‹gr™y
) {

578 
d©a
 = 
Ãw
 
	`SŒšgBy‹I‹¿tÜ
(
	`budD‘”mši¡icV®ue
(
key
, 
f›ldkey
));

581 
d©a
 = 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
());

583 
v®ues
.
	`put
(
f›ldkey
, 
d©a
);

585  
v®ues
;

586 
	}
}

591 
´iv©e
 
SŒšg
 
	$budD‘”mši¡icV®ue
(
SŒšg
 
key
, SŒšg 
f›ldkey
) {

592 
size
 = 
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`štV®ue
();

593 
SŒšgBud”
 
sb
 = 
Ãw
 
	`SŒšgBud”
(
size
);

594 
sb
.
	`­³nd
(
key
);

595 
sb
.
	`­³nd
(':');

596 
sb
.
	`­³nd
(
f›ldkey
);

597 
sb
.
	`Ëngth
(è< 
size
) {

598 
sb
.
	`­³nd
(':');

599 
sb
.
	`­³nd
(sb.
	`toSŒšg
().
	`hashCode
());

601 
sb
.
	`£tL’gth
(
size
);

603  
sb
.
	`toSŒšg
();

604 
	}
}

612 @
Ov”ride


613 
public
 
boŞ—n
 
	$doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

614 
keynum
 = 
key£qu’û
.
	`ÃxtV®ue
().
	`štV®ue
();

615 
SŒšg
 
dbkey
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

616 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
	`budV®ues
(
dbkey
);

618 
Stus
 
¡©us
;

619 
numOfR‘r›s
 = 0;

621 
¡©us
 = 
db
.
	`š£¹
(
bË
, 
dbkey
, 
v®ues
);

622 ià(
nuÎ
 !ğ
¡©us
 && stus.
	`isOk
()) {

628 ià(++
numOfR‘r›s
 <ğ
š£¹iÚR‘ryLim™
) {

629 
Sy¡em
.
”r
.
	`´šn
("R‘ryšg in£¹iÚ,„‘ry couÁ: " + 
numOfR‘r›s
);

630 
Œy
 {

632 
¦“pTime
 = (è(1000 * 
š£¹iÚR‘ryIÁ”v®
 * (0.8 + 0.4 * 
M©h
.
	`¿ndom
()));

633 
Th»ad
.
	`¦“p
(
¦“pTime
);

634 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

639 
Sy¡em
.
”r
.
	`´šn
("E¼Ü in£¹šg,‚Ù„‘ryšg‡ny mÜe.‚umb” oà©‹m±s: " + 
numOfR‘r›s
 +

640 "In£¹iÚ R‘ry Lim™: " + 
š£¹iÚR‘ryLim™
);

644 } 
Œue
);

646  
nuÎ
 !ğ
¡©us
 && stus.
	`isOk
();

647 
	}
}

655 @
Ov”ride


656 
public
 
boŞ—n
 
	$doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

657 
SŒšg
 
İ”©iÚ
 = 
İ”©iÚchoo£r
.
	`ÃxtSŒšg
();

658 if(
İ”©iÚ
 =ğ
nuÎ
) {

659  
çl£
;

662 
İ”©iÚ
) {

664 
	`doT¿n§ùiÚR—d
(
db
);

667 
	`doT¿n§ùiÚUpd©e
(
db
);

670 
	`doT¿n§ùiÚIn£¹
(
db
);

673 
	`doT¿n§ùiÚSÿn
(
db
);

676 
	`doT¿n§ùiÚR—dModifyWr™e
(
db
);

679  
Œue
;

680 
	}
}

689 
´Ùeùed
 
v”ifyRow
(
SŒšg
 
key
, 
HashM­
<SŒšg, 
By‹I‹¿tÜ
> 
ûÎs
) {

690 
Stus
 
	gv”ifyStus
 = Stus.
OK
;

691 
	g¡¬tTime
 = 
Sy¡em
.
ÇnoTime
();

692 ià(!
	gûÎs
.
isEm±y
()) {

693 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
ûÎs
.
’ŒyS‘
()) {

694 ià(!
’Œy
.
g‘V®ue
().
toSŒšg
().
equ®s
(
budD‘”mši¡icV®ue
(
key
,ƒÁry.
g‘Key
()))) {

695 
	gv”ifyStus
 = 
Stus
.
UNEXPECTED_STATE
;

701 
	gv”ifyStus
 = 
Stus
.
ERROR
;

703 
	g’dTime
 = 
Sy¡em
.
ÇnoTime
();

704 
	gm—su»m’ts
.
m—su»
("VERIFY", (è(
’dTime
 - 
¡¬tTime
) / 1000);

705 
	gm—su»m’ts
.
»pÜtStus
("VERIFY", 
v”ifyStus
);

708 
	$ÃxtKeynum
() {

709 
keynum
;

710 ià(
keychoo£r
 
š¡ªûof
 
ExpÚ’tŸlG’”©Ü
) {

712 
keynum
 = 
Œª§ùiÚš£¹key£qu’û
.
	`Ï¡V®ue
(è- 
keychoo£r
.
	`ÃxtV®ue
().
	`štV®ue
();

713 } 
keynum
 < 0);

716 
keynum
 = 
keychoo£r
.
	`ÃxtV®ue
().
	`štV®ue
();

717 } 
keynum
 > 
Œª§ùiÚš£¹key£qu’û
.
	`Ï¡V®ue
());

719  
keynum
;

720 
	}
}

722 
public
 
	$doT¿n§ùiÚR—d
(
DB
 
db
) {

724 
keynum
 = 
	`ÃxtKeynum
();

726 
SŒšg
 
keyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

728 
HashS‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

730 ià(!
»ad®lf›lds
) {

732 
SŒšg
 
f›ldÇme
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

734 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>();

735 
f›lds
.
	`add
(
f›ldÇme
);

736 } ià(
d©aš‹gr™y
 || 
»ad®lf›ldsbyÇme
) {

738 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>(
f›ldÇmes
);

741 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 HashMap<String, ByteIterator>();

742 
db
.
	`»ad
(
bË
, 
keyÇme
, 
f›lds
, 
ûÎs
);

744 ià(
d©aš‹gr™y
) {

745 
	`v”ifyRow
(
keyÇme
, 
ûÎs
);

747 
	}
}

749 
public
 
	$doT¿n§ùiÚR—dModifyWr™e
(
DB
 
db
) {

751 
keynum
 = 
	`ÃxtKeynum
();

753 
SŒšg
 
keyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

755 
HashS‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

757 ià(!
»ad®lf›lds
) {

759 
SŒšg
 
f›ldÇme
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

761 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>();

762 
f›lds
.
	`add
(
f›ldÇme
);

765 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
;

767 ià(
wr™—Îf›lds
) {

769 
v®ues
 = 
	`budV®ues
(
keyÇme
);

772 
v®ues
 = 
	`budSšgËV®ue
(
keyÇme
);

777 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 HashMap<String, ByteIterator>();

780 
i¡
 = 
m—su»m’ts
.
	`g‘IÁ’dedS¹TimeNs
();

781 
¡
 = 
Sy¡em
.
	`ÇnoTime
();

782 
db
.
	`»ad
(
bË
, 
keyÇme
, 
f›lds
, 
ûÎs
);

784 
db
.
	`upd©e
(
bË
, 
keyÇme
, 
v®ues
);

786 
’
 = 
Sy¡em
.
	`ÇnoTime
();

788 ià(
d©aš‹gr™y
) {

789 
	`v”ifyRow
(
keyÇme
, 
ûÎs
);

792 
m—su»m’ts
.
	`m—su»
("READ-MODIFY-WRITE", (è((
’
 - 
¡
) / 1000));

793 
m—su»m’ts
.
	`m—su»IÁ’ded
("READ-MODIFY-WRITE", (è((
’
 - 
i¡
) / 1000));

794 
	}
}

796 
public
 
	$doT¿n§ùiÚSÿn
(
DB
 
db
) {

798 
keynum
 = 
	`ÃxtKeynum
();

800 
SŒšg
 
¡¬tkeyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

803 
Ën
 = 
sÿÆ’gth
.
	`ÃxtV®ue
().
	`štV®ue
();

805 
HashS‘
<
SŒšg
> 
f›lds
 = 
nuÎ
;

807 ià(!
»ad®lf›lds
) {

809 
SŒšg
 
f›ldÇme
 = 
f›ldÇmes
.
	`g‘
(
f›ldchoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

811 
f›lds
 = 
Ãw
 
HashS‘
<
SŒšg
>();

812 
f›lds
.
	`add
(
f›ldÇme
);

815 
db
.
	`sÿn
(
bË
, 
¡¬tkeyÇme
, 
Ën
, 
f›lds
, 
Ãw
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>>());

816 
	}
}

818 
public
 
	$doT¿n§ùiÚUpd©e
(
DB
 
db
) {

820 
keynum
 = 
	`ÃxtKeynum
();

822 
SŒšg
 
keyÇme
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

824 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
;

826 ià(
wr™—Îf›lds
) {

828 
v®ues
 = 
	`budV®ues
(
keyÇme
);

831 
v®ues
 = 
	`budSšgËV®ue
(
keyÇme
);

834 
db
.
	`upd©e
(
bË
, 
keyÇme
, 
v®ues
);

835 
	}
}

837 
public
 
	$doT¿n§ùiÚIn£¹
(
DB
 
db
) {

839 
keynum
 = 
Œª§ùiÚš£¹key£qu’û
.
	`ÃxtV®ue
();

841 
Œy
 {

842 
SŒšg
 
dbkey
 = 
CÜeWÜklßd
.
	`budKeyName
(
keynum
, 
z”İaddšg
, 
Üd”edš£¹s
);

844 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ues
 = 
	`budV®ues
(
dbkey
);

845 
db
.
	`š£¹
(
bË
, 
dbkey
, 
v®ues
);

846 } 
fš®ly
 {

847 
Œª§ùiÚš£¹key£qu’û
.
	`acknowËdge
(
keynum
);

849 
	}
}

861 
´Ùeùed
 
Disü‘eG’”©Ü
 
	$ü—‹O³¿tiÚG’”©Ü
(
fš®
 
Prİ”t›s
 
p
) {

862 ià(
p
 =ğ
nuÎ
) {

863 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Properties object cannot be‚ull");

865 
fš®
 
»ad´İÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

866 
p
.
	`g‘Prİ”ty
(
READ_PROPORTION_PROPERTY
, 
READ_PROPORTION_PROPERTY_DEFAULT
));

867 
fš®
 
upd©•rİÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

868 
p
.
	`g‘Prİ”ty
(
UPDATE_PROPORTION_PROPERTY
, 
UPDATE_PROPORTION_PROPERTY_DEFAULT
));

869 
fš®
 
š£¹´İÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

870 
p
.
	`g‘Prİ”ty
(
INSERT_PROPORTION_PROPERTY
, 
INSERT_PROPORTION_PROPERTY_DEFAULT
));

871 
fš®
 
sÿÅrİÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(

872 
p
.
	`g‘Prİ”ty
(
SCAN_PROPORTION_PROPERTY
, 
SCAN_PROPORTION_PROPERTY_DEFAULT
));

873 
fš®
 
»admodifywr™•rİÜtiÚ
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(

874 
READMODIFYWRITE_PROPORTION_PROPERTY
, 
READMODIFYWRITE_PROPORTION_PROPERTY_DEFAULT
));

876 
fš®
 
Disü‘eG’”©Ü
 
İ”©iÚchoo£r
 = 
Ãw
 
	`Disü‘eG’”©Ü
();

877 ià(
»ad´İÜtiÚ
 > 0) {

878 
İ”©iÚchoo£r
.
	`addV®ue
(
»ad´İÜtiÚ
, "READ");

881 ià(
upd©•rİÜtiÚ
 > 0) {

882 
İ”©iÚchoo£r
.
	`addV®ue
(
upd©•rİÜtiÚ
, "UPDATE");

885 ià(
š£¹´İÜtiÚ
 > 0) {

886 
İ”©iÚchoo£r
.
	`addV®ue
(
š£¹´İÜtiÚ
, "INSERT");

889 ià(
sÿÅrİÜtiÚ
 > 0) {

890 
İ”©iÚchoo£r
.
	`addV®ue
(
sÿÅrİÜtiÚ
, "SCAN");

893 ià(
»admodifywr™•rİÜtiÚ
 > 0) {

894 
İ”©iÚchoo£r
.
	`addV®ue
(
»admodifywr™•rİÜtiÚ
, "READMODIFYWRITE");

896  
İ”©iÚchoo£r
;

897 
	}
}

	@workloads/RestWorkload.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gRªdomBy‹I‹¿tÜ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.*;

26 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

27 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

28 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnifÜmLÚgG’”©Ü
;

42 
public
 cÏs 
	cRe¡WÜklßd
 
ex‹nds
 
	mCÜeWÜklßd
 {

48 
public
 
fš®
 
SŒšg
 
	mDELETE_PROPORTION_PROPERTY
 = "deleteproportion";

53 
public
 
fš®
 
SŒšg
 
	mDELETE_PROPORTION_PROPERTY_DEFAULT
 = "0.00";

58 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_FILE_PROPERTY
 = "fieldlengthdistfile";

63 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_FILE_PROPERTY_DEFAULT
 = "fieldLengthDistFile.txt";

73 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_TRACE_FILE
 = "url.trace.read";

74 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_TRACE_FILE_DEFAULT
 = "readtrace.txt";

75 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_ZIPFIAN_CONSTANT
 = "readzipfconstant";

76 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

77 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_RECORD_COUNT_PROPERTY
 = "readrecordcount";

79 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_TRACE_FILE
 = "url.trace.insert";

80 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_TRACE_FILE_DEFAULT
 = "inserttrace.txt";

81 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_ZIPFIAN_CONSTANT
 = "insertzipfconstant";

82 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

83 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_SIZE_ZIPFIAN_CONSTANT
 = "insertsizezipfconstant";

84 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_SIZE_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

85 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_RECORD_COUNT_PROPERTY
 = "insertrecordcount";

87 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_TRACE_FILE
 = "url.trace.delete";

88 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_TRACE_FILE_DEFAULT
 = "deletetrace.txt";

89 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_ZIPFIAN_CONSTANT
 = "deletezipfconstant";

90 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

91 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_RECORD_COUNT_PROPERTY
 = "deleterecordcount";

93 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_TRACE_FILE
 = "url.trace.update";

94 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_TRACE_FILE_DEFAULT
 = "updatetrace.txt";

95 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_ZIPFIAN_CONSTANT
 = "updatezipfconstant";

96 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

97 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_RECORD_COUNT_PROPERTY
 = "updaterecordcount";

99 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	m»adU¾M­
;

100 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	mš£¹U¾M­
;

101 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	md–‘eU¾M­
;

102 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	mupd©eU¾M­
;

103 
´iv©e
 
	m»adRecÜdCouÁ
;

104 
´iv©e
 
	mš£¹RecÜdCouÁ
;

105 
´iv©e
 
	md–‘eRecÜdCouÁ
;

106 
´iv©e
 
	mupd©eRecÜdCouÁ
;

107 
´iv©e
 
Numb”G’”©Ü
 
	m»adKeyChoo£r
;

108 
´iv©e
 
Numb”G’”©Ü
 
	mš£¹KeyChoo£r
;

109 
´iv©e
 
Numb”G’”©Ü
 
	md–‘eKeyChoo£r
;

110 
´iv©e
 
Numb”G’”©Ü
 
	mupd©eKeyChoo£r
;

111 
´iv©e
 
Numb”G’”©Ü
 
	mf›ldËngthg’”©Ü
;

112 
´iv©e
 
Disü‘eG’”©Ü
 
	mİ”©iÚchoo£r
;

114 @
Ov”ride


115 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

117 
»adRecÜdCouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
READ_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(IÁeg”.
MAX_VALUE
)));

118 
š£¹RecÜdCouÁ
 = 
IÁeg”


119 .
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
INSERT_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
IÁeg”
.
MAX_VALUE
)));

120 
d–‘eRecÜdCouÁ
 = 
IÁeg”


121 .
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
DELETE_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
IÁeg”
.
MAX_VALUE
)));

122 
upd©eRecÜdCouÁ
 = 
IÁeg”


123 .
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
UPDATE_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
IÁeg”
.
MAX_VALUE
)));

125 
»adU¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
READ_TRACE_FILE
, 
READ_TRACE_FILE_DEFAULT
), 
»adRecÜdCouÁ
);

126 
š£¹U¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
INSERT_TRACE_FILE
, 
INSERT_TRACE_FILE_DEFAULT
), 
š£¹RecÜdCouÁ
);

127 
d–‘eU¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
DELETE_TRACE_FILE
, 
DELETE_TRACE_FILE_DEFAULT
), 
d–‘eRecÜdCouÁ
);

128 
upd©eU¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
UPDATE_TRACE_FILE
, 
UPDATE_TRACE_FILE_DEFAULT
), 
upd©eRecÜdCouÁ
);

130 
İ”©iÚchoo£r
 = 
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

133 
SŒšg
 
»que¡Di¡rib
 = 
p
.
	`g‘Prİ”ty
(
REQUEST_DISTRIBUTION_PROPERTY
, 
REQUEST_DISTRIBUTION_PROPERTY_DEFAULT
);

135 
»adZfcÚ¡ªt
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
READ_ZIPFIAN_CONSTANT
, 
READ_ZIPFIAN_CONSTANT_DEAFULT
));

136 
»adKeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
»adU¾M­
.
	`size
(), 
»adZfcÚ¡ªt
, 
p
);

137 
upd©eZfcÚ¡ªt
 = 
DoubË


138 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
UPDATE_ZIPFIAN_CONSTANT
, 
UPDATE_ZIPFIAN_CONSTANT_DEAFULT
));

139 
upd©eKeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
upd©eU¾M­
.
	`size
(), 
upd©eZfcÚ¡ªt
, 
p
);

140 
š£¹ZfcÚ¡ªt
 = 
DoubË


141 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
INSERT_ZIPFIAN_CONSTANT
, 
INSERT_ZIPFIAN_CONSTANT_DEAFULT
));

142 
š£¹KeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
š£¹U¾M­
.
	`size
(), 
š£¹ZfcÚ¡ªt
, 
p
);

143 
d–‘eZfcÚ¡ªt
 = 
DoubË


144 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
DELETE_ZIPFIAN_CONSTANT
, 
DELETE_ZIPFIAN_CONSTANT_DEAFULT
));

145 
d–‘eKeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
d–‘eU¾M­
.
	`size
(), 
d–‘eZfcÚ¡ªt
, 
p
);

147 
f›ldËngthg’”©Ü
 = 
	`g‘F›ldL’gthG’”©Ü
(
p
);

150 
public
 
Disü‘eG’”©Ü
 
	$ü—‹O³¿tiÚG’”©Ü
(
fš®
 
Prİ”t›s
 
p
) {

152 
fš®
 
Disü‘eG’”©Ü
 
İ”©iÚChoo£r
 = 
CÜeWÜklßd
.
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

154 
d–‘•rİÜtiÚ
 = 
DoubË


155 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
DELETE_PROPORTION_PROPERTY
, 
DELETE_PROPORTION_PROPERTY_DEFAULT
));

156 ià(
d–‘•rİÜtiÚ
 > 0) {

157 
İ”©iÚChoo£r
.
	`addV®ue
(
d–‘•rİÜtiÚ
, "DELETE");

159  
İ”©iÚChoo£r
;

160 
	}
}

162 
´iv©e
 
Numb”G’”©Ü
 
	$g‘KeyChoo£r
(
SŒšg
 
»que¡Di¡rib
, 
»cÜdCouÁ
, 
zfCÚÁ
,

163 
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

164 
Numb”G’”©Ü
 
keychoo£r
;

166 
»que¡Di¡rib
) {

168 
³rûÁe
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_PROPERTY
,

169 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_DEFAULT
));

170 
äac
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_PROPERTY
,

171 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_DEFAULT
));

172 
keychoo£r
 = 
Ãw
 
	`ExpÚ’tŸlG’”©Ü
(
³rûÁe
, 
»cÜdCouÁ
 * 
äac
);

175 
keychoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(0, 
»cÜdCouÁ
 - 1);

178 
keychoo£r
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
»cÜdCouÁ
, 
zfCÚÁ
);

181 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Latest„equest distribution is‚ot supported for RestWorkload.");

183 
hÙ£täaùiÚ
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_DATA_FRACTION
, 
HOTSPOT_DATA_FRACTION_DEFAULT
));

184 
hÙİnäaùiÚ
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_OPN_FRACTION
, 
HOTSPOT_OPN_FRACTION_DEFAULT
));

185 
keychoo£r
 = 
Ãw
 
	`HÙ¥ÙIÁeg”G’”©Ü
(0, 
»cÜdCouÁ
 - 1, 
hÙ£täaùiÚ
, 
hÙİnäaùiÚ
);

188 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀ»que¡ di¡ributiÚ \"" + 
»que¡Di¡rib
 + "\"");

190  
keychoo£r
;

191 
	}
}

193 
´Ùeùed
 
Numb”G’”©Ü
 
	$g‘F›ldL’gthG’”©Ü
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

195 
Numb”G’”©Ü
 
f›ldL’gthG’”©Ü
 = 
CÜeWÜklßd
.
	`g‘F›ldL’gthG’”©Ü
(
p
);

196 
SŒšg
 
f›ldËngthdi¡ributiÚ
 = 
p
.
	`g‘Prİ”ty
(
FIELD_LENGTH_DISTRIBUTION_PROPERTY
,

197 
FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

199 ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("zipfian") == 0) {

200 
f›ldËngth
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
FIELD_LENGTH_PROPERTY
, 
FIELD_LENGTH_PROPERTY_DEFAULT
));

201 
š£¹sizezfcÚ¡ªt
 = 
DoubË


202 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
INSERT_SIZE_ZIPFIAN_CONSTANT
, 
INSERT_SIZE_ZIPFIAN_CONSTANT_DEAFULT
));

203 
f›ldL’gthG’”©Ü
 = 
Ãw
 
	`ZfŸnG’”©Ü
(1, 
f›ldËngth
, 
š£¹sizezfcÚ¡ªt
);

205  
f›ldL’gthG’”©Ü
;

206 
	}
}

211 
´iv©e
 
	gM­
<
	gIÁeg”
, 
	gSŒšg
> 
	$g‘T¿û
(
SŒšg
 
feP©h
, 
»cÜdCouÁ
)

212 
throws
 
WÜklßdExû±iÚ
 {

213 
M­
<
IÁeg”
, 
SŒšg
> 
u¾M­
 = 
Ãw
 
HashM­
<Integer, String>();

214 
couÁ
 = 0;

215 
SŒšg
 
lše
;

216 
Œy
 {

217 
FeR—d”
 
šputFe
 = 
Ãw
 
	`FeR—d”
(
feP©h
);

218 
Bufã»dR—d”
 
bufãrR—d”
 = 
Ãw
 
	`Bufã»dR—d”
(
šputFe
);

219 (
lše
 = 
bufãrR—d”
.
	`»adLše
()è!ğ
nuÎ
) {

220 
u¾M­
.
	`put
(
couÁ
++, 
lše
.
	`Œim
());

221 ià(
couÁ
 >ğ
»cÜdCouÁ
) {

225 
bufãrR—d”
.
	`şo£
();

226 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

227 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

229 + 
e
.
	`g‘LoÿlizedMes§ge
());

231  
u¾M­
;

232 
	}
}

237 @
Ov”ride


238 
public
 
boŞ—n
 
	$doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

239  
çl£
;

240 
	}
}

242 @
Ov”ride


243 
public
 
boŞ—n
 
	$doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

244 
SŒšg
 
İ”©iÚ
 = 
İ”©iÚchoo£r
.
	`ÃxtSŒšg
();

245 ià(
İ”©iÚ
 =ğ
nuÎ
) {

246  
çl£
;

249 
İ”©iÚ
) {

251 
	`doT¿n§ùiÚUpd©e
(
db
);

254 
	`doT¿n§ùiÚIn£¹
(
db
);

257 
	`doT¿n§ùiÚD–‘e
(
db
);

260 
	`doT¿n§ùiÚR—d
(
db
);

262  
Œue
;

263 
	}
}

268 
´iv©e
 
SŒšg
 
	$g‘NextURL
(
İTy³
) {

269 ià(
İTy³
 == 1) {

270  
»adU¾M­
.
	`g‘
(
»adKeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

271 } ià(
İTy³
 == 2) {

272  
š£¹U¾M­
.
	`g‘
(
š£¹KeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

273 } ià(
İTy³
 == 3) {

274  
d–‘eU¾M­
.
	`g‘
(
d–‘eKeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

276  
upd©eU¾M­
.
	`g‘
(
upd©eKeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

278 
	}
}

280 @
Ov”ride


281 
public
 
	$doT¿n§ùiÚR—d
(
DB
 
db
) {

282 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

283 
db
.
	`»ad
(
nuÎ
, 
	`g‘NextURL
(1),‚uÎ, 
»suÉ
);

284 
	}
}

286 @
Ov”ride


287 
public
 
	$doT¿n§ùiÚIn£¹
(
DB
 
db
) {

288 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ue
 = 
Ãw
 HashMap<String, ByteIterator>();

290 
v®ue
.
	`put
("d©a", 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
()));

291 
db
.
	`š£¹
(
nuÎ
, 
	`g‘NextURL
(2), 
v®ue
);

292 
	}
}

294 
public
 
	$doT¿n§ùiÚD–‘e
(
DB
 
db
) {

295 
db
.
	`d–‘e
(
nuÎ
, 
	`g‘NextURL
(3));

296 
	}
}

298 @
Ov”ride


299 
public
 
	$doT¿n§ùiÚUpd©e
(
DB
 
db
) {

300 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ue
 = 
Ãw
 HashMap<String, ByteIterator>();

302 
v®ue
.
	`put
("d©a", 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
()));

303 
db
.
	`upd©e
(
nuÎ
, 
	`g‘NextURL
(4), 
v®ue
);

304 
	}
}

	@workloads/RestWorkload.java

18 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

20 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

21 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

22 
impÜt
 
	gs™e
.
	gycsb
.
	gRªdomBy‹I‹¿tÜ
;

23 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

24 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.*;

26 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

27 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

28 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnifÜmLÚgG’”©Ü
;

42 
public
 cÏs 
	cRe¡WÜklßd
 
ex‹nds
 
	mCÜeWÜklßd
 {

48 
public
 
fš®
 
SŒšg
 
	mDELETE_PROPORTION_PROPERTY
 = "deleteproportion";

53 
public
 
fš®
 
SŒšg
 
	mDELETE_PROPORTION_PROPERTY_DEFAULT
 = "0.00";

58 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_FILE_PROPERTY
 = "fieldlengthdistfile";

63 
public
 
fš®
 
SŒšg
 
	mFIELD_LENGTH_DISTRIBUTION_FILE_PROPERTY_DEFAULT
 = "fieldLengthDistFile.txt";

73 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_TRACE_FILE
 = "url.trace.read";

74 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_TRACE_FILE_DEFAULT
 = "readtrace.txt";

75 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_ZIPFIAN_CONSTANT
 = "readzipfconstant";

76 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

77 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_RECORD_COUNT_PROPERTY
 = "readrecordcount";

79 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_TRACE_FILE
 = "url.trace.insert";

80 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_TRACE_FILE_DEFAULT
 = "inserttrace.txt";

81 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_ZIPFIAN_CONSTANT
 = "insertzipfconstant";

82 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

83 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_SIZE_ZIPFIAN_CONSTANT
 = "insertsizezipfconstant";

84 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_SIZE_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

85 
´iv©e
 
fš®
 
SŒšg
 
	mINSERT_RECORD_COUNT_PROPERTY
 = "insertrecordcount";

87 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_TRACE_FILE
 = "url.trace.delete";

88 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_TRACE_FILE_DEFAULT
 = "deletetrace.txt";

89 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_ZIPFIAN_CONSTANT
 = "deletezipfconstant";

90 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

91 
´iv©e
 
fš®
 
SŒšg
 
	mDELETE_RECORD_COUNT_PROPERTY
 = "deleterecordcount";

93 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_TRACE_FILE
 = "url.trace.update";

94 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_TRACE_FILE_DEFAULT
 = "updatetrace.txt";

95 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_ZIPFIAN_CONSTANT
 = "updatezipfconstant";

96 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_ZIPFIAN_CONSTANT_DEAFULT
 = "0.99";

97 
´iv©e
 
fš®
 
SŒšg
 
	mUPDATE_RECORD_COUNT_PROPERTY
 = "updaterecordcount";

99 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	m»adU¾M­
;

100 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	mš£¹U¾M­
;

101 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	md–‘eU¾M­
;

102 
´iv©e
 
	mM­
<
	mIÁeg”
, 
	mSŒšg
> 
	mupd©eU¾M­
;

103 
´iv©e
 
	m»adRecÜdCouÁ
;

104 
´iv©e
 
	mš£¹RecÜdCouÁ
;

105 
´iv©e
 
	md–‘eRecÜdCouÁ
;

106 
´iv©e
 
	mupd©eRecÜdCouÁ
;

107 
´iv©e
 
Numb”G’”©Ü
 
	m»adKeyChoo£r
;

108 
´iv©e
 
Numb”G’”©Ü
 
	mš£¹KeyChoo£r
;

109 
´iv©e
 
Numb”G’”©Ü
 
	md–‘eKeyChoo£r
;

110 
´iv©e
 
Numb”G’”©Ü
 
	mupd©eKeyChoo£r
;

111 
´iv©e
 
Numb”G’”©Ü
 
	mf›ldËngthg’”©Ü
;

112 
´iv©e
 
Disü‘eG’”©Ü
 
	mİ”©iÚchoo£r
;

114 @
Ov”ride


115 
public
 
	$š™
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

117 
»adRecÜdCouÁ
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
READ_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(IÁeg”.
MAX_VALUE
)));

118 
š£¹RecÜdCouÁ
 = 
IÁeg”


119 .
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
INSERT_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
IÁeg”
.
MAX_VALUE
)));

120 
d–‘eRecÜdCouÁ
 = 
IÁeg”


121 .
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
DELETE_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
IÁeg”
.
MAX_VALUE
)));

122 
upd©eRecÜdCouÁ
 = 
IÁeg”


123 .
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
UPDATE_RECORD_COUNT_PROPERTY
, 
SŒšg
.
	`v®ueOf
(
IÁeg”
.
MAX_VALUE
)));

125 
»adU¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
READ_TRACE_FILE
, 
READ_TRACE_FILE_DEFAULT
), 
»adRecÜdCouÁ
);

126 
š£¹U¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
INSERT_TRACE_FILE
, 
INSERT_TRACE_FILE_DEFAULT
), 
š£¹RecÜdCouÁ
);

127 
d–‘eU¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
DELETE_TRACE_FILE
, 
DELETE_TRACE_FILE_DEFAULT
), 
d–‘eRecÜdCouÁ
);

128 
upd©eU¾M­
 = 
	`g‘T¿û
(
p
.
	`g‘Prİ”ty
(
UPDATE_TRACE_FILE
, 
UPDATE_TRACE_FILE_DEFAULT
), 
upd©eRecÜdCouÁ
);

130 
İ”©iÚchoo£r
 = 
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

133 
SŒšg
 
»que¡Di¡rib
 = 
p
.
	`g‘Prİ”ty
(
REQUEST_DISTRIBUTION_PROPERTY
, 
REQUEST_DISTRIBUTION_PROPERTY_DEFAULT
);

135 
»adZfcÚ¡ªt
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
READ_ZIPFIAN_CONSTANT
, 
READ_ZIPFIAN_CONSTANT_DEAFULT
));

136 
»adKeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
»adU¾M­
.
	`size
(), 
»adZfcÚ¡ªt
, 
p
);

137 
upd©eZfcÚ¡ªt
 = 
DoubË


138 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
UPDATE_ZIPFIAN_CONSTANT
, 
UPDATE_ZIPFIAN_CONSTANT_DEAFULT
));

139 
upd©eKeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
upd©eU¾M­
.
	`size
(), 
upd©eZfcÚ¡ªt
, 
p
);

140 
š£¹ZfcÚ¡ªt
 = 
DoubË


141 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
INSERT_ZIPFIAN_CONSTANT
, 
INSERT_ZIPFIAN_CONSTANT_DEAFULT
));

142 
š£¹KeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
š£¹U¾M­
.
	`size
(), 
š£¹ZfcÚ¡ªt
, 
p
);

143 
d–‘eZfcÚ¡ªt
 = 
DoubË


144 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
DELETE_ZIPFIAN_CONSTANT
, 
DELETE_ZIPFIAN_CONSTANT_DEAFULT
));

145 
d–‘eKeyChoo£r
 = 
	`g‘KeyChoo£r
(
»que¡Di¡rib
, 
d–‘eU¾M­
.
	`size
(), 
d–‘eZfcÚ¡ªt
, 
p
);

147 
f›ldËngthg’”©Ü
 = 
	`g‘F›ldL’gthG’”©Ü
(
p
);

150 
public
 
Disü‘eG’”©Ü
 
	$ü—‹O³¿tiÚG’”©Ü
(
fš®
 
Prİ”t›s
 
p
) {

152 
fš®
 
Disü‘eG’”©Ü
 
İ”©iÚChoo£r
 = 
CÜeWÜklßd
.
	`ü—‹O³¿tiÚG’”©Ü
(
p
);

154 
d–‘•rİÜtiÚ
 = 
DoubË


155 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
DELETE_PROPORTION_PROPERTY
, 
DELETE_PROPORTION_PROPERTY_DEFAULT
));

156 ià(
d–‘•rİÜtiÚ
 > 0) {

157 
İ”©iÚChoo£r
.
	`addV®ue
(
d–‘•rİÜtiÚ
, "DELETE");

159  
İ”©iÚChoo£r
;

160 
	}
}

162 
´iv©e
 
Numb”G’”©Ü
 
	$g‘KeyChoo£r
(
SŒšg
 
»que¡Di¡rib
, 
»cÜdCouÁ
, 
zfCÚÁ
,

163 
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

164 
Numb”G’”©Ü
 
keychoo£r
;

166 
»que¡Di¡rib
) {

168 
³rûÁe
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_PROPERTY
,

169 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_PERCENTILE_DEFAULT
));

170 
äac
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_PROPERTY
,

171 
ExpÚ’tŸlG’”©Ü
.
EXPONENTIAL_FRAC_DEFAULT
));

172 
keychoo£r
 = 
Ãw
 
	`ExpÚ’tŸlG’”©Ü
(
³rûÁe
, 
»cÜdCouÁ
 * 
äac
);

175 
keychoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(0, 
»cÜdCouÁ
 - 1);

178 
keychoo£r
 = 
Ãw
 
	`ZfŸnG’”©Ü
(
»cÜdCouÁ
, 
zfCÚÁ
);

181 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Latest„equest distribution is‚ot supported for RestWorkload.");

183 
hÙ£täaùiÚ
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_DATA_FRACTION
, 
HOTSPOT_DATA_FRACTION_DEFAULT
));

184 
hÙİnäaùiÚ
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
HOTSPOT_OPN_FRACTION
, 
HOTSPOT_OPN_FRACTION_DEFAULT
));

185 
keychoo£r
 = 
Ãw
 
	`HÙ¥ÙIÁeg”G’”©Ü
(0, 
»cÜdCouÁ
 - 1, 
hÙ£täaùiÚ
, 
hÙİnäaùiÚ
);

188 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀ»que¡ di¡ributiÚ \"" + 
»que¡Di¡rib
 + "\"");

190  
keychoo£r
;

191 
	}
}

193 
´Ùeùed
 
Numb”G’”©Ü
 
	$g‘F›ldL’gthG’”©Ü
(
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

195 
Numb”G’”©Ü
 
f›ldL’gthG’”©Ü
 = 
CÜeWÜklßd
.
	`g‘F›ldL’gthG’”©Ü
(
p
);

196 
SŒšg
 
f›ldËngthdi¡ributiÚ
 = 
p
.
	`g‘Prİ”ty
(
FIELD_LENGTH_DISTRIBUTION_PROPERTY
,

197 
FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

199 ià(
f›ldËngthdi¡ributiÚ
.
	`com·»To
("zipfian") == 0) {

200 
f›ldËngth
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
FIELD_LENGTH_PROPERTY
, 
FIELD_LENGTH_PROPERTY_DEFAULT
));

201 
š£¹sizezfcÚ¡ªt
 = 
DoubË


202 .
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
INSERT_SIZE_ZIPFIAN_CONSTANT
, 
INSERT_SIZE_ZIPFIAN_CONSTANT_DEAFULT
));

203 
f›ldL’gthG’”©Ü
 = 
Ãw
 
	`ZfŸnG’”©Ü
(1, 
f›ldËngth
, 
š£¹sizezfcÚ¡ªt
);

205  
f›ldL’gthG’”©Ü
;

206 
	}
}

211 
´iv©e
 
	gM­
<
	gIÁeg”
, 
	gSŒšg
> 
	$g‘T¿û
(
SŒšg
 
feP©h
, 
»cÜdCouÁ
)

212 
throws
 
WÜklßdExû±iÚ
 {

213 
M­
<
IÁeg”
, 
SŒšg
> 
u¾M­
 = 
Ãw
 
HashM­
<Integer, String>();

214 
couÁ
 = 0;

215 
SŒšg
 
lše
;

216 
Œy
 {

217 
FeR—d”
 
šputFe
 = 
Ãw
 
	`FeR—d”
(
feP©h
);

218 
Bufã»dR—d”
 
bufãrR—d”
 = 
Ãw
 
	`Bufã»dR—d”
(
šputFe
);

219 (
lše
 = 
bufãrR—d”
.
	`»adLše
()è!ğ
nuÎ
) {

220 
u¾M­
.
	`put
(
couÁ
++, 
lše
.
	`Œim
());

221 ià(
couÁ
 >ğ
»cÜdCouÁ
) {

225 
bufãrR—d”
.
	`şo£
();

226 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

227 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

229 + 
e
.
	`g‘LoÿlizedMes§ge
());

231  
u¾M­
;

232 
	}
}

237 @
Ov”ride


238 
public
 
boŞ—n
 
	$doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

239  
çl£
;

240 
	}
}

242 @
Ov”ride


243 
public
 
boŞ—n
 
	$doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

244 
SŒšg
 
İ”©iÚ
 = 
İ”©iÚchoo£r
.
	`ÃxtSŒšg
();

245 ià(
İ”©iÚ
 =ğ
nuÎ
) {

246  
çl£
;

249 
İ”©iÚ
) {

251 
	`doT¿n§ùiÚUpd©e
(
db
);

254 
	`doT¿n§ùiÚIn£¹
(
db
);

257 
	`doT¿n§ùiÚD–‘e
(
db
);

260 
	`doT¿n§ùiÚR—d
(
db
);

262  
Œue
;

263 
	}
}

268 
´iv©e
 
SŒšg
 
	$g‘NextURL
(
İTy³
) {

269 ià(
İTy³
 == 1) {

270  
»adU¾M­
.
	`g‘
(
»adKeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

271 } ià(
İTy³
 == 2) {

272  
š£¹U¾M­
.
	`g‘
(
š£¹KeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

273 } ià(
İTy³
 == 3) {

274  
d–‘eU¾M­
.
	`g‘
(
d–‘eKeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

276  
upd©eU¾M­
.
	`g‘
(
upd©eKeyChoo£r
.
	`ÃxtV®ue
().
	`štV®ue
());

278 
	}
}

280 @
Ov”ride


281 
public
 
	$doT¿n§ùiÚR—d
(
DB
 
db
) {

282 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
»suÉ
 = 
Ãw
 HashMap<String, ByteIterator>();

283 
db
.
	`»ad
(
nuÎ
, 
	`g‘NextURL
(1),‚uÎ, 
»suÉ
);

284 
	}
}

286 @
Ov”ride


287 
public
 
	$doT¿n§ùiÚIn£¹
(
DB
 
db
) {

288 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ue
 = 
Ãw
 HashMap<String, ByteIterator>();

290 
v®ue
.
	`put
("d©a", 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
()));

291 
db
.
	`š£¹
(
nuÎ
, 
	`g‘NextURL
(2), 
v®ue
);

292 
	}
}

294 
public
 
	$doT¿n§ùiÚD–‘e
(
DB
 
db
) {

295 
db
.
	`d–‘e
(
nuÎ
, 
	`g‘NextURL
(3));

296 
	}
}

298 @
Ov”ride


299 
public
 
	$doT¿n§ùiÚUpd©e
(
DB
 
db
) {

300 
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
> 
v®ue
 = 
Ãw
 HashMap<String, ByteIterator>();

302 
v®ue
.
	`put
("d©a", 
Ãw
 
	`RªdomBy‹I‹¿tÜ
(
f›ldËngthg’”©Ü
.
	`ÃxtV®ue
().
	`lÚgV®ue
()));

303 
db
.
	`upd©e
(
nuÎ
, 
	`g‘NextURL
(4), 
v®ue
);

304 
	}
}

	@workloads/TimeSeriesWorkload.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

19 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

24 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

25 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
impÜt
 
	gjava
.
	gut
.
	gT»eM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

32 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

34 
impÜt
 
	gs™e
.
	gycsb
.
	gNum”icBy‹I‹¿tÜ
;

35 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßd
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gDisü‘eG’”©Ü
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gG’”©Ü
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gHÙ¥ÙIÁeg”G’”©Ü
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gInüem’tšgPršbËSŒšgG’”©Ü
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gNumb”G’”©Ü
;

45 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gRªdomDisü‘eTime¡ampG’”©Ü
;

46 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gSüambËdZfŸnG’”©Ü
;

47 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gSequ’tŸlG’”©Ü
;

48 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnifÜmLÚgG’”©Ü
;

49 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnixEpochTime¡ampG’”©Ü
;

50 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gZfŸnG’”©Ü
;

51 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

284 
public
 cÏs 
	cTimeS”›sWÜklßd
 
ex‹nds
 
	mWÜklßd
 {

289 
public
 
	eV®ueTy³
 {

290 
INTEGERS
("integers"),

291 
FLOATS
("floats"),

292 
MIXED
("mixednumbers");

294 
´Ùeùed
 
fš®
 
SŒšg
 
	mÇme
;

296 
V®ueTy³
(
fš®
 
SŒšg
 
Çme
) {

297 
	mthis
.
	mÇme
 = 
Çme
;

300 
public
 
V®ueTy³
 
äomSŒšg
(
fš®
 
SŒšg
 
Çme
) {

301 
fš®
 
V®ueTy³
 
	mty³
 : V®ueTy³.
v®ues
()) {

302 ià(
ty³
.
Çme
.
equ®sIgnÜeCa£
(name)) {

303  
ty³
;

306 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("UÄecognizedy³: " + 
Çme
);

311 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_KEY_PROPERTY
 = "timestampkey";

312 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_KEY_PROPERTY_DEFAULT
 = "YCSBTS";

315 
public
 
fš®
 
SŒšg
 
	gVALUE_KEY_PROPERTY
 = "valuekey";

316 
public
 
fš®
 
SŒšg
 
	gVALUE_KEY_PROPERTY_DEFAULT
 = "YCSBV";

319 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_INTERVAL_PROPERTY
 = "timestampinterval";

320 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_INTERVAL_PROPERTY_DEFAULT
 = "60";

323 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_UNITS_PROPERTY
 = "timestampunits";

324 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_UNITS_PROPERTY_DEFAULT
 = "SECONDS";

327 
public
 
fš®
 
SŒšg
 
	gTAG_COUNT_PROPERTY
 = "tagcount";

328 
public
 
fš®
 
SŒšg
 
	gTAG_COUNT_PROPERTY_DEFAULT
 = "4";

331 
public
 
fš®
 
SŒšg
 
	gTAG_CARDINALITY_PROPERTY
 = "tagcardinality";

332 
public
 
fš®
 
SŒšg
 
	gTAG_CARDINALITY_PROPERTY_DEFAULT
 = "1, 2, 4, 8";

335 
public
 
fš®
 
SŒšg
 
	gTAG_KEY_LENGTH_PROPERTY
 = "tagkeylength";

336 
public
 
fš®
 
SŒšg
 
	gTAG_KEY_LENGTH_PROPERTY_DEFAULT
 = "8";

339 
public
 
fš®
 
SŒšg
 
	gTAG_VALUE_LENGTH_PROPERTY
 = "tagvaluelength";

340 
public
 
fš®
 
SŒšg
 
	gTAG_VALUE_LENGTH_PROPERTY_DEFAULT
 = "8";

343 
public
 
fš®
 
SŒšg
 
	gPAIR_DELIMITER_PROPERTY
 = "tagpairdelimiter";

344 
public
 
fš®
 
SŒšg
 
	gPAIR_DELIMITER_PROPERTY_DEFAULT
 = "=";

347 
public
 
fš®
 
SŒšg
 
	gDELETE_DELIMITER_PROPERTY
 = "deletedelimiter";

348 
public
 
fš®
 
SŒšg
 
	gDELETE_DELIMITER_PROPERTY_DEFAULT
 = ":";

351 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESTAMP_ORDER_PROPERTY
 = "randomwritetimestamporder";

352 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESTAMP_ORDER_PROPERTY_DEFAULT
 = "false";

355 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESERIES_ORDER_PROPERTY
 = "randomtimeseriesorder";

356 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESERIES_ORDER_PROPERTY_DEFAULT
 = "true";

359 
public
 
fš®
 
SŒšg
 
	gVALUE_TYPE_PROPERTY
 = "valuetype";

360 
public
 
fš®
 
SŒšg
 
	gVALUE_TYPE_PROPERTY_DEFAULT
 = "floats";

363 
public
 
fš®
 
SŒšg
 
	gSPARSITY_PROPERTY
 = "sparsity";

364 
public
 
fš®
 
SŒšg
 
	gSPARSITY_PROPERTY_DEFAULT
 = "0.00";

367 
public
 
fš®
 
SŒšg
 
	gDELAYED_SERIES_PROPERTY
 = "delayedseries";

368 
public
 
fš®
 
SŒšg
 
	gDELAYED_SERIES_PROPERTY_DEFAULT
 = "0.10";

371 
public
 
fš®
 
SŒšg
 
	gDELAYED_INTERVALS_PROPERTY
 = "delayedintervals";

372 
public
 
fš®
 
SŒšg
 
	gDELAYED_INTERVALS_PROPERTY_DEFAULT
 = "5";

375 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_PROPERTY
 = "querytimespan";

376 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_PROPERTY_DEFAULT
 = "0";

379 
public
 
fš®
 
SŒšg
 
	gQUERY_RANDOM_TIMESPAN_PROPERTY
 = "queryrandomtimespan";

380 
public
 
fš®
 
SŒšg
 
	gQUERY_RANDOM_TIMESPAN_PROPERTY_DEFAULT
 = "false";

383 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_DELIMITER_PROPERTY
 = "querytimespandelimiter";

384 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
 = ",";

387 
public
 
fš®
 
SŒšg
 
	gGROUPBY_KEY_PROPERTY
 = "groupbykey";

388 
public
 
fš®
 
SŒšg
 
	gGROUPBY_KEY_PROPERTY_DEFAULT
 = "YCSBGB";

391 
public
 
fš®
 
SŒšg
 
	gGROUPBY_PROPERTY
 = "groupbyfunction";

394 
public
 
fš®
 
SŒšg
 
	gGROUPBY_KEYS_PROPERTY
 = "groupbykeys";

397 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_KEY_PROPERTY
 = "downsamplingkey";

398 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_KEY_PROPERTY_DEFAULT
 = "YCSBDS";

401 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_FUNCTION_PROPERTY
 = "downsamplingfunction";

404 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_INTERVAL_PROPERTY
 = "downsamplinginterval";

407 
´Ùeùed
 
Prİ”t›s
 
	g´İ”t›s
;

410 
´Ùeùed
 
	gG’”©Ü
<
	gSŒšg
> 
	gkeyG’”©Ü
;

411 
´Ùeùed
 
	gG’”©Ü
<
	gSŒšg
> 
	ggKeyG’”©Ü
;

412 
´Ùeùed
 
	gG’”©Ü
<
	gSŒšg
> 
	ggV®ueG’”©Ü
;

415 
´Ùeùed
 
SŒšg
 
	gtime¡ampKey
;

418 
´Ùeùed
 
SŒšg
 
	gv®ueKey
;

421 
´Ùeùed
 
	gtime¡ampIÁ”v®
;

424 
´Ùeùed
 
TimeUn™
 
	gtimeUn™s
;

427 
´Ùeùed
 
boŞ—n
 
	g¿ndomizeTime¡ampOrd”
;

431 
´Ùeùed
 
boŞ—n
 
	g¿ndomizeTime£r›sOrd”
;

434 
´Ùeùed
 
V®ueTy³
 
	gv®ueTy³
;

437 
´Ùeùed
 [] 
	gcumuÏtiveC¬dš®™y
;

440 
´Ùeùed
 
	gtÙ®C¬dš®™y
;

444 
´Ùeùed
 
	g³rKeyC¬dš®™y
;

447 
´Ùeùed
 
Numb”G’”©Ü
 
	gsÿÆ’gth
;

450 
´Ùeùed
 
Numb”G’”©Ü
 
	gkeychoo£r
;

453 
´Ùeùed
 
Disü‘eG’”©Ü
 
	gİ”©iÚchoo£r
;

457 
´Ùeùed
 
	gmaxOff£ts
;

460 
´Ùeùed
 
	g»cÜdcouÁ
;

463 
´Ùeùed
 
	ggPaœs
;

466 
´Ùeùed
 
SŒšg
 
	gbË
;

469 
´Ùeùed
 
	gnumKeys
;

472 
´Ùeùed
 
	gSŒšg
[] 
	gkeys
;

475 
´Ùeùed
 
	gSŒšg
[] 
	ggKeys
;

478 
´Ùeùed
 
	gSŒšg
[] 
	ggV®ues
;

481 
´Ùeùed
 [] 
	ggC¬dš®™y
;

484 
´Ùeùed
 
	gfœ¡Inüem’bËC¬dš®™y
;

487 
´Ùeùed
 
	g¥¬s™y
;

490 
´Ùeùed
 
	gd–ayedS”›s
;

493 
´Ùeùed
 
	gd–ayedIÁ”v®s
;

496 
´Ùeùed
 
	gqu”yTimeS·n
;

500 
´Ùeùed
 
boŞ—n
 
	gqu”yRªdomTimeS·n
;

503 
´Ùeùed
 
SŒšg
 
	ggPaœD–im™”
;

506 
´Ùeùed
 
SŒšg
 
	gd–‘eD–im™”
;

509 
´Ùeùed
 
SŒšg
 
	gqu”yTimeS·nD–im™”
;

512 
´Ùeùed
 
boŞ—n
 
	ggroupBy
;

515 
´Ùeùed
 
SŒšg
 
	ggroupByKey
;

518 
´Ùeùed
 
SŒšg
 
	ggroupByFunùiÚ
;

521 
´Ùeùed
 
	gboŞ—n
[] 
	ggroupBys
;

524 
´Ùeùed
 
boŞ—n
 
	gdown§m¶e
;

527 
´Ùeùed
 
SŒšg
 
	gdown§m¶eKey
;

530 
´Ùeùed
 
SŒšg
 
	gdown§m¶eFunùiÚ
;

533 
´Ùeùed
 
	gdown§m¶eIÁ”v®
;

539 
´Ùeùed
 
boŞ—n
 
	gd©aš‹gr™y
;

542 
´Ùeùed
 
M—su»m’ts
 
	gm—su»m’ts
 = M—su»m’ts.
g‘M—su»m’ts
();

544 @
Ov”ride


545 
public
 
	$š™
(
fš®
 
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

546 
´İ”t›s
 = 
p
;

547 
»cÜdcouÁ
 =

548 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
,

549 
Cl›Á
.
DEFAULT_RECORD_COUNT
));

550 ià(
»cÜdcouÁ
 == 0) {

551 
»cÜdcouÁ
 = 
IÁeg”
.
MAX_VALUE
;

553 
time¡ampKey
 = 
p
.
	`g‘Prİ”ty
(
TIMESTAMP_KEY_PROPERTY
, 
TIMESTAMP_KEY_PROPERTY_DEFAULT
);

554 
v®ueKey
 = 
p
.
	`g‘Prİ”ty
(
VALUE_KEY_PROPERTY
, 
VALUE_KEY_PROPERTY_DEFAULT
);

555 
İ”©iÚchoo£r
 = 
CÜeWÜklßd
.
	`ü—‹O³¿tiÚG’”©Ü
(
´İ”t›s
);

557 
fš®
 
maxsÿÆ’gth
 =

558 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
MAX_SCAN_LENGTH_PROPERTY
,

559 
CÜeWÜklßd
.
MAX_SCAN_LENGTH_PROPERTY_DEFAULT
));

560 
SŒšg
 
sÿÆ’gthdi¡rib
 =

561 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
SCAN_LENGTH_DISTRIBUTION_PROPERTY
,

562 
CÜeWÜklßd
.
SCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

564 ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("uniform") == 0) {

565 
sÿÆ’gth
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(1, 
maxsÿÆ’gth
);

566 } ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("zipfian") == 0) {

567 
sÿÆ’gth
 = 
Ãw
 
	`ZfŸnG’”©Ü
(1, 
maxsÿÆ’gth
);

569 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

570 "Di¡ributiÚ \"" + 
sÿÆ’gthdi¡rib
 + "\"‚ot‡llowed for scan†ength");

573 
¿ndomizeTime¡ampOrd”
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
p
.
	`g‘Prİ”ty
(

574 
RANDOMIZE_TIMESTAMP_ORDER_PROPERTY
,

575 
RANDOMIZE_TIMESTAMP_ORDER_PROPERTY_DEFAULT
));

576 
¿ndomizeTime£r›sOrd”
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
p
.
	`g‘Prİ”ty
(

577 
RANDOMIZE_TIMESERIES_ORDER_PROPERTY
,

578 
RANDOMIZE_TIMESERIES_ORDER_PROPERTY_DEFAULT
));

581 
numKeys
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
,

582 
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY_DEFAULT
));

583 
gPaœs
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
TAG_COUNT_PROPERTY
,

584 
TAG_COUNT_PROPERTY_DEFAULT
));

585 
¥¬s™y
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
SPARSITY_PROPERTY
, 
SPARSITY_PROPERTY_DEFAULT
));

586 
gC¬dš®™y
 = 
Ãw
 [
gPaœs
];

588 
fš®
 
SŒšg
 
»que¡di¡rib
 =

589 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
REQUEST_DISTRIBUTION_PROPERTY
,

590 
CÜeWÜklßd
.
REQUEST_DISTRIBUTION_PROPERTY_DEFAULT
);

591 ià(
»que¡di¡rib
.
	`com·»To
("uniform") == 0) {

592 
keychoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(0, 
numKeys
 - 1);

593 } ià(
»que¡di¡rib
.
	`com·»To
("sequential") == 0) {

594 
keychoo£r
 = 
Ãw
 
	`Sequ’tŸlG’”©Ü
(0, 
numKeys
 - 1);

595 } ià(
»que¡di¡rib
.
	`com·»To
("zipfian") == 0) {

596 
keychoo£r
 = 
Ãw
 
	`SüambËdZfŸnG’”©Ü
(0, 
numKeys
 - 1);

599 } ià(
»que¡di¡rib
.
	`equ®s
("hotspot")) {

600 
hÙ£täaùiÚ
 =

601 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
HOTSPOT_DATA_FRACTION
,

602 
CÜeWÜklßd
.
HOTSPOT_DATA_FRACTION_DEFAULT
));

603 
hÙİnäaùiÚ
 =

604 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
HOTSPOT_OPN_FRACTION
,

605 
CÜeWÜklßd
.
HOTSPOT_OPN_FRACTION_DEFAULT
));

606 
keychoo£r
 = 
Ãw
 
	`HÙ¥ÙIÁeg”G’”©Ü
(0, 
numKeys
 - 1,

607 
hÙ£täaùiÚ
, 
hÙİnäaùiÚ
);

609 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀ»que¡ di¡ributiÚ \"" + 
»que¡di¡rib
 + "\"");

613 
Œy
 {

614 
time¡ampIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(

615 
TIMESTAMP_INTERVAL_PROPERTY
, 
TIMESTAMP_INTERVAL_PROPERTY_DEFAULT
));

616 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

617 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Unableo…arsehe " +

618 
TIMESTAMP_INTERVAL_PROPERTY
, 
nã
);

621 
Œy
 {

622 
timeUn™s
 = 
TimeUn™
.
	`v®ueOf
(
p
.
	`g‘Prİ”ty
(
TIMESTAMP_UNITS_PROPERTY
,

623 
TIMESTAMP_UNITS_PROPERTY_DEFAULT
).
	`toUµ”Ca£
());

624 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

625 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀtimun™y³", 
e
);

627 ià(
timeUn™s
 =ğ
TimeUn™
.
NANOSECONDS
 ||imeUn™ =ğTimeUn™.
MICROSECONDS
) {

628 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("YCSB dÛ¢'ˆsuµÜˆ" + 
timeUn™s
 +

632 
gPaœD–im™”
 = 
p
.
	`g‘Prİ”ty
(
PAIR_DELIMITER_PROPERTY
, 
PAIR_DELIMITER_PROPERTY_DEFAULT
);

633 
d–‘eD–im™”
 = 
p
.
	`g‘Prİ”ty
(
DELETE_DELIMITER_PROPERTY
, 
DELETE_DELIMITER_PROPERTY_DEFAULT
);

634 
d©aš‹gr™y
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

635 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
DATA_INTEGRITY_PROPERTY
,

636 
CÜeWÜklßd
.
DATA_INTEGRITY_PROPERTY_DEFAULT
));

637 ià(
d©aš‹gr™y
) {

638 
Sy¡em
.
out
.
	`´šn
("Data integrity isƒnabled.");

641 
qu”yTimeS·n
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
QUERY_TIMESPAN_PROPERTY
,

642 
QUERY_TIMESPAN_PROPERTY_DEFAULT
));

643 
qu”yRªdomTimeS·n
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
p
.
	`g‘Prİ”ty
(
QUERY_RANDOM_TIMESPAN_PROPERTY
,

644 
QUERY_RANDOM_TIMESPAN_PROPERTY_DEFAULT
));

645 
qu”yTimeS·nD–im™”
 = 
p
.
	`g‘Prİ”ty
(
QUERY_TIMESPAN_DELIMITER_PROPERTY
,

646 
QUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
);

648 
groupByKey
 = 
p
.
	`g‘Prİ”ty
(
GROUPBY_KEY_PROPERTY
, 
GROUPBY_KEY_PROPERTY_DEFAULT
);

649 
groupByFunùiÚ
 = 
p
.
	`g‘Prİ”ty
(
GROUPBY_PROPERTY
);

650 ià(
groupByFunùiÚ
 !ğ
nuÎ
 && !groupByFunùiÚ.
	`isEm±y
()) {

651 
fš®
 
SŒšg
 
groupByKeys
 = 
p
.
	`g‘Prİ”ty
(
GROUPBY_KEYS_PROPERTY
);

652 ià(
groupByKeys
 =ğ
nuÎ
 || groupByKeys.
	`isEm±y
()) {

653 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Group by wasƒnabled but‚o keys were specified.");

655 
fš®
 
SŒšg
[] 
gbKeys
 = 
groupByKeys
.
	`¥l™
(",");

656 ià(
gbKeys
.
Ëngth
 !ğ
gKeys
.length) {

657 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("OÆy " + 
gbKeys
.
Ëngth
 + " group by keys "

658 + "w”¥ecif›d buˆth”w”" + 
gKeys
.
Ëngth
 + "ag keys given.");

660 
groupBys
 = 
Ãw
 
boŞ—n
[
gbKeys
.
Ëngth
];

661 
i
 = 0; i < 
gbKeys
.
Ëngth
; i++) {

662 
groupBys
[
i
] = 
IÁeg”
.
	`·r£IÁ
(
gbKeys
[i].
	`Œim
()è=ğ0 ? 
çl£
 : 
Œue
;

664 
groupBy
 = 
Œue
;

667 
down§m¶eKey
 = 
p
.
	`g‘Prİ”ty
(
DOWNSAMPLING_KEY_PROPERTY
, 
DOWNSAMPLING_KEY_PROPERTY_DEFAULT
);

668 
down§m¶eFunùiÚ
 = 
p
.
	`g‘Prİ”ty
(
DOWNSAMPLING_FUNCTION_PROPERTY
);

669 ià(
down§m¶eFunùiÚ
 !ğ
nuÎ
 && !down§m¶eFunùiÚ.
	`isEm±y
()) {

670 
fš®
 
SŒšg
 
š‹rv®
 = 
p
.
	`g‘Prİ”ty
(
DOWNSAMPLING_INTERVAL_PROPERTY
);

671 ià(
š‹rv®
 =ğ
nuÎ
 || iÁ”v®.
	`isEm±y
()) {

672 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("'" + 
DOWNSAMPLING_INTERVAL_PROPERTY
 + "' was missing despite '"

673 + 
DOWNSAMPLING_FUNCTION_PROPERTY
 + "' being set.");

675 
down§m¶eIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
š‹rv®
);

676 
down§m¶e
 = 
Œue
;

679 
d–ayedS”›s
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
DELAYED_SERIES_PROPERTY
, 
DELAYED_SERIES_PROPERTY_DEFAULT
));

680 
d–ayedIÁ”v®s
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
DELAYED_INTERVALS_PROPERTY
, 
DELAYED_INTERVALS_PROPERTY_DEFAULT
));

682 
v®ueTy³
 = 
V®ueTy³
.
	`äomSŒšg
(
p
.
	`g‘Prİ”ty
(
VALUE_TYPE_PROPERTY
, 
VALUE_TYPE_PROPERTY_DEFAULT
));

683 
bË
 = 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, CÜeWÜklßd.
TABLENAME_PROPERTY_DEFAULT
);

684 
	`š™KeysAndTags
();

685 
	`v®id©eS‘tšgs
();

686 
	}
}

688 @
Ov”ride


689 
public
 
Objeù
 
	$š™Th»ad
(
Prİ”t›s
 
p
, 
myth»adid
, 
th»adcouÁ
è
throws
 
WÜklßdExû±iÚ
 {

690 ià(
´İ”t›s
 =ğ
nuÎ
) {

691 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Workload has‚ot been initialized.");

693  
Ãw
 
	`Th»adS‹
(
myth»adid
, 
th»adcouÁ
);

694 
	}
}

696 @
Ov”ride


697 
public
 
boŞ—n
 
	$doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

698 ià(
th»ad¡©e
 =ğ
nuÎ
) {

699 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Missinghread state.");

701 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
gs
 = 
Ãw
 
T»eM­
<String, ByteIterator>();

702 
fš®
 
SŒšg
 
key
 = ((
Th»adS‹
)
th»ad¡©e
).
	`ÃxtD©aPošt
(
gs
, 
Œue
);

703 ià(
db
.
	`š£¹
(
bË
, 
key
, 
gs
è=ğ
Stus
.
OK
) {

704  
Œue
;

706  
çl£
;

707 
	}
}

709 @
Ov”ride


710 
public
 
boŞ—n
 
	$doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

711 ià(
th»ad¡©e
 =ğ
nuÎ
) {

712 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Missinghread state.");

714 
İ”©iÚchoo£r
.
	`ÃxtSŒšg
()) {

716 
	`doT¿n§ùiÚR—d
(
db
, 
th»ad¡©e
);

719 
	`doT¿n§ùiÚUpd©e
(
db
, 
th»ad¡©e
);

722 
	`doT¿n§ùiÚIn£¹
(
db
, 
th»ad¡©e
);

725 
	`doT¿n§ùiÚSÿn
(
db
, 
th»ad¡©e
);

728 
	`doT¿n§ùiÚD–‘e
(
db
, 
th»ad¡©e
);

731  
çl£
;

733  
Œue
;

734 
	}
}

736 
´Ùeùed
 
	$doT¿n§ùiÚR—d
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

737 
fš®
 
Th»adS‹
 
¡©e
 = (Th»adS‹è
th»ad¡©e
;

738 
fš®
 
SŒšg
 
keyÇme
 = 
keys
[
keychoo£r
.
	`ÃxtV®ue
().
	`štV®ue
()];

739 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

740 
off£ts
 = 
¡©e
.
qu”yOff£tG’”©Ü
.
	`ÃxtV®ue
().
	`štV®ue
();

742 
fš®
 
¡¬tTime¡amp
;

743 ià(
off£ts
 > 0) {

744 
¡¬tTime¡amp
 = 
¡©e
.¡¬tTime¡am°+ s‹.
time¡ampG’”©Ü
.
	`g‘Off£t
(
off£ts
);

746 
¡¬tTime¡amp
 = 
¡©e
.startTimestamp;

750 
S‘
<
SŒšg
> 
f›lds
 = 
Ãw
 
HashS‘
<String>();

751 
i
 = 0; i < 
gPaœs
; ++i) {

752 ià(
groupBy
 && 
groupBys
[
i
]) {

753 
f›lds
.
	`add
(
gKeys
[
i
]);

755 
f›lds
.
	`add
(
gKeys
[
i
] + 
gPaœD–im™”
 +

756 
gV®ues
[
¿ndom
.
	`ÃxtIÁ
(
gC¬dš®™y
[
i
])]);

760 ià(
qu”yTimeS·n
 > 0) {

761 
fš®
 
’dTime¡amp
;

762 ià(
qu”yRªdomTimeS·n
) {

763 
’dTime¡amp
 = 
¡¬tTime¡amp
 + (
time¡ampIÁ”v®
 * 
¿ndom
.
	`ÃxtIÁ
(
qu”yTimeS·n
 /imestampInterval));

765 
’dTime¡amp
 = 
¡¬tTime¡amp
 + 
qu”yTimeS·n
;

767 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
 + 
qu”yTimeS·nD–im™”
 + 
’dTime¡amp
);

769 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
);

771 ià(
groupBy
) {

772 
f›lds
.
	`add
(
groupByKey
 + 
gPaœD–im™”
 + 
groupByFunùiÚ
);

774 ià(
down§m¶e
) {

775 
f›lds
.
	`add
(
down§m¶eKey
 + 
gPaœD–im™”
 + 
down§m¶eFunùiÚ
 + 
down§m¶eIÁ”v®
);

778 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 
HashM­
<String, ByteIterator>();

779 
fš®
 
Stus
 
¡©us
 = 
db
.
	`»ad
(
bË
, 
keyÇme
, 
f›lds
, 
ûÎs
);

781 ià(
d©aš‹gr™y
 && 
¡©us
 =ğ
Stus
.
OK
) {

782 
	`v”ifyRow
(
keyÇme
, 
ûÎs
);

784 
	}
}

786 
´Ùeùed
 
	$doT¿n§ùiÚUpd©e
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

787 ià(
th»ad¡©e
 =ğ
nuÎ
) {

788 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Missinghread state.");

790 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
gs
 = 
Ãw
 
T»eM­
<String, ByteIterator>();

791 
fš®
 
SŒšg
 
key
 = ((
Th»adS‹
)
th»ad¡©e
).
	`ÃxtD©aPošt
(
gs
, 
çl£
);

792 
db
.
	`upd©e
(
bË
, 
key
, 
gs
);

793 
	}
}

795 
´Ùeùed
 
	$doT¿n§ùiÚIn£¹
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

796 
	`doIn£¹
(
db
, 
th»ad¡©e
);

797 
	}
}

799 
´Ùeùed
 
	$doT¿n§ùiÚSÿn
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

800 
fš®
 
Th»adS‹
 
¡©e
 = (Th»adS‹è
th»ad¡©e
;

801 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

802 
fš®
 
SŒšg
 
keyÇme
 = 
keys
[
¿ndom
.
	`ÃxtIÁ
(keys.
Ëngth
)];

805 
Ën
 = 
sÿÆ’gth
.
	`ÃxtV®ue
().
	`štV®ue
();

807 
off£ts
 = 
¿ndom
.
	`ÃxtIÁ
(
maxOff£ts
 - 1);

808 
fš®
 
¡¬tTime¡amp
;

809 ià(
off£ts
 > 0) {

810 
¡¬tTime¡amp
 = 
¡©e
.¡¬tTime¡am°+ s‹.
time¡ampG’”©Ü
.
	`g‘Off£t
(
off£ts
);

812 
¡¬tTime¡amp
 = 
¡©e
.startTimestamp;

816 
S‘
<
SŒšg
> 
f›lds
 = 
Ãw
 
HashS‘
<String>();

817 
i
 = 0; i < 
gPaœs
; ++i) {

818 ià(
groupBy
 && 
groupBys
[
i
]) {

819 
f›lds
.
	`add
(
gKeys
[
i
]);

821 
f›lds
.
	`add
(
gKeys
[
i
] + 
gPaœD–im™”
 +

822 
gV®ues
[
¿ndom
.
	`ÃxtIÁ
(
gC¬dš®™y
[
i
])]);

826 ià(
qu”yTimeS·n
 > 0) {

827 
fš®
 
’dTime¡amp
;

828 ià(
qu”yRªdomTimeS·n
) {

829 
’dTime¡amp
 = 
¡¬tTime¡amp
 + (
time¡ampIÁ”v®
 * 
¿ndom
.
	`ÃxtIÁ
(
qu”yTimeS·n
 /imestampInterval));

831 
’dTime¡amp
 = 
¡¬tTime¡amp
 + 
qu”yTimeS·n
;

833 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
 + 
qu”yTimeS·nD–im™”
 + 
’dTime¡amp
);

835 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
);

837 ià(
groupBy
) {

838 
f›lds
.
	`add
(
groupByKey
 + 
gPaœD–im™”
 + 
groupByFunùiÚ
);

840 ià(
down§m¶e
) {

841 
f›lds
.
	`add
(
down§m¶eKey
 + 
gPaœD–im™”
 + 
down§m¶eFunùiÚ
 +agPaœD–im™” + 
down§m¶eIÁ”v®
);

844 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉs
 = 
Ãw
 Vector<HashMap<String, ByteIterator>>();

845 
db
.
	`sÿn
(
bË
, 
keyÇme
, 
Ën
, 
f›lds
, 
»suÉs
);

846 
	}
}

848 
´Ùeùed
 
	$doT¿n§ùiÚD–‘e
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

849 
fš®
 
Th»adS‹
 
¡©e
 = (Th»adS‹è
th»ad¡©e
;

850 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

851 
fš®
 
SŒšgBud”
 
buf
 = 
Ãw
 
	`SŒšgBud”
().
	`­³nd
(
keys
[
¿ndom
.
	`ÃxtIÁ
(keys.
Ëngth
)]);

853 
off£ts
 = 
¿ndom
.
	`ÃxtIÁ
(
maxOff£ts
 - 1);

854 
fš®
 
¡¬tTime¡amp
;

855 ià(
off£ts
 > 0) {

856 
¡¬tTime¡amp
 = 
¡©e
.¡¬tTime¡am°+ s‹.
time¡ampG’”©Ü
.
	`g‘Off£t
(
off£ts
);

858 
¡¬tTime¡amp
 = 
¡©e
.startTimestamp;

862 
i
 = 0; i < 
gPaœs
; ++i) {

863 ià(
groupBy
 && 
groupBys
[
i
]) {

864 
buf
.
	`­³nd
(
d–‘eD–im™”
)

865 .
	`­³nd
(
gKeys
[
i
]);

867 
buf
.
	`­³nd
(
d–‘eD–im™”
).­³nd(
gKeys
[
i
] + 
gPaœD–im™”
 +

868 
gV®ues
[
¿ndom
.
	`ÃxtIÁ
(
gC¬dš®™y
[
i
])]);

872 ià(
qu”yTimeS·n
 > 0) {

873 
fš®
 
’dTime¡amp
;

874 ià(
qu”yRªdomTimeS·n
) {

875 
’dTime¡amp
 = 
¡¬tTime¡amp
 + (
time¡ampIÁ”v®
 * 
¿ndom
.
	`ÃxtIÁ
(
qu”yTimeS·n
 /imestampInterval));

877 
’dTime¡amp
 = 
¡¬tTime¡amp
 + 
qu”yTimeS·n
;

879 
buf
.
	`­³nd
(
d–‘eD–im™”
)

880 .
	`­³nd
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
 + 
qu”yTimeS·nD–im™”
 + 
’dTime¡amp
);

882 
buf
.
	`­³nd
(
d–‘eD–im™”
)

883 .
	`­³nd
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
);

886 
db
.
	`d–‘e
(
bË
, 
buf
.
	`toSŒšg
());

887 
	}
}

898 
´Ùeùed
 
Stus
 
v”ifyRow
(
fš®
 
SŒšg
 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
ûÎs
) {

899 
Stus
 
	gv”ifyStus
 = Stus.
UNEXPECTED_STATE
;

900 
	g¡¬tTime
 = 
Sy¡em
.
ÇnoTime
();

902 
	gv®ue
 = 0;

903 
	gtime¡amp
 = 0;

904 
fš®
 
	gT»eM­
<
	gSŒšg
, SŒšg> 
	gv®id©iÚTags
 = 
Ãw
 
T»eM­
<
SŒšg
, String>();

905 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
ûÎs
.
’ŒyS‘
()) {

906 ià(
’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

907 
fš®
 
Num”icBy‹I‹¿tÜ
 
™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

908 
	gtime¡amp
 = 
™
.
g‘LÚg
();

909 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

910 
fš®
 
Num”icBy‹I‹¿tÜ
 
	g™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

911 
	gv®ue
 = 
™
.
isFlßtšgPošt
(è? it.
g‘DoubË
(è: it.
g‘LÚg
();

913 
	gv®id©iÚTags
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

917 ià(
v®id©iÚFunùiÚ
(
key
, 
time¡amp
, 
v®id©iÚTags
è=ğ
v®ue
) {

918 
v”ifyStus
 = 
Stus
.
OK
;

920 
	g’dTime
 = 
Sy¡em
.
ÇnoTime
();

921 
	gm—su»m’ts
.
m—su»
("VERIFY", (è(
’dTime
 - 
¡¬tTime
) / 1000);

922 
	gm—su»m’ts
.
»pÜtStus
("VERIFY", 
v”ifyStus
);

923  
	gv”ifyStus
;

935 
´Ùeùed
 
v®id©iÚFunùiÚ
(
fš®
 
SŒšg
 
key
, fš® 
time¡amp
,

936 
fš®
 
T»eM­
<
SŒšg
, SŒšg> 
gs
) {

937 
fš®
 
SŒšgBud”
 
	gv®id©iÚBufãr
 = 
Ãw
 SŒšgBud”(
keys
[0].
Ëngth
() +

938 (
gPaœs
 * 
gKeys
[0].
Ëngth
()è+ (gPaœ * 
gC¬dš®™y
[1]));

939 
fš®
 
	gEÁry
<
	gSŒšg
, SŒšg> 
	g·œ
 : 
gs
.
’ŒyS‘
()) {

940 
v®id©iÚBufãr
.
­³nd
(
·œ
.
g‘Key
()).­³ndÕaœ.
g‘V®ue
());

942  (è
	gv®id©iÚBufãr
.
toSŒšg
().
hashCode
(è^ 
	gtime¡amp
;

950 
´Ùeùed
 
	$š™KeysAndTags
(è
throws
 
WÜklßdExû±iÚ
 {

951 
fš®
 
keyL’gth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

952 
CÜeWÜklßd
.
FIELD_LENGTH_PROPERTY
,

953 
CÜeWÜklßd
.
FIELD_LENGTH_PROPERTY_DEFAULT
));

954 
fš®
 
gKeyL’gth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

955 
TAG_KEY_LENGTH_PROPERTY
, 
TAG_KEY_LENGTH_PROPERTY_DEFAULT
));

956 
fš®
 
gV®ueL’gth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

957 
TAG_VALUE_LENGTH_PROPERTY
, 
TAG_VALUE_LENGTH_PROPERTY_DEFAULT
));

959 
keyG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
keyL’gth
);

960 
gKeyG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
gKeyL’gth
);

961 
gV®ueG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
gV®ueL’gth
);

963 
fš®
 
th»ads
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
Cl›Á
.
THREAD_COUNT_PROPERTY
, "1"));

964 
fš®
 
SŒšg
 
gC¬dš®™ySŒšg
 = 
´İ”t›s
.
	`g‘Prİ”ty
(

965 
TAG_CARDINALITY_PROPERTY
,

966 
TAG_CARDINALITY_PROPERTY_DEFAULT
);

967 
fš®
 
SŒšg
[] 
gC¬dš®™yP¬ts
 = 
gC¬dš®™ySŒšg
.
	`¥l™
(",");

968 
idx
 = 0;

969 
tÙ®C¬dš®™y
 = 
numKeys
;

970 
³rKeyC¬dš®™y
 = 1;

971 
maxC¬dš®™y
 = 0;

972 
fš®
 
SŒšg
 
ÿrd
 : 
gC¬dš®™yP¬ts
) {

973 
Œy
 {

974 
gC¬dš®™y
[
idx
] = 
IÁeg”
.
	`·r£IÁ
(
ÿrd
.
	`Œim
());

975 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

976 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Unableo…arse cardinality: " +

977 
ÿrd
, 
nã
);

979 ià(
gC¬dš®™y
[
idx
] < 1) {

980 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Cardinality must be greaterhan zero: " +

981 
gC¬dš®™y
[
idx
]);

983 
tÙ®C¬dš®™y
 *ğ
gC¬dš®™y
[
idx
];

984 
³rKeyC¬dš®™y
 *ğ
gC¬dš®™y
[
idx
];

985 ià(
gC¬dš®™y
[
idx
] > 
maxC¬dš®™y
) {

986 
maxC¬dš®™y
 = 
gC¬dš®™y
[
idx
];

988 ++
idx
;

989 ià(
idx
 >ğ
gPaœs
) {

994 ià(
numKeys
 < 
th»ads
) {

995 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("F›ld couÁ " + 
numKeys
 + " (keys forime "

997 + "th»ad " + 
th»ads
);

1001 ià(
idx
 < 
gPaœs
) {

1002 
gC¬dš®™y
[
idx
++] = 1;

1005 
i
 = 0; i < 
gC¬dš®™y
.
Ëngth
; ++i) {

1006 ià(
gC¬dš®™y
[
i
] > 1) {

1007 
fœ¡Inüem’bËC¬dš®™y
 = 
i
;

1012 
keys
 = 
Ãw
 
SŒšg
[
numKeys
];

1013 
gKeys
 = 
Ãw
 
SŒšg
[
gPaœs
];

1014 
gV®ues
 = 
Ãw
 
SŒšg
[
maxC¬dš®™y
];

1015 
i
 = 0; i < 
numKeys
; ++i) {

1016 
keys
[
i
] = 
keyG’”©Ü
.
	`ÃxtSŒšg
();

1019 
i
 = 0; i < 
gPaœs
; ++i) {

1020 
gKeys
[
i
] = 
gKeyG’”©Ü
.
	`ÃxtSŒšg
();

1023 
i
 = 0; i < 
maxC¬dš®™y
; i++) {

1024 
gV®ues
[
i
] = 
gV®ueG’”©Ü
.
	`ÃxtSŒšg
();

1026 ià(
¿ndomizeTime£r›sOrd”
) {

1027 
Uts
.
	`shufæeA¼ay
(
keys
);

1028 
Uts
.
	`shufæeA¼ay
(
gV®ues
);

1031 
maxOff£ts
 = (
»cÜdcouÁ
 / 
tÙ®C¬dš®™y
) + 1;

1032 
fš®
 [] 
keyAndTagC¬dš®™y
 = 
Ãw
 [
gPaœs
 + 1];

1033 
keyAndTagC¬dš®™y
[0] = 
numKeys
;

1034 
i
 = 0; i < 
gPaœs
; i++) {

1035 
keyAndTagC¬dš®™y
[
i
 + 1] = 
gC¬dš®™y
[i];

1038 
cumuÏtiveC¬dš®™y
 = 
Ãw
 [
keyAndTagC¬dš®™y
.
Ëngth
];

1039 
i
 = 0; i < 
keyAndTagC¬dš®™y
.
Ëngth
; i++) {

1040 
cumuÏtiÚ
 = 1;

1041 
x
 = 
i
; x <ğ
keyAndTagC¬dš®™y
.
Ëngth
 - 1; x++) {

1042 
cumuÏtiÚ
 *ğ
keyAndTagC¬dš®™y
[
x
];

1044 ià(
i
 > 0) {

1045 
cumuÏtiveC¬dš®™y
[
i
 - 1] = 
cumuÏtiÚ
;

1048 
cumuÏtiveC¬dš®™y
[cumuÏtiveC¬dš®™y.
Ëngth
 - 1] = 1;

1049 
	}
}

1055 
´Ùeùed
 
	$v®id©eS‘tšgs
(è
throws
 
WÜklßdExû±iÚ
 {

1056 ià(
d©aš‹gr™y
) {

1057 ià(
v®ueTy³
 !ğ
V®ueTy³
.
INTEGERS
) {

1058 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'valuetype' must "

1061 ià(
groupBy
) {

1062 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'groupbyfunction' must "

1065 ià(
down§m¶e
) {

1066 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'downsamplingfunction' must "

1069 ià(
qu”yTimeS·n
 > 0) {

1070 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'querytimespan' must "

1073 ià(
¿ndomizeTime£r›sOrd”
) {

1074 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'randomizetimeseriesorder' must "

1077 
fš®
 
SŒšg
 
¡¬tTime¡amp
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
INSERT_START_PROPERTY
);

1078 ià(
¡¬tTime¡amp
 =ğ
nuÎ
 || s¹Time¡amp.
	`isEm±y
()) {

1079 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'insertstart' must "

1083 
	}
}

1088 
´Ùeùed
 cÏs 
	cTh»adS‹
 {

1090 
´Ùeùed
 
fš®
 
UnixEpochTime¡ampG’”©Ü
 
	gtime¡ampG’”©Ü
;

1093 
´Ùeùed
 
fš®
 
Numb”G’”©Ü
 
	gqu”yOff£tG’”©Ü
;

1096 
´Ùeùed
 
	gkeyIdx
;

1099 
´Ùeùed
 
	gkeyIdxS¹
;

1102 
´Ùeùed
 
	gkeyIdxEnd
;

1105 
´Ùeùed
 [] 
	ggV®ueIdxs
;

1108 
´Ùeùed
 
boŞ—n
 
	grŞlov”
;

1111 
´Ùeùed
 
	g¡¬tTime¡amp
;

1119 
´Ùeùed
 
Th»adS‹
(
fš®
 
th»adID
, fš® 
th»adCouÁ
è
throws
 
	gWÜklßdExû±iÚ
 {

1120 
	gtÙ®Th»ads
 = 
th»adCouÁ
 > 0 ?hreadCount : 1;

1122 ià(
	gth»adID
 >ğ
tÙ®Th»ads
) {

1123 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Th»ad ID " + 
th»adID
 + " cannot be greater "

1124 + "thª o¸equ®hªhth»ad couÁ " + 
tÙ®Th»ads
);

1126 ià(
	gkeys
.
	gËngth
 < 
	gth»adCouÁ
) {

1127 
throw
 
Ãw
 
WÜklßdExû±iÚ
("Th»ad couÁ " + 
tÙ®Th»ads
 + " must be greater "

1128 + "thª o¸equ®Økey couÁ " + 
keys
.
Ëngth
);

1131 
	gkeysP”Th»ad
 = 
keys
.
Ëngth
 / 
tÙ®Th»ads
;

1132 
	gkeyIdx
 = 
keysP”Th»ad
 * 
th»adID
;

1133 
	gkeyIdxS¹
 = 
keyIdx
;

1134 ià(
	gtÙ®Th»ads
 - 1 =ğ
th»adID
) {

1135 
keyIdxEnd
 = 
keys
.
Ëngth
;

1137 
	gkeyIdxEnd
 = 
keyIdxS¹
 + 
keysP”Th»ad
;

1140 
	ggV®ueIdxs
 = 
Ãw
 [
gPaœs
];

1142 
fš®
 
SŒšg
 
	g¡¬tšgTime¡amp
 =

1143 
´İ”t›s
.
g‘Prİ”ty
(
CÜeWÜklßd
.
INSERT_START_PROPERTY
);

1144 ià(
	g¡¬tšgTime¡amp
 =ğ
nuÎ
 || 
¡¬tšgTime¡amp
.
isEm±y
()) {

1145 
time¡ampG’”©Ü
 = 
¿ndomizeTime¡ampOrd”
 ?

1146 
Ãw
 
RªdomDisü‘eTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
, 
maxOff£ts
) :

1147 
Ãw
 
UnixEpochTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
);

1149 
	gŒy
 {

1150 
	gtime¡ampG’”©Ü
 = 
¿ndomizeTime¡ampOrd”
 ?

1151 
Ãw
 
RªdomDisü‘eTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
,

1152 
LÚg
.
·r£LÚg
(
¡¬tšgTime¡amp
), 
maxOff£ts
) :

1153 
Ãw
 
UnixEpochTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
,

1154 
LÚg
.
·r£LÚg
(
¡¬tšgTime¡amp
));

1155 } 
ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

1156 
throw
 
Ãw
 
WÜklßdExû±iÚ
("Unableo…arsehe " +

1157 
CÜeWÜklßd
.
INSERT_START_PROPERTY
, 
nã
);

1162 
	g¡¬tTime¡amp
 = 
time¡ampG’”©Ü
.
ÃxtV®ue
();

1164 
	gqu”yOff£tG’”©Ü
 = 
Ãw
 
UnifÜmLÚgG’”©Ü
(0, 
maxOff£ts
 - 2);

1175 
´Ùeùed
 
SŒšg
 
ÃxtD©aPošt
(
fš®
 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
m­
, fš® 
boŞ—n
 
isIn£¹
) {

1176 
fš®
 
Rªdom
 
	g¿ndom
 = 
Th»adLoÿlRªdom
.
cu¼’t
();

1177 
	g™”©iÚs
 = 
¥¬s™y
 <ğ0 ? 1 : 
¿ndom
.
ÃxtIÁ
((è((è
³rKeyC¬dš®™y
 * sparsity));

1178 ià(
	g™”©iÚs
 < 1) {

1179 
	g™”©iÚs
 = 1;

1181 
	gŒue
) {

1182 
	g™”©iÚs
--;

1183 ià(
	grŞlov”
) {

1184 
	gtime¡ampG’”©Ü
.
ÃxtV®ue
();

1185 
	grŞlov”
 = 
çl£
;

1187 
SŒšg
 
	gkey
 = 
nuÎ
;

1188 ià(
	g™”©iÚs
 <= 0) {

1189 
fš®
 
T»eM­
<
SŒšg
, SŒšg> 
v®id©iÚTags
;

1190 ià(
	gd©aš‹gr™y
) {

1191 
	gv®id©iÚTags
 = 
Ãw
 
T»eM­
<
SŒšg
, 
	gSŒšg
>();

1193 
	gv®id©iÚTags
 = 
nuÎ
;

1195 
	gkey
 = 
keys
[
keyIdx
];

1196 
	gov”®lIdx
 = 
keyIdx
 * 
cumuÏtiveC¬dš®™y
[0];

1197 
	gi
 = 0; i < 
	ggPaœs
; ++i) {

1198 
	gtvidx
 = 
gV®ueIdxs
[
i
];

1199 
	gm­
.
put
(
gKeys
[
i
], 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
gV®ues
[
tvidx
]));

1200 ià(
	gd©aš‹gr™y
) {

1201 
	gv®id©iÚTags
.
put
(
gKeys
[
i
], 
gV®ues
[
tvidx
]);

1203 ià(
	gd–ayedS”›s
 > 0) {

1204 
	gov”®lIdx
 +ğ(
tvidx
 * 
cumuÏtiveC¬dš®™y
[
i
 + 1]);

1208 ià(!
	gisIn£¹
) {

1209 
fš®
 
	gd–
 = (
time¡ampG’”©Ü
.
cu¼’tV®ue
(è- 
¡¬tTime¡amp
è/ 
time¡ampIÁ”v®
;

1210 
fš®
 
	gš‹rv®s
 = 
¿ndom
.
ÃxtIÁ
((è
d–
);

1211 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¡¬tTime¡amp
 + (
š‹rv®s
 * 
time¡ampIÁ”v®
)));

1212 } ià(
	gd–ayedS”›s
 > 0) {

1215 
	gpù
 = (è
ov”®lIdx
 / (è
tÙ®C¬dš®™y
;

1216 ià(
	gpù
 < 
	gd–ayedS”›s
) {

1217 
	gmodulo
 = 
ov”®lIdx
 % 
d–ayedIÁ”v®s
;

1218 ià(
	gmodulo
 < 0) {

1219 
	gmodulo
 *= -1;

1221 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
time¡ampG’”©Ü
.
cu¼’tV®ue
() -

1222 
time¡ampIÁ”v®
 * 
modulo
));

1224 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
time¡ampG’”©Ü
.
cu¼’tV®ue
()));

1227 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
time¡ampG’”©Ü
.
cu¼’tV®ue
()));

1230 ià(
	gd©aš‹gr™y
) {

1231 
	gm­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
v®id©iÚFunùiÚ
(
key
,

1232 
time¡ampG’”©Ü
.
cu¼’tV®ue
(), 
v®id©iÚTags
)));

1234 
	gv®ueTy³
) {

1235 
	gINTEGERS
:

1236 
m­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtIÁ
()));

1238 
	gFLOATS
:

1239 
m­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtDoubË
() * () 100000));

1241 
	gMIXED
:

1242 ià(
¿ndom
.
ÃxtBoŞ—n
()) {

1243 
m­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtIÁ
()));

1245 
	gm­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtDoubË
() * () 100000));

1249 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Somehow we didn't have‡ value "

1250 + "ty³ cÚfigu»dh© wsuµÜt: " + 
v®ueTy³
);

1255 
boŞ—n
 
	ggRŞlov”
 = 
çl£
;

1256 
	gi
 = 
gC¬dš®™y
.
Ëngth
 - 1; i >= 0; --i) {

1257 ià(
	ggC¬dš®™y
[
i
] <= 1) {

1258 
gRŞlov”
 = 
Œue
;

1262 ià(
	ggV®ueIdxs
[
i
] + 1 >ğ
gC¬dš®™y
[i]) {

1263 
gV®ueIdxs
[
i
] = 0;

1264 ià(
	gi
 =ğ
fœ¡Inüem’bËC¬dš®™y
) {

1265 
gRŞlov”
 = 
Œue
;

1268 ++
	ggV®ueIdxs
[
i
];

1273 ià(
	ggRŞlov”
) {

1274 ià(
	gkeyIdx
 + 1 >ğ
keyIdxEnd
) {

1275 
keyIdx
 = 
keyIdxS¹
;

1276 
	grŞlov”
 = 
Œue
;

1278 ++
	gkeyIdx
;

1282 ià(
	g™”©iÚs
 <= 0) {

1283  
key
;

	@workloads/TimeSeriesWorkload.java

17 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

19 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

24 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

25 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
impÜt
 
	gjava
.
	gut
.
	gT»eM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gVeùÜ
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

31 
impÜt
 
	gs™e
.
	gycsb
.
	gBy‹I‹¿tÜ
;

32 
impÜt
 
	gs™e
.
	gycsb
.
	gCl›Á
;

33 
impÜt
 
	gs™e
.
	gycsb
.
	gDB
;

34 
impÜt
 
	gs™e
.
	gycsb
.
	gNum”icBy‹I‹¿tÜ
;

35 
impÜt
 
	gs™e
.
	gycsb
.
	gStus
;

36 
impÜt
 
	gs™e
.
	gycsb
.
	gSŒšgBy‹I‹¿tÜ
;

37 
impÜt
 
	gs™e
.
	gycsb
.
	gUts
;

38 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßd
;

39 
impÜt
 
	gs™e
.
	gycsb
.
	gWÜklßdExû±iÚ
;

40 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gDisü‘eG’”©Ü
;

41 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gG’”©Ü
;

42 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gHÙ¥ÙIÁeg”G’”©Ü
;

43 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gInüem’tšgPršbËSŒšgG’”©Ü
;

44 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gNumb”G’”©Ü
;

45 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gRªdomDisü‘eTime¡ampG’”©Ü
;

46 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gSüambËdZfŸnG’”©Ü
;

47 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gSequ’tŸlG’”©Ü
;

48 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnifÜmLÚgG’”©Ü
;

49 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gUnixEpochTime¡ampG’”©Ü
;

50 
impÜt
 
	gs™e
.
	gycsb
.
	gg’”©Ü
.
	gZfŸnG’”©Ü
;

51 
impÜt
 
	gs™e
.
	gycsb
.
	gm—su»m’ts
.
	gM—su»m’ts
;

284 
public
 cÏs 
	cTimeS”›sWÜklßd
 
ex‹nds
 
	mWÜklßd
 {

289 
public
 
	eV®ueTy³
 {

290 
INTEGERS
("integers"),

291 
FLOATS
("floats"),

292 
MIXED
("mixednumbers");

294 
´Ùeùed
 
fš®
 
SŒšg
 
	mÇme
;

296 
V®ueTy³
(
fš®
 
SŒšg
 
Çme
) {

297 
	mthis
.
	mÇme
 = 
Çme
;

300 
public
 
V®ueTy³
 
äomSŒšg
(
fš®
 
SŒšg
 
Çme
) {

301 
fš®
 
V®ueTy³
 
	mty³
 : V®ueTy³.
v®ues
()) {

302 ià(
ty³
.
Çme
.
equ®sIgnÜeCa£
(name)) {

303  
ty³
;

306 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("UÄecognizedy³: " + 
Çme
);

311 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_KEY_PROPERTY
 = "timestampkey";

312 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_KEY_PROPERTY_DEFAULT
 = "YCSBTS";

315 
public
 
fš®
 
SŒšg
 
	gVALUE_KEY_PROPERTY
 = "valuekey";

316 
public
 
fš®
 
SŒšg
 
	gVALUE_KEY_PROPERTY_DEFAULT
 = "YCSBV";

319 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_INTERVAL_PROPERTY
 = "timestampinterval";

320 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_INTERVAL_PROPERTY_DEFAULT
 = "60";

323 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_UNITS_PROPERTY
 = "timestampunits";

324 
public
 
fš®
 
SŒšg
 
	gTIMESTAMP_UNITS_PROPERTY_DEFAULT
 = "SECONDS";

327 
public
 
fš®
 
SŒšg
 
	gTAG_COUNT_PROPERTY
 = "tagcount";

328 
public
 
fš®
 
SŒšg
 
	gTAG_COUNT_PROPERTY_DEFAULT
 = "4";

331 
public
 
fš®
 
SŒšg
 
	gTAG_CARDINALITY_PROPERTY
 = "tagcardinality";

332 
public
 
fš®
 
SŒšg
 
	gTAG_CARDINALITY_PROPERTY_DEFAULT
 = "1, 2, 4, 8";

335 
public
 
fš®
 
SŒšg
 
	gTAG_KEY_LENGTH_PROPERTY
 = "tagkeylength";

336 
public
 
fš®
 
SŒšg
 
	gTAG_KEY_LENGTH_PROPERTY_DEFAULT
 = "8";

339 
public
 
fš®
 
SŒšg
 
	gTAG_VALUE_LENGTH_PROPERTY
 = "tagvaluelength";

340 
public
 
fš®
 
SŒšg
 
	gTAG_VALUE_LENGTH_PROPERTY_DEFAULT
 = "8";

343 
public
 
fš®
 
SŒšg
 
	gPAIR_DELIMITER_PROPERTY
 = "tagpairdelimiter";

344 
public
 
fš®
 
SŒšg
 
	gPAIR_DELIMITER_PROPERTY_DEFAULT
 = "=";

347 
public
 
fš®
 
SŒšg
 
	gDELETE_DELIMITER_PROPERTY
 = "deletedelimiter";

348 
public
 
fš®
 
SŒšg
 
	gDELETE_DELIMITER_PROPERTY_DEFAULT
 = ":";

351 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESTAMP_ORDER_PROPERTY
 = "randomwritetimestamporder";

352 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESTAMP_ORDER_PROPERTY_DEFAULT
 = "false";

355 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESERIES_ORDER_PROPERTY
 = "randomtimeseriesorder";

356 
public
 
fš®
 
SŒšg
 
	gRANDOMIZE_TIMESERIES_ORDER_PROPERTY_DEFAULT
 = "true";

359 
public
 
fš®
 
SŒšg
 
	gVALUE_TYPE_PROPERTY
 = "valuetype";

360 
public
 
fš®
 
SŒšg
 
	gVALUE_TYPE_PROPERTY_DEFAULT
 = "floats";

363 
public
 
fš®
 
SŒšg
 
	gSPARSITY_PROPERTY
 = "sparsity";

364 
public
 
fš®
 
SŒšg
 
	gSPARSITY_PROPERTY_DEFAULT
 = "0.00";

367 
public
 
fš®
 
SŒšg
 
	gDELAYED_SERIES_PROPERTY
 = "delayedseries";

368 
public
 
fš®
 
SŒšg
 
	gDELAYED_SERIES_PROPERTY_DEFAULT
 = "0.10";

371 
public
 
fš®
 
SŒšg
 
	gDELAYED_INTERVALS_PROPERTY
 = "delayedintervals";

372 
public
 
fš®
 
SŒšg
 
	gDELAYED_INTERVALS_PROPERTY_DEFAULT
 = "5";

375 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_PROPERTY
 = "querytimespan";

376 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_PROPERTY_DEFAULT
 = "0";

379 
public
 
fš®
 
SŒšg
 
	gQUERY_RANDOM_TIMESPAN_PROPERTY
 = "queryrandomtimespan";

380 
public
 
fš®
 
SŒšg
 
	gQUERY_RANDOM_TIMESPAN_PROPERTY_DEFAULT
 = "false";

383 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_DELIMITER_PROPERTY
 = "querytimespandelimiter";

384 
public
 
fš®
 
SŒšg
 
	gQUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
 = ",";

387 
public
 
fš®
 
SŒšg
 
	gGROUPBY_KEY_PROPERTY
 = "groupbykey";

388 
public
 
fš®
 
SŒšg
 
	gGROUPBY_KEY_PROPERTY_DEFAULT
 = "YCSBGB";

391 
public
 
fš®
 
SŒšg
 
	gGROUPBY_PROPERTY
 = "groupbyfunction";

394 
public
 
fš®
 
SŒšg
 
	gGROUPBY_KEYS_PROPERTY
 = "groupbykeys";

397 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_KEY_PROPERTY
 = "downsamplingkey";

398 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_KEY_PROPERTY_DEFAULT
 = "YCSBDS";

401 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_FUNCTION_PROPERTY
 = "downsamplingfunction";

404 
public
 
fš®
 
SŒšg
 
	gDOWNSAMPLING_INTERVAL_PROPERTY
 = "downsamplinginterval";

407 
´Ùeùed
 
Prİ”t›s
 
	g´İ”t›s
;

410 
´Ùeùed
 
	gG’”©Ü
<
	gSŒšg
> 
	gkeyG’”©Ü
;

411 
´Ùeùed
 
	gG’”©Ü
<
	gSŒšg
> 
	ggKeyG’”©Ü
;

412 
´Ùeùed
 
	gG’”©Ü
<
	gSŒšg
> 
	ggV®ueG’”©Ü
;

415 
´Ùeùed
 
SŒšg
 
	gtime¡ampKey
;

418 
´Ùeùed
 
SŒšg
 
	gv®ueKey
;

421 
´Ùeùed
 
	gtime¡ampIÁ”v®
;

424 
´Ùeùed
 
TimeUn™
 
	gtimeUn™s
;

427 
´Ùeùed
 
boŞ—n
 
	g¿ndomizeTime¡ampOrd”
;

431 
´Ùeùed
 
boŞ—n
 
	g¿ndomizeTime£r›sOrd”
;

434 
´Ùeùed
 
V®ueTy³
 
	gv®ueTy³
;

437 
´Ùeùed
 [] 
	gcumuÏtiveC¬dš®™y
;

440 
´Ùeùed
 
	gtÙ®C¬dš®™y
;

444 
´Ùeùed
 
	g³rKeyC¬dš®™y
;

447 
´Ùeùed
 
Numb”G’”©Ü
 
	gsÿÆ’gth
;

450 
´Ùeùed
 
Numb”G’”©Ü
 
	gkeychoo£r
;

453 
´Ùeùed
 
Disü‘eG’”©Ü
 
	gİ”©iÚchoo£r
;

457 
´Ùeùed
 
	gmaxOff£ts
;

460 
´Ùeùed
 
	g»cÜdcouÁ
;

463 
´Ùeùed
 
	ggPaœs
;

466 
´Ùeùed
 
SŒšg
 
	gbË
;

469 
´Ùeùed
 
	gnumKeys
;

472 
´Ùeùed
 
	gSŒšg
[] 
	gkeys
;

475 
´Ùeùed
 
	gSŒšg
[] 
	ggKeys
;

478 
´Ùeùed
 
	gSŒšg
[] 
	ggV®ues
;

481 
´Ùeùed
 [] 
	ggC¬dš®™y
;

484 
´Ùeùed
 
	gfœ¡Inüem’bËC¬dš®™y
;

487 
´Ùeùed
 
	g¥¬s™y
;

490 
´Ùeùed
 
	gd–ayedS”›s
;

493 
´Ùeùed
 
	gd–ayedIÁ”v®s
;

496 
´Ùeùed
 
	gqu”yTimeS·n
;

500 
´Ùeùed
 
boŞ—n
 
	gqu”yRªdomTimeS·n
;

503 
´Ùeùed
 
SŒšg
 
	ggPaœD–im™”
;

506 
´Ùeùed
 
SŒšg
 
	gd–‘eD–im™”
;

509 
´Ùeùed
 
SŒšg
 
	gqu”yTimeS·nD–im™”
;

512 
´Ùeùed
 
boŞ—n
 
	ggroupBy
;

515 
´Ùeùed
 
SŒšg
 
	ggroupByKey
;

518 
´Ùeùed
 
SŒšg
 
	ggroupByFunùiÚ
;

521 
´Ùeùed
 
	gboŞ—n
[] 
	ggroupBys
;

524 
´Ùeùed
 
boŞ—n
 
	gdown§m¶e
;

527 
´Ùeùed
 
SŒšg
 
	gdown§m¶eKey
;

530 
´Ùeùed
 
SŒšg
 
	gdown§m¶eFunùiÚ
;

533 
´Ùeùed
 
	gdown§m¶eIÁ”v®
;

539 
´Ùeùed
 
boŞ—n
 
	gd©aš‹gr™y
;

542 
´Ùeùed
 
M—su»m’ts
 
	gm—su»m’ts
 = M—su»m’ts.
g‘M—su»m’ts
();

544 @
Ov”ride


545 
public
 
	$š™
(
fš®
 
Prİ”t›s
 
p
è
throws
 
WÜklßdExû±iÚ
 {

546 
´İ”t›s
 = 
p
;

547 
»cÜdcouÁ
 =

548 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
Cl›Á
.
RECORD_COUNT_PROPERTY
,

549 
Cl›Á
.
DEFAULT_RECORD_COUNT
));

550 ià(
»cÜdcouÁ
 == 0) {

551 
»cÜdcouÁ
 = 
IÁeg”
.
MAX_VALUE
;

553 
time¡ampKey
 = 
p
.
	`g‘Prİ”ty
(
TIMESTAMP_KEY_PROPERTY
, 
TIMESTAMP_KEY_PROPERTY_DEFAULT
);

554 
v®ueKey
 = 
p
.
	`g‘Prİ”ty
(
VALUE_KEY_PROPERTY
, 
VALUE_KEY_PROPERTY_DEFAULT
);

555 
İ”©iÚchoo£r
 = 
CÜeWÜklßd
.
	`ü—‹O³¿tiÚG’”©Ü
(
´İ”t›s
);

557 
fš®
 
maxsÿÆ’gth
 =

558 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
MAX_SCAN_LENGTH_PROPERTY
,

559 
CÜeWÜklßd
.
MAX_SCAN_LENGTH_PROPERTY_DEFAULT
));

560 
SŒšg
 
sÿÆ’gthdi¡rib
 =

561 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
SCAN_LENGTH_DISTRIBUTION_PROPERTY
,

562 
CÜeWÜklßd
.
SCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT
);

564 ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("uniform") == 0) {

565 
sÿÆ’gth
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(1, 
maxsÿÆ’gth
);

566 } ià(
sÿÆ’gthdi¡rib
.
	`com·»To
("zipfian") == 0) {

567 
sÿÆ’gth
 = 
Ãw
 
	`ZfŸnG’”©Ü
(1, 
maxsÿÆ’gth
);

569 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
(

570 "Di¡ributiÚ \"" + 
sÿÆ’gthdi¡rib
 + "\"‚ot‡llowed for scan†ength");

573 
¿ndomizeTime¡ampOrd”
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
p
.
	`g‘Prİ”ty
(

574 
RANDOMIZE_TIMESTAMP_ORDER_PROPERTY
,

575 
RANDOMIZE_TIMESTAMP_ORDER_PROPERTY_DEFAULT
));

576 
¿ndomizeTime£r›sOrd”
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
p
.
	`g‘Prİ”ty
(

577 
RANDOMIZE_TIMESERIES_ORDER_PROPERTY
,

578 
RANDOMIZE_TIMESERIES_ORDER_PROPERTY_DEFAULT
));

581 
numKeys
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY
,

582 
CÜeWÜklßd
.
FIELD_COUNT_PROPERTY_DEFAULT
));

583 
gPaœs
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
TAG_COUNT_PROPERTY
,

584 
TAG_COUNT_PROPERTY_DEFAULT
));

585 
¥¬s™y
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
SPARSITY_PROPERTY
, 
SPARSITY_PROPERTY_DEFAULT
));

586 
gC¬dš®™y
 = 
Ãw
 [
gPaœs
];

588 
fš®
 
SŒšg
 
»que¡di¡rib
 =

589 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
REQUEST_DISTRIBUTION_PROPERTY
,

590 
CÜeWÜklßd
.
REQUEST_DISTRIBUTION_PROPERTY_DEFAULT
);

591 ià(
»que¡di¡rib
.
	`com·»To
("uniform") == 0) {

592 
keychoo£r
 = 
Ãw
 
	`UnifÜmLÚgG’”©Ü
(0, 
numKeys
 - 1);

593 } ià(
»que¡di¡rib
.
	`com·»To
("sequential") == 0) {

594 
keychoo£r
 = 
Ãw
 
	`Sequ’tŸlG’”©Ü
(0, 
numKeys
 - 1);

595 } ià(
»que¡di¡rib
.
	`com·»To
("zipfian") == 0) {

596 
keychoo£r
 = 
Ãw
 
	`SüambËdZfŸnG’”©Ü
(0, 
numKeys
 - 1);

599 } ià(
»que¡di¡rib
.
	`equ®s
("hotspot")) {

600 
hÙ£täaùiÚ
 =

601 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
HOTSPOT_DATA_FRACTION
,

602 
CÜeWÜklßd
.
HOTSPOT_DATA_FRACTION_DEFAULT
));

603 
hÙİnäaùiÚ
 =

604 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
HOTSPOT_OPN_FRACTION
,

605 
CÜeWÜklßd
.
HOTSPOT_OPN_FRACTION_DEFAULT
));

606 
keychoo£r
 = 
Ãw
 
	`HÙ¥ÙIÁeg”G’”©Ü
(0, 
numKeys
 - 1,

607 
hÙ£täaùiÚ
, 
hÙİnäaùiÚ
);

609 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀ»que¡ di¡ributiÚ \"" + 
»que¡di¡rib
 + "\"");

613 
Œy
 {

614 
time¡ampIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(

615 
TIMESTAMP_INTERVAL_PROPERTY
, 
TIMESTAMP_INTERVAL_PROPERTY_DEFAULT
));

616 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

617 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Unableo…arsehe " +

618 
TIMESTAMP_INTERVAL_PROPERTY
, 
nã
);

621 
Œy
 {

622 
timeUn™s
 = 
TimeUn™
.
	`v®ueOf
(
p
.
	`g‘Prİ”ty
(
TIMESTAMP_UNITS_PROPERTY
,

623 
TIMESTAMP_UNITS_PROPERTY_DEFAULT
).
	`toUµ”Ca£
());

624 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

625 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("UnknowÀtimun™y³", 
e
);

627 ià(
timeUn™s
 =ğ
TimeUn™
.
NANOSECONDS
 ||imeUn™ =ğTimeUn™.
MICROSECONDS
) {

628 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("YCSB dÛ¢'ˆsuµÜˆ" + 
timeUn™s
 +

632 
gPaœD–im™”
 = 
p
.
	`g‘Prİ”ty
(
PAIR_DELIMITER_PROPERTY
, 
PAIR_DELIMITER_PROPERTY_DEFAULT
);

633 
d–‘eD–im™”
 = 
p
.
	`g‘Prİ”ty
(
DELETE_DELIMITER_PROPERTY
, 
DELETE_DELIMITER_PROPERTY_DEFAULT
);

634 
d©aš‹gr™y
 = 
BoŞ—n
.
	`·r£BoŞ—n
(

635 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
DATA_INTEGRITY_PROPERTY
,

636 
CÜeWÜklßd
.
DATA_INTEGRITY_PROPERTY_DEFAULT
));

637 ià(
d©aš‹gr™y
) {

638 
Sy¡em
.
out
.
	`´šn
("Data integrity isƒnabled.");

641 
qu”yTimeS·n
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
QUERY_TIMESPAN_PROPERTY
,

642 
QUERY_TIMESPAN_PROPERTY_DEFAULT
));

643 
qu”yRªdomTimeS·n
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
p
.
	`g‘Prİ”ty
(
QUERY_RANDOM_TIMESPAN_PROPERTY
,

644 
QUERY_RANDOM_TIMESPAN_PROPERTY_DEFAULT
));

645 
qu”yTimeS·nD–im™”
 = 
p
.
	`g‘Prİ”ty
(
QUERY_TIMESPAN_DELIMITER_PROPERTY
,

646 
QUERY_TIMESPAN_DELIMITER_PROPERTY_DEFAULT
);

648 
groupByKey
 = 
p
.
	`g‘Prİ”ty
(
GROUPBY_KEY_PROPERTY
, 
GROUPBY_KEY_PROPERTY_DEFAULT
);

649 
groupByFunùiÚ
 = 
p
.
	`g‘Prİ”ty
(
GROUPBY_PROPERTY
);

650 ià(
groupByFunùiÚ
 !ğ
nuÎ
 && !groupByFunùiÚ.
	`isEm±y
()) {

651 
fš®
 
SŒšg
 
groupByKeys
 = 
p
.
	`g‘Prİ”ty
(
GROUPBY_KEYS_PROPERTY
);

652 ià(
groupByKeys
 =ğ
nuÎ
 || groupByKeys.
	`isEm±y
()) {

653 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Group by wasƒnabled but‚o keys were specified.");

655 
fš®
 
SŒšg
[] 
gbKeys
 = 
groupByKeys
.
	`¥l™
(",");

656 ià(
gbKeys
.
Ëngth
 !ğ
gKeys
.length) {

657 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("OÆy " + 
gbKeys
.
Ëngth
 + " group by keys "

658 + "w”¥ecif›d buˆth”w”" + 
gKeys
.
Ëngth
 + "ag keys given.");

660 
groupBys
 = 
Ãw
 
boŞ—n
[
gbKeys
.
Ëngth
];

661 
i
 = 0; i < 
gbKeys
.
Ëngth
; i++) {

662 
groupBys
[
i
] = 
IÁeg”
.
	`·r£IÁ
(
gbKeys
[i].
	`Œim
()è=ğ0 ? 
çl£
 : 
Œue
;

664 
groupBy
 = 
Œue
;

667 
down§m¶eKey
 = 
p
.
	`g‘Prİ”ty
(
DOWNSAMPLING_KEY_PROPERTY
, 
DOWNSAMPLING_KEY_PROPERTY_DEFAULT
);

668 
down§m¶eFunùiÚ
 = 
p
.
	`g‘Prİ”ty
(
DOWNSAMPLING_FUNCTION_PROPERTY
);

669 ià(
down§m¶eFunùiÚ
 !ğ
nuÎ
 && !down§m¶eFunùiÚ.
	`isEm±y
()) {

670 
fš®
 
SŒšg
 
š‹rv®
 = 
p
.
	`g‘Prİ”ty
(
DOWNSAMPLING_INTERVAL_PROPERTY
);

671 ià(
š‹rv®
 =ğ
nuÎ
 || iÁ”v®.
	`isEm±y
()) {

672 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("'" + 
DOWNSAMPLING_INTERVAL_PROPERTY
 + "' was missing despite '"

673 + 
DOWNSAMPLING_FUNCTION_PROPERTY
 + "' being set.");

675 
down§m¶eIÁ”v®
 = 
IÁeg”
.
	`·r£IÁ
(
š‹rv®
);

676 
down§m¶e
 = 
Œue
;

679 
d–ayedS”›s
 = 
DoubË
.
	`·r£DoubË
(
p
.
	`g‘Prİ”ty
(
DELAYED_SERIES_PROPERTY
, 
DELAYED_SERIES_PROPERTY_DEFAULT
));

680 
d–ayedIÁ”v®s
 = 
IÁeg”
.
	`·r£IÁ
(
p
.
	`g‘Prİ”ty
(
DELAYED_INTERVALS_PROPERTY
, 
DELAYED_INTERVALS_PROPERTY_DEFAULT
));

682 
v®ueTy³
 = 
V®ueTy³
.
	`äomSŒšg
(
p
.
	`g‘Prİ”ty
(
VALUE_TYPE_PROPERTY
, 
VALUE_TYPE_PROPERTY_DEFAULT
));

683 
bË
 = 
p
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
TABLENAME_PROPERTY
, CÜeWÜklßd.
TABLENAME_PROPERTY_DEFAULT
);

684 
	`š™KeysAndTags
();

685 
	`v®id©eS‘tšgs
();

686 
	}
}

688 @
Ov”ride


689 
public
 
Objeù
 
	$š™Th»ad
(
Prİ”t›s
 
p
, 
myth»adid
, 
th»adcouÁ
è
throws
 
WÜklßdExû±iÚ
 {

690 ià(
´İ”t›s
 =ğ
nuÎ
) {

691 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Workload has‚ot been initialized.");

693  
Ãw
 
	`Th»adS‹
(
myth»adid
, 
th»adcouÁ
);

694 
	}
}

696 @
Ov”ride


697 
public
 
boŞ—n
 
	$doIn£¹
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

698 ià(
th»ad¡©e
 =ğ
nuÎ
) {

699 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Missinghread state.");

701 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
gs
 = 
Ãw
 
T»eM­
<String, ByteIterator>();

702 
fš®
 
SŒšg
 
key
 = ((
Th»adS‹
)
th»ad¡©e
).
	`ÃxtD©aPošt
(
gs
, 
Œue
);

703 ià(
db
.
	`š£¹
(
bË
, 
key
, 
gs
è=ğ
Stus
.
OK
) {

704  
Œue
;

706  
çl£
;

707 
	}
}

709 @
Ov”ride


710 
public
 
boŞ—n
 
	$doT¿n§ùiÚ
(
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

711 ià(
th»ad¡©e
 =ğ
nuÎ
) {

712 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Missinghread state.");

714 
İ”©iÚchoo£r
.
	`ÃxtSŒšg
()) {

716 
	`doT¿n§ùiÚR—d
(
db
, 
th»ad¡©e
);

719 
	`doT¿n§ùiÚUpd©e
(
db
, 
th»ad¡©e
);

722 
	`doT¿n§ùiÚIn£¹
(
db
, 
th»ad¡©e
);

725 
	`doT¿n§ùiÚSÿn
(
db
, 
th»ad¡©e
);

728 
	`doT¿n§ùiÚD–‘e
(
db
, 
th»ad¡©e
);

731  
çl£
;

733  
Œue
;

734 
	}
}

736 
´Ùeùed
 
	$doT¿n§ùiÚR—d
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

737 
fš®
 
Th»adS‹
 
¡©e
 = (Th»adS‹è
th»ad¡©e
;

738 
fš®
 
SŒšg
 
keyÇme
 = 
keys
[
keychoo£r
.
	`ÃxtV®ue
().
	`štV®ue
()];

739 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

740 
off£ts
 = 
¡©e
.
qu”yOff£tG’”©Ü
.
	`ÃxtV®ue
().
	`štV®ue
();

742 
fš®
 
¡¬tTime¡amp
;

743 ià(
off£ts
 > 0) {

744 
¡¬tTime¡amp
 = 
¡©e
.¡¬tTime¡am°+ s‹.
time¡ampG’”©Ü
.
	`g‘Off£t
(
off£ts
);

746 
¡¬tTime¡amp
 = 
¡©e
.startTimestamp;

750 
S‘
<
SŒšg
> 
f›lds
 = 
Ãw
 
HashS‘
<String>();

751 
i
 = 0; i < 
gPaœs
; ++i) {

752 ià(
groupBy
 && 
groupBys
[
i
]) {

753 
f›lds
.
	`add
(
gKeys
[
i
]);

755 
f›lds
.
	`add
(
gKeys
[
i
] + 
gPaœD–im™”
 +

756 
gV®ues
[
¿ndom
.
	`ÃxtIÁ
(
gC¬dš®™y
[
i
])]);

760 ià(
qu”yTimeS·n
 > 0) {

761 
fš®
 
’dTime¡amp
;

762 ià(
qu”yRªdomTimeS·n
) {

763 
’dTime¡amp
 = 
¡¬tTime¡amp
 + (
time¡ampIÁ”v®
 * 
¿ndom
.
	`ÃxtIÁ
(
qu”yTimeS·n
 /imestampInterval));

765 
’dTime¡amp
 = 
¡¬tTime¡amp
 + 
qu”yTimeS·n
;

767 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
 + 
qu”yTimeS·nD–im™”
 + 
’dTime¡amp
);

769 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
);

771 ià(
groupBy
) {

772 
f›lds
.
	`add
(
groupByKey
 + 
gPaœD–im™”
 + 
groupByFunùiÚ
);

774 ià(
down§m¶e
) {

775 
f›lds
.
	`add
(
down§m¶eKey
 + 
gPaœD–im™”
 + 
down§m¶eFunùiÚ
 + 
down§m¶eIÁ”v®
);

778 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
ûÎs
 = 
Ãw
 
HashM­
<String, ByteIterator>();

779 
fš®
 
Stus
 
¡©us
 = 
db
.
	`»ad
(
bË
, 
keyÇme
, 
f›lds
, 
ûÎs
);

781 ià(
d©aš‹gr™y
 && 
¡©us
 =ğ
Stus
.
OK
) {

782 
	`v”ifyRow
(
keyÇme
, 
ûÎs
);

784 
	}
}

786 
´Ùeùed
 
	$doT¿n§ùiÚUpd©e
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

787 ià(
th»ad¡©e
 =ğ
nuÎ
) {

788 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Missinghread state.");

790 
fš®
 
M­
<
SŒšg
, 
By‹I‹¿tÜ
> 
gs
 = 
Ãw
 
T»eM­
<String, ByteIterator>();

791 
fš®
 
SŒšg
 
key
 = ((
Th»adS‹
)
th»ad¡©e
).
	`ÃxtD©aPošt
(
gs
, 
çl£
);

792 
db
.
	`upd©e
(
bË
, 
key
, 
gs
);

793 
	}
}

795 
´Ùeùed
 
	$doT¿n§ùiÚIn£¹
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

796 
	`doIn£¹
(
db
, 
th»ad¡©e
);

797 
	}
}

799 
´Ùeùed
 
	$doT¿n§ùiÚSÿn
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

800 
fš®
 
Th»adS‹
 
¡©e
 = (Th»adS‹è
th»ad¡©e
;

801 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

802 
fš®
 
SŒšg
 
keyÇme
 = 
keys
[
¿ndom
.
	`ÃxtIÁ
(keys.
Ëngth
)];

805 
Ën
 = 
sÿÆ’gth
.
	`ÃxtV®ue
().
	`štV®ue
();

807 
off£ts
 = 
¿ndom
.
	`ÃxtIÁ
(
maxOff£ts
 - 1);

808 
fš®
 
¡¬tTime¡amp
;

809 ià(
off£ts
 > 0) {

810 
¡¬tTime¡amp
 = 
¡©e
.¡¬tTime¡am°+ s‹.
time¡ampG’”©Ü
.
	`g‘Off£t
(
off£ts
);

812 
¡¬tTime¡amp
 = 
¡©e
.startTimestamp;

816 
S‘
<
SŒšg
> 
f›lds
 = 
Ãw
 
HashS‘
<String>();

817 
i
 = 0; i < 
gPaœs
; ++i) {

818 ià(
groupBy
 && 
groupBys
[
i
]) {

819 
f›lds
.
	`add
(
gKeys
[
i
]);

821 
f›lds
.
	`add
(
gKeys
[
i
] + 
gPaœD–im™”
 +

822 
gV®ues
[
¿ndom
.
	`ÃxtIÁ
(
gC¬dš®™y
[
i
])]);

826 ià(
qu”yTimeS·n
 > 0) {

827 
fš®
 
’dTime¡amp
;

828 ià(
qu”yRªdomTimeS·n
) {

829 
’dTime¡amp
 = 
¡¬tTime¡amp
 + (
time¡ampIÁ”v®
 * 
¿ndom
.
	`ÃxtIÁ
(
qu”yTimeS·n
 /imestampInterval));

831 
’dTime¡amp
 = 
¡¬tTime¡amp
 + 
qu”yTimeS·n
;

833 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
 + 
qu”yTimeS·nD–im™”
 + 
’dTime¡amp
);

835 
f›lds
.
	`add
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
);

837 ià(
groupBy
) {

838 
f›lds
.
	`add
(
groupByKey
 + 
gPaœD–im™”
 + 
groupByFunùiÚ
);

840 ià(
down§m¶e
) {

841 
f›lds
.
	`add
(
down§m¶eKey
 + 
gPaœD–im™”
 + 
down§m¶eFunùiÚ
 +agPaœD–im™” + 
down§m¶eIÁ”v®
);

844 
fš®
 
VeùÜ
<
HashM­
<
SŒšg
, 
By‹I‹¿tÜ
>> 
»suÉs
 = 
Ãw
 Vector<HashMap<String, ByteIterator>>();

845 
db
.
	`sÿn
(
bË
, 
keyÇme
, 
Ën
, 
f›lds
, 
»suÉs
);

846 
	}
}

848 
´Ùeùed
 
	$doT¿n§ùiÚD–‘e
(
fš®
 
DB
 
db
, 
Objeù
 
th»ad¡©e
) {

849 
fš®
 
Th»adS‹
 
¡©e
 = (Th»adS‹è
th»ad¡©e
;

850 
fš®
 
Rªdom
 
¿ndom
 = 
Th»adLoÿlRªdom
.
	`cu¼’t
();

851 
fš®
 
SŒšgBud”
 
buf
 = 
Ãw
 
	`SŒšgBud”
().
	`­³nd
(
keys
[
¿ndom
.
	`ÃxtIÁ
(keys.
Ëngth
)]);

853 
off£ts
 = 
¿ndom
.
	`ÃxtIÁ
(
maxOff£ts
 - 1);

854 
fš®
 
¡¬tTime¡amp
;

855 ià(
off£ts
 > 0) {

856 
¡¬tTime¡amp
 = 
¡©e
.¡¬tTime¡am°+ s‹.
time¡ampG’”©Ü
.
	`g‘Off£t
(
off£ts
);

858 
¡¬tTime¡amp
 = 
¡©e
.startTimestamp;

862 
i
 = 0; i < 
gPaœs
; ++i) {

863 ià(
groupBy
 && 
groupBys
[
i
]) {

864 
buf
.
	`­³nd
(
d–‘eD–im™”
)

865 .
	`­³nd
(
gKeys
[
i
]);

867 
buf
.
	`­³nd
(
d–‘eD–im™”
).­³nd(
gKeys
[
i
] + 
gPaœD–im™”
 +

868 
gV®ues
[
¿ndom
.
	`ÃxtIÁ
(
gC¬dš®™y
[
i
])]);

872 ià(
qu”yTimeS·n
 > 0) {

873 
fš®
 
’dTime¡amp
;

874 ià(
qu”yRªdomTimeS·n
) {

875 
’dTime¡amp
 = 
¡¬tTime¡amp
 + (
time¡ampIÁ”v®
 * 
¿ndom
.
	`ÃxtIÁ
(
qu”yTimeS·n
 /imestampInterval));

877 
’dTime¡amp
 = 
¡¬tTime¡amp
 + 
qu”yTimeS·n
;

879 
buf
.
	`­³nd
(
d–‘eD–im™”
)

880 .
	`­³nd
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
 + 
qu”yTimeS·nD–im™”
 + 
’dTime¡amp
);

882 
buf
.
	`­³nd
(
d–‘eD–im™”
)

883 .
	`­³nd
(
time¡ampKey
 + 
gPaœD–im™”
 + 
¡¬tTime¡amp
);

886 
db
.
	`d–‘e
(
bË
, 
buf
.
	`toSŒšg
());

887 
	}
}

898 
´Ùeùed
 
Stus
 
v”ifyRow
(
fš®
 
SŒšg
 
key
, fš® 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
ûÎs
) {

899 
Stus
 
	gv”ifyStus
 = Stus.
UNEXPECTED_STATE
;

900 
	g¡¬tTime
 = 
Sy¡em
.
ÇnoTime
();

902 
	gv®ue
 = 0;

903 
	gtime¡amp
 = 0;

904 
fš®
 
	gT»eM­
<
	gSŒšg
, SŒšg> 
	gv®id©iÚTags
 = 
Ãw
 
T»eM­
<
SŒšg
, String>();

905 
fš®
 
	gEÁry
<
	gSŒšg
, 
	gBy‹I‹¿tÜ
> 
	g’Œy
 : 
ûÎs
.
’ŒyS‘
()) {

906 ià(
’Œy
.
g‘Key
().
equ®s
(
time¡ampKey
)) {

907 
fš®
 
Num”icBy‹I‹¿tÜ
 
™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

908 
	gtime¡amp
 = 
™
.
g‘LÚg
();

909 } ià(
	g’Œy
.
g‘Key
().
equ®s
(
v®ueKey
)) {

910 
fš®
 
Num”icBy‹I‹¿tÜ
 
	g™
 = (Num”icBy‹I‹¿tÜè
’Œy
.
g‘V®ue
();

911 
	gv®ue
 = 
™
.
isFlßtšgPošt
(è? it.
g‘DoubË
(è: it.
g‘LÚg
();

913 
	gv®id©iÚTags
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
().
toSŒšg
());

917 ià(
v®id©iÚFunùiÚ
(
key
, 
time¡amp
, 
v®id©iÚTags
è=ğ
v®ue
) {

918 
v”ifyStus
 = 
Stus
.
OK
;

920 
	g’dTime
 = 
Sy¡em
.
ÇnoTime
();

921 
	gm—su»m’ts
.
m—su»
("VERIFY", (è(
’dTime
 - 
¡¬tTime
) / 1000);

922 
	gm—su»m’ts
.
»pÜtStus
("VERIFY", 
v”ifyStus
);

923  
	gv”ifyStus
;

935 
´Ùeùed
 
v®id©iÚFunùiÚ
(
fš®
 
SŒšg
 
key
, fš® 
time¡amp
,

936 
fš®
 
T»eM­
<
SŒšg
, SŒšg> 
gs
) {

937 
fš®
 
SŒšgBud”
 
	gv®id©iÚBufãr
 = 
Ãw
 SŒšgBud”(
keys
[0].
Ëngth
() +

938 (
gPaœs
 * 
gKeys
[0].
Ëngth
()è+ (gPaœ * 
gC¬dš®™y
[1]));

939 
fš®
 
	gEÁry
<
	gSŒšg
, SŒšg> 
	g·œ
 : 
gs
.
’ŒyS‘
()) {

940 
v®id©iÚBufãr
.
­³nd
(
·œ
.
g‘Key
()).­³ndÕaœ.
g‘V®ue
());

942  (è
	gv®id©iÚBufãr
.
toSŒšg
().
hashCode
(è^ 
	gtime¡amp
;

950 
´Ùeùed
 
	$š™KeysAndTags
(è
throws
 
WÜklßdExû±iÚ
 {

951 
fš®
 
keyL’gth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

952 
CÜeWÜklßd
.
FIELD_LENGTH_PROPERTY
,

953 
CÜeWÜklßd
.
FIELD_LENGTH_PROPERTY_DEFAULT
));

954 
fš®
 
gKeyL’gth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

955 
TAG_KEY_LENGTH_PROPERTY
, 
TAG_KEY_LENGTH_PROPERTY_DEFAULT
));

956 
fš®
 
gV®ueL’gth
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(

957 
TAG_VALUE_LENGTH_PROPERTY
, 
TAG_VALUE_LENGTH_PROPERTY_DEFAULT
));

959 
keyG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
keyL’gth
);

960 
gKeyG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
gKeyL’gth
);

961 
gV®ueG’”©Ü
 = 
Ãw
 
	`Inüem’tšgPršbËSŒšgG’”©Ü
(
gV®ueL’gth
);

963 
fš®
 
th»ads
 = 
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
Cl›Á
.
THREAD_COUNT_PROPERTY
, "1"));

964 
fš®
 
SŒšg
 
gC¬dš®™ySŒšg
 = 
´İ”t›s
.
	`g‘Prİ”ty
(

965 
TAG_CARDINALITY_PROPERTY
,

966 
TAG_CARDINALITY_PROPERTY_DEFAULT
);

967 
fš®
 
SŒšg
[] 
gC¬dš®™yP¬ts
 = 
gC¬dš®™ySŒšg
.
	`¥l™
(",");

968 
idx
 = 0;

969 
tÙ®C¬dš®™y
 = 
numKeys
;

970 
³rKeyC¬dš®™y
 = 1;

971 
maxC¬dš®™y
 = 0;

972 
fš®
 
SŒšg
 
ÿrd
 : 
gC¬dš®™yP¬ts
) {

973 
Œy
 {

974 
gC¬dš®™y
[
idx
] = 
IÁeg”
.
	`·r£IÁ
(
ÿrd
.
	`Œim
());

975 } 
	`ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

976 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Unableo…arse cardinality: " +

977 
ÿrd
, 
nã
);

979 ià(
gC¬dš®™y
[
idx
] < 1) {

980 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Cardinality must be greaterhan zero: " +

981 
gC¬dš®™y
[
idx
]);

983 
tÙ®C¬dš®™y
 *ğ
gC¬dš®™y
[
idx
];

984 
³rKeyC¬dš®™y
 *ğ
gC¬dš®™y
[
idx
];

985 ià(
gC¬dš®™y
[
idx
] > 
maxC¬dš®™y
) {

986 
maxC¬dš®™y
 = 
gC¬dš®™y
[
idx
];

988 ++
idx
;

989 ià(
idx
 >ğ
gPaœs
) {

994 ià(
numKeys
 < 
th»ads
) {

995 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("F›ld couÁ " + 
numKeys
 + " (keys forime "

997 + "th»ad " + 
th»ads
);

1001 ià(
idx
 < 
gPaœs
) {

1002 
gC¬dš®™y
[
idx
++] = 1;

1005 
i
 = 0; i < 
gC¬dš®™y
.
Ëngth
; ++i) {

1006 ià(
gC¬dš®™y
[
i
] > 1) {

1007 
fœ¡Inüem’bËC¬dš®™y
 = 
i
;

1012 
keys
 = 
Ãw
 
SŒšg
[
numKeys
];

1013 
gKeys
 = 
Ãw
 
SŒšg
[
gPaœs
];

1014 
gV®ues
 = 
Ãw
 
SŒšg
[
maxC¬dš®™y
];

1015 
i
 = 0; i < 
numKeys
; ++i) {

1016 
keys
[
i
] = 
keyG’”©Ü
.
	`ÃxtSŒšg
();

1019 
i
 = 0; i < 
gPaœs
; ++i) {

1020 
gKeys
[
i
] = 
gKeyG’”©Ü
.
	`ÃxtSŒšg
();

1023 
i
 = 0; i < 
maxC¬dš®™y
; i++) {

1024 
gV®ues
[
i
] = 
gV®ueG’”©Ü
.
	`ÃxtSŒšg
();

1026 ià(
¿ndomizeTime£r›sOrd”
) {

1027 
Uts
.
	`shufæeA¼ay
(
keys
);

1028 
Uts
.
	`shufæeA¼ay
(
gV®ues
);

1031 
maxOff£ts
 = (
»cÜdcouÁ
 / 
tÙ®C¬dš®™y
) + 1;

1032 
fš®
 [] 
keyAndTagC¬dš®™y
 = 
Ãw
 [
gPaœs
 + 1];

1033 
keyAndTagC¬dš®™y
[0] = 
numKeys
;

1034 
i
 = 0; i < 
gPaœs
; i++) {

1035 
keyAndTagC¬dš®™y
[
i
 + 1] = 
gC¬dš®™y
[i];

1038 
cumuÏtiveC¬dš®™y
 = 
Ãw
 [
keyAndTagC¬dš®™y
.
Ëngth
];

1039 
i
 = 0; i < 
keyAndTagC¬dš®™y
.
Ëngth
; i++) {

1040 
cumuÏtiÚ
 = 1;

1041 
x
 = 
i
; x <ğ
keyAndTagC¬dš®™y
.
Ëngth
 - 1; x++) {

1042 
cumuÏtiÚ
 *ğ
keyAndTagC¬dš®™y
[
x
];

1044 ià(
i
 > 0) {

1045 
cumuÏtiveC¬dš®™y
[
i
 - 1] = 
cumuÏtiÚ
;

1048 
cumuÏtiveC¬dš®™y
[cumuÏtiveC¬dš®™y.
Ëngth
 - 1] = 1;

1049 
	}
}

1055 
´Ùeùed
 
	$v®id©eS‘tšgs
(è
throws
 
WÜklßdExû±iÚ
 {

1056 ià(
d©aš‹gr™y
) {

1057 ià(
v®ueTy³
 !ğ
V®ueTy³
.
INTEGERS
) {

1058 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'valuetype' must "

1061 ià(
groupBy
) {

1062 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'groupbyfunction' must "

1065 ià(
down§m¶e
) {

1066 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'downsamplingfunction' must "

1069 ià(
qu”yTimeS·n
 > 0) {

1070 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'querytimespan' must "

1073 ià(
¿ndomizeTime£r›sOrd”
) {

1074 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'randomizetimeseriesorder' must "

1077 
fš®
 
SŒšg
 
¡¬tTime¡amp
 = 
´İ”t›s
.
	`g‘Prİ”ty
(
CÜeWÜklßd
.
INSERT_START_PROPERTY
);

1078 ià(
¡¬tTime¡amp
 =ğ
nuÎ
 || s¹Time¡amp.
	`isEm±y
()) {

1079 
throw
 
Ãw
 
	`WÜklßdExû±iÚ
("Data integrity wasƒnabled. 'insertstart' must "

1083 
	}
}

1088 
´Ùeùed
 cÏs 
	cTh»adS‹
 {

1090 
´Ùeùed
 
fš®
 
UnixEpochTime¡ampG’”©Ü
 
	gtime¡ampG’”©Ü
;

1093 
´Ùeùed
 
fš®
 
Numb”G’”©Ü
 
	gqu”yOff£tG’”©Ü
;

1096 
´Ùeùed
 
	gkeyIdx
;

1099 
´Ùeùed
 
	gkeyIdxS¹
;

1102 
´Ùeùed
 
	gkeyIdxEnd
;

1105 
´Ùeùed
 [] 
	ggV®ueIdxs
;

1108 
´Ùeùed
 
boŞ—n
 
	grŞlov”
;

1111 
´Ùeùed
 
	g¡¬tTime¡amp
;

1119 
´Ùeùed
 
Th»adS‹
(
fš®
 
th»adID
, fš® 
th»adCouÁ
è
throws
 
	gWÜklßdExû±iÚ
 {

1120 
	gtÙ®Th»ads
 = 
th»adCouÁ
 > 0 ?hreadCount : 1;

1122 ià(
	gth»adID
 >ğ
tÙ®Th»ads
) {

1123 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Th»ad ID " + 
th»adID
 + " cannot be greater "

1124 + "thª o¸equ®hªhth»ad couÁ " + 
tÙ®Th»ads
);

1126 ià(
	gkeys
.
	gËngth
 < 
	gth»adCouÁ
) {

1127 
throw
 
Ãw
 
WÜklßdExû±iÚ
("Th»ad couÁ " + 
tÙ®Th»ads
 + " must be greater "

1128 + "thª o¸equ®Økey couÁ " + 
keys
.
Ëngth
);

1131 
	gkeysP”Th»ad
 = 
keys
.
Ëngth
 / 
tÙ®Th»ads
;

1132 
	gkeyIdx
 = 
keysP”Th»ad
 * 
th»adID
;

1133 
	gkeyIdxS¹
 = 
keyIdx
;

1134 ià(
	gtÙ®Th»ads
 - 1 =ğ
th»adID
) {

1135 
keyIdxEnd
 = 
keys
.
Ëngth
;

1137 
	gkeyIdxEnd
 = 
keyIdxS¹
 + 
keysP”Th»ad
;

1140 
	ggV®ueIdxs
 = 
Ãw
 [
gPaœs
];

1142 
fš®
 
SŒšg
 
	g¡¬tšgTime¡amp
 =

1143 
´İ”t›s
.
g‘Prİ”ty
(
CÜeWÜklßd
.
INSERT_START_PROPERTY
);

1144 ià(
	g¡¬tšgTime¡amp
 =ğ
nuÎ
 || 
¡¬tšgTime¡amp
.
isEm±y
()) {

1145 
time¡ampG’”©Ü
 = 
¿ndomizeTime¡ampOrd”
 ?

1146 
Ãw
 
RªdomDisü‘eTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
, 
maxOff£ts
) :

1147 
Ãw
 
UnixEpochTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
);

1149 
	gŒy
 {

1150 
	gtime¡ampG’”©Ü
 = 
¿ndomizeTime¡ampOrd”
 ?

1151 
Ãw
 
RªdomDisü‘eTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
,

1152 
LÚg
.
·r£LÚg
(
¡¬tšgTime¡amp
), 
maxOff£ts
) :

1153 
Ãw
 
UnixEpochTime¡ampG’”©Ü
(
time¡ampIÁ”v®
, 
timeUn™s
,

1154 
LÚg
.
·r£LÚg
(
¡¬tšgTime¡amp
));

1155 } 
ÿtch
 (
Numb”FÜm©Exû±iÚ
 
nã
) {

1156 
throw
 
Ãw
 
WÜklßdExû±iÚ
("Unableo…arsehe " +

1157 
CÜeWÜklßd
.
INSERT_START_PROPERTY
, 
nã
);

1162 
	g¡¬tTime¡amp
 = 
time¡ampG’”©Ü
.
ÃxtV®ue
();

1164 
	gqu”yOff£tG’”©Ü
 = 
Ãw
 
UnifÜmLÚgG’”©Ü
(0, 
maxOff£ts
 - 2);

1175 
´Ùeùed
 
SŒšg
 
ÃxtD©aPošt
(
fš®
 
M­
<SŒšg, 
By‹I‹¿tÜ
> 
m­
, fš® 
boŞ—n
 
isIn£¹
) {

1176 
fš®
 
Rªdom
 
	g¿ndom
 = 
Th»adLoÿlRªdom
.
cu¼’t
();

1177 
	g™”©iÚs
 = 
¥¬s™y
 <ğ0 ? 1 : 
¿ndom
.
ÃxtIÁ
((è((è
³rKeyC¬dš®™y
 * sparsity));

1178 ià(
	g™”©iÚs
 < 1) {

1179 
	g™”©iÚs
 = 1;

1181 
	gŒue
) {

1182 
	g™”©iÚs
--;

1183 ià(
	grŞlov”
) {

1184 
	gtime¡ampG’”©Ü
.
ÃxtV®ue
();

1185 
	grŞlov”
 = 
çl£
;

1187 
SŒšg
 
	gkey
 = 
nuÎ
;

1188 ià(
	g™”©iÚs
 <= 0) {

1189 
fš®
 
T»eM­
<
SŒšg
, SŒšg> 
v®id©iÚTags
;

1190 ià(
	gd©aš‹gr™y
) {

1191 
	gv®id©iÚTags
 = 
Ãw
 
T»eM­
<
SŒšg
, 
	gSŒšg
>();

1193 
	gv®id©iÚTags
 = 
nuÎ
;

1195 
	gkey
 = 
keys
[
keyIdx
];

1196 
	gov”®lIdx
 = 
keyIdx
 * 
cumuÏtiveC¬dš®™y
[0];

1197 
	gi
 = 0; i < 
	ggPaœs
; ++i) {

1198 
	gtvidx
 = 
gV®ueIdxs
[
i
];

1199 
	gm­
.
put
(
gKeys
[
i
], 
Ãw
 
SŒšgBy‹I‹¿tÜ
(
gV®ues
[
tvidx
]));

1200 ià(
	gd©aš‹gr™y
) {

1201 
	gv®id©iÚTags
.
put
(
gKeys
[
i
], 
gV®ues
[
tvidx
]);

1203 ià(
	gd–ayedS”›s
 > 0) {

1204 
	gov”®lIdx
 +ğ(
tvidx
 * 
cumuÏtiveC¬dš®™y
[
i
 + 1]);

1208 ià(!
	gisIn£¹
) {

1209 
fš®
 
	gd–
 = (
time¡ampG’”©Ü
.
cu¼’tV®ue
(è- 
¡¬tTime¡amp
è/ 
time¡ampIÁ”v®
;

1210 
fš®
 
	gš‹rv®s
 = 
¿ndom
.
ÃxtIÁ
((è
d–
);

1211 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¡¬tTime¡amp
 + (
š‹rv®s
 * 
time¡ampIÁ”v®
)));

1212 } ià(
	gd–ayedS”›s
 > 0) {

1215 
	gpù
 = (è
ov”®lIdx
 / (è
tÙ®C¬dš®™y
;

1216 ià(
	gpù
 < 
	gd–ayedS”›s
) {

1217 
	gmodulo
 = 
ov”®lIdx
 % 
d–ayedIÁ”v®s
;

1218 ià(
	gmodulo
 < 0) {

1219 
	gmodulo
 *= -1;

1221 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
time¡ampG’”©Ü
.
cu¼’tV®ue
() -

1222 
time¡ampIÁ”v®
 * 
modulo
));

1224 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
time¡ampG’”©Ü
.
cu¼’tV®ue
()));

1227 
	gm­
.
put
(
time¡ampKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
time¡ampG’”©Ü
.
cu¼’tV®ue
()));

1230 ià(
	gd©aš‹gr™y
) {

1231 
	gm­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
v®id©iÚFunùiÚ
(
key
,

1232 
time¡ampG’”©Ü
.
cu¼’tV®ue
(), 
v®id©iÚTags
)));

1234 
	gv®ueTy³
) {

1235 
	gINTEGERS
:

1236 
m­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtIÁ
()));

1238 
	gFLOATS
:

1239 
m­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtDoubË
() * () 100000));

1241 
	gMIXED
:

1242 ià(
¿ndom
.
ÃxtBoŞ—n
()) {

1243 
m­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtIÁ
()));

1245 
	gm­
.
put
(
v®ueKey
, 
Ãw
 
Num”icBy‹I‹¿tÜ
(
¿ndom
.
ÃxtDoubË
() * () 100000));

1249 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Somehow we didn't have‡ value "

1250 + "ty³ cÚfigu»dh© wsuµÜt: " + 
v®ueTy³
);

1255 
boŞ—n
 
	ggRŞlov”
 = 
çl£
;

1256 
	gi
 = 
gC¬dš®™y
.
Ëngth
 - 1; i >= 0; --i) {

1257 ià(
	ggC¬dš®™y
[
i
] <= 1) {

1258 
gRŞlov”
 = 
Œue
;

1262 ià(
	ggV®ueIdxs
[
i
] + 1 >ğ
gC¬dš®™y
[i]) {

1263 
gV®ueIdxs
[
i
] = 0;

1264 ià(
	gi
 =ğ
fœ¡Inüem’bËC¬dš®™y
) {

1265 
gRŞlov”
 = 
Œue
;

1268 ++
	ggV®ueIdxs
[
i
];

1273 ià(
	ggRŞlov”
) {

1274 ià(
	gkeyIdx
 + 1 >ğ
keyIdxEnd
) {

1275 
keyIdx
 = 
keyIdxS¹
;

1276 
	grŞlov”
 = 
Œue
;

1278 ++
	gkeyIdx
;

1282 ià(
	g™”©iÚs
 <= 0) {

1283  
key
;

	@workloads/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

	@workloads/package-info.java

21 
·ckage
 
	gs™e
.
	gycsb
.
	gwÜklßds
;

	@
1
.
1
/usr/include
129
3886
BasicDB.java
BasicDB.java
BasicTSDB.java
BasicTSDB.java
ByteArrayByteIterator.java
ByteArrayByteIterator.java
ByteIterator.java
ByteIterator.java
Client.java
Client.java
ClientThread.java
ClientThread.java
CommandLine.java
CommandLine.java
DB.java
DB.java
DBException.java
DBException.java
DBFactory.java
DBFactory.java
DBWrapper.java
DBWrapper.java
GoodBadUglyDB.java
GoodBadUglyDB.java
InputStreamByteIterator.java
InputStreamByteIterator.java
NumericByteIterator.java
NumericByteIterator.java
RandomByteIterator.java
RandomByteIterator.java
Status.java
Status.java
StatusThread.java
StatusThread.java
StringByteIterator.java
StringByteIterator.java
TerminatorThread.java
TerminatorThread.java
TimeseriesDB.java
TimeseriesDB.java
UnknownDBException.java
UnknownDBException.java
Utils.java
Utils.java
Workload.java
Workload.java
WorkloadException.java
WorkloadException.java
cscope.file
generator/AcknowledgedCounterGenerator.java
generator/AcknowledgedCounterGenerator.java
generator/ConstantIntegerGenerator.java
generator/ConstantIntegerGenerator.java
generator/CounterGenerator.java
generator/CounterGenerator.java
generator/DiscreteGenerator.java
generator/DiscreteGenerator.java
generator/ExponentialGenerator.java
generator/ExponentialGenerator.java
generator/FileGenerator.java
generator/FileGenerator.java
generator/Generator.java
generator/Generator.java
generator/HistogramGenerator.java
generator/HistogramGenerator.java
generator/HotspotIntegerGenerator.java
generator/HotspotIntegerGenerator.java
generator/IncrementingPrintableStringGenerator.java
generator/IncrementingPrintableStringGenerator.java
generator/NumberGenerator.java
generator/NumberGenerator.java
generator/RandomDiscreteTimestampGenerator.java
generator/RandomDiscreteTimestampGenerator.java
generator/ScrambledZipfianGenerator.java
generator/ScrambledZipfianGenerator.java
generator/SequentialGenerator.java
generator/SequentialGenerator.java
generator/SkewedLatestGenerator.java
generator/SkewedLatestGenerator.java
generator/UniformGenerator.java
generator/UniformGenerator.java
generator/UniformLongGenerator.java
generator/UniformLongGenerator.java
generator/UnixEpochTimestampGenerator.java
generator/UnixEpochTimestampGenerator.java
generator/ZipfianGenerator.java
generator/ZipfianGenerator.java
generator/package-info.java
generator/package-info.java
measurements/.OneMeasurementHistogram.java.swp
measurements/.OneMeasurementHistogram.java.swp
measurements/Measurements.java
measurements/Measurements.java
measurements/OneMeasurement.java
measurements/OneMeasurement.java
measurements/OneMeasurementHdrHistogram.java
measurements/OneMeasurementHdrHistogram.java
measurements/OneMeasurementHistogram.java
measurements/OneMeasurementHistogram.java
measurements/OneMeasurementRaw.java
measurements/OneMeasurementRaw.java
measurements/OneMeasurementTimeSeries.java
measurements/OneMeasurementTimeSeries.java
measurements/TwoInOneMeasurement.java
measurements/TwoInOneMeasurement.java
measurements/exporter/JSONArrayMeasurementsExporter.java
measurements/exporter/JSONArrayMeasurementsExporter.java
measurements/exporter/JSONMeasurementsExporter.java
measurements/exporter/JSONMeasurementsExporter.java
measurements/exporter/MeasurementsExporter.java
measurements/exporter/MeasurementsExporter.java
measurements/exporter/TextMeasurementsExporter.java
measurements/exporter/TextMeasurementsExporter.java
measurements/exporter/package-info.java
measurements/exporter/package-info.java
measurements/package-info.java
measurements/package-info.java
package-info.java
package-info.java
workloads/ConstantOccupancyWorkload.java
workloads/ConstantOccupancyWorkload.java
workloads/CoreWorkload.java
workloads/CoreWorkload.java
workloads/RestWorkload.java
workloads/RestWorkload.java
workloads/TimeSeriesWorkload.java
workloads/TimeSeriesWorkload.java
workloads/package-info.java
workloads/package-info.java
